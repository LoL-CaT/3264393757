(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"+924":function(t,e,i){"use strict";i.d(e,"d",function(){return s}),i.d(e,"c",function(){return a}),i.d(e,"b",function(){return r}),i.d(e,"a",function(){return o});var n=i("9AQC");function s(t,e){return void 0===e&&(e=0),"string"!=typeof t||0===e||t.length<=e?t:t.substr(0,e)+"..."}function a(t,e){var i=t,n=i.length;if(n<=150)return i;e>n&&(e=n);var s=Math.max(e-60,0);s<5&&(s=0);var a=Math.min(s+140,n);return a>n-5&&(a=n),a===n&&(s=Math.max(a-140,0)),i=i.slice(s,a),s>0&&(i="'{snip} "+i),a<n&&(i+=" {snip}"),i}function r(t,e){if(!Array.isArray(t))return"";for(var i=[],n=0;n<t.length;n++){var s=t[n];try{i.push(String(s))}catch(a){i.push("[value cannot be serialized]")}}return i.join(e)}function o(t,e){return!!Object(n.k)(t)&&(Object(n.j)(e)?e.test(t):"string"==typeof e&&-1!==t.indexOf(e))}},"+A1k":function(t,e,i){"use strict";(function(t){function n(){return"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)}function s(t,e){return t.require(e)}function a(e){var i;try{i=s(t,e)}catch(a){}try{var n=s(t,"process").cwd;i=s(t,n()+"/node_modules/"+e)}catch(a){}return i}i.d(e,"b",function(){return n}),i.d(e,"a",function(){return s}),i.d(e,"c",function(){return a})}).call(this,i("3UD+")(t))},0:function(t,e,i){t.exports=i("zUnb")},"2QA8":function(t,e,i){"use strict";i.d(e,"a",function(){return n});const n=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())()},"2bdC":function(t,e,i){"use strict";i.d(e,"a",function(){return o});var n=i("6hSO"),s=i("8LbN"),a=i("bju/"),r=i("FGHR");function o(){Object(n.a)({callback:c,type:"error"}),Object(n.a)({callback:c,type:"unhandledrejection"})}function c(){var t=Object(r.b)();t&&(s.a.log("[Tracing] Transaction: "+a.a.InternalError+" -> Global error occured"),t.setStatus(a.a.InternalError))}},"2fFW":function(t,e,i){"use strict";i.d(e,"a",function(){return s});let n=!1;const s={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else n&&console.log("RxJS: Back to a better error behavior. Thank you. <3");n=t},get useDeprecatedSynchronousErrorHandling(){return n}}},"3UD+":function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},"4Ssk":function(t,e,i){"use strict";i.d(e,"b",function(){return a}),i.d(e,"a",function(){return r}),i.d(e,"d",function(){return o}),i.d(e,"e",function(){return c}),i.d(e,"c",function(){return l});var n=i("8LbN"),s=i("9/Zf");function a(){if(!("fetch"in Object(s.e)()))return!1;try{return new Headers,new Request(""),new Response,!0}catch(t){return!1}}function r(t){return t&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function o(){if(!a())return!1;var t=Object(s.e)();if(r(t.fetch))return!0;var e=!1,i=t.document;if(i&&"function"==typeof i.createElement)try{var o=i.createElement("iframe");o.hidden=!0,i.head.appendChild(o),o.contentWindow&&o.contentWindow.fetch&&(e=r(o.contentWindow.fetch)),i.head.removeChild(o)}catch(c){n.a.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",c)}return e}function c(){if(!a())return!1;try{return new Request("_",{referrerPolicy:"origin"}),!0}catch(t){return!1}}function l(){var t=Object(s.e)(),e=t.chrome;return!(e&&e.app&&e.app.runtime||!("history"in t)||!t.history.pushState||!t.history.replaceState)}},"5+tZ":function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=i("lJxs"),s=i("Cfvw"),a=i("zx2A");function r(t,e,i=Number.POSITIVE_INFINITY){return"function"==typeof e?a=>a.pipe(r((i,a)=>Object(s.a)(t(i,a)).pipe(Object(n.a)((t,n)=>e(i,t,a,n))),i)):("number"==typeof e&&(i=e),e=>e.lift(new o(t,i)))}class o{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new c(t,this.project,this.concurrent))}}class c extends a.b{constructor(t,e,i=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const i=this.index++;try{e=this.project(t,i)}catch(n){return void this.destination.error(n)}this.active++,this._innerSub(e)}_innerSub(t){const e=new a.a(this),i=this.destination;i.add(e);const n=Object(a.c)(t,e);n!==e&&i.add(n)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t){this.destination.next(t)}notifyComplete(){const t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}},"6PXS":function(t,e,i){"use strict";i.d(e,"c",function(){return l}),i.d(e,"f",function(){return u}),i.d(e,"e",function(){return h}),i.d(e,"d",function(){return p}),i.d(e,"b",function(){return g}),i.d(e,"a",function(){return f});var n=i("wmvo"),s=i("vFt6"),a=i("9AQC"),r=function(){function t(){this._hasWeakSet="function"==typeof WeakSet,this._inner=this._hasWeakSet?new WeakSet:[]}return t.prototype.memoize=function(t){if(this._hasWeakSet)return!!this._inner.has(t)||(this._inner.add(t),!1);for(var e=0;e<this._inner.length;e++)if(this._inner[e]===t)return!0;return this._inner.push(t),!1},t.prototype.unmemoize=function(t){if(this._hasWeakSet)this._inner.delete(t);else for(var e=0;e<this._inner.length;e++)if(this._inner[e]===t){this._inner.splice(e,1);break}},t}(),o=i("pRiV"),c=i("+924");function l(t,e,i){if(e in t){var n=t[e],s=i(n);if("function"==typeof s)try{s.prototype=s.prototype||{},Object.defineProperties(s,{__sentry_original__:{enumerable:!1,value:n}})}catch(a){}t[e]=s}}function u(t){return Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&")}function d(t){if(Object(a.d)(t)){var e=t,i={message:e.message,name:e.name,stack:e.stack};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n]);return i}if(Object(a.f)(t)){var r=t,o={};o.type=r.type;try{o.target=Object(a.c)(r.target)?Object(s.a)(r.target):Object.prototype.toString.call(r.target)}catch(c){o.target="<unknown>"}try{o.currentTarget=Object(a.c)(r.currentTarget)?Object(s.a)(r.currentTarget):Object.prototype.toString.call(r.currentTarget)}catch(c){o.currentTarget="<unknown>"}for(var n in"undefined"!=typeof CustomEvent&&Object(a.g)(t,CustomEvent)&&(o.detail=r.detail),r)Object.prototype.hasOwnProperty.call(r,n)&&(o[n]=r);return o}return t}function h(t,e,i){void 0===e&&(e=3),void 0===i&&(i=102400);var n,s=p(t,e);return n=JSON.stringify(s),~-encodeURI(n).split(/%..|./).length>i?h(t,e-1,i):s}function b(t,e){return"domain"===e&&t&&"object"==typeof t&&t._events?"[Domain]":"domainEmitter"===e?"[DomainEmitter]":"undefined"!=typeof global&&t===global?"[Global]":"undefined"!=typeof window&&t===window?"[Window]":"undefined"!=typeof document&&t===document?"[Document]":Object(a.l)(t)?"[SyntheticEvent]":"number"==typeof t&&t!=t?"[NaN]":void 0===t?"[undefined]":"function"==typeof t?"[Function: "+Object(o.a)(t)+"]":"symbol"==typeof t?"["+String(t)+"]":"bigint"==typeof t?"[BigInt: "+String(t)+"]":t}function m(t,e,i,n){if(void 0===i&&(i=1/0),void 0===n&&(n=new r),0===i)return function(t){var e=Object.prototype.toString.call(t);if("string"==typeof t)return t;if("[object Object]"===e)return"[Object]";if("[object Array]"===e)return"[Array]";var i=b(t);return Object(a.i)(i)?i:e}(e);if(null!=e&&"function"==typeof e.toJSON)return e.toJSON();var s=b(e,t);if(Object(a.i)(s))return s;var o=d(e),c=Array.isArray(e)?[]:{};if(n.memoize(e))return"[Circular ~]";for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(c[l]=m(l,o[l],i-1,n));return n.unmemoize(e),c}function p(t,e){try{return JSON.parse(JSON.stringify(t,function(t,i){return m(t,i,e)}))}catch(i){return"**non-serializable**"}}function g(t,e){void 0===e&&(e=40);var i=Object.keys(d(t));if(i.sort(),!i.length)return"[object has no keys]";if(i[0].length>=e)return Object(c.d)(i[0],e);for(var n=i.length;n>0;n--){var s=i.slice(0,n).join(", ");if(!(s.length>e))return n===i.length?s:Object(c.d)(s,e)}return""}function f(t){var e,i;if(Object(a.h)(t)){var s=t,r={};try{for(var o=Object(n.g)(Object.keys(s)),c=o.next();!c.done;c=o.next()){var l=c.value;void 0!==s[l]&&(r[l]=f(s[l]))}}catch(u){e={error:u}}finally{try{c&&!c.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}return r}return Array.isArray(t)?t.map(f):t}},"6hSO":function(t,e,i){"use strict";i.d(e,"a",function(){return g});var n,s,a,r=i("wmvo"),o=i("9AQC"),c=i("8LbN"),l=i("9/Zf"),u=i("6PXS"),d=i("pRiV"),h=i("4Ssk"),b=Object(l.e)(),m={},p={};function g(t){t&&"string"==typeof t.type&&"function"==typeof t.callback&&(m[t.type]=m[t.type]||[],m[t.type].push(t.callback),function(t){if(!p[t])switch(p[t]=!0,t){case"console":"console"in b&&["debug","info","warn","error","log","assert"].forEach(function(t){t in b.console&&Object(u.c)(b.console,t,function(e){return function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];f("console",{args:i,level:t}),e&&Function.prototype.apply.call(e,b.console,i)}})});break;case"dom":!function(){if("document"in b){var t=f.bind(null,"dom"),e=_(t,!0);b.document.addEventListener("click",e,!1),b.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(function(e){var i=b[e]&&b[e].prototype;i&&i.hasOwnProperty&&i.hasOwnProperty("addEventListener")&&(Object(u.c)(i,"addEventListener",function(e){return function(i,n,s){if("click"===i||"keypress"==i)try{var a=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},r=a[i]=a[i]||{refCount:0};if(!r.handler){var o=_(t);r.handler=o,e.call(this,i,o,s)}r.refCount+=1}catch(c){}return e.call(this,i,n,s)}}),Object(u.c)(i,"removeEventListener",function(t){return function(e,i,n){if("click"===e||"keypress"==e)try{var s=this.__sentry_instrumentation_handlers__||{},a=s[e];a&&(a.refCount-=1,a.refCount<=0&&(t.call(this,e,a.handler,n),a.handler=void 0,delete s[e]),0===Object.keys(s).length&&delete this.__sentry_instrumentation_handlers__)}catch(r){}return t.call(this,e,i,n)}}))})}}();break;case"xhr":!function(){if("XMLHttpRequest"in b){var t=[],e=[],i=XMLHttpRequest.prototype;Object(u.c)(i,"open",function(i){return function(){for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];var a=this,r=n[1];a.__sentry_xhr__={method:Object(o.k)(n[0])?n[0].toUpperCase():n[0],url:n[1]},Object(o.k)(r)&&"POST"===a.__sentry_xhr__.method&&r.match(/sentry_key/)&&(a.__sentry_own_request__=!0);var c=function(){if(4===a.readyState){try{a.__sentry_xhr__&&(a.__sentry_xhr__.status_code=a.status)}catch(r){}try{var i=t.indexOf(a);if(-1!==i){t.splice(i);var s=e.splice(i)[0];a.__sentry_xhr__&&void 0!==s[0]&&(a.__sentry_xhr__.body=s[0])}}catch(r){}f("xhr",{args:n,endTimestamp:Date.now(),startTimestamp:Date.now(),xhr:a})}};return"onreadystatechange"in a&&"function"==typeof a.onreadystatechange?Object(u.c)(a,"onreadystatechange",function(t){return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return c(),t.apply(a,e)}}):a.addEventListener("readystatechange",c),i.apply(a,n)}}),Object(u.c)(i,"send",function(i){return function(){for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];return t.push(this),e.push(n),f("xhr",{args:n,startTimestamp:Date.now(),xhr:this}),i.apply(this,n)}})}}();break;case"fetch":Object(h.d)()&&Object(u.c)(b,"fetch",function(t){return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var n={args:e,fetchData:{method:v(e),url:y(e)},startTimestamp:Date.now()};return f("fetch",Object(r.a)({},n)),t.apply(b,e).then(function(t){return f("fetch",Object(r.a)(Object(r.a)({},n),{endTimestamp:Date.now(),response:t})),t},function(t){throw f("fetch",Object(r.a)(Object(r.a)({},n),{endTimestamp:Date.now(),error:t})),t})}});break;case"history":!function(){if(Object(h.c)()){var t=b.onpopstate;b.onpopstate=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var s=b.location.href,a=n;if(n=s,f("history",{from:a,to:s}),t)try{return t.apply(this,e)}catch(r){}},Object(u.c)(b.history,"pushState",e),Object(u.c)(b.history,"replaceState",e)}function e(t){return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var s=e.length>2?e[2]:void 0;if(s){var a=n,r=String(s);n=r,f("history",{from:a,to:r})}return t.apply(this,e)}}}();break;case"error":k=b.onerror,b.onerror=function(t,e,i,n,s){return f("error",{column:n,error:s,line:i,msg:t,url:e}),!!k&&k.apply(this,arguments)};break;case"unhandledrejection":w=b.onunhandledrejection,b.onunhandledrejection=function(t){return f("unhandledrejection",t),!w||w.apply(this,arguments)};break;default:c.a.warn("unknown instrumentation type:",t)}}(t.type))}function f(t,e){var i,n;if(t&&m[t])try{for(var s=Object(r.g)(m[t]||[]),a=s.next();!a.done;a=s.next()){var o=a.value;try{o(e)}catch(l){c.a.error("Error while triggering instrumentation handler.\nType: "+t+"\nName: "+Object(d.a)(o)+"\nError: "+l)}}}catch(u){i={error:u}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}}function v(t){return void 0===t&&(t=[]),"Request"in b&&Object(o.g)(t[0],Request)&&t[0].method?String(t[0].method).toUpperCase():t[1]&&t[1].method?String(t[1].method).toUpperCase():"GET"}function y(t){return void 0===t&&(t=[]),"string"==typeof t[0]?t[0]:"Request"in b&&Object(o.g)(t[0],Request)?t[0].url:String(t[0])}function _(t,e){return void 0===e&&(e=!1),function(i){if(i&&a!==i&&!function(t){if("keypress"!==t.type)return!1;try{var e=t.target;if(!e||!e.tagName)return!0;if("INPUT"===e.tagName||"TEXTAREA"===e.tagName||e.isContentEditable)return!1}catch(i){}return!0}(i)){var n="keypress"===i.type?"input":i.type;(void 0===s||function(t,e){if(!t)return!0;if(t.type!==e.type)return!0;try{if(t.target!==e.target)return!0}catch(i){}return!1}(a,i))&&(t({event:i,name:n,global:e}),a=i),clearTimeout(s),s=b.setTimeout(function(){s=void 0},1e3)}}}var k=null,w=null},"7o/Q":function(t,e,i){"use strict";i.d(e,"a",function(){return l});var n=i("n6bG"),s=i("gRHU"),a=i("quSY"),r=i("2QA8"),o=i("2fFW"),c=i("NJ4a");class l extends a.a{constructor(t,e,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=s.a;break;case 1:if(!t){this.destination=s.a;break}if("object"==typeof t){t instanceof l?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new u(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new u(this,t,e,i)}}[r.a](){return this}static create(t,e,i){const n=new l(t,e,i);return n.syncErrorThrowable=!1,n}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:t}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}class u extends l{constructor(t,e,i,a){let r;super(),this._parentSubscriber=t;let o=this;Object(n.a)(e)?r=e:e&&(r=e.next,i=e.error,a=e.complete,e!==s.a&&(o=Object.create(e),Object(n.a)(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=r,this._error=i,this._complete=a}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;o.a.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:i}=o.a;if(this._error)i&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)i?(e.syncErrorValue=t,e.syncErrorThrown=!0):Object(c.a)(t),this.unsubscribe();else{if(this.unsubscribe(),i)throw t;Object(c.a)(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);o.a.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(i){if(this.unsubscribe(),o.a.useDeprecatedSynchronousErrorHandling)throw i;Object(c.a)(i)}}__tryOrSetError(t,e,i){if(!o.a.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,i)}catch(n){return o.a.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=n,t.syncErrorThrown=!0,!0):(Object(c.a)(n),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}},"8LbN":function(t,e,i){"use strict";i.d(e,"a",function(){return o});var n=i("9/Zf"),s=Object(n.e)(),a="Sentry Logger ",r=function(){function t(){this._enabled=!1}return t.prototype.disable=function(){this._enabled=!1},t.prototype.enable=function(){this._enabled=!0},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._enabled&&Object(n.c)(function(){s.console.log(a+"[Log]: "+t.join(" "))})},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._enabled&&Object(n.c)(function(){s.console.warn(a+"[Warn]: "+t.join(" "))})},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._enabled&&Object(n.c)(function(){s.console.error(a+"[Error]: "+t.join(" "))})},t}();s.__SENTRY__=s.__SENTRY__||{};var o=s.__SENTRY__.logger||(s.__SENTRY__.logger=new r)},"8ZBU":function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n=i("fXoL");function s(...t){function e(){try{throw Error("")}catch(i){return i}}var i=e(),s=i.stack.split("\n")[3],a=s.indexOf("at ");s.slice(a+2,s.length);let r=new Date,o=t=>t<10?"00"+t:t<100?"0"+t:t,c=t=>t<10?"0"+t:t,l=`[${c(r.getHours())}:${c(r.getMinutes())}:${c(r.getSeconds())}:${o(r.getMilliseconds().toFixed(0))}]`,u=[].slice.call(arguments).map(t=>"object"==typeof t?JSON.stringify(t):("number"==typeof t?t:t||"").toString()).join(", ");console.log.apply(null,t),location.href.match(/noAlert\=1/gim)||Object(n.X)()||location.href.match(/\/dist\//)||alert("con:"+l+" "+u)}window.SystemLog=s},"9/Zf":function(t,e,i){"use strict";i.d(e,"e",function(){return a}),i.d(e,"j",function(){return r}),i.d(e,"h",function(){return o}),i.d(e,"d",function(){return c}),i.d(e,"c",function(){return l}),i.d(e,"b",function(){return u}),i.d(e,"a",function(){return d}),i.d(e,"f",function(){return h}),i.d(e,"g",function(){return b}),i.d(e,"i",function(){return m});var n=i("+A1k"),s=(i("+924"),{});function a(){return Object(n.b)()?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:s}function r(){var t=a(),e=t.crypto||t.msCrypto;if(void 0!==e&&e.getRandomValues){var i=new Uint16Array(8);e.getRandomValues(i),i[3]=4095&i[3]|16384,i[4]=16383&i[4]|32768;var n=function(t){for(var e=t.toString(16);e.length<4;)e="0"+e;return e};return n(i[0])+n(i[1])+n(i[2])+n(i[3])+n(i[4])+n(i[5])+n(i[6])+n(i[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})}function o(t){if(!t)return{};var e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);return e?{host:e[4],path:e[5],protocol:e[2],relative:e[5]+(e[6]||"")+(e[8]||"")}:{}}function c(t){if(t.message)return t.message;if(t.exception&&t.exception.values&&t.exception.values[0]){var e=t.exception.values[0];return e.type&&e.value?e.type+": "+e.value:e.type||e.value||t.event_id||"<unknown>"}return t.event_id||"<unknown>"}function l(t){var e=a();if(!("console"in e))return t();var i=e.console,n={};["debug","info","warn","error","log","assert"].forEach(function(t){t in e.console&&i[t].__sentry_original__&&(n[t]=i[t],i[t]=i[t].__sentry_original__)});var s=t();return Object.keys(n).forEach(function(t){i[t]=n[t]}),s}function u(t,e,i){t.exception=t.exception||{},t.exception.values=t.exception.values||[],t.exception.values[0]=t.exception.values[0]||{},t.exception.values[0].value=t.exception.values[0].value||e||"",t.exception.values[0].type=t.exception.values[0].type||i||"Error"}function d(t,e){void 0===e&&(e={});try{t.exception.values[0].mechanism=t.exception.values[0].mechanism||{},Object.keys(e).forEach(function(i){t.exception.values[0].mechanism[i]=e[i]})}catch(i){}}function h(){try{return document.location.href}catch(t){return""}}function b(t,e){if(!e)return 6e4;var i=parseInt(""+e,10);if(!isNaN(i))return 1e3*i;var n=Date.parse(""+e);return isNaN(n)?6e4:n-t}function m(t){return t.split(/[\?#]/,1)[0]}},"9AQC":function(t,e,i){"use strict";function n(t){switch(Object.prototype.toString.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return p(t,Error)}}function s(t){return"[object ErrorEvent]"===Object.prototype.toString.call(t)}function a(t){return"[object DOMError]"===Object.prototype.toString.call(t)}function r(t){return"[object DOMException]"===Object.prototype.toString.call(t)}function o(t){return"[object String]"===Object.prototype.toString.call(t)}function c(t){return null===t||"object"!=typeof t&&"function"!=typeof t}function l(t){return"[object Object]"===Object.prototype.toString.call(t)}function u(t){return"undefined"!=typeof Event&&p(t,Event)}function d(t){return"undefined"!=typeof Element&&p(t,Element)}function h(t){return"[object RegExp]"===Object.prototype.toString.call(t)}function b(t){return Boolean(t&&t.then&&"function"==typeof t.then)}function m(t){return l(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function p(t,e){try{return t instanceof e}catch(i){return!1}}i.d(e,"d",function(){return n}),i.d(e,"e",function(){return s}),i.d(e,"a",function(){return a}),i.d(e,"b",function(){return r}),i.d(e,"k",function(){return o}),i.d(e,"i",function(){return c}),i.d(e,"h",function(){return l}),i.d(e,"f",function(){return u}),i.d(e,"c",function(){return d}),i.d(e,"j",function(){return h}),i.d(e,"m",function(){return b}),i.d(e,"l",function(){return m}),i.d(e,"g",function(){return p})},"9ppp":function(t,e,i){"use strict";i.d(e,"a",function(){return n});const n=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})()},Cfvw:function(t,e,i){"use strict";i.d(e,"a",function(){return d});var n=i("HDdC"),s=i("SeVD"),a=i("quSY"),r=i("kJWO"),o=i("jZKg"),c=i("Lhse"),l=i("c2HN"),u=i("I55L");function d(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[r.a]}(t))return function(t,e){return new n.a(i=>{const n=new a.a;return n.add(e.schedule(()=>{const s=t[r.a]();n.add(s.subscribe({next(t){n.add(e.schedule(()=>i.next(t)))},error(t){n.add(e.schedule(()=>i.error(t)))},complete(){n.add(e.schedule(()=>i.complete()))}}))})),n})}(t,e);if(Object(l.a)(t))return function(t,e){return new n.a(i=>{const n=new a.a;return n.add(e.schedule(()=>t.then(t=>{n.add(e.schedule(()=>{i.next(t),n.add(e.schedule(()=>i.complete()))}))},t=>{n.add(e.schedule(()=>i.error(t)))}))),n})}(t,e);if(Object(u.a)(t))return Object(o.a)(t,e);if(function(t){return t&&"function"==typeof t[c.a]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new n.a(i=>{const n=new a.a;let s;return n.add(()=>{s&&"function"==typeof s.return&&s.return()}),n.add(e.schedule(()=>{s=t[c.a](),n.add(e.schedule(function(){if(i.closed)return;let t,e;try{const i=s.next();t=i.value,e=i.done}catch(n){return void i.error(n)}e?i.complete():(i.next(t),this.schedule())}))})),n})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof n.a?t:new n.a(Object(s.a)(t))}},Cpvd:function(t,e,i){"use strict";(function(t){i.d(e,"b",function(){return p}),i.d(e,"a",function(){return g});var n=i("wmvo"),s=i("lW6c"),a=i("jrpr"),r=i("8LbN"),o=i("+A1k"),c=i("2bdC"),l=i("MBYv"),u=i("EldZ"),d=i("FGHR");function h(){var t=this.getScope();if(t){var e=t.getSpan();if(e)return{"sentry-trace":e.toTraceparent()}}return{}}function b(t,e,i){return Object(d.c)()?void 0!==t.sampled?(t.setMetadata({transactionSampling:{method:a.a.Explicit}}),t):("function"==typeof e.tracesSampler?(s=e.tracesSampler(i),t.setMetadata({transactionSampling:{method:a.a.Sampler,rate:Number(s)}})):void 0!==i.parentSampled?(s=i.parentSampled,t.setMetadata({transactionSampling:{method:a.a.Inheritance}})):(s=e.tracesSampleRate,t.setMetadata({transactionSampling:{method:a.a.Rate,rate:Number(s)}})),n=s,(isNaN(n)||"number"!=typeof n&&"boolean"!=typeof n?(r.a.warn("[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got "+JSON.stringify(n)+" of type "+JSON.stringify(typeof n)+"."),0):!(n<0||n>1)||(r.a.warn("[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got "+n+"."),0))?s?(t.sampled=Math.random()<s,t.sampled?(r.a.log("[Tracing] starting "+t.op+" transaction - "+t.name),t):(r.a.log("[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = "+Number(s)+")"),t)):(r.a.log("[Tracing] Discarding transaction because "+("function"==typeof e.tracesSampler?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0")),t.sampled=!1,t):(r.a.warn("[Tracing] Discarding transaction because of invalid sample rate."),t.sampled=!1,t)):(t.sampled=!1,t);var n,s}function m(t,e){var i,s,a=(null===(i=this.getClient())||void 0===i?void 0:i.getOptions())||{},r=new u.a(t,this);return(r=b(r,a,Object(n.a)({parentSampled:t.parentSampled,transactionContext:t},e))).sampled&&r.initSpanRecorder(null===(s=a._experiments)||void 0===s?void 0:s.maxSpans),r}function p(t,e,i,s,a){var r,o,c=(null===(r=t.getClient())||void 0===r?void 0:r.getOptions())||{},u=new l.b(e,t,i,s);return(u=b(u,c,Object(n.a)({parentSampled:e.parentSampled,transactionContext:e},a))).sampled&&u.initSpanRecorder(null===(o=c._experiments)||void 0===o?void 0:o.maxSpans),u}function g(){var e;(e=Object(s.c)()).__SENTRY__&&(e.__SENTRY__.extensions=e.__SENTRY__.extensions||{},e.__SENTRY__.extensions.startTransaction||(e.__SENTRY__.extensions.startTransaction=m),e.__SENTRY__.extensions.traceHeaders||(e.__SENTRY__.extensions.traceHeaders=h)),Object(o.b)()&&function(){var e=Object(s.c)();if(e.__SENTRY__){var i={mongodb:function(){return new(Object(o.a)(t,"./integrations/mongo").Mongo)},mongoose:function(){return new(Object(o.a)(t,"./integrations/mongo").Mongo)({mongoose:!0})},mysql:function(){return new(Object(o.a)(t,"./integrations/mysql").Mysql)},pg:function(){return new(Object(o.a)(t,"./integrations/postgres").Postgres)}},a=Object.keys(i).filter(function(t){return!!Object(o.c)(t)}).map(function(t){try{return i[t]()}catch(e){return}}).filter(function(t){return t});a.length>0&&(e.__SENTRY__.integrations=Object(n.f)(e.__SENTRY__.integrations||[],a))}}(),Object(c.a)()}}).call(this,i("3UD+")(t))},DH7j:function(t,e,i){"use strict";i.d(e,"a",function(){return n});const n=(()=>Array.isArray||(t=>t&&"number"==typeof t.length))()},EldZ:function(t,e,i){"use strict";i.d(e,"a",function(){return l});var n=i("wmvo"),s=i("lW6c"),a=i("9AQC"),r=i("8LbN"),o=i("6PXS"),c=i("SYqL"),l=function(t){function e(e,i){var n=t.call(this,e)||this;return n._measurements={},n._hub=Object(s.b)(),Object(a.g)(i,s.a)&&(n._hub=i),n.name=e.name||"",n.metadata=e.metadata||{},n._trimEnd=e.trimEnd,n.transaction=n,n}return Object(n.c)(e,t),e.prototype.setName=function(t){this.name=t},e.prototype.initSpanRecorder=function(t){void 0===t&&(t=1e3),this.spanRecorder||(this.spanRecorder=new c.b(t)),this.spanRecorder.add(this)},e.prototype.setMeasurements=function(t){this._measurements=Object(n.a)({},t)},e.prototype.setMetadata=function(t){this.metadata=Object(n.a)(Object(n.a)({},this.metadata),t)},e.prototype.finish=function(e){var i=this;if(void 0===this.endTimestamp){if(this.name||(r.a.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this.name="<unlabeled transaction>"),t.prototype.finish.call(this,e),!0===this.sampled){var n=this.spanRecorder?this.spanRecorder.spans.filter(function(t){return t!==i&&t.endTimestamp}):[];this._trimEnd&&n.length>0&&(this.endTimestamp=n.reduce(function(t,e){return t.endTimestamp&&e.endTimestamp?t.endTimestamp>e.endTimestamp?t:e:t}).endTimestamp);var s={contexts:{trace:this.getTraceContext()},spans:n,start_timestamp:this.startTimestamp,tags:this.tags,timestamp:this.endTimestamp,transaction:this.name,type:"transaction",debug_meta:this.metadata};return Object.keys(this._measurements).length>0&&(r.a.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),s.measurements=this._measurements),r.a.log("[Tracing] Finishing "+this.op+" transaction: "+this.name+"."),this._hub.captureEvent(s)}r.a.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled.")}},e.prototype.toContext=function(){var e=t.prototype.toContext.call(this);return Object(o.a)(Object(n.a)(Object(n.a)({},e),{name:this.name,trimEnd:this._trimEnd}))},e.prototype.updateWithContext=function(e){var i;return t.prototype.updateWithContext.call(this,e),this.name=null!=(i=e.name)?i:"",this._trimEnd=e.trimEnd,this},e}(c.a)},"F/b7":function(t,e){!function(){var t,e,i=i||function(t,e){var i={},n=i.lib={},s=function(){},a=n.Base={extend:function(t){s.prototype=this;var e=new s;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},r=n.WordArray=a.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||c).stringify(this)},concat:function(t){var e=this.words,i=t.words,n=this.sigBytes;if(t=t.sigBytes,this.clamp(),n%4)for(var s=0;s<t;s++)e[n+s>>>2]|=(i[s>>>2]>>>24-s%4*8&255)<<24-(n+s)%4*8;else if(65535<i.length)for(s=0;s<t;s+=4)e[n+s>>>2]=i[s>>>2];else e.push.apply(e,i);return this.sigBytes+=t,this},clamp:function(){var e=this.words,i=this.sigBytes;e[i>>>2]&=4294967295<<32-i%4*8,e.length=t.ceil(i/4)},clone:function(){var t=a.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var i=[],n=0;n<e;n+=4)i.push(4294967296*t.random()|0);return new r.init(i,e)}}),o=i.enc={},c=o.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var i=[],n=0;n<t;n++){var s=e[n>>>2]>>>24-n%4*8&255;i.push((s>>>4).toString(16)),i.push((15&s).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n+=2)i[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new r.init(i,e/2)}},l=o.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var i=[],n=0;n<t;n++)i.push(String.fromCharCode(e[n>>>2]>>>24-n%4*8&255));return i.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n++)i[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new r.init(i,e)}},u=o.Utf8={stringify:function(t){try{return decodeURIComponent(escape(l.stringify(t)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(t){return l.parse(unescape(encodeURIComponent(t)))}},d=n.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new r.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=u.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var i=this._data,n=i.words,s=i.sigBytes,a=this.blockSize,o=s/(4*a);if(o=e?t.ceil(o):t.max((0|o)-this._minBufferSize,0),s=t.min(4*(e=o*a),s),e){for(var c=0;c<e;c+=a)this._doProcessBlock(n,c);c=n.splice(0,e),i.sigBytes-=s}return new r.init(c,s)},clone:function(){var t=a.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});n.Hasher=d.extend({cfg:a.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,i){return new t.init(i).finalize(e)}},_createHmacHelper:function(t){return function(e,i){return new h.HMAC.init(t,i).finalize(e)}}});var h=i.algo={};return i}(Math);!function(t){for(var e=i,n=(a=e.lib).WordArray,s=a.Hasher,a=e.algo,r=[],o=[],c=function(t){return 4294967296*(t-(0|t))|0},l=2,u=0;64>u;){var d;t:{for(var h=t.sqrt(d=l),b=2;b<=h;b++)if(!(d%b)){d=!1;break t}d=!0}d&&(8>u&&(r[u]=c(t.pow(l,.5))),o[u]=c(t.pow(l,1/3)),u++),l++}var m=[];a=a.SHA256=s.extend({_doReset:function(){this._hash=new n.init(r.slice(0))},_doProcessBlock:function(t,e){for(var i=this._hash.words,n=i[0],s=i[1],a=i[2],r=i[3],c=i[4],l=i[5],u=i[6],d=i[7],h=0;64>h;h++){if(16>h)m[h]=0|t[e+h];else{var b=m[h-15],p=m[h-2];m[h]=((b<<25|b>>>7)^(b<<14|b>>>18)^b>>>3)+m[h-7]+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+m[h-16]}b=d+((c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25))+(c&l^~c&u)+o[h]+m[h],p=((n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22))+(n&s^n&a^s&a),d=u,u=l,l=c,c=r+b|0,r=a,a=s,s=n,n=b+p|0}i[0]=i[0]+n|0,i[1]=i[1]+s|0,i[2]=i[2]+a|0,i[3]=i[3]+r|0,i[4]=i[4]+c|0,i[5]=i[5]+l|0,i[6]=i[6]+u|0,i[7]=i[7]+d|0},_doFinalize:function(){var e=this._data,i=e.words,n=8*this._nDataBytes,s=8*e.sigBytes;return i[s>>>5]|=128<<24-s%32,i[14+(s+64>>>9<<4)]=t.floor(n/4294967296),i[15+(s+64>>>9<<4)]=n,e.sigBytes=4*i.length,this._process(),this._hash},clone:function(){var t=s.clone.call(this);return t._hash=this._hash.clone(),t}}),e.SHA256=s._createHelper(a),e.HmacSHA256=s._createHmacHelper(a)}(Math),t=i.enc.Utf8,i.algo.HMAC=i.lib.Base.extend({init:function(e,i){e=this._hasher=new e.init,"string"==typeof i&&(i=t.parse(i));var n=e.blockSize,s=4*n;i.sigBytes>s&&(i=e.finalize(i)),i.clamp();for(var a=this._oKey=i.clone(),r=this._iKey=i.clone(),o=a.words,c=r.words,l=0;l<n;l++)o[l]^=1549556828,c[l]^=909522486;a.sigBytes=r.sigBytes=s,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher;return t=e.finalize(t),e.reset(),e.finalize(this._oKey.clone().concat(t))}}),e=i.lib.WordArray,i.enc.Base64={stringify:function(t){var e=t.words,i=t.sigBytes,n=this._map;t.clamp(),t=[];for(var s=0;s<i;s+=3)for(var a=(e[s>>>2]>>>24-s%4*8&255)<<16|(e[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|e[s+2>>>2]>>>24-(s+2)%4*8&255,r=0;4>r&&s+.75*r<i;r++)t.push(n.charAt(a>>>6*(3-r)&63));if(e=n.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var i=(t=t.replace(/\s/g,"")).length,n=this._map;(s=n.charAt(64))&&-1!=(s=t.indexOf(s))&&(i=s);for(var s=[],a=0,r=0;r<i;r++)if(r%4){var o=n.indexOf(t.charAt(r-1))<<r%4*2,c=n.indexOf(t.charAt(r))>>>6-r%4*2;s[a>>>2]|=(o|c)<<24-a%4*8,a++}return e.create(s,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},window.CryptoJS=i}()},FGHR:function(t,e,i){"use strict";i.d(e,"c",function(){return a}),i.d(e,"a",function(){return r}),i.d(e,"b",function(){return o}),i.d(e,"d",function(){return c}),i.d(e,"e",function(){return l});var n=i("lW6c"),s=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function a(t){var e;return void 0===t&&(t=null===(e=Object(n.b)().getClient())||void 0===e?void 0:e.getOptions()),!!t&&("tracesSampleRate"in t||"tracesSampler"in t)}function r(t){var e=t.match(s);if(e){var i=void 0;return"1"===e[3]?i=!0:"0"===e[3]&&(i=!1),{traceId:e[1],parentSampled:i,parentSpanId:e[2]}}}function o(t){var e,i;return void 0===t&&(t=Object(n.b)()),null===(i=null===(e=t)||void 0===e?void 0:e.getScope())||void 0===i?void 0:i.getTransaction()}function c(t){return t/1e3}function l(t){return 1e3*t}},HDdC:function(t,e,i){"use strict";i.d(e,"a",function(){return l});var n=i("7o/Q"),s=i("2QA8"),a=i("gRHU"),r=i("kJWO"),o=i("SpAZ"),c=i("2fFW");let l=(()=>{class t{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(e){const i=new t;return i.source=this,i.operator=e,i}subscribe(t,e,i){const{operator:r}=this,o=function(t,e,i){if(t){if(t instanceof n.a)return t;if(t[s.a])return t[s.a]()}return t||e||i?new n.a(t,e,i):new n.a(a.a)}(t,e,i);if(o.add(r?r.call(o,this.source):this.source||c.a.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),c.a.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o}_trySubscribe(t){try{return this._subscribe(t)}catch(e){c.a.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:i,isStopped:s}=t;if(e||s)return!1;t=i&&i instanceof n.a?i:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=u(e))((e,i)=>{let n;n=this.subscribe(e=>{try{t(e)}catch(s){i(s),n&&n.unsubscribe()}},i,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[r.a](){return this}pipe(...t){return 0===t.length?this:(0===(e=t).length?o.a:1===e.length?e[0]:function(t){return e.reduce((t,e)=>e(t),t)})(this);var e}toPromise(t){return new(t=u(t))((t,e)=>{let i;this.subscribe(t=>i=t,t=>e(t),()=>t(i))})}}return t.create=e=>new t(e),t})();function u(t){if(t||(t=c.a.Promise||Promise),!t)throw new Error("no Promise impl found");return t}},HR75:function(t,e,i){"use strict";i.d(e,"a",function(){return a});var n,s=i("9AQC");!function(t){t.PENDING="PENDING",t.RESOLVED="RESOLVED",t.REJECTED="REJECTED"}(n||(n={}));var a=function(){function t(t){var e=this;this._state=n.PENDING,this._handlers=[],this._resolve=function(t){e._setResult(n.RESOLVED,t)},this._reject=function(t){e._setResult(n.REJECTED,t)},this._setResult=function(t,i){e._state===n.PENDING&&(Object(s.m)(i)?i.then(e._resolve,e._reject):(e._state=t,e._value=i,e._executeHandlers()))},this._attachHandler=function(t){e._handlers=e._handlers.concat(t),e._executeHandlers()},this._executeHandlers=function(){if(e._state!==n.PENDING){var t=e._handlers.slice();e._handlers=[],t.forEach(function(t){t.done||(e._state===n.RESOLVED&&t.onfulfilled&&t.onfulfilled(e._value),e._state===n.REJECTED&&t.onrejected&&t.onrejected(e._value),t.done=!0)})}};try{t(this._resolve,this._reject)}catch(i){this._reject(i)}}return t.resolve=function(e){return new t(function(t){t(e)})},t.reject=function(e){return new t(function(t,i){i(e)})},t.all=function(e){return new t(function(i,n){if(Array.isArray(e))if(0!==e.length){var s=e.length,a=[];e.forEach(function(e,r){t.resolve(e).then(function(t){a[r]=t,0==(s-=1)&&i(a)}).then(null,n)})}else i([]);else n(new TypeError("Promise.all requires an array as input."))})},t.prototype.then=function(e,i){var n=this;return new t(function(t,s){n._attachHandler({done:!1,onfulfilled:function(i){if(e)try{return void t(e(i))}catch(n){return void s(n)}else t(i)},onrejected:function(e){if(i)try{return void t(i(e))}catch(n){return void s(n)}else s(e)}})})},t.prototype.catch=function(t){return this.then(function(t){return t},t)},t.prototype.finally=function(e){var i=this;return new t(function(t,n){var s,a;return i.then(function(t){a=!1,s=t,e&&e()},function(t){a=!0,s=t,e&&e()}).then(function(){a?n(s):t(s)})})},t.prototype.toString=function(){return"[object SyncPromise]"},t}()},I55L:function(t,e,i){"use strict";i.d(e,"a",function(){return n});const n=t=>t&&"number"==typeof t.length&&"function"!=typeof t},KjyA:function(t,e,i){"use strict";i.d(e,"a",function(){return c}),i.d(e,"b",function(){return u});var n=i("wmvo"),s=i("9AQC"),a=i("kdvv"),r=i("HR75"),o=i("9/Zf"),c=function(){function t(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._user={},this._tags={},this._extra={},this._contexts={}}return t.clone=function(e){var i=new t;return e&&(i._breadcrumbs=Object(n.f)(e._breadcrumbs),i._tags=Object(n.a)({},e._tags),i._extra=Object(n.a)({},e._extra),i._contexts=Object(n.a)({},e._contexts),i._user=e._user,i._level=e._level,i._span=e._span,i._session=e._session,i._transactionName=e._transactionName,i._fingerprint=e._fingerprint,i._eventProcessors=Object(n.f)(e._eventProcessors),i._requestSession=e._requestSession),i},t.prototype.addScopeListener=function(t){this._scopeListeners.push(t)},t.prototype.addEventProcessor=function(t){return this._eventProcessors.push(t),this},t.prototype.setUser=function(t){return this._user=t||{},this._session&&this._session.update({user:t}),this._notifyScopeListeners(),this},t.prototype.getUser=function(){return this._user},t.prototype.getRequestSession=function(){return this._requestSession},t.prototype.setRequestSession=function(t){return this._requestSession=t,this},t.prototype.setTags=function(t){return this._tags=Object(n.a)(Object(n.a)({},this._tags),t),this._notifyScopeListeners(),this},t.prototype.setTag=function(t,e){var i;return this._tags=Object(n.a)(Object(n.a)({},this._tags),((i={})[t]=e,i)),this._notifyScopeListeners(),this},t.prototype.setExtras=function(t){return this._extra=Object(n.a)(Object(n.a)({},this._extra),t),this._notifyScopeListeners(),this},t.prototype.setExtra=function(t,e){var i;return this._extra=Object(n.a)(Object(n.a)({},this._extra),((i={})[t]=e,i)),this._notifyScopeListeners(),this},t.prototype.setFingerprint=function(t){return this._fingerprint=t,this._notifyScopeListeners(),this},t.prototype.setLevel=function(t){return this._level=t,this._notifyScopeListeners(),this},t.prototype.setTransactionName=function(t){return this._transactionName=t,this._notifyScopeListeners(),this},t.prototype.setTransaction=function(t){return this.setTransactionName(t)},t.prototype.setContext=function(t,e){var i;return null===e?delete this._contexts[t]:this._contexts=Object(n.a)(Object(n.a)({},this._contexts),((i={})[t]=e,i)),this._notifyScopeListeners(),this},t.prototype.setSpan=function(t){return this._span=t,this._notifyScopeListeners(),this},t.prototype.getSpan=function(){return this._span},t.prototype.getTransaction=function(){var t,e,i,n,s=this.getSpan();return(null===(t=s)||void 0===t?void 0:t.transaction)?null===(e=s)||void 0===e?void 0:e.transaction:(null===(n=null===(i=s)||void 0===i?void 0:i.spanRecorder)||void 0===n?void 0:n.spans[0])?s.spanRecorder.spans[0]:void 0},t.prototype.setSession=function(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this},t.prototype.getSession=function(){return this._session},t.prototype.update=function(e){if(!e)return this;if("function"==typeof e){var i=e(this);return i instanceof t?i:this}return e instanceof t?(this._tags=Object(n.a)(Object(n.a)({},this._tags),e._tags),this._extra=Object(n.a)(Object(n.a)({},this._extra),e._extra),this._contexts=Object(n.a)(Object(n.a)({},this._contexts),e._contexts),e._user&&Object.keys(e._user).length&&(this._user=e._user),e._level&&(this._level=e._level),e._fingerprint&&(this._fingerprint=e._fingerprint),e._requestSession&&(this._requestSession=e._requestSession)):Object(s.h)(e)&&(e=e,this._tags=Object(n.a)(Object(n.a)({},this._tags),e.tags),this._extra=Object(n.a)(Object(n.a)({},this._extra),e.extra),this._contexts=Object(n.a)(Object(n.a)({},this._contexts),e.contexts),e.user&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint&&(this._fingerprint=e.fingerprint),e.requestSession&&(this._requestSession=e.requestSession)),this},t.prototype.clear=function(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this},t.prototype.addBreadcrumb=function(t,e){var i="number"==typeof e?Math.min(e,100):100;if(i<=0)return this;var s=Object(n.a)({timestamp:Object(a.b)()},t);return this._breadcrumbs=Object(n.f)(this._breadcrumbs,[s]).slice(-i),this._notifyScopeListeners(),this},t.prototype.clearBreadcrumbs=function(){return this._breadcrumbs=[],this._notifyScopeListeners(),this},t.prototype.applyToEvent=function(t,e){var i;if(this._extra&&Object.keys(this._extra).length&&(t.extra=Object(n.a)(Object(n.a)({},this._extra),t.extra)),this._tags&&Object.keys(this._tags).length&&(t.tags=Object(n.a)(Object(n.a)({},this._tags),t.tags)),this._user&&Object.keys(this._user).length&&(t.user=Object(n.a)(Object(n.a)({},this._user),t.user)),this._contexts&&Object.keys(this._contexts).length&&(t.contexts=Object(n.a)(Object(n.a)({},this._contexts),t.contexts)),this._level&&(t.level=this._level),this._transactionName&&(t.transaction=this._transactionName),this._span){t.contexts=Object(n.a)({trace:this._span.getTraceContext()},t.contexts);var s=null===(i=this._span.transaction)||void 0===i?void 0:i.name;s&&(t.tags=Object(n.a)({transaction:s},t.tags))}return this._applyFingerprint(t),t.breadcrumbs=Object(n.f)(t.breadcrumbs||[],this._breadcrumbs),t.breadcrumbs=t.breadcrumbs.length>0?t.breadcrumbs:void 0,this._notifyEventProcessors(Object(n.f)(l(),this._eventProcessors),t,e)},t.prototype._notifyEventProcessors=function(t,e,i,a){var o=this;return void 0===a&&(a=0),new r.a(function(r,c){var l=t[a];if(null===e||"function"!=typeof l)r(e);else{var u=l(Object(n.a)({},e),i);Object(s.m)(u)?u.then(function(e){return o._notifyEventProcessors(t,e,i,a+1).then(r)}).then(null,c):o._notifyEventProcessors(t,u,i,a+1).then(r).then(null,c)}})},t.prototype._notifyScopeListeners=function(){var t=this;this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(function(e){e(t)}),this._notifyingListeners=!1)},t.prototype._applyFingerprint=function(t){t.fingerprint=t.fingerprint?Array.isArray(t.fingerprint)?t.fingerprint:[t.fingerprint]:[],this._fingerprint&&(t.fingerprint=t.fingerprint.concat(this._fingerprint)),t.fingerprint&&!t.fingerprint.length&&delete t.fingerprint},t}();function l(){var t=Object(o.e)();return t.__SENTRY__=t.__SENTRY__||{},t.__SENTRY__.globalEventProcessors=t.__SENTRY__.globalEventProcessors||[],t.__SENTRY__.globalEventProcessors}function u(t){l().push(t)}},Lhse:function(t,e,i){"use strict";function n(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}i.d(e,"a",function(){return s});const s=n()},MBYv:function(t,e,i){"use strict";i.d(e,"a",function(){return l}),i.d(e,"b",function(){return d});var n=i("wmvo"),s=i("kdvv"),a=i("8LbN"),r=i("SYqL"),o=i("bju/"),c=i("EldZ"),l=1e3,u=function(t){function e(e,i,n,s){void 0===n&&(n="");var a=t.call(this,s)||this;return a._pushActivity=e,a._popActivity=i,a.transactionSpanId=n,a}return Object(n.c)(e,t),e.prototype.add=function(e){var i=this;e.spanId!==this.transactionSpanId&&(e.finish=function(t){e.endTimestamp="number"==typeof t?t:Object(s.d)(),i._popActivity(e.spanId)},void 0===e.endTimestamp&&this._pushActivity(e.spanId)),t.prototype.add.call(this,e)},e}(r.b),d=function(t){function e(e,i,n,s){void 0===n&&(n=l),void 0===s&&(s=!1);var r=t.call(this,e,i)||this;return r._idleHub=i,r._idleTimeout=n,r._onScope=s,r.activities={},r._heartbeatTimer=0,r._heartbeatCounter=0,r._finished=!1,r._beforeFinishCallbacks=[],i&&s&&(h(i),a.a.log("Setting idle transaction on scope. Span ID: "+r.spanId),i.configureScope(function(t){return t.setSpan(r)})),r._initTimeout=setTimeout(function(){r._finished||r.finish()},r._idleTimeout),r}return Object(n.c)(e,t),e.prototype.finish=function(e){var i,r,c=this;if(void 0===e&&(e=Object(s.d)()),this._finished=!0,this.activities={},this.spanRecorder){a.a.log("[Tracing] finishing IdleTransaction",new Date(1e3*e).toISOString(),this.op);try{for(var l=Object(n.g)(this._beforeFinishCallbacks),u=l.next();!u.done;u=l.next())(0,u.value)(this,e)}catch(d){i={error:d}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(i)throw i.error}}this.spanRecorder.spans=this.spanRecorder.spans.filter(function(t){if(t.spanId===c.spanId)return!0;t.endTimestamp||(t.endTimestamp=e,t.setStatus(o.a.Cancelled),a.a.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(t,void 0,2)));var i=t.startTimestamp<e;return i||a.a.log("[Tracing] discarding Span since it happened after Transaction was finished",JSON.stringify(t,void 0,2)),i}),a.a.log("[Tracing] flushing IdleTransaction")}else a.a.log("[Tracing] No active IdleTransaction");return this._onScope&&h(this._idleHub),t.prototype.finish.call(this,e)},e.prototype.registerBeforeFinishCallback=function(t){this._beforeFinishCallbacks.push(t)},e.prototype.initSpanRecorder=function(t){var e=this;this.spanRecorder||(this.spanRecorder=new u(function(t){e._finished||e._pushActivity(t)},function(t){e._finished||e._popActivity(t)},this.spanId,t),a.a.log("Starting heartbeat"),this._pingHeartbeat()),this.spanRecorder.add(this)},e.prototype._pushActivity=function(t){this._initTimeout&&(clearTimeout(this._initTimeout),this._initTimeout=void 0),a.a.log("[Tracing] pushActivity: "+t),this.activities[t]=!0,a.a.log("[Tracing] new activities count",Object.keys(this.activities).length)},e.prototype._popActivity=function(t){var e=this;if(this.activities[t]&&(a.a.log("[Tracing] popActivity "+t),delete this.activities[t],a.a.log("[Tracing] new activities count",Object.keys(this.activities).length)),0===Object.keys(this.activities).length){var i=this._idleTimeout,n=Object(s.d)()+i/1e3;setTimeout(function(){e._finished||e.finish(n)},i)}},e.prototype._beat=function(){if(clearTimeout(this._heartbeatTimer),!this._finished){var t=Object.keys(this.activities),e=t.length?t.reduce(function(t,e){return t+e}):"";e===this._prevHeartbeatString?this._heartbeatCounter+=1:this._heartbeatCounter=1,this._prevHeartbeatString=e,this._heartbeatCounter>=3?(a.a.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus(o.a.DeadlineExceeded),this.setTag("heartbeat","failed"),this.finish()):this._pingHeartbeat()}},e.prototype._pingHeartbeat=function(){var t=this;a.a.log("pinging Heartbeat -> current counter: "+this._heartbeatCounter),this._heartbeatTimer=setTimeout(function(){t._beat()},5e3)},e}(c.a);function h(t){if(t){var e=t.getScope();e&&e.getTransaction()&&e.setSpan(void 0)}}},NJ4a:function(t,e,i){"use strict";function n(t){setTimeout(()=>{throw t},0)}i.d(e,"a",function(){return n})},RahF:function(t,e){!function(){var t=function(){};t.prototype={init:function(t){this.options=t,this.socketUrl=t.url,this.isArk="ark"==t.type,this.sendKeepAlive=!0,this.keepAliveTimeoutMs=this.isArk?54e4:3e4,this.sendConnectOpen=this.isArk,this.allowEmptyReplies=this.isArk,this.allowDeflate=this.isArk,this.pendingRequests={},this.requestCounter=0,this.connect()},buildServiceUrl:function(t,e){var i,n,s,a=e.key;return i=t?"live":"preview",n=e.credential&&0!==e.credential.length?e.credential:"device",e.secret&&(s=e.secret.indexOf(":"))>0&&(n="secure",a=e.secret.substr(0,s)+"/"+a),"ark"==e.type?"wss://"+e.key+".execute-api."+e.region+".amazonaws.com/"+i:"wss://"+i+"-"+a+".ws.gamesparks.net/ws/"+n+"/"+a},initPreview:function(t){t.url=this.buildServiceUrl(!1,t),this.init(t)},initLive:function(t){t.url=this.buildServiceUrl(!0,t),this.init(t)},reset:function(){this.initialised=!1,this.connected=!1,this.error=!1,this.disconnected=!1,null!=this.webSocket&&(this.webSocket.onclose=null,this.webSocket.close())},connect:function(){this.reset();try{this.webSocket=new WebSocket(this.socketUrl),this.webSocket.onopen=this.onWebSocketOpen.bind(this),this.webSocket.onclose=this.onWebSocketClose.bind(this),this.webSocket.onerror=this.onWebSocketError.bind(this),this.webSocket.onmessage=this.onWebSocketMessage.bind(this)}catch(t){this.log(t.message)}},disconnect:function(){this.webSocket&&this.connected&&(this.disconnected=!0,this.webSocket.close())},onWebSocketOpen:function(t){this.log("WebSocket onOpen"),this.options.onOpen&&this.options.onOpen(t),this.connected=!0,this.sendConnectOpen&&this.webSocketSend({"@class":".AuthenticatedConnectOpen"})},onWebSocketClose:function(t){this.log("WebSocket onClose"),this.options.onClose&&this.options.onClose(t),this.connected=!1,this.error||this.disconnected||this.connect()},onWebSocketError:function(t){this.log("WebSocket onError: Sorry, but there is some problem with your socket or the server is down"),this.options.onError&&this.options.onError(t),this.socketUrl=this.options.url,this.error=!0},processJsonMessage:function(t){var e;this.log("WebSocket onMessage: "+t.data);try{e=JSON.parse(t.data)}catch(s){return window.SystemLog&&window.SystemLog("[ERROR] GameSparks",t.data,s),console.warn("Response parsing error:",t,s),void this.log("An error ocurred while parsing the JSON Data: "+t+"; Error: "+s)}this.options.onMessage&&this.options.onMessage(e),e.authToken&&(this.authToken=e.authToken,delete e.authToken),e.connectUrl&&(this.socketUrl=e.connectUrl,this.connect());var i=e["@class"];if(".AuthenticatedConnectResponse"===i)this.handshake(e);else if(i.match(/Response$/)&&e.requestId){var n=e.requestId;delete e.requestId,this.pendingRequests[n]&&(this.pendingRequests[n](e),this.pendingRequests[n]=null)}},onWebSocketMessage:function(t){if(!this.allowEmptyReplies||t.data.length){if(!this.allowDeflate)return this.processJsonMessage(t);if(t.data.startsWith('{"'))return this.processJsonMessage(t);try{var e=atob(t.data),i=Uint8Array.from(e,t=>t.charCodeAt(0));let a=[],r=0;const o=new DecompressionStream("deflate");var n=o.writable.getWriter();n.write(i),n.close();const c=({done:t,value:e})=>{if(t){var i=new Uint8Array(r);let t=0;for(let n of a)i.set(n,t),t+=n.length;let e=(new TextDecoder).decode(i);return this.processJsonMessage({data:e})}return a.push(e),r+=e.length,s.read().then(c)};var s=o.readable.getReader();s.read().then(c)}catch(a){console.warn("Response decoding error:",t,a)}}},handshake:function(t){if(t.nonce){var e;this.options.onNonce?e=this.options.onNonce(t.nonce):this.options.secret&&(e=CryptoJS.enc.Base64.stringify(CryptoJS.HmacSHA256(t.nonce,this.options.secret)));var i={"@class":".AuthenticatedConnectRequest",hmac:e};this.authToken&&(i.authToken=this.authToken),this.sessionId&&(i.sessionId=this.sessionId);const n=this.getBrowserData();i.platform=n.browser,i.os=n.operatingSystem,this.webSocketSend(i)}else t.sessionId&&(this.sessionId=t.sessionId,this.initialised=!0,this.options.onInit&&this.options.onInit(),this.keepAliveInterval=window.setInterval(this.keepAlive.bind(this),this.keepAliveTimeoutMs))},keepAlive:function(){this.initialised&&this.connected&&this.sendKeepAlive&&this.webSocket.send(" ")},send:function(t,e){this.sendWithData(t,{},e)},sendWithData:function(t,e,i){if(!this.initialised)return i({error:{bad_value:{ucode:"bad_value",dcode:"socket.not_initialised"}}}),void location.reload();0!==t.indexOf(".")&&(t="."+t),e["@class"]=t,e.requestId=(new Date).getTime()+"_"+ ++this.requestCounter,null!=i&&(this.pendingRequests[e.requestId]=i,setTimeout((function(){this.pendingRequests[e.requestId]&&this.pendingRequests[e.requestId]({error:{bad_value:{ucode:"bad_value",dcode:"socket.no_response"}}})}).bind(this),32e3)),this.webSocketSend(e)},webSocketSend:function(t){this.options.onSend&&this.options.onSend(t);var e=JSON.stringify(t);this.log("WebSocket send: "+e),this.webSocket.send(e)},getSocketUrl:function(){return this.socketUrl},getSessionId:function(){return this.sessionId},getAuthToken:function(){return this.authToken},setAuthToken:function(t){this.authToken=t},isConnected:function(){return this.connected},log:function(t){this.options.logger&&this.options.logger(t)},getBrowserData:function(){var t=[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],e=[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}];function i(t){for(var e=0;e<t.length;e++){var i=t[e].string,n=t[e].prop;if(i){if(-1!==i.indexOf(t[e].subString))return t[e].identity}else if(n)return t[e].identity}}return{browser:i(t),operatingSystem:i(e)}}},console.log(t),window.GameSparks=t}()},SYqL:function(t,e,i){"use strict";i.d(e,"b",function(){return c}),i.d(e,"a",function(){return l});var n=i("wmvo"),s=i("9/Zf"),a=i("kdvv"),r=i("6PXS"),o=i("bju/"),c=function(){function t(t){void 0===t&&(t=1e3),this.spans=[],this._maxlen=t}return t.prototype.add=function(t){this.spans.length>this._maxlen?t.spanRecorder=void 0:this.spans.push(t)},t}(),l=function(){function t(t){if(this.traceId=Object(s.j)(),this.spanId=Object(s.j)().substring(16),this.startTimestamp=Object(a.d)(),this.tags={},this.data={},!t)return this;t.traceId&&(this.traceId=t.traceId),t.spanId&&(this.spanId=t.spanId),t.parentSpanId&&(this.parentSpanId=t.parentSpanId),"sampled"in t&&(this.sampled=t.sampled),t.op&&(this.op=t.op),t.description&&(this.description=t.description),t.data&&(this.data=t.data),t.tags&&(this.tags=t.tags),t.status&&(this.status=t.status),t.startTimestamp&&(this.startTimestamp=t.startTimestamp),t.endTimestamp&&(this.endTimestamp=t.endTimestamp)}return t.prototype.child=function(t){return this.startChild(t)},t.prototype.startChild=function(e){var i=new t(Object(n.a)(Object(n.a)({},e),{parentSpanId:this.spanId,sampled:this.sampled,traceId:this.traceId}));return i.spanRecorder=this.spanRecorder,i.spanRecorder&&i.spanRecorder.add(i),i.transaction=this.transaction,i},t.prototype.setTag=function(t,e){var i;return this.tags=Object(n.a)(Object(n.a)({},this.tags),((i={})[t]=e,i)),this},t.prototype.setData=function(t,e){var i;return this.data=Object(n.a)(Object(n.a)({},this.data),((i={})[t]=e,i)),this},t.prototype.setStatus=function(t){return this.status=t,this},t.prototype.setHttpStatus=function(t){this.setTag("http.status_code",String(t));var e=o.a.fromHttpCode(t);return e!==o.a.UnknownError&&this.setStatus(e),this},t.prototype.isSuccess=function(){return this.status===o.a.Ok},t.prototype.finish=function(t){this.endTimestamp="number"==typeof t?t:Object(a.d)()},t.prototype.toTraceparent=function(){var t="";return void 0!==this.sampled&&(t=this.sampled?"-1":"-0"),this.traceId+"-"+this.spanId+t},t.prototype.toContext=function(){return Object(r.a)({data:this.data,description:this.description,endTimestamp:this.endTimestamp,op:this.op,parentSpanId:this.parentSpanId,sampled:this.sampled,spanId:this.spanId,startTimestamp:this.startTimestamp,status:this.status,tags:this.tags,traceId:this.traceId})},t.prototype.updateWithContext=function(t){var e,i,n,s,a;return this.data=null!=(e=t.data)?e:{},this.description=t.description,this.endTimestamp=t.endTimestamp,this.op=t.op,this.parentSpanId=t.parentSpanId,this.sampled=t.sampled,this.spanId=null!=(i=t.spanId)?i:this.spanId,this.startTimestamp=null!=(n=t.startTimestamp)?n:this.startTimestamp,this.status=t.status,this.tags=null!=(s=t.tags)?s:{},this.traceId=null!=(a=t.traceId)?a:this.traceId,this},t.prototype.getTraceContext=function(){return Object(r.a)({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,trace_id:this.traceId})},t.prototype.toJSON=function(){return Object(r.a)({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,start_timestamp:this.startTimestamp,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this.endTimestamp,trace_id:this.traceId})},t}()},SeVD:function(t,e,i){"use strict";i.d(e,"a",function(){return u});var n=i("ngJS"),s=i("NJ4a"),a=i("Lhse"),r=i("kJWO"),o=i("I55L"),c=i("c2HN"),l=i("XoHu");const u=t=>{if(t&&"function"==typeof t[r.a])return u=t,t=>{const e=u[r.a]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(Object(o.a)(t))return Object(n.a)(t);if(Object(c.a)(t))return i=t,t=>(i.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,s.a),t);if(t&&"function"==typeof t[a.a])return e=t,t=>{const i=e[a.a]();for(;;){let e;try{e=i.next()}catch(n){return t.error(n),t}if(e.done){t.complete();break}if(t.next(e.value),t.closed)break}return"function"==typeof i.return&&t.add(()=>{i.return&&i.return()}),t};{const e=Object(l.a)(t)?"an invalid object":`'${t}'`;throw new TypeError(`You provided ${e} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var e,i,u}},SpAZ:function(t,e,i){"use strict";function n(t){return t}i.d(e,"a",function(){return n})},XNiG:function(t,e,i){"use strict";i.d(e,"b",function(){return l}),i.d(e,"a",function(){return u});var n=i("HDdC"),s=i("7o/Q"),a=i("quSY"),r=i("9ppp"),o=i("Ylt2"),c=i("2QA8");class l extends s.a{constructor(t){super(t),this.destination=t}}let u=(()=>{class t extends n.a{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[c.a](){return new l(this)}lift(t){const e=new d(this,this);return e.operator=t,e}next(t){if(this.closed)throw new r.a;if(!this.isStopped){const{observers:e}=this,i=e.length,n=e.slice();for(let s=0;s<i;s++)n[s].next(t)}}error(t){if(this.closed)throw new r.a;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,i=e.length,n=e.slice();for(let s=0;s<i;s++)n[s].error(t);this.observers.length=0}complete(){if(this.closed)throw new r.a;this.isStopped=!0;const{observers:t}=this,e=t.length,i=t.slice();for(let n=0;n<e;n++)i[n].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new r.a;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new r.a;return this.hasError?(t.error(this.thrownError),a.a.EMPTY):this.isStopped?(t.complete(),a.a.EMPTY):(this.observers.push(t),new o.a(this,t))}asObservable(){const t=new n.a;return t.source=this,t}}return t.create=(t,e)=>new d(t,e),t})();class d extends u{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):a.a.EMPTY}}},XoHu:function(t,e,i){"use strict";function n(t){return null!==t&&"object"==typeof t}i.d(e,"a",function(){return n})},Ylt2:function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n=i("quSY");class s extends n.a{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const i=e.indexOf(this.subscriber);-1!==i&&e.splice(i,1)}}},bHdf:function(t,e,i){"use strict";i.d(e,"a",function(){return a});var n=i("5+tZ"),s=i("SpAZ");function a(t=Number.POSITIVE_INFINITY){return Object(n.a)(s.a,t)}},"bju/":function(t,e,i){"use strict";var n;i.d(e,"a",function(){return n}),function(t){t.Ok="ok",t.DeadlineExceeded="deadline_exceeded",t.Unauthenticated="unauthenticated",t.PermissionDenied="permission_denied",t.NotFound="not_found",t.ResourceExhausted="resource_exhausted",t.InvalidArgument="invalid_argument",t.Unimplemented="unimplemented",t.Unavailable="unavailable",t.InternalError="internal_error",t.UnknownError="unknown_error",t.Cancelled="cancelled",t.AlreadyExists="already_exists",t.FailedPrecondition="failed_precondition",t.Aborted="aborted",t.OutOfRange="out_of_range",t.DataLoss="data_loss"}(n||(n={})),function(t){t.fromHttpCode=function(e){if(e<400)return t.Ok;if(e>=400&&e<500)switch(e){case 401:return t.Unauthenticated;case 403:return t.PermissionDenied;case 404:return t.NotFound;case 409:return t.AlreadyExists;case 413:return t.FailedPrecondition;case 429:return t.ResourceExhausted;default:return t.InvalidArgument}if(e>=500&&e<600)switch(e){case 501:return t.Unimplemented;case 503:return t.Unavailable;case 504:return t.DeadlineExceeded;default:return t.InternalError}return t.UnknownError}}(n||(n={}))},c2HN:function(t,e,i){"use strict";function n(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}i.d(e,"a",function(){return n})},crnd:function(t,e){function i(t){return Promise.resolve().then(function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}i.keys=function(){return[]},i.resolve=i,t.exports=i,i.id="crnd"},fXoL:function(t,e,i){"use strict";i.d(e,"a",function(){return Mi}),i.d(e,"b",function(){return Sb}),i.d(e,"c",function(){return vb}),i.d(e,"d",function(){return gb}),i.d(e,"e",function(){return fb}),i.d(e,"f",function(){return gm}),i.d(e,"g",function(){return rm}),i.d(e,"h",function(){return Rd}),i.d(e,"i",function(){return Qb}),i.d(e,"j",function(){return td}),i.d(e,"k",function(){return Lb}),i.d(e,"l",function(){return db}),i.d(e,"m",function(){return sd}),i.d(e,"n",function(){return ks}),i.d(e,"o",function(){return Ch}),i.d(e,"p",function(){return Ir}),i.d(e,"q",function(){return Zi}),i.d(e,"r",function(){return Ao}),i.d(e,"s",function(){return ji}),i.d(e,"t",function(){return Pr}),i.d(e,"u",function(){return hb}),i.d(e,"v",function(){return kd}),i.d(e,"w",function(){return wd}),i.d(e,"x",function(){return Cb}),i.d(e,"y",function(){return mb}),i.d(e,"z",function(){return Nd}),i.d(e,"A",function(){return cm}),i.d(e,"B",function(){return Ed}),i.d(e,"C",function(){return em}),i.d(e,"D",function(){return Eb}),i.d(e,"E",function(){return tn}),i.d(e,"F",function(){return wb}),i.d(e,"G",function(){return kb}),i.d(e,"H",function(){return rd}),i.d(e,"I",function(){return ad}),i.d(e,"J",function(){return Ts}),i.d(e,"K",function(){return cd}),i.d(e,"L",function(){return os}),i.d(e,"M",function(){return nn}),i.d(e,"N",function(){return dm}),i.d(e,"O",function(){return Md}),i.d(e,"P",function(){return qb}),i.d(e,"Q",function(){return Di}),i.d(e,"R",function(){return ld}),i.d(e,"S",function(){return Pd}),i.d(e,"T",function(){return U}),i.d(e,"U",function(){return im}),i.d(e,"V",function(){return Zb}),i.d(e,"W",function(){return w}),i.d(e,"X",function(){return Xb}),i.d(e,"Y",function(){return mm}),i.d(e,"Z",function(){return Gb}),i.d(e,"ab",function(){return Ib}),i.d(e,"bb",function(){return Lr}),i.d(e,"cb",function(){return Nl}),i.d(e,"db",function(){return as}),i.d(e,"eb",function(){return Un}),i.d(e,"fb",function(){return Tn}),i.d(e,"gb",function(){return Bn}),i.d(e,"hb",function(){return An}),i.d(e,"ib",function(){return Mn}),i.d(e,"jb",function(){return jn}),i.d(e,"kb",function(){return Qn}),i.d(e,"lb",function(){return Ql}),i.d(e,"mb",function(){return bm}),i.d(e,"nb",function(){return Al}),i.d(e,"ob",function(){return Dl}),i.d(e,"pb",function(){return xn}),i.d(e,"qb",function(){return $}),i.d(e,"rb",function(){return to}),i.d(e,"sb",function(){return Yo}),i.d(e,"tb",function(){return Ho}),i.d(e,"ub",function(){return Ml}),i.d(e,"vb",function(){return Nt}),i.d(e,"wb",function(){return y}),i.d(e,"xb",function(){return On}),i.d(e,"yb",function(){return Jr}),i.d(e,"zb",function(){return xt}),i.d(e,"Ab",function(){return Ku}),i.d(e,"Bb",function(){return Ia}),i.d(e,"Cb",function(){return co}),i.d(e,"Db",function(){return Bc}),i.d(e,"Eb",function(){return el}),i.d(e,"Fb",function(){return Oc}),i.d(e,"Gb",function(){return Uh}),i.d(e,"Hb",function(){return nt}),i.d(e,"Ib",function(){return dt}),i.d(e,"Jb",function(){return L}),i.d(e,"Kb",function(){return R}),i.d(e,"Lb",function(){return ct}),i.d(e,"Mb",function(){return ht}),i.d(e,"Nb",function(){return Eo}),i.d(e,"Ob",function(){return Jo}),i.d(e,"Pb",function(){return $o}),i.d(e,"Qb",function(){return zo}),i.d(e,"Rb",function(){return Uo}),i.d(e,"Sb",function(){return Go}),i.d(e,"Tb",function(){return wi}),i.d(e,"Ub",function(){return Ol}),i.d(e,"Vb",function(){return fn}),i.d(e,"Wb",function(){return Si}),i.d(e,"Xb",function(){return Yh}),i.d(e,"Yb",function(){return Wo}),i.d(e,"Zb",function(){return qh}),i.d(e,"ac",function(){return Ee}),i.d(e,"bc",function(){return ec}),i.d(e,"cc",function(){return fh}),i.d(e,"dc",function(){return vh}),i.d(e,"ec",function(){return yh}),i.d(e,"fc",function(){return _h}),i.d(e,"gc",function(){return kh}),i.d(e,"hc",function(){return sc}),i.d(e,"ic",function(){return nc}),i.d(e,"jc",function(){return Fo}),i.d(e,"kc",function(){return ac}),i.d(e,"lc",function(){return oc}),i.d(e,"mc",function(){return eh}),i.d(e,"nc",function(){return ih}),i.d(e,"oc",function(){return nh}),i.d(e,"pc",function(){return sh}),i.d(e,"qc",function(){return ah}),i.d(e,"rc",function(){return rh}),i.d(e,"sc",function(){return oh}),i.d(e,"tc",function(){return ch}),i.d(e,"uc",function(){return lh}),i.d(e,"vc",function(){return Eh}),i.d(e,"wc",function(){return To}),i.d(e,"xc",function(){return Ls}),i.d(e,"yc",function(){return Cs}),i.d(e,"zc",function(){return re}),i.d(e,"Ac",function(){return cs}),i.d(e,"Bc",function(){return ls}),i.d(e,"Cc",function(){return us}),i.d(e,"Dc",function(){return st}),i.d(e,"Ec",function(){return lt}),i.d(e,"Fc",function(){return Nh}),i.d(e,"Gc",function(){return Tc}),i.d(e,"Hc",function(){return ul}),i.d(e,"Ic",function(){return Rc}),i.d(e,"Jc",function(){return Oo}),i.d(e,"Kc",function(){return Hh}),i.d(e,"Lc",function(){return qc}),i.d(e,"Mc",function(){return Vc}),i.d(e,"Nc",function(){return $c}),i.d(e,"Oc",function(){return Gc}),i.d(e,"Pc",function(){return Hc}),i.d(e,"Qc",function(){return Fh});var n=i("XNiG"),s=i("quSY"),a=i("HDdC"),r=i("z+Ro"),o=i("bHdf"),c=i("yCtX"),l=i("7o/Q");function u(){return function(t){return t.lift(new d(t))}}class d{constructor(t){this.connectable=t}call(t,e){const{connectable:i}=this;i._refCount++;const n=new h(t,i),s=e.subscribe(n);return n.closed||(n.connection=i.connect()),s}}class h extends l.a{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:i}=this,n=t._connection;this.connection=null,!n||i&&n!==i||n.unsubscribe()}}class b extends a.a{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,t=this._connection=new s.a,t.add(this.source.subscribe(new p(this.getSubject(),this))),t.closed&&(this._connection=null,t=s.a.EMPTY)),t}refCount(){return u()(this)}}const m=(()=>{const t=b.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class p extends n.b{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}function g(){return new n.a}function f(t){for(let e in t)if(t[e]===f)return e;throw Error("Could not find renamed property on target object.")}function v(t,e){for(const i in e)e.hasOwnProperty(i)&&!t.hasOwnProperty(i)&&(t[i]=e[i])}function y(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(y).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return""+t.overriddenName;if(t.name)return""+t.name;const e=t.toString();if(null==e)return""+e;const i=e.indexOf("\n");return-1===i?e:e.substring(0,i)}function _(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const k=f({__forward_ref__:f});function w(t){return t.__forward_ref__=w,t.toString=function(){return y(this())},t}function S(t){return I(t)?t():t}function I(t){return"function"==typeof t&&t.hasOwnProperty(k)&&t.__forward_ref__===w}function C(t,e,i,n){throw new Error("ASSERTION ERROR: "+t+(null==n?"":` [Expected=> ${i} ${n} ${e} <=Actual]`))}function L(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function R(t){return{factory:t.factory,providers:t.providers||[],imports:t.imports||[]}}function O(t){return T(t,B)||T(t,M)}function T(t,e){return t.hasOwnProperty(e)?t[e]:null}function x(t){return t&&(t.hasOwnProperty(j)||t.hasOwnProperty(Q))?t[j]:null}const B=f({"\u0275prov":f}),j=f({"\u0275inj":f}),M=f({ngInjectableDef:f}),Q=f({ngInjectorDef:f});var A=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}({});let D;function E(t){const e=D;return D=t,e}function N(t,e,i){const n=O(t);if(n&&"root"==n.providedIn)return void 0===n.value?n.value=n.factory():n.value;if(i&A.Optional)return null;if(void 0!==e)return e;throw new Error(`Injector: NOT_FOUND [${y(t)}]`)}function F(t){return{toString:t}.toString()}var P=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}({}),U=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}({});const z="undefined"!=typeof globalThis&&globalThis,J="undefined"!=typeof window&&window,q="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,V="undefined"!=typeof global&&global,$=z||V||J||q,G={},H=[],Y=f({"\u0275cmp":f}),W=f({"\u0275dir":f}),K=f({"\u0275pipe":f}),X=f({"\u0275mod":f}),Z=f({"\u0275loc":f}),tt=f({"\u0275fac":f}),et=f({__NG_ELEMENT_ID__:f});let it=0;function nt(t){return F(()=>{const e={},i={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===P.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||H,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||U.Emulated,id:"c",styles:t.styles||H,_:null,setInput:null,schemas:t.schemas||null,tView:null},n=t.directives,s=t.features,a=t.pipes;return i.id+=it++,i.inputs=ut(t.inputs,e),i.outputs=ut(t.outputs),s&&s.forEach(t=>t(i)),i.directiveDefs=n?()=>("function"==typeof n?n():n).map(at):null,i.pipeDefs=a?()=>("function"==typeof a?a():a).map(rt):null,i})}function st(t,e,i){const n=t.\u0275cmp;n.directiveDefs=()=>e.map(at),n.pipeDefs=()=>i.map(rt)}function at(t){return bt(t)||mt(t)}function rt(t){return function(t){return t[K]||null}(t)}const ot={};function ct(t){const e={type:t.type,bootstrap:t.bootstrap||H,declarations:t.declarations||H,imports:t.imports||H,exports:t.exports||H,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&F(()=>{ot[t.id]=t.type}),e}function lt(t,e){return F(()=>{const i=pt(t,!0);i.declarations=e.declarations||H,i.imports=e.imports||H,i.exports=e.exports||H})}function ut(t,e){if(null==t)return G;const i={};for(const n in t)if(t.hasOwnProperty(n)){let s=t[n],a=s;Array.isArray(s)&&(a=s[1],s=s[0]),i[s]=n,e&&(e[s]=a)}return i}const dt=nt;function ht(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,onDestroy:t.type.prototype.ngOnDestroy||null}}function bt(t){return t[Y]||null}function mt(t){return t[W]||null}function pt(t,e){const i=t[X]||null;if(!i&&!0===e)throw new Error(`Type ${y(t)} does not have '\u0275mod' property.`);return i}const gt=20,ft=10;function vt(t){return Array.isArray(t)&&"object"==typeof t[1]}function yt(t){return Array.isArray(t)&&!0===t[1]}function _t(t){return 0!=(8&t.flags)}function kt(t){return 2==(2&t.flags)}function wt(t){return 1==(1&t.flags)}function St(t){return null!==t.template}function It(t,e){return t.hasOwnProperty(tt)?t[tt]:null}class Ct extends Error{constructor(t,e){super(function(t,e){return`${t?`NG0${t}: `:""}${e}`}(t,e)),this.code=t}}function Lt(t){return"string"==typeof t?t:null==t?"":String(t)}function Rt(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():Lt(t)}function Ot(t,e){const i=e?" in "+e:"";throw new Ct("201",`No provider for ${Rt(t)} found${i}`)}class Tt{constructor(t,e,i){this.previousValue=t,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function xt(){return Bt}function Bt(t){return t.type.prototype.ngOnChanges&&(t.setInput=Mt),jt}function jt(){const t=Qt(this),e=null==t?void 0:t.current;if(e){const i=t.previous;if(i===G)t.previous=e;else for(let t in e)i[t]=e[t];t.current=null,this.ngOnChanges(e)}}function Mt(t,e,i,n){const s=Qt(t)||function(t,e){return t.__ngSimpleChanges__=e}(t,{previous:G,current:null}),a=s.current||(s.current={}),r=s.previous,o=this.declaredInputs[i],c=r[o];a[o]=new Tt(c&&c.currentValue,e,r===G),t[n]=e}function Qt(t){return t.__ngSimpleChanges__||null}xt.ngInherit=!0;const At="http://www.w3.org/2000/svg",Dt="http://www.w3.org/1998/MathML/";let Et=void 0;function Nt(t){Et=t}function Ft(){return void 0!==Et?Et:"undefined"!=typeof document?document:void 0}function Pt(t){return!!t.listen}const Ut={createRenderer:(t,e)=>Ft()};function zt(t){for(;Array.isArray(t);)t=t[0];return t}function Jt(t,e){return zt(e[t])}function qt(t,e){return zt(e[t.index])}function Vt(t,e){return t.data[e]}function $t(t,e){return t[e]}function Gt(t,e){const i=e[t];return vt(i)?i:i[0]}function Ht(t){const e=function(t){return t.__ngContext__||null}(t);return e?Array.isArray(e)?e:e.lView:null}function Yt(t){return 4==(4&t[2])}function Wt(t){return 128==(128&t[2])}function Kt(t,e){return null==e?null:t[e]}function Xt(t){t[18]=0}function Zt(t,e){t[5]+=e;let i=t,n=t[3];for(;null!==n&&(1===e&&1===i[5]||-1===e&&0===i[5]);)n[5]+=e,i=n,n=n[3]}const te={lFrame:xe(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function ee(){return te.bindingsEnabled}function ie(){te.bindingsEnabled=!0}function ne(){te.bindingsEnabled=!1}function se(){return te.lFrame.lView}function ae(){return te.lFrame.tView}function re(t){te.lFrame.contextLView=t}function oe(){let t=ce();for(;null!==t&&64===t.type;)t=t.parent;return t}function ce(){return te.lFrame.currentTNode}function le(){const t=te.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function ue(t,e){const i=te.lFrame;i.currentTNode=t,i.isParent=e}function de(){return te.lFrame.isParent}function he(){te.lFrame.isParent=!1}function be(){return te.isInCheckNoChangesMode}function me(t){te.isInCheckNoChangesMode=t}function pe(){const t=te.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function ge(){return te.lFrame.bindingIndex}function fe(t){return te.lFrame.bindingIndex=t}function ve(){return te.lFrame.bindingIndex++}function ye(t){const e=te.lFrame,i=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,i}function _e(t){te.lFrame.inI18n=t}function ke(t,e){const i=te.lFrame;i.bindingIndex=i.bindingRootIndex=t,we(e)}function we(t){te.lFrame.currentDirectiveIndex=t}function Se(t){const e=te.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}function Ie(){return te.lFrame.currentQueryIndex}function Ce(t){te.lFrame.currentQueryIndex=t}function Le(t){const e=t[1];return 2===e.type?e.declTNode:1===e.type?t[6]:null}function Re(t,e,i){if(i&A.SkipSelf){let n=e,s=t;for(;n=n.parent,!(null!==n||i&A.Host||(n=Le(s),null===n)||(s=s[15],10&n.type)););if(null===n)return!1;e=n,t=s}const n=te.lFrame=Te();return n.currentTNode=e,n.lView=t,!0}function Oe(t){const e=Te(),i=t[1];te.lFrame=e,e.currentTNode=i.firstChild,e.lView=t,e.tView=i,e.contextLView=t,e.bindingIndex=i.bindingStartIndex,e.inI18n=!1}function Te(){const t=te.lFrame,e=null===t?null:t.child;return null===e?xe(t):e}function xe(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function Be(){const t=te.lFrame;return te.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const je=Be;function Me(){const t=Be();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Qe(){return te.lFrame.selectedIndex}function Ae(t){te.lFrame.selectedIndex=t}function De(){const t=te.lFrame;return Vt(t.tView,t.selectedIndex)}function Ee(){te.lFrame.currentNamespace=At}function Ne(){te.lFrame.currentNamespace=Dt}function Fe(){te.lFrame.currentNamespace=null}function Pe(t,e){for(let i=e.directiveStart,n=e.directiveEnd;i<n;i++){const e=t.data[i].type.prototype,{ngAfterContentInit:n,ngAfterContentChecked:s,ngAfterViewInit:a,ngAfterViewChecked:r,ngOnDestroy:o}=e;n&&(t.contentHooks||(t.contentHooks=[])).push(-i,n),s&&((t.contentHooks||(t.contentHooks=[])).push(i,s),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(i,s)),a&&(t.viewHooks||(t.viewHooks=[])).push(-i,a),r&&((t.viewHooks||(t.viewHooks=[])).push(i,r),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(i,r)),null!=o&&(t.destroyHooks||(t.destroyHooks=[])).push(i,o)}}function Ue(t,e,i){qe(t,e,3,i)}function ze(t,e,i,n){(3&t[2])===i&&qe(t,e,i,n)}function Je(t,e){let i=t[2];(3&i)===e&&(i&=2047,i+=1,t[2]=i)}function qe(t,e,i,n){const s=null!=n?n:-1,a=e.length-1;let r=0;for(let o=void 0!==n?65535&t[18]:0;o<a;o++)if("number"==typeof e[o+1]){if(r=e[o],null!=n&&r>=n)break}else e[o]<0&&(t[18]+=65536),(r<s||-1==s)&&(Ve(t,i,e,o),t[18]=(4294901760&t[18])+o+2),o++}function Ve(t,e,i,n){const s=i[n]<0,a=i[n+1],r=t[s?-i[n]:i[n]];s?t[2]>>11<t[18]>>16&&(3&t[2])===e&&(t[2]+=2048,a.call(r)):a.call(r)}const $e=-1;class Ge{constructor(t,e,i){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function He(t,e,i){const n=Pt(t);let s=0;for(;s<i.length;){const a=i[s];if("number"==typeof a){if(0!==a)break;s++;const r=i[s++],o=i[s++],c=i[s++];n?t.setAttribute(e,o,c,r):e.setAttributeNS(r,o,c)}else{const r=a,o=i[++s];We(r)?n&&t.setProperty(e,r,o):n?t.setAttribute(e,r,o):e.setAttribute(r,o),s++}}return s}function Ye(t){return 3===t||4===t||6===t}function We(t){return 64===t.charCodeAt(0)}function Ke(t,e){if(null===e||0===e.length);else if(null===t||0===t.length)t=e.slice();else{let i=-1;for(let n=0;n<e.length;n++){const s=e[n];"number"==typeof s?i=s:0===i||Xe(t,i,s,null,-1===i||2===i?e[++n]:null)}}return t}function Xe(t,e,i,n,s){let a=0,r=t.length;if(-1===e)r=-1;else for(;a<t.length;){const i=t[a++];if("number"==typeof i){if(i===e){r=-1;break}if(i>e){r=a-1;break}}}for(;a<t.length;){const e=t[a];if("number"==typeof e)break;if(e===i){if(null===n)return void(null!==s&&(t[a+1]=s));if(n===t[a+1])return void(t[a+2]=s)}a++,null!==n&&a++,null!==s&&a++}-1!==r&&(t.splice(r,0,e),a=r+1),t.splice(a++,0,i),null!==n&&t.splice(a++,0,n),null!==s&&t.splice(a++,0,s)}function Ze(t){return t!==$e}function ti(t){return 32767&t}function ei(t,e){let i=t>>16,n=e;for(;i>0;)n=n[15],i--;return n}let ii=!0;function ni(t){const e=ii;return ii=t,e}let si=0;function ai(t,e){const i=oi(t,e);if(-1!==i)return i;const n=e[1];n.firstCreatePass&&(t.injectorIndex=e.length,ri(n.data,t),ri(e,null),ri(n.blueprint,null));const s=ci(t,e),a=t.injectorIndex;if(Ze(s)){const t=ti(s),i=ei(s,e),n=i[1].data;for(let s=0;s<8;s++)e[a+s]=i[t+s]|n[t+s]}return e[a+8]=s,a}function ri(t,e){t.push(0,0,0,0,0,0,0,0,e)}function oi(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function ci(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let i=0,n=null,s=e;for(;null!==s;){const t=s[1],e=t.type;if(n=2===e?t.declTNode:1===e?s[6]:null,null===n)return $e;if(i++,s=s[15],-1!==n.injectorIndex)return n.injectorIndex|i<<16}return $e}function li(t,e,i){!function(t,e,i){let n;"string"==typeof i?n=i.charCodeAt(0)||0:i.hasOwnProperty(et)&&(n=i[et]),null==n&&(n=i[et]=si++);const s=255&n,a=1<<s,r=64&s,o=32&s,c=e.data;128&s?r?o?c[t+7]|=a:c[t+6]|=a:o?c[t+5]|=a:c[t+4]|=a:r?o?c[t+3]|=a:c[t+2]|=a:o?c[t+1]|=a:c[t]|=a}(t,e,i)}function ui(t,e,i){if(i&A.Optional)return t;Ot(e,"NodeInjector")}function di(t,e,i,n){if(i&A.Optional&&void 0===n&&(n=null),0==(i&(A.Self|A.Host))){const s=t[9],a=E(void 0);try{return s?s.get(e,n,i&A.Optional):N(e,n,i&A.Optional)}finally{E(a)}}return ui(n,e,i)}function hi(t,e,i,n=A.Default,s){if(null!==t){const a=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(et)?t[et]:void 0;return"number"==typeof e?e>=0?255&e:mi:e}(i);if("function"==typeof a){if(!Re(e,t,n))return n&A.Host?ui(s,i,n):di(e,i,n,s);try{const t=a();if(null!=t||n&A.Optional)return t;Ot(i)}finally{je()}}else if("number"==typeof a){let s=null,r=oi(t,e),o=$e,c=n&A.Host?e[16][6]:null;for((-1===r||n&A.SkipSelf)&&(o=-1===r?ci(t,e):e[r+8],o!==$e&&yi(n,!1)?(s=e[1],r=ti(o),e=ei(o,e)):r=-1);-1!==r;){const t=e[1];if(vi(a,r,t.data)){const t=pi(r,e,i,s,n,c);if(t!==bi)return t}o=e[r+8],o!==$e&&yi(n,e[1].data[r+8]===c)&&vi(a,r,e)?(s=t,r=ti(o),e=ei(o,e)):r=-1}}}return di(e,i,n,s)}const bi={};function mi(){return new _i(oe(),se())}function pi(t,e,i,n,s,a){const r=e[1],o=r.data[t+8],c=gi(o,r,i,null==n?kt(o)&&ii:n!=r&&0!=(3&o.type),s&A.Host&&a===o);return null!==c?fi(e,r,c,o):bi}function gi(t,e,i,n,s){const a=t.providerIndexes,r=e.data,o=1048575&a,c=t.directiveStart,l=a>>20,u=s?o+l:t.directiveEnd;for(let d=n?o:o+l;d<u;d++){const t=r[d];if(d<c&&i===t||d>=c&&t.type===i)return d}if(s){const t=r[c];if(t&&St(t)&&t.type===i)return c}return null}function fi(t,e,i,n){let s=t[i];const a=e.data;if(s instanceof Ge){const r=s;r.resolving&&function(t,e){throw new Ct("200","Circular dependency in DI detected for "+t)}(Rt(a[i]));const o=ni(r.canSeeViewProviders);r.resolving=!0;const c=r.injectImpl?E(r.injectImpl):null;Re(t,n,A.Default);try{s=t[i]=r.factory(void 0,a,t,n),e.firstCreatePass&&i>=n.directiveStart&&function(t,e,i){const{ngOnChanges:n,ngOnInit:s,ngDoCheck:a}=e.type.prototype;if(n){const n=Bt(e);(i.preOrderHooks||(i.preOrderHooks=[])).push(t,n),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(t,n)}s&&(i.preOrderHooks||(i.preOrderHooks=[])).push(0-t,s),a&&((i.preOrderHooks||(i.preOrderHooks=[])).push(t,a),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(t,a))}(i,a[i],e)}finally{null!==c&&E(c),ni(o),r.resolving=!1,je()}}return s}function vi(t,e,i){const n=64&t,s=32&t;let a;return a=128&t?n?s?i[e+7]:i[e+6]:s?i[e+5]:i[e+4]:n?s?i[e+3]:i[e+2]:s?i[e+1]:i[e],!!(a&1<<t)}function yi(t,e){return!(t&A.Self||t&A.Host&&e)}class _i{constructor(t,e){this._tNode=t,this._lView=e}get(t,e){return hi(this._tNode,this._lView,t,void 0,e)}}function ki(t){const e=t;if(I(t))return()=>{const t=ki(S(e));return t?t():null};let i=It(e);if(null===i){const t=x(e);i=t&&t.factory}return i||null}function wi(t){return F(()=>{const e=t.prototype.constructor,i=e[tt]||ki(e),n=Object.prototype;let s=Object.getPrototypeOf(t.prototype).constructor;for(;s&&s!==n;){const t=s[tt]||ki(s);if(t&&t!==i)return t;s=Object.getPrototypeOf(s)}return t=>new t})}function Si(t){return function(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const i=t.attrs;if(i){const t=i.length;let n=0;for(;n<t;){const s=i[n];if(Ye(s))break;if(0===s)n+=2;else if("number"==typeof s)for(n++;n<t&&"string"==typeof i[n];)n++;else{if(s===e)return i[n+1];n+=2}}}return null}(oe(),t)}const Ii="__annotations__",Ci="__parameters__",Li="__prop__metadata__";function Ri(t,e,i,n,s){return F(()=>{const a=Oi(e);function r(...t){if(this instanceof r)return a.call(this,...t),this;const e=new r(...t);return function(i){return s&&s(i,...t),(i.hasOwnProperty(Ii)?i[Ii]:Object.defineProperty(i,Ii,{value:[]})[Ii]).push(e),n&&n(i),i}}return i&&(r.prototype=Object.create(i.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}function Oi(t){return function(...e){if(t){const i=t(...e);for(const t in i)this[t]=i[t]}}}function Ti(t,e,i){return F(()=>{const n=Oi(e);function s(...t){if(this instanceof s)return n.apply(this,t),this;const e=new s(...t);return i.annotation=e,i;function i(t,i,n){const s=t.hasOwnProperty(Ci)?t[Ci]:Object.defineProperty(t,Ci,{value:[]})[Ci];for(;s.length<=n;)s.push(null);return(s[n]=s[n]||[]).push(e),t}}return i&&(s.prototype=Object.create(i.prototype)),s.prototype.ngMetadataName=t,s.annotationCls=s,s})}function xi(t,e,i,n){return F(()=>{const s=Oi(e);function a(...t){if(this instanceof a)return s.apply(this,t),this;const e=new a(...t);return function(i,s){const a=i.constructor,r=a.hasOwnProperty(Li)?a[Li]:Object.defineProperty(a,Li,{value:{}})[Li];r[s]=r.hasOwnProperty(s)&&r[s]||[],r[s].unshift(e),n&&n(i,s,...t)}}return i&&(a.prototype=Object.create(i.prototype)),a.prototype.ngMetadataName=t,a.annotationCls=a,a})}const Bi=function(){return Ti("Attribute",t=>({attributeName:t,__NG_ELEMENT_ID__:()=>Si(t)}))}();class ji{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=L({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return"InjectionToken "+this._desc}}const Mi=new ji("AnalyzeForEntryComponents");var Qi=function(t){return t[t.Token=0]="Token",t[t.Attribute=1]="Attribute",t[t.ChangeDetectorRef=2]="ChangeDetectorRef",t[t.Invalid=3]="Invalid",t}({});function Ai(){const t=$.ng;if(!t||!t.\u0275compilerFacade)throw new Error("Angular JIT compilation failed: '@angular/compiler' not loaded!\n  - JIT compilation is discouraged for production use-cases! Consider AOT mode instead.\n  - Did you bootstrap using '@angular/platform-browser-dynamic' or '@angular/platform-server'?\n  - Alternatively provide the compiler with 'import \"@angular/compiler\";' before bootstrapping.");return t.\u0275compilerFacade}const Di=Function;function Ei(t){return"function"==typeof t}function Ni(t,e){void 0===e&&(e=t);for(let i=0;i<t.length;i++){let n=t[i];Array.isArray(n)?(e===t&&(e=t.slice(0,i)),Ni(n,e)):e!==t&&e.push(n)}return e}function Fi(t,e){t.forEach(t=>Array.isArray(t)?Fi(t,e):e(t))}function Pi(t,e,i){e>=t.length?t.push(i):t.splice(e,0,i)}function Ui(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function zi(t,e){const i=[];for(let n=0;n<t;n++)i.push(e);return i}function Ji(t,e,i){let n=Vi(t,e);return n>=0?t[1|n]=i:(n=~n,function(t,e,i,n){let s=t.length;if(s==e)t.push(i,n);else if(1===s)t.push(n,t[0]),t[0]=i;else{for(s--,t.push(t[s-1],t[s]);s>e;)t[s]=t[s-2],s--;t[e]=i,t[e+1]=n}}(t,n,e,i)),n}function qi(t,e){const i=Vi(t,e);if(i>=0)return t[1|i]}function Vi(t,e){return function(t,e,i){let n=0,s=t.length>>1;for(;s!==n;){const i=n+(s-n>>1),a=t[i<<1];if(e===a)return i<<1;a>e?s=i:n=i+1}return~(s<<1)}(t,e)}const $i=/^function\s+\S+\(\)\s*{[\s\S]+\.apply\(this,\s*(arguments|[^()]+\(arguments\))\)/,Gi=/^class\s+[A-Za-z\d$_]*\s*extends\s+[^{]+{/,Hi=/^class\s+[A-Za-z\d$_]*\s*extends\s+[^{]+{[\s\S]*constructor\s*\(/,Yi=/^class\s+[A-Za-z\d$_]*\s*extends\s+[^{]+{[\s\S]*constructor\s*\(\)\s*{\s*super\(\.\.\.arguments\)/;class Wi{constructor(t){this._reflect=t||$.Reflect}isReflectionEnabled(){return!0}factory(t){return(...e)=>new t(...e)}_zipTypesAndAnnotations(t,e){let i;i=zi(void 0===t?e.length:t.length);for(let n=0;n<i.length;n++)i[n]=void 0===t?[]:t[n]&&t[n]!=Object?[t[n]]:[],e&&null!=e[n]&&(i[n]=i[n].concat(e[n]));return i}_ownParameters(t,e){if(i=t.toString(),$i.test(i)||Yi.test(i)||Gi.test(i)&&!Hi.test(i))return null;var i;if(t.parameters&&t.parameters!==e.parameters)return t.parameters;const n=t.ctorParameters;if(n&&n!==e.ctorParameters){const t="function"==typeof n?n():n,e=t.map(t=>t&&t.type),i=t.map(t=>t&&Ki(t.decorators));return this._zipTypesAndAnnotations(e,i)}const s=t.hasOwnProperty(Ci)&&t[Ci],a=this._reflect&&this._reflect.getOwnMetadata&&this._reflect.getOwnMetadata("design:paramtypes",t);return a||s?this._zipTypesAndAnnotations(a,s):zi(t.length)}parameters(t){if(!Ei(t))return[];const e=Xi(t);let i=this._ownParameters(t,e);return i||e===Object||(i=this.parameters(e)),i||[]}_ownAnnotations(t,e){if(t.annotations&&t.annotations!==e.annotations){let e=t.annotations;return"function"==typeof e&&e.annotations&&(e=e.annotations),e}return t.decorators&&t.decorators!==e.decorators?Ki(t.decorators):t.hasOwnProperty(Ii)?t[Ii]:null}annotations(t){if(!Ei(t))return[];const e=Xi(t),i=this._ownAnnotations(t,e)||[];return(e!==Object?this.annotations(e):[]).concat(i)}_ownPropMetadata(t,e){if(t.propMetadata&&t.propMetadata!==e.propMetadata){let e=t.propMetadata;return"function"==typeof e&&e.propMetadata&&(e=e.propMetadata),e}if(t.propDecorators&&t.propDecorators!==e.propDecorators){const e=t.propDecorators,i={};return Object.keys(e).forEach(t=>{i[t]=Ki(e[t])}),i}return t.hasOwnProperty(Li)?t[Li]:null}propMetadata(t){if(!Ei(t))return{};const e=Xi(t),i={};if(e!==Object){const t=this.propMetadata(e);Object.keys(t).forEach(e=>{i[e]=t[e]})}const n=this._ownPropMetadata(t,e);return n&&Object.keys(n).forEach(t=>{const e=[];i.hasOwnProperty(t)&&e.push(...i[t]),e.push(...n[t]),i[t]=e}),i}ownPropMetadata(t){return Ei(t)&&this._ownPropMetadata(t,Xi(t))||{}}hasLifecycleHook(t,e){return t instanceof Di&&e in t.prototype}guards(t){return{}}getter(t){return new Function("o","return o."+t+";")}setter(t){return new Function("o","v","return o."+t+" = v;")}method(t){return new Function("o","args",`if (!o.${t}) throw new Error('"${t}" is undefined');\n        return o.${t}.apply(o, args);`)}importUri(t){return"object"==typeof t&&t.filePath?t.filePath:"./"+y(t)}resourceUri(t){return"./"+y(t)}resolveIdentifier(t,e,i,n){return n}resolveEnum(t,e){return t[e]}}function Ki(t){return t?t.map(t=>new(0,t.type.annotationCls)(...t.args?t.args:[])):[]}function Xi(t){const e=t.prototype?Object.getPrototypeOf(t.prototype):null;return(e?e.constructor:null)||Object}const Zi=Ti("Inject",t=>({token:t})),tn=Ti("Optional"),en=Ti("Self"),nn=Ti("SkipSelf"),sn=Ti("Host");let an=null;function rn(){return an=an||new Wi}function on(t){return cn(rn().parameters(t))}function cn(t){const e=Ai();return t.map(t=>function(t,e){const i={token:null,host:!1,optional:!1,resolved:t.R3ResolvedDependencyType.Token,self:!1,skipSelf:!1};function n(e){i.resolved=t.R3ResolvedDependencyType.Token,i.token=e}if(Array.isArray(e)&&e.length>0)for(let s=0;s<e.length;s++){const a=e[s];if(void 0===a)continue;const r=Object.getPrototypeOf(a);if(a instanceof tn||"Optional"===r.ngMetadataName)i.optional=!0;else if(a instanceof nn||"SkipSelf"===r.ngMetadataName)i.skipSelf=!0;else if(a instanceof en||"Self"===r.ngMetadataName)i.self=!0;else if(a instanceof sn||"Host"===r.ngMetadataName)i.host=!0;else if(a instanceof Zi)i.token=a.token;else if(a instanceof Bi){if(void 0===a.attributeName)throw new Error("Attribute name must be defined.");i.token=a.attributeName,i.resolved=t.R3ResolvedDependencyType.Attribute}else!0===a.__ChangeDetectorRef__?(i.token=a,i.resolved=t.R3ResolvedDependencyType.ChangeDetectorRef):n(a)}else void 0===e||Array.isArray(e)&&0===e.length?(i.token=void 0,i.resolved=Qi.Invalid):n(e);return i}(e,t))}const ln={},un=/\n/gm,dn="__source",hn=f({provide:String,useValue:f});let bn,mn=void 0;function pn(t){const e=mn;return mn=t,e}function gn(t,e=A.Default){if(void 0===mn)throw new Error("inject() must be called from an injection context");return null===mn?N(t,void 0,e):mn.get(t,e&A.Optional?null:void 0,e)}function fn(t,e=A.Default){return(D||gn)(S(t),e)}function vn(t){throw new Error("invalid")}function yn(t){const e=[];for(let i=0;i<t.length;i++){const n=S(t[i]);if(Array.isArray(n)){if(0===n.length)throw new Error("Arguments array must have arguments.");let t=void 0,i=A.Default;for(let e=0;e<n.length;e++){const s=n[e];s instanceof tn||"Optional"===s.ngMetadataName||s===tn?i|=A.Optional:s instanceof nn||"SkipSelf"===s.ngMetadataName||s===nn?i|=A.SkipSelf:s instanceof en||"Self"===s.ngMetadataName||s===en?i|=A.Self:s instanceof sn||"Host"===s.ngMetadataName||s===sn?i|=A.Host:t=s instanceof Zi||s===Zi?s.token:s}e.push(fn(t,i))}else e.push(fn(n))}return e}function _n(){if(void 0===bn&&(bn=null,$.trustedTypes))try{bn=$.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch(t){}return bn}function kn(t){var e;return(null===(e=_n())||void 0===e?void 0:e.createHTML(t))||t}class wn{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return"SafeValue must use [property]=binding: "+this.changingThisBreaksApplicationSecurity+" (see https://g.co/ng/security#xss)"}}class Sn extends wn{getTypeName(){return"HTML"}}class In extends wn{getTypeName(){return"Style"}}class Cn extends wn{getTypeName(){return"Script"}}class Ln extends wn{getTypeName(){return"URL"}}class Rn extends wn{getTypeName(){return"ResourceURL"}}function On(t){return t instanceof wn?t.changingThisBreaksApplicationSecurity:t}function Tn(t,e){const i=xn(t);if(null!=i&&i!==e){if("ResourceURL"===i&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${i} (see https://g.co/ng/security#xss)`)}return i===e}function xn(t){return t instanceof wn&&t.getTypeName()||null}function Bn(t){return new Sn(t)}function jn(t){return new In(t)}function Mn(t){return new Cn(t)}function Qn(t){return new Ln(t)}function An(t){return new Rn(t)}function Dn(t){const e=new Nn(t);return function(){try{return!!(new window.DOMParser).parseFromString(kn(""),"text/html")}catch(t){return!1}}()?new En(e):e}class En{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(kn(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch(e){return null}}}class Nn{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t);const e=this.inertDocument.createElement("body");t.appendChild(e)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=kn(t),e;const i=this.inertDocument.createElement("body");return i.innerHTML=kn(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}stripCustomNsAttrs(t){const e=t.attributes;for(let n=e.length-1;0<n;n--){const i=e.item(n).name;"xmlns:ns1"!==i&&0!==i.indexOf("ns1:")||t.removeAttribute(i)}let i=t.firstChild;for(;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}const Fn=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Pn=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Un(t){return(t=String(t)).match(Fn)||t.match(Pn)?t:"unsafe:"+t}function zn(t){return(t=String(t)).split(",").map(t=>Un(t.trim())).join(", ")}function Jn(t){const e={};for(const i of t.split(","))e[i]=!0;return e}function qn(...t){const e={};for(const i of t)for(const t in i)i.hasOwnProperty(t)&&(e[t]=!0);return e}const Vn=Jn("area,br,col,hr,img,wbr"),$n=Jn("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Gn=Jn("rp,rt"),Hn=qn(Gn,$n),Yn=qn(Vn,qn($n,Jn("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),qn(Gn,Jn("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Hn),Wn=Jn("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Kn=Jn("srcset"),Xn=qn(Wn,Kn,Jn("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Jn("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Zn=Jn("script,style,template");class ts{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,i=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?i=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,i&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let t=this.checkClobberedElement(e,e.nextSibling);if(t){e=t;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!Yn.hasOwnProperty(e))return this.sanitizedSomething=!0,!Zn.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const i=t.attributes;for(let n=0;n<i.length;n++){const t=i.item(n),e=t.name,s=e.toLowerCase();if(!Xn.hasOwnProperty(s)){this.sanitizedSomething=!0;continue}let a=t.value;Wn[s]&&(a=Un(a)),Kn[s]&&(a=zn(a)),this.buf.push(" ",e,'="',ns(a),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();Yn.hasOwnProperty(e)&&!Vn.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(ns(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: "+t.outerHTML);return e}}const es=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,is=/([^\#-~ |!])/g;function ns(t){return t.replace(/&/g,"&amp;").replace(es,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(is,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let ss;function as(t,e){let i=null;try{ss=ss||Dn(t);let n=e?String(e):"";i=ss.getInertBodyElement(n);let s=5,a=n;do{if(0===s)throw new Error("Failed to sanitize html because the input is unstable");s--,n=a,a=i.innerHTML,i=ss.getInertBodyElement(n)}while(n!==a);return(new ts).sanitizeChildren(rs(i)||i)}finally{if(i){const t=rs(i)||i;for(;t.firstChild;)t.removeChild(t.firstChild)}}}function rs(t){return"content"in t&&function(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var os=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}({});function cs(t){const e=fs();return e?e.sanitize(os.HTML,t)||"":Tn(t,"HTML")?On(t):as(Ft(),Lt(t))}function ls(t){const e=fs();return e?e.sanitize(os.STYLE,t)||"":Tn(t,"Style")?On(t):Lt(t)}function us(t){const e=fs();return e?e.sanitize(os.URL,t)||"":Tn(t,"URL")?On(t):Un(Lt(t))}function ds(t){const e=fs();if(e)return e.sanitize(os.RESOURCE_URL,t)||"";if(Tn(t,"ResourceURL"))return On(t);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)")}function hs(t){const e=fs();if(e)return e.sanitize(os.SCRIPT,t)||"";if(Tn(t,"Script"))return On(t);throw new Error("unsafe value used in a script context")}function bs(t){return kn(t)}function ms(t){return function(t){var e;return(null===(e=_n())||void 0===e?void 0:e.createScript(t))||t}(t)}function ps(t){return function(t){var e;return(null===(e=_n())||void 0===e?void 0:e.createScriptURL(t))||t}(t)}function gs(t,e,i){return function(t,e){return"src"===e&&("embed"===t||"frame"===t||"iframe"===t||"media"===t||"script"===t)||"href"===e&&("base"===t||"link"===t)?ds:us}(e,i)(t)}function fs(){const t=se();return t&&t[12]}function vs(t){return t.ngDebugContext}function ys(t){return t.ngOriginalError}function _s(t,...e){t.error(...e)}class ks{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),i=this._findContext(t),n=function(t){return t.ngErrorLogger||_s}(t);n(this._console,"ERROR",t),e&&n(this._console,"ORIGINAL ERROR",e),i&&n(this._console,"ERROR CONTEXT",i)}_findContext(t){return t?vs(t)?vs(t):this._findContext(ys(t)):null}_findOriginalError(t){let e=ys(t);for(;e&&ys(e);)e=ys(e);return e}}const ws=/-->/g;function Ss(t,e){t.__ngContext__=e}const Is=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind($))();function Cs(t){return{name:"window",target:t.ownerDocument.defaultView}}function Ls(t){return{name:"document",target:t.ownerDocument}}function Rs(t){return{name:"body",target:t.ownerDocument.body}}function Os(t){return t instanceof Function?t():t}var Ts=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}({});let xs;function Bs(t,e){return xs(t,e)}function js(t){const e=t[3];return yt(e)?e[3]:e}function Ms(t){return As(t[13])}function Qs(t){return As(t[4])}function As(t){for(;null!==t&&!yt(t);)t=t[4];return t}function Ds(t,e,i,n,s){if(null!=n){let a,r=!1;yt(n)?a=n:vt(n)&&(r=!0,n=n[0]);const o=zt(n);0===t&&null!==i?null==s?Hs(e,i,o):Gs(e,i,o,s||null,!0):1===t&&null!==i?Gs(e,i,o,s||null,!0):2===t?aa(e,o,r):3===t&&e.destroyNode(o),null!=a&&function(t,e,i,n,s){const a=i[7];a!==zt(i)&&Ds(e,t,n,a,s);for(let r=ft;r<i.length;r++){const s=i[r];oa(s[1],s,t,e,n,a)}}(e,t,a,i,s)}}function Es(t,e){return Pt(t)?t.createText(e):t.createTextNode(e)}function Ns(t,e,i){Pt(t)?t.setValue(e,i):e.textContent=i}function Fs(t,e){return t.createComment(function(t){return t.replace(ws,"-\u200b-\u200b>")}(e))}function Ps(t,e,i){return Pt(t)?t.createElement(e,i):null===i?t.createElement(e):t.createElementNS(i,e)}function Us(t,e){const i=t[9],n=i.indexOf(e),s=e[3];1024&e[2]&&(e[2]&=-1025,Zt(s,-1)),i.splice(n,1)}function zs(t,e){if(t.length<=ft)return;const i=ft+e,n=t[i];if(n){const a=n[17];null!==a&&a!==t&&Us(a,n),e>0&&(t[i-1][4]=n[4]);const r=Ui(t,ft+e);oa(n[1],s=n,s[11],2,null,null),s[0]=null,s[6]=null;const o=r[19];null!==o&&o.detachView(r[1]),n[3]=null,n[4]=null,n[2]&=-129}var s;return n}function Js(t,e){if(!(256&e[2])){const i=e[11];Pt(i)&&i.destroyNode&&oa(t,e,i,3,null,null),function(t){let e=t[13];if(!e)return qs(t[1],t);for(;e;){let i=null;if(vt(e))i=e[13];else{const t=e[10];t&&(i=t)}if(!i){for(;e&&!e[4]&&e!==t;)vt(e)&&qs(e[1],e),e=e[3];null===e&&(e=t),vt(e)&&qs(e[1],e),i=e&&e[4]}e=i}}(e)}}function qs(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){let i;if(null!=t&&null!=(i=t.destroyHooks))for(let n=0;n<i.length;n+=2){const t=e[i[n]];if(!(t instanceof Ge)){const e=i[n+1];if(Array.isArray(e))for(let i=0;i<e.length;i+=2)e[i+1].call(t[e[i]]);else e.call(t)}}}(t,e),function(t,e){const i=t.cleanup,n=e[7];let s=-1;if(null!==i)for(let a=0;a<i.length-1;a+=2)if("string"==typeof i[a]){const t=i[a+1],r="function"==typeof t?t(e):zt(e[t]),o=n[s=i[a+2]],c=i[a+3];"boolean"==typeof c?r.removeEventListener(i[a],o,c):c>=0?n[s=c]():n[s=-c].unsubscribe(),a+=2}else{const t=n[s=i[a+1]];i[a].call(t)}if(null!==n){for(let t=s+1;t<n.length;t++)(0,n[t])();e[7]=null}}(t,e),1===e[1].type&&Pt(e[11])&&e[11].destroy();const i=e[17];if(null!==i&&yt(e[3])){i!==e[3]&&Us(i,e);const n=e[19];null!==n&&n.detachView(t)}}}function Vs(t,e,i){return $s(t,e.parent,i)}function $s(t,e,i){let n=e;for(;null!==n&&40&n.type;)n=(e=n).parent;if(null===n)return i[0];if(2&n.flags){const e=t.data[n.directiveStart].encapsulation;if(e===U.None||e===U.Emulated)return null}return qt(n,i)}function Gs(t,e,i,n,s){Pt(t)?t.insertBefore(e,i,n,s):e.insertBefore(i,n,s)}function Hs(t,e,i){Pt(t)?t.appendChild(e,i):e.appendChild(i)}function Ys(t,e,i,n,s){null!==n?Gs(t,e,i,n,s):Hs(t,e,i)}function Ws(t,e){return Pt(t)?t.parentNode(e):e.parentNode}function Ks(t,e,i){return ta(t,e,i)}function Xs(t,e,i){return 40&t.type?qt(t,i):null}let Zs,ta=Xs;function ea(t,e){ta=t,Zs=e}function ia(t,e,i,n){const s=Vs(t,n,e),a=e[11],r=Ks(n.parent||e[6],n,e);if(null!=s)if(Array.isArray(i))for(let o=0;o<i.length;o++)Ys(a,s,i[o],r,!1);else Ys(a,s,i,r,!1);void 0!==Zs&&Zs(a,n,e,i,s)}function na(t,e){if(null!==e){const i=e.type;if(3&i)return qt(e,t);if(4&i)return sa(-1,t[e.index]);if(8&i){const i=e.child;if(null!==i)return na(t,i);{const i=t[e.index];return yt(i)?sa(-1,i):zt(i)}}if(32&i)return Bs(e,t)()||zt(t[e.index]);{const i=t[16],n=i[6],s=js(i),a=n.projection[e.projection];return null!=a?na(s,a):na(t,e.next)}}return null}function sa(t,e){const i=ft+t+1;if(i<e.length){const t=e[i],n=t[1].firstChild;if(null!==n)return na(t,n)}return e[7]}function aa(t,e,i){const n=Ws(t,e);n&&function(t,e,i,n){Pt(t)?t.removeChild(e,i,n):e.removeChild(i)}(t,n,e,i)}function ra(t,e,i,n,s,a,r){for(;null!=i;){const o=n[i.index],c=i.type;if(r&&0===e&&(o&&Ss(zt(o),n),i.flags|=4),64!=(64&i.flags))if(8&c)ra(t,e,i.child,n,s,a,!1),Ds(e,t,s,o,a);else if(32&c){const r=Bs(i,n);let c;for(;c=r();)Ds(e,t,s,c,a);Ds(e,t,s,o,a)}else 16&c?ca(t,e,n,i,s,a):Ds(e,t,s,o,a);i=r?i.projectionNext:i.next}}function oa(t,e,i,n,s,a){ra(i,n,t.firstChild,e,s,a,!1)}function ca(t,e,i,n,s,a){const r=i[16],o=r[6].projection[n.projection];if(Array.isArray(o))for(let c=0;c<o.length;c++)Ds(e,t,s,o[c],a);else ra(t,e,o,r[3],s,a,!0)}function la(t,e,i){Pt(t)?t.setAttribute(e,"style",i):e.style.cssText=i}function ua(t,e,i){Pt(t)?""===i?t.removeAttribute(e,"class"):t.setAttribute(e,"class",i):e.className=i}function da(t,e,i){let n=t.length;for(;;){const s=t.indexOf(e,i);if(-1===s)return s;if(0===s||t.charCodeAt(s-1)<=32){const i=e.length;if(s+i===n||t.charCodeAt(s+i)<=32)return s}i=s+1}}const ha="ng-template";function ba(t,e,i){let n=0;for(;n<t.length;){let s=t[n++];if(i&&"class"===s){if(s=t[n],-1!==da(s.toLowerCase(),e,0))return!0}else if(1===s){for(;n<t.length&&"string"==typeof(s=t[n++]);)if(s.toLowerCase()===e)return!0;return!1}}return!1}function ma(t){return 4===t.type&&t.value!==ha}function pa(t,e,i){return e===(4!==t.type||i?t.value:ha)}function ga(t,e,i){let n=4;const s=t.attrs||[],a=function(t){for(let e=0;e<t.length;e++)if(Ye(t[e]))return e;return t.length}(s);let r=!1;for(let o=0;o<e.length;o++){const c=e[o];if("number"!=typeof c){if(!r)if(4&n){if(n=2|1&n,""!==c&&!pa(t,c,i)||""===c&&1===e.length){if(fa(n))return!1;r=!0}}else{const l=8&n?c:e[++o];if(8&n&&null!==t.attrs){if(!ba(t.attrs,l,i)){if(fa(n))return!1;r=!0}continue}const u=va(8&n?"class":c,s,ma(t),i);if(-1===u){if(fa(n))return!1;r=!0;continue}if(""!==l){let t;t=u>a?"":s[u+1].toLowerCase();const e=8&n?t:null;if(e&&-1!==da(e,l,0)||2&n&&l!==t){if(fa(n))return!1;r=!0}}}}else{if(!r&&!fa(n)&&!fa(c))return!1;if(r&&fa(c))continue;r=!1,n=c|1&n}}return fa(n)||r}function fa(t){return 0==(1&t)}function va(t,e,i,n){if(null===e)return-1;let s=0;if(n||!i){let i=!1;for(;s<e.length;){const n=e[s];if(n===t)return s;if(3===n||6===n)i=!0;else{if(1===n||2===n){let t=e[++s];for(;"string"==typeof t;)t=e[++s];continue}if(4===n)break;if(0===n){s+=4;continue}}s+=i?1:2}return-1}return function(t,e){let i=t.indexOf(4);if(i>-1)for(i++;i<t.length;){const n=t[i];if("number"==typeof n)return-1;if(n===e)return i;i++}return-1}(e,t)}function ya(t,e,i=!1){for(let n=0;n<e.length;n++)if(ga(t,e[n],i))return!0;return!1}function _a(t,e){t:for(let i=0;i<e.length;i++){const n=e[i];if(t.length===n.length){for(let e=0;e<t.length;e++)if(t[e]!==n[e])continue t;return!0}}return!1}function ka(t,e){return t?":not("+e.trim()+")":e}function wa(t){let e=t[0],i=1,n=2,s="",a=!1;for(;i<t.length;){let r=t[i];if("string"==typeof r)if(2&n){const e=t[++i];s+="["+r+(e.length>0?'="'+e+'"':"")+"]"}else 8&n?s+="."+r:4&n&&(s+=" "+r);else""===s||fa(r)||(e+=ka(a,s),s=""),n=r,a=a||!fa(n);i++}return""!==s&&(e+=ka(a,s)),e}const Sa={};function Ia(t){Ca(ae(),se(),Qe()+t,be())}function Ca(t,e,i,n){if(!n)if(3==(3&e[2])){const n=t.preOrderCheckHooks;null!==n&&Ue(e,n,i)}else{const n=t.preOrderHooks;null!==n&&ze(e,n,0,i)}Ae(i)}function La(t,e){return t<<17|e<<2}function Ra(t){return t>>17&32767}function Oa(t){return 2|t}function Ta(t){return(131068&t)>>2}function xa(t,e){return-131069&t|e<<2}function Ba(t){return 1|t}function ja(t,e){const i=t.contentQueries;if(null!==i)for(let n=0;n<i.length;n+=2){const s=i[n],a=i[n+1];if(-1!==a){const i=t.data[a];Ce(s),i.contentQueries(2,e[a],a)}}}function Ma(t,e,i,n,s,a,r,o,c,l){const u=e.blueprint.slice();return u[0]=s,u[2]=140|n,Xt(u),u[3]=u[15]=t,u[8]=i,u[10]=r||t&&t[10],u[11]=o||t&&t[11],u[12]=c||t&&t[12]||null,u[9]=l||t&&t[9]||null,u[6]=a,u[16]=2==e.type?t[16]:u,u}function Qa(t,e,i,n,s){let a=t.data[e];if(null===a)a=Aa(t,e,i,n,s),te.lFrame.inI18n&&(a.flags|=64);else if(64&a.type){a.type=i,a.value=n,a.attrs=s;const t=le();a.injectorIndex=null===t?-1:t.injectorIndex}return ue(a,!0),a}function Aa(t,e,i,n,s){const a=ce(),r=de(),o=t.data[e]=function(t,e,i,n,s,a){return{type:i,index:n,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:s,attrs:a,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,r?a:a&&a.parent,i,e,n,s);return null===t.firstChild&&(t.firstChild=o),null!==a&&(r?null==a.child&&null!==o.parent&&(a.child=o):null===a.next&&(a.next=o)),o}function Da(t,e,i,n){if(0===i)return-1;const s=e.length;for(let a=0;a<i;a++)e.push(n),t.blueprint.push(n),t.data.push(null);return s}function Ea(t,e,i){Oe(e);try{const n=t.viewQuery;null!==n&&pr(1,n,i);const s=t.template;null!==s&&Pa(t,e,s,1,i),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&ja(t,e),t.staticViewQueries&&pr(2,t.viewQuery,i);const a=t.components;null!==a&&function(t,e){for(let i=0;i<e.length;i++)ur(t,e[i])}(e,a)}catch(n){throw t.firstCreatePass&&(t.incompleteFirstPass=!0),n}finally{e[2]&=-5,Me()}}function Na(t,e,i,n){const s=e[2];if(256==(256&s))return;Oe(e);const a=be();try{Xt(e),fe(t.bindingStartIndex),null!==i&&Pa(t,e,i,2,n);const r=3==(3&s);if(!a)if(r){const i=t.preOrderCheckHooks;null!==i&&Ue(e,i,null)}else{const i=t.preOrderHooks;null!==i&&ze(e,i,0,null),Je(e,0)}if(function(t){for(let e=Ms(t);null!==e;e=Qs(e)){if(!e[2])continue;const t=e[9];for(let e=0;e<t.length;e++){const i=t[e],n=i[3];0==(1024&i[2])&&Zt(n,1),i[2]|=1024}}}(e),function(t){for(let e=Ms(t);null!==e;e=Qs(e))for(let t=ft;t<e.length;t++){const i=e[t],n=i[1];Wt(i)&&Na(n,i,n.template,i[8])}}(e),null!==t.contentQueries&&ja(t,e),!a)if(r){const i=t.contentCheckHooks;null!==i&&Ue(e,i)}else{const i=t.contentHooks;null!==i&&ze(e,i,1),Je(e,1)}!function(t,e){const i=t.hostBindingOpCodes;if(null!==i)try{for(let t=0;t<i.length;t++){const n=i[t];if(n<0)Ae(~n);else{const s=n,a=i[++t],r=i[++t];ke(a,s),r(2,e[s])}}}finally{Ae(-1)}}(t,e);const o=t.components;null!==o&&function(t,e){for(let i=0;i<e.length;i++)cr(t,e[i])}(e,o);const c=t.viewQuery;if(null!==c&&pr(2,c,n),!a)if(r){const i=t.viewCheckHooks;null!==i&&Ue(e,i)}else{const i=t.viewHooks;null!==i&&ze(e,i,2),Je(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),a||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,Zt(e[3],-1))}finally{Me()}}function Fa(t,e,i,n){const s=e[10],a=!be(),r=Yt(e);try{a&&!r&&s.begin&&s.begin(),r&&Ea(t,e,n),Na(t,e,i,n)}finally{a&&!r&&s.end&&s.end()}}function Pa(t,e,i,n,s){const a=Qe();try{Ae(-1),2&n&&e.length>gt&&Ca(t,e,gt,be()),i(n,s)}finally{Ae(a)}}function Ua(t,e,i){if(_t(e)){const n=e.directiveEnd;for(let s=e.directiveStart;s<n;s++){const e=t.data[s];e.contentQueries&&e.contentQueries(1,i[s],s)}}}function za(t,e,i){ee()&&(function(t,e,i,n){const s=i.directiveStart,a=i.directiveEnd;t.firstCreatePass||ai(i,e),Ss(n,e);const r=i.initialInputs;for(let o=s;o<a;o++){const n=t.data[o],a=St(n);a&&ir(e,i,n);const c=fi(e,t,o,i);Ss(c,e),null!==r&&ar(0,o-s,c,n,0,r),a&&(Gt(i.index,e)[8]=c)}}(t,e,i,qt(i,e)),128==(128&i.flags)&&function(t,e,i){const n=i.directiveStart,s=i.directiveEnd,a=i.index,r=te.lFrame.currentDirectiveIndex;try{Ae(a);for(let i=n;i<s;i++){const n=t.data[i],s=e[i];we(i),null===n.hostBindings&&0===n.hostVars&&null===n.hostAttrs||Ka(n,s)}}finally{Ae(-1),we(r)}}(t,e,i))}function Ja(t,e,i=qt){const n=e.localNames;if(null!==n){let s=e.index+1;for(let a=0;a<n.length;a+=2){const r=n[a+1],o=-1===r?i(e,t):t[r];t[s++]=o}}}function qa(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=Va(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function Va(t,e,i,n,s,a,r,o,c,l){const u=gt+n,d=u+s,h=function(t,e){const i=[];for(let n=0;n<e;n++)i.push(n<t?null:Sa);return i}(u,d),b="function"==typeof l?l():l;return h[1]={type:t,blueprint:h,template:i,queries:null,viewQuery:o,declTNode:e,data:h.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof a?a():a,pipeRegistry:"function"==typeof r?r():r,firstChild:null,schemas:c,consts:b,incompleteFirstPass:!1}}function $a(t,e,i,n){const s=fr(e);null===i?s.push(n):(s.push(i),t.firstCreatePass&&vr(t).push(n,s.length-1))}function Ga(t,e,i){for(let n in t)if(t.hasOwnProperty(n)){const s=t[n];(i=null===i?{}:i).hasOwnProperty(n)?i[n].push(e,s):i[n]=[e,s]}return i}function Ha(t,e,i,n,s,a,r,o){const c=qt(e,i);let l,u=e.inputs;var d;!o&&null!=u&&(l=u[n])?(kr(t,i,l,n,s),kt(e)&&function(t,e){const i=Gt(e,t);16&i[2]||(i[2]|=64)}(i,e.index)):3&e.type&&(n="class"===(d=n)?"className":"for"===d?"htmlFor":"formaction"===d?"formAction":"innerHtml"===d?"innerHTML":"readonly"===d?"readOnly":"tabindex"===d?"tabIndex":d,s=null!=r?r(s,e.value||"",n):s,Pt(a)?a.setProperty(c,n,s):We(n)||(c.setProperty?c.setProperty(n,s):c[n]=s))}function Ya(t,e,i,n){let s=!1;if(ee()){const a=function(t,e,i){const n=t.directiveRegistry;let s=null;if(n)for(let a=0;a<n.length;a++){const r=n[a];ya(i,r.selectors,!1)&&(s||(s=[]),li(ai(i,e),t,r.type),St(r)?(Xa(t,i),s.unshift(r)):s.push(r))}return s}(t,e,i),r=null===n?null:{"":-1};if(null!==a){s=!0,tr(i,t.data.length,a.length);for(let t=0;t<a.length;t++){const e=a[t];e.providersResolver&&e.providersResolver(e)}let n=!1,o=!1,c=Da(t,e,a.length,null);for(let s=0;s<a.length;s++){const l=a[s];i.mergedAttrs=Ke(i.mergedAttrs,l.hostAttrs),er(t,i,e,c,l),Za(c,l,r),null!==l.contentQueries&&(i.flags|=8),null===l.hostBindings&&null===l.hostAttrs&&0===l.hostVars||(i.flags|=128);const u=l.type.prototype;!n&&(u.ngOnChanges||u.ngOnInit||u.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(i.index),n=!0),o||!u.ngOnChanges&&!u.ngDoCheck||((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(i.index),o=!0),c++}!function(t,e){const i=e.directiveEnd,n=t.data,s=e.attrs,a=[];let r=null,o=null;for(let c=e.directiveStart;c<i;c++){const t=n[c],i=t.inputs,l=null===s||ma(e)?null:rr(i,s);a.push(l),r=Ga(i,c,r),o=Ga(t.outputs,c,o)}null!==r&&(r.hasOwnProperty("class")&&(e.flags|=16),r.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=a,e.inputs=r,e.outputs=o}(t,i)}r&&function(t,e,i){if(e){const n=t.localNames=[];for(let t=0;t<e.length;t+=2){const s=i[e[t+1]];if(null==s)throw new Ct("301",`Export of name '${e[t+1]}' not found!`);n.push(e[t],s)}}}(i,n,r)}return i.mergedAttrs=Ke(i.mergedAttrs,i.attrs),s}function Wa(t,e,i,n,s,a){const r=a.hostBindings;if(r){let i=t.hostBindingOpCodes;null===i&&(i=t.hostBindingOpCodes=[]);const a=~e.index;(function(t){let e=t.length;for(;e>0;){const i=t[--e];if("number"==typeof i&&i<0)return i}return 0})(i)!=a&&i.push(a),i.push(n,s,r)}}function Ka(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function Xa(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function Za(t,e,i){if(i){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)i[e.exportAs[n]]=t;St(e)&&(i[""]=t)}}function tr(t,e,i){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+i,t.providerIndexes=e}function er(t,e,i,n,s){t.data[n]=s;const a=s.factory||(s.factory=It(s.type)),r=new Ge(a,St(s),null);t.blueprint[n]=r,i[n]=r,Wa(t,e,0,n,Da(t,i,s.hostVars,Sa),s)}function ir(t,e,i){const n=qt(e,t),s=qa(i),a=t[10],r=dr(t,Ma(t,s,null,i.onPush?64:16,n,e,a,a.createRenderer(n,i),null,null));t[e.index]=r}function nr(t,e,i,n,s,a){const r=qt(t,e);sr(e[11],r,a,t.value,i,n,s)}function sr(t,e,i,n,s,a,r){if(null==a)Pt(t)?t.removeAttribute(e,s,i):e.removeAttribute(s);else{const o=null==r?Lt(a):r(a,n||"",s);Pt(t)?t.setAttribute(e,s,o,i):i?e.setAttributeNS(i,s,o):e.setAttribute(s,o)}}function ar(t,e,i,n,s,a){const r=a[e];if(null!==r){const t=n.setInput;for(let e=0;e<r.length;){const s=r[e++],a=r[e++],o=r[e++];null!==t?n.setInput(i,o,s,a):i[a]=o}}}function rr(t,e){let i=null,n=0;for(;n<e.length;){const s=e[n];if(0!==s)if(5!==s){if("number"==typeof s)break;t.hasOwnProperty(s)&&(null===i&&(i=[]),i.push(s,t[s],e[n+1])),n+=2}else n+=2;else n+=4}return i}function or(t,e,i,n){return new Array(t,!0,!1,e,null,0,n,i,null,null)}function cr(t,e){const i=Gt(e,t);if(Wt(i)){const t=i[1];80&i[2]?Na(t,i,t.template,i[8]):i[5]>0&&lr(i)}}function lr(t){for(let i=Ms(t);null!==i;i=Qs(i))for(let t=ft;t<i.length;t++){const e=i[t];if(1024&e[2]){const t=e[1];Na(t,e,t.template,e[8])}else e[5]>0&&lr(e)}const e=t[1].components;if(null!==e)for(let i=0;i<e.length;i++){const n=Gt(e[i],t);Wt(n)&&n[5]>0&&lr(n)}}function ur(t,e){const i=Gt(e,t),n=i[1];!function(t,e){for(let i=e.length;i<t.blueprint.length;i++)e.push(t.blueprint[i])}(n,i),Ea(n,i,i[8])}function dr(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function hr(t){for(;t;){t[2]|=64;const e=js(t);if(0!=(512&t[2])&&!e)return t;t=e}return null}function br(t,e,i){const n=e[10];n.begin&&n.begin();try{Na(t,e,t.template,i)}catch(s){throw _r(e,s),s}finally{n.end&&n.end()}}function mr(t){!function(t){for(let e=0;e<t.components.length;e++){const i=t.components[e],n=Ht(i),s=n[1];Fa(s,n,s.template,i)}}(t[8])}function pr(t,e,i){Ce(0),e(t,i)}const gr=(()=>Promise.resolve(null))();function fr(t){return t[7]||(t[7]=[])}function vr(t){return t.cleanup||(t.cleanup=[])}function yr(t,e,i){return(null===t||St(t))&&(i=function(t){for(;Array.isArray(t);){if("object"==typeof t[1])return t;t=t[0]}return null}(i[e.index])),i[11]}function _r(t,e){const i=t[9],n=i?i.get(ks,null):null;n&&n.handleError(e)}function kr(t,e,i,n,s){for(let a=0;a<i.length;){const r=i[a++],o=i[a++],c=e[r],l=t.data[r];null!==l.setInput?l.setInput(c,s,n,o):c[o]=s}}function wr(t,e,i){const n=Jt(e,t);Ns(t[11],n,i)}function Sr(t,e,i){let n=i?t.styles:null,s=i?t.classes:null,a=0;if(null!==e)for(let r=0;r<e.length;r++){const t=e[r];"number"==typeof t?a=t:1==a?s=_(s,t):2==a&&(n=_(n,t+": "+e[++r]+";"))}i?t.styles=n:t.stylesWithoutHost=n,i?t.classes=s:t.classesWithoutHost=s}const Ir=new ji("INJECTOR",-1);class Cr{get(t,e=ln){if(e===ln){const e=new Error(`NullInjectorError: No provider for ${y(t)}!`);throw e.name="NullInjectorError",e}return e}}const Lr=new ji("Set Injector scope."),Rr={},Or={},Tr=[];let xr=void 0;function Br(){return void 0===xr&&(xr=new Cr),xr}function jr(t,e=null,i=null,n){return new Mr(t,i,e||Br(),n)}class Mr{constructor(t,e,i,n=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];e&&Fi(e,i=>this.processProvider(i,t,e)),Fi([t],t=>this.processInjectorType(t,[],s)),this.records.set(Ir,Dr(void 0,this));const a=this.records.get(Lr);this.scope=null!=a?a.value:null,this.source=n||("object"==typeof t?null:y(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=ln,i=A.Default){this.assertNotDestroyed();const n=pn(this);try{if(!(i&A.SkipSelf)){let e=this.records.get(t);if(void 0===e){const i=("function"==typeof(s=t)||"object"==typeof s&&s instanceof ji)&&O(t);e=i&&this.injectableDefInScope(i)?Dr(Qr(t),Rr):null,this.records.set(t,e)}if(null!=e)return this.hydrate(t,e)}return(i&A.Self?Br():this.parent).get(t,e=i&A.Optional&&e===ln?null:e)}catch(a){if("NullInjectorError"===a.name){if((a.ngTempTokenPath=a.ngTempTokenPath||[]).unshift(y(t)),n)throw a;return function(t,e,i,n){const s=t.ngTempTokenPath;throw e[dn]&&s.unshift(e[dn]),t.message=function(t,e,i,n=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let s=y(e);if(Array.isArray(e))s=e.map(y).join(" -> ");else if("object"==typeof e){let t=[];for(let i in e)if(e.hasOwnProperty(i)){let n=e[i];t.push(i+":"+("string"==typeof n?JSON.stringify(n):y(n)))}s=`{${t.join(", ")}}`}return`${i}${n?"("+n+")":""}[${s}]: ${t.replace(un,"\n  ")}`}("\n"+t.message,s,i,n),t.ngTokenPath=s,t.ngTempTokenPath=null,t}(a,t,"R3InjectorError",this.source)}throw a}finally{pn(n)}var s}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((e,i)=>t.push(y(i))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(t,e,i){if(!(t=S(t)))return!1;let n=x(t);const s=null==n&&t.ngModule||void 0,a=void 0===s?t:s,r=-1!==i.indexOf(a);if(void 0!==s&&(n=x(s)),null==n)return!1;if(null!=n.imports&&!r){let t;i.push(a);try{Fi(n.imports,n=>{this.processInjectorType(n,e,i)&&(void 0===t&&(t=[]),t.push(n))})}finally{}if(void 0!==t)for(let e=0;e<t.length;e++){const{ngModule:i,providers:n}=t[e];Fi(n,t=>this.processProvider(t,i,n||Tr))}}this.injectorDefTypes.add(a),this.records.set(a,Dr(n.factory,Rr));const o=n.providers;if(null!=o&&!r){const e=t;Fi(o,t=>this.processProvider(t,e,o))}return void 0!==s&&void 0!==t.providers}processProvider(t,e,i){let n=Nr(t=S(t))?t:S(t&&t.provide);const s=function(t,e,i){return Er(t)?Dr(void 0,t.useValue):Dr(Ar(t),Rr)}(t);if(Nr(t)||!0!==t.multi)this.records.get(n);else{let e=this.records.get(n);e||(e=Dr(void 0,Rr,!0),e.factory=()=>yn(e.multi),this.records.set(n,e)),n=t,e.multi.push(t)}this.records.set(n,s)}hydrate(t,e){var i;return e.value===Rr&&(e.value=Or,e.value=e.factory()),"object"==typeof e.value&&e.value&&null!==(i=e.value)&&"object"==typeof i&&"function"==typeof i.ngOnDestroy&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){return!!t.providedIn&&("string"==typeof t.providedIn?"any"===t.providedIn||t.providedIn===this.scope:this.injectorDefTypes.has(t.providedIn))}}function Qr(t){const e=O(t),i=null!==e?e.factory:It(t);if(null!==i)return i;const n=x(t);if(null!==n)return n.factory;if(t instanceof ji)throw new Error(`Token ${y(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const e=t.length;if(e>0){const i=zi(e,"?");throw new Error(`Can't resolve all parameters for ${y(t)}: (${i.join(", ")}).`)}const i=function(t){const e=t&&(t[B]||t[M]);if(e){const i=function(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${i}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${i}" class.`),e}return null}(t);return null!==i?()=>i.factory(t):()=>new t}(t);throw new Error("unreachable")}function Ar(t,e,i){let n=void 0;if(Nr(t)){const e=S(t);return It(e)||Qr(e)}if(Er(t))n=()=>S(t.useValue);else if((s=t)&&s.useFactory)n=()=>t.useFactory(...yn(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))n=()=>fn(S(t.useExisting));else{const e=S(t&&(t.useClass||t.provide));if(!function(t){return!!t.deps}(t))return It(e)||Qr(e);n=()=>new e(...yn(t.deps))}var s;return n}function Dr(t,e,i=!1){return{factory:t,value:e,multi:i?[]:void 0}}function Er(t){return null!==t&&"object"==typeof t&&hn in t}function Nr(t){return"function"==typeof t}const Fr=function(t,e,i){return function(t,e=null,i=null,n){const s=jr(t,e,i,n);return s._resolveInjectorDefTypes(),s}({name:i},e,t,i)};let Pr=(()=>{class t{static create(t,e){return Array.isArray(t)?Fr(t,e,""):Fr(t.providers,t.parent,t.name||"")}}return t.THROW_IF_NOT_FOUND=ln,t.NULL=new Cr,t.\u0275prov=L({token:t,providedIn:"any",factory:()=>fn(Ir)}),t.__NG_ELEMENT_ID__=-1,t})();function Ur(t,e){Pe(Ht(t)[1],oe())}function zr(t){return Object.getPrototypeOf(t.prototype).constructor}function Jr(t){let e=zr(t.type),i=!0;const n=[t];for(;e;){let s=void 0;if(St(t))s=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");s=e.\u0275dir}if(s){if(i){n.push(s);const e=t;e.inputs=qr(t.inputs),e.declaredInputs=qr(t.declaredInputs),e.outputs=qr(t.outputs);const i=s.hostBindings;i&&Gr(t,i);const a=s.viewQuery,r=s.contentQueries;if(a&&Vr(t,a),r&&$r(t,r),v(t.inputs,s.inputs),v(t.declaredInputs,s.declaredInputs),v(t.outputs,s.outputs),St(s)&&s.data.animation){const e=t.data;e.animation=(e.animation||[]).concat(s.data.animation)}}const e=s.features;if(e)for(let n=0;n<e.length;n++){const s=e[n];s&&s.ngInherit&&s(t),s===Jr&&(i=!1)}}e=Object.getPrototypeOf(e)}!function(t){let e=0,i=null;for(let n=t.length-1;n>=0;n--){const s=t[n];s.hostVars=e+=s.hostVars,s.hostAttrs=Ke(s.hostAttrs,i=Ke(i,s.hostAttrs))}}(n)}function qr(t){return t===G?{}:t===H?[]:t}function Vr(t,e){const i=t.viewQuery;t.viewQuery=i?(t,n)=>{e(t,n),i(t,n)}:e}function $r(t,e){const i=t.contentQueries;t.contentQueries=i?(t,n,s)=>{e(t,n,s),i(t,n,s)}:e}function Gr(t,e){const i=t.hostBindings;t.hostBindings=i?(t,n)=>{e(t,n),i(t,n)}:e}const Hr=["providersResolver"],Yr=["template","decls","consts","vars","onPush","ngContentSelectors","styles","encapsulation","schemas"];function Wr(t){let e=zr(t.type),i=void 0;i=St(t)?e.\u0275cmp:e.\u0275dir;const n=t;for(const s of Hr)n[s]=i[s];if(St(i))for(const s of Yr)n[s]=i[s]}let Kr=null;function Xr(){if(!Kr){const t=$.Symbol;if(t&&t.iterator)Kr=t.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const i=t[e];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(Kr=i)}}}return Kr}class Zr{constructor(t){this.wrapped=t}static wrap(t){return new Zr(t)}static unwrap(t){return Zr.isWrapped(t)?t.wrapped:t}static isWrapped(t){return t instanceof Zr}}function to(t){return!!eo(t)&&(Array.isArray(t)||!(t instanceof Map)&&Xr()in t)}function eo(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function io(t,e,i){return t[e]=i}function no(t,e){return t[e]}function so(t,e,i){return!Object.is(t[e],i)&&(t[e]=i,!0)}function ao(t,e,i,n){const s=so(t,e,i);return so(t,e+1,n)||s}function ro(t,e,i,n,s){const a=ao(t,e,i,n);return so(t,e+2,s)||a}function oo(t,e,i,n,s,a){const r=ao(t,e,i,n);return ao(t,e+2,s,a)||r}function co(t,e,i,n){const s=se();return so(s,ve(),e)&&(ae(),nr(De(),s,t,e,i,n)),co}function lo(t,e){let i=!1,n=ge();for(let a=1;a<e.length;a+=2)i=so(t,n++,e[a])||i;if(fe(n),!i)return Sa;let s=e[0];for(let a=1;a<e.length;a+=2)s+=Lt(e[a])+e[a+1];return s}function uo(t,e,i,n){return so(t,ve(),i)?e+Lt(i)+n:Sa}function ho(t,e,i,n,s,a){const r=ao(t,ge(),i,s);return ye(2),r?e+Lt(i)+n+Lt(s)+a:Sa}function bo(t,e,i,n,s,a,r,o){const c=ro(t,ge(),i,s,r);return ye(3),c?e+Lt(i)+n+Lt(s)+a+Lt(r)+o:Sa}function mo(t,e,i,n,s,a,r,o,c,l){const u=oo(t,ge(),i,s,r,c);return ye(4),u?e+Lt(i)+n+Lt(s)+a+Lt(r)+o+Lt(c)+l:Sa}function po(t,e,i,n,s,a,r,o,c,l,u,d){const h=ge();let b=oo(t,h,i,s,r,c);return b=so(t,h+4,u)||b,ye(5),b?e+Lt(i)+n+Lt(s)+a+Lt(r)+o+Lt(c)+l+Lt(u)+d:Sa}function go(t,e,i,n,s,a,r,o,c,l,u,d,h,b){const m=ge();let p=oo(t,m,i,s,r,c);return p=ao(t,m+4,u,h)||p,ye(6),p?e+Lt(i)+n+Lt(s)+a+Lt(r)+o+Lt(c)+l+Lt(u)+d+Lt(h)+b:Sa}function fo(t,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p){const g=ge();let f=oo(t,g,i,s,r,c);return f=ro(t,g+4,u,h,m)||f,ye(7),f?e+Lt(i)+n+Lt(s)+a+Lt(r)+o+Lt(c)+l+Lt(u)+d+Lt(h)+b+Lt(m)+p:Sa}function vo(t,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p,g,f){const v=ge();let y=oo(t,v,i,s,r,c);return y=oo(t,v+4,u,h,m,g)||y,ye(8),y?e+Lt(i)+n+Lt(s)+a+Lt(r)+o+Lt(c)+l+Lt(u)+d+Lt(h)+b+Lt(m)+p+Lt(g)+f:Sa}function yo(t,e,i,n,s,a){const r=se(),o=uo(r,e,i,n);return o!==Sa&&nr(De(),r,t,o,s,a),yo}function _o(t,e,i,n,s,a,r,o){const c=se(),l=ho(c,e,i,n,s,a);return l!==Sa&&nr(De(),c,t,l,r,o),_o}function ko(t,e,i,n,s,a,r,o,c,l){const u=se(),d=bo(u,e,i,n,s,a,r,o);return d!==Sa&&nr(De(),u,t,d,c,l),ko}function wo(t,e,i,n,s,a,r,o,c,l,u,d){const h=se(),b=mo(h,e,i,n,s,a,r,o,c,l);return b!==Sa&&nr(De(),h,t,b,u,d),wo}function So(t,e,i,n,s,a,r,o,c,l,u,d,h,b){const m=se(),p=po(m,e,i,n,s,a,r,o,c,l,u,d);return p!==Sa&&nr(De(),m,t,p,h,b),So}function Io(t,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p){const g=se(),f=go(g,e,i,n,s,a,r,o,c,l,u,d,h,b);return f!==Sa&&nr(De(),g,t,f,m,p),Io}function Co(t,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p,g,f){const v=se(),y=fo(v,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p);return y!==Sa&&nr(De(),v,t,y,g,f),Co}function Lo(t,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p,g,f,v,y){const _=se(),k=vo(_,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p,g,f);return k!==Sa&&nr(De(),_,t,k,v,y),Lo}function Ro(t,e,i,n){const s=se(),a=lo(s,e);return a!==Sa&&nr(De(),s,t,a,i,n),Ro}function Oo(t,e,i,n,s,a,r,o){const c=se(),l=ae(),u=t+gt,d=l.firstCreatePass?function(t,e,i,n,s,a,r,o,c){const l=e.consts,u=Qa(e,t,4,r||null,Kt(l,o));Ya(e,i,u,Kt(l,c)),Pe(e,u);const d=u.tViews=Va(2,u,n,s,a,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l);return null!==e.queries&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}(u,l,c,e,i,n,s,a,r):l.data[u];ue(d,!1);const h=c[11].createComment("");ia(l,c,h,d),Ss(h,c),dr(c,c[u]=or(h,c,h,d)),wt(d)&&za(l,c,d),null!=r&&Ja(c,d,o)}function To(t){return $t(te.lFrame.contextLView,gt+t)}const xo={"\u0275\u0275defineInjectable":L,"\u0275\u0275defineInjector":R,"\u0275\u0275inject":fn,"\u0275\u0275getFactoryOf":function t(e){const i=e;if(I(e))return()=>{const e=t(S(i));return e?e():null};const n=O(i)||x(i);return n&&void 0!==n.factory?n.factory:null},"\u0275\u0275invalidFactoryDep":vn},Bo=f({provide:String,useValue:f});function jo(t){return void 0!==t.useClass}function Mo(t){return void 0!==t.useFactory}function Qo(t,e){const i=e||{providedIn:null},n={name:t.name,type:t,typeArgumentCount:0,providedIn:i.providedIn,userDeps:void 0};return(jo(i)||Mo(i))&&void 0!==i.deps&&(n.userDeps=cn(i.deps)),jo(i)?n.useClass=S(i.useClass):function(t){return Bo in t}(i)?n.useValue=S(i.useValue):Mo(i)?n.useFactory=i.useFactory:function(t){return void 0!==t.useExisting}(i)&&(n.useExisting=S(i.useExisting)),n}const Ao=Ri("Injectable",void 0,void 0,void 0,(t,e)=>Do(t,e)),Do=function(t,e){let i=null,n=null;t.hasOwnProperty(B)||Object.defineProperty(t,B,{get:()=>(null===i&&(i=Ai().compileInjectable(xo,`ng:///${t.name}/\u0275prov.js`,Qo(t,e))),i)}),t.hasOwnProperty(tt)||Object.defineProperty(t,tt,{get:()=>{if(null===n){const i=Qo(t,e),s=Ai();n=s.compileFactory(xo,`ng:///${t.name}/\u0275fac.js`,{name:i.name,type:i.type,typeArgumentCount:i.typeArgumentCount,deps:on(t),injectFn:"inject",target:s.R3FactoryTarget.Injectable})}return n},configurable:!0})};function Eo(t,e=A.Default){const i=se();return null===i?fn(t,e):hi(oe(),i,S(t),e)}function No(){throw new Error("invalid")}function Fo(t,e,i){const n=se();return so(n,ve(),e)&&Ha(ae(),De(),n,t,e,n[11],i,!1),Fo}function Po(t,e,i,n,s){const a=s?"class":"style";kr(t,i,e.inputs[a],a,n)}function Uo(t,e,i,n){const s=se(),a=ae(),r=gt+t,o=s[11],c=s[r]=Ps(o,e,te.lFrame.currentNamespace),l=a.firstCreatePass?function(t,e,i,n,s,a,r){const o=e.consts,c=Qa(e,t,2,s,Kt(o,a));return Ya(e,i,c,Kt(o,r)),null!==c.attrs&&Sr(c,c.attrs,!1),null!==c.mergedAttrs&&Sr(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(r,a,s,0,e,i,n):a.data[r];ue(l,!0);const u=l.mergedAttrs;null!==u&&He(o,c,u);const d=l.classes;null!==d&&ua(o,c,d);const h=l.styles;null!==h&&la(o,c,h),64!=(64&l.flags)&&ia(a,s,c,l),0===te.lFrame.elementDepthCount&&Ss(c,s),te.lFrame.elementDepthCount++,wt(l)&&(za(a,s,l),Ua(a,l,s)),null!==n&&Ja(s,l)}function zo(){let t=oe();de()?he():(t=t.parent,ue(t,!1));const e=t;te.lFrame.elementDepthCount--;const i=ae();i.firstCreatePass&&(Pe(i,t),_t(t)&&i.queries.elementEnd(t)),null!=e.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(e)&&Po(i,e,se(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(e)&&Po(i,e,se(),e.stylesWithoutHost,!1)}function Jo(t,e,i,n){Uo(t,e,i,n),zo()}function qo(t,e,i){const n=se(),s=ae(),a=t+gt,r=s.firstCreatePass?function(t,e,i,n,s){const a=e.consts,r=Kt(a,n),o=Qa(e,t,8,"ng-container",r);return null!==r&&Sr(o,r,!0),Ya(e,i,o,Kt(a,s)),null!==e.queries&&e.queries.elementStart(e,o),o}(a,s,n,e,i):s.data[a];ue(r,!0);const o=n[a]=n[11].createComment("");ia(s,n,o,r),Ss(o,n),wt(r)&&(za(s,n,r),Ua(s,r,n)),null!=i&&Ja(n,r)}function Vo(){let t=oe();const e=ae();de()?he():(t=t.parent,ue(t,!1)),e.firstCreatePass&&(Pe(e,t),_t(t)&&e.queries.elementEnd(t))}function $o(t,e,i){qo(t,e,i),Vo()}function Go(){return se()}function Ho(t){return!!t&&"function"==typeof t.then}function Yo(t){return!!t&&"function"==typeof t.subscribe}function Wo(t,e,i=!1,n){const s=se(),a=ae(),r=oe();return Xo(a,s,s[11],r,t,e,i,n),Wo}function Ko(t,e,i=!1,n){const s=oe(),a=se(),r=ae();return Xo(r,a,yr(Se(r.data),s,a),s,t,e,i,n),Ko}function Xo(t,e,i,n,s,a,r=!1,o){const c=wt(n),l=t.firstCreatePass&&vr(t),u=fr(e);let d=!0;if(3&n.type){const h=qt(n,e),b=o?o(h):G,m=b.target||h,p=u.length,g=o?t=>o(zt(t[n.index])).target:n.index;if(Pt(i)){let r=null;if(!o&&c&&(r=function(t,e,i,n){const s=t.cleanup;if(null!=s)for(let a=0;a<s.length-1;a+=2){const t=s[a];if(t===i&&s[a+1]===n){const t=e[7],i=s[a+2];return t.length>i?t[i]:null}"string"==typeof t&&(a+=2)}return null}(t,e,s,n.index)),null!==r)(r.__ngLastListenerFn__||r).__ngNextListenerFn__=a,r.__ngLastListenerFn__=a,d=!1;else{a=tc(n,e,a,!1);const t=i.listen(b.name||m,s,a);u.push(a,t),l&&l.push(s,g,p,p+1)}}else a=tc(n,e,a,!0),m.addEventListener(s,a,r),u.push(a),l&&l.push(s,g,p,r)}else a=tc(n,e,a,!1);const h=n.outputs;let b;if(d&&null!==h&&(b=h[s])){const t=b.length;if(t)for(let i=0;i<t;i+=2){const t=e[b[i]][b[i+1]].subscribe(a),r=u.length;u.push(a,t),l&&l.push(s,n.index,r,-(r+1))}}}function Zo(t,e,i){try{return!1!==e(i)}catch(n){return _r(t,n),!1}}function tc(t,e,i,n){return function s(a){if(a===Function)return i;const r=2&t.flags?Gt(t.index,e):e;0==(32&e[2])&&hr(r);let o=Zo(e,i,a),c=s.__ngNextListenerFn__;for(;c;)o=Zo(e,c,a)&&o,c=c.__ngNextListenerFn__;return n&&!1===o&&(a.preventDefault(),a.returnValue=!1),o}}function ec(t=1){return function(t){return(te.lFrame.contextLView=function(t,e){for(;t>0;)e=e[15],t--;return e}(t,te.lFrame.contextLView))[8]}(t)}function ic(t,e){let i=null;const n=function(t){const e=t.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(t);for(let s=0;s<e.length;s++){const a=e[s];if("*"!==a){if(null===n?ya(t,a,!0):_a(n,a))return s}else i=s}return i}function nc(t){const e=se()[16][6];if(!e.projection){const i=e.projection=zi(t?t.length:1,null),n=i.slice();let s=e.child;for(;null!==s;){const e=t?ic(s,t):0;null!==e&&(n[e]?n[e].projectionNext=s:i[e]=s,n[e]=s),s=s.next}}}function sc(t,e=0,i){const n=se(),s=ae(),a=Qa(s,gt+t,16,null,i||null);null===a.projection&&(a.projection=e),he(),64!=(64&a.flags)&&function(t,e,i){ca(e[11],0,e,i,Vs(t,i,e),Ks(i.parent||e[6],i,e))}(s,n,a)}function ac(t,e,i){return rc(t,"",e,"",i),ac}function rc(t,e,i,n,s){const a=se(),r=uo(a,e,i,n);return r!==Sa&&Ha(ae(),De(),a,t,r,a[11],s,!1),rc}function oc(t,e,i,n,s,a,r){const o=se(),c=ho(o,e,i,n,s,a);return c!==Sa&&Ha(ae(),De(),o,t,c,o[11],r,!1),oc}function cc(t,e,i,n,s,a,r,o,c){const l=se(),u=bo(l,e,i,n,s,a,r,o);return u!==Sa&&Ha(ae(),De(),l,t,u,l[11],c,!1),cc}function lc(t,e,i,n,s,a,r,o,c,l,u){const d=se(),h=mo(d,e,i,n,s,a,r,o,c,l);return h!==Sa&&Ha(ae(),De(),d,t,h,d[11],u,!1),lc}function uc(t,e,i,n,s,a,r,o,c,l,u,d,h){const b=se(),m=po(b,e,i,n,s,a,r,o,c,l,u,d);return m!==Sa&&Ha(ae(),De(),b,t,m,b[11],h,!1),uc}function dc(t,e,i,n,s,a,r,o,c,l,u,d,h,b,m){const p=se(),g=go(p,e,i,n,s,a,r,o,c,l,u,d,h,b);return g!==Sa&&Ha(ae(),De(),p,t,g,p[11],m,!1),dc}function hc(t,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p,g){const f=se(),v=fo(f,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p);return v!==Sa&&Ha(ae(),De(),f,t,v,f[11],g,!1),hc}function bc(t,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p,g,f,v){const y=se(),_=vo(y,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p,g,f);return _!==Sa&&Ha(ae(),De(),y,t,_,y[11],v,!1),bc}function mc(t,e,i){const n=se(),s=lo(n,e);return s!==Sa&&Ha(ae(),De(),n,t,s,n[11],i,!1),mc}const pc=[];function gc(t,e,i,n,s){const a=t[i+1],r=null===e;let o=n?Ra(a):Ta(a),c=!1;for(;0!==o&&(!1===c||r);){const i=t[o+1];fc(t[o],e)&&(c=!0,t[o+1]=n?Ba(i):Oa(i)),o=n?Ra(i):Ta(i)}c&&(t[i+1]=n?Oa(a):Ba(a))}function fc(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&Vi(t,e)>=0}const vc={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function yc(t){return t.substring(vc.key,vc.keyEnd)}function _c(t){return t.substring(vc.value,vc.valueEnd)}function kc(t,e){const i=vc.textEnd;return i===e?-1:(e=vc.keyEnd=function(t,e,i){for(;e<i&&t.charCodeAt(e)>32;)e++;return e}(t,vc.key=e,i),Ic(t,e,i))}function wc(t,e){const i=vc.textEnd;let n=vc.key=Ic(t,e,i);return i===n?-1:(n=vc.keyEnd=function(t,e,i){let n;for(;e<i&&(45===(n=t.charCodeAt(e))||95===n||(-33&n)>=65&&(-33&n)<=90||n>=48&&n<=57);)e++;return e}(t,n,i),n=Cc(t,n,i),n=vc.value=Ic(t,n,i),n=vc.valueEnd=function(t,e,i){let n=-1,s=-1,a=-1,r=e,o=r;for(;r<i;){const c=t.charCodeAt(r++);if(59===c)return o;34===c||39===c?o=r=Lc(t,c,r,i):e===r-4&&85===a&&82===s&&76===n&&40===c?o=r=Lc(t,41,r,i):c>32&&(o=r),a=s,s=n,n=-33&c}return o}(t,n,i),Cc(t,n,i))}function Sc(t){vc.key=0,vc.keyEnd=0,vc.value=0,vc.valueEnd=0,vc.textEnd=t.length}function Ic(t,e,i){for(;e<i&&t.charCodeAt(e)<=32;)e++;return e}function Cc(t,e,i,n){return(e=Ic(t,e,i))<i&&e++,e}function Lc(t,e,i,n){let s=-1,a=i;for(;a<n;){const i=t.charCodeAt(a++);if(i==e&&92!==s)return a;s=92==i&&92===s?0:i}throw new Error}function Rc(t,e,i){return Mc(t,e,i,!1),Rc}function Oc(t,e){return Mc(t,e,null,!0),Oc}function Tc(t){Qc(Fc,xc,t,!1)}function xc(t,e){for(let i=function(t){return Sc(t),wc(t,Ic(t,0,vc.textEnd))}(e);i>=0;i=wc(e,i))Fc(t,yc(e),_c(e))}function Bc(t){Qc(Ji,jc,t,!0)}function jc(t,e){for(let i=function(t){return Sc(t),kc(t,Ic(t,0,vc.textEnd))}(e);i>=0;i=kc(e,i))Ji(t,yc(e),!0)}function Mc(t,e,i,n){const s=se(),a=ae(),r=ye(2);a.firstUpdatePass&&Dc(a,t,r,n),e!==Sa&&so(s,r,e)&&Pc(a,a.data[Qe()],s,s[11],t,s[r+1]=function(t,e){return null==t||("string"==typeof e?t+=e:"object"==typeof t&&(t=y(On(t)))),t}(e,i),n,r)}function Qc(t,e,i,n){const s=ae(),a=ye(2);s.firstUpdatePass&&Dc(s,null,a,n);const r=se();if(i!==Sa&&so(r,a,i)){const o=s.data[Qe()];if(Jc(o,n)&&!Ac(s,a)){let t=n?o.classesWithoutHost:o.stylesWithoutHost;null!==t&&(i=_(t,i||"")),Po(s,o,r,i,n)}else!function(t,e,i,n,s,a,r,o){s===Sa&&(s=pc);let c=0,l=0,u=0<s.length?s[0]:null,d=0<a.length?a[0]:null;for(;null!==u||null!==d;){const h=c<s.length?s[c+1]:void 0,b=l<a.length?a[l+1]:void 0;let m=null,p=void 0;u===d?(c+=2,l+=2,h!==b&&(m=d,p=b)):null===d||null!==u&&u<d?(c+=2,m=u):(l+=2,m=d,p=b),null!==m&&Pc(t,e,i,n,m,p,r,o),u=c<s.length?s[c]:null,d=l<a.length?a[l]:null}}(s,o,r,r[11],r[a+1],r[a+1]=function(t,e,i){if(null==i||""===i)return pc;const n=[],s=On(i);if(Array.isArray(s))for(let a=0;a<s.length;a++)t(n,s[a],!0);else if("object"==typeof s)for(const a in s)s.hasOwnProperty(a)&&t(n,a,s[a]);else"string"==typeof s&&e(n,s);return n}(t,e,i),n,a)}}function Ac(t,e){return e>=t.expandoStartIndex}function Dc(t,e,i,n){const s=t.data;if(null===s[i+1]){const a=s[Qe()],r=Ac(t,i);Jc(a,n)&&null===e&&!r&&(e=!1),e=function(t,e,i,n){const s=Se(t);let a=n?e.residualClasses:e.residualStyles;if(null===s)0===(n?e.classBindings:e.styleBindings)&&(i=Nc(i=Ec(null,t,e,i,n),e.attrs,n),a=null);else{const r=e.directiveStylingLast;if(-1===r||t[r]!==s)if(i=Ec(s,t,e,i,n),null===a){let i=function(t,e,i){const n=i?e.classBindings:e.styleBindings;if(0!==Ta(n))return t[Ra(n)]}(t,e,n);void 0!==i&&Array.isArray(i)&&(i=Ec(null,t,e,i[1],n),i=Nc(i,e.attrs,n),function(t,e,i,n){t[Ra(i?e.classBindings:e.styleBindings)]=n}(t,e,n,i))}else a=function(t,e,i){let n=void 0;const s=e.directiveEnd;for(let a=1+e.directiveStylingLast;a<s;a++)n=Nc(n,t[a].hostAttrs,i);return Nc(n,e.attrs,i)}(t,e,n)}return void 0!==a&&(n?e.residualClasses=a:e.residualStyles=a),i}(s,a,e,n),function(t,e,i,n,s,a){let r=a?e.classBindings:e.styleBindings,o=Ra(r),c=Ta(r);t[n]=i;let l,u=!1;if(Array.isArray(i)){const t=i;l=t[1],(null===l||Vi(t,l)>0)&&(u=!0)}else l=i;if(s)if(0!==c){const e=Ra(t[o+1]);t[n+1]=La(e,o),0!==e&&(t[e+1]=xa(t[e+1],n)),t[o+1]=131071&t[o+1]|n<<17}else t[n+1]=La(o,0),0!==o&&(t[o+1]=xa(t[o+1],n)),o=n;else t[n+1]=La(c,0),0===o?o=n:t[c+1]=xa(t[c+1],n),c=n;u&&(t[n+1]=Oa(t[n+1])),gc(t,l,n,!0),gc(t,l,n,!1),function(t,e,i,n,s){const a=s?t.residualClasses:t.residualStyles;null!=a&&"string"==typeof e&&Vi(a,e)>=0&&(i[n+1]=Ba(i[n+1]))}(e,l,t,n,a),r=La(o,c),a?e.classBindings=r:e.styleBindings=r}(s,a,e,i,r,n)}}function Ec(t,e,i,n,s){let a=null;const r=i.directiveEnd;let o=i.directiveStylingLast;for(-1===o?o=i.directiveStart:o++;o<r&&(a=e[o],n=Nc(n,a.hostAttrs,s),a!==t);)o++;return null!==t&&(i.directiveStylingLast=o),n}function Nc(t,e,i){const n=i?1:2;let s=-1;if(null!==e)for(let a=0;a<e.length;a++){const r=e[a];"number"==typeof r?s=r:s===n&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Ji(t,r,!!i||e[++a]))}return void 0===t?null:t}function Fc(t,e,i){Ji(t,e,On(i))}function Pc(t,e,i,n,s,a,r,o){if(!(3&e.type))return;const c=t.data,l=c[o+1];zc(1==(1&l)?Uc(c,e,i,s,Ta(l),r):void 0)||(zc(a)||2==(2&l)&&(a=Uc(c,null,i,s,o,r)),function(t,e,i,n,s){const a=Pt(t);if(e)s?a?t.addClass(i,n):i.classList.add(n):a?t.removeClass(i,n):i.classList.remove(n);else{let e=-1===n.indexOf("-")?void 0:Ts.DashCase;if(null==s)a?t.removeStyle(i,n,e):i.style.removeProperty(n);else{const r="string"==typeof s&&s.endsWith("!important");r&&(s=s.slice(0,-10),e|=Ts.Important),a?t.setStyle(i,n,s,e):i.style.setProperty(n,s,r?"important":"")}}}(n,r,Jt(Qe(),i),s,a))}function Uc(t,e,i,n,s,a){const r=null===e;let o=void 0;for(;s>0;){const e=t[s],a=Array.isArray(e),c=a?e[1]:e,l=null===c;let u=i[s+1];u===Sa&&(u=l?pc:void 0);let d=l?qi(u,n):c===n?u:void 0;if(a&&!zc(d)&&(d=qi(e,n)),zc(d)&&(o=d,r))return o;const h=t[s+1];s=r?Ra(h):Ta(h)}if(null!==e){let t=a?e.residualClasses:e.residualStyles;null!=t&&(o=qi(t,n))}return o}function zc(t){return void 0!==t}function Jc(t,e){return 0!=(t.flags&(e?16:32))}function qc(t,e=""){const i=se(),n=ae(),s=t+gt,a=n.firstCreatePass?Qa(n,s,1,e,null):n.data[s],r=i[s]=Es(i[11],e);ia(n,i,r,a),ue(a,!1)}function Vc(t){return $c("",t,""),Vc}function $c(t,e,i){const n=se(),s=uo(n,t,e,i);return s!==Sa&&wr(n,Qe(),s),$c}function Gc(t,e,i,n,s){const a=se(),r=ho(a,t,e,i,n,s);return r!==Sa&&wr(a,Qe(),r),Gc}function Hc(t,e,i,n,s,a,r){const o=se(),c=bo(o,t,e,i,n,s,a,r);return c!==Sa&&wr(o,Qe(),c),Hc}function Yc(t,e,i,n,s,a,r,o,c){const l=se(),u=mo(l,t,e,i,n,s,a,r,o,c);return u!==Sa&&wr(l,Qe(),u),Yc}function Wc(t,e,i,n,s,a,r,o,c,l,u){const d=se(),h=po(d,t,e,i,n,s,a,r,o,c,l,u);return h!==Sa&&wr(d,Qe(),h),Wc}function Kc(t,e,i,n,s,a,r,o,c,l,u,d,h){const b=se(),m=go(b,t,e,i,n,s,a,r,o,c,l,u,d,h);return m!==Sa&&wr(b,Qe(),m),Kc}function Xc(t,e,i,n,s,a,r,o,c,l,u,d,h,b,m){const p=se(),g=fo(p,t,e,i,n,s,a,r,o,c,l,u,d,h,b,m);return g!==Sa&&wr(p,Qe(),g),Xc}function Zc(t,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p,g){const f=se(),v=vo(f,t,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p,g);return v!==Sa&&wr(f,Qe(),v),Zc}function tl(t){const e=se(),i=lo(e,t);return i!==Sa&&wr(e,Qe(),i),tl}function el(t,e,i){Qc(Ji,jc,uo(se(),t,e,i),!0)}function il(t,e,i,n,s){Qc(Ji,jc,ho(se(),t,e,i,n,s),!0)}function nl(t,e,i,n,s,a,r){Qc(Ji,jc,bo(se(),t,e,i,n,s,a,r),!0)}function sl(t,e,i,n,s,a,r,o,c){Qc(Ji,jc,mo(se(),t,e,i,n,s,a,r,o,c),!0)}function al(t,e,i,n,s,a,r,o,c,l,u){Qc(Ji,jc,po(se(),t,e,i,n,s,a,r,o,c,l,u),!0)}function rl(t,e,i,n,s,a,r,o,c,l,u,d,h){Qc(Ji,jc,go(se(),t,e,i,n,s,a,r,o,c,l,u,d,h),!0)}function ol(t,e,i,n,s,a,r,o,c,l,u,d,h,b,m){Qc(Ji,jc,fo(se(),t,e,i,n,s,a,r,o,c,l,u,d,h,b,m),!0)}function cl(t,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p,g){Qc(Ji,jc,vo(se(),t,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p,g),!0)}function ll(t){Qc(Ji,jc,lo(se(),t),!0)}function ul(t,e,i){Tc(uo(se(),t,e,i))}function dl(t,e,i,n,s){Tc(ho(se(),t,e,i,n,s))}function hl(t,e,i,n,s,a,r){Tc(bo(se(),t,e,i,n,s,a,r))}function bl(t,e,i,n,s,a,r,o,c){Tc(mo(se(),t,e,i,n,s,a,r,o,c))}function ml(t,e,i,n,s,a,r,o,c,l,u){Tc(po(se(),t,e,i,n,s,a,r,o,c,l,u))}function pl(t,e,i,n,s,a,r,o,c,l,u,d,h){Tc(go(se(),t,e,i,n,s,a,r,o,c,l,u,d,h))}function gl(t,e,i,n,s,a,r,o,c,l,u,d,h,b,m){Tc(fo(se(),t,e,i,n,s,a,r,o,c,l,u,d,h,b,m))}function fl(t,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p,g){Tc(vo(se(),t,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p,g))}function vl(t){Tc(lo(se(),t))}function yl(t,e,i,n,s){return Mc(t,uo(se(),e,i,n),s,!1),yl}function _l(t,e,i,n,s,a,r){return Mc(t,ho(se(),e,i,n,s,a),r,!1),_l}function kl(t,e,i,n,s,a,r,o,c){return Mc(t,bo(se(),e,i,n,s,a,r,o),c,!1),kl}function wl(t,e,i,n,s,a,r,o,c,l,u){return Mc(t,mo(se(),e,i,n,s,a,r,o,c,l),u,!1),wl}function Sl(t,e,i,n,s,a,r,o,c,l,u,d,h){return Mc(t,po(se(),e,i,n,s,a,r,o,c,l,u,d),h,!1),Sl}function Il(t,e,i,n,s,a,r,o,c,l,u,d,h,b,m){return Mc(t,go(se(),e,i,n,s,a,r,o,c,l,u,d,h,b),m,!1),Il}function Cl(t,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p,g){return Mc(t,fo(se(),e,i,n,s,a,r,o,c,l,u,d,h,b,m,p),g,!1),Cl}function Ll(t,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p,g,f,v){return Mc(t,vo(se(),e,i,n,s,a,r,o,c,l,u,d,h,b,m,p,g,f),v,!1),Ll}function Rl(t,e,i){return Mc(t,lo(se(),e),i,!1),Rl}function Ol(t,e,i){const n=se();return so(n,ve(),e)&&Ha(ae(),De(),n,t,e,n[11],i,!0),Ol}function Tl(t,e,i){const n=se();if(so(n,ve(),e)){const s=ae(),a=De();Ha(s,a,n,t,e,yr(Se(s.data),a,n),i,!0)}return Tl}const xl=void 0;var Bl=["en",[["a","p"],["AM","PM"],xl],[["AM","PM"],xl,xl],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],xl,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],xl,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",xl,"{1} 'at' {0}",xl],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){let e=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let jl={};function Ml(t,e,i){"string"!=typeof e&&(i=e,e=t[Nl.LocaleId]),e=e.toLowerCase().replace(/_/g,"-"),jl[e]=t,i&&(jl[e][Nl.ExtraData]=i)}function Ql(t){const e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let i=El(e);if(i)return i;const n=e.split("-")[0];if(i=El(n),i)return i;if("en"===n)return Bl;throw new Error(`Missing locale data for the locale "${t}".`)}function Al(t){return Ql(t)[Nl.CurrencyCode]||null}function Dl(t){return Ql(t)[Nl.PluralCase]}function El(t){return t in jl||(jl[t]=$.ng&&$.ng.common&&$.ng.common.locales&&$.ng.common.locales[t]),jl[t]}var Nl=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}({});const Fl=["zero","one","two","few","many"],Pl="en-US",Ul={marker:"element"},zl={marker:"ICU"};var Jl=function(t){return t[t.SHIFT=2]="SHIFT",t[t.APPEND_EAGERLY=1]="APPEND_EAGERLY",t[t.COMMENT=2]="COMMENT",t}({});let ql=Pl;function Vl(t){var e;null==(e=t)&&C("Expected localeId to be defined",e,null,"!="),"string"==typeof t&&(ql=t.toLowerCase().replace(/_/g,"-"))}function $l(t,e,i){const n=e.insertBeforeIndex,s=Array.isArray(n)?n[0]:n;return null===s?Xs(t,0,i):zt(i[s])}function Gl(t,e,i,n,s){const a=e.insertBeforeIndex;if(Array.isArray(a)){let r=n,o=null;if(3&e.type||(o=r,r=s),null!==r&&0==(2&e.flags))for(let e=1;e<a.length;e++)Gs(t,r,i[a[e]],o,!1)}}function Hl(t,e){if(t.push(e),t.length>1)for(let i=t.length-2;i>=0;i--){const n=t[i];Yl(n)||Wl(n,e)&&null===Kl(n)&&Xl(n,e.index)}}function Yl(t){return!(64&t.type)}function Wl(t,e){return Yl(e)||t.index>e.index}function Kl(t){const e=t.insertBeforeIndex;return Array.isArray(e)?e[0]:e}function Xl(t,e){const i=t.insertBeforeIndex;Array.isArray(i)?i[0]=e:(ea($l,Gl),t.insertBeforeIndex=e)}function Zl(t,e){const i=t.data[e];return null===i||"string"==typeof i?null:i.hasOwnProperty("currentCaseLViewIndex")?i:i.value}function tu(t,e,i){const n=Aa(t,i,64,null,null);return Hl(e,n),n}function eu(t,e){const i=e[t.currentCaseLViewIndex];return null===i?i:i<0?~i:i}let iu=0,nu=0;function su(t,e,i,n){const s=i[11];let a,r=null;for(let o=0;o<e.length;o++){const c=e[o];if("string"==typeof c){const t=e[++o];null===i[t]&&(i[t]=Es(s,c))}else if("number"==typeof c)switch(1&c){case 0:const l=c>>>17;let u,d;if(null===r&&(r=l,a=Ws(s,n)),l===r?(u=n,d=a):(u=null,d=zt(i[l])),null!==d){const e=(131070&c)>>>1;Gs(s,d,i[e],u,!1);const n=Zl(t,e);if(null!==n&&"object"==typeof n){const e=eu(n,i);null!==e&&su(t,n.create[e],i,i[n.anchorIdx])}}break;case 1:const h=e[++o],b=e[++o];sr(s,Jt(c>>>1,i),null,null,h,b,null);break;default:throw new Error(`Unable to determine the type of mutate operation for "${c}"`)}else switch(c){case zl:const t=e[++o],n=e[++o];null===i[n]&&Ss(i[n]=Fs(s,t),i);break;case Ul:const a=e[++o],r=e[++o];null===i[r]&&Ss(i[r]=Ps(s,a,null),i)}}}function au(t,e,i,n,s){for(let a=0;a<i.length;a++){const r=i[a],o=i[++a];if(r&s){let s="";for(let r=a+1;r<=a+o;r++){const a=i[r];if("string"==typeof a)s+=a;else if("number"==typeof a)if(a<0)s+=Lt(e[n-a]);else{const o=a>>>2;switch(3&a){case 1:const a=i[++r],c=i[++r],l=t.data[o];"string"==typeof l?sr(e[11],e[o],null,l,a,s,c):Ha(t,l,e,a,s,e[11],c,!1);break;case 0:const u=e[o];null!==u&&Ns(e[11],u,s);break;case 2:ou(t,Zl(t,o),e,s);break;case 3:ru(t,Zl(t,o),n,e)}}}}else{const s=i[a+1];if(s>0&&3==(3&s)){const i=Zl(t,s>>>2);e[i.currentCaseLViewIndex]<0&&ru(t,i,n,e)}}a+=o}}function ru(t,e,i,n){let s=n[e.currentCaseLViewIndex];if(null!==s){let a=iu;s<0&&(s=n[e.currentCaseLViewIndex]=~s,a=-1),au(t,n,e.update[s],i,a)}}function ou(t,e,i,n){const s=function(t,e){let i=t.cases.indexOf(e);if(-1===i)switch(t.type){case 1:{const n=function(t,e){const i=Dl(e)(parseInt(t,10)),n=Fl[i];return void 0!==n?n:"other"}(e,ql);i=t.cases.indexOf(n),-1===i&&"other"!==n&&(i=t.cases.indexOf("other"));break}case 0:i=t.cases.indexOf("other")}return-1===i?null:i}(e,n);if(eu(e,i)!==s&&(cu(t,e,i),i[e.currentCaseLViewIndex]=null===s?null:~s,null!==s)){const n=i[e.anchorIdx];n&&su(t,e.create[s],i,n)}}function cu(t,e,i){let n=eu(e,i);if(null!==n){const s=e.remove[n];for(let e=0;e<s.length;e++){const n=s[e];if(n>0){const t=Jt(n,i);null!==t&&aa(i[11],t)}else cu(t,Zl(t,~n),i)}}}const lu=/\ufffd(\d+):?\d*\ufffd/gi,uu=/({\s*\ufffd\d+:?\d*\ufffd\s*,\s*\S{6}\s*,[\s\S]*})/gi,du=/\ufffd(\d+)\ufffd/,hu=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,bu=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,mu=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,pu=/\uE500/g;function gu(t,e,i,n,s,a,r){const o=Da(t,n,1,null);let c=o<<Jl.SHIFT,l=le();e===l&&(l=null),null===l&&(c|=Jl.APPEND_EAGERLY),r&&(c|=Jl.COMMENT,void 0===xs&&(xs=function(){const t=[];let e,i,n=-1;function s(t,e){n=0;const s=eu(t,e);i=null!==s?t.remove[s]:H}function a(){if(n<i.length){const r=i[n++];return r>0?e[r]:(t.push(n,i),s(e[1].data[~r],e),a())}return 0===t.length?null:(i=t.pop(),n=t.pop(),a())}return function(i,n){for(e=n;t.length;)t.pop();return s(i.value,n),a}}())),s.push(c,null===a?"":a);const u=Aa(t,o,r?32:1,null===a?"":a,null);Hl(i,u);const d=u.index;return ue(u,!1),null!==l&&e!==l&&function(t,e){let i=t.insertBeforeIndex;var n;null===i?(ea($l,Gl),i=t.insertBeforeIndex=[null,e]):("Expecting array here",(n=Array.isArray(i))!=!0&&C("Expecting array here",n,true,"=="),i.push(e))}(l,d),u}function fu(t,e,i,n,s,a,r){const o=r.match(lu),c=gu(t,e,i,a,n,o?null:r,!1);o&&vu(s,r,c.index)}function vu(t,e,i,n,s=null){const a=t.length,r=a+1;t.push(null,null);const o=a+2,c=e.split(lu);let l=0;for(let u=0;u<c.length;u++){const e=c[u];if(1&u){const i=parseInt(e,10);t.push(-1-i),l|=yu(i)}else""!==e&&t.push(e)}return t.push(i<<2|(n?1:0)),n&&t.push(n,s),t[a]=l,t[r]=t.length-o,l}function yu(t){return 1<<Math.min(t,31)}function _u(t){let e,i,n="",s=0,a=!1;for(;null!==(e=bu.exec(t));)a?e[0]===`\ufffd/*${i}\ufffd`&&(s=e.index,a=!1):(n+=t.substring(s,e.index+e[0].length),i=e[1],a=!0);return n+=t.substr(s),n}function ku(t,e,i,n,s,a){let r=0;const o={type:s.type,currentCaseLViewIndex:Da(t,e,1,null),anchorIdx:a,cases:[],create:[],remove:[],update:[]};!function(t,e,i){t.push(yu(e.mainBinding),2,-1-e.mainBinding,i<<2|2)}(i,s,a),function(t,e,i){const n=t.data[e];null===n?t.data[e]=i:n.value=i}(t,a,o);const c=s.values;for(let l=0;l<c.length;l++){const a=c[l],u=[];for(let t=0;t<a.length;t++){const e=a[t];if("string"!=typeof e){const i=u.push(e)-1;a[t]=`\x3c!--\ufffd${i}\ufffd--\x3e`}}r=Iu(t,o,e,i,n,s.cases[l],a.join(""),u)|r}r&&function(t,e,i){t.push(e,1,i<<2|3)}(i,r,a)}function wu(t){const e=[],i=[];let n=1,s=0;const a=Su(t=t.replace(hu,function(t,e,i){return n="select"===i?0:1,s=parseInt(e.substr(1),10),""}));for(let r=0;r<a.length;){let t=a[r++].trim();1===n&&(t=t.replace(/\s*(?:=)?(\w+)\s*/,"$1")),t.length&&e.push(t);const s=Su(a[r++]);e.length>i.length&&i.push(s)}return{type:n,mainBinding:s,cases:e,values:i}}function Su(t){if(!t)return[];let e=0;const i=[],n=[],s=/[{}]/g;let a;for(s.lastIndex=0;a=s.exec(t);){const s=a.index;if("}"==a[0]){if(i.pop(),0==i.length){const i=t.substring(e,s);hu.test(i)?n.push(wu(i)):n.push(i),e=s+1}}else{if(0==i.length){const i=t.substring(e,s);n.push(i),e=s+1}i.push("{")}}const r=t.substring(e);return n.push(r),n}function Iu(t,e,i,n,s,a,r,o){const c=[],l=[],u=[];e.cases.push(a),e.create.push(c),e.remove.push(l),e.update.push(u);const d=Dn(Ft()).getInertBodyElement(r),h=rs(d)||d;return h?Cu(t,e,i,n,c,l,u,h,s,o,0):0}function Cu(t,e,i,n,s,a,r,o,c,l,u){let d=0,h=o.firstChild;for(;h;){const o=Da(t,i,1,null);switch(h.nodeType){case Node.ELEMENT_NODE:const b=h,m=b.tagName.toLowerCase();if(Yn.hasOwnProperty(m)){Ou(s,Ul,m,c,o),t.data[o]=m;const p=b.attributes;for(let t=0;t<p.length;t++){const e=p.item(t),i=e.name.toLowerCase();e.value.match(lu)?Xn.hasOwnProperty(i)&&(Wn[i]?vu(r,e.value,o,e.name,Un):Kn[i]?vu(r,e.value,o,e.name,zn):vu(r,e.value,o,e.name)):Tu(s,o,e)}d=Cu(t,e,i,n,s,a,r,h,o,l,u+1)|d,Lu(a,o,u)}break;case Node.TEXT_NODE:const p=h.textContent||"",g=p.match(lu);Ou(s,null,g?"":p,c,o),Lu(a,o,u),g&&(d=vu(r,p,o)|d);break;case Node.COMMENT_NODE:const f=du.exec(h.textContent||"");if(f){const e=l[parseInt(f[1],10)];Ou(s,zl,"",c,o),ku(t,i,n,c,e,o),Ru(a,o,u)}}h=h.nextSibling}return d}function Lu(t,e,i){0===i&&t.push(e)}function Ru(t,e,i){0===i&&(t.push(~e),t.push(e))}function Ou(t,e,i,n,s){null!==e&&t.push(e),t.push(i,s,0|n<<17|s<<1)}function Tu(t,e,i){t.push(e<<1|1,i.name,i.value)}const xu=/\[(\ufffd.+?\ufffd?)\]/,Bu=/\[(\ufffd.+?\ufffd?)\]|(\ufffd\/?\*\d+:\d+\ufffd)/g,ju=/({\s*)(VAR_(PLURAL|SELECT)(_\d+)?)(\s*,)/g,Mu=/{([A-Z0-9_]+)}/g,Qu=/\ufffdI18N_EXP_(ICU(_\d+)?)\ufffd/g,Au=/\/\*/,Du=/\d+\:(\d+)/;function Eu(t,e,i=-1){const n=ae(),s=se(),a=gt+t,r=Kt(n.consts,e),o=le();n.firstCreatePass&&function(t,e,i,n,s,a){const r=le(),o=[],c=[],l=[[]],u=(d=s=function(t,e){if(function(t){return-1===t}(e))return _u(t);{const i=t.indexOf(`:${e}\ufffd`)+2+e.toString().length,n=t.search(new RegExp(`\ufffd\\/\\*\\d+:${e}\ufffd`));return _u(t.substring(i,n))}}(s,a),d.replace(pu," ")).split(mu);var d;for(let h=0;h<u.length;h++){let n=u[h];if(0==(1&h)){const a=Su(n);for(let n=0;n<a.length;n++){let u=a[n];if(0==(1&n)){const e=u;""!==e&&fu(t,r,l[0],o,c,i,e)}else{const n=u;if("object"!=typeof n)throw new Error(`Unable to parse ICU expression in "${s}" message.`);ku(t,i,c,e,n,gu(t,r,l[0],i,o,"",!0).index)}}}else{const e=47===n.charCodeAt(0),i=(n.charCodeAt(e?1:0),gt+Number.parseInt(n.substring(e?2:1)));if(e)l.shift(),ue(le(),!1);else{const e=tu(t,l[0],i);l.unshift([]),ue(e,!0)}}}t.data[n]={create:o,update:c}}(n,null===o?0:o.index,s,a,r,i);const c=n.data[a],l=$s(n,o===s[6]?null:o,s);!function(t,e,i,n){const s=t[11];for(let a=0;a<e.length;a++){const r=e[a++],o=e[a],c=(r&Jl.COMMENT)===Jl.COMMENT,l=(r&Jl.APPEND_EAGERLY)===Jl.APPEND_EAGERLY,u=r>>>Jl.SHIFT;let d=t[u];null===d&&(d=t[u]=c?s.createComment(o):Es(s,o)),l&&null!==i&&Gs(s,i,d,n,!1)}}(s,c.create,l,o&&8&o.type?s[o.index]:null),_e(!0)}function Nu(){_e(!1)}function Fu(t,e,i){Eu(t,e,i),Nu()}function Pu(t,e){const i=ae(),n=Kt(i.consts,e);!function(t,e,i){const n=oe().index,s=[];if(t.firstCreatePass&&null===t.data[e]){for(let t=0;t<i.length;t+=2){const e=i[t],a=i[t+1];if(""!==a){if(uu.test(a))throw new Error(`ICU expressions are not supported in attributes. Message: "${a}".`);vu(s,a,n,e)}}t.data[e]=s}}(i,t+gt,n)}function Uu(t){return so(se(),ve(),t)&&(iu|=1<<Math.min(nu,31)),nu++,Uu}function zu(t){!function(t,e,i){if(nu>0){const n=t.data[i];au(t,e,Array.isArray(n)?n:n.update,ge()-nu-1,iu)}iu=0,nu=0}(ae(),se(),t+gt)}function Ju(t,e={}){return function(t,e={}){let i=t;if(xu.test(t)){const t={},e=[0];i=i.replace(Bu,(i,n,s)=>{const a=n||s,r=t[a]||[];if(r.length||(a.split("|").forEach(t=>{const e=t.match(Du),i=e?parseInt(e[1],10):0,n=Au.test(t);r.push([i,n,t])}),t[a]=r),!r.length)throw new Error("i18n postprocess: unmatched placeholder - "+a);const o=e[e.length-1];let c=0;for(let t=0;t<r.length;t++)if(r[t][0]===o){c=t;break}const[l,u,d]=r[c];return u?e.pop():o!==l&&e.push(l),r.splice(c,1),d})}return Object.keys(e).length?(i=i.replace(ju,(t,i,n,s,a,r)=>e.hasOwnProperty(n)?`${i}${e[n]}${r}`:t),i=i.replace(Mu,(t,i)=>e.hasOwnProperty(i)?e[i]:t),i=i.replace(Qu,(t,i)=>{if(e.hasOwnProperty(i)){const n=e[i];if(!n.length)throw new Error(`i18n postprocess: unmatched ICU - ${t} with key: ${i}`);return n.shift()}return t}),i):i}(t,e)}function qu(t,e,i,n,s){if(t=S(t),Array.isArray(t))for(let a=0;a<t.length;a++)qu(t[a],e,i,n,s);else{const a=ae(),r=se();let o=Nr(t)?t:S(t.provide),c=Ar(t);const l=oe(),u=1048575&l.providerIndexes,d=l.directiveStart,h=l.providerIndexes>>20;if(Nr(t)||!t.multi){const n=new Ge(c,s,Eo),b=Gu(o,e,s?u:u+h,d);-1===b?(li(ai(l,r),a,o),Vu(a,t,e.length),e.push(o),l.directiveStart++,l.directiveEnd++,s&&(l.providerIndexes+=1048576),i.push(n),r.push(n)):(i[b]=n,r[b]=n)}else{const b=Gu(o,e,u+h,d),m=Gu(o,e,u,u+h),p=b>=0&&i[b],g=m>=0&&i[m];if(s&&!g||!s&&!p){li(ai(l,r),a,o);const u=function(t,e,i,n,s){const a=new Ge(t,i,Eo);return a.multi=[],a.index=e,a.componentProviders=0,$u(a,s,n&&!i),a}(s?Yu:Hu,i.length,s,n,c);!s&&g&&(i[m].providerFactory=u),Vu(a,t,e.length,0),e.push(o),l.directiveStart++,l.directiveEnd++,s&&(l.providerIndexes+=1048576),i.push(u),r.push(u)}else Vu(a,t,b>-1?b:m,$u(i[s?m:b],c,!s&&n));!s&&n&&g&&i[m].componentProviders++}}}function Vu(t,e,i,n){const s=Nr(e);if(s||e.useClass){const a=(e.useClass||e).prototype.ngOnDestroy;if(a){const r=t.destroyHooks||(t.destroyHooks=[]);if(!s&&e.multi){const t=r.indexOf(i);-1===t?r.push(i,[n,a]):r[t+1].push(n,a)}else r.push(i,a)}}}function $u(t,e,i){return i&&t.componentProviders++,t.multi.push(e)-1}function Gu(t,e,i,n){for(let s=i;s<n;s++)if(e[s]===t)return s;return-1}function Hu(t,e,i,n){return Wu(this.multi,[])}function Yu(t,e,i,n){const s=this.multi;let a;if(this.providerFactory){const t=this.providerFactory.componentProviders,e=fi(i,i[1],this.providerFactory.index,n);a=e.slice(0,t),Wu(s,a);for(let i=t;i<e.length;i++)a.push(e[i])}else a=[],Wu(s,a);return a}function Wu(t,e){for(let i=0;i<t.length;i++)e.push((0,t[i])());return e}function Ku(t,e=[]){return i=>{i.providersResolver=(i,n)=>function(t,e,i){const n=ae();if(n.firstCreatePass){const s=St(t);qu(i,n.data,n.blueprint,s,!0),qu(e,n.data,n.blueprint,s,!1)}}(i,n?n(t):t,e)}}class Xu{}class Zu{resolveComponentFactory(t){throw function(t){const e=Error(`No component factory found for ${y(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(t)}}let td=(()=>{class t{}return t.NULL=new Zu,t})();function ed(...t){}function id(t,e){return new sd(qt(t,e))}const nd=function(){return id(oe(),se())};let sd=(()=>{class t{constructor(t){this.nativeElement=t}}return t.__NG_ELEMENT_ID__=nd,t})();class ad{}let rd=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>od(),t})();const od=function(){const t=se(),e=Gt(oe().index,t);return function(t){return t[11]}(vt(e)?e:t)};let cd=(()=>{class t{}return t.\u0275prov=L({token:t,providedIn:"root",factory:()=>null}),t})();class ld{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const ud=new ld("11.0.9");class dd{constructor(){}supports(t){return to(t)}create(t){return new bd(t)}}const hd=(t,e)=>e;class bd{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||hd}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,i=this._removalsHead,n=0,s=null;for(;e||i;){const a=!i||e&&e.currentIndex<fd(i,n,s)?e:i,r=fd(a,n,s),o=a.currentIndex;if(a===i)n--,i=i._nextRemoved;else if(e=e._next,null==a.previousIndex)n++;else{s||(s=[]);const t=r-n,e=o-n;if(t!=e){for(let i=0;i<t;i++){const n=i<s.length?s[i]:s[i]=0,a=n+i;e<=a&&a<t&&(s[i]=n+1)}s[a.previousIndex]=e-t}}r!==o&&t(a,r,o)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!to(t))throw new Error(`Error trying to diff '${y(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,i,n,s=this._itHead,a=!1;if(Array.isArray(t)){this.length=t.length;for(let e=0;e<this.length;e++)i=t[e],n=this._trackByFn(e,i),null!==s&&Object.is(s.trackById,n)?(a&&(s=this._verifyReinsertion(s,i,n,e)),Object.is(s.item,i)||this._addIdentityChange(s,i)):(s=this._mismatch(s,i,n,e),a=!0),s=s._next}else e=0,function(t,e){if(Array.isArray(t))for(let i=0;i<t.length;i++)e(t[i]);else{const i=t[Xr()]();let n;for(;!(n=i.next()).done;)e(n.value)}}(t,t=>{n=this._trackByFn(e,t),null!==s&&Object.is(s.trackById,n)?(a&&(s=this._verifyReinsertion(s,t,n,e)),Object.is(s.item,t)||this._addIdentityChange(s,t)):(s=this._mismatch(s,t,n,e),a=!0),s=s._next,e++}),this.length=e;return this._truncate(s),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,i,n){let s;return null===t?s=this._itTail:(s=t._prev,this._remove(t)),null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(i,n))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,s,n)):null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,s,n)):t=this._addAfter(new md(e,i),s,n),t}_verifyReinsertion(t,e,i,n){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?t=this._reinsertAfter(s,t._prev,n):t.currentIndex!=n&&(t.currentIndex=n,this._addToMoves(t,n)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const n=t._prevRemoved,s=t._nextRemoved;return null===n?this._removalsHead=s:n._nextRemoved=s,null===s?this._removalsTail=n:s._prevRemoved=n,this._insertAfter(t,e,i),this._addToMoves(t,i),t}_moveAfter(t,e,i){return this._unlink(t),this._insertAfter(t,e,i),this._addToMoves(t,i),t}_addAfter(t,e,i){return this._insertAfter(t,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,i){const n=null===e?this._itHead:e._next;return t._next=n,t._prev=e,null===n?this._itTail=t:n._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new gd),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,i=t._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new gd),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class md{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class pd{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){const e=t._prevDup,i=t._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class gd{constructor(){this.map=new Map}put(t){const e=t.trackById;let i=this.map.get(e);i||(i=new pd,this.map.set(e,i)),i.add(t)}get(t,e){const i=this.map.get(t);return i?i.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function fd(t,e,i){const n=t.previousIndex;if(null===n)return n;let s=0;return i&&n<i.length&&(s=i[n]),n+e+s}class vd{constructor(){}supports(t){return t instanceof Map||eo(t)}create(){return new yd}}class yd{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||eo(t)))throw new Error(`Error trying to diff '${y(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(t,i)=>{if(e&&e.key===i)this._maybeAddToChanges(e,t),this._appendAfter=e,e=e._next;else{const n=this._getOrCreateRecordForKey(i,t);e=this._insertBeforeOrAppend(e,n)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let t=e;null!==t;t=t._nextRemoved)t===this._mapHead&&(this._mapHead=null),this._records.delete(t.key),t._nextRemoved=t._next,t.previousValue=t.currentValue,t.currentValue=null,t._prev=null,t._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const i=t._prev;return e._next=t,e._prev=i,t._prev=e,i&&(i._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const i=this._records.get(t);this._maybeAddToChanges(i,e);const n=i._prev,s=i._next;return n&&(n._next=s),s&&(s._prev=n),i._next=null,i._prev=null,i}const i=new _d(t);return this._records.set(t,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(i=>e(t[i],i))}}class _d{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}let kd=(()=>{class t{constructor(t){this.factories=t}static create(e,i){if(null!=i){const t=i.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>{if(!i)throw new Error("Cannot extend IterableDiffers without a parent injector");return t.create(e,i)},deps:[[t,new nn,new tn]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(null!=e)return e;throw new Error(`Cannot find a differ supporting object '${t}' of type '${i=t,i.name||typeof i}'`);var i}}return t.\u0275prov=L({token:t,providedIn:"root",factory:()=>new t([new dd])}),t})(),wd=(()=>{class t{constructor(t){this.factories=t}static create(e,i){if(i){const t=i.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>{if(!i)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return t.create(e,i)},deps:[[t,new nn,new tn]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(e)return e;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return t.\u0275prov=L({token:t,providedIn:"root",factory:()=>new t([new vd])}),t})();function Sd(t,e,i,n,s=!1){for(;null!==i;){const a=e[i.index];if(null!==a&&n.push(zt(a)),yt(a))for(let t=ft;t<a.length;t++){const e=a[t],i=e[1].firstChild;null!==i&&Sd(e[1],e,i,n)}const r=i.type;if(8&r)Sd(t,e,i.child,n);else if(32&r){const t=Bs(i,e);let s;for(;s=t();)n.push(s)}else if(16&r){const t=e[16],s=t[6].projection[i.projection];if(Array.isArray(s))n.push(...s);else{const e=js(t);Sd(e[1],e,s,n,!0)}}i=s?i.projectionNext:i.next}return n}class Id{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return Sd(e,t,e.firstChild,[])}get context(){return this._lView[8]}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(yt(t)){const e=t[8],i=e?e.indexOf(this):-1;i>-1&&(zs(t,i),Ui(e,i))}this._attachedToViewContainer=!1}Js(this._lView[1],this._lView)}onDestroy(t){$a(this._lView[1],this._lView,null,t)}markForCheck(){hr(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){br(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,e,i){me(!0);try{br(t,e,i)}finally{me(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var t;this._appRef=null,oa(this._lView[1],t=this._lView,t[11],2,null,null)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}}class Cd extends Id{constructor(t){super(t),this._view=t}detectChanges(){mr(this._view)}checkNoChanges(){!function(t){me(!0);try{mr(t)}finally{me(!1)}}(this._view)}get context(){return null}}const Ld=Od;let Rd=(()=>{class t{}return t.__NG_ELEMENT_ID__=Ld,t.__ChangeDetectorRef__=!0,t})();function Od(t=!1){return function(t,e,i){if(!i&&kt(t)){const i=Gt(t.index,e);return new Id(i,i)}return 47&t.type?new Id(e[16],e):null}(oe(),se(),t)}const Td=[new vd],xd=new kd([new dd]),Bd=new wd(Td),jd=function(){return Dd(oe(),se())};let Md=(()=>{class t{}return t.__NG_ELEMENT_ID__=jd,t})();const Qd=Md,Ad=class extends Qd{constructor(t,e,i){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=i}createEmbeddedView(t){const e=this._declarationTContainer.tViews,i=Ma(this._declarationLView,e,t,16,null,e.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const n=this._declarationLView[19];return null!==n&&(i[19]=n.createEmbeddedView(e)),Ea(e,i,t),new Id(i)}};function Dd(t,e){return 4&t.type?new Ad(e,t,id(t,e)):null}class Ed{}class Nd{}const Fd=function(){return Vd(oe(),se())};let Pd=(()=>{class t{}return t.__NG_ELEMENT_ID__=Fd,t})();const Ud=Pd,zd=class extends Ud{constructor(t,e,i){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=i}get element(){return id(this._hostTNode,this._hostLView)}get injector(){return new _i(this._hostTNode,this._hostLView)}get parentInjector(){const t=ci(this._hostTNode,this._hostLView);if(Ze(t)){const e=ei(t,this._hostLView),i=ti(t);return new _i(e[1].data[i+8],e)}return new _i(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=Jd(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-ft}createEmbeddedView(t,e,i){const n=t.createEmbeddedView(e||{});return this.insert(n,i),n}createComponent(t,e,i,n,s){const a=i||this.parentInjector;if(!s&&null==t.ngModule&&a){const t=a.get(Ed,null);t&&(s=t)}const r=t.create(a,n,void 0,s);return this.insert(r.hostView,e),r}insert(t,e){const i=t._lView,n=i[1];if(yt(i[3])){const e=this.indexOf(t);if(-1!==e)this.detach(e);else{const e=i[3],n=new zd(e,e[6],e[3]);n.detach(n.indexOf(t))}}const s=this._adjustIndex(e),a=this._lContainer;!function(t,e,i,n){const s=ft+n,a=i.length;n>0&&(i[s-1][4]=e),n<a-ft?(e[4]=i[s],Pi(i,ft+n,e)):(i.push(e),e[4]=null),e[3]=i;const r=e[17];null!==r&&i!==r&&function(t,e){const i=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===i?t[9]=[e]:i.push(e)}(r,e);const o=e[19];null!==o&&o.insertView(t),e[2]|=128}(n,i,a,s);const r=sa(s,a),o=i[11],c=Ws(o,a[7]);return null!==c&&function(t,e,i,n,s,a){n[0]=s,n[6]=e,oa(t,n,i,1,s,a)}(n,a[6],o,i,c,r),t.attachToViewContainerRef(),Pi(qd(a),s,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=Jd(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),i=zs(this._lContainer,e);i&&(Ui(qd(this._lContainer),e),Js(i[1],i))}detach(t){const e=this._adjustIndex(t,-1),i=zs(this._lContainer,e);return i&&null!=Ui(qd(this._lContainer),e)?new Id(i):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}};function Jd(t){return t[8]}function qd(t){return t[8]||(t[8]=[])}function Vd(t,e){let i;const n=e[t.index];if(yt(n))i=n;else{let s;if(8&t.type)s=zt(n);else{const i=e[11];s=i.createComment("");const n=qt(t,e);Gs(i,Ws(i,n),s,function(t,e){return Pt(t)?t.nextSibling(e):e.nextSibling}(i,n),!1)}e[t.index]=i=or(n,e,s,t),dr(e,i)}return new zd(i,t,e)}const $d={};class Gd extends td{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=bt(t);return new Wd(e,this.ngModule)}}function Hd(t){const e=[];for(let i in t)t.hasOwnProperty(i)&&e.push({propName:t[i],templateName:i});return e}const Yd=new ji("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Is});class Wd extends Xu{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=t.selectors.map(wa).join(","),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return Hd(this.componentDef.inputs)}get outputs(){return Hd(this.componentDef.outputs)}create(t,e,i,n){const s=(n=n||this.ngModule)?function(t,e){return{get:(i,n,s)=>{const a=t.get(i,$d,s);return a!==$d||n===$d?a:e.get(i,n,s)}}}(t,n.injector):t,a=s.get(ad,Ut),r=s.get(cd,null),o=a.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",l=i?function(t,e,i){if(Pt(t))return t.selectRootElement(e,i===U.ShadowDom);let n="string"==typeof e?t.querySelector(e):e;return n.textContent="",n}(o,i,this.componentDef.encapsulation):Ps(a.createRenderer(null,this.componentDef),c,function(t){const e=t.toLowerCase();return"svg"===e?At:"math"===e?Dt:null}(c)),u=this.componentDef.onPush?576:528,d={components:[],scheduler:Is,clean:gr,playerHandler:null,flags:0},h=Va(0,null,null,1,0,null,null,null,null,null),b=Ma(null,h,d,u,null,null,a,o,r,s);let m,p;Oe(b);try{const t=function(t,e,i,n,s,a){const r=i[1];i[20]=t;const o=Qa(r,20,2,"#host",null),c=o.mergedAttrs=e.hostAttrs;null!==c&&(Sr(o,c,!0),null!==t&&(He(s,t,c),null!==o.classes&&ua(s,t,o.classes),null!==o.styles&&la(s,t,o.styles)));const l=n.createRenderer(t,e),u=Ma(i,qa(e),null,e.onPush?64:16,i[20],o,n,l,null,null);return r.firstCreatePass&&(li(ai(o,i),r,e.type),Xa(r,o),tr(o,i.length,1)),dr(i,u),i[20]=u}(l,this.componentDef,b,a,o);if(l)if(i)He(o,l,["ng-version",ud.full]);else{const{attrs:t,classes:e}=function(t){const e=[],i=[];let n=1,s=2;for(;n<t.length;){let a=t[n];if("string"==typeof a)2===s?""!==a&&e.push(a,t[++n]):8===s&&i.push(a);else{if(!fa(s))break;s=a}n++}return{attrs:e,classes:i}}(this.componentDef.selectors[0]);t&&He(o,l,t),e&&e.length>0&&ua(o,l,e.join(" "))}if(p=Vt(h,gt),void 0!==e){const t=p.projection=[];for(let i=0;i<this.ngContentSelectors.length;i++){const n=e[i];t.push(null!=n?Array.from(n):null)}}m=function(t,e,i,n,s){const a=i[1],r=function(t,e,i){const n=oe();t.firstCreatePass&&(i.providersResolver&&i.providersResolver(i),er(t,n,e,Da(t,e,1,null),i));const s=fi(e,t,n.directiveStart,n);Ss(s,e);const a=qt(n,e);return a&&Ss(a,e),s}(a,i,e);if(n.components.push(r),t[8]=r,s&&s.forEach(t=>t(r,e)),e.contentQueries){const t=oe();e.contentQueries(1,r,t.directiveStart)}const o=oe();return!a.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(Ae(o.index),Wa(i[1],o,0,o.directiveStart,o.directiveEnd,e),Ka(e,r)),r}(t,this.componentDef,b,d,[Ur]),Ea(h,b,null)}finally{Me()}return new Kd(this.componentType,m,id(p,b),b,p)}}class Kd extends class{}{constructor(t,e,i,n,s){super(),this.location=i,this._rootLView=n,this._tNode=s,this.instance=e,this.hostView=this.changeDetectorRef=new Cd(n),this.componentType=t}get injector(){return new _i(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}const Xd=new Map;class Zd extends Ed{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Gd(this);const i=pt(t),n=t[Z]||null;n&&Vl(n),this._bootstrapComponents=Os(i.bootstrap),this._r3Injector=jr(t,e,[{provide:Ed,useValue:this},{provide:td,useValue:this.componentFactoryResolver}],y(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=Pr.THROW_IF_NOT_FOUND,i=A.Default){return t===Pr||t===Ed||t===Ir?this:this._r3Injector.get(t,e,i)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class th extends Nd{constructor(t){super(),this.moduleType=t,null!==pt(t)&&function(t){const e=new Set;!function t(i){const n=pt(i,!0),s=n.id;null!==s&&(function(t,e,i){if(e&&e!==i)throw new Error(`Duplicate module registered for ${t} - ${y(e)} vs ${y(e.name)}`)}(s,Xd.get(s),i),Xd.set(s,i));const a=Os(n.imports);for(const r of a)e.has(r)||(e.add(r),t(r))}(t)}(t)}create(t){return new Zd(this.moduleType,t)}}function eh(t,e,i){const n=pe()+t,s=se();return s[n]===Sa?io(s,n,i?e.call(i):e()):no(s,n)}function ih(t,e,i,n){return hh(se(),pe(),t,e,i,n)}function nh(t,e,i,n,s){return bh(se(),pe(),t,e,i,n,s)}function sh(t,e,i,n,s,a){return mh(se(),pe(),t,e,i,n,s,a)}function ah(t,e,i,n,s,a,r){return ph(se(),pe(),t,e,i,n,s,a,r)}function rh(t,e,i,n,s,a,r,o){const c=pe()+t,l=se(),u=oo(l,c,i,n,s,a);return so(l,c+4,r)||u?io(l,c+5,o?e.call(o,i,n,s,a,r):e(i,n,s,a,r)):no(l,c+5)}function oh(t,e,i,n,s,a,r,o,c){const l=pe()+t,u=se(),d=oo(u,l,i,n,s,a);return ao(u,l+4,r,o)||d?io(u,l+6,c?e.call(c,i,n,s,a,r,o):e(i,n,s,a,r,o)):no(u,l+6)}function ch(t,e,i,n,s,a,r,o,c,l){const u=pe()+t,d=se();let h=oo(d,u,i,n,s,a);return ro(d,u+4,r,o,c)||h?io(d,u+7,l?e.call(l,i,n,s,a,r,o,c):e(i,n,s,a,r,o,c)):no(d,u+7)}function lh(t,e,i,n,s,a,r,o,c,l,u){const d=pe()+t,h=se(),b=oo(h,d,i,n,s,a);return oo(h,d+4,r,o,c,l)||b?io(h,d+8,u?e.call(u,i,n,s,a,r,o,c,l):e(i,n,s,a,r,o,c,l)):no(h,d+8)}function uh(t,e,i,n){return gh(se(),pe(),t,e,i,n)}function dh(t,e){const i=t[e];return i===Sa?void 0:i}function hh(t,e,i,n,s,a){const r=e+i;return so(t,r,s)?io(t,r+1,a?n.call(a,s):n(s)):dh(t,r+1)}function bh(t,e,i,n,s,a,r){const o=e+i;return ao(t,o,s,a)?io(t,o+2,r?n.call(r,s,a):n(s,a)):dh(t,o+2)}function mh(t,e,i,n,s,a,r,o){const c=e+i;return ro(t,c,s,a,r)?io(t,c+3,o?n.call(o,s,a,r):n(s,a,r)):dh(t,c+3)}function ph(t,e,i,n,s,a,r,o,c){const l=e+i;return oo(t,l,s,a,r,o)?io(t,l+4,c?n.call(c,s,a,r,o):n(s,a,r,o)):dh(t,l+4)}function gh(t,e,i,n,s,a){let r=e+i,o=!1;for(let c=0;c<s.length;c++)so(t,r++,s[c])&&(o=!0);return o?io(t,r,n.apply(a,s)):dh(t,r)}function fh(t,e){const i=ae();let n;const s=t+gt;i.firstCreatePass?(n=function(t,e){if(e)for(let i=e.length-1;i>=0;i--){const n=e[i];if(t===n.name)return n}throw new Ct("302",`The pipe '${t}' could not be found!`)}(e,i.pipeRegistry),i.data[s]=n,n.onDestroy&&(i.destroyHooks||(i.destroyHooks=[])).push(s,n.onDestroy)):n=i.data[s];const a=n.factory||(n.factory=It(n.type)),r=E(Eo);try{const t=ni(!1),e=a();return ni(t),function(t,e,i,n){i>=t.data.length&&(t.data[i]=null,t.blueprint[i]=null),e[i]=n}(i,se(),s,e),e}finally{E(r)}}function vh(t,e,i){const n=t+gt,s=se(),a=$t(s,n);return Ih(s,Sh(s,n)?hh(s,pe(),e,a.transform,i,a):a.transform(i))}function yh(t,e,i,n){const s=t+gt,a=se(),r=$t(a,s);return Ih(a,Sh(a,s)?bh(a,pe(),e,r.transform,i,n,r):r.transform(i,n))}function _h(t,e,i,n,s){const a=t+gt,r=se(),o=$t(r,a);return Ih(r,Sh(r,a)?mh(r,pe(),e,o.transform,i,n,s,o):o.transform(i,n,s))}function kh(t,e,i,n,s,a){const r=t+gt,o=se(),c=$t(o,r);return Ih(o,Sh(o,r)?ph(o,pe(),e,c.transform,i,n,s,a,c):c.transform(i,n,s,a))}function wh(t,e,i){const n=t+gt,s=se(),a=$t(s,n);return Ih(s,Sh(s,n)?gh(s,pe(),e,a.transform,i,a):a.transform.apply(a,i))}function Sh(t,e){return t[1].data[e].pure}function Ih(t,e){return Zr.isWrapped(e)&&(e=Zr.unwrap(e),t[ge()]=Sa),e}const Ch=class extends n.a{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,i){let n,a=t=>null,r=()=>null;t&&"object"==typeof t?(n=this.__isAsync?e=>{setTimeout(()=>t.next(e))}:e=>{t.next(e)},t.error&&(a=this.__isAsync?e=>{setTimeout(()=>t.error(e))}:e=>{t.error(e)}),t.complete&&(r=this.__isAsync?()=>{setTimeout(()=>t.complete())}:()=>{t.complete()})):(n=this.__isAsync?e=>{setTimeout(()=>t(e))}:e=>{t(e)},e&&(a=this.__isAsync?t=>{setTimeout(()=>e(t))}:t=>{e(t)}),i&&(r=this.__isAsync?()=>{setTimeout(()=>i())}:()=>{i()}));const o=super.subscribe(n,a,r);return t instanceof s.a&&t.add(o),o}};function Lh(){return this._results[Xr()]()}class Rh{constructor(){this.dirty=!0,this._results=[],this.changes=new Ch,this.length=0;const t=Xr(),e=Rh.prototype;e[t]||(e[t]=Lh)}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t){this._results=Ni(t),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}notifyOnChanges(){this.changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}class Oh{constructor(t){this.queryList=t,this.matches=null}clone(){return new Oh(this.queryList)}setDirty(){this.queryList.setDirty()}}class Th{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const i=null!==t.contentQueries?t.contentQueries[0]:e.length,n=[];for(let t=0;t<i;t++){const i=e.getByIndex(t);n.push(this.queries[i.indexInDeclarationView].clone())}return new Th(n)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==Gh(t,e).matches&&this.queries[e].setDirty()}}class xh{constructor(t,e,i,n=null){this.predicate=t,this.descendants=e,this.isStatic=i,this.read=n}}class Bh{constructor(t=[]){this.queries=t}elementStart(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let i=0;i<this.length;i++){const n=null!==e?e.length:0,s=this.getByIndex(i).embeddedTView(t,n);s&&(s.indexInDeclarationView=i,null!==e?e.push(s):e=[s])}return null!==e?new Bh(e):null}template(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class jh{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new jh(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&!1===this.metadata.descendants){const e=this._declarationNodeIndex;let i=t.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let n=0;n<i.length;n++){const s=i[n];this.matchTNodeWithReadOption(t,e,Mh(e,s)),this.matchTNodeWithReadOption(t,e,gi(e,t,s,!1,!1))}else i===Md?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,gi(e,t,i,!1,!1))}matchTNodeWithReadOption(t,e,i){if(null!==i){const n=this.metadata.read;if(null!==n)if(n===sd||n===Pd||n===Md&&4&e.type)this.addMatch(e.index,-2);else{const i=gi(e,t,n,!1,!1);null!==i&&this.addMatch(e.index,i)}else this.addMatch(e.index,i)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function Mh(t,e){const i=t.localNames;if(null!==i)for(let n=0;n<i.length;n+=2)if(i[n]===e)return i[n+1];return null}function Qh(t,e,i,n){return-1===i?function(t,e){return 11&t.type?id(t,e):4&t.type?Dd(t,e):null}(e,t):-2===i?function(t,e,i){return i===sd?id(e,t):i===Md?Dd(e,t):i===Pd?Vd(e,t):void 0}(t,e,n):fi(t,t[1],i,e)}function Ah(t,e,i,n){const s=e[19].queries[n];if(null===s.matches){const n=t.data,a=i.matches,r=[];for(let t=0;t<a.length;t+=2){const s=a[t];r.push(s<0?null:Qh(e,n[s],a[t+1],i.metadata.read))}s.matches=r}return s.matches}function Dh(t,e,i,n){const s=t.queries.getByIndex(i),a=s.matches;if(null!==a){const r=Ah(t,e,s,i);for(let t=0;t<a.length;t+=2){const i=a[t];if(i>0)n.push(r[t/2]);else{const s=a[t+1],r=e[-i];for(let t=ft;t<r.length;t++){const e=r[t];e[17]===e[3]&&Dh(e[1],e,s,n)}if(null!==r[9]){const t=r[9];for(let e=0;e<t.length;e++){const i=t[e];Dh(i[1],i,s,n)}}}}}return n}function Eh(t){const e=se(),i=ae(),n=Ie();Ce(n+1);const s=Gh(i,n);if(t.dirty&&Yt(e)===s.metadata.isStatic){if(null===s.matches)t.reset([]);else{const a=s.crossesNgTemplate?Dh(i,e,n,[]):Ah(i,e,s,n);t.reset(a),t.notifyOnChanges()}return!0}return!1}function Nh(t,e,i){Ph(ae(),se(),t,e,i,!0)}function Fh(t,e,i){Ph(ae(),se(),t,e,i,!1)}function Ph(t,e,i,n,s,a){t.firstCreatePass&&($h(t,new xh(i,n,a,s),-1),a&&(t.staticViewQueries=!0)),Vh(t,e)}function Uh(t,e,i,n){Jh(ae(),se(),e,i,n,!1,oe(),t)}function zh(t,e,i,n){Jh(ae(),se(),e,i,n,!0,oe(),t)}function Jh(t,e,i,n,s,a,r,o){t.firstCreatePass&&($h(t,new xh(i,n,a,s),r.index),function(t,e){const i=t.contentQueries||(t.contentQueries=[]);e!==(i.length?i[i.length-1]:-1)&&i.push(t.queries.length-1,e)}(t,o),a&&(t.staticContentQueries=!0)),Vh(t,e)}function qh(){return t=se(),e=Ie(),t[19].queries[e].queryList;var t,e}function Vh(t,e){const i=new Rh;$a(t,e,i,i.destroy),null===e[19]&&(e[19]=new Th),e[19].queries.push(new Oh(i))}function $h(t,e,i){null===t.queries&&(t.queries=new Bh),t.queries.track(new jh(e,i))}function Gh(t,e){return t.queries.getByIndex(e)}function Hh(t,e){return Dd(t,e)}function Yh(t=A.Default){const e=Od(!0);if(null!=e||t&A.Optional)return e;Ot("ChangeDetectorRef")}const Wh=(()=>({"\u0275\u0275attribute":co,"\u0275\u0275attributeInterpolate1":yo,"\u0275\u0275attributeInterpolate2":_o,"\u0275\u0275attributeInterpolate3":ko,"\u0275\u0275attributeInterpolate4":wo,"\u0275\u0275attributeInterpolate5":So,"\u0275\u0275attributeInterpolate6":Io,"\u0275\u0275attributeInterpolate7":Co,"\u0275\u0275attributeInterpolate8":Lo,"\u0275\u0275attributeInterpolateV":Ro,"\u0275\u0275defineComponent":nt,"\u0275\u0275defineDirective":dt,"\u0275\u0275defineInjectable":L,"\u0275\u0275defineInjector":R,"\u0275\u0275defineNgModule":ct,"\u0275\u0275definePipe":ht,"\u0275\u0275directiveInject":Eo,"\u0275\u0275getFactoryOf":ki,"\u0275\u0275getInheritedFactory":wi,"\u0275\u0275inject":fn,"\u0275\u0275injectAttribute":Si,"\u0275\u0275invalidFactory":No,"\u0275\u0275invalidFactoryDep":vn,"\u0275\u0275injectPipeChangeDetectorRef":Yh,"\u0275\u0275templateRefExtractor":Hh,"\u0275\u0275NgOnChangesFeature":xt,"\u0275\u0275ProvidersFeature":Ku,"\u0275\u0275CopyDefinitionFeature":Wr,"\u0275\u0275InheritDefinitionFeature":Jr,"\u0275\u0275nextContext":ec,"\u0275\u0275namespaceHTML":Fe,"\u0275\u0275namespaceMathML":Ne,"\u0275\u0275namespaceSVG":Ee,"\u0275\u0275enableBindings":ie,"\u0275\u0275disableBindings":ne,"\u0275\u0275elementStart":Uo,"\u0275\u0275elementEnd":zo,"\u0275\u0275element":Jo,"\u0275\u0275elementContainerStart":qo,"\u0275\u0275elementContainerEnd":Vo,"\u0275\u0275elementContainer":$o,"\u0275\u0275pureFunction0":eh,"\u0275\u0275pureFunction1":ih,"\u0275\u0275pureFunction2":nh,"\u0275\u0275pureFunction3":sh,"\u0275\u0275pureFunction4":ah,"\u0275\u0275pureFunction5":rh,"\u0275\u0275pureFunction6":oh,"\u0275\u0275pureFunction7":ch,"\u0275\u0275pureFunction8":lh,"\u0275\u0275pureFunctionV":uh,"\u0275\u0275getCurrentView":Go,"\u0275\u0275restoreView":re,"\u0275\u0275listener":Wo,"\u0275\u0275projection":sc,"\u0275\u0275syntheticHostProperty":Tl,"\u0275\u0275syntheticHostListener":Ko,"\u0275\u0275pipeBind1":vh,"\u0275\u0275pipeBind2":yh,"\u0275\u0275pipeBind3":_h,"\u0275\u0275pipeBind4":kh,"\u0275\u0275pipeBindV":wh,"\u0275\u0275projectionDef":nc,"\u0275\u0275hostProperty":Ol,"\u0275\u0275property":Fo,"\u0275\u0275propertyInterpolate":ac,"\u0275\u0275propertyInterpolate1":rc,"\u0275\u0275propertyInterpolate2":oc,"\u0275\u0275propertyInterpolate3":cc,"\u0275\u0275propertyInterpolate4":lc,"\u0275\u0275propertyInterpolate5":uc,"\u0275\u0275propertyInterpolate6":dc,"\u0275\u0275propertyInterpolate7":hc,"\u0275\u0275propertyInterpolate8":bc,"\u0275\u0275propertyInterpolateV":mc,"\u0275\u0275pipe":fh,"\u0275\u0275queryRefresh":Eh,"\u0275\u0275viewQuery":Fh,"\u0275\u0275staticViewQuery":Nh,"\u0275\u0275staticContentQuery":zh,"\u0275\u0275loadQuery":qh,"\u0275\u0275contentQuery":Uh,"\u0275\u0275reference":To,"\u0275\u0275classMap":Bc,"\u0275\u0275classMapInterpolate1":el,"\u0275\u0275classMapInterpolate2":il,"\u0275\u0275classMapInterpolate3":nl,"\u0275\u0275classMapInterpolate4":sl,"\u0275\u0275classMapInterpolate5":al,"\u0275\u0275classMapInterpolate6":rl,"\u0275\u0275classMapInterpolate7":ol,"\u0275\u0275classMapInterpolate8":cl,"\u0275\u0275classMapInterpolateV":ll,"\u0275\u0275styleMap":Tc,"\u0275\u0275styleMapInterpolate1":ul,"\u0275\u0275styleMapInterpolate2":dl,"\u0275\u0275styleMapInterpolate3":hl,"\u0275\u0275styleMapInterpolate4":bl,"\u0275\u0275styleMapInterpolate5":ml,"\u0275\u0275styleMapInterpolate6":pl,"\u0275\u0275styleMapInterpolate7":gl,"\u0275\u0275styleMapInterpolate8":fl,"\u0275\u0275styleMapInterpolateV":vl,"\u0275\u0275styleProp":Rc,"\u0275\u0275stylePropInterpolate1":yl,"\u0275\u0275stylePropInterpolate2":_l,"\u0275\u0275stylePropInterpolate3":kl,"\u0275\u0275stylePropInterpolate4":wl,"\u0275\u0275stylePropInterpolate5":Sl,"\u0275\u0275stylePropInterpolate6":Il,"\u0275\u0275stylePropInterpolate7":Cl,"\u0275\u0275stylePropInterpolate8":Ll,"\u0275\u0275stylePropInterpolateV":Rl,"\u0275\u0275classProp":Oc,"\u0275\u0275advance":Ia,"\u0275\u0275template":Oo,"\u0275\u0275text":qc,"\u0275\u0275textInterpolate":Vc,"\u0275\u0275textInterpolate1":$c,"\u0275\u0275textInterpolate2":Gc,"\u0275\u0275textInterpolate3":Hc,"\u0275\u0275textInterpolate4":Yc,"\u0275\u0275textInterpolate5":Wc,"\u0275\u0275textInterpolate6":Kc,"\u0275\u0275textInterpolate7":Xc,"\u0275\u0275textInterpolate8":Zc,"\u0275\u0275textInterpolateV":tl,"\u0275\u0275i18n":Fu,"\u0275\u0275i18nAttributes":Pu,"\u0275\u0275i18nExp":Uu,"\u0275\u0275i18nStart":Eu,"\u0275\u0275i18nEnd":Nu,"\u0275\u0275i18nApply":zu,"\u0275\u0275i18nPostprocess":Ju,"\u0275\u0275resolveWindow":Cs,"\u0275\u0275resolveDocument":Ls,"\u0275\u0275resolveBody":Rs,"\u0275\u0275setComponentScope":st,"\u0275\u0275setNgModuleScope":lt,"\u0275\u0275sanitizeHtml":cs,"\u0275\u0275sanitizeStyle":ls,"\u0275\u0275sanitizeResourceUrl":ds,"\u0275\u0275sanitizeScript":hs,"\u0275\u0275sanitizeUrl":us,"\u0275\u0275sanitizeUrlOrResourceUrl":gs,"\u0275\u0275trustConstantHtml":bs,"\u0275\u0275trustConstantScript":ms,"\u0275\u0275trustConstantResourceUrl":ps}))(),Kh=[],Xh=[];function Zh(t){return function(t){return void 0!==t.ngModule}(t)?t.ngModule:t}function tb(t,e){let i=null;(function(t,e){let i=null;Object.defineProperty(t,tt,{get:()=>{if(null===i){const n=eb(t,e),s=Ai();i=s.compileFactory(Wh,`ng:///${t.name}/\u0275fac.js`,Object.assign(Object.assign({},n.metadata),{injectFn:"directiveInject",target:s.R3FactoryTarget.Directive}))}return i},configurable:!1})})(t,e||{}),Object.defineProperty(t,W,{get:()=>{if(null===i){const n=eb(t,e||{});i=Ai().compileDirective(Wh,n.sourceMapUrl,n.metadata)}return i},configurable:!1})}function eb(t,e){const i=t&&t.name,n=`ng:///${i}/\u0275dir.js`,s=Ai(),a=function(t,e){const i=rn(),n=i.ownPropMetadata(t);return{name:t.name,type:t,typeArgumentCount:0,selector:void 0!==e.selector?e.selector:null,deps:on(t),host:e.host||G,propMetadata:n,inputs:e.inputs||H,outputs:e.outputs||H,queries:sb(t,n,ab),lifecycle:{usesOnChanges:i.hasLifecycleHook(t,"ngOnChanges")},typeSourceSpan:null,usesInheritance:!ib(t),exportAs:(s=e.exportAs,void 0===s?null:cb(s)),providers:e.providers||null,viewQueries:sb(t,n,rb)};var s}(t,e);return a.typeSourceSpan=s.createParseSourceSpan("Directive",i,n),a.usesInheritance&&function(t){const e=Object.prototype;let i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==e;)mt(i)||bt(i)||!ub(i)||tb(i,null),i=Object.getPrototypeOf(i)}(t),{metadata:a,sourceMapUrl:n}}function ib(t){return Object.getPrototypeOf(t.prototype)===Object.prototype}function nb(t,e){return{propertyName:t,predicate:(i=e.selector,"string"==typeof i?cb(i):S(i)),descendants:e.descendants,first:e.first,read:e.read?e.read:null,static:!!e.static};var i}function sb(t,e,i){const n=[];for(const s in e)if(e.hasOwnProperty(s)){const a=e[s];a.forEach(e=>{if(i(e)){if(!e.selector)throw new Error(`Can't construct a query for the property "${s}" of "${Rt(t)}" since the query selector wasn't defined.`);if(a.some(ob))throw new Error("Cannot combine @Input decorators with query decorators");n.push(nb(s,e))}})}return n}function ab(t){const e=t.ngMetadataName;return"ContentChild"===e||"ContentChildren"===e}function rb(t){const e=t.ngMetadataName;return"ViewChild"===e||"ViewChildren"===e}function ob(t){return"Input"===t.ngMetadataName}function cb(t){return t.split(",").map(t=>t.trim())}const lb=["ngOnChanges","ngOnInit","ngOnDestroy","ngDoCheck","ngAfterViewInit","ngAfterViewChecked","ngAfterContentInit","ngAfterContentChecked"];function ub(t){const e=rn();if(lb.some(i=>e.hasLifecycleHook(t,i)))return!0;const i=e.propMetadata(t);for(const n in i){const t=i[n];for(let e=0;e<t.length;e++){const i=t[e],n=i.ngMetadataName;if(ob(i)||ab(i)||rb(i)||"Output"===n||"HostBinding"===n||"HostListener"===n)return!0}}return!1}const db=Ri("Directive",(t={})=>t,void 0,void 0,(t,e)=>bb(t,e)),hb=xi("Input",t=>({bindingPropertyName:t})),bb=tb,mb=Ri("NgModule",t=>t,void 0,void 0,(t,e)=>pb(t,e)),pb=function(t,e={}){!function(t,e,i=!1){const n=Ni(e.declarations||Kh);let s=null;Object.defineProperty(t,X,{configurable:!0,get:()=>(null===s&&(s=Ai().compileNgModule(Wh,`ng:///${t.name}/\u0275mod.js`,{type:t,bootstrap:Ni(e.bootstrap||Kh).map(S),declarations:n.map(S),imports:Ni(e.imports||Kh).map(S).map(Zh),exports:Ni(e.exports||Kh).map(S).map(Zh),schemas:e.schemas?Ni(e.schemas):null,id:e.id||null}),s.schemas||(s.schemas=[])),s)});let a=null;Object.defineProperty(t,j,{get:()=>{if(null===a){const i={name:t.name,type:t,deps:on(t),providers:e.providers||Kh,imports:[(e.imports||Kh).map(S),(e.exports||Kh).map(S)]};a=Ai().compileInjector(Wh,`ng:///${t.name}/\u0275inj.js`,i)}return a},configurable:!1})}(t,e),function(t,e){Xh.push({moduleType:t,ngModule:e})}(t,e)},gb=new ji("Application Initializer");let fb=(()=>{class t{constructor(t){this.appInits=t,this.resolve=ed,this.reject=ed,this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}runInitializers(){if(this.initialized)return;const t=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const e=this.appInits[i]();Ho(e)&&t.push(e)}Promise.all(t).then(()=>{e()}).catch(t=>{this.reject(t)}),0===t.length&&e(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(fn(gb,8))},t.\u0275prov=L({token:t,factory:t.\u0275fac}),t})();const vb=new ji("AppId"),yb={provide:vb,useFactory:function(){return`${_b()}${_b()}${_b()}`},deps:[]};function _b(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const kb=new ji("Platform Initializer"),wb=new ji("Platform ID"),Sb=new ji("appBootstrapListener");let Ib=(()=>{class t{log(t){console.log(t)}warn(t){console.warn(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=L({token:t,factory:t.\u0275fac}),t})();const Cb=new ji("LocaleId"),Lb=new ji("DefaultCurrencyCode");class Rb{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}const Ob=function(t){return new th(t)},Tb=Ob,xb=function(t){return Promise.resolve(Ob(t))},Bb=function(t){const e=Ob(t),i=Os(pt(t).declarations).reduce((t,e)=>{const i=bt(e);return i&&t.push(new Wd(i)),t},[]);return new Rb(e,i)},jb=Bb,Mb=function(t){return Promise.resolve(Bb(t))};let Qb=(()=>{class t{constructor(){this.compileModuleSync=Tb,this.compileModuleAsync=xb,this.compileModuleAndAllComponentsSync=jb,this.compileModuleAndAllComponentsAsync=Mb}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=L({token:t,factory:t.\u0275fac}),t})();const Ab=(()=>Promise.resolve(0))();function Db(t){"undefined"==typeof Zone?Ab.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class Eb{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ch(!1),this.onMicrotaskEmpty=new Ch(!1),this.onStable=new Ch(!1),this.onError=new Ch(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=e,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function(){let t=$.requestAnimationFrame,e=$.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i);const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(t){const e=!!t.shouldCoalesceEventChangeDetection&&t.nativeRequestAnimationFrame&&(()=>{!function(t){-1===t.lastRequestAnimationFrameId&&(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call($,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Pb(t),Fb(t)},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Pb(t))}(t)});t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0,maybeDelayChangeDetection:e},onInvokeTask:(i,n,s,a,r,o)=>{try{return Ub(t),i.invokeTask(s,a,r,o)}finally{e&&"eventTask"===a.type&&e(),zb(t)}},onInvoke:(e,i,n,s,a,r,o)=>{try{return Ub(t),e.invoke(n,s,a,r,o)}finally{zb(t)}},onHasTask:(e,i,n,s)=>{e.hasTask(n,s),i===n&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,Pb(t),Fb(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(e,i,n,s)=>(e.handleError(n,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Eb.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Eb.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,i){return this._inner.run(t,e,i)}runTask(t,e,i,n){const s=this._inner,a=s.scheduleEventTask("NgZoneEvent: "+n,t,Nb,ed,ed);try{return s.runTask(a,e,i)}finally{s.cancelTask(a)}}runGuarded(t,e,i){return this._inner.runGuarded(t,e,i)}runOutsideAngular(t){return this._outer.run(t)}}const Nb={};function Fb(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Pb(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||t.shouldCoalesceEventChangeDetection&&-1!==t.lastRequestAnimationFrameId)}function Ub(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function zb(t){t._nesting--,Fb(t)}class Jb{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ch,this.onMicrotaskEmpty=new Ch,this.onStable=new Ch,this.onError=new Ch}run(t,e,i){return t.apply(e,i)}runGuarded(t,e,i){return t.apply(e,i)}runOutsideAngular(t){return t()}runTask(t,e,i,n){return t.apply(e,i)}}let qb=(()=>{class t{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Eb.assertNotInAngularZone(),Db(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Db(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(e=>!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,e,i){let n=-1;e&&e>0&&(n=setTimeout(()=>{this._callbacks=this._callbacks.filter(t=>t.timeoutId!==n),t(this._didWork,this.getPendingTasks())},e)),this._callbacks.push({doneCb:t,timeoutId:n,updateCb:i})}whenStable(t,e,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(t,e,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,e,i){return[]}}return t.\u0275fac=function(e){return new(e||t)(fn(Eb))},t.\u0275prov=L({token:t,factory:t.\u0275fac}),t})(),Vb=(()=>{class t{constructor(){this._applications=new Map,Yb.addToWindow(this)}registerApplication(t,e){this._applications.set(t,e)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,e=!0){return Yb.findTestabilityInTree(this,t,e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=L({token:t,factory:t.\u0275fac}),t})();class $b{addToWindow(t){}findTestabilityInTree(t,e,i){return null}}function Gb(t){Yb=t}let Hb,Yb=new $b,Wb=!0,Kb=!1;function Xb(){return Kb=!0,Wb}function Zb(){if(Kb)throw new Error("Cannot enable prod mode after platform setup.");Wb=!1}const tm=new ji("AllowMultipleToken");class em{constructor(t,e){this.name=t,this.token=e}}function im(t,e,i=[]){const n="Platform: "+e,s=new ji(n);return(e=[])=>{let a=nm();if(!a||a.injector.get(tm,!1))if(t)t(i.concat(e).concat({provide:s,useValue:!0}));else{const t=i.concat(e).concat({provide:s,useValue:!0},{provide:Lr,useValue:"platform"});!function(t){if(Hb&&!Hb.destroyed&&!Hb.injector.get(tm,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Hb=t.get(sm);const e=t.get(kb,null);e&&e.forEach(t=>t())}(Pr.create({providers:t,name:n}))}return function(t){const e=nm();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(s)}}function nm(){return Hb&&!Hb.destroyed?Hb:null}let sm=(()=>{class t{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,e){const i=function(t,e){let i;return i="noop"===t?new Jb:("zone.js"===t?void 0:t)||new Eb({enableLongStackTrace:Xb(),shouldCoalesceEventChangeDetection:e}),i}(e?e.ngZone:void 0,e&&e.ngZoneEventCoalescing||!1),n=[{provide:Eb,useValue:i}];return i.run(()=>{const e=Pr.create({providers:n,parent:this.injector,name:t.moduleType.name}),s=t.create(e),a=s.injector.get(ks,null);if(!a)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return i.runOutsideAngular(()=>{const t=i.onError.subscribe({next:t=>{a.handleError(t)}});s.onDestroy(()=>{om(this._modules,s),t.unsubscribe()})}),function(t,e,i){try{const n=i();return Ho(n)?n.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):n}catch(n){throw e.runOutsideAngular(()=>t.handleError(n)),n}}(a,i,()=>{const t=s.injector.get(fb);return t.runInitializers(),t.donePromise.then(()=>(Vl(s.injector.get(Cb,Pl)||Pl),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,e=[]){const i=am({},e);return function(t,e,i){const n=new th(i);return Promise.resolve(n)}(0,0,t).then(t=>this.bootstrapModuleFactory(t,i))}_moduleDoBootstrap(t){const e=t.injector.get(rm);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${y(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(e)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(fn(Pr))},t.\u0275prov=L({token:t,factory:t.\u0275fac}),t})();function am(t,e){return Array.isArray(e)?e.reduce(am,t):Object.assign(Object.assign({},t),e)}let rm=(()=>{class t{constructor(t,e,i,n,s,l){this._zone=t,this._console=e,this._injector=i,this._exceptionHandler=n,this._componentFactoryResolver=s,this._initStatus=l,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const d=new a.a(t=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{t.next(this._stable),t.complete()})}),h=new a.a(t=>{let e;this._zone.runOutsideAngular(()=>{e=this._zone.onStable.subscribe(()=>{Eb.assertNotInAngularZone(),Db(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,t.next(!0))})})});const i=this._zone.onUnstable.subscribe(()=>{Eb.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{t.next(!1)}))});return()=>{e.unsubscribe(),i.unsubscribe()}});this.isStable=function(...t){let e=Number.POSITIVE_INFINITY,i=null,n=t[t.length-1];return Object(r.a)(n)?(i=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof n&&(e=t.pop()),null===i&&1===t.length&&t[0]instanceof a.a?t[0]:Object(o.a)(e)(Object(c.a)(t,i))}(d,h.pipe(t=>{return u()((e=g,function(t){let i;i="function"==typeof e?e:function(){return e};const n=Object.create(t,m);return n.source=t,n.subjectFactory=i,n})(t));var e}))}bootstrap(t,e){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let i;i=t instanceof Xu?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(i.componentType);const n=i.isBoundToModule?void 0:this._injector.get(Ed),s=i.create(Pr.NULL,[],e||i.selector,n),a=s.location.nativeElement,r=s.injector.get(qb,null),o=r&&s.injector.get(Vb);return r&&o&&o.registerApplication(a,r),s.onDestroy(()=>{this.detachView(s.hostView),om(this.components,s),o&&o.unregisterApplication(a)}),this._loadComponent(s),Xb()&&this._console.log("Angular is running in development mode. Call enableProdMode() to enable production mode."),s}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const e=t;this._views.push(e),e.attachToAppRef(this)}detachView(t){const e=t;om(this._views,e),e.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(Sb,[]).concat(this._bootstrapListeners).forEach(e=>e(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(fn(Eb),fn(Ib),fn(Pr),fn(ks),fn(td),fn(fb))},t.\u0275prov=L({token:t,factory:t.\u0275fac}),t})();function om(t,e){const i=t.indexOf(e);i>-1&&t.splice(i,1)}class cm{}class lm{}const um={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let dm=(()=>{class t{constructor(t,e){this._compiler=t,this._config=e||um}load(t){return this.loadAndCompile(t)}loadAndCompile(t){let[e,n]=t.split("#");return void 0===n&&(n="default"),i("crnd")(e).then(t=>t[n]).then(t=>hm(t,e,n)).then(t=>this._compiler.compileModuleAsync(t))}loadFactory(t){let[e,n]=t.split("#"),s="NgFactory";return void 0===n&&(n="default",s=""),i("crnd")(this._config.factoryPathPrefix+e+this._config.factoryPathSuffix).then(t=>t[n+s]).then(t=>hm(t,e,n))}}return t.\u0275fac=function(e){return new(e||t)(fn(Qb),fn(lm,8))},t.\u0275prov=L({token:t,factory:t.\u0275fac}),t})();function hm(t,e,i){if(!t)throw new Error(`Cannot find '${i}' in '${e}'`);return t}const bm=function(t){return null},mm=im(null,"core",[{provide:wb,useValue:"unknown"},{provide:sm,deps:[Pr]},{provide:Vb,deps:[]},{provide:Ib,deps:[]}]),pm=[{provide:rm,useClass:rm,deps:[Eb,Ib,Pr,ks,td,fb]},{provide:Yd,deps:[Eb],useFactory:function(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:fb,useClass:fb,deps:[[new tn,gb]]},{provide:Qb,useClass:Qb,deps:[]},yb,{provide:kd,useFactory:function(){return xd},deps:[]},{provide:wd,useFactory:function(){return Bd},deps:[]},{provide:Cb,useFactory:function(t){return Vl(t=t||"undefined"!=typeof $localize&&$localize.locale||Pl),t},deps:[[new Zi(Cb),new tn,new nn]]},{provide:Lb,useValue:"USD"}];let gm=(()=>{class t{constructor(t){}}return t.\u0275mod=ct({type:t}),t.\u0275inj=R({factory:function(e){return new(e||t)(fn(rm))},providers:pm}),t})()},gRHU:function(t,e,i){"use strict";i.d(e,"a",function(){return a});var n=i("2fFW"),s=i("NJ4a");const a={closed:!0,next(t){},error(t){if(n.a.useDeprecatedSynchronousErrorHandling)throw t;Object(s.a)(t)},complete(){}}},jZKg:function(t,e,i){"use strict";i.d(e,"a",function(){return a});var n=i("HDdC"),s=i("quSY");function a(t,e){return new n.a(i=>{const n=new s.a;let a=0;return n.add(e.schedule(function(){a!==t.length?(i.next(t[a++]),i.closed||n.add(this.schedule())):i.complete()})),n})}},jrpr:function(t,e,i){"use strict";var n;i.d(e,"a",function(){return n}),function(t){t.Explicit="explicitly_set",t.Sampler="client_sampler",t.Rate="client_rate",t.Inheritance="inheritance"}(n||(n={}))},kJWO:function(t,e,i){"use strict";i.d(e,"a",function(){return n});const n=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")()},kdvv:function(t,e,i){"use strict";(function(t){i.d(e,"b",function(){return c}),i.d(e,"c",function(){return l}),i.d(e,"d",function(){return u}),i.d(e,"a",function(){return d});var n=i("9/Zf"),s=i("+A1k"),a={nowSeconds:function(){return Date.now()/1e3}},r=Object(s.b)()?function(){try{return Object(s.a)(t,"perf_hooks").performance}catch(e){return}}():function(){var t=Object(n.e)().performance;if(t&&t.now)return{now:function(){return t.now()},timeOrigin:Date.now()-t.now()}}(),o=void 0===r?a:{nowSeconds:function(){return(r.timeOrigin+r.now())/1e3}},c=a.nowSeconds.bind(a),l=o.nowSeconds.bind(o),u=l,d=function(){var t=Object(n.e)().performance;if(t&&t.now){var e=36e5,i=t.now(),s=Date.now(),a=t.timeOrigin?Math.abs(t.timeOrigin+i-s):e,r=a<e,o=t.timing&&t.timing.navigationStart,c="number"==typeof o?Math.abs(o+i-s):e;return r||c<e?a<=c?t.timeOrigin:o:s}}()}).call(this,i("3UD+")(t))},kiQV:function(t){t.exports=JSON.parse('{"a":"1.0.32-0206568"}')},lJxs:function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n=i("7o/Q");function s(t,e){return function(i){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new a(t,e))}}class a{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new r(t,this.project,this.thisArg))}}class r extends n.a{constructor(t,e,i){super(t),this.project=e,this.count=0,this.thisArg=i||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(e)}}},lW6c:function(t,e,i){"use strict";i.d(e,"a",function(){return h}),i.d(e,"c",function(){return b}),i.d(e,"b",function(){return p});var n=i("wmvo"),s=i("yksw"),a=i("9/Zf"),r=i("kdvv"),o=i("8LbN"),c=i("+A1k"),l=i("KjyA"),u=i("6PXS"),d=function(){function t(t){this.errors=0,this.sid=Object(a.j)(),this.duration=0,this.status=s.a.Ok,this.init=!0,this.ignoreDuration=!1;var e=Object(r.c)();this.timestamp=e,this.started=e,t&&this.update(t)}return t.prototype.update=function(t){if(void 0===t&&(t={}),t.user&&(!this.ipAddress&&t.user.ip_address&&(this.ipAddress=t.user.ip_address),this.did||t.did||(this.did=t.user.id||t.user.email||t.user.username)),this.timestamp=t.timestamp||Object(r.c)(),t.ignoreDuration&&(this.ignoreDuration=t.ignoreDuration),t.sid&&(this.sid=32===t.sid.length?t.sid:Object(a.j)()),void 0!==t.init&&(this.init=t.init),!this.did&&t.did&&(this.did=""+t.did),"number"==typeof t.started&&(this.started=t.started),this.ignoreDuration)this.duration=void 0;else if("number"==typeof t.duration)this.duration=t.duration;else{var e=this.timestamp-this.started;this.duration=e>=0?e:0}t.release&&(this.release=t.release),t.environment&&(this.environment=t.environment),!this.ipAddress&&t.ipAddress&&(this.ipAddress=t.ipAddress),!this.userAgent&&t.userAgent&&(this.userAgent=t.userAgent),"number"==typeof t.errors&&(this.errors=t.errors),t.status&&(this.status=t.status)},t.prototype.close=function(t){t?this.update({status:t}):this.status===s.a.Ok?this.update({status:s.a.Exited}):this.update()},t.prototype.toJSON=function(){return Object(u.a)({sid:""+this.sid,init:this.init,started:new Date(1e3*this.started).toISOString(),timestamp:new Date(1e3*this.timestamp).toISOString(),status:this.status,errors:this.errors,did:"number"==typeof this.did||"string"==typeof this.did?""+this.did:void 0,duration:this.duration,attrs:Object(u.a)({release:this.release,environment:this.environment,ip_address:this.ipAddress,user_agent:this.userAgent})})},t}(),h=function(){function t(t,e,i){void 0===e&&(e=new l.a),void 0===i&&(i=4),this._version=i,this._stack=[{}],this.getStackTop().scope=e,this.bindClient(t)}return t.prototype.isOlderThan=function(t){return this._version<t},t.prototype.bindClient=function(t){this.getStackTop().client=t,t&&t.setupIntegrations&&t.setupIntegrations()},t.prototype.pushScope=function(){var t=l.a.clone(this.getScope());return this.getStack().push({client:this.getClient(),scope:t}),t},t.prototype.popScope=function(){return!(this.getStack().length<=1||!this.getStack().pop())},t.prototype.withScope=function(t){var e=this.pushScope();try{t(e)}finally{this.popScope()}},t.prototype.getClient=function(){return this.getStackTop().client},t.prototype.getScope=function(){return this.getStackTop().scope},t.prototype.getStack=function(){return this._stack},t.prototype.getStackTop=function(){return this._stack[this._stack.length-1]},t.prototype.captureException=function(t,e){var i=this._lastEventId=Object(a.j)(),s=e;if(!e){var r=void 0;try{throw new Error("Sentry syntheticException")}catch(t){r=t}s={originalException:t,syntheticException:r}}return this._invokeClient("captureException",t,Object(n.a)(Object(n.a)({},s),{event_id:i})),i},t.prototype.captureMessage=function(t,e,i){var s=this._lastEventId=Object(a.j)(),r=i;if(!i){var o=void 0;try{throw new Error(t)}catch(c){o=c}r={originalException:t,syntheticException:o}}return this._invokeClient("captureMessage",t,e,Object(n.a)(Object(n.a)({},r),{event_id:s})),s},t.prototype.captureEvent=function(t,e){var i=this._lastEventId=Object(a.j)();return this._invokeClient("captureEvent",t,Object(n.a)(Object(n.a)({},e),{event_id:i})),i},t.prototype.lastEventId=function(){return this._lastEventId},t.prototype.addBreadcrumb=function(t,e){var i=this.getStackTop(),s=i.scope,o=i.client;if(s&&o){var c=o.getOptions&&o.getOptions()||{},l=c.beforeBreadcrumb,u=void 0===l?null:l,d=c.maxBreadcrumbs,h=void 0===d?100:d;if(!(h<=0)){var b=Object(r.b)(),m=Object(n.a)({timestamp:b},t),p=u?Object(a.c)(function(){return u(m,e)}):m;null!==p&&s.addBreadcrumb(p,h)}}},t.prototype.setUser=function(t){var e=this.getScope();e&&e.setUser(t)},t.prototype.setTags=function(t){var e=this.getScope();e&&e.setTags(t)},t.prototype.setExtras=function(t){var e=this.getScope();e&&e.setExtras(t)},t.prototype.setTag=function(t,e){var i=this.getScope();i&&i.setTag(t,e)},t.prototype.setExtra=function(t,e){var i=this.getScope();i&&i.setExtra(t,e)},t.prototype.setContext=function(t,e){var i=this.getScope();i&&i.setContext(t,e)},t.prototype.configureScope=function(t){var e=this.getStackTop(),i=e.scope;i&&e.client&&t(i)},t.prototype.run=function(t){var e=m(this);try{t(this)}finally{m(e)}},t.prototype.getIntegration=function(t){var e=this.getClient();if(!e)return null;try{return e.getIntegration(t)}catch(i){return o.a.warn("Cannot retrieve integration "+t.id+" from the current Hub"),null}},t.prototype.startSpan=function(t){return this._callExtensionMethod("startSpan",t)},t.prototype.startTransaction=function(t,e){return this._callExtensionMethod("startTransaction",t,e)},t.prototype.traceHeaders=function(){return this._callExtensionMethod("traceHeaders")},t.prototype.captureSession=function(t){if(void 0===t&&(t=!1),t)return this.endSession();this._sendSessionUpdate()},t.prototype.endSession=function(){var t,e,i,n,s;null===(i=null===(e=null===(t=this.getStackTop())||void 0===t?void 0:t.scope)||void 0===e?void 0:e.getSession())||void 0===i||i.close(),this._sendSessionUpdate(),null===(s=null===(n=this.getStackTop())||void 0===n?void 0:n.scope)||void 0===s||s.setSession()},t.prototype.startSession=function(t){var e=this.getStackTop(),i=e.scope,r=e.client,o=r&&r.getOptions()||{},c=o.release,l=o.environment,u=(Object(a.e)().navigator||{}).userAgent,h=new d(Object(n.a)(Object(n.a)(Object(n.a)({release:c,environment:l},i&&{user:i.getUser()}),u&&{userAgent:u}),t));if(i){var b=i.getSession&&i.getSession();b&&b.status===s.a.Ok&&b.update({status:s.a.Exited}),this.endSession(),i.setSession(h)}return h},t.prototype._sendSessionUpdate=function(){var t=this.getStackTop(),e=t.scope,i=t.client;if(e){var n=e.getSession&&e.getSession();n&&i&&i.captureSession&&i.captureSession(n)}},t.prototype._invokeClient=function(t){for(var e,i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];var a=this.getStackTop(),r=a.scope,o=a.client;o&&o[t]&&(e=o)[t].apply(e,Object(n.f)(i,[r]))},t.prototype._callExtensionMethod=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=b(),s=n.__SENTRY__;if(s&&s.extensions&&"function"==typeof s.extensions[t])return s.extensions[t].apply(this,e);o.a.warn("Extension method "+t+" couldn't be found, doing nothing.")},t}();function b(){var t=Object(a.e)();return t.__SENTRY__=t.__SENTRY__||{extensions:{},hub:void 0},t}function m(t){var e=b(),i=f(e);return v(e,t),i}function p(){var t=b();return g(t)&&!f(t).isOlderThan(4)||v(t,new h),Object(c.b)()?function(t){var e,i,n;try{var s=null===(n=null===(i=null===(e=b().__SENTRY__)||void 0===e?void 0:e.extensions)||void 0===i?void 0:i.domain)||void 0===n?void 0:n.active;if(!s)return f(t);if(!g(s)||f(s).isOlderThan(4)){var a=f(t).getStackTop();v(s,new h(a.client,l.a.clone(a.scope)))}return f(s)}catch(r){return f(t)}}(t):f(t)}function g(t){return!!(t&&t.__SENTRY__&&t.__SENTRY__.hub)}function f(t){return t&&t.__SENTRY__&&t.__SENTRY__.hub||(t.__SENTRY__=t.__SENTRY__||{},t.__SENTRY__.hub=new h),t.__SENTRY__.hub}function v(t,e){return!!t&&(t.__SENTRY__=t.__SENTRY__||{},t.__SENTRY__.hub=e,!0)}},mgsY:function(t,e){function i(t,e){var i=t.scriptData={version:e.version,connection:"player"};e.gdprVersion&&(i.gdprAcceptVersion=e.gdprVersion),e.gdprLanguange&&(i.gdprAcceptLanguage=e.gdprLanguange),e.deleteAccount&&(i.deleteAccount=!0),e.hasOwnProperty("gdprStatsOpen")&&(i.gdprStatsOpen=e.gdprStatsOpen)}GameSparks.prototype.acceptChallengeRequest=function(t,e,i){var n={};n.challengeInstanceId=t,n.message=e,gamesparks.sendWithData("AcceptChallengeRequest",n,i)},GameSparks.prototype.accountDetailsRequest=function(t){gamesparks.sendWithData("AccountDetailsRequest",{},t)},GameSparks.prototype.analyticsRequest=function(t,e,i,n,s){var a={};a.data=t,a.end=e,a.key=i,a.start=n,gamesparks.sendWithData("AnalyticsRequest",a,s)},GameSparks.prototype.aroundMeLeaderboardRequest=function(t,e,i,n,s){var a={};a.count=t,a.friendIds=e,a.leaderboardShortCode=i,a.social=n,gamesparks.sendWithData("AroundMeLeaderboardRequest",a,s)},GameSparks.prototype.buyVirtualGoodsRequest=function(t,e,i,n){var s={};s.currencyType=t,s.quantity=e,s.shortCode=i,gamesparks.sendWithData("BuyVirtualGoodsRequest",s,n)},GameSparks.prototype.changeUserDetailsRequest=function(t,e){var i={};i.displayName=t,gamesparks.sendWithData("ChangeUserDetailsRequest",i,e)},GameSparks.prototype.chatOnChallengeRequest=function(t,e,i){var n={};n.challengeInstanceId=t,n.message=e,gamesparks.sendWithData("ChatOnChallengeRequest",n,i)},GameSparks.prototype.consumeVirtualGoodRequest=function(t,e,i){var n={};n.quantity=t,n.shortCode=e,gamesparks.sendWithData("ConsumeVirtualGoodRequest",n,i)},GameSparks.prototype.createChallengeRequest=function(t,e,i,n,s,a,r,o,c,l,u,d,h,b,m,p,g,f){var v={};v.accessType=t,v.challengeMessage=e,v.challengeShortCode=i,v.currency1Wager=n,v.currency2Wager=s,v.currency3Wager=a,v.currency4Wager=r,v.currency5Wager=o,v.currency6Wager=c,v.endTime=l,v.expiryTime=u,v.maxAttempts=d,v.maxPlayers=h,v.minPlayers=b,v.silent=m,v.startTime=p,v.usersToChallenge=g,gamesparks.sendWithData("CreateChallengeRequest",v,f)},GameSparks.prototype.declineChallengeRequest=function(t,e,i){var n={};n.challengeInstanceId=t,n.message=e,gamesparks.sendWithData("DeclineChallengeRequest",n,i)},GameSparks.prototype.deviceAuthenticationRequest=function(t,e,i,n,s,a,r){var o={};o.deviceId=t,o.deviceModel=e,o.deviceName=i,o.deviceOS=n,o.deviceType=s,o.operatingSystem=a,gamesparks.sendWithData("DeviceAuthenticationRequest",o,r)},GameSparks.prototype.dismissMessageRequest=function(t,e){var i={};i.messageId=t,gamesparks.sendWithData("DismissMessageRequest",i,e)},GameSparks.prototype.endSessionRequest=function(t){gamesparks.sendWithData("EndSessionRequest",{},t)},GameSparks.prototype.facebookConnectRequest=function(t,e,i){var n={};n.accessToken=t,n.code=e,gamesparks.sendWithData("FacebookConnectRequest",n,i)},GameSparks.prototype.findChallengeRequest=function(t,e,i,n){var s={};s.accessType=t,s.count=e,s.offset=i,gamesparks.sendWithData("FindChallengeRequest",s,n)},GameSparks.prototype.getChallengeRequest=function(t,e,i){var n={};n.challengeInstanceId=t,n.message=e,gamesparks.sendWithData("GetChallengeRequest",n,i)},GameSparks.prototype.getDownloadableRequest=function(t,e){var i={};i.shortCode=t,gamesparks.sendWithData("GetDownloadableRequest",i,e)},GameSparks.prototype.getMessageRequest=function(t,e){var i={};i.messageId=t,gamesparks.sendWithData("GetMessageRequest",i,e)},GameSparks.prototype.getRunningTotalsRequest=function(t,e,i){var n={};n.friendIds=t,n.shortCode=e,gamesparks.sendWithData("GetRunningTotalsRequest",n,i)},GameSparks.prototype.getUploadUrlRequest=function(t,e){var i={};i.uploadData=t,gamesparks.sendWithData("GetUploadUrlRequest",i,e)},GameSparks.prototype.getUploadedRequest=function(t,e){var i={};i.uploadId=t,gamesparks.sendWithData("GetUploadedRequest",i,e)},GameSparks.prototype.googlePlayBuyGoodsRequest=function(t,e,i,n,s){var a={};a.currencyCode=t,a.signature=e,a.signedData=i,a.subUnitPrice=n,gamesparks.sendWithData("GooglePlayBuyGoodsRequest",a,s)},GameSparks.prototype.iOSBuyGoodsRequest=function(t,e,i,n,s){var a={};a.currencyCode=t,a.receipt=e,a.sandbox=i,a.subUnitPrice=n,gamesparks.sendWithData("IOSBuyGoodsRequest",a,s)},GameSparks.prototype.joinChallengeRequest=function(t,e,i){var n={};n.challengeInstanceId=t,n.message=e,gamesparks.sendWithData("JoinChallengeRequest",n,i)},GameSparks.prototype.leaderboardDataRequest=function(t,e,i,n,s,a,r){var o={};o.challengeInstanceId=t,o.entryCount=e,o.friendIds=i,o.leaderboardShortCode=n,o.offset=s,o.social=a,gamesparks.sendWithData("LeaderboardDataRequest",o,r)},GameSparks.prototype.listAchievementsRequest=function(t){gamesparks.sendWithData("ListAchievementsRequest",{},t)},GameSparks.prototype.listChallengeRequest=function(t,e,i,n,s){var a={};a.entryCount=t,a.offset=e,a.shortCode=i,a.state=n,gamesparks.sendWithData("ListChallengeRequest",a,s)},GameSparks.prototype.listChallengeTypeRequest=function(t){gamesparks.sendWithData("ListChallengeTypeRequest",{},t)},GameSparks.prototype.listGameFriendsRequest=function(t){gamesparks.sendWithData("ListGameFriendsRequest",{},t)},GameSparks.prototype.listInviteFriendsRequest=function(t){gamesparks.sendWithData("ListInviteFriendsRequest",{},t)},GameSparks.prototype.listLeaderboardsRequest=function(t){gamesparks.sendWithData("ListLeaderboardsRequest",{},t)},GameSparks.prototype.listMessageRequest=function(t,e,i){var n={};n.entryCount=t,n.offset=e,gamesparks.sendWithData("ListMessageRequest",n,i)},GameSparks.prototype.listMessageSummaryRequest=function(t,e,i){var n={};n.entryCount=t,n.offset=e,gamesparks.sendWithData("ListMessageSummaryRequest",n,i)},GameSparks.prototype.listVirtualGoodsRequest=function(t){gamesparks.sendWithData("ListVirtualGoodsRequest",{},t)},GameSparks.prototype.logChallengeEventRequest=function(t,e,i){var n={};n.challengeInstanceId=t,n.eventKey=e,gamesparks.sendWithData("LogChallengeEventRequest",n,i)},GameSparks.prototype.logEventRequest=function(t,e){var i={};i.eventKey=t,gamesparks.sendWithData("LogEventRequest",i,e)},GameSparks.prototype.pushRegistrationRequest=function(t,e,i){var n={};n.deviceOS=t,n.pushId=e,gamesparks.sendWithData("PushRegistrationRequest",n,i)},GameSparks.prototype.registrationRequest=function(t,e,i,n){var s={};s.displayName=t,s.password=e,s.userName=i,gamesparks.sendWithData("RegistrationRequest",s,n)},GameSparks.prototype.sendFriendMessageRequest=function(t,e,i){var n={};n.friendIds=t,n.message=e,gamesparks.sendWithData("SendFriendMessageRequest",n,i)},GameSparks.prototype.socialLeaderboardDataRequest=function(t,e,i,n,s,a,r){var o={};o.challengeInstanceId=t,o.entryCount=e,o.friendIds=i,o.leaderboardShortCode=n,o.offset=s,o.social=a,gamesparks.sendWithData("SocialLeaderboardDataRequest",o,r)},GameSparks.prototype.twitterConnectRequest=function(t,e,i){var n={};n.accessSecret=t,n.accessToken=e,gamesparks.sendWithData("TwitterConnectRequest",n,i)},GameSparks.prototype.windowsBuyGoodsRequest=function(t,e,i,n){var s={};s.currencyCode=t,s.receipt=e,s.subUnitPrice=i,gamesparks.sendWithData("WindowsBuyGoodsRequest",s,n)},GameSparks.prototype.withdrawChallengeRequest=function(t,e,i){var n={};n.challengeInstanceId=t,n.message=e,gamesparks.sendWithData("WithdrawChallengeRequest",n,i)},GameSparks.prototype.steamConnectRequest=function(t,e,n){var s={};s.sessionTicket=t,i(s,e),gamesparks.sendWithData("SteamConnectRequest",s,n)},GameSparks.prototype.eosConnectRequest=function(t,e,n){var s={};s.token=t,i(s,e),gamesparks.sendWithData("EosConnectRequest",s,n)},GameSparks.prototype.connectViaExternalTokenRequest=function(t,e,n,s){var a=gamesparks.getBrowserData(),r={deviceId:"extracted from token"};r.deviceOS=a.operatingSystem,r.deviceType="desktop",r.displayName="extracted from token",i(r,n),r.scriptData.auth=t,r.scriptData.token=e,gamesparks.sendWithData("DeviceAuthenticationRequest",r,s)},GameSparks.prototype.authenticationRequest=function(t,e,n,s){var a={};a.password=t,a.userName=e,i(a,n),this.sendWithData("AuthenticationRequest",a,s)}},n6bG:function(t,e,i){"use strict";function n(t){return"function"==typeof t}i.d(e,"a",function(){return n})},ngJS:function(t,e,i){"use strict";i.d(e,"a",function(){return n});const n=t=>e=>{for(let i=0,n=t.length;i<n&&!e.closed;i++)e.next(t[i]);e.complete()}},pRiV:function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n="<anonymous>";function s(t){try{return t&&"function"==typeof t&&t.name||n}catch(e){return n}}},quSY:function(t,e,i){"use strict";i.d(e,"a",function(){return o});var n=i("DH7j"),s=i("XoHu"),a=i("n6bG");const r=(()=>{function t(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t})();let o=(()=>{class t{constructor(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:i,_ctorUnsubscribe:o,_unsubscribe:l,_subscriptions:u}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,i instanceof t)i.remove(this);else if(null!==i)for(let t=0;t<i.length;++t)i[t].remove(this);if(Object(a.a)(l)){o&&(this._unsubscribe=void 0);try{l.call(this)}catch(d){e=d instanceof r?c(d.errors):[d]}}if(Object(n.a)(u)){let t=-1,i=u.length;for(;++t<i;){const i=u[t];if(Object(s.a)(i))try{i.unsubscribe()}catch(d){e=e||[],d instanceof r?e=e.concat(c(d.errors)):e.push(d)}}}if(e)throw new r(e)}add(e){let i=e;if(!e)return t.EMPTY;switch(typeof e){case"function":i=new t(e);case"object":if(i===this||i.closed||"function"!=typeof i.unsubscribe)return i;if(this.closed)return i.unsubscribe(),i;if(!(i instanceof t)){const e=i;i=new t,i._subscriptions=[e]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:n}=i;if(null===n)i._parentOrParents=this;else if(n instanceof t){if(n===this)return i;i._parentOrParents=[n,this]}else{if(-1!==n.indexOf(this))return i;n.push(this)}const s=this._subscriptions;return null===s?this._subscriptions=[i]:s.push(i),i}remove(t){const e=this._subscriptions;if(e){const i=e.indexOf(t);-1!==i&&e.splice(i,1)}}}var e;return t.EMPTY=((e=new t).closed=!0,e),t})();function c(t){return t.reduce((t,e)=>t.concat(e instanceof r?e.errors:e),[])}},vFt6:function(t,e,i){"use strict";i.d(e,"a",function(){return s});var n=i("9AQC");function s(t,e){try{for(var i=t,n=[],s=0,r=0,o=" > ".length,c=void 0;i&&s++<5&&!("html"===(c=a(i,e))||s>1&&r+n.length*o+c.length>=80);)n.push(c),r+=c.length,i=i.parentNode;return n.reverse().join(" > ")}catch(l){return"<unknown>"}}function a(t,e){var i,s,a,r,o,c,l,u=t,d=[];if(!u||!u.tagName)return"";d.push(u.tagName.toLowerCase());var h=(null===(i=e)||void 0===i?void 0:i.length)?e.filter(function(t){return u.getAttribute(t)}).map(function(t){return[t,u.getAttribute(t)]}):null;if(null===(s=h)||void 0===s?void 0:s.length)h.forEach(function(t){d.push("["+t[0]+'="'+t[1]+'"]')});else if(u.id&&d.push("#"+u.id),(a=u.className)&&Object(n.k)(a))for(r=a.split(/\s+/),l=0;l<r.length;l++)d.push("."+r[l]);var b=["type","name","title","alt"];for(l=0;l<b.length;l++)(c=u.getAttribute(o=b[l]))&&d.push("["+o+'="'+c+'"]');return d.join("")}},wmvo:function(t,e,i){"use strict";i.d(e,"c",function(){return s}),i.d(e,"a",function(){return a}),i.d(e,"e",function(){return r}),i.d(e,"b",function(){return o}),i.d(e,"g",function(){return c}),i.d(e,"d",function(){return l}),i.d(e,"f",function(){return u});var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function s(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var a=function(){return(a=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var s in e=arguments[i])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};function r(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(i[n[s]]=t[n[s]])}return i}function o(t,e,i,n){var s,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var o=t.length-1;o>=0;o--)(s=t[o])&&(r=(a<3?s(r):a>3?s(e,i,r):s(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r}function c(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,s,a=i.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)r.push(n.value)}catch(o){s={error:o}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(s)throw s.error}}return r}function u(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(l(arguments[e]));return t}},yCtX:function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=i("HDdC"),s=i("ngJS"),a=i("jZKg");function r(t,e){return e?Object(a.a)(t,e):new n.a(Object(s.a)(t))}},yksw:function(t,e,i){"use strict";var n,s;i.d(e,"a",function(){return n}),function(t){t.Ok="ok",t.Exited="exited",t.Crashed="crashed",t.Abnormal="abnormal"}(n||(n={})),function(t){t.Ok="ok",t.Errored="errored",t.Crashed="crashed"}(s||(s={}))},"z+Ro":function(t,e,i){"use strict";function n(t){return t&&"function"==typeof t.schedule}i.d(e,"a",function(){return n})},zUnb:function(t,e,i){"use strict";i.r(e);var n={};i.r(n),i.d(n,"FunctionToString",function(){return u}),i.d(n,"InboundFilters",function(){return f});var s={};i.r(s),i.d(s,"GlobalHandlers",function(){return kt}),i.d(s,"TryCatch",function(){return _t}),i.d(s,"Breadcrumbs",function(){return gt}),i.d(s,"LinkedErrors",function(){return wt}),i.d(s,"UserAgent",function(){return Ct}),i.d(s,"Dedupe",function(){return St});var a={};i.r(a),i.d(a,"Express",function(){return Ka}),i.d(a,"Postgres",function(){return tr}),i.d(a,"Mysql",function(){return er}),i.d(a,"Mongo",function(){return sr}),i("RahF"),i("mgsY"),i("F/b7");var r,o=i("fXoL"),c="6.10.0",l=i("wmvo"),u=function(){function t(){this.name=t.id}return t.prototype.setupOnce=function(){r=Function.prototype.toString,Function.prototype.toString=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this.__sentry_original__||this;return r.apply(i,t)}},t.id="FunctionToString",t}(),d=i("KjyA"),h=i("lW6c"),b=i("8LbN"),m=i("9/Zf"),p=i("+924"),g=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],f=function(){function t(e){void 0===e&&(e={}),this._options=e,this.name=t.id}return t.prototype.setupOnce=function(){Object(d.b)(function(e){var i=Object(h.b)();if(!i)return e;var n=i.getIntegration(t);if(n){var s=i.getClient(),a=s?s.getOptions():{},r="function"==typeof n._mergeOptions?n._mergeOptions(a):{};return"function"!=typeof n._shouldDropEvent?e:n._shouldDropEvent(e,r)?null:e}return e})},t.prototype._shouldDropEvent=function(t,e){return this._isSentryError(t,e)?(b.a.warn("Event dropped due to being internal Sentry Error.\nEvent: "+Object(m.d)(t)),!0):this._isIgnoredError(t,e)?(b.a.warn("Event dropped due to being matched by `ignoreErrors` option.\nEvent: "+Object(m.d)(t)),!0):this._isDeniedUrl(t,e)?(b.a.warn("Event dropped due to being matched by `denyUrls` option.\nEvent: "+Object(m.d)(t)+".\nUrl: "+this._getEventFilterUrl(t)),!0):!this._isAllowedUrl(t,e)&&(b.a.warn("Event dropped due to not being matched by `allowUrls` option.\nEvent: "+Object(m.d)(t)+".\nUrl: "+this._getEventFilterUrl(t)),!0)},t.prototype._isSentryError=function(t,e){if(!e.ignoreInternal)return!1;try{return t&&t.exception&&t.exception.values&&t.exception.values[0]&&"SentryError"===t.exception.values[0].type||!1}catch(i){return!1}},t.prototype._isIgnoredError=function(t,e){return!(!e.ignoreErrors||!e.ignoreErrors.length)&&this._getPossibleEventMessages(t).some(function(t){return e.ignoreErrors.some(function(e){return Object(p.a)(t,e)})})},t.prototype._isDeniedUrl=function(t,e){if(!e.denyUrls||!e.denyUrls.length)return!1;var i=this._getEventFilterUrl(t);return!!i&&e.denyUrls.some(function(t){return Object(p.a)(i,t)})},t.prototype._isAllowedUrl=function(t,e){if(!e.allowUrls||!e.allowUrls.length)return!0;var i=this._getEventFilterUrl(t);return!i||e.allowUrls.some(function(t){return Object(p.a)(i,t)})},t.prototype._mergeOptions=function(t){return void 0===t&&(t={}),{allowUrls:Object(l.f)(this._options.whitelistUrls||[],this._options.allowUrls||[],t.whitelistUrls||[],t.allowUrls||[]),denyUrls:Object(l.f)(this._options.blacklistUrls||[],this._options.denyUrls||[],t.blacklistUrls||[],t.denyUrls||[]),ignoreErrors:Object(l.f)(this._options.ignoreErrors||[],t.ignoreErrors||[],g),ignoreInternal:void 0===this._options.ignoreInternal||this._options.ignoreInternal}},t.prototype._getPossibleEventMessages=function(t){if(t.message)return[t.message];if(t.exception)try{var e=t.exception.values&&t.exception.values[0]||{},i=e.type,n=e.value,s=void 0===n?"":n;return[""+s,(void 0===i?"":i)+": "+s]}catch(a){return b.a.error("Cannot extract message for event "+Object(m.d)(t)),[]}return[]},t.prototype._getEventFilterUrl=function(t){try{if(t.stacktrace){var e=t.stacktrace.frames;return e&&e[e.length-1].filename||null}if(t.exception){var i=t.exception.values&&t.exception.values[0].stacktrace&&t.exception.values[0].stacktrace.frames;return i&&i[i.length-1].filename||null}return null}catch(n){return b.a.error("Cannot extract url for event "+Object(m.d)(t)),null}},t.id="InboundFilters",t}(),v=i("HR75"),y=i("6hSO"),_=i("yksw"),k=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){return t.__proto__=e,t}:function(t,e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);return t}),w=function(t){function e(e){var i=this.constructor,n=t.call(this,e)||this;return n.message=e,n.name=i.prototype.constructor.name,k(n,i.prototype),n}return Object(l.c)(e,t),e}(Error),S=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+))?@)([\w.-]+)(?::(\d+))?\/(.+)/,I=function(){function t(t){"string"==typeof t?this._fromString(t):this._fromComponents(t),this._validate()}return t.prototype.toString=function(t){void 0===t&&(t=!1);var e=this,i=e.path,n=e.pass,s=e.port;return e.protocol+"://"+e.publicKey+(t&&n?":"+n:"")+"@"+e.host+(s?":"+s:"")+"/"+(i?i+"/":i)+e.projectId},t.prototype._fromString=function(t){var e=S.exec(t);if(!e)throw new w("Invalid Dsn");var i=Object(l.d)(e.slice(1),6),n=i[0],s=i[1],a=i[2],r=void 0===a?"":a,o=i[3],c=i[4],u=void 0===c?"":c,d="",h=i[5],b=h.split("/");if(b.length>1&&(d=b.slice(0,-1).join("/"),h=b.pop()),h){var m=h.match(/^\d+/);m&&(h=m[0])}this._fromComponents({host:o,pass:r,path:d,projectId:h,port:u,protocol:n,publicKey:s})},t.prototype._fromComponents=function(t){"user"in t&&!("publicKey"in t)&&(t.publicKey=t.user),this.user=t.publicKey||"",this.protocol=t.protocol,this.publicKey=t.publicKey||"",this.pass=t.pass||"",this.host=t.host,this.port=t.port||"",this.path=t.path||"",this.projectId=t.projectId},t.prototype._validate=function(){var t=this;if(["protocol","publicKey","host","projectId"].forEach(function(e){if(!t[e])throw new w("Invalid Dsn: "+e+" missing")}),!this.projectId.match(/^\d+$/))throw new w("Invalid Dsn: Invalid projectId "+this.projectId);if("http"!==this.protocol&&"https"!==this.protocol)throw new w("Invalid Dsn: Invalid protocol "+this.protocol);if(this.port&&isNaN(parseInt(this.port,10)))throw new w("Invalid Dsn: Invalid port "+this.port)},t}(),C=i("9AQC"),L=i("kdvv"),R=i("6PXS"),O=[];function T(t){return t.reduce(function(t,e){return t.every(function(t){return e.name!==t.name})&&t.push(e),t},[])}var x,B=function(){function t(t,e){this._integrations={},this._numProcessing=0,this._backend=new t(e),this._options=e,e.dsn&&(this._dsn=new I(e.dsn))}return t.prototype.captureException=function(t,e,i){var n=this,s=e&&e.event_id;return this._process(this._getBackend().eventFromException(t,e).then(function(t){return n._captureEvent(t,e,i)}).then(function(t){s=t})),s},t.prototype.captureMessage=function(t,e,i,n){var s=this,a=i&&i.event_id,r=Object(C.i)(t)?this._getBackend().eventFromMessage(String(t),e,i):this._getBackend().eventFromException(t,i);return this._process(r.then(function(t){return s._captureEvent(t,i,n)}).then(function(t){a=t})),a},t.prototype.captureEvent=function(t,e,i){var n=e&&e.event_id;return this._process(this._captureEvent(t,e,i).then(function(t){n=t})),n},t.prototype.captureSession=function(t){this._isEnabled()?"string"!=typeof t.release?b.a.warn("Discarded session because of missing or non-string release"):(this._sendSession(t),t.update({init:!1})):b.a.warn("SDK not enabled, will not capture session.")},t.prototype.getDsn=function(){return this._dsn},t.prototype.getOptions=function(){return this._options},t.prototype.flush=function(t){var e=this;return this._isClientDoneProcessing(t).then(function(i){return e._getBackend().getTransport().close(t).then(function(t){return i&&t})})},t.prototype.close=function(t){var e=this;return this.flush(t).then(function(t){return e.getOptions().enabled=!1,t})},t.prototype.setupIntegrations=function(){this._isEnabled()&&(this._integrations=function(t){var e={};return function(t){var e=t.defaultIntegrations&&Object(l.f)(t.defaultIntegrations)||[],i=t.integrations,n=Object(l.f)(T(e));Array.isArray(i)?n=Object(l.f)(n.filter(function(t){return i.every(function(e){return e.name!==t.name})}),T(i)):"function"==typeof i&&(n=i(n),n=Array.isArray(n)?n:[n]);var s=n.map(function(t){return t.name}),a="Debug";return-1!==s.indexOf(a)&&n.push.apply(n,Object(l.f)(n.splice(s.indexOf(a),1))),n}(t).forEach(function(t){e[t.name]=t,function(t){-1===O.indexOf(t.name)&&(t.setupOnce(d.b,h.b),O.push(t.name),b.a.log("Integration installed: "+t.name))}(t)}),e}(this._options))},t.prototype.getIntegration=function(t){try{return this._integrations[t.id]||null}catch(e){return b.a.warn("Cannot retrieve integration "+t.id+" from the current Client"),null}},t.prototype._updateSessionFromEvent=function(t,e){var i,n,s=!1,a=!1,r=e.exception&&e.exception.values;if(r){a=!0;try{for(var o=Object(l.g)(r),c=o.next();!c.done;c=o.next()){var u=c.value.mechanism;if(u&&!1===u.handled){s=!0;break}}}catch(h){i={error:h}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}}var d=t.status===_.a.Ok;(d&&0===t.errors||d&&s)&&(t.update(Object(l.a)(Object(l.a)({},s&&{status:_.a.Crashed}),{errors:t.errors||Number(a||s)})),this.captureSession(t))},t.prototype._sendSession=function(t){this._getBackend().sendSession(t)},t.prototype._isClientDoneProcessing=function(t){var e=this;return new v.a(function(i){var n=0,s=setInterval(function(){0==e._numProcessing?(clearInterval(s),i(!0)):(n+=1,t&&n>=t&&(clearInterval(s),i(!1)))},1)})},t.prototype._getBackend=function(){return this._backend},t.prototype._isEnabled=function(){return!1!==this.getOptions().enabled&&void 0!==this._dsn},t.prototype._prepareEvent=function(t,e,i){var n=this,s=this.getOptions().normalizeDepth,a=void 0===s?3:s,r=Object(l.a)(Object(l.a)({},t),{event_id:t.event_id||(i&&i.event_id?i.event_id:Object(m.j)()),timestamp:t.timestamp||Object(L.b)()});this._applyClientOptions(r),this._applyIntegrationsMetadata(r);var o=e;i&&i.captureContext&&(o=d.a.clone(o).update(i.captureContext));var c=v.a.resolve(r);return o&&(c=o.applyToEvent(r,i)),c.then(function(t){return"number"==typeof a&&a>0?n._normalizeEvent(t,a):t})},t.prototype._normalizeEvent=function(t,e){if(!t)return null;var i=Object(l.a)(Object(l.a)(Object(l.a)(Object(l.a)(Object(l.a)({},t),t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map(function(t){return Object(l.a)(Object(l.a)({},t),t.data&&{data:Object(R.d)(t.data,e)})})}),t.user&&{user:Object(R.d)(t.user,e)}),t.contexts&&{contexts:Object(R.d)(t.contexts,e)}),t.extra&&{extra:Object(R.d)(t.extra,e)});t.contexts&&t.contexts.trace&&(i.contexts.trace=t.contexts.trace);var n=this.getOptions()._experiments;return(void 0===n?{}:n).ensureNoCircularStructures?Object(R.d)(i):i},t.prototype._applyClientOptions=function(t){var e=this.getOptions(),i=e.release,n=e.dist,s=e.maxValueLength,a=void 0===s?250:s;"environment"in t||(t.environment="environment"in e?e.environment:"production"),void 0===t.release&&void 0!==i&&(t.release=i),void 0===t.dist&&void 0!==n&&(t.dist=n),t.message&&(t.message=Object(p.d)(t.message,a));var r=t.exception&&t.exception.values&&t.exception.values[0];r&&r.value&&(r.value=Object(p.d)(r.value,a));var o=t.request;o&&o.url&&(o.url=Object(p.d)(o.url,a))},t.prototype._applyIntegrationsMetadata=function(t){var e=Object.keys(this._integrations);e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=Object(l.f)(t.sdk.integrations||[],e))},t.prototype._sendEvent=function(t){this._getBackend().sendEvent(t)},t.prototype._captureEvent=function(t,e,i){return this._processEvent(t,e,i).then(function(t){return t.event_id},function(t){b.a.error(t)})},t.prototype._processEvent=function(t,e,i){var n=this,s=this.getOptions(),a=s.beforeSend,r=s.sampleRate;if(!this._isEnabled())return v.a.reject(new w("SDK not enabled, will not capture event."));var o="transaction"===t.type;return!o&&"number"==typeof r&&Math.random()>r?v.a.reject(new w("Discarding event because it's not included in the random sample (sampling rate = "+r+")")):this._prepareEvent(t,i,e).then(function(t){if(null===t)throw new w("An event processor returned null, will not send event.");if(e&&e.data&&!0===e.data.__sentry__||o||!a)return t;var i=a(t,e);return n._ensureBeforeSendRv(i)}).then(function(t){if(null===t)throw new w("`beforeSend` returned `null`, will not send event.");var e=i&&i.getSession&&i.getSession();return!o&&e&&n._updateSessionFromEvent(e,t),n._sendEvent(t),t}).then(null,function(t){if(t instanceof w)throw t;throw n.captureException(t,{data:{__sentry__:!0},originalException:t}),new w("Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: "+t)})},t.prototype._process=function(t){var e=this;this._numProcessing+=1,t.then(function(t){return e._numProcessing-=1,t},function(t){return e._numProcessing-=1,t})},t.prototype._ensureBeforeSendRv=function(t){var e="`beforeSend` method has to return `null` or a valid event.";if(Object(C.m)(t))return t.then(function(t){if(!Object(C.h)(t)&&null!==t)throw new w(e);return t},function(t){throw new w("beforeSend rejected with "+t)});if(!Object(C.h)(t)&&null!==t)throw new w(e);return t},t}();!function(t){t.Unknown="unknown",t.Skipped="skipped",t.Success="success",t.RateLimit="rate_limit",t.Invalid="invalid",t.Failed="failed"}(x||(x={})),function(t){t.fromHttpCode=function(e){return e>=200&&e<300?t.Success:429===e?t.RateLimit:e>=400&&e<500?t.Invalid:e>=500?t.Failed:t.Unknown}}(x||(x={}));var j,M=function(){function t(){}return t.prototype.sendEvent=function(t){return v.a.resolve({reason:"NoopTransport: Event has been skipped because no Dsn is configured.",status:x.Skipped})},t.prototype.close=function(t){return v.a.resolve(!0)},t}(),Q=function(){function t(t){this._options=t,this._options.dsn||b.a.warn("No DSN provided, backend will not do anything."),this._transport=this._setupTransport()}return t.prototype.eventFromException=function(t,e){throw new w("Backend has to implement `eventFromException` method")},t.prototype.eventFromMessage=function(t,e,i){throw new w("Backend has to implement `eventFromMessage` method")},t.prototype.sendEvent=function(t){this._transport.sendEvent(t).then(null,function(t){b.a.error("Error while sending event: "+t)})},t.prototype.sendSession=function(t){this._transport.sendSession?this._transport.sendSession(t).then(null,function(t){b.a.error("Error while sending session: "+t)}):b.a.warn("Dropping session because custom transport doesn't implement sendSession")},t.prototype.getTransport=function(){return this._transport},t.prototype._setupTransport=function(){return new M},t}();!function(t){t.Fatal="fatal",t.Error="error",t.Warning="warning",t.Log="log",t.Info="info",t.Debug="debug",t.Critical="critical"}(j||(j={})),function(t){t.fromString=function(e){switch(e){case"debug":return t.Debug;case"info":return t.Info;case"warn":case"warning":return t.Warning;case"error":return t.Error;case"fatal":return t.Fatal;case"critical":return t.Critical;case"log":default:return t.Log}}}(j||(j={}));var A=i("4Ssk"),D="?",E=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|.*bundle|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,N=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:file|https?|blob|chrome|webpack|resource|moz-extension|capacitor).*?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,F=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,P=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,U=/\((\S*)(?::(\d+))(?::(\d+))\)/,z=/Minified React error #\d+;/i;function J(t){var e=null,i=0;t&&("number"==typeof t.framesToPop?i=t.framesToPop:z.test(t.message)&&(i=1));try{if(e=function(t){if(!t||!t.stacktrace)return null;for(var e,i=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,n=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^)]+))\((.*)\))? in (.*):\s*$/i,s=t.stacktrace.split("\n"),a=[],r=0;r<s.length;r+=2){var o=null;(e=i.exec(s[r]))?o={url:e[2],func:e[3],args:[],line:+e[1],column:null}:(e=n.exec(s[r]))&&(o={url:e[6],func:e[3]||e[4],args:e[5]?e[5].split(","):[],line:+e[1],column:+e[2]}),o&&(!o.func&&o.line&&(o.func=D),a.push(o))}return a.length?{message:V(t),name:t.name,stack:a}:null}(t))return q(e,i)}catch(n){}try{if(e=function(t){if(!t||!t.stack)return null;for(var e,i,n,s=[],a=t.stack.split("\n"),r=0;r<a.length;++r){if(i=E.exec(a[r])){var o=i[2]&&0===i[2].indexOf("native");i[2]&&0===i[2].indexOf("eval")&&(e=U.exec(i[2]))&&(i[2]=e[1],i[3]=e[2],i[4]=e[3]);var c=i[2]&&0===i[2].indexOf("address at ")?i[2].substr("address at ".length):i[2],l=i[1]||D,u=-1!==l.indexOf("safari-extension"),d=-1!==l.indexOf("safari-web-extension");(u||d)&&(l=-1!==l.indexOf("@")?l.split("@")[0]:D,c=u?"safari-extension:"+c:"safari-web-extension:"+c),n={url:c,func:l,args:o?[i[2]]:[],line:i[3]?+i[3]:null,column:i[4]?+i[4]:null}}else if(i=F.exec(a[r]))n={url:i[2],func:i[1]||D,args:[],line:+i[3],column:i[4]?+i[4]:null};else{if(!(i=N.exec(a[r])))continue;i[3]&&i[3].indexOf(" > eval")>-1&&(e=P.exec(i[3]))?(i[1]=i[1]||"eval",i[3]=e[1],i[4]=e[2],i[5]=""):0!==r||i[5]||void 0===t.columnNumber||(s[0].column=t.columnNumber+1),n={url:i[3],func:i[1]||D,args:i[2]?i[2].split(","):[],line:i[4]?+i[4]:null,column:i[5]?+i[5]:null}}!n.func&&n.line&&(n.func=D),s.push(n)}return s.length?{message:V(t),name:t.name,stack:s}:null}(t))return q(e,i)}catch(n){}return{message:V(t),name:t&&t.name,stack:[],failed:!0}}function q(t,e){try{return Object(l.a)(Object(l.a)({},t),{stack:t.stack.slice(e)})}catch(i){return t}}function V(t){var e=t&&t.message;return e?e.error&&"string"==typeof e.error.message?e.error.message:e:"No error message"}function $(t){var e=H(t.stack),i={type:t.name,value:t.message};return e&&e.length&&(i.stacktrace={frames:e}),void 0===i.type&&""===i.value&&(i.value="Unrecoverable error caught"),i}function G(t){return{exception:{values:[$(t)]}}}function H(t){if(!t||!t.length)return[];var e=t,i=e[0].func||"",n=e[e.length-1].func||"";return-1===i.indexOf("captureMessage")&&-1===i.indexOf("captureException")||(e=e.slice(1)),-1!==n.indexOf("sentryWrapped")&&(e=e.slice(0,-1)),e.slice(0,50).map(function(t){return{colno:null===t.column?void 0:t.column,filename:t.url||e[0].url,function:t.func||"?",in_app:!0,lineno:null===t.line?void 0:t.line}}).reverse()}function Y(t,e,i){var n;if(void 0===i&&(i={}),Object(C.e)(t)&&t.error)return G(J(t=t.error));if(Object(C.a)(t)||Object(C.b)(t)){var s=t,a=s.name||(Object(C.a)(s)?"DOMError":"DOMException"),r=s.message?a+": "+s.message:a;return n=W(r,e,i),Object(m.b)(n,r),"code"in s&&(n.tags=Object(l.a)(Object(l.a)({},n.tags),{"DOMException.code":""+s.code})),n}return Object(C.d)(t)?n=G(J(t)):Object(C.h)(t)||Object(C.f)(t)?(n=function(t,e,i){var n={exception:{values:[{type:Object(C.f)(t)?t.constructor.name:i?"UnhandledRejection":"Error",value:"Non-Error "+(i?"promise rejection":"exception")+" captured with keys: "+Object(R.b)(t)}]},extra:{__serialized__:Object(R.e)(t)}};if(e){var s=H(J(e).stack);n.stacktrace={frames:s}}return n}(t,e,i.rejection),Object(m.a)(n,{synthetic:!0}),n):(n=W(t,e,i),Object(m.b)(n,""+t,void 0),Object(m.a)(n,{synthetic:!0}),n)}function W(t,e,i){void 0===i&&(i={});var n={message:t};if(i.attachStacktrace&&e){var s=H(J(e).stack);n.stacktrace={frames:s}}return n}function K(t){if(t.metadata&&t.metadata.sdk){var e=t.metadata.sdk;return{name:e.name,version:e.version}}}function X(t,e){return e?(t.sdk=t.sdk||{},t.sdk.name=t.sdk.name||e.name,t.sdk.version=t.sdk.version||e.version,t.sdk.integrations=Object(l.f)(t.sdk.integrations||[],e.integrations||[]),t.sdk.packages=Object(l.f)(t.sdk.packages||[],e.packages||[]),t):t}function Z(t,e){var i=K(e),n="aggregates"in t?"sessions":"session";return{body:JSON.stringify(Object(l.a)(Object(l.a)({sent_at:(new Date).toISOString()},i&&{sdk:i}),e.forceEnvelope()&&{dsn:e.getDsn().toString()}))+"\n"+JSON.stringify({type:n})+"\n"+JSON.stringify(t),type:n,url:e.getEnvelopeEndpointWithUrlEncodedAuth()}}function tt(t,e){var i=K(e),n=t.type||"event",s="transaction"===n||e.forceEnvelope(),a=t.debug_meta||{},r=a.transactionSampling,o=Object(l.e)(a,["transactionSampling"]),c=r||{},u=c.method,d=c.rate;0===Object.keys(o).length?delete t.debug_meta:t.debug_meta=o;var h={body:JSON.stringify(i?X(t,e.metadata.sdk):t),type:n,url:s?e.getEnvelopeEndpointWithUrlEncodedAuth():e.getStoreEndpointWithUrlEncodedAuth()};if(s){var b=JSON.stringify(Object(l.a)(Object(l.a)({event_id:t.event_id,sent_at:(new Date).toISOString()},i&&{sdk:i}),e.forceEnvelope()&&{dsn:e.getDsn().toString()})),m=JSON.stringify({type:n,sample_rates:[{id:u,rate:d}]});h.body=b+"\n"+m+"\n"+h.body}return h}var et=function(){function t(t,e,i){void 0===e&&(e={}),this.dsn=t,this._dsnObject=new I(t),this.metadata=e,this._tunnel=i}return t.prototype.getDsn=function(){return this._dsnObject},t.prototype.forceEnvelope=function(){return!!this._tunnel},t.prototype.getBaseApiEndpoint=function(){var t=this.getDsn();return(t.protocol?t.protocol+":":"")+"//"+t.host+(t.port?":"+t.port:"")+(t.path?"/"+t.path:"")+"/api/"},t.prototype.getStoreEndpoint=function(){return this._getIngestEndpoint("store")},t.prototype.getStoreEndpointWithUrlEncodedAuth=function(){return this.getStoreEndpoint()+"?"+this._encodedAuth()},t.prototype.getEnvelopeEndpointWithUrlEncodedAuth=function(){return this.forceEnvelope()?this._tunnel:this._getEnvelopeEndpoint()+"?"+this._encodedAuth()},t.prototype.getStoreEndpointPath=function(){var t=this.getDsn();return(t.path?"/"+t.path:"")+"/api/"+t.projectId+"/store/"},t.prototype.getRequestHeaders=function(t,e){var i=this.getDsn(),n=["Sentry sentry_version=7"];return n.push("sentry_client="+t+"/"+e),n.push("sentry_key="+i.publicKey),i.pass&&n.push("sentry_secret="+i.pass),{"Content-Type":"application/json","X-Sentry-Auth":n.join(", ")}},t.prototype.getReportDialogEndpoint=function(t){void 0===t&&(t={});var e=this.getDsn(),i=this.getBaseApiEndpoint()+"embed/error-page/",n=[];for(var s in n.push("dsn="+e.toString()),t)if("dsn"!==s)if("user"===s){if(!t.user)continue;t.user.name&&n.push("name="+encodeURIComponent(t.user.name)),t.user.email&&n.push("email="+encodeURIComponent(t.user.email))}else n.push(encodeURIComponent(s)+"="+encodeURIComponent(t[s]));return n.length?i+"?"+n.join("&"):i},t.prototype._getEnvelopeEndpoint=function(){return this._getIngestEndpoint("envelope")},t.prototype._getIngestEndpoint=function(t){return this._tunnel?this._tunnel:""+this.getBaseApiEndpoint()+this.getDsn().projectId+"/"+t+"/"},t.prototype._encodedAuth=function(){var t={sentry_key:this.getDsn().publicKey,sentry_version:"7"};return Object(R.f)(t)},t}(),it=function(){function t(t){this._limit=t,this._buffer=[]}return t.prototype.isReady=function(){return void 0===this._limit||this.length()<this._limit},t.prototype.add=function(t){var e=this;if(!this.isReady())return v.a.reject(new w("Not adding Promise due to buffer limit reached."));var i=t();return-1===this._buffer.indexOf(i)&&this._buffer.push(i),i.then(function(){return e.remove(i)}).then(null,function(){return e.remove(i).then(null,function(){})}),i},t.prototype.remove=function(t){return this._buffer.splice(this._buffer.indexOf(t),1)[0]},t.prototype.length=function(){return this._buffer.length},t.prototype.drain=function(t){var e=this;return new v.a(function(i){var n=setTimeout(function(){t&&t>0&&i(!1)},t);v.a.all(e._buffer).then(function(){clearTimeout(n),i(!0)}).then(null,function(){i(!0)})})},t}(),nt={event:"error",transaction:"transaction",session:"session",attachment:"attachment"},st=function(){function t(t){this.options=t,this._buffer=new it(30),this._rateLimits={},this._api=new et(t.dsn,t._metadata,t.tunnel),this.url=this._api.getStoreEndpointWithUrlEncodedAuth()}return t.prototype.sendEvent=function(t){throw new w("Transport Class has to implement `sendEvent` method")},t.prototype.close=function(t){return this._buffer.drain(t)},t.prototype._handleResponse=function(t){var e=t.requestType,i=t.response,n=t.headers,s=t.resolve,a=t.reject,r=x.fromHttpCode(i.status);this._handleRateLimit(n)&&b.a.warn("Too many "+e+" requests, backing off until: "+this._disabledUntil(e)),r!==x.Success?a(i):s({status:r})},t.prototype._disabledUntil=function(t){return this._rateLimits[nt[t]]||this._rateLimits.all},t.prototype._isRateLimited=function(t){return this._disabledUntil(t)>new Date(Date.now())},t.prototype._handleRateLimit=function(t){var e,i,n,s,a=Date.now(),r=t["x-sentry-rate-limits"],o=t["retry-after"];if(r){try{for(var c=Object(l.g)(r.trim().split(",")),u=c.next();!u.done;u=c.next()){var d=u.value.split(":",2),h=parseInt(d[0],10),b=1e3*(isNaN(h)?60:h);try{for(var p=(n=void 0,Object(l.g)(d[1].split(";"))),g=p.next();!g.done;g=p.next())this._rateLimits[g.value||"all"]=new Date(a+b)}catch(f){n={error:f}}finally{try{g&&!g.done&&(s=p.return)&&s.call(p)}finally{if(n)throw n.error}}}}catch(v){e={error:v}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(e)throw e.error}}return!0}return!!o&&(this._rateLimits.all=new Date(a+Object(m.g)(a,o)),!0)},t}(),at=function(t){function e(e,i){void 0===i&&(i=function(){var t,e,i=Object(m.e)();if(Object(A.a)(i.fetch))return i.fetch.bind(i);var n=i.document,s=i.fetch;if("function"==typeof(null===(t=n)||void 0===t?void 0:t.createElement))try{var a=n.createElement("iframe");a.hidden=!0,n.head.appendChild(a),(null===(e=a.contentWindow)||void 0===e?void 0:e.fetch)&&(s=a.contentWindow.fetch),n.head.removeChild(a)}catch(r){b.a.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",r)}return s.bind(i)}());var n=t.call(this,e)||this;return n._fetch=i,n}return Object(l.c)(e,t),e.prototype.sendEvent=function(t){return this._sendRequest(tt(t,this._api),t)},e.prototype.sendSession=function(t){return this._sendRequest(Z(t,this._api),t)},e.prototype._sendRequest=function(t,e){var i=this;if(this._isRateLimited(t.type))return Promise.reject({event:e,type:t.type,reason:"Transport for "+t.type+" requests locked till "+this._disabledUntil(t.type)+" due to too many requests.",status:429});var n={body:t.body,method:"POST",referrerPolicy:Object(A.e)()?"origin":""};return void 0!==this.options.fetchParameters&&Object.assign(n,this.options.fetchParameters),void 0!==this.options.headers&&(n.headers=this.options.headers),this._buffer.add(function(){return new v.a(function(e,s){i._fetch(t.url,n).then(function(n){var a={"x-sentry-rate-limits":n.headers.get("X-Sentry-Rate-Limits"),"retry-after":n.headers.get("Retry-After")};i._handleResponse({requestType:t.type,response:n,headers:a,resolve:e,reject:s})}).catch(s)})})},e}(st),rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(l.c)(e,t),e.prototype.sendEvent=function(t){return this._sendRequest(tt(t,this._api),t)},e.prototype.sendSession=function(t){return this._sendRequest(Z(t,this._api),t)},e.prototype._sendRequest=function(t,e){var i=this;return this._isRateLimited(t.type)?Promise.reject({event:e,type:t.type,reason:"Transport for "+t.type+" requests locked till "+this._disabledUntil(t.type)+" due to too many requests.",status:429}):this._buffer.add(function(){return new v.a(function(e,n){var s=new XMLHttpRequest;for(var a in s.onreadystatechange=function(){if(4===s.readyState){var a={"x-sentry-rate-limits":s.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":s.getResponseHeader("Retry-After")};i._handleResponse({requestType:t.type,response:s,headers:a,resolve:e,reject:n})}},s.open("POST",t.url),i.options.headers)i.options.headers.hasOwnProperty(a)&&s.setRequestHeader(a,i.options.headers[a]);s.send(t.body)})})},e}(st),ot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(l.c)(e,t),e.prototype.eventFromException=function(t,e){return function(t,e,i){var n=Y(e,i&&i.syntheticException||void 0,{attachStacktrace:t.attachStacktrace});return Object(m.a)(n,{handled:!0,type:"generic"}),n.level=j.Error,i&&i.event_id&&(n.event_id=i.event_id),v.a.resolve(n)}(this._options,t,e)},e.prototype.eventFromMessage=function(t,e,i){return void 0===e&&(e=j.Info),function(t,e,i,n){void 0===i&&(i=j.Info);var s=W(e,n&&n.syntheticException||void 0,{attachStacktrace:t.attachStacktrace});return s.level=i,n&&n.event_id&&(s.event_id=n.event_id),v.a.resolve(s)}(this._options,t,e,i)},e.prototype._setupTransport=function(){if(!this._options.dsn)return t.prototype._setupTransport.call(this);var e=Object(l.a)(Object(l.a)({},this._options.transportOptions),{dsn:this._options.dsn,tunnel:this._options.tunnel,_metadata:this._options._metadata});return this._options.transport?new this._options.transport(e):Object(A.b)()?new at(e):new rt(e)},e}(Q);function ct(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=Object(h.b)();if(n&&n[t])return n[t].apply(n,Object(l.f)(e));throw new Error("No hub defined or "+t+" was not found on the hub, please open a bug report.")}function lt(t,e){var i;try{throw new Error("Sentry syntheticException")}catch(t){i=t}return ct("captureException",t,{captureContext:e,originalException:t,syntheticException:i})}function ut(t){ct("withScope",t)}var dt=0;function ht(){return dt>0}function bt(){dt+=1,setTimeout(function(){dt-=1})}function mt(t,e,i){if(void 0===e&&(e={}),"function"!=typeof t)return t;try{if(t.__sentry__)return t;if(t.__sentry_wrapped__)return t.__sentry_wrapped__}catch(a){return t}var n=function(){var n=Array.prototype.slice.call(arguments);try{i&&"function"==typeof i&&i.apply(this,arguments);var s=n.map(function(t){return mt(t,e)});return t.handleEvent?t.handleEvent.apply(this,s):t.apply(this,s)}catch(a){throw bt(),ut(function(t){t.addEventProcessor(function(t){var i=Object(l.a)({},t);return e.mechanism&&(Object(m.b)(i,void 0,void 0),Object(m.a)(i,e.mechanism)),i.extra=Object(l.a)(Object(l.a)({},i.extra),{arguments:n}),i}),lt(a)}),a}};try{for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}catch(r){}t.prototype=t.prototype||{},n.prototype=t.prototype,Object.defineProperty(t,"__sentry_wrapped__",{enumerable:!1,value:n}),Object.defineProperties(n,{__sentry__:{enumerable:!1,value:!0},__sentry_original__:{enumerable:!1,value:t}});try{Object.getOwnPropertyDescriptor(n,"name").configurable&&Object.defineProperty(n,"name",{get:function(){return t.name}})}catch(r){}return n}var pt=i("vFt6"),gt=function(){function t(e){this.name=t.id,this._options=Object(l.a)({console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0},e)}return t.prototype.addSentryBreadcrumb=function(t){this._options.sentry&&Object(h.b)().addBreadcrumb({category:"sentry."+("transaction"===t.type?"transaction":"event"),event_id:t.event_id,level:t.level,message:Object(m.d)(t)},{event:t})},t.prototype.setupOnce=function(){var t=this;this._options.console&&Object(y.a)({callback:function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t._consoleBreadcrumb.apply(t,Object(l.f)(e))},type:"console"}),this._options.dom&&Object(y.a)({callback:function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t._domBreadcrumb.apply(t,Object(l.f)(e))},type:"dom"}),this._options.xhr&&Object(y.a)({callback:function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t._xhrBreadcrumb.apply(t,Object(l.f)(e))},type:"xhr"}),this._options.fetch&&Object(y.a)({callback:function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t._fetchBreadcrumb.apply(t,Object(l.f)(e))},type:"fetch"}),this._options.history&&Object(y.a)({callback:function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t._historyBreadcrumb.apply(t,Object(l.f)(e))},type:"history"})},t.prototype._consoleBreadcrumb=function(t){var e={category:"console",data:{arguments:t.args,logger:"console"},level:j.fromString(t.level),message:Object(p.b)(t.args," ")};if("assert"===t.level){if(!1!==t.args[0])return;e.message="Assertion failed: "+(Object(p.b)(t.args.slice(1)," ")||"console.assert"),e.data.arguments=t.args.slice(1)}Object(h.b)().addBreadcrumb(e,{input:t.args,level:t.level})},t.prototype._domBreadcrumb=function(t){var e,i="object"==typeof this._options.dom?this._options.dom.serializeAttribute:void 0;"string"==typeof i&&(i=[i]);try{e=t.event.target?Object(pt.a)(t.event.target,i):Object(pt.a)(t.event,i)}catch(n){e="<unknown>"}0!==e.length&&Object(h.b)().addBreadcrumb({category:"ui."+t.name,message:e},{event:t.event,name:t.name,global:t.global})},t.prototype._xhrBreadcrumb=function(t){if(t.endTimestamp){if(t.xhr.__sentry_own_request__)return;var e=t.xhr.__sentry_xhr__||{},i=e.method,n=e.url,s=e.status_code,a=e.body;Object(h.b)().addBreadcrumb({category:"xhr",data:{method:i,url:n,status_code:s},type:"http"},{xhr:t.xhr,input:a})}},t.prototype._fetchBreadcrumb=function(t){t.endTimestamp&&(t.fetchData.url.match(/sentry_key/)&&"POST"===t.fetchData.method||(t.error?Object(h.b)().addBreadcrumb({category:"fetch",data:t.fetchData,level:j.Error,type:"http"},{data:t.error,input:t.args}):Object(h.b)().addBreadcrumb({category:"fetch",data:Object(l.a)(Object(l.a)({},t.fetchData),{status_code:t.response.status}),type:"http"},{input:t.args,response:t.response})))},t.prototype._historyBreadcrumb=function(t){var e=Object(m.e)(),i=t.from,n=t.to,s=Object(m.h)(e.location.href),a=Object(m.h)(i),r=Object(m.h)(n);a.path||(a=s),s.protocol===r.protocol&&s.host===r.host&&(n=r.relative),s.protocol===a.protocol&&s.host===a.host&&(i=a.relative),Object(h.b)().addBreadcrumb({category:"navigation",data:{from:i,to:n}})},t.id="Breadcrumbs",t}(),ft=function(t){function e(e){return void 0===e&&(e={}),e._metadata=e._metadata||{},e._metadata.sdk=e._metadata.sdk||{name:"sentry.javascript.browser",packages:[{name:"npm:@sentry/browser",version:c}],version:c},t.call(this,ot,e)||this}return Object(l.c)(e,t),e.prototype.showReportDialog=function(t){void 0===t&&(t={}),Object(m.e)().document&&(this._isEnabled()?function(t){if(void 0===t&&(t={}),t.eventId)if(t.dsn){var e=document.createElement("script");e.async=!0,e.src=new et(t.dsn).getReportDialogEndpoint(t),t.onLoad&&(e.onload=t.onLoad),(document.head||document.body).appendChild(e)}else b.a.error("Missing dsn option in showReportDialog call");else b.a.error("Missing eventId option in showReportDialog call")}(Object(l.a)(Object(l.a)({},t),{dsn:t.dsn||this.getDsn()})):b.a.error("Trying to call showReportDialog with Sentry Client disabled"))},e.prototype._prepareEvent=function(e,i,n){return e.platform=e.platform||"javascript",t.prototype._prepareEvent.call(this,e,i,n)},e.prototype._sendEvent=function(e){var i=this.getIntegration(gt);i&&i.addSentryBreadcrumb(e),t.prototype._sendEvent.call(this,e)},e}(B),vt=i("pRiV"),yt=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],_t=function(){function t(e){this.name=t.id,this._options=Object(l.a)({XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0},e)}return t.prototype.setupOnce=function(){var t=Object(m.e)();this._options.setTimeout&&Object(R.c)(t,"setTimeout",this._wrapTimeFunction.bind(this)),this._options.setInterval&&Object(R.c)(t,"setInterval",this._wrapTimeFunction.bind(this)),this._options.requestAnimationFrame&&Object(R.c)(t,"requestAnimationFrame",this._wrapRAF.bind(this)),this._options.XMLHttpRequest&&"XMLHttpRequest"in t&&Object(R.c)(XMLHttpRequest.prototype,"send",this._wrapXHR.bind(this)),this._options.eventTarget&&(Array.isArray(this._options.eventTarget)?this._options.eventTarget:yt).forEach(this._wrapEventTarget.bind(this))},t.prototype._wrapTimeFunction=function(t){return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var n=e[0];return e[0]=mt(n,{mechanism:{data:{function:Object(vt.a)(t)},handled:!0,type:"instrument"}}),t.apply(this,e)}},t.prototype._wrapRAF=function(t){return function(e){return t.call(this,mt(e,{mechanism:{data:{function:"requestAnimationFrame",handler:Object(vt.a)(t)},handled:!0,type:"instrument"}}))}},t.prototype._wrapEventTarget=function(t){var e=Object(m.e)(),i=e[t]&&e[t].prototype;i&&i.hasOwnProperty&&i.hasOwnProperty("addEventListener")&&(Object(R.c)(i,"addEventListener",function(e){return function(i,n,s){try{"function"==typeof n.handleEvent&&(n.handleEvent=mt(n.handleEvent.bind(n),{mechanism:{data:{function:"handleEvent",handler:Object(vt.a)(n),target:t},handled:!0,type:"instrument"}}))}catch(a){}return e.call(this,i,mt(n,{mechanism:{data:{function:"addEventListener",handler:Object(vt.a)(n),target:t},handled:!0,type:"instrument"}}),s)}}),Object(R.c)(i,"removeEventListener",function(t){return function(e,i,n){var s,a=i;try{var r=null===(s=a)||void 0===s?void 0:s.__sentry_wrapped__;r&&t.call(this,e,r,n)}catch(o){}return t.call(this,e,a,n)}}))},t.prototype._wrapXHR=function(t){return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var n=this,s=["onload","onerror","onprogress","onreadystatechange"];return s.forEach(function(t){t in n&&"function"==typeof n[t]&&Object(R.c)(n,t,function(e){var i={mechanism:{data:{function:t,handler:Object(vt.a)(e)},handled:!0,type:"instrument"}};return e.__sentry_original__&&(i.mechanism.data.handler=Object(vt.a)(e.__sentry_original__)),mt(e,i)})}),t.apply(this,e)}},t.id="TryCatch",t}(),kt=function(){function t(e){this.name=t.id,this._onErrorHandlerInstalled=!1,this._onUnhandledRejectionHandlerInstalled=!1,this._options=Object(l.a)({onerror:!0,onunhandledrejection:!0},e)}return t.prototype.setupOnce=function(){Error.stackTraceLimit=50,this._options.onerror&&(b.a.log("Global Handler attached: onerror"),this._installGlobalOnErrorHandler()),this._options.onunhandledrejection&&(b.a.log("Global Handler attached: onunhandledrejection"),this._installGlobalOnUnhandledRejectionHandler())},t.prototype._installGlobalOnErrorHandler=function(){var e=this;this._onErrorHandlerInstalled||(Object(y.a)({callback:function(i){var n=i.error,s=Object(h.b)(),a=s.getIntegration(t),r=n&&!0===n.__sentry_own_request__;if(a&&!ht()&&!r){var o=s.getClient(),c=void 0===n&&Object(C.k)(i.msg)?e._eventFromIncompleteOnError(i.msg,i.url,i.line,i.column):e._enhanceEventWithInitialFrame(Y(n||i.msg,void 0,{attachStacktrace:o&&o.getOptions().attachStacktrace,rejection:!1}),i.url,i.line,i.column);Object(m.a)(c,{handled:!1,type:"onerror"}),s.captureEvent(c,{originalException:n})}},type:"error"}),this._onErrorHandlerInstalled=!0)},t.prototype._installGlobalOnUnhandledRejectionHandler=function(){var e=this;this._onUnhandledRejectionHandlerInstalled||(Object(y.a)({callback:function(i){var n=i;try{"reason"in i?n=i.reason:"detail"in i&&"reason"in i.detail&&(n=i.detail.reason)}catch(l){}var s=Object(h.b)(),a=s.getIntegration(t),r=n&&!0===n.__sentry_own_request__;if(!a||ht()||r)return!0;var o=s.getClient(),c=Object(C.i)(n)?e._eventFromRejectionWithPrimitive(n):Y(n,void 0,{attachStacktrace:o&&o.getOptions().attachStacktrace,rejection:!0});c.level=j.Error,Object(m.a)(c,{handled:!1,type:"onunhandledrejection"}),s.captureEvent(c,{originalException:n})},type:"unhandledrejection"}),this._onUnhandledRejectionHandlerInstalled=!0)},t.prototype._eventFromIncompleteOnError=function(t,e,i,n){var s,a=Object(C.e)(t)?t.message:t,r=a.match(/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i);return r&&(s=r[1],a=r[2]),this._enhanceEventWithInitialFrame({exception:{values:[{type:s||"Error",value:a}]}},e,i,n)},t.prototype._eventFromRejectionWithPrimitive=function(t){return{exception:{values:[{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+String(t)}]}}},t.prototype._enhanceEventWithInitialFrame=function(t,e,i,n){t.exception=t.exception||{},t.exception.values=t.exception.values||[],t.exception.values[0]=t.exception.values[0]||{},t.exception.values[0].stacktrace=t.exception.values[0].stacktrace||{},t.exception.values[0].stacktrace.frames=t.exception.values[0].stacktrace.frames||[];var s=isNaN(parseInt(n,10))?void 0:n,a=isNaN(parseInt(i,10))?void 0:i,r=Object(C.k)(e)&&e.length>0?e:Object(m.f)();return 0===t.exception.values[0].stacktrace.frames.length&&t.exception.values[0].stacktrace.frames.push({colno:s,filename:r,function:"?",in_app:!0,lineno:a}),t},t.id="GlobalHandlers",t}(),wt=function(){function t(e){void 0===e&&(e={}),this.name=t.id,this._key=e.key||"cause",this._limit=e.limit||5}return t.prototype.setupOnce=function(){Object(d.b)(function(e,i){var n=Object(h.b)().getIntegration(t);return n?n._handler(e,i):e})},t.prototype._handler=function(t,e){if(!(t.exception&&t.exception.values&&e&&Object(C.g)(e.originalException,Error)))return t;var i=this._walkErrorTree(e.originalException,this._key);return t.exception.values=Object(l.f)(i,t.exception.values),t},t.prototype._walkErrorTree=function(t,e,i){if(void 0===i&&(i=[]),!Object(C.g)(t[e],Error)||i.length+1>=this._limit)return i;var n=$(J(t[e]));return this._walkErrorTree(t[e],e,Object(l.f)([n],i))},t.id="LinkedErrors",t}(),St=function(){function t(){this.name=t.id}return t.prototype.setupOnce=function(e,i){e(function(e){var n=i().getIntegration(t);if(n){try{if(n._shouldDropEvent(e,n._previousEvent))return null}catch(s){return n._previousEvent=e}return n._previousEvent=e}return e})},t.prototype._shouldDropEvent=function(t,e){return!(!e||!this._isSameMessageEvent(t,e)&&!this._isSameExceptionEvent(t,e))},t.prototype._isSameMessageEvent=function(t,e){var i=t.message,n=e.message;return!(!i&&!n||i&&!n||!i&&n||i!==n||!this._isSameFingerprint(t,e)||!this._isSameStacktrace(t,e))},t.prototype._getFramesFromEvent=function(t){var e=t.exception;if(e)try{return e.values[0].stacktrace.frames}catch(i){return}else if(t.stacktrace)return t.stacktrace.frames},t.prototype._isSameStacktrace=function(t,e){var i=this._getFramesFromEvent(t),n=this._getFramesFromEvent(e);if(!i&&!n)return!0;if(i&&!n||!i&&n)return!1;if((n=n).length!==(i=i).length)return!1;for(var s=0;s<n.length;s++){var a=n[s],r=i[s];if(a.filename!==r.filename||a.lineno!==r.lineno||a.colno!==r.colno||a.function!==r.function)return!1}return!0},t.prototype._getExceptionFromEvent=function(t){return t.exception&&t.exception.values&&t.exception.values[0]},t.prototype._isSameExceptionEvent=function(t,e){var i=this._getExceptionFromEvent(e),n=this._getExceptionFromEvent(t);return!!(i&&n&&i.type===n.type&&i.value===n.value&&this._isSameFingerprint(t,e)&&this._isSameStacktrace(t,e))},t.prototype._isSameFingerprint=function(t,e){var i=t.fingerprint,n=e.fingerprint;if(!i&&!n)return!0;if(i&&!n||!i&&n)return!1;i=i,n=n;try{return!(i.join("")!==n.join(""))}catch(s){return!1}},t.id="Dedupe",t}(),It=Object(m.e)(),Ct=function(){function t(){this.name=t.id}return t.prototype.setupOnce=function(){Object(d.b)(function(e){var i,n,s;if(Object(h.b)().getIntegration(t)){if(!It.navigator&&!It.location&&!It.document)return e;var a=(null===(i=e.request)||void 0===i?void 0:i.url)||(null===(n=It.location)||void 0===n?void 0:n.href),r=(It.document||{}).referrer,o=(It.navigator||{}).userAgent,c=Object(l.a)(Object(l.a)(Object(l.a)({},null===(s=e.request)||void 0===s?void 0:s.headers),r&&{Referer:r}),o&&{"User-Agent":o}),u=Object(l.a)(Object(l.a)({},a&&{url:a}),{headers:c});return Object(l.a)(Object(l.a)({},e),{request:u})}return e})},t.id="UserAgent",t}(),Lt=[new n.InboundFilters,new n.FunctionToString,new _t,new gt,new kt,new wt,new St,new Ct];let Rt=null;function Ot(){return Rt}const Tt=new o.s("DocumentToken");let xt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Object(o.Jb)({factory:Bt,token:t,providedIn:"platform"}),t})();function Bt(){return Object(o.Vb)(Mt)}const jt=new o.s("Location Initialized");let Mt=(()=>{class t extends xt{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=Ot().getLocation(),this._history=Ot().getHistory()}getBaseHrefFromDOM(){return Ot().getBaseHref(this._doc)}onPopState(t){Ot().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",t,!1)}onHashChange(t){Ot().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",t,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,e,i){Qt()?this._history.pushState(t,e,i):this.location.hash=i}replaceState(t,e,i){Qt()?this._history.replaceState(t,e,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(Tt))},t.\u0275prov=Object(o.Jb)({factory:At,token:t,providedIn:"platform"}),t})();function Qt(){return!!window.history.pushState}function At(){return new Mt(Object(o.Vb)(Tt))}function Dt(t,e){if(0==t.length)return e;if(0==e.length)return t;let i=0;return t.endsWith("/")&&i++,e.startsWith("/")&&i++,2==i?t+e.substring(1):1==i?t+e:t+"/"+e}function Et(t){const e=t.match(/#|\?|$/),i=e&&e.index||t.length;return t.slice(0,i-("/"===t[i-1]?1:0))+t.slice(i)}function Nt(t){return t&&"?"!==t[0]?"?"+t:t}let Ft=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Object(o.Jb)({factory:Pt,token:t,providedIn:"root"}),t})();function Pt(t){const e=Object(o.Vb)(Tt).location;return new zt(Object(o.Vb)(xt),e&&e.origin||"")}const Ut=new o.s("appBaseHref");let zt=(()=>{class t extends Ft{constructor(t,e){if(super(),this._platformLocation=t,null==e&&(e=this._platformLocation.getBaseHrefFromDOM()),null==e)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=e}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Dt(this._baseHref,t)}path(t=!1){const e=this._platformLocation.pathname+Nt(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${e}${i}`:e}pushState(t,e,i,n){const s=this.prepareExternalUrl(i+Nt(n));this._platformLocation.pushState(t,e,s)}replaceState(t,e,i,n){const s=this.prepareExternalUrl(i+Nt(n));this._platformLocation.replaceState(t,e,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(xt),o.Vb(Ut,8))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})(),Jt=(()=>{class t extends Ft{constructor(t,e){super(),this._platformLocation=t,this._baseHref="",null!=e&&(this._baseHref=e)}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}path(t=!1){let e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}prepareExternalUrl(t){const e=Dt(this._baseHref,t);return e.length>0?"#"+e:e}pushState(t,e,i,n){let s=this.prepareExternalUrl(i+Nt(n));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.pushState(t,e,s)}replaceState(t,e,i,n){let s=this.prepareExternalUrl(i+Nt(n));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(xt),o.Vb(Ut,8))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})(),qt=(()=>{class t{constructor(t,e){this._subject=new o.o,this._urlChangeListeners=[],this._platformStrategy=t;const i=this._platformStrategy.getBaseHref();this._platformLocation=e,this._baseHref=Et($t(i)),this._platformStrategy.onPopState(t=>{this._subject.emit({url:this.path(!0),pop:!0,state:t.state,type:t.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,e=""){return this.path()==this.normalize(t+Nt(e))}normalize(e){return t.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,$t(e)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,e="",i=null){this._platformStrategy.pushState(i,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Nt(e)),i)}replaceState(t,e="",i=null){this._platformStrategy.replaceState(i,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Nt(e)),i)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(t=>{this._notifyUrlChangeListeners(t.url,t.state)}))}_notifyUrlChangeListeners(t="",e){this._urlChangeListeners.forEach(i=>i(t,e))}subscribe(t,e,i){return this._subject.subscribe({next:t,error:e,complete:i})}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(Ft),o.Vb(xt))},t.normalizeQueryParams=Nt,t.joinWithSlash=Dt,t.stripTrailingSlash=Et,t.\u0275prov=Object(o.Jb)({factory:Vt,token:t,providedIn:"root"}),t})();function Vt(){return new qt(Object(o.Vb)(Ft),Object(o.Vb)(xt))}function $t(t){return t.replace(/\/index.html$/,"")}var Gt=function(t){return t[t.Zero=0]="Zero",t[t.One=1]="One",t[t.Two=2]="Two",t[t.Few=3]="Few",t[t.Many=4]="Many",t[t.Other=5]="Other",t}({});const Ht=o.ob;class Yt{}let Wt=(()=>{class t extends Yt{constructor(t){super(),this.locale=t}getPluralCategory(t,e){switch(Ht(e||this.locale)(t)){case Gt.Zero:return"zero";case Gt.One:return"one";case Gt.Two:return"two";case Gt.Few:return"few";case Gt.Many:return"many";default:return"other"}}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(o.x))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})(),Kt=(()=>{class t{constructor(t,e,i,n){this._iterableDiffers=t,this._keyValueDiffers=e,this._ngEl=i,this._renderer=n,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&(Object(o.rb)(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachChangedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachRemovedItem(t=>{t.previousValue&&this._toggleClass(t.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(t=>{if("string"!=typeof t.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got "+Object(o.wb)(t.item));this._toggleClass(t.item,!0)}),t.forEachRemovedItem(t=>this._toggleClass(t.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!0)):Object.keys(t).forEach(e=>this._toggleClass(e,!!t[e])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!1)):Object.keys(t).forEach(t=>this._toggleClass(t,!1)))}_toggleClass(t,e){(t=t.trim())&&t.split(/\s+/g).forEach(t=>{e?this._renderer.addClass(this._ngEl.nativeElement,t):this._renderer.removeClass(this._ngEl.nativeElement,t)})}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.v),o.Nb(o.w),o.Nb(o.m),o.Nb(o.H))},t.\u0275dir=o.Ib({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),t})();class Xt{constructor(t,e,i,n){this.$implicit=t,this.ngForOf=e,this.index=i,this.count=n}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Zt=(()=>{class t{constructor(t,e,i){this._viewContainer=t,this._template=e,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const i=this._ngForOf;if(!this._differ&&i)try{this._differ=this._differs.find(i).create(this.ngForTrackBy)}catch(e){throw new Error(`Cannot find a differ supporting object '${i}' of type '${t=i,t.name||typeof t}'. NgFor only supports binding to Iterables such as Arrays.`)}}var t;if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const e=[];t.forEachOperation((t,i,n)=>{if(null==t.previousIndex){const i=this._viewContainer.createEmbeddedView(this._template,new Xt(null,this._ngForOf,-1,-1),null===n?void 0:n),s=new te(t,i);e.push(s)}else if(null==n)this._viewContainer.remove(null===i?void 0:i);else if(null!==i){const s=this._viewContainer.get(i);this._viewContainer.move(s,n);const a=new te(t,s);e.push(a)}});for(let i=0;i<e.length;i++)this._perViewChange(e[i].view,e[i].record);for(let i=0,n=this._viewContainer.length;i<n;i++){const t=this._viewContainer.get(i);t.context.index=i,t.context.count=n,t.context.ngForOf=this._ngForOf}t.forEachIdentityChange(t=>{this._viewContainer.get(t.currentIndex).context.$implicit=t.item})}_perViewChange(t,e){t.context.$implicit=e.item}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.S),o.Nb(o.O),o.Nb(o.v))},t.\u0275dir=o.Ib({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();class te{constructor(t,e){this.record=t,this.view=e}}let ee=(()=>{class t{constructor(t,e){this._viewContainer=t,this._context=new ie,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=e}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){ne("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){ne("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.S),o.Nb(o.O))},t.\u0275dir=o.Ib({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class ie{constructor(){this.$implicit=null,this.ngIf=null}}function ne(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${Object(o.wb)(e)}'.`)}let se=(()=>{class t{constructor(t,e,i){this._ngEl=t,this._differs=e,this._renderer=i,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,e){const[i,n]=t.split(".");null!=(e=null!=e&&n?`${e}${n}`:e)?this._renderer.setStyle(this._ngEl.nativeElement,i,e):this._renderer.removeStyle(this._ngEl.nativeElement,i)}_applyChanges(t){t.forEachRemovedItem(t=>this._setStyle(t.key,null)),t.forEachAddedItem(t=>this._setStyle(t.key,t.currentValue)),t.forEachChangedItem(t=>this._setStyle(t.key,t.currentValue))}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m),o.Nb(o.w),o.Nb(o.H))},t.\u0275dir=o.Ib({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),t})(),ae=(()=>{class t{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(t){if(this._shouldRecreateView(t)){const t=this._viewContainerRef;this._viewRef&&t.remove(t.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?t.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&this.ngTemplateOutletContext&&this._updateExistingContext(this.ngTemplateOutletContext)}_shouldRecreateView(t){const e=t.ngTemplateOutletContext;return!!t.ngTemplateOutlet||e&&this._hasContextShapeChanged(e)}_hasContextShapeChanged(t){const e=Object.keys(t.previousValue||{}),i=Object.keys(t.currentValue||{});if(e.length===i.length){for(let t of i)if(-1===e.indexOf(t))return!0;return!1}return!0}_updateExistingContext(t){for(let e of Object.keys(t))this._viewRef.context[e]=this.ngTemplateOutletContext[e]}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.S))},t.\u0275dir=o.Ib({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[o.zb]}),t})(),re=(()=>{class t{transform(t){return JSON.stringify(t,null,2)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Mb({name:"json",type:t,pure:!1}),t})(),oe=(()=>{class t{constructor(t){this.differs=t,this.keyValues=[]}transform(t,e=ce){if(!t||!(t instanceof Map)&&"object"!=typeof t)return null;this.differ||(this.differ=this.differs.find(t).create());const i=this.differ.diff(t);return i&&(this.keyValues=[],i.forEachItem(t=>{this.keyValues.push({key:t.key,value:t.currentValue})}),this.keyValues.sort(e)),this.keyValues}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.w))},t.\u0275pipe=o.Mb({name:"keyvalue",type:t,pure:!1}),t})();function ce(t,e){const i=t.key,n=e.key;if(i===n)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(null===i)return 1;if(null===n)return-1;if("string"==typeof i&&"string"==typeof n)return i<n?-1:1;if("number"==typeof i&&"number"==typeof n)return i-n;if("boolean"==typeof i&&"boolean"==typeof n)return i<n?-1:1;const s=String(i),a=String(n);return s==a?0:s<a?-1:1}let le=(()=>{class t{transform(e,i,n){if(null==e)return null;if(!this.supports(e))throw function(t,e){return Error(`InvalidPipeArgument: '${e}' for pipe '${Object(o.wb)(t)}'`)}(t,e);return e.slice(i,n)}supports(t){return"string"==typeof t||Array.isArray(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Mb({name:"slice",type:t,pure:!1}),t})(),ue=(()=>{class t{}return t.\u0275mod=o.Lb({type:t}),t.\u0275inj=o.Kb({factory:function(e){return new(e||t)},providers:[{provide:Yt,useClass:Wt}]}),t})(),de=(()=>{class t{}return t.\u0275prov=Object(o.Jb)({token:t,providedIn:"root",factory:()=>new he(Object(o.Vb)(Tt),window)}),t})();class he{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){var e;if(!this.supportsScrolling())return;const i=null!==(e=this.document.getElementById(t))&&void 0!==e?e:this.document.getElementsByName(t)[0];void 0!==i&&(this.scrollToElement(i),this.attemptFocus(i))}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),i=e.left+this.window.pageXOffset,n=e.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],n-s[1])}attemptFocus(t){return t.focus(),this.document.activeElement===t}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=be(this.window.history)||be(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch(t){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(t){return!1}}}function be(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}var me=i("Cfvw"),pe=i("z+Ro"),ge=i("yCtX"),fe=i("jZKg");function ve(...t){let e=t[t.length-1];return Object(pe.a)(e)?(t.pop(),Object(fe.a)(t,e)):Object(ge.a)(t)}var ye=i("XNiG"),_e=i("9ppp");class ke extends ye.a{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new _e.a;return this._value}next(t){super.next(this._value=t)}}var we=i("DH7j"),Se=i("7o/Q");class Ie extends Se.a{notifyNext(t,e,i,n,s){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}class Ce extends Se.a{constructor(t,e,i){super(),this.parent=t,this.outerValue=e,this.outerIndex=i,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}var Le=i("SeVD"),Re=i("HDdC");function Oe(t,e,i,n,s=new Ce(t,i,n)){if(!s.closed)return e instanceof Re.a?e.subscribe(s):Object(Le.a)(e)(s)}const Te={};class xe{constructor(t){this.resultSelector=t}call(t,e){return e.subscribe(new Be(t,this.resultSelector))}}class Be extends Ie{constructor(t,e){super(t),this.resultSelector=e,this.active=0,this.values=[],this.observables=[]}_next(t){this.values.push(Te),this.observables.push(t)}_complete(){const t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(let i=0;i<e;i++)this.add(Oe(this,t[i],void 0,i))}}notifyComplete(t){0==(this.active-=1)&&this.destination.complete()}notifyNext(t,e,i){const n=this.values,s=this.toRespond?n[i]===Te?--this.toRespond:this.toRespond:0;n[i]=e,0===s&&(this.resultSelector?this._tryResultSelector(n):this.destination.next(n.slice()))}_tryResultSelector(t){let e;try{e=this.resultSelector.apply(this,t)}catch(i){return void this.destination.error(i)}this.destination.next(e)}}const je=(()=>{function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t})();var Me=i("bHdf");function Qe(...t){return Object(Me.a)(1)(ve(...t))}const Ae=new Re.a(t=>t.complete());function De(t){return t?function(t){return new Re.a(e=>t.schedule(()=>e.complete()))}(t):Ae}function Ee(t){return new Re.a(e=>{let i;try{i=t()}catch(n){return void e.error(n)}return(i?Object(me.a)(i):De()).subscribe(e)})}var Ne=i("lJxs"),Fe=i("zx2A");function Pe(t,e){return"function"==typeof e?i=>i.pipe(Pe((i,n)=>Object(me.a)(t(i,n)).pipe(Object(Ne.a)((t,s)=>e(i,t,n,s))))):e=>e.lift(new Ue(t))}class Ue{constructor(t){this.project=t}call(t,e){return e.subscribe(new ze(t,this.project))}}class ze extends Fe.b{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const i=this.index++;try{e=this.project(t,i)}catch(n){return void this.destination.error(n)}this._innerSub(e)}_innerSub(t){const e=this.innerSubscription;e&&e.unsubscribe();const i=new Fe.a(this),n=this.destination;n.add(i),this.innerSubscription=Object(Fe.c)(t,i),this.innerSubscription!==i&&n.add(this.innerSubscription)}_complete(){const{innerSubscription:t}=this;t&&!t.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(t){this.destination.next(t)}}const Je=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})();function qe(t){return e=>0===t?De():e.lift(new Ve(t))}class Ve{constructor(t){if(this.total=t,this.total<0)throw new Je}call(t,e){return e.subscribe(new $e(t,this.total))}}class $e extends Se.a{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,i=++this.count;i<=e&&(this.destination.next(t),i===e&&(this.destination.complete(),this.unsubscribe()))}}function Ge(t,e){let i=!1;return arguments.length>=2&&(i=!0),function(n){return n.lift(new He(t,e,i))}}class He{constructor(t,e,i=!1){this.accumulator=t,this.seed=e,this.hasSeed=i}call(t,e){return e.subscribe(new Ye(t,this.accumulator,this.seed,this.hasSeed))}}class Ye extends Se.a{constructor(t,e,i,n){super(t),this.accumulator=e,this._seed=i,this.hasSeed=n,this.index=0}get seed(){return this._seed}set seed(t){this.hasSeed=!0,this._seed=t}_next(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}_tryNext(t){const e=this.index++;let i;try{i=this.accumulator(this.seed,t,e)}catch(n){this.destination.error(n)}this.seed=i,this.destination.next(i)}}function We(t,e){return function(i){return i.lift(new Ke(t,e))}}class Ke{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new Xe(t,this.predicate,this.thisArg))}}class Xe extends Se.a{constructor(t,e,i){super(t),this.predicate=e,this.thisArg=i,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(i){return void this.destination.error(i)}e&&this.destination.next(t)}}function Ze(t){return function(e){const i=new ti(t),n=e.lift(i);return i.caught=n}}class ti{constructor(t){this.selector=t}call(t,e){return e.subscribe(new ei(t,this.selector,this.caught))}}class ei extends Fe.b{constructor(t,e,i){super(t),this.selector=e,this.caught=i}error(t){if(!this.isStopped){let i;try{i=this.selector(t,this.caught)}catch(e){return void super.error(e)}this._unsubscribeAndRecycle();const n=new Fe.a(this);this.add(n);const s=Object(Fe.c)(i,n);s!==n&&this.add(s)}}}var ii=i("5+tZ");function ni(t,e){return Object(ii.a)(t,e,1)}function si(t){return function(e){return 0===t?De():e.lift(new ai(t))}}class ai{constructor(t){if(this.total=t,this.total<0)throw new Je}call(t,e){return e.subscribe(new ri(t,this.total))}}class ri extends Se.a{constructor(t,e){super(t),this.total=e,this.ring=new Array,this.count=0}_next(t){const e=this.ring,i=this.total,n=this.count++;e.length<i?e.push(t):e[n%i]=t}_complete(){const t=this.destination;let e=this.count;if(e>0){const i=this.count>=this.total?this.total:this.count,n=this.ring;for(let s=0;s<i;s++){const s=e++%i;t.next(n[s])}}t.complete()}}function oi(t=ui){return e=>e.lift(new ci(t))}class ci{constructor(t){this.errorFactory=t}call(t,e){return e.subscribe(new li(t,this.errorFactory))}}class li extends Se.a{constructor(t,e){super(t),this.errorFactory=e,this.hasValue=!1}_next(t){this.hasValue=!0,this.destination.next(t)}_complete(){if(this.hasValue)return this.destination.complete();{let e;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)}}}function ui(){return new je}function di(t=null){return e=>e.lift(new hi(t))}class hi{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new bi(t,this.defaultValue))}}class bi extends Se.a{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}var mi=i("SpAZ");function pi(t,e){const i=arguments.length>=2;return n=>n.pipe(t?We((e,i)=>t(e,i,n)):mi.a,qe(1),i?di(e):oi(()=>new je))}function gi(){}var fi=i("n6bG");function vi(t,e,i){return function(n){return n.lift(new yi(t,e,i))}}class yi{constructor(t,e,i){this.nextOrObserver=t,this.error=e,this.complete=i}call(t,e){return e.subscribe(new _i(t,this.nextOrObserver,this.error,this.complete))}}class _i extends Se.a{constructor(t,e,i,n){super(t),this._tapNext=gi,this._tapError=gi,this._tapComplete=gi,this._tapError=i||gi,this._tapComplete=n||gi,Object(fi.a)(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||gi,this._tapError=e.error||gi,this._tapComplete=e.complete||gi)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}var ki=i("quSY");class wi{constructor(t){this.callback=t}call(t,e){return e.subscribe(new Si(t,this.callback))}}class Si extends Se.a{constructor(t,e){super(t),this.add(new ki.a(e))}}class Ii{constructor(t,e){this.id=t,this.url=e}}class Ci extends Ii{constructor(t,e,i="imperative",n=null){super(t,e),this.navigationTrigger=i,this.restoredState=n}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Li extends Ii{constructor(t,e,i){super(t,e),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Ri extends Ii{constructor(t,e,i){super(t,e),this.reason=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Oi extends Ii{constructor(t,e,i){super(t,e),this.error=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Ti extends Ii{constructor(t,e,i,n){super(t,e),this.urlAfterRedirects=i,this.state=n}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class xi extends Ii{constructor(t,e,i,n){super(t,e),this.urlAfterRedirects=i,this.state=n}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Bi extends Ii{constructor(t,e,i,n,s){super(t,e),this.urlAfterRedirects=i,this.state=n,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class ji extends Ii{constructor(t,e,i,n){super(t,e),this.urlAfterRedirects=i,this.state=n}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Mi extends Ii{constructor(t,e,i,n){super(t,e),this.urlAfterRedirects=i,this.state=n}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Qi{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Ai{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Di{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ei{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ni{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Fi{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Pi{constructor(t,e,i){this.routerEvent=t,this.position=e,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Ui="primary";class zi{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function Ji(t){return new zi(t)}function qi(t){const e=Error("NavigationCancelingError: "+t);return e.ngNavigationCancelingError=!0,e}function Vi(t,e,i){const n=i.path.split("/");if(n.length>t.length)return null;if("full"===i.pathMatch&&(e.hasChildren()||n.length<t.length))return null;const s={};for(let a=0;a<n.length;a++){const e=n[a],i=t[a];if(e.startsWith(":"))s[e.substring(1)]=i;else if(e!==i.path)return null}return{consumed:t.slice(0,n.length),posParams:s}}function $i(t,e){const i=Object.keys(t),n=Object.keys(e);if(!i||!n||i.length!=n.length)return!1;let s;for(let a=0;a<i.length;a++)if(s=i[a],!Gi(t[s],e[s]))return!1;return!0}function Gi(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const i=[...t].sort(),n=[...e].sort();return i.every((t,e)=>n[e]===t)}return t===e}function Hi(t){return Array.prototype.concat.apply([],t)}function Yi(t){return t.length>0?t[t.length-1]:null}function Wi(t,e){for(const i in t)t.hasOwnProperty(i)&&e(t[i],i)}function Ki(t){return Object(o.sb)(t)?t:Object(o.tb)(t)?Object(me.a)(Promise.resolve(t)):ve(t)}function Xi(t,e,i){return i?function(t,e){return $i(t,e)}(t.queryParams,e.queryParams)&&Zi(t.root,e.root):function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(i=>Gi(t[i],e[i]))}(t.queryParams,e.queryParams)&&tn(t.root,e.root)}function Zi(t,e){if(!rn(t.segments,e.segments))return!1;if(t.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children){if(!t.children[i])return!1;if(!Zi(t.children[i],e.children[i]))return!1}return!0}function tn(t,e){return en(t,e,e.segments)}function en(t,e,i){if(t.segments.length>i.length)return!!rn(t.segments.slice(0,i.length),i)&&!e.hasChildren();if(t.segments.length===i.length){if(!rn(t.segments,i))return!1;for(const i in e.children){if(!t.children[i])return!1;if(!tn(t.children[i],e.children[i]))return!1}return!0}{const n=i.slice(0,t.segments.length),s=i.slice(t.segments.length);return!!rn(t.segments,n)&&!!t.children.primary&&en(t.children.primary,e,s)}}class nn{constructor(t,e,i){this.root=t,this.queryParams=e,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Ji(this.queryParams)),this._queryParamMap}toString(){return ln.serialize(this)}}class sn{constructor(t,e){this.segments=t,this.children=e,this.parent=null,Wi(e,(t,e)=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return un(this)}}class an{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=Ji(this.parameters)),this._parameterMap}toString(){return fn(this)}}function rn(t,e){return t.length===e.length&&t.every((t,i)=>t.path===e[i].path)}class on{}class cn{parse(t){const e=new wn(t);return new nn(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){return`${"/"+dn(t.root,!0)}${function(t){const e=Object.keys(t).map(e=>{const i=t[e];return Array.isArray(i)?i.map(t=>`${bn(e)}=${bn(t)}`).join("&"):`${bn(e)}=${bn(i)}`});return e.length?"?"+e.join("&"):""}(t.queryParams)}${"string"==typeof t.fragment?"#"+encodeURI(t.fragment):""}`}}const ln=new cn;function un(t){return t.segments.map(t=>fn(t)).join("/")}function dn(t,e){if(!t.hasChildren())return un(t);if(e){const e=t.children.primary?dn(t.children.primary,!1):"",i=[];return Wi(t.children,(t,e)=>{e!==Ui&&i.push(`${e}:${dn(t,!1)}`)}),i.length>0?`${e}(${i.join("//")})`:e}{const e=function(t,e){let i=[];return Wi(t.children,(t,n)=>{n===Ui&&(i=i.concat(e(t,n)))}),Wi(t.children,(t,n)=>{n!==Ui&&(i=i.concat(e(t,n)))}),i}(t,(e,i)=>i===Ui?[dn(t.children.primary,!1)]:[`${i}:${dn(e,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children.primary?`${un(t)}/${e[0]}`:`${un(t)}/(${e.join("//")})`}}function hn(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function bn(t){return hn(t).replace(/%3B/gi,";")}function mn(t){return hn(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function pn(t){return decodeURIComponent(t)}function gn(t){return pn(t.replace(/\+/g,"%20"))}function fn(t){return`${mn(t.path)}${e=t.parameters,Object.keys(e).map(t=>`;${mn(t)}=${mn(e[t])}`).join("")}`;var e}const vn=/^[^\/()?;=#]+/;function yn(t){const e=t.match(vn);return e?e[0]:""}const _n=/^[^=?&#]+/,kn=/^[^?&#]+/;class wn{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new sn([],{}):new sn([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(i.primary=new sn(t,e)),i}parseSegment(){const t=yn(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new an(pn(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=yn(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const t=yn(this.remaining);t&&(i=t,this.capture(i))}t[pn(e)]=pn(i)}parseQueryParam(t){const e=function(t){const e=t.match(_n);return e?e[0]:""}(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const t=function(t){const e=t.match(kn);return e?e[0]:""}(this.remaining);t&&(i=t,this.capture(i))}const n=gn(e),s=gn(i);if(t.hasOwnProperty(n)){let e=t[n];Array.isArray(e)||(e=[e],t[n]=e),e.push(s)}else t[n]=s}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=yn(this.remaining),n=this.remaining[i.length];if("/"!==n&&")"!==n&&";"!==n)throw new Error(`Cannot parse url '${this.url}'`);let s=void 0;i.indexOf(":")>-1?(s=i.substr(0,i.indexOf(":")),this.capture(s),this.capture(":")):t&&(s=Ui);const a=this.parseChildren();e[s]=1===Object.keys(a).length?a.primary:new sn([],a),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class Sn{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=In(t,this._root);return e?e.children.map(t=>t.value):[]}firstChild(t){const e=In(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=Cn(t,this._root);return e.length<2?[]:e[e.length-2].children.map(t=>t.value).filter(e=>e!==t)}pathFromRoot(t){return Cn(t,this._root).map(t=>t.value)}}function In(t,e){if(t===e.value)return e;for(const i of e.children){const e=In(t,i);if(e)return e}return null}function Cn(t,e){if(t===e.value)return[e];for(const i of e.children){const n=Cn(t,i);if(n.length)return n.unshift(e),n}return[]}class Ln{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function Rn(t){const e={};return t&&t.children.forEach(t=>e[t.value.outlet]=t),e}class On extends Sn{constructor(t,e){super(t),this.snapshot=e,Qn(this,t)}toString(){return this.snapshot.toString()}}function Tn(t,e){const i=function(t,e){const i=new jn([],{},{},"",{},Ui,e,null,t.root,-1,{});return new Mn("",new Ln(i,[]))}(t,e),n=new ke([new an("",{})]),s=new ke({}),a=new ke({}),r=new ke({}),o=new ke(""),c=new xn(n,s,r,o,a,Ui,e,i.root);return c.snapshot=i.root,new On(new Ln(c,[]),i)}class xn{constructor(t,e,i,n,s,a,r,o){this.url=t,this.params=e,this.queryParams=i,this.fragment=n,this.data=s,this.outlet=a,this.component=r,this._futureSnapshot=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Object(Ne.a)(t=>Ji(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Object(Ne.a)(t=>Ji(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Bn(t,e="emptyOnly"){const i=t.pathFromRoot;let n=0;if("always"!==e)for(n=i.length-1;n>=1;){const t=i[n],e=i[n-1];if(t.routeConfig&&""===t.routeConfig.path)n--;else{if(e.component)break;n--}}return function(t){return t.reduce((t,e)=>({params:Object.assign(Object.assign({},t.params),e.params),data:Object.assign(Object.assign({},t.data),e.data),resolve:Object.assign(Object.assign({},t.resolve),e._resolvedData)}),{params:{},data:{},resolve:{}})}(i.slice(n))}class jn{constructor(t,e,i,n,s,a,r,o,c,l,u){this.url=t,this.params=e,this.queryParams=i,this.fragment=n,this.data=s,this.outlet=a,this.component=r,this.routeConfig=o,this._urlSegment=c,this._lastPathIndex=l,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Ji(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Ji(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(t=>t.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Mn extends Sn{constructor(t,e){super(e),this.url=t,Qn(this,e)}toString(){return An(this._root)}}function Qn(t,e){e.value._routerState=t,e.children.forEach(e=>Qn(t,e))}function An(t){const e=t.children.length>0?` { ${t.children.map(An).join(", ")} } `:"";return`${t.value}${e}`}function Dn(t){if(t.snapshot){const e=t.snapshot,i=t._futureSnapshot;t.snapshot=i,$i(e.queryParams,i.queryParams)||t.queryParams.next(i.queryParams),e.fragment!==i.fragment&&t.fragment.next(i.fragment),$i(e.params,i.params)||t.params.next(i.params),function(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!$i(t[i],e[i]))return!1;return!0}(e.url,i.url)||t.url.next(i.url),$i(e.data,i.data)||t.data.next(i.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function En(t,e){var i,n;return $i(t.params,e.params)&&rn(i=t.url,n=e.url)&&i.every((t,e)=>$i(t.parameters,n[e].parameters))&&!(!t.parent!=!e.parent)&&(!t.parent||En(t.parent,e.parent))}function Nn(t,e,i){if(i&&t.shouldReuseRoute(e.value,i.value.snapshot)){const n=i.value;n._futureSnapshot=e.value;const s=function(t,e,i){return e.children.map(e=>{for(const n of i.children)if(t.shouldReuseRoute(e.value,n.value.snapshot))return Nn(t,e,n);return Nn(t,e)})}(t,e,i);return new Ln(n,s)}{const i=t.retrieve(e.value);if(i){const t=i.route;return Fn(e,t),t}{const i=new xn(new ke((n=e.value).url),new ke(n.params),new ke(n.queryParams),new ke(n.fragment),new ke(n.data),n.outlet,n.component,n),s=e.children.map(e=>Nn(t,e));return new Ln(i,s)}}var n}function Fn(t,e){if(t.value.routeConfig!==e.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(t.children.length!==e.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");e.value._futureSnapshot=t.value;for(let i=0;i<t.children.length;++i)Fn(t.children[i],e.children[i])}function Pn(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function Un(t){return"object"==typeof t&&null!=t&&t.outlets}function zn(t,e,i,n,s){let a={};return n&&Wi(n,(t,e)=>{a[e]=Array.isArray(t)?t.map(t=>""+t):""+t}),new nn(i.root===t?e:Jn(i.root,t,e),a,s)}function Jn(t,e,i){const n={};return Wi(t.children,(t,s)=>{n[s]=t===e?i:Jn(t,e,i)}),new sn(t.segments,n)}class qn{constructor(t,e,i){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=i,t&&i.length>0&&Pn(i[0]))throw new Error("Root segment cannot have matrix parameters");const n=i.find(Un);if(n&&n!==Yi(i))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Vn{constructor(t,e,i){this.segmentGroup=t,this.processChildren=e,this.index=i}}function $n(t,e,i){if(t||(t=new sn([],{})),0===t.segments.length&&t.hasChildren())return Gn(t,e,i);const n=function(t,e,i){let n=0,s=e;const a={match:!1,pathIndex:0,commandIndex:0};for(;s<t.segments.length;){if(n>=i.length)return a;const e=t.segments[s],r=i[n];if(Un(r))break;const o=""+r,c=n<i.length-1?i[n+1]:null;if(s>0&&void 0===o)break;if(o&&c&&"object"==typeof c&&void 0===c.outlets){if(!Kn(o,c,e))return a;n+=2}else{if(!Kn(o,{},e))return a;n++}s++}return{match:!0,pathIndex:s,commandIndex:n}}(t,e,i),s=i.slice(n.commandIndex);if(n.match&&n.pathIndex<t.segments.length){const e=new sn(t.segments.slice(0,n.pathIndex),{});return e.children.primary=new sn(t.segments.slice(n.pathIndex),t.children),Gn(e,0,s)}return n.match&&0===s.length?new sn(t.segments,{}):n.match&&!t.hasChildren()?Hn(t,e,i):n.match?Gn(t,0,s):Hn(t,e,i)}function Gn(t,e,i){if(0===i.length)return new sn(t.segments,{});{const n=function(t){return Un(t[0])?t[0].outlets:{[Ui]:t}}(i),s={};return Wi(n,(i,n)=>{"string"==typeof i&&(i=[i]),null!==i&&(s[n]=$n(t.children[n],e,i))}),Wi(t.children,(t,e)=>{void 0===n[e]&&(s[e]=t)}),new sn(t.segments,s)}}function Hn(t,e,i){const n=t.segments.slice(0,e);let s=0;for(;s<i.length;){const a=i[s];if(Un(a)){const t=Yn(a.outlets);return new sn(n,t)}if(0===s&&Pn(i[0])){n.push(new an(t.segments[e].path,i[0])),s++;continue}const r=Un(a)?a.outlets.primary:""+a,o=s<i.length-1?i[s+1]:null;r&&o&&Pn(o)?(n.push(new an(r,Wn(o))),s+=2):(n.push(new an(r,{})),s++)}return new sn(n,{})}function Yn(t){const e={};return Wi(t,(t,i)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[i]=Hn(new sn([],{}),0,t))}),e}function Wn(t){const e={};return Wi(t,(t,i)=>e[i]=""+t),e}function Kn(t,e,i){return t==i.path&&$i(e,i.parameters)}class Xn{constructor(t,e,i,n){this.routeReuseStrategy=t,this.futureState=e,this.currState=i,this.forwardEvent=n}activate(t){const e=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,i,t),Dn(this.futureState.root),this.activateChildRoutes(e,i,t)}deactivateChildRoutes(t,e,i){const n=Rn(e);t.children.forEach(t=>{const e=t.value.outlet;this.deactivateRoutes(t,n[e],i),delete n[e]}),Wi(n,(t,e)=>{this.deactivateRouteAndItsChildren(t,i)})}deactivateRoutes(t,e,i){const n=t.value,s=e?e.value:null;if(n===s)if(n.component){const s=i.getContext(n.outlet);s&&this.deactivateChildRoutes(t,e,s.children)}else this.deactivateChildRoutes(t,e,i);else s&&this.deactivateRouteAndItsChildren(e,i)}deactivateRouteAndItsChildren(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const i=e.getContext(t.value.outlet);if(i&&i.outlet){const e=i.outlet.detach(),n=i.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:e,route:t,contexts:n})}}deactivateRouteAndOutlet(t,e){const i=e.getContext(t.value.outlet),n=i&&t.value.component?i.children:e,s=Rn(t);for(const a of Object.keys(s))this.deactivateRouteAndItsChildren(s[a],n);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated())}activateChildRoutes(t,e,i){const n=Rn(e);t.children.forEach(t=>{this.activateRoutes(t,n[t.value.outlet],i),this.forwardEvent(new Fi(t.value.snapshot))}),t.children.length&&this.forwardEvent(new Ei(t.value.snapshot))}activateRoutes(t,e,i){const n=t.value,s=e?e.value:null;if(Dn(n),n===s)if(n.component){const s=i.getOrCreateContext(n.outlet);this.activateChildRoutes(t,e,s.children)}else this.activateChildRoutes(t,e,i);else if(n.component){const e=i.getOrCreateContext(n.outlet);if(this.routeReuseStrategy.shouldAttach(n.snapshot)){const t=this.routeReuseStrategy.retrieve(n.snapshot);this.routeReuseStrategy.store(n.snapshot,null),e.children.onOutletReAttached(t.contexts),e.attachRef=t.componentRef,e.route=t.route.value,e.outlet&&e.outlet.attach(t.componentRef,t.route.value),Zn(t.route)}else{const i=function(t){for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(n.snapshot),s=i?i.module.componentFactoryResolver:null;e.attachRef=null,e.route=n,e.resolver=s,e.outlet&&e.outlet.activateWith(n,s),this.activateChildRoutes(t,null,e.children)}}else this.activateChildRoutes(t,null,i)}}function Zn(t){Dn(t.value),t.children.forEach(Zn)}class ts{constructor(t,e){this.routes=t,this.module=e}}function es(t){return"function"==typeof t}function is(t){return t instanceof nn}const ns=Symbol("INITIAL_VALUE");function ss(){return Pe(t=>function(...t){let e=void 0,i=void 0;return Object(pe.a)(t[t.length-1])&&(i=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&Object(we.a)(t[0])&&(t=t[0]),Object(ge.a)(t,i).lift(new xe(e))}(t.map(t=>t.pipe(qe(1),function(...t){const e=t[t.length-1];return Object(pe.a)(e)?(t.pop(),i=>Qe(t,i,e)):e=>Qe(t,e)}(ns)))).pipe(Ge((t,e)=>{let i=!1;return e.reduce((t,n,s)=>{if(t!==ns)return t;if(n===ns&&(i=!0),!i){if(!1===n)return n;if(s===e.length-1||is(n))return n}return t},t)},ns),We(t=>t!==ns),Object(Ne.a)(t=>is(t)?t:!0===t),qe(1)))}let as=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Hb({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&o.Ob(0,"router-outlet")},directives:function(){return[ta]},encapsulation:2}),t})();function rs(t,e=""){for(let i=0;i<t.length;i++){const n=t[i];os(n,cs(e,n))}}function os(t,e){t.children&&rs(t.children,e)}function cs(t,e){return e?t||e.path?t&&!e.path?t+"/":!t&&e.path?e.path:`${t}/${e.path}`:"":t}function ls(t){const e=t.children&&t.children.map(ls),i=e?Object.assign(Object.assign({},t),{children:e}):Object.assign({},t);return!i.component&&(e||i.loadChildren)&&i.outlet&&i.outlet!==Ui&&(i.component=as),i}function us(t){return t.outlet||Ui}function ds(t,e){const i=t.filter(t=>us(t)===e);return i.push(...t.filter(t=>us(t)!==e)),i}const hs={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function bs(t,e,i){var n;if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||i.length>0)?Object.assign({},hs):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const s=(e.matcher||Vi)(i,t,e);if(!s)return Object.assign({},hs);const a={};Wi(s.posParams,(t,e)=>{a[e]=t.path});const r=s.consumed.length>0?Object.assign(Object.assign({},a),s.consumed[s.consumed.length-1].parameters):a;return{matched:!0,consumedSegments:s.consumed,lastChild:s.consumed.length,parameters:r,positionalParamSegments:null!==(n=s.posParams)&&void 0!==n?n:{}}}function ms(t,e,i,n,s="corrected"){if(i.length>0&&function(t,e,i){return i.some(i=>ps(t,e,i)&&us(i)!==Ui)}(t,i,n)){const s=new sn(e,function(t,e,i,n){const s={};s.primary=n,n._sourceSegment=t,n._segmentIndexShift=e.length;for(const a of i)if(""===a.path&&us(a)!==Ui){const i=new sn([],{});i._sourceSegment=t,i._segmentIndexShift=e.length,s[us(a)]=i}return s}(t,e,n,new sn(i,t.children)));return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:[]}}if(0===i.length&&function(t,e,i){return i.some(i=>ps(t,e,i))}(t,i,n)){const a=new sn(t.segments,function(t,e,i,n,s,a){const r={};for(const o of n)if(ps(t,i,o)&&!s[us(o)]){const i=new sn([],{});i._sourceSegment=t,i._segmentIndexShift="legacy"===a?t.segments.length:e.length,r[us(o)]=i}return Object.assign(Object.assign({},s),r)}(t,e,i,n,t.children,s));return a._sourceSegment=t,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:i}}const a=new sn(t.segments,t.children);return a._sourceSegment=t,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:i}}function ps(t,e,i){return(!(t.hasChildren()||e.length>0)||"full"!==i.pathMatch)&&""===i.path}function gs(t,e,i,n){return!!(us(t)===n||n!==Ui&&ps(e,i,t))&&("**"===t.path||bs(e,t,i).matched)}function fs(t,e,i){return 0===e.length&&!t.children[i]}class vs{constructor(t){this.segmentGroup=t||null}}class ys{constructor(t){this.urlTree=t}}function _s(t){return new Re.a(e=>e.error(new vs(t)))}function ks(t){return new Re.a(e=>e.error(new ys(t)))}function ws(t){return new Re.a(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class Ss{constructor(t,e,i,n,s){this.configLoader=e,this.urlSerializer=i,this.urlTree=n,this.config=s,this.allowRedirects=!0,this.ngModule=t.get(o.B)}apply(){const t=ms(this.urlTree.root,[],[],this.config).segmentGroup,e=new sn(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,e,Ui).pipe(Object(Ne.a)(t=>this.createUrlTree(Is(t),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Ze(t=>{if(t instanceof ys)return this.allowRedirects=!1,this.match(t.urlTree);if(t instanceof vs)throw this.noMatchError(t);throw t}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,Ui).pipe(Object(Ne.a)(e=>this.createUrlTree(Is(e),t.queryParams,t.fragment))).pipe(Ze(t=>{if(t instanceof vs)throw this.noMatchError(t);throw t}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,i){const n=t.segments.length>0?new sn([],{[Ui]:t}):t;return new nn(n,e,i)}expandSegmentGroup(t,e,i,n){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(t,e,i).pipe(Object(Ne.a)(t=>new sn([],t))):this.expandSegment(t,i,e,i.segments,n,!0)}expandChildren(t,e,i){const n=[];for(const s of Object.keys(i.children))"primary"===s?n.unshift(s):n.push(s);return Object(me.a)(n).pipe(ni(n=>{const s=i.children[n],a=ds(e,n);return this.expandSegmentGroup(t,a,s,n).pipe(Object(Ne.a)(t=>({segment:t,outlet:n})))}),Ge((t,e)=>(t[e.outlet]=e.segment,t),{}),function(t,e){const i=arguments.length>=2;return n=>n.pipe(t?We((e,i)=>t(e,i,n)):mi.a,si(1),i?di(e):oi(()=>new je))}())}expandSegment(t,e,i,n,s,a){return Object(me.a)(i).pipe(ni(r=>this.expandSegmentAgainstRoute(t,e,i,r,n,s,a).pipe(Ze(t=>{if(t instanceof vs)return ve(null);throw t}))),pi(t=>!!t),Ze((t,i)=>{if(t instanceof je||"EmptyError"===t.name){if(fs(e,n,s))return ve(new sn([],{}));throw new vs(e)}throw t}))}expandSegmentAgainstRoute(t,e,i,n,s,a,r){return gs(n,e,s,a)?void 0===n.redirectTo?this.matchSegmentAgainstRoute(t,e,n,s,a):r&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,i,n,s,a):_s(e):_s(e)}expandSegmentAgainstRouteUsingRedirect(t,e,i,n,s,a){return"**"===n.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,i,n,a):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,i,n,s,a)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,i,n){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?ks(s):this.lineralizeSegments(i,s).pipe(Object(ii.a)(i=>{const s=new sn(i,{});return this.expandSegment(t,s,e,i,n,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,i,n,s,a){const{matched:r,consumedSegments:o,lastChild:c,positionalParamSegments:l}=bs(e,n,s);if(!r)return _s(e);const u=this.applyRedirectCommands(o,n.redirectTo,l);return n.redirectTo.startsWith("/")?ks(u):this.lineralizeSegments(n,u).pipe(Object(ii.a)(n=>this.expandSegment(t,e,i,n.concat(s.slice(c)),a,!1)))}matchSegmentAgainstRoute(t,e,i,n,s){if("**"===i.path)return i.loadChildren?this.configLoader.load(t.injector,i).pipe(Object(Ne.a)(t=>(i._loadedConfig=t,new sn(n,{})))):ve(new sn(n,{}));const{matched:a,consumedSegments:r,lastChild:o}=bs(e,i,n);if(!a)return _s(e);const c=n.slice(o);return this.getChildConfig(t,i,n).pipe(Object(ii.a)(t=>{const n=t.module,a=t.routes,{segmentGroup:o,slicedSegments:l}=ms(e,r,c,a),u=new sn(o.segments,o.children);if(0===l.length&&u.hasChildren())return this.expandChildren(n,a,u).pipe(Object(Ne.a)(t=>new sn(r,t)));if(0===a.length&&0===l.length)return ve(new sn(r,{}));const d=us(i)===s;return this.expandSegment(n,u,a,l,d?Ui:s,!0).pipe(Object(Ne.a)(t=>new sn(r.concat(t.segments),t.children)))}))}getChildConfig(t,e,i){return e.children?ve(new ts(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?ve(e._loadedConfig):this.runCanLoadGuards(t.injector,e,i).pipe(Object(ii.a)(i=>i?this.configLoader.load(t.injector,e).pipe(Object(Ne.a)(t=>(e._loadedConfig=t,t))):function(t){return new Re.a(e=>e.error(qi(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(e))):ve(new ts([],t))}runCanLoadGuards(t,e,i){const n=e.canLoad;return n&&0!==n.length?ve(n.map(n=>{const s=t.get(n);let a;if(function(t){return t&&es(t.canLoad)}(s))a=s.canLoad(e,i);else{if(!es(s))throw new Error("Invalid CanLoad guard");a=s(e,i)}return Ki(a)})).pipe(ss(),vi(t=>{if(!is(t))return;const e=qi(`Redirecting to "${this.urlSerializer.serialize(t)}"`);throw e.url=t,e}),Object(Ne.a)(t=>!0===t)):ve(!0)}lineralizeSegments(t,e){let i=[],n=e.root;for(;;){if(i=i.concat(n.segments),0===n.numberOfChildren)return ve(i);if(n.numberOfChildren>1||!n.children.primary)return ws(t.redirectTo);n=n.children.primary}}applyRedirectCommands(t,e,i){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,i)}applyRedirectCreatreUrlTree(t,e,i,n){const s=this.createSegmentGroup(t,e.root,i,n);return new nn(s,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const i={};return Wi(t,(t,n)=>{if("string"==typeof t&&t.startsWith(":")){const s=t.substring(1);i[n]=e[s]}else i[n]=t}),i}createSegmentGroup(t,e,i,n){const s=this.createSegments(t,e.segments,i,n);let a={};return Wi(e.children,(e,s)=>{a[s]=this.createSegmentGroup(t,e,i,n)}),new sn(s,a)}createSegments(t,e,i,n){return e.map(e=>e.path.startsWith(":")?this.findPosParam(t,e,n):this.findOrReturn(e,i))}findPosParam(t,e,i){const n=i[e.path.substring(1)];if(!n)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return n}findOrReturn(t,e){let i=0;for(const n of e){if(n.path===t.path)return e.splice(i),n;i++}return t}}function Is(t){const e={};for(const i of Object.keys(t.children)){const n=Is(t.children[i]);(n.segments.length>0||n.hasChildren())&&(e[i]=n)}return function(t){if(1===t.numberOfChildren&&t.children.primary){const e=t.children.primary;return new sn(t.segments.concat(e.segments),e.children)}return t}(new sn(t.segments,e))}class Cs{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Ls{constructor(t,e){this.component=t,this.route=e}}function Rs(t,e,i){const n=t._root;return Ts(n,e?e._root:null,i,[n.value])}function Os(t,e,i){const n=function(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(n?n.module.injector:i).get(t)}function Ts(t,e,i,n,s={canDeactivateChecks:[],canActivateChecks:[]}){const a=Rn(e);return t.children.forEach(t=>{!function(t,e,i,n,s={canDeactivateChecks:[],canActivateChecks:[]}){const a=t.value,r=e?e.value:null,o=i?i.getContext(t.value.outlet):null;if(r&&a.routeConfig===r.routeConfig){const c=function(t,e,i){if("function"==typeof i)return i(t,e);switch(i){case"pathParamsChange":return!rn(t.url,e.url);case"pathParamsOrQueryParamsChange":return!rn(t.url,e.url)||!$i(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!En(t,e)||!$i(t.queryParams,e.queryParams);case"paramsChange":default:return!En(t,e)}}(r,a,a.routeConfig.runGuardsAndResolvers);c?s.canActivateChecks.push(new Cs(n)):(a.data=r.data,a._resolvedData=r._resolvedData),Ts(t,e,a.component?o?o.children:null:i,n,s),c&&o&&o.outlet&&o.outlet.isActivated&&s.canDeactivateChecks.push(new Ls(o.outlet.component,r))}else r&&xs(e,o,s),s.canActivateChecks.push(new Cs(n)),Ts(t,null,a.component?o?o.children:null:i,n,s)}(t,a[t.value.outlet],i,n.concat([t.value]),s),delete a[t.value.outlet]}),Wi(a,(t,e)=>xs(t,i.getContext(e),s)),s}function xs(t,e,i){const n=Rn(t),s=t.value;Wi(n,(t,n)=>{xs(t,s.component?e?e.children.getContext(n):null:e,i)}),i.canDeactivateChecks.push(new Ls(s.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,s))}class Bs{}function js(t){return new Re.a(e=>e.error(t))}class Ms{constructor(t,e,i,n,s,a){this.rootComponentType=t,this.config=e,this.urlTree=i,this.url=n,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=a}recognize(){const t=ms(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo),this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,Ui);if(null===e)return null;const i=new jn([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Ui,this.rootComponentType,null,this.urlTree.root,-1,{}),n=new Ln(i,e),s=new Mn(this.url,n);return this.inheritParamsAndData(s._root),s}inheritParamsAndData(t){const e=t.value,i=Bn(e,this.paramsInheritanceStrategy);e.params=Object.freeze(i.params),e.data=Object.freeze(i.data),t.children.forEach(t=>this.inheritParamsAndData(t))}processSegmentGroup(t,e,i){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,i)}processChildren(t,e){const i=[];for(const s of Object.keys(e.children)){const n=e.children[s],a=ds(t,s),r=this.processSegmentGroup(a,n,s);if(null===r)return null;i.push(...r)}const n=function(t){const e=[];for(const i of t){if(!Qs(i)){e.push(i);continue}const t=e.find(t=>i.value.routeConfig===t.value.routeConfig);void 0!==t?t.children.push(...i.children):e.push(i)}return e}(i);return n.sort((t,e)=>t.value.outlet===Ui?-1:e.value.outlet===Ui?1:t.value.outlet.localeCompare(e.value.outlet)),n}processSegment(t,e,i,n){for(const s of t){const t=this.processSegmentAgainstRoute(s,e,i,n);if(null!==t)return t}return fs(e,i,n)?[]:null}processSegmentAgainstRoute(t,e,i,n){if(t.redirectTo||!gs(t,e,i,n))return null;let s,a=[],r=[];if("**"===t.path){const n=i.length>0?Yi(i).parameters:{};s=new jn(i,n,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Es(t),us(t),t.component,t,As(e),Ds(e)+i.length,Ns(t))}else{const n=bs(e,t,i);if(!n.matched)return null;a=n.consumedSegments,r=i.slice(n.lastChild),s=new jn(a,n.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Es(t),us(t),t.component,t,As(e),Ds(e)+a.length,Ns(t))}const o=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(t),{segmentGroup:c,slicedSegments:l}=ms(e,a,r,o.filter(t=>void 0===t.redirectTo),this.relativeLinkResolution);if(0===l.length&&c.hasChildren()){const t=this.processChildren(o,c);return null===t?null:[new Ln(s,t)]}if(0===o.length&&0===l.length)return[new Ln(s,[])];const u=us(t)===n,d=this.processSegment(o,c,l,u?Ui:n);return null===d?null:[new Ln(s,d)]}}function Qs(t){const e=t.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function As(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function Ds(t){let e=t,i=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,i+=e._segmentIndexShift?e._segmentIndexShift:0;return i-1}function Es(t){return t.data||{}}function Ns(t){return t.resolve||{}}function Fs(t){return Pe(e=>{const i=t(e);return i?Object(me.a)(i).pipe(Object(Ne.a)(()=>e)):ve(e)})}class Ps extends class{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const Us=new o.s("ROUTES");class zs{constructor(t,e,i,n){this.loader=t,this.compiler=e,this.onLoadStartListener=i,this.onLoadEndListener=n}load(t,e){return this.onLoadStartListener&&this.onLoadStartListener(e),this.loadModuleFactory(e.loadChildren).pipe(Object(Ne.a)(i=>{this.onLoadEndListener&&this.onLoadEndListener(e);const n=i.create(t);return new ts(Hi(n.injector.get(Us)).map(ls),n)}))}loadModuleFactory(t){return"string"==typeof t?Object(me.a)(this.loader.load(t)):Ki(t()).pipe(Object(ii.a)(t=>t instanceof o.z?ve(t):Object(me.a)(this.compiler.compileModuleAsync(t))))}}class Js{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new qs,this.attachRef=null}}class qs{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const i=this.getOrCreateContext(t);i.outlet=e,this.contexts.set(t,i)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new Js,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}class Vs{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function $s(t){throw t}function Gs(t,e,i){return e.parse("/")}function Hs(t,e){return ve(null)}let Ys=(()=>{class t{constructor(t,e,i,n,s,a,r,c){this.rootComponentType=t,this.urlSerializer=e,this.rootContexts=i,this.location=n,this.config=c,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.lastLocationChangeInfo=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new ye.a,this.errorHandler=$s,this.malformedUriErrorHandler=Gs,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:Hs,afterPreactivation:Hs},this.urlHandlingStrategy=new Vs,this.routeReuseStrategy=new Ps,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.ngModule=s.get(o.B),this.console=s.get(o.ab);const l=s.get(o.D);this.isNgZoneEnabled=l instanceof o.D&&o.D.isInAngularZone(),this.resetConfig(c),this.currentUrlTree=new nn(new sn([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new zs(a,r,t=>this.triggerEvent(new Qi(t)),t=>this.triggerEvent(new Ai(t))),this.routerState=Tn(this.currentUrlTree,this.rootComponentType),this.transitions=new ke({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(t){const e=this.events;return t.pipe(We(t=>0!==t.id),Object(Ne.a)(t=>Object.assign(Object.assign({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl)})),Pe(t=>{let i=!1,n=!1;return ve(t).pipe(vi(t=>{this.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Pe(t=>{const i=!this.navigated||t.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||i)&&this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return ve(t).pipe(Pe(t=>{const i=this.transitions.getValue();return e.next(new Ci(t.id,this.serializeUrl(t.extractedUrl),t.source,t.restoredState)),i!==this.transitions.getValue()?Ae:Promise.resolve(t)}),(n=this.ngModule.injector,s=this.configLoader,a=this.urlSerializer,r=this.config,Pe(t=>function(t,e,i,n,s){return new Ss(t,e,i,n,s).apply()}(n,s,a,t.extractedUrl,r).pipe(Object(Ne.a)(e=>Object.assign(Object.assign({},t),{urlAfterRedirects:e}))))),vi(t=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:t.urlAfterRedirects})}),function(t,e,i,n,s){return Object(ii.a)(a=>function(t,e,i,n,s="emptyOnly",a="legacy"){try{const r=new Ms(t,e,i,n,s,a).recognize();return null===r?js(new Bs):ve(r)}catch(r){return js(r)}}(t,e,a.urlAfterRedirects,i(a.urlAfterRedirects),n,s).pipe(Object(Ne.a)(t=>Object.assign(Object.assign({},a),{targetSnapshot:t}))))}(this.rootComponentType,this.config,t=>this.serializeUrl(t),this.paramsInheritanceStrategy,this.relativeLinkResolution),vi(t=>{"eager"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(t.urlAfterRedirects,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects);const i=new Ti(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.next(i)}));var n,s,a,r;if(i&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:i,extractedUrl:n,source:s,restoredState:a,extras:r}=t,o=new Ci(i,this.serializeUrl(n),s,a);e.next(o);const c=Tn(n,this.rootComponentType).snapshot;return ve(Object.assign(Object.assign({},t),{targetSnapshot:c,urlAfterRedirects:n,extras:Object.assign(Object.assign({},r),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=t.rawUrl,this.browserUrlTree=t.urlAfterRedirects,t.resolve(null),Ae}),Fs(t=>{const{targetSnapshot:e,id:i,extractedUrl:n,rawUrl:s,extras:{skipLocationChange:a,replaceUrl:r}}=t;return this.hooks.beforePreactivation(e,{navigationId:i,appliedUrlTree:n,rawUrlTree:s,skipLocationChange:!!a,replaceUrl:!!r})}),vi(t=>{const e=new xi(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),Object(Ne.a)(t=>Object.assign(Object.assign({},t),{guards:Rs(t.targetSnapshot,t.currentSnapshot,this.rootContexts)})),function(t,e){return Object(ii.a)(i=>{const{targetSnapshot:n,currentSnapshot:s,guards:{canActivateChecks:a,canDeactivateChecks:r}}=i;return 0===r.length&&0===a.length?ve(Object.assign(Object.assign({},i),{guardsResult:!0})):function(t,e,i,n){return Object(me.a)(t).pipe(Object(ii.a)(t=>function(t,e,i,n,s){const a=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return a&&0!==a.length?ve(a.map(a=>{const r=Os(a,e,s);let o;if(function(t){return t&&es(t.canDeactivate)}(r))o=Ki(r.canDeactivate(t,e,i,n));else{if(!es(r))throw new Error("Invalid CanDeactivate guard");o=Ki(r(t,e,i,n))}return o.pipe(pi())})).pipe(ss()):ve(!0)}(t.component,t.route,i,e,n)),pi(t=>!0!==t,!0))}(r,n,s,t).pipe(Object(ii.a)(i=>i&&"boolean"==typeof i?function(t,e,i,n){return Object(me.a)(e).pipe(ni(e=>Qe(function(t,e){return null!==t&&e&&e(new Di(t)),ve(!0)}(e.route.parent,n),function(t,e){return null!==t&&e&&e(new Ni(t)),ve(!0)}(e.route,n),function(t,e,i){const n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(t=>function(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(t)).filter(t=>null!==t).map(e=>Ee(()=>ve(e.guards.map(s=>{const a=Os(s,e.node,i);let r;if(function(t){return t&&es(t.canActivateChild)}(a))r=Ki(a.canActivateChild(n,t));else{if(!es(a))throw new Error("Invalid CanActivateChild guard");r=Ki(a(n,t))}return r.pipe(pi())})).pipe(ss())));return ve(s).pipe(ss())}(t,e.path,i),function(t,e,i){const n=e.routeConfig?e.routeConfig.canActivate:null;return n&&0!==n.length?ve(n.map(n=>Ee(()=>{const s=Os(n,e,i);let a;if(function(t){return t&&es(t.canActivate)}(s))a=Ki(s.canActivate(e,t));else{if(!es(s))throw new Error("Invalid CanActivate guard");a=Ki(s(e,t))}return a.pipe(pi())}))).pipe(ss()):ve(!0)}(t,e.route,i))),pi(t=>!0!==t,!0))}(n,a,t,e):ve(i)),Object(Ne.a)(t=>Object.assign(Object.assign({},i),{guardsResult:t})))})}(this.ngModule.injector,t=>this.triggerEvent(t)),vi(t=>{if(is(t.guardsResult)){const e=qi(`Redirecting to "${this.serializeUrl(t.guardsResult)}"`);throw e.url=t.guardsResult,e}const e=new Bi(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.triggerEvent(e)}),We(t=>{if(!t.guardsResult){this.resetUrlToCurrentUrlTree();const i=new Ri(t.id,this.serializeUrl(t.extractedUrl),"");return e.next(i),t.resolve(!1),!1}return!0}),Fs(t=>{if(t.guards.canActivateChecks.length)return ve(t).pipe(vi(t=>{const e=new ji(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),Pe(t=>{let i=!1;return ve(t).pipe((n=this.paramsInheritanceStrategy,s=this.ngModule.injector,Object(ii.a)(t=>{const{targetSnapshot:e,guards:{canActivateChecks:i}}=t;if(!i.length)return ve(t);let a=0;return Object(me.a)(i).pipe(ni(t=>function(t,e,i,n){return function(t,e,i,n){const s=Object.keys(t);if(0===s.length)return ve({});const a={};return Object(me.a)(s).pipe(Object(ii.a)(s=>function(t,e,i,n){const s=Os(t,e,n);return Ki(s.resolve?s.resolve(e,i):s(e,i))}(t[s],e,i,n).pipe(vi(t=>{a[s]=t}))),si(1),Object(ii.a)(()=>Object.keys(a).length===s.length?ve(a):Ae))}(t._resolve,t,e,n).pipe(Object(Ne.a)(e=>(t._resolvedData=e,t.data=Object.assign(Object.assign({},t.data),Bn(t,i).resolve),null)))}(t.route,e,n,s)),vi(()=>a++),si(1),Object(ii.a)(e=>a===i.length?ve(t):Ae))})),vi({next:()=>i=!0,complete:()=>{if(!i){const i=new Ri(t.id,this.serializeUrl(t.extractedUrl),"At least one route resolver didn't emit any value.");e.next(i),t.resolve(!1)}}}));var n,s}),vi(t=>{const e=new Mi(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}))}),Fs(t=>{const{targetSnapshot:e,id:i,extractedUrl:n,rawUrl:s,extras:{skipLocationChange:a,replaceUrl:r}}=t;return this.hooks.afterPreactivation(e,{navigationId:i,appliedUrlTree:n,rawUrlTree:s,skipLocationChange:!!a,replaceUrl:!!r})}),Object(Ne.a)(t=>{const e=function(t,e,i){const n=Nn(t,e._root,i?i._root:void 0);return new On(n,e)}(this.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign(Object.assign({},t),{targetRouterState:e})}),vi(t=>{this.currentUrlTree=t.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl),this.routerState=t.targetRouterState,"deferred"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),(a=this.rootContexts,r=this.routeReuseStrategy,o=t=>this.triggerEvent(t),Object(Ne.a)(t=>(new Xn(r,t.targetRouterState,t.currentRouterState,o).activate(a),t))),vi({next(){i=!0},complete(){i=!0}}),(s=()=>{if(!i&&!n){this.resetUrlToCurrentUrlTree();const i=new Ri(t.id,this.serializeUrl(t.extractedUrl),`Navigation ID ${t.id} is not equal to the current navigation id ${this.navigationId}`);e.next(i),t.resolve(!1)}this.currentNavigation=null},t=>t.lift(new wi(s))),Ze(i=>{if(n=!0,(s=i)&&s.ngNavigationCancelingError){const n=is(i.url);n||(this.navigated=!0,this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));const s=new Ri(t.id,this.serializeUrl(t.extractedUrl),i.message);e.next(s),n?setTimeout(()=>{const e=this.urlHandlingStrategy.merge(i.url,this.rawUrlTree);this.scheduleNavigation(e,"imperative",null,{skipLocationChange:t.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy},{resolve:t.resolve,reject:t.reject,promise:t.promise})},0):t.resolve(!1)}else{this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);const n=new Oi(t.id,this.serializeUrl(t.extractedUrl),i);e.next(n);try{t.resolve(this.errorHandler(i))}catch(a){t.reject(a)}}var s;return Ae}));var s,a,r,o}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}getTransition(){const t=this.transitions.value;return t.urlAfterRedirects=this.browserUrlTree,t}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const e=this.extractLocationChangeInfoFromEvent(t);this.shouldScheduleNavigation(this.lastLocationChangeInfo,e)&&setTimeout(()=>{const{source:t,state:i,urlTree:n}=e,s={replaceUrl:!0};if(i){const t=Object.assign({},i);delete t.navigationId,0!==Object.keys(t).length&&(s.state=t)}this.scheduleNavigation(n,t,i,s)},0),this.lastLocationChangeInfo=e}))}extractLocationChangeInfoFromEvent(t){var e;return{source:"popstate"===t.type?"popstate":"hashchange",urlTree:this.parseUrl(t.url),state:(null===(e=t.state)||void 0===e?void 0:e.navigationId)?t.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(t,e){if(!t)return!0;const i=e.urlTree.toString()===t.urlTree.toString();return!(e.transitionId===t.transitionId&&i&&("hashchange"===e.source&&"popstate"===t.source||"popstate"===e.source&&"hashchange"===t.source))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){rs(t),this.config=t.map(ls),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0)}createUrlTree(t,e={}){const{relativeTo:i,queryParams:n,fragment:s,queryParamsHandling:a,preserveFragment:r}=e,o=i||this.routerState.root,c=r?this.currentUrlTree.fragment:s;let l=null;switch(a){case"merge":l=Object.assign(Object.assign({},this.currentUrlTree.queryParams),n);break;case"preserve":l=this.currentUrlTree.queryParams;break;default:l=n||null}return null!==l&&(l=this.removeEmptyProps(l)),function(t,e,i,n,s){if(0===i.length)return zn(e.root,e.root,e,n,s);const a=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new qn(!0,0,t);let e=0,i=!1;const n=t.reduce((t,n,s)=>{if("object"==typeof n&&null!=n){if(n.outlets){const e={};return Wi(n.outlets,(t,i)=>{e[i]="string"==typeof t?t.split("/"):t}),[...t,{outlets:e}]}if(n.segmentPath)return[...t,n.segmentPath]}return"string"!=typeof n?[...t,n]:0===s?(n.split("/").forEach((n,s)=>{0==s&&"."===n||(0==s&&""===n?i=!0:".."===n?e++:""!=n&&t.push(n))}),t):[...t,n]},[]);return new qn(i,e,n)}(i);if(a.toRoot())return zn(e.root,new sn([],{}),e,n,s);const r=function(t,e,i){if(t.isAbsolute)return new Vn(e.root,!0,0);if(-1===i.snapshot._lastPathIndex){const t=i.snapshot._urlSegment;return new Vn(t,t===e.root,0)}const n=Pn(t.commands[0])?0:1;return function(t,e,i){let n=t,s=e,a=i;for(;a>s;){if(a-=s,n=n.parent,!n)throw new Error("Invalid number of '../'");s=n.segments.length}return new Vn(n,!1,s-a)}(i.snapshot._urlSegment,i.snapshot._lastPathIndex+n,t.numberOfDoubleDots)}(a,e,t),o=r.processChildren?Gn(r.segmentGroup,r.index,a.commands):$n(r.segmentGroup,r.index,a.commands);return zn(r.segmentGroup,o,e,n,s)}(o,this.currentUrlTree,t,l,c)}navigateByUrl(t,e={skipLocationChange:!1}){const i=is(t)?t:this.parseUrl(t),n=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(n,"imperative",null,e)}navigate(t,e={skipLocationChange:!1}){return function(t){for(let e=0;e<t.length;e++){const i=t[e];if(null==i)throw new Error(`The requested path contains ${i} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,e),e)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let e;try{e=this.urlSerializer.parse(t)}catch(i){e=this.malformedUriErrorHandler(i,this.urlSerializer,t)}return e}isActive(t,e){if(is(t))return Xi(this.currentUrlTree,t,e);const i=this.parseUrl(t);return Xi(this.currentUrlTree,i,e)}removeEmptyProps(t){return Object.keys(t).reduce((e,i)=>{const n=t[i];return null!=n&&(e[i]=n),e},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.events.next(new Li(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.currentNavigation=null,t.resolve(!0)},t=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(t,e,i,n,s){const a=this.getTransition(),r="imperative"!==e&&"imperative"===(null==a?void 0:a.source),o=(this.lastSuccessfulId===a.id||this.currentNavigation?a.rawUrl:a.urlAfterRedirects).toString()===t.toString();if(r&&o)return Promise.resolve(!0);let c,l,u;s?(c=s.resolve,l=s.reject,u=s.promise):u=new Promise((t,e)=>{c=t,l=e});const d=++this.navigationId;return this.setTransition({id:d,source:e,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:n,resolve:c,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(t=>Promise.reject(t))}setBrowserUrl(t,e,i,n){const s=this.urlSerializer.serialize(t);n=n||{},this.location.isCurrentPathEqualTo(s)||e?this.location.replaceState(s,"",Object.assign(Object.assign({},n),{navigationId:i})):this.location.go(s,"",Object.assign(Object.assign({},n),{navigationId:i}))}resetStateAndUrl(t,e,i){this.routerState=t,this.currentUrlTree=e,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(o.Q),o.Vb(on),o.Vb(qs),o.Vb(qt),o.Vb(o.t),o.Vb(o.A),o.Vb(o.i),o.Vb(void 0))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})(),Ws=(()=>{class t{constructor(t,e,i,n,s){this.router=t,this.route=e,this.commands=[],this.onChanges=new ye.a,null==i&&n.setAttribute(s.nativeElement,"tabindex","0")}ngOnChanges(t){this.onChanges.next(this)}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:[]}onClick(){const t={skipLocationChange:Xs(this.skipLocationChange),replaceUrl:Xs(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,t),!0}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:Xs(this.preserveFragment)})}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Ys),o.Nb(xn),o.Wb("tabindex"),o.Nb(o.H),o.Nb(o.m))},t.\u0275dir=o.Ib({type:t,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(t,e){1&t&&o.Yb("click",function(){return e.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state"},features:[o.zb]}),t})(),Ks=(()=>{class t{constructor(t,e,i){this.router=t,this.route=e,this.locationStrategy=i,this.commands=[],this.onChanges=new ye.a,this.subscription=t.events.subscribe(t=>{t instanceof Li&&this.updateTargetUrlAndHref()})}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:[]}ngOnChanges(t){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(t,e,i,n,s){if(0!==t||e||i||n||s)return!0;if("string"==typeof this.target&&"_self"!=this.target)return!0;const a={skipLocationChange:Xs(this.skipLocationChange),replaceUrl:Xs(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,a),!1}updateTargetUrlAndHref(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:Xs(this.preserveFragment)})}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Ys),o.Nb(xn),o.Nb(Ft))},t.\u0275dir=o.Ib({type:t,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(t,e){1&t&&o.Yb("click",function(t){return e.onClick(t.button,t.ctrlKey,t.shiftKey,t.altKey,t.metaKey)}),2&t&&(o.Ub("href",e.href,o.Cc),o.Cb("target",e.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state"},features:[o.zb]}),t})();function Xs(t){return""===t||!!t}let Zs=(()=>{class t{constructor(t,e,i,n,s,a){this.router=t,this.element=e,this.renderer=i,this.cdr=n,this.link=s,this.linkWithHref=a,this.classes=[],this.isActive=!1,this.routerLinkActiveOptions={exact:!1},this.routerEventsSubscription=t.events.subscribe(t=>{t instanceof Li&&this.update()})}ngAfterContentInit(){ve(this.links.changes,this.linksWithHrefs.changes,ve(null)).pipe(Object(Me.a)()).subscribe(t=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){var t;null===(t=this.linkInputChangesSubscription)||void 0===t||t.unsubscribe();const e=[...this.links.toArray(),...this.linksWithHrefs.toArray(),this.link,this.linkWithHref].filter(t=>!!t).map(t=>t.onChanges);this.linkInputChangesSubscription=Object(me.a)(e).pipe(Object(Me.a)()).subscribe(t=>{this.isActive!==this.isLinkActive(this.router)(t)&&this.update()})}set routerLinkActive(t){const e=Array.isArray(t)?t:t.split(" ");this.classes=e.filter(t=>!!t)}ngOnChanges(t){this.update()}ngOnDestroy(){var t;this.routerEventsSubscription.unsubscribe(),null===(t=this.linkInputChangesSubscription)||void 0===t||t.unsubscribe()}update(){this.links&&this.linksWithHrefs&&this.router.navigated&&Promise.resolve().then(()=>{const t=this.hasActiveLinks();this.isActive!==t&&(this.isActive=t,this.cdr.markForCheck(),this.classes.forEach(e=>{t?this.renderer.addClass(this.element.nativeElement,e):this.renderer.removeClass(this.element.nativeElement,e)}))})}isLinkActive(t){return e=>t.isActive(e.urlTree,this.routerLinkActiveOptions.exact)}hasActiveLinks(){const t=this.isLinkActive(this.router);return this.link&&t(this.link)||this.linkWithHref&&t(this.linkWithHref)||this.links.some(t)||this.linksWithHrefs.some(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Ys),o.Nb(o.m),o.Nb(o.H),o.Nb(o.h),o.Nb(Ws,8),o.Nb(Ks,8))},t.\u0275dir=o.Ib({type:t,selectors:[["","routerLinkActive",""]],contentQueries:function(t,e,i){if(1&t&&(o.Gb(i,Ws,!0),o.Gb(i,Ks,!0)),2&t){let t;o.vc(t=o.Zb())&&(e.links=t),o.vc(t=o.Zb())&&(e.linksWithHrefs=t)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",routerLinkActive:"routerLinkActive"},exportAs:["routerLinkActive"],features:[o.zb]}),t})(),ta=(()=>{class t{constructor(t,e,i,n,s){this.parentContexts=t,this.location=e,this.resolver=i,this.changeDetector=s,this.activated=null,this._activatedRoute=null,this.activateEvents=new o.o,this.deactivateEvents=new o.o,this.name=n||Ui,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,t}attach(t,e){this.activated=t,this._activatedRoute=e,this.location.insert(t.hostView)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,e){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const i=(e=e||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),n=this.parentContexts.getOrCreateContext(this.name).children,s=new ea(t,n,this.location.injector);this.activated=this.location.createComponent(i,this.location.length,s),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(qs),o.Nb(o.S),o.Nb(o.j),o.Wb("name"),o.Nb(o.h))},t.\u0275dir=o.Ib({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),t})();class ea{constructor(t,e,i){this.route=t,this.childContexts=e,this.parent=i}get(t,e){return t===xn?this.route:t===qs?this.childContexts:this.parent.get(t,e)}}class ia{}class na{preload(t,e){return ve(null)}}let sa=(()=>{class t{constructor(t,e,i,n,s){this.router=t,this.injector=n,this.preloadingStrategy=s,this.loader=new zs(e,i,e=>t.triggerEvent(new Qi(e)),e=>t.triggerEvent(new Ai(e)))}setUpPreloading(){this.subscription=this.router.events.pipe(We(t=>t instanceof Li),ni(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(o.B);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,e){const i=[];for(const n of e)if(n.loadChildren&&!n.canLoad&&n._loadedConfig){const t=n._loadedConfig;i.push(this.processRoutes(t.module,t.routes))}else n.loadChildren&&!n.canLoad?i.push(this.preloadConfig(t,n)):n.children&&i.push(this.processRoutes(t,n.children));return Object(me.a)(i).pipe(Object(Me.a)(),Object(Ne.a)(t=>{}))}preloadConfig(t,e){return this.preloadingStrategy.preload(e,()=>this.loader.load(t.injector,e).pipe(Object(ii.a)(t=>(e._loadedConfig=t,this.processRoutes(t.module,t.routes)))))}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(Ys),o.Vb(o.A),o.Vb(o.i),o.Vb(o.t),o.Vb(ia))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})(),aa=(()=>{class t{constructor(t,e,i={}){this.router=t,this.viewportScroller=e,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Ci?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Li&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Pi&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,e){this.router.triggerEvent(new Pi(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,e))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(Ys),o.Vb(de),o.Vb(void 0))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})();const ra=new o.s("ROUTER_CONFIGURATION"),oa=new o.s("ROUTER_FORROOT_GUARD"),ca=[qt,{provide:on,useClass:cn},{provide:Ys,useFactory:function(t,e,i,n,s,a,r,o={},c,l){const u=new Ys(null,t,e,i,n,s,a,Hi(r));if(c&&(u.urlHandlingStrategy=c),l&&(u.routeReuseStrategy=l),function(t,e){t.errorHandler&&(e.errorHandler=t.errorHandler),t.malformedUriErrorHandler&&(e.malformedUriErrorHandler=t.malformedUriErrorHandler),t.onSameUrlNavigation&&(e.onSameUrlNavigation=t.onSameUrlNavigation),t.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=t.paramsInheritanceStrategy),t.relativeLinkResolution&&(e.relativeLinkResolution=t.relativeLinkResolution),t.urlUpdateStrategy&&(e.urlUpdateStrategy=t.urlUpdateStrategy)}(o,u),o.enableTracing){const t=Ot();u.events.subscribe(e=>{t.logGroup("Router Event: "+e.constructor.name),t.log(e.toString()),t.log(e),t.logGroupEnd()})}return u},deps:[on,qs,qt,o.t,o.A,o.i,Us,ra,[class{},new o.E],[class{},new o.E]]},qs,{provide:xn,useFactory:function(t){return t.routerState.root},deps:[Ys]},{provide:o.A,useClass:o.N},sa,na,class{preload(t,e){return e().pipe(Ze(()=>ve(null)))}},{provide:ra,useValue:{enableTracing:!1}}];function la(){return new o.C("Router",Ys)}let ua=(()=>{class t{constructor(t,e){}static forRoot(e,i){return{ngModule:t,providers:[ca,ma(e),{provide:oa,useFactory:ba,deps:[[Ys,new o.E,new o.M]]},{provide:ra,useValue:i||{}},{provide:Ft,useFactory:ha,deps:[xt,[new o.q(Ut),new o.E],ra]},{provide:aa,useFactory:da,deps:[Ys,de,ra]},{provide:ia,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:na},{provide:o.C,multi:!0,useFactory:la},[pa,{provide:o.d,multi:!0,useFactory:ga,deps:[pa]},{provide:va,useFactory:fa,deps:[pa]},{provide:o.b,multi:!0,useExisting:va}]]}}static forChild(e){return{ngModule:t,providers:[ma(e)]}}}return t.\u0275mod=o.Lb({type:t}),t.\u0275inj=o.Kb({factory:function(e){return new(e||t)(o.Vb(oa,8),o.Vb(Ys,8))}}),t})();function da(t,e,i){return i.scrollOffset&&e.setOffset(i.scrollOffset),new aa(t,e,i)}function ha(t,e,i={}){return i.useHash?new Jt(t,e):new zt(t,e)}function ba(t){return"guarded"}function ma(t){return[{provide:o.a,multi:!0,useValue:t},{provide:Us,multi:!0,useValue:t}]}let pa=(()=>{class t{constructor(t){this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new ye.a}appInitializer(){return this.injector.get(jt,Promise.resolve(null)).then(()=>{let t=null;const e=new Promise(e=>t=e),i=this.injector.get(Ys),n=this.injector.get(ra);return"disabled"===n.initialNavigation?(i.setUpLocationChangeListener(),t(!0)):"enabled"===n.initialNavigation||"enabledBlocking"===n.initialNavigation?(i.hooks.afterPreactivation=()=>this.initNavigation?ve(null):(this.initNavigation=!0,t(!0),this.resultOfPreactivationDone),i.initialNavigation()):t(!0),e})}bootstrapListener(t){const e=this.injector.get(ra),i=this.injector.get(sa),n=this.injector.get(aa),s=this.injector.get(Ys),a=this.injector.get(o.g);t===a.components[0]&&("enabledNonBlocking"!==e.initialNavigation&&void 0!==e.initialNavigation||s.initialNavigation(),i.setUpPreloading(),n.init(),s.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(o.t))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})();function ga(t){return t.appInitializer.bind(t)}function fa(t){return t.bootstrapListener.bind(t)}const va=new o.s("Router Initializer");var ya,_a,ka,wa="undefined"!=typeof Zone&&!!Zone.current;function Sa(){var t=Object(h.b)();if(t){var e=t.getScope();if(e)return e.getTransaction()}}var Ia=function(){function t(t){var e=this;this._router=t,this.navStart$=this._router.events.pipe(We(function(t){return t instanceof Ci}),vi(function(t){if(ya){var i=t,n=Object(m.i)(i.url),s=Sa();!s&&ka&&(s=_a({name:n,op:"navigation"})),s&&(e._routingSpan=s.startChild({description:""+i.url,op:"angular.routing",tags:Object(l.a)({"routing.instrumentation":"@sentry/angular",url:n},i.navigationTrigger&&{navigationTrigger:i.navigationTrigger})}))}else b.a.error("Angular integration has tracing enabled, but Tracing integration is not configured")})),this.navEnd$=this._router.events.pipe(We(function(t){return t instanceof Li}),vi(function(){var t;e._routingSpan&&(t=function(){e._routingSpan.finish()},wa?Zone.root.run(t):t(),e._routingSpan=null)})),this._routingSpan=null,this._subscription=new ki.a,this._subscription.add(this.navStart$.subscribe()),this._subscription.add(this.navEnd$.subscribe())}return t.prototype.ngOnDestroy=function(){this._subscription.unsubscribe()},Object(l.b)([Object(o.r)({providedIn:"root"})],t)}(),Ca=function(){function t(){this.componentName="unknown"}return t.prototype.ngOnInit=function(){var t=Sa();t&&(this._tracingSpan=t.startChild({description:"<"+this.componentName+">",op:"angular.initialize"}))},t.prototype.ngAfterViewInit=function(){this._tracingSpan&&this._tracingSpan.finish()},Object(l.b)([Object(o.u)("trace")],t.prototype,"componentName",void 0),Object(l.b)([Object(o.l)({selector:"[trace]"})],t)}();!function(){function t(){}t=Object(l.b)([Object(o.y)({declarations:[Ca],exports:[Ca]})],t)}();var La={},Ra=Object(m.e)();Ra.Sentry&&Ra.Sentry.Integrations&&(La=Ra.Sentry.Integrations);var Oa=Object(l.a)(Object(l.a)(Object(l.a)({},La),n),s),Ta=i("Cpvd"),xa=i("MBYv"),Ba=i("bju/"),ja=i("FGHR"),Ma=Object(m.e)(),Qa=i("+A1k"),Aa=function(t,e,i){var n;return function(s){e.value>=0&&(s||i)&&(e.delta=e.value-(n||0),(e.delta||void 0===n)&&(n=e.value,t(e)))}},Da=function(t,e){return{name:t,value:null!=e?e:-1,delta:0,entries:[],id:"v2-"+Date.now()+"-"+(Math.floor(8999999999999*Math.random())+1e12)}},Ea=function(t,e){try{if(PerformanceObserver.supportedEntryTypes.includes(t)){if("first-input"===t&&!("PerformanceEventTiming"in self))return;var i=new PerformanceObserver(function(t){return t.getEntries().map(e)});return i.observe({type:t,buffered:!0}),i}}catch(n){}},Na=function(t,e){var i=function(n){"pagehide"!==n.type&&"hidden"!==document.visibilityState||(t(n),e&&(removeEventListener("visibilitychange",i,!0),removeEventListener("pagehide",i,!0)))};addEventListener("visibilitychange",i,!0),addEventListener("pagehide",i,!0)},Fa=-1,Pa=function(){return Fa<0&&(Fa="hidden"===document.visibilityState?0:1/0,Na(function(t){Fa=t.timeStamp},!0)),{get firstHiddenTime(){return Fa}}},Ua={},za=Object(m.e)(),Ja=function(){function t(){var t;this._measurements={},this._performanceCursor=0,!Object(Qa.b)()&&(null===(t=za)||void 0===t?void 0:t.performance)&&(za.performance.mark&&za.performance.mark("sentry-tracing-init"),this._trackCLS(),this._trackLCP(),this._trackFID())}return t.prototype.addPerformanceEntries=function(t){var e=this;if(za&&za.performance&&za.performance.getEntries&&L.a){b.a.log("[Tracing] Adding & adjusting spans using Performance API");var i,n,s,a,r,o=Object(ja.d)(L.a);if(za.document&&za.document.scripts)for(var c=0;c<za.document.scripts.length;c++)if("true"===za.document.scripts[c].dataset.entry){i=za.document.scripts[c].src;break}if(za.performance.getEntries().slice(this._performanceCursor).forEach(function(c){var l=Object(ja.d)(c.startTime),u=Object(ja.d)(c.duration);if(!("navigation"===t.op&&o+l<t.startTimestamp))switch(c.entryType){case"navigation":!function(t,e,i){qa({transaction:t,entry:e,event:"unloadEvent",timeOrigin:i}),qa({transaction:t,entry:e,event:"redirect",timeOrigin:i}),qa({transaction:t,entry:e,event:"domContentLoadedEvent",timeOrigin:i}),qa({transaction:t,entry:e,event:"loadEvent",timeOrigin:i}),qa({transaction:t,entry:e,event:"connect",timeOrigin:i}),qa({transaction:t,entry:e,event:"secureConnection",timeOrigin:i,eventEnd:"connectEnd",description:"TLS/SSL"}),qa({transaction:t,entry:e,event:"fetch",timeOrigin:i,eventEnd:"domainLookupStart",description:"cache"}),qa({transaction:t,entry:e,event:"domainLookup",timeOrigin:i,description:"DNS"}),function(t,e,i){Va(t,{op:"browser",description:"request",startTimestamp:i+Object(ja.d)(e.requestStart),endTimestamp:i+Object(ja.d)(e.responseEnd)}),Va(t,{op:"browser",description:"response",startTimestamp:i+Object(ja.d)(e.responseStart),endTimestamp:i+Object(ja.d)(e.responseEnd)})}(t,e,i)}(t,c,o),a=o+Object(ja.d)(c.responseStart),r=o+Object(ja.d)(c.requestStart);break;case"mark":case"paint":case"measure":var d=function(t,e,i,n,s){var a=s+i;return Va(t,{description:e.name,endTimestamp:a+n,op:e.entryType,startTimestamp:a}),a}(t,c,l,u,o);void 0===s&&"sentry-tracing-init"===c.name&&(s=d);var h=Pa(),m=c.startTime<h.firstHiddenTime;"first-paint"===c.name&&m&&(b.a.log("[Measurements] Adding FP"),e._measurements.fp={value:c.startTime},e._measurements["mark.fp"]={value:d}),"first-contentful-paint"===c.name&&m&&(b.a.log("[Measurements] Adding FCP"),e._measurements.fcp={value:c.startTime},e._measurements["mark.fcp"]={value:d});break;case"resource":var p=c.name.replace(window.location.origin,""),g=function(t,e,i,n,s,a){if("xmlhttprequest"!==e.initiatorType&&"fetch"!==e.initiatorType){var r={};"transferSize"in e&&(r["Transfer Size"]=e.transferSize),"encodedBodySize"in e&&(r["Encoded Body Size"]=e.encodedBodySize),"decodedBodySize"in e&&(r["Decoded Body Size"]=e.decodedBodySize);var o=a+n,c=o+s;return Va(t,{description:i,endTimestamp:c,op:e.initiatorType?"resource."+e.initiatorType:"resource",startTimestamp:o,data:r}),c}}(t,c,p,l,u,o);void 0===n&&(i||"").indexOf(p)>-1&&(n=g)}}),void 0!==n&&void 0!==s&&Va(t,{description:"evaluation",endTimestamp:s,op:"script",startTimestamp:n}),this._performanceCursor=Math.max(performance.getEntries().length-1,0),this._trackNavigator(t),"pageload"===t.op){var l=Object(ja.d)(L.a);"number"==typeof a&&(b.a.log("[Measurements] Adding TTFB"),this._measurements.ttfb={value:1e3*(a-t.startTimestamp)},"number"==typeof r&&r<=a&&(this._measurements["ttfb.requestTime"]={value:1e3*(a-r)})),["fcp","fp","lcp"].forEach(function(i){if(e._measurements[i]&&!(l>=t.startTimestamp)){var n=e._measurements[i].value,s=l+Object(ja.d)(n),a=Math.abs(1e3*(s-t.startTimestamp));b.a.log("[Measurements] Normalized "+i+" from "+n+" to "+a+" ("+(a-n)+")"),e._measurements[i].value=a}}),this._measurements["mark.fid"]&&this._measurements.fid&&Va(t,{description:"first input delay",endTimestamp:this._measurements["mark.fid"].value+Object(ja.d)(this._measurements.fid.value),op:"web.vitals",startTimestamp:this._measurements["mark.fid"].value}),"fcp"in this._measurements||delete this._measurements.cls,t.setMeasurements(this._measurements),this._tagMetricInfo(t)}}},t.prototype._tagMetricInfo=function(t){this._lcpEntry&&(b.a.log("[Measurements] Adding LCP Data"),this._lcpEntry.element&&t.setTag("lcp.element",Object(pt.a)(this._lcpEntry.element)),this._lcpEntry.id&&t.setTag("lcp.id",this._lcpEntry.id),this._lcpEntry.url&&t.setTag("lcp.url",this._lcpEntry.url.trim().slice(0,200)),t.setTag("lcp.size",this._lcpEntry.size)),this._clsEntry&&this._clsEntry.sources&&(b.a.log("[Measurements] Adding CLS Data"),this._clsEntry.sources.forEach(function(e,i){return t.setTag("cls.source."+(i+1),Object(pt.a)(e.node))}))},t.prototype._trackCLS=function(){var t,e,i,n,s,a,r,o=this;t=function(t){var e=t.entries.pop();e&&(b.a.log("[Measurements] Adding CLS"),o._measurements.cls={value:t.value},o._clsEntry=e)},i=Da("CLS",0),n=0,s=[],(r=Ea("layout-shift",a=function(t){t&&!t.hadRecentInput&&(n&&0!==s.length&&t.startTime-s[s.length-1].startTime<1e3&&t.startTime-s[0].startTime<5e3?(n+=t.value,s.push(t)):(n=t.value,s=[t]),n>i.value&&(i.value=n,i.entries=s,e&&e()))}))&&(e=Aa(t,i,void 0),Na(function(){r.takeRecords().map(a),e(!0)}))},t.prototype._trackNavigator=function(t){var e=za.navigator;if(e){var i=e.connection;i&&(i.effectiveType&&t.setTag("effectiveConnectionType",i.effectiveType),i.type&&t.setTag("connectionType",i.type),$a(i.rtt)&&(this._measurements["connection.rtt"]={value:i.rtt}),$a(i.downlink)&&(this._measurements["connection.downlink"]={value:i.downlink})),$a(e.deviceMemory)&&t.setTag("deviceMemory",String(e.deviceMemory)),$a(e.hardwareConcurrency)&&t.setTag("hardwareConcurrency",String(e.hardwareConcurrency))}},t.prototype._trackLCP=function(){var t=this;!function(e,i){var n,s=Pa(),a=Da("LCP"),r=function(t){var e=t.startTime;e<s.firstHiddenTime&&(a.value=e,a.entries.push(t)),n&&n()},o=Ea("largest-contentful-paint",r);if(o){n=Aa(function(e){var i=e.entries.pop();if(i){var n=Object(ja.d)(L.a),s=Object(ja.d)(i.startTime);b.a.log("[Measurements] Adding LCP"),t._measurements.lcp={value:e.value},t._measurements["mark.lcp"]={value:n+s},t._lcpEntry=i}},a,void 0);var c=function(){Ua[a.id]||(o.takeRecords().map(r),o.disconnect(),Ua[a.id]=!0,n(!0))};["keydown","click"].forEach(function(t){addEventListener(t,c,{once:!0,capture:!0})}),Na(c,!0)}}()},t.prototype._trackFID=function(){var t,e,i,n,s,a,r=this;t=function(t){var e=t.entries.pop();if(e){var i=Object(ja.d)(L.a),n=Object(ja.d)(e.startTime);b.a.log("[Measurements] Adding FID"),r._measurements.fid={value:t.value},r._measurements["mark.fid"]={value:i+n}}},i=Pa(),n=Da("FID"),(a=Ea("first-input",s=function(t){e&&t.startTime<i.firstHiddenTime&&(n.value=t.processingStart-t.startTime,n.entries.push(t),e(!0))}))&&(e=Aa(t,n,void 0),Na(function(){a.takeRecords().map(s),a.disconnect()},!0))},t}();function qa(t){var e=t.entry,i=t.event,n=t.timeOrigin,s=t.eventEnd,a=t.description,r=s?e[s]:e[i+"End"],o=e[i+"Start"];o&&r&&Va(t.transaction,{op:"browser",description:null!=a?a:i,startTimestamp:n+Object(ja.d)(o),endTimestamp:n+Object(ja.d)(r)})}function Va(t,e){var i=e.startTimestamp,n=Object(l.e)(e,["startTimestamp"]);return i&&t.startTimestamp>i&&(t.startTimestamp=i),t.startChild(Object(l.a)({startTimestamp:i},n))}function $a(t){return"number"==typeof t&&isFinite(t)}var Ga={traceFetch:!0,traceXHR:!0,tracingOrigins:["localhost",/^\//]},Ha=Object(m.e)(),Ya=Object(l.a)({idleTimeout:xa.a,markBackgroundTransactions:!0,maxTransactionDuration:600,routingInstrumentation:function(t,e,i){if(void 0===e&&(e=!0),void 0===i&&(i=!0),Ha&&Ha.location){var n,s=Ha.location.href;e&&(n=t({name:Ha.location.pathname,op:"pageload"})),i&&Object(y.a)({callback:function(e){var i=e.to,a=e.from;void 0===a&&s&&-1!==s.indexOf(i)?s=void 0:a!==i&&(s=void 0,n&&(b.a.log("[Tracing] Finishing current transaction with op: "+n.op),n.finish()),n=t({name:Ha.location.pathname,op:"navigation"}))},type:"history"})}else b.a.warn("Could not initialize routing instrumentation due to invalid location")},startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0},Ga),Wa=function(){function t(e){this.name=t.id,this._metrics=new Ja,this._emitOptionsWarning=!1;var i=Ga.tracingOrigins;e&&e.tracingOrigins&&Array.isArray(e.tracingOrigins)&&0!==e.tracingOrigins.length?i=e.tracingOrigins:this._emitOptionsWarning=!0,this.options=Object(l.a)(Object(l.a)(Object(l.a)({},Ya),e),{tracingOrigins:i})}return t.prototype.setupOnce=function(t,e){var i=this;this._getCurrentHub=e,this._emitOptionsWarning&&(b.a.warn("[Tracing] You need to define `tracingOrigins` in the options. Set an array of urls or patterns to trace."),b.a.warn("[Tracing] We added a reasonable default for you: "+Ga.tracingOrigins));var n=this.options,s=n.markBackgroundTransactions,a=n.traceFetch,r=n.traceXHR,o=n.tracingOrigins,c=n.shouldCreateSpanForRequest;(0,n.routingInstrumentation)(function(t){return i._createRouteTransaction(t)},n.startTransactionOnPageLoad,n.startTransactionOnLocationChange),s&&(Ma&&Ma.document?Ma.document.addEventListener("visibilitychange",function(){var t=Object(ja.b)();Ma.document.hidden&&t&&(b.a.log("[Tracing] Transaction: "+Ba.a.Cancelled+" -> since tab moved to the background, op: "+t.op),t.status||t.setStatus(Ba.a.Cancelled),t.setTag("visibilitychange","document.hidden"),t.finish())}):b.a.warn("[Tracing] Could not set up background tab detection due to lack of global document")),function(e){var i=Object(l.a)(Object(l.a)({},Ga),e),n=i.traceXHR,s=i.tracingOrigins,a=i.shouldCreateSpanForRequest,r={},o=function(t){return r[t]||(r[t]=s.some(function(e){return Object(p.a)(t,e)})&&!Object(p.a)(t,"sentry_key")),r[t]},c=o;"function"==typeof a&&(c=function(t){return o(t)&&a(t)});var u={};i.traceFetch&&Object(y.a)({callback:function(t){!function(t,e,i){if(Object(ja.c)()&&t.fetchData&&e(t.fetchData.url))if(t.endTimestamp&&t.fetchData.__span)(s=i[t.fetchData.__span])&&(t.response?s.setHttpStatus(t.response.status):t.error&&s.setStatus(Ba.a.InternalError),s.finish(),delete i[t.fetchData.__span]);else{var n=Object(ja.b)();if(n){var s=n.startChild({data:Object(l.a)(Object(l.a)({},t.fetchData),{type:"fetch"}),description:t.fetchData.method+" "+t.fetchData.url,op:"http.client"});t.fetchData.__span=s.spanId,i[s.spanId]=s;var a=t.args[0]=t.args[0],r=t.args[1]=t.args[1]||{},o=r.headers;Object(C.g)(a,Request)&&(o=a.headers),o?"function"==typeof o.append?o.append("sentry-trace",s.toTraceparent()):o=Array.isArray(o)?Object(l.f)(o,[["sentry-trace",s.toTraceparent()]]):Object(l.a)(Object(l.a)({},o),{"sentry-trace":s.toTraceparent()}):o={"sentry-trace":s.toTraceparent()},r.headers=o}}}(t,c,u)},type:"fetch"}),n&&Object(y.a)({callback:function(e){!function(e,i,n){var s,a;if(Object(ja.c)()&&!(null===(s=e.xhr)||void 0===s?void 0:s.__sentry_own_request__)&&(null===(a=e.xhr)||void 0===a?void 0:a.__sentry_xhr__)&&i(e.xhr.__sentry_xhr__.url)){var r=e.xhr.__sentry_xhr__;if(e.endTimestamp&&e.xhr.__sentry_xhr_span_id__)(c=n[e.xhr.__sentry_xhr_span_id__])&&(c.setHttpStatus(r.status_code),c.finish(),delete n[e.xhr.__sentry_xhr_span_id__]);else{var o=Object(ja.b)();if(o){var c=o.startChild({data:Object(l.a)(Object(l.a)({},r.data),{type:"xhr",method:r.method,url:r.url}),description:r.method+" "+r.url,op:"http.client"});if(e.xhr.__sentry_xhr_span_id__=c.spanId,n[e.xhr.__sentry_xhr_span_id__]=c,e.xhr.setRequestHeader)try{e.xhr.setRequestHeader("sentry-trace",c.toTraceparent())}catch(t){}}}}}(e,c,u)},type:"xhr"})}({traceFetch:a,traceXHR:r,tracingOrigins:o,shouldCreateSpanForRequest:c})},t.prototype._createRouteTransaction=function(t){var e=this;if(this._getCurrentHub){var i=this.options,n=i.beforeNavigate,s=i.idleTimeout,a=i.maxTransactionDuration,r="pageload"===t.op?function(){var t,e=(t=document.querySelector("meta[name=sentry-trace]"))?t.getAttribute("content"):null;if(e)return Object(ja.a)(e)}():void 0,o=Object(l.a)(Object(l.a)(Object(l.a)({},t),r),{trimEnd:!0}),c="function"==typeof n?n(o):o,u=void 0===c?Object(l.a)(Object(l.a)({},o),{sampled:!1}):c;!1===u.sampled&&b.a.log("[Tracing] Will not send "+u.op+" transaction because of beforeNavigate."),b.a.log("[Tracing] Starting "+u.op+" transaction on scope");var d=this._getCurrentHub(),h=Object(m.e)().location,p=Object(Ta.b)(d,u,s,!0,{location:h});return p.registerBeforeFinishCallback(function(t,i){e._metrics.addPerformanceEntries(t),function(t,e,i){var n=i-e.startTimestamp;i&&(n>t||n<0)&&(e.setStatus(Ba.a.DeadlineExceeded),e.setTag("maxTransactionDurationExceeded","true"))}(Object(ja.e)(a),t,i)}),p}b.a.warn("[Tracing] Did not create "+t.op+" transaction because _getCurrentHub is invalid.")},t.id="BrowserTracing",t}(),Ka=function(){function t(e){void 0===e&&(e={}),this.name=t.id,this._router=e.router||e.app,this._methods=(Array.isArray(e.methods)?e.methods:[]).concat("use")}return t.prototype.setupOnce=function(){var t,e;this._router?(t=this._router,void 0===(e=this._methods)&&(e=[]),e.forEach(function(e){return function(t,e){var i=t[e];return t[e]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return i.call.apply(i,Object(l.f)([this],Za(t,e)))},t}(t,e)})):b.a.error("ExpressIntegration is missing an Express instance")},t.id="Express",t}();function Xa(t,e){var i=t.length;switch(i){case 2:return function(i,n){var s=n.__sentry_transaction;if(s){var a=s.startChild({description:t.name,op:"middleware."+e});n.once("finish",function(){a.finish()})}return t.call(this,i,n)};case 3:return function(i,n,s){var a,r=null===(a=n.__sentry_transaction)||void 0===a?void 0:a.startChild({description:t.name,op:"middleware."+e});t.call(this,i,n,function(){for(var t,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];null===(t=r)||void 0===t||t.finish(),s.call.apply(s,Object(l.f)([this],e))})};case 4:return function(i,n,s,a){var r,o=null===(r=s.__sentry_transaction)||void 0===r?void 0:r.startChild({description:t.name,op:"middleware."+e});t.call(this,i,n,s,function(){for(var t,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];null===(t=o)||void 0===t||t.finish(),a.call.apply(a,Object(l.f)([this],e))})};default:throw new Error("Express middleware takes 2-4 arguments. Got: "+i)}}function Za(t,e){return t.map(function(t){return"function"==typeof t?Xa(t,e):Array.isArray(t)?t.map(function(t){return"function"==typeof t?Xa(t,e):t}):t})}var tr=function(){function t(){this.name=t.id}return t.prototype.setupOnce=function(t,e){var i=Object(Qa.c)("pg");i?Object(R.c)(i.Client.prototype,"query",function(t){return function(i,n,s){var a,r,o,c=null===(r=null===(a=e().getScope())||void 0===a?void 0:a.getSpan())||void 0===r?void 0:r.startChild({description:"string"==typeof i?i:i.text,op:"db"});if("function"==typeof s)return t.call(this,i,n,function(t,e){var i;null===(i=c)||void 0===i||i.finish(),s(t,e)});if("function"==typeof n)return t.call(this,i,function(t,e){var i;null===(i=c)||void 0===i||i.finish(),n(t,e)});var l=void 0!==n?t.call(this,i,n):t.call(this,i);return Object(C.m)(l)?l.then(function(t){var e;return null===(e=c)||void 0===e||e.finish(),t}):(null===(o=c)||void 0===o||o.finish(),l)}}):b.a.error("Postgres Integration was unable to require `pg` package.")},t.id="Postgres",t}(),er=function(){function t(){this.name=t.id}return t.prototype.setupOnce=function(t,e){var i=Object(Qa.c)("mysql/lib/Connection.js");i?Object(R.c)(i,"createQuery",function(t){return function(i,n,s){var a,r,o=null===(r=null===(a=e().getScope())||void 0===a?void 0:a.getSpan())||void 0===r?void 0:r.startChild({description:"string"==typeof i?i:i.sql,op:"db"});return"function"==typeof s?t.call(this,i,n,function(t,e,i){var n;null===(n=o)||void 0===n||n.finish(),s(t,e,i)}):"function"==typeof n?t.call(this,i,function(t,e,i){var s;null===(s=o)||void 0===s||s.finish(),n(t,e,i)}):t.call(this,i,n,s)}}):b.a.error("Mysql Integration was unable to require `mysql` package.")},t.id="Mysql",t}(),ir=["aggregate","bulkWrite","countDocuments","createIndex","createIndexes","deleteMany","deleteOne","distinct","drop","dropIndex","dropIndexes","estimatedDocumentCount","find","findOne","findOneAndDelete","findOneAndReplace","findOneAndUpdate","indexes","indexExists","indexInformation","initializeOrderedBulkOp","insertMany","insertOne","isCapped","mapReduce","options","parallelCollectionScan","rename","replaceOne","stats","updateMany","updateOne"],nr={bulkWrite:["operations"],countDocuments:["query"],createIndex:["fieldOrSpec"],createIndexes:["indexSpecs"],deleteMany:["filter"],deleteOne:["filter"],distinct:["key","query"],dropIndex:["indexName"],find:["query"],findOne:["query"],findOneAndDelete:["filter"],findOneAndReplace:["filter","replacement"],findOneAndUpdate:["filter","update"],indexExists:["indexes"],insertMany:["docs"],insertOne:["doc"],mapReduce:["map","reduce"],rename:["newName"],replaceOne:["filter","doc"],updateMany:["filter","update"],updateOne:["filter","update"]},sr=function(){function t(e){void 0===e&&(e={}),this.name=t.id,this._operations=Array.isArray(e.operations)?e.operations:ir,this._describeOperations=!("describeOperations"in e)||e.describeOperations,this._useMongoose=!!e.useMongoose}return t.prototype.setupOnce=function(t,e){var i=this._useMongoose?"mongoose":"mongodb",n=Object(Qa.c)(i);n?this._instrumentOperations(n.Collection,this._operations,e):b.a.error("Mongo Integration was unable to require `"+i+"` package.")},t.prototype._instrumentOperations=function(t,e,i){var n=this;e.forEach(function(e){return n._patchOperation(t,e,i)})},t.prototype._patchOperation=function(t,e,i){if(e in t.prototype){var n=this._getSpanContextFromOperationArguments.bind(this);Object(R.c)(t.prototype,e,function(t){return function(){for(var s,a,r,o,c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];var d=c[c.length-1],h=i().getScope(),b=null===(s=h)||void 0===s?void 0:s.getSpan();if("function"!=typeof d||"mapReduce"===e&&2===c.length){var m=null===(a=b)||void 0===a?void 0:a.startChild(n(this,e,c)),p=t.call.apply(t,Object(l.f)([this],c));return Object(C.m)(p)?p.then(function(t){var e;return null===(e=m)||void 0===e||e.finish(),t}):(null===(r=m)||void 0===r||r.finish(),p)}var g=null===(o=b)||void 0===o?void 0:o.startChild(n(this,e,c.slice(0,-1)));return t.call.apply(t,Object(l.f)([this],c.slice(0,-1),[function(t,e){var i;null===(i=g)||void 0===i||i.finish(),d(t,e)}]))}})}},t.prototype._getSpanContextFromOperationArguments=function(t,e,i){var n={collectionName:t.collectionName,dbName:t.dbName,namespace:t.namespace},s={op:"db",description:e,data:n},a=nr[e],r=Array.isArray(this._describeOperations)?this._describeOperations.includes(e):this._describeOperations;if(!a||!r)return s;try{if("mapReduce"===e){var o=Object(l.d)(i,2),c=o[0],u=o[1];n[a[0]]="string"==typeof c?c:c.name||"<anonymous>",n[a[1]]="string"==typeof u?u:u.name||"<anonymous>"}else for(var d=0;d<a.length;d++)n[a[d]]=JSON.stringify(i[d])}catch(h){}return s},t.id="Mongo",t}(),ar=Object(l.a)(Object(l.a)({},a),{BrowserTracing:Wa});function rr(t,e){for(var i=0,n=t.length-1;n>=0;n--){var s=t[n];"."===s?t.splice(n,1):".."===s?(t.splice(n,1),i++):i&&(t.splice(n,1),i--)}if(e)for(;i--;i)t.unshift("..");return t}Object(Ta.a)();var or=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^/]+?|)(\.[^./]*|))(?:[/]*)$/;function cr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i="",n=!1,s=t.length-1;s>=-1&&!n;s--){var a=s>=0?t[s]:"/";a&&(i=a+"/"+i,n="/"===a.charAt(0))}return(n?"/":"")+(i=rr(i.split("/").filter(function(t){return!!t}),!n).join("/"))||"."}function lr(t){for(var e=0;e<t.length&&""===t[e];e++);for(var i=t.length-1;i>=0&&""===t[i];i--);return e>i?[]:t.slice(e,i-e+1)}var ur=function(){function t(e){var i=this;void 0===e&&(e={}),this.name=t.id,this._prefix="app:///",this._iteratee=function(t){if(!t.filename)return t;var e=/^[A-Z]:\\/.test(t.filename),n=/^\//.test(t.filename);if(e||n){var s=e?t.filename.replace(/^[A-Z]:/,"").replace(/\\/g,"/"):t.filename,a=i._root?function(t,e){t=cr(t).substr(1),e=cr(e).substr(1);for(var i=lr(t.split("/")),n=lr(e.split("/")),s=Math.min(i.length,n.length),a=s,r=0;r<s;r++)if(i[r]!==n[r]){a=r;break}var o=[];for(r=a;r<i.length;r++)o.push("..");return(o=o.concat(n.slice(a))).join("/")}(i._root,s):function(t){var e=or.exec(t);return e?e.slice(1):[]}(s)[2];t.filename=""+i._prefix+a}return t},e.root&&(this._root=e.root),e.prefix&&(this._prefix=e.prefix),e.iteratee&&(this._iteratee=e.iteratee)}return t.prototype.setupOnce=function(e,i){e(function(e){var n=i().getIntegration(t);return n?n.process(e):e})},t.prototype.process=function(t){var e=t;return t.exception&&Array.isArray(t.exception.values)&&(e=this._processExceptionsEvent(e)),t.stacktrace&&(e=this._processStacktraceEvent(e)),e},t.prototype._processExceptionsEvent=function(t){var e=this;try{return Object(l.a)(Object(l.a)({},t),{exception:Object(l.a)(Object(l.a)({},t.exception),{values:t.exception.values.map(function(t){return Object(l.a)(Object(l.a)({},t),{stacktrace:e._processStacktrace(t.stacktrace)})})})})}catch(i){return t}},t.prototype._processStacktraceEvent=function(t){try{return Object(l.a)(Object(l.a)({},t),{stacktrace:this._processStacktrace(t.stacktrace)})}catch(e){return t}},t.prototype._processStacktrace=function(t){var e=this;return Object(l.a)(Object(l.a)({},t),{frames:t&&t.frames&&t.frames.map(function(t){return e._iteratee(t)})})},t.id="RewriteFrames",t}(),dr=i("kiQV");class hr extends class extends class{}{constructor(){super()}supportsDOMEvents(){return!0}}{static makeCurrent(){var t;t=new hr,Rt||(Rt=t)}getProperty(t,e){return t[e]}log(t){window.console&&window.console.log&&window.console.log(t)}logGroup(t){window.console&&window.console.group&&window.console.group(t)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}onAndCancel(t,e,i){return t.addEventListener(e,i,!1),()=>{t.removeEventListener(e,i,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){return t.parentNode&&t.parentNode.removeChild(t),t}getValue(t){return t.value}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(t){const e=mr||(mr=document.querySelector("base"),mr)?mr.getAttribute("href"):null;return null==e?null:(i=e,br||(br=document.createElement("a")),br.setAttribute("href",i),"/"===br.pathname.charAt(0)?br.pathname:"/"+br.pathname);var i}resetBaseElement(){mr=null}getUserAgent(){return window.navigator.userAgent}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(t){return function(t,e){e=encodeURIComponent(e);for(const i of t.split(";")){const t=i.indexOf("="),[n,s]=-1==t?[i,""]:[i.slice(0,t),i.slice(t+1)];if(n.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,t)}}let br,mr=null;const pr=new o.s("TRANSITION_ID"),gr=[{provide:o.d,useFactory:function(t,e,i){return()=>{i.get(o.e).donePromise.then(()=>{const i=Ot();Array.prototype.slice.apply(e.querySelectorAll("style[ng-transition]")).filter(e=>e.getAttribute("ng-transition")===t).forEach(t=>i.remove(t))})}},deps:[pr,Tt,o.t],multi:!0}];class fr{static init(){Object(o.Z)(new fr)}addToWindow(t){o.qb.getAngularTestability=(e,i=!0)=>{const n=t.findTestabilityInTree(e,i);if(null==n)throw new Error("Could not find testability for element.");return n},o.qb.getAllAngularTestabilities=()=>t.getAllTestabilities(),o.qb.getAllAngularRootElements=()=>t.getAllRootElements(),o.qb.frameworkStabilizers||(o.qb.frameworkStabilizers=[]),o.qb.frameworkStabilizers.push(t=>{const e=o.qb.getAllAngularTestabilities();let i=e.length,n=!1;const s=function(e){n=n||e,i--,0==i&&t(n)};e.forEach(function(t){t.whenStable(s)})})}findTestabilityInTree(t,e,i){if(null==e)return null;const n=t.getTestability(e);return null!=n?n:i?Ot().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}const vr=new o.s("EventManagerPlugins");let yr=(()=>{class t{constructor(t,e){this._zone=e,this._eventNameToPlugin=new Map,t.forEach(t=>t.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,e,i){return this._findPluginFor(e).addEventListener(t,e,i)}addGlobalEventListener(t,e,i){return this._findPluginFor(e).addGlobalEventListener(t,e,i)}getZone(){return this._zone}_findPluginFor(t){const e=this._eventNameToPlugin.get(t);if(e)return e;const i=this._plugins;for(let n=0;n<i.length;n++){const e=i[n];if(e.supports(t))return this._eventNameToPlugin.set(t,e),e}throw new Error("No event manager plugin found for event "+t)}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(vr),o.Vb(o.D))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})();class _r{constructor(t){this._doc=t}addGlobalEventListener(t,e,i){const n=Ot().getGlobalEventTarget(this._doc,t);if(!n)throw new Error(`Unsupported event target ${n} for event ${e}`);return this.addEventListener(n,e,i)}}let kr=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(t){const e=new Set;t.forEach(t=>{this._stylesSet.has(t)||(this._stylesSet.add(t),e.add(t))}),this.onStylesAdded(e)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})(),wr=(()=>{class t extends kr{constructor(t){super(),this._doc=t,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(t.head)}_addStylesToHost(t,e){t.forEach(t=>{const i=this._doc.createElement("style");i.textContent=t,this._styleNodes.add(e.appendChild(i))})}addHost(t){this._addStylesToHost(this._stylesSet,t),this._hostNodes.add(t)}removeHost(t){this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach(e=>this._addStylesToHost(t,e))}ngOnDestroy(){this._styleNodes.forEach(t=>Ot().remove(t))}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(Tt))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})();const Sr={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Ir=/%COMP%/g;function Cr(t,e,i){for(let n=0;n<e.length;n++){let s=e[n];Array.isArray(s)?Cr(t,s,i):(s=s.replace(Ir,t),i.push(s))}return i}function Lr(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let Rr=(()=>{class t{constructor(t,e,i){this.eventManager=t,this.sharedStylesHost=e,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new Or(t)}createRenderer(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case o.T.Emulated:{let i=this.rendererByCompId.get(e.id);return i||(i=new Tr(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,i)),i.applyToHost(t),i}case 1:case o.T.ShadowDom:return new xr(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){const t=Cr(e.id,e.styles,[]);this.sharedStylesHost.addStyles(t),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(yr),o.Vb(wr),o.Vb(o.c))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})();class Or{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(Sr[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,i){t&&t.insertBefore(e,i)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let i="string"==typeof t?document.querySelector(t):t;if(!i)throw new Error(`The selector "${t}" did not match any elements`);return e||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,i,n){if(n){e=n+":"+e;const s=Sr[n];s?t.setAttributeNS(s,e,i):t.setAttribute(e,i)}else t.setAttribute(e,i)}removeAttribute(t,e,i){if(i){const n=Sr[i];n?t.removeAttributeNS(n,e):t.removeAttribute(`${i}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,i,n){n&(o.J.DashCase|o.J.Important)?t.style.setProperty(e,i,n&o.J.Important?"important":""):t.style[e]=i}removeStyle(t,e,i){i&o.J.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,i){t[e]=i}setValue(t,e){t.nodeValue=e}listen(t,e,i){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,Lr(i)):this.eventManager.addEventListener(t,e,Lr(i))}}class Tr extends Or{constructor(t,e,i,n){super(t),this.component=i;const s=Cr(n+"-"+i.id,i.styles,[]);e.addStyles(s),this.contentAttr="_ngcontent-%COMP%".replace(Ir,n+"-"+i.id),this.hostAttr="_nghost-%COMP%".replace(Ir,n+"-"+i.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const i=super.createElement(t,e);return super.setAttribute(i,this.contentAttr,""),i}}class xr extends Or{constructor(t,e,i,n){super(t),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=Cr(n.id,n.styles,[]);for(let a=0;a<s.length;a++){const t=document.createElement("style");t.textContent=s[a],this.shadowRoot.appendChild(t)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,i){return super.insertBefore(this.nodeOrShadowRoot(t),e,i)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let Br=(()=>{class t extends _r{constructor(t){super(t)}supports(t){return!0}addEventListener(t,e,i){return t.addEventListener(e,i,!1),()=>this.removeEventListener(t,e,i)}removeEventListener(t,e,i){return t.removeEventListener(e,i)}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(Tt))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})();const jr=["alt","control","meta","shift"],Mr={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Qr={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Ar={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let Dr=(()=>{class t extends _r{constructor(t){super(t)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,i,n){const s=t.parseEventName(i),a=t.eventCallback(s.fullKey,n,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ot().onAndCancel(e,s.domEventName,a))}static parseEventName(e){const i=e.toLowerCase().split("."),n=i.shift();if(0===i.length||"keydown"!==n&&"keyup"!==n)return null;const s=t._normalizeKey(i.pop());let a="";if(jr.forEach(t=>{const e=i.indexOf(t);e>-1&&(i.splice(e,1),a+=t+".")}),a+=s,0!=i.length||0===s.length)return null;const r={};return r.domEventName=n,r.fullKey=a,r}static getEventFullKey(t){let e="",i=function(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&Qr.hasOwnProperty(e)&&(e=Qr[e]))}return Mr[e]||e}(t);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),jr.forEach(n=>{n!=i&&(0,Ar[n])(t)&&(e+=n+".")}),e+=i,e}static eventCallback(e,i,n){return s=>{t.getEventFullKey(s)===e&&n.runGuarded(()=>i(s))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(Tt))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})(),Er=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Object(o.Jb)({factory:function(){return Object(o.Vb)(Nr)},token:t,providedIn:"root"}),t})(),Nr=(()=>{class t extends Er{constructor(t){super(),this._doc=t}sanitize(t,e){if(null==e)return null;switch(t){case o.L.NONE:return e;case o.L.HTML:return Object(o.fb)(e,"HTML")?Object(o.xb)(e):Object(o.db)(this._doc,String(e));case o.L.STYLE:return Object(o.fb)(e,"Style")?Object(o.xb)(e):e;case o.L.SCRIPT:if(Object(o.fb)(e,"Script"))return Object(o.xb)(e);throw new Error("unsafe value used in a script context");case o.L.URL:return Object(o.pb)(e),Object(o.fb)(e,"URL")?Object(o.xb)(e):Object(o.eb)(String(e));case o.L.RESOURCE_URL:if(Object(o.fb)(e,"ResourceURL"))return Object(o.xb)(e);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${t} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(t){return Object(o.gb)(t)}bypassSecurityTrustStyle(t){return Object(o.jb)(t)}bypassSecurityTrustScript(t){return Object(o.ib)(t)}bypassSecurityTrustUrl(t){return Object(o.kb)(t)}bypassSecurityTrustResourceUrl(t){return Object(o.hb)(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(Tt))},t.\u0275prov=Object(o.Jb)({factory:function(){return t=Object(o.Vb)(o.p),new Nr(t.get(Tt));var t},token:t,providedIn:"root"}),t})();const Fr=[{provide:o.F,useValue:"browser"},{provide:o.G,useValue:function(){hr.makeCurrent(),fr.init()},multi:!0},{provide:Tt,useFactory:function(){return Object(o.vb)(document),document},deps:[]}],Pr=Object(o.U)(o.Y,"browser",Fr),Ur=[[],{provide:o.bb,useValue:"root"},{provide:o.n,useFactory:function(){return new o.n},deps:[]},{provide:vr,useClass:Br,multi:!0,deps:[Tt,o.D,o.F]},{provide:vr,useClass:Dr,multi:!0,deps:[Tt]},[],{provide:Rr,useClass:Rr,deps:[yr,wr,o.c]},{provide:o.I,useExisting:Rr},{provide:kr,useExisting:wr},{provide:wr,useClass:wr,deps:[Tt]},{provide:o.P,useClass:o.P,deps:[o.D]},{provide:yr,useClass:yr,deps:[vr,o.D]},[]];let zr=(()=>{class t{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:o.c,useValue:e.appId},{provide:pr,useExisting:o.c},gr]}}}return t.\u0275mod=o.Lb({type:t}),t.\u0275inj=o.Kb({factory:function(e){return new(e||t)(o.Vb(t,12))},providers:Ur,imports:[ue,o.f]}),t})();"undefined"!=typeof window&&window;var Jr=i("XoHu");function qr(t,e){return new Re.a(i=>{const n=t.length;if(0===n)return void i.complete();const s=new Array(n);let a=0,r=0;for(let o=0;o<n;o++){const c=Object(me.a)(t[o]);let l=!1;i.add(c.subscribe({next:t=>{l||(l=!0,r++),s[o]=t},error:t=>i.error(t),complete:()=>{a++,a!==n&&l||(r===n&&i.next(e?e.reduce((t,e,i)=>(t[e]=s[i],t),{}):s),i.complete())}}))}})}const Vr=new o.s("NgValueAccessor"),$r={provide:Vr,useExisting:Object(o.W)(()=>Gr),multi:!0};let Gr=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"checked",t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.H),o.Nb(o.m))},t.\u0275dir=o.Ib({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,e){1&t&&o.Yb("change",function(t){return e.onChange(t.target.checked)})("blur",function(){return e.onTouched()})},features:[o.Ab([$r])]}),t})();const Hr={provide:Vr,useExisting:Object(o.W)(()=>Wr),multi:!0},Yr=new o.s("CompositionEventMode");let Wr=(()=>{class t{constructor(t,e,i){this._renderer=t,this._elementRef=e,this._compositionMode=i,this.onChange=t=>{},this.onTouched=()=>{},this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const t=Ot()?Ot().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.H),o.Nb(o.m),o.Nb(Yr,8))},t.\u0275dir=o.Ib({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,e){1&t&&o.Yb("input",function(t){return e._handleInput(t.target.value)})("blur",function(){return e.onTouched()})("compositionstart",function(){return e._compositionStart()})("compositionend",function(t){return e._compositionEnd(t.target.value)})},features:[o.Ab([Hr])]}),t})();function Kr(t){return null==t||0===t.length}function Xr(t){return null!=t&&"number"==typeof t.length}const Zr=new o.s("NgValidators"),to=new o.s("NgAsyncValidators"),eo=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class io{static min(t){return e=>{if(Kr(e.value)||Kr(t))return null;const i=parseFloat(e.value);return!isNaN(i)&&i<t?{min:{min:t,actual:e.value}}:null}}static max(t){return e=>{if(Kr(e.value)||Kr(t))return null;const i=parseFloat(e.value);return!isNaN(i)&&i>t?{max:{max:t,actual:e.value}}:null}}static required(t){return Kr(t.value)?{required:!0}:null}static requiredTrue(t){return!0===t.value?null:{required:!0}}static email(t){return Kr(t.value)||eo.test(t.value)?null:{email:!0}}static minLength(t){return e=>Kr(e.value)||!Xr(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}static maxLength(t){return e=>Xr(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}static pattern(t){if(!t)return io.nullValidator;let e,i;return"string"==typeof t?(i="","^"!==t.charAt(0)&&(i+="^"),i+=t,"$"!==t.charAt(t.length-1)&&(i+="$"),e=new RegExp(i)):(i=t.toString(),e=t),t=>{if(Kr(t.value))return null;const n=t.value;return e.test(n)?null:{pattern:{requiredPattern:i,actualValue:n}}}}static nullValidator(t){return null}static compose(t){if(!t)return null;const e=t.filter(no);return 0==e.length?null:function(t){return ao(ro(t,e))}}static composeAsync(t){if(!t)return null;const e=t.filter(no);return 0==e.length?null:function(t){return function(...t){if(1===t.length){const e=t[0];if(Object(we.a)(e))return qr(e,null);if(Object(Jr.a)(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return qr(t.map(t=>e[t]),t)}}if("function"==typeof t[t.length-1]){const e=t.pop();return qr(t=1===t.length&&Object(we.a)(t[0])?t[0]:t,null).pipe(Object(Ne.a)(t=>e(...t)))}return qr(t,null)}(ro(t,e).map(so)).pipe(Object(Ne.a)(ao))}}}function no(t){return null!=t}function so(t){const e=Object(o.tb)(t)?Object(me.a)(t):t;return Object(o.sb)(e),e}function ao(t){let e={};return t.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function ro(t,e){return e.map(e=>e(t))}function oo(t){return t.map(t=>function(t){return!t.validate}(t)?t:e=>t.validate(e))}function co(t){return null!=t?io.compose(oo(t)):null}function lo(t){return null!=t?io.composeAsync(oo(t)):null}function uo(t,e){return null===t?[e]:Array.isArray(t)?[...t,e]:[t,e]}function ho(t){return t._rawValidators}function bo(t){return t._rawAsyncValidators}let mo=(()=>{class t{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=co(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=lo(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=o.Ib({type:t}),t})(),po=(()=>{class t extends mo{get formDirective(){return null}get path(){return null}}return t.\u0275fac=function(e){return go(e||t)},t.\u0275dir=o.Ib({type:t,features:[o.yb]}),t})();const go=o.Tb(po);class fo extends mo{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class vo{constructor(t){this._cd=t}get ngClassUntouched(){var t,e,i;return null!==(i=null===(e=null===(t=this._cd)||void 0===t?void 0:t.control)||void 0===e?void 0:e.untouched)&&void 0!==i&&i}get ngClassTouched(){var t,e,i;return null!==(i=null===(e=null===(t=this._cd)||void 0===t?void 0:t.control)||void 0===e?void 0:e.touched)&&void 0!==i&&i}get ngClassPristine(){var t,e,i;return null!==(i=null===(e=null===(t=this._cd)||void 0===t?void 0:t.control)||void 0===e?void 0:e.pristine)&&void 0!==i&&i}get ngClassDirty(){var t,e,i;return null!==(i=null===(e=null===(t=this._cd)||void 0===t?void 0:t.control)||void 0===e?void 0:e.dirty)&&void 0!==i&&i}get ngClassValid(){var t,e,i;return null!==(i=null===(e=null===(t=this._cd)||void 0===t?void 0:t.control)||void 0===e?void 0:e.valid)&&void 0!==i&&i}get ngClassInvalid(){var t,e,i;return null!==(i=null===(e=null===(t=this._cd)||void 0===t?void 0:t.control)||void 0===e?void 0:e.invalid)&&void 0!==i&&i}get ngClassPending(){var t,e,i;return null!==(i=null===(e=null===(t=this._cd)||void 0===t?void 0:t.control)||void 0===e?void 0:e.pending)&&void 0!==i&&i}}let yo=(()=>{class t extends vo{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(fo,2))},t.\u0275dir=o.Ib({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,e){2&t&&o.Fb("ng-untouched",e.ngClassUntouched)("ng-touched",e.ngClassTouched)("ng-pristine",e.ngClassPristine)("ng-dirty",e.ngClassDirty)("ng-valid",e.ngClassValid)("ng-invalid",e.ngClassInvalid)("ng-pending",e.ngClassPending)},features:[o.yb]}),t})(),_o=(()=>{class t extends vo{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(po,10))},t.\u0275dir=o.Ib({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(t,e){2&t&&o.Fb("ng-untouched",e.ngClassUntouched)("ng-touched",e.ngClassTouched)("ng-pristine",e.ngClassPristine)("ng-dirty",e.ngClassDirty)("ng-valid",e.ngClassValid)("ng-invalid",e.ngClassInvalid)("ng-pending",e.ngClassPending)},features:[o.yb]}),t})();const ko={provide:Vr,useExisting:Object(o.W)(()=>wo),multi:!0};let wo=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=e=>{t(""==e?null:parseFloat(e))}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.H),o.Nb(o.m))},t.\u0275dir=o.Ib({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(t,e){1&t&&o.Yb("input",function(t){return e.onChange(t.target.value)})("blur",function(){return e.onTouched()})},features:[o.Ab([ko])]}),t})();const So={provide:Vr,useExisting:Object(o.W)(()=>Co),multi:!0};let Io=(()=>{class t{constructor(){this._accessors=[]}add(t,e){this._accessors.push([t,e])}remove(t){for(let e=this._accessors.length-1;e>=0;--e)if(this._accessors[e][1]===t)return void this._accessors.splice(e,1)}select(t){this._accessors.forEach(e=>{this._isSameGroup(e,t)&&e[1]!==t&&e[1].fireUncheck(t.value)})}_isSameGroup(t,e){return!!t[0].control&&t[0]._parent===e._control._parent&&t[1].name===e.name}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})(),Co=(()=>{class t{constructor(t,e,i,n){this._renderer=t,this._elementRef=e,this._registry=i,this._injector=n,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){this._control=this._injector.get(fo),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(t){this._state=t===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}registerOnChange(t){this._fn=t,this.onChange=()=>{t(this.value),this._registry.select(this)}}fireUncheck(t){this.writeValue(t)}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.H),o.Nb(o.m),o.Nb(Io),o.Nb(o.t))},t.\u0275dir=o.Ib({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(t,e){1&t&&o.Yb("change",function(){return e.onChange()})("blur",function(){return e.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[o.Ab([So])]}),t})();const Lo={provide:Vr,useExisting:Object(o.W)(()=>Ro),multi:!0};let Ro=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(t))}registerOnChange(t){this.onChange=e=>{t(""==e?null:parseFloat(e))}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.H),o.Nb(o.m))},t.\u0275dir=o.Ib({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(t,e){1&t&&o.Yb("change",function(t){return e.onChange(t.target.value)})("input",function(t){return e.onChange(t.target.value)})("blur",function(){return e.onTouched()})},features:[o.Ab([Lo])]}),t})();const Oo={provide:Vr,useExisting:Object(o.W)(()=>xo),multi:!0};function To(t,e){return null==t?""+e:(e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}let xo=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const e=this._getOptionId(t);null==e&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);const i=To(e,t);this._renderer.setProperty(this._elementRef.nativeElement,"value",i)}registerOnChange(t){this.onChange=e=>{this.value=this._getOptionValue(e),t(this.value)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e),t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e):t}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.H),o.Nb(o.m))},t.\u0275dir=o.Ib({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,e){1&t&&o.Yb("change",function(t){return e.onChange(t.target.value)})("blur",function(){return e.onTouched()})},inputs:{compareWith:"compareWith"},features:[o.Ab([Oo])]}),t})(),Bo=(()=>{class t{constructor(t,e,i){this._element=t,this._renderer=e,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(To(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m),o.Nb(o.H),o.Nb(xo,9))},t.\u0275dir=o.Ib({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();const jo={provide:Vr,useExisting:Object(o.W)(()=>Qo),multi:!0};function Mo(t,e){return null==t?""+e:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}let Qo=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let e;if(this.value=t,Array.isArray(t)){const i=t.map(t=>this._getOptionId(t));e=(t,e)=>{t._setSelected(i.indexOf(e.toString())>-1)}}else e=(t,e)=>{t._setSelected(!1)};this._optionMap.forEach(e)}registerOnChange(t){this.onChange=e=>{const i=[];if(void 0!==e.selectedOptions){const t=e.selectedOptions;for(let e=0;e<t.length;e++){const n=t.item(e),s=this._getOptionValue(n.value);i.push(s)}}else{const t=e.options;for(let e=0;e<t.length;e++){const n=t.item(e);if(n.selected){const t=this._getOptionValue(n.value);i.push(t)}}}this.value=i,t(i)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(t){const e=(this._idCounter++).toString();return this._optionMap.set(e,t),e}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e)._value,t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e)._value:t}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.H),o.Nb(o.m))},t.\u0275dir=o.Ib({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,e){1&t&&o.Yb("change",function(t){return e.onChange(t.target)})("blur",function(){return e.onTouched()})},inputs:{compareWith:"compareWith"},features:[o.Ab([jo])]}),t})(),Ao=(()=>{class t{constructor(t,e,i){this._element=t,this._renderer=e,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(Mo(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(Mo(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m),o.Nb(o.H),o.Nb(Qo,9))},t.\u0275dir=o.Ib({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();function Do(t,e){return[...e.path,t]}function Eo(t,e){Fo(t,e,!0),e.valueAccessor.writeValue(t.value),function(t,e){e.valueAccessor.registerOnChange(i=>{t._pendingValue=i,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&Uo(t,e)})}(t,e),function(t,e){const i=(t,i)=>{e.valueAccessor.writeValue(t),i&&e.viewToModelUpdate(t)};t.registerOnChange(i),e._registerOnDestroy(()=>{t._unregisterOnChange(i)})}(t,e),function(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&Uo(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),function(t,e){if(e.valueAccessor.setDisabledState){const i=t=>{e.valueAccessor.setDisabledState(t)};t.registerOnDisabledChange(i),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(i)})}}(t,e)}function No(t,e){t.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function Fo(t,e,i){const n=ho(t);null!==e.validator?t.setValidators(uo(n,e.validator)):"function"==typeof n&&t.setValidators([n]);const s=bo(t);if(null!==e.asyncValidator?t.setAsyncValidators(uo(s,e.asyncValidator)):"function"==typeof s&&t.setAsyncValidators([s]),i){const i=()=>t.updateValueAndValidity();No(e._rawValidators,i),No(e._rawAsyncValidators,i)}}function Po(t,e,i){if(null!==t){if(null!==e.validator){const i=ho(t);Array.isArray(i)&&i.length>0&&t.setValidators(i.filter(t=>t!==e.validator))}if(null!==e.asyncValidator){const i=bo(t);Array.isArray(i)&&i.length>0&&t.setAsyncValidators(i.filter(t=>t!==e.asyncValidator))}}if(i){const t=()=>{};No(e._rawValidators,t),No(e._rawAsyncValidators,t)}}function Uo(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function zo(t,e){Fo(t,e,!1)}function Jo(t,e){if(!t.hasOwnProperty("model"))return!1;const i=t.model;return!!i.isFirstChange()||!Object.is(e,i.currentValue)}const qo=[Gr,Ro,wo,xo,Qo,Co];function Vo(t,e){t._syncPendingControls(),e.forEach(t=>{const e=t.control;"submit"===e.updateOn&&e._pendingChange&&(t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1)})}function $o(t,e){if(!e)return null;Array.isArray(e);let i=void 0,n=void 0,s=void 0;return e.forEach(t=>{var e;t.constructor===Wr?i=t:(e=t,qo.some(t=>e.constructor===t)?n=t:s=t)}),s||n||i||null}function Go(t,e){const i=t.indexOf(e);i>-1&&t.splice(i,1)}const Ho="VALID",Yo="INVALID",Wo="PENDING",Ko="DISABLED";function Xo(t){return(ic(t)?t.validators:t)||null}function Zo(t){return Array.isArray(t)?co(t):t||null}function tc(t,e){return(ic(e)?e.asyncValidators:t)||null}function ec(t){return Array.isArray(t)?lo(t):t||null}function ic(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class nc{constructor(t,e){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=Zo(this._rawValidators),this._composedAsyncValidatorFn=ec(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===Ho}get invalid(){return this.status===Yo}get pending(){return this.status==Wo}get disabled(){return this.status===Ko}get enabled(){return this.status!==Ko}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=Zo(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=ec(t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=Wo,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Ko,this.errors=null,this._forEachChild(e=>{e.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Ho,this._forEachChild(e=>{e.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),this.status!==Ho&&this.status!==Wo||this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Ko:Ho}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=Wo,this._hasOwnPendingAsyncValidator=!0;const e=so(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(e=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(e,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function(t,e,i){if(null==e)return null;if(Array.isArray(e)||(e=e.split(".")),Array.isArray(e)&&0===e.length)return null;let n=t;return e.forEach(t=>{n=n instanceof ac?n.controls.hasOwnProperty(t)?n.controls[t]:null:n instanceof rc&&n.at(t)||null}),n}(this,t)}getError(t,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new o.o,this.statusChanges=new o.o}_calculateStatus(){return this._allControlsDisabled()?Ko:this.errors?Yo:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Wo)?Wo:this._anyControlsHaveStatus(Yo)?Yo:Ho}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){ic(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class sc extends nc{constructor(t=null,e,i){super(Xo(e),tc(i,e)),this._onChange=[],this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!i})}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(t=>t(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=null,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){Go(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){Go(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class ac extends nc{constructor(t,e,i){super(Xo(e),tc(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!i})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e){this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}removeControl(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity(),this._onCollectionChange()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){this._checkAllValuesPresent(t),Object.keys(t).forEach(i=>{this._throwIfControlMissing(i),this.controls[i].setValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){Object.keys(t).forEach(i=>{this.controls[i]&&this.controls[i].patchValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t={},e={}){this._forEachChild((i,n)=>{i.reset(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,i)=>(t[i]=e instanceof sc?e.value:e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(t,e)=>!!e._syncPendingControls()||t);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error(`Cannot find form control with name: ${t}.`)}_forEachChild(t){Object.keys(this.controls).forEach(e=>t(this.controls[e],e))}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const e of Object.keys(this.controls)){const i=this.controls[e];if(this.contains(e)&&t(i))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,e,i)=>((e.enabled||this.disabled)&&(t[i]=e.value),t))}_reduceChildren(t,e){let i=t;return this._forEachChild((t,n)=>{i=e(i,t,n)}),i}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(t){this._forEachChild((e,i)=>{if(void 0===t[i])throw new Error(`Must supply a value for form control with name: '${i}'.`)})}}class rc extends nc{constructor(t,e,i){super(Xo(e),tc(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!i})}at(t){return this.controls[t]}push(t){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity(),this._onCollectionChange()}insert(t,e){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity()}removeAt(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity(),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){this._checkAllValuesPresent(t),t.forEach((t,i)=>{this._throwIfControlMissing(i),this.at(i).setValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t.forEach((t,i)=>{this.at(i)&&this.at(i).patchValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t=[],e={}){this._forEachChild((i,n)=>{i.reset(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t instanceof sc?t.value:t.getRawValue())}clear(){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity())}_syncPendingControls(){let t=this.controls.reduce((t,e)=>!!e._syncPendingControls()||t,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error("Cannot find form control at index "+t)}_forEachChild(t){this.controls.forEach((e,i)=>{t(e,i)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_checkAllValuesPresent(t){this._forEachChild((e,i)=>{if(void 0===t[i])throw new Error(`Must supply a value for form control at index: ${i}.`)})}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const oc={provide:po,useExisting:Object(o.W)(()=>lc)},cc=(()=>Promise.resolve(null))();let lc=(()=>{class t extends po{constructor(t,e){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new o.o,this.form=new ac({},co(t),lo(e))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){cc.then(()=>{const e=this._findContainer(t.path);t.control=e.registerControl(t.name,t.control),Eo(t.control,t),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){cc.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name),Go(this._directives,t)})}addFormGroup(t){cc.then(()=>{const e=this._findContainer(t.path),i=new ac({});zo(i,t),e.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){cc.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,e){cc.then(()=>{this.form.get(t.path).setValue(e)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,Vo(this.form,this._directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Zr,10),o.Nb(to,10))},t.\u0275dir=o.Ib({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,e){1&t&&o.Yb("submit",function(t){return e.onSubmit(t)})("reset",function(){return e.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[o.Ab([oc]),o.yb]}),t})();const uc={provide:fo,useExisting:Object(o.W)(()=>hc)},dc=(()=>Promise.resolve(null))();let hc=(()=>{class t extends fo{constructor(t,e,i,n){super(),this.control=new sc,this._registered=!1,this.update=new o.o,this._parent=t,this._setValidators(e),this._setAsyncValidators(i),this.valueAccessor=$o(0,n)}ngOnChanges(t){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in t&&this._updateDisabled(t),Jo(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?Do(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Eo(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){dc.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1})})}_updateDisabled(t){const e=t.isDisabled.currentValue,i=""===e||e&&"false"!==e;dc.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable()})}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(po,9),o.Nb(Zr,10),o.Nb(to,10),o.Nb(Vr,10))},t.\u0275dir=o.Ib({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[o.Ab([uc]),o.yb,o.zb]}),t})(),bc=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=o.Ib({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})();const mc=new o.s("NgModelWithFormControlWarning"),pc={provide:po,useExisting:Object(o.W)(()=>gc)};let gc=(()=>{class t extends po{constructor(t,e){super(),this.validators=t,this.asyncValidators=e,this.submitted=!1,this.directives=[],this.form=null,this.ngSubmit=new o.o,this._setValidators(t),this._setAsyncValidators(e)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const e=this.form.get(t.path);return Eo(e,t),e.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),e}getControl(t){return this.form.get(t.path)}removeControl(t){Go(this.directives,t)}addFormGroup(t){const e=this.form.get(t.path);zo(e,t),e.updateValueAndValidity({emitEvent:!1})}removeFormGroup(t){}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){const e=this.form.get(t.path);zo(e,t),e.updateValueAndValidity({emitEvent:!1})}removeFormArray(t){}getFormArray(t){return this.form.get(t.path)}updateModel(t,e){this.form.get(t.path).setValue(e)}onSubmit(t){return this.submitted=!0,Vo(this.form,this.directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const e=this.form.get(t.path);t.control!==e&&(function(t,e){const i=()=>{};e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i),Po(t,e,!0),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}(t.control||null,t),e&&Eo(e,t),t.control=e)}),this.form._updateTreeValidity({emitEvent:!1})}_updateRegistrations(){this.form._registerOnCollectionChange(()=>this._updateDomValue()),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Fo(this.form,this,!1),this._oldForm&&Po(this._oldForm,this,!1)}_checkFormPresent(){}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Zr,10),o.Nb(to,10))},t.\u0275dir=o.Ib({type:t,selectors:[["","formGroup",""]],hostBindings:function(t,e){1&t&&o.Yb("submit",function(t){return e.onSubmit(t)})("reset",function(){return e.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[o.Ab([pc]),o.yb,o.zb]}),t})();const fc={provide:fo,useExisting:Object(o.W)(()=>vc)};let vc=(()=>{class t extends fo{constructor(t,e,i,n,s){super(),this._ngModelWarningConfig=s,this._added=!1,this.update=new o.o,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(e),this._setAsyncValidators(i),this.valueAccessor=$o(0,n)}set isDisabled(t){}ngOnChanges(t){this._added||this._setUpControl(),Jo(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return Do(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(po,13),o.Nb(Zr,10),o.Nb(to,10),o.Nb(Vr,10),o.Nb(mc,8))},t.\u0275dir=o.Ib({type:t,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[o.Ab([fc]),o.yb,o.zb]}),t._ngModelWarningSentOnce=!1,t})();const yc={provide:Zr,useExisting:Object(o.W)(()=>_c),multi:!0};let _c=(()=>{class t{constructor(){this._validator=io.nullValidator}ngOnChanges(t){"maxlength"in t&&(this._createValidator(),this._onChange&&this._onChange())}validate(t){return null!=this.maxlength?this._validator(t):null}registerOnValidatorChange(t){this._onChange=t}_createValidator(){this._validator=io.maxLength("number"==typeof this.maxlength?this.maxlength:parseInt(this.maxlength,10))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=o.Ib({type:t,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(t,e){2&t&&o.Cb("maxlength",e.maxlength?e.maxlength:null)},inputs:{maxlength:"maxlength"},features:[o.Ab([yc]),o.zb]}),t})();const kc={provide:Zr,useExisting:Object(o.W)(()=>wc),multi:!0};let wc=(()=>{class t{constructor(){this._validator=io.nullValidator}ngOnChanges(t){"pattern"in t&&(this._createValidator(),this._onChange&&this._onChange())}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}_createValidator(){this._validator=io.pattern(this.pattern)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=o.Ib({type:t,selectors:[["","pattern","","formControlName",""],["","pattern","","formControl",""],["","pattern","","ngModel",""]],hostVars:1,hostBindings:function(t,e){2&t&&o.Cb("pattern",e.pattern?e.pattern:null)},inputs:{pattern:"pattern"},features:[o.Ab([kc]),o.zb]}),t})(),Sc=(()=>{class t{}return t.\u0275mod=o.Lb({type:t}),t.\u0275inj=o.Kb({factory:function(e){return new(e||t)}}),t})(),Ic=(()=>{class t{group(t,e=null){const i=this._reduceControls(t);let n=null,s=null,a=void 0;return null!=e&&(function(t){return void 0!==t.asyncValidators||void 0!==t.validators||void 0!==t.updateOn}(e)?(n=null!=e.validators?e.validators:null,s=null!=e.asyncValidators?e.asyncValidators:null,a=null!=e.updateOn?e.updateOn:void 0):(n=null!=e.validator?e.validator:null,s=null!=e.asyncValidator?e.asyncValidator:null)),new ac(i,{asyncValidators:s,updateOn:a,validators:n})}control(t,e,i){return new sc(t,e,i)}array(t,e,i){const n=t.map(t=>this._createControl(t));return new rc(n,e,i)}_reduceControls(t){const e={};return Object.keys(t).forEach(i=>{e[i]=this._createControl(t[i])}),e}_createControl(t){return t instanceof sc||t instanceof ac||t instanceof rc?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})(),Cc=(()=>{class t{}return t.\u0275mod=o.Lb({type:t}),t.\u0275inj=o.Kb({factory:function(e){return new(e||t)},providers:[Io],imports:[Sc]}),t})(),Lc=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:mc,useValue:e.warnOnNgModelWithFormControl}]}}}return t.\u0275mod=o.Lb({type:t}),t.\u0275inj=o.Kb({factory:function(e){return new(e||t)},providers:[Ic,Io],imports:[Sc]}),t})();class Rc extends ki.a{constructor(t,e){super()}schedule(t,e=0){return this}}class Oc extends Rc{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const i=this.id,n=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(n,i,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this}requestAsyncId(t,e,i=0){return setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,e,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let i=!1,n=void 0;try{this.work(t)}catch(s){i=!0,n=!!s&&s||new Error(s)}if(i)return this.unsubscribe(),n}_unsubscribe(){const t=this.id,e=this.scheduler,i=e.actions,n=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&i.splice(n,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}class Tc extends Oc{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,i=0){return null!==i&&i>0||null===i&&this.delay>0?super.requestAsyncId(t,e,i):t.flush(this)}}let xc=(()=>{class t{constructor(e,i=t.now){this.SchedulerAction=e,this.now=i}schedule(t,e=0,i){return new this.SchedulerAction(this,t).schedule(i,e)}}return t.now=()=>Date.now(),t})();class Bc extends xc{constructor(t,e=xc.now){super(t,()=>Bc.delegate&&Bc.delegate!==this?Bc.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,i){return Bc.delegate&&Bc.delegate!==this?Bc.delegate.schedule(t,e,i):super.schedule(t,e,i)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let i;this.active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}}class jc extends Bc{}const Mc=new jc(Tc);let Qc=(()=>{class t{constructor(t,e,i){this.kind=t,this.value=e,this.error=i,this.hasValue="N"===t}observe(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}}do(t,e,i){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return i&&i()}}accept(t,e,i){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,i)}toObservable(){switch(this.kind){case"N":return ve(this.value);case"E":return t=this.error,new Re.a(e=>e.error(t));case"C":return De()}var t;throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new t("N",e):t.undefinedValueNotification}static createError(e){return new t("E",void 0,e)}static createComplete(){return t.completeNotification}}return t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t})();class Ac extends Se.a{constructor(t,e,i=0){super(t),this.scheduler=e,this.delay=i}static dispatch(t){const{notification:e,destination:i}=t;e.observe(i),this.unsubscribe()}scheduleMessage(t){this.destination.add(this.scheduler.schedule(Ac.dispatch,this.delay,new Dc(t,this.destination)))}_next(t){this.scheduleMessage(Qc.createNext(t))}_error(t){this.scheduleMessage(Qc.createError(t)),this.unsubscribe()}_complete(){this.scheduleMessage(Qc.createComplete()),this.unsubscribe()}}class Dc{constructor(t,e){this.notification=t,this.destination=e}}var Ec=i("Ylt2");class Nc extends ye.a{constructor(t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,i){super(),this.scheduler=i,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=t<1?1:t,this._windowTime=e<1?1:e,e===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(t){if(!this.isStopped){const e=this._events;e.push(t),e.length>this._bufferSize&&e.shift()}super.next(t)}nextTimeWindow(t){this.isStopped||(this._events.push(new Fc(this._getNow(),t)),this._trimBufferThenGetEvents()),super.next(t)}_subscribe(t){const e=this._infiniteTimeWindow,i=e?this._events:this._trimBufferThenGetEvents(),n=this.scheduler,s=i.length;let a;if(this.closed)throw new _e.a;if(this.isStopped||this.hasError?a=ki.a.EMPTY:(this.observers.push(t),a=new Ec.a(this,t)),n&&t.add(t=new Ac(t,n)),e)for(let r=0;r<s&&!t.closed;r++)t.next(i[r]);else for(let r=0;r<s&&!t.closed;r++)t.next(i[r].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),a}_getNow(){return(this.scheduler||Mc).now()}_trimBufferThenGetEvents(){const t=this._getNow(),e=this._bufferSize,i=this._windowTime,n=this._events,s=n.length;let a=0;for(;a<s&&!(t-n[a].time<i);)a++;return s>e&&(a=Math.max(a,s-e)),a>0&&n.splice(0,a),n}}class Fc{constructor(t,e){this.time=t,this.value=e}}var Pc=i("8ZBU");class Uc{constructor(){if(Uc.instance)return Uc.instance;Uc.instance=this,this.notifications=new Nc}push(t){this.notifications.next(t)}}const zc=new GameSparks;window.gamesparks=zc;const Jc={auth:null,ticket:null,version:null,lng:null,key:null,secret:null,test:null,region:null,type:null},qc="ybPPRqr52WONAYDnrhkMHKSIyXVp4WQl",Vc=/[?&]+([^=&]+)=([^&]*)/gi,$c={preview:!1};class Gc{constructor(){if(this.onError=new o.o,this.onMessage=new o.o,this.onGDPRFound=new o.o,this.metaSubject=new o.o,this._gdprInfo=null,this._loginOptions=null,Gc.instance)return Gc.instance;Gc.instance=this,Gc.notificatorService=new Uc,location.href.replace(Vc,(t,e,i)=>Jc[e]=i),Jc.auth||(Jc.auth="test")}login(t=$c){let e=new Nc;this._loginOptions=t;const i=t.preview;this.authenticate=((t,e,i,n=!1,s)=>{Jc.ticket=Jc.ticket||"",Jc.version=Jc.version||3;let a={version:Jc.version,gdprVersion:e,gdprLanguange:i,deleteAccount:n,gdprStatsOpen:s};"steam"===Jc.auth?zc.steamConnectRequest(Jc.ticket,a,e=>{t.next(e)}):"1c"===Jc.auth?zc.connectViaExternalTokenRequest(Jc.auth,Jc.ticket,a,e=>{t.next(e)}):"eos"===Jc.auth?zc.eosConnectRequest(Jc.ticket,a,e=>{t.next(e)}):t.next({error:{auth:"unauthorized"}})}).bind(this,e);const n={key:Jc.key||"17knjy8qkb",secret:Jc.secret||qc,region:Jc.region||"eu-central-1",type:Jc.type||"ark",onNonce:t=>CryptoJS.enc.Base64.stringify(CryptoJS.HmacSHA256(t,Jc.secret||qc)),onInit:()=>{this._gdprInfo&&this.onGDPRFound.emit(this._gdprInfo)},onMessage:t=>{if(t.error&&Object.keys(t.error)[0].match(/gdpr\_/)){console.warn("Gdpr error. Redirecting to acception window",t.error),localStorage.removeItem("METAGAME_GDPR");let e=Object.keys(t.error)[0];this._gdprInfo=t.error[e].value,this.onGDPRFound.emit(this._gdprInfo)}t&&".AuthenticatedConnectResponse"===t["@class"]&&t.info?(this._gdprInfo=t.info,console.log("> info",t.info)):t&&".AuthenticatedConnectResponse"===t["@class"]&&!t.info&&t.sessionId&&(console.log("> no info"),setTimeout(()=>{this.authenticate()},10)),this.onMessage.emit(t)},onError:t=>{this.onError.emit(t)}};return i?zc.initPreview(n):zc.initLive(n),e}requestSendWithData(t,e,i,n){zc.sendWithData("LogEventRequest",t,e,i,n)}getGameSparks(){return zc}static Fetch(t,e,i){t.messageInit&&Object(Pc.a)(t.messageInit.injectVariables(t.options));let n=new Nc;const s=Object.assign({eventKey:t.requestKey},t.options);return zc.sendWithData("LogEventRequest",s,s=>{if(s.error&&(n.error(s.error),t.messageError&&Object(Pc.a)(t.messageError.injectVariables(t.options),s.error),i&&Gc.notificatorService.push({response:s.error,parameters:""})),!s.error){if(e&&e.length&&Object(Pc.a)(e),t.returnKeys&&t.returnKeys.length){let e;t.returnKeys.length>1?t.returnKeys.map(t=>Object.assign(e,s.scriptData[t])):e=s.scriptData[t.returnKeys[0]],n.next(e)}else n.next(s);t.messageSuccess&&Object(Pc.a)(t.messageSuccess.injectVariables(t.options))}},e=>{e.error&&(n.error(e.error),t.messageError&&Object(Pc.a)(t.messageError.injectVariables(t.options),e.error),i&&Gc.notificatorService.push({response:e.error,parameters:""})),n.error(e),t.messageError&&Object(Pc.a)(t.messageError.injectVariables(t.options),e.error),i&&Gc.notificatorService.push({response:e,parameters:""})}),n}}function Hc(t,e,i){for(var n in i=i||{},t){var s=t[n=n.replace(/(\s|\t| |\r|\n)/gim,".")];n=e?e+"."+n:n,"object"!=typeof s||null===s||s.length&&"string"!=typeof s.length?i[n]=s:Hc(s,n,i)}return i}function Yc(t){let e="";for(let i in t)!e&&i&&(e=i);return{dcode:t[e].dcode,value:t[e].value}}function Wc(t){let e,i,n,s,a={};for(e=(t=t.replace(/^(.*?)\?/gim,"")).split(new RegExp(/(\?|\&)/)),n=0,s=e.length;n<s;n++)i=e[n].split("="),a[i[0]]=i[1];return a}const Kc="METAGAME_LOCALIZATION",Xc="METAGAME_SELECTED_LANGUAGE",Zc=["interface","unit","unit_1","unit_2","unit_3","mission","commander","hint","task","shop"],tl=["en","ru","fr","de","es","pt","pl","jp","ko","zh","tr","ua"],el=["0","I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"];let il=null,nl=`{\n\t"version": 0,\n\t${function(){let t="";return tl.map((e,i)=>{i>0&&(t+=","),t+=`"${e}": {${Zc.slice().map(t=>`"${t}": {"version": 0}`).join()}}`}),t}()}\n}`.replace(/(\n|\t|\r)/gim,""),sl=JSON.stringify({version:0,ru:{"meta.ui.load.connecting":"\u0412\u044b\u0445\u043e\u0434\u0438\u043c \u043d\u0430 \u0441\u0432\u044f\u0437\u044c...","meta.ui.load.reload_button":"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u0435\u0449\u0451 \u0440\u0430\u0437","meta.ui.load.login":"\u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b...","meta.ui.load.localization":"\u041e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u043c \u043d\u0430\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c...","meta.ui.load.information":"\u041e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u043c \u0431\u0430\u0437\u0443 \u0437\u043d\u0430\u043d\u0438\u0439...","meta.ui.load.commanders_templates":"\u0418\u0437\u0443\u0447\u0430\u0435\u043c \u0438\u0441\u0442\u043e\u0440\u0438\u044e...","meta.ui.load.commanders":"\u0420\u043e\u0435\u043c\u0441\u044f \u0432 \u043b\u0438\u0447\u043d\u044b\u0445 \u0434\u0435\u043b\u0430\u0445..","meta.ui.load.troops":"\u0413\u043e\u0442\u043e\u0432\u0438\u043c \u0432\u043e\u0439\u0441\u043a\u0430...","meta.ui.load.tech":"\u0418\u0437\u0443\u0447\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0435 \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0438...","meta.ui.load.tech_amount":"\u0423\u0431\u0438\u0440\u0430\u0435\u043c \u043a\u0430\u0437\u0430\u0440\u043c\u044b...","meta.ui.load.failed":"\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443","meta.ui.load.maps":"\u0420\u0430\u0437\u0432\u043e\u0440\u0430\u0447\u0438\u0432\u0430\u0435\u043c \u043a\u0430\u0440\u0442\u0443 \u043c\u0435\u0441\u0442\u043d\u043e\u0441\u0442\u0438...","meta.ui.load.campaigns":"\u041f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0437\u0430\u0434\u0430\u043d\u0438\u044f \u0433\u0435\u043d\u0448\u0442\u0430\u0431\u0430...","meta.ui.load.inventory":"\u041f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0431\u043e\u0435\u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0442, \u043f\u043e\u0434\u0433\u043e\u043d\u044f\u0435\u043c \u0441\u043d\u0430\u0440\u044f\u0436\u0435\u043d\u0438\u0435...","meta.ui.button_exit":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u0438\u0433\u0440\u0443","meta.ui.error.auth":"\u041d\u0435\u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0437\u0430\u043f\u0440\u0435\u0449\u0435\u043d\u044b","meta.ui.error.connect":"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f","meta.ui.error.player_deleted":"\u0410\u043a\u043a\u0430\u0443\u043d\u0442 \u0438\u0433\u0440\u043e\u043a\u0430 \u0431\u044b\u043b \u0443\u0434\u0430\u043b\u0451\u043d","meta.ui.error.player_will_be_deleted":"\u0410\u043a\u043a\u0430\u0443\u043d\u0442 \u0438\u0433\u0440\u043e\u043a\u0430 \u0431\u0443\u0434\u0435\u0442 \u0443\u0434\u0430\u043b\u0451\u043d #{deleteAt}","meta.ui.error.auth_failed":"\u041e\u0442\u043a\u0430\u0437 \u0432 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u0438\u0433\u0440\u043e\u043a\u0430","meta.ui.error.auth_server_response":"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u043e\u0442\u0432\u0435\u0442\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438","meta.ui.error.auth_server_timeout":"\u041d\u0435\u0442 \u043e\u0442\u0432\u0435\u0442\u0430 \u043e\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438","meta.ui.error.bad_cache":"\u041e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u043e \u0440\u0430\u0441\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445. \n\u041f\u0440\u0438\u043d\u043e\u0441\u0438\u043c \u0441\u0432\u043e\u0438 \u0438\u0437\u0432\u0438\u043d\u0435\u043d\u0438\u044f \u0437\u0430 \u043e\u0448\u0438\u0431\u043a\u0438 \u0432 \u0438\u0433\u0440\u0435. \n\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441. \u0415\u0441\u043b\u0438 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430 \u043d\u0435 \u0438\u0441\u0447\u0435\u0437\u043d\u0435\u0442, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0438\u0433\u0440\u0443.","meta.ui.error.bad_config":"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0441\u0435\u0440\u0432\u0435\u0440\u0430. \n\u0423\u0432\u0435\u0434\u043e\u043c\u0438\u0442\u0435 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u043e\u0432 \u043e\u0431 \u043e\u0448\u0438\u0431\u043a\u0435","meta.ui.error.bad_format":"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445. \n\u0423\u0432\u0435\u0434\u043e\u043c\u0438\u0442\u0435 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u043e\u0432 \u043e\u0431 \u043e\u0448\u0438\u0431\u043a\u0435","meta.ui.error.bad_id":"\u041d\u0443\u0436\u043d\u044b\u0439 \u043e\u0431\u044a\u0435\u043a\u0442 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d. \n\u0423\u0432\u0435\u0434\u043e\u043c\u0438\u0442\u0435 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u043e\u0432 \u043e\u0431 \u043e\u0448\u0438\u0431\u043a\u0435","meta.ui.error.bad_value":"\u041f\u0435\u0440\u0435\u0434\u0430\u043d\u044b \u043d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u0437\u0430\u043f\u0440\u043e\u0441\u0435. \n\u0423\u0432\u0435\u0434\u043e\u043c\u0438\u0442\u0435 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u043e\u0432 \u043e\u0431 \u043e\u0448\u0438\u0431\u043a\u0435","meta.ui.error.login_disabled":"\u0412\u0445\u043e\u0434 \u0432 \u0438\u0433\u0440\u0443 \u0437\u0430\u043a\u0440\u044b\u0442","meta.ui.error.login_disabled_until":"\u0412\u0445\u043e\u0434 \u0432 \u0438\u0433\u0440\u0443 \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e \u0437\u0430\u043a\u0440\u044b\u0442 \u0434\u043e #{date}","meta.ui.error.player_busy":"\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u044f \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u0430 \u0434\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0438\u0433\u0440\u043e\u043a\u0430","meta.ui.error.auth_server_ban_temporary":"\u0412\u044b \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e \u0437\u0430\u0431\u0430\u043d\u0435\u043d\u044b \u0434\u043e #{date}","meta.ui.error.auth_server_ban_permanent":"\u0412\u044b \u0437\u0430\u0431\u0430\u043d\u0435\u043d\u044b \u043d\u0430\u0432\u0441\u0435\u0433\u0434\u0430","meta.ui.error.bad_operation":"\u0417\u0430\u043f\u0440\u043e\u0448\u0435\u043d\u0430 \u043d\u0435\u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u0430\u044f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u044f","meta.ui.error.socket.no_response":"\u0423\u0442\u0435\u0440\u044f\u043d\u043e \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c","meta.ui.error.socket.not_initialised":"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e","meta.ui.error.steam_server_response":"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442 \u043e\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 Steam","meta.ui.error.attention":"\u0412\u043d\u0438\u043c\u0430\u043d\u0438\u0435","meta.ui.error.not_authenticated":"\u041d\u0435 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d","meta.ui.reason.auth_server_ban_temporary":"\u0412\u044b \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e \u0437\u0430\u0431\u0430\u043d\u0435\u043d\u044b \u0434\u043e #{date}","meta.ui.reason.auth_server_ban_permanent":"\u0412\u044b \u0437\u0430\u0431\u0430\u043d\u0435\u043d\u044b \u043d\u0430\u0432\u0441\u0435\u0433\u0434\u0430","meta.ui.reason.auth_failed":"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f","meta.ui.reason.maintenance":"\u0421\u0435\u0440\u0432\u0435\u0440\u0430 \u0437\u0430\u043a\u0440\u044b\u0442\u044b \u043d\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435","meta.ui.reason.maintenance_until":"\u0421\u0435\u0440\u0432\u0435\u0440\u0430 \u0437\u0430\u043a\u0440\u044b\u0442\u044b \u043d\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0434\u043e #{date}","meta.ui.reason.test_not_started":"\u0421\u0435\u0440\u0432\u0435\u0440\u0430 \u0437\u0430\u043a\u0440\u044b\u0442\u044b \u0434\u043e \u043d\u0430\u0447\u0430\u043b\u0430 \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f - #{date}","meta.ui.reason.player_not_exist":"\u0422\u0430\u043a\u043e\u0433\u043e \u0438\u0433\u0440\u043e\u043a\u0430 \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442","meta.ui.reason.player_will_be_deleted":"\u0410\u043a\u043a\u0430\u0443\u043d\u0442 \u0431\u0443\u0434\u0435\u0442 \u0443\u0434\u0430\u043b\u0451\u043d","meta.ui.reason.gdpr_accept_required":"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c \u0441\u043e\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435 \u0437\u0430\u043d\u043e\u0432\u043e","meta.ui.reason.friends_and_family_test":"\u0421\u0435\u0440\u0432\u0435\u0440\u044b \u0438\u0433\u0440\u044b \u0431\u0443\u0434\u0443\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0441 15:00 \u0434\u043e 23:00 \u041c\u0421\u041a. \u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0437\u0430\u043f\u0443\u0441\u043a #{date}","meta.ui.gdpr.acception_text":"\u042f \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u043b \u0438 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u044e \u043b\u0438\u0446\u0435\u043d\u0437\u0438\u043e\u043d\u043d\u043e\u0435 \u0441\u043e\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435 \u0441 \u043a\u043e\u043d\u0435\u0447\u043d\u044b\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c","meta.ui.gdpr.profile_delete":"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430","meta.ui.gdpr.profile_stats_label":"\u041e\u0442\u043a\u0440\u044b\u0442\u044c \u0438\u0433\u0440\u043e\u0432\u0443\u044e \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443 \u0434\u043b\u044f \u0434\u0440\u0443\u0433\u0438\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432? ","meta.ui.gdpr.profile_stats_explainer_open":"\u0415\u0441\u043b\u0438 \u0432\u044b \u043f\u043b\u0430\u043d\u0438\u0440\u0443\u0435\u0442\u0435 \u0438\u0433\u0440\u0430\u0442\u044c \u0432 \u043c\u0443\u043b\u044c\u0442\u0438\u043f\u043b\u0435\u0435\u0440, \u0442\u043e \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u043c \u0432\u044b\u0431\u0440\u0430\u0442\u044c @\u041e\u0442\u043a\u0440\u044b\u0442\u044c \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443@, \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0438\u0433\u0440\u043e\u0432\u043e\u0439 \u043e\u043f\u044b\u0442.\n<br><br>\n\u0412 \u043e\u0442\u043a\u0440\u044b\u0442\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435 \u0432\u044b \u0441\u043c\u043e\u0436\u0435\u0442\u0435:\n+ \u0443\u0447\u0430\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u0432 \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0435\n+ \u0432\u0438\u0434\u0435\u0442\u044c \u0447\u0443\u0436\u0443\u044e \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443\n+ \u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0438\u0442\u043e\u0433\u0438 \u0447\u0443\u0436\u0438\u0445 \u0431\u043e\u0451\u0432\n+ \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c \u0440\u0435\u043f\u043b\u0435\u0438 \u0447\u0443\u0436\u0438\u0445 \u0431\u043e\u0451\u0432\n+ \u0434\u0440\u0443\u0433\u0438\u0435 \u0438\u0433\u0440\u043e\u043a\u0438 \u0442\u0430\u043a\u0436\u0435 \u0441\u043c\u043e\u0433\u0443\u0442 \u0432\u0438\u0434\u0435\u0442\u044c \u0432\u0430\u0448\u0443 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443.","meta.ui.gdpr.profile_stats_explainer_close":"\u0412 \u0437\u0430\u043a\u0440\u044b\u0442\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435 \u0432\u0430\u0448\u0430 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0441\u043a\u0440\u044b\u0442\u0430 \u043e\u0442 \u043f\u043e\u0441\u0442\u043e\u0440\u043e\u043d\u043d\u0438\u0445.\n\u041d\u0435 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u043c \u044d\u0442\u0443 \u043e\u043f\u0446\u0438\u044e, \u0435\u0441\u043b\u0438 \u0432\u044b \u043f\u043b\u0430\u043d\u0438\u0440\u0443\u0435\u0442\u0435 \u0438\u0433\u0440\u0430\u0442\u044c \u0432 \u043c\u0443\u043b\u044c\u0442\u0438\u043f\u043b\u0435\u0435\u0440.\n<br><br>\n\u0412 \u044d\u0442\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435 \u0432\u0430\u043c \u0431\u0443\u0434\u0443\u0442 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b:\n+ \u0443\u0447\u0430\u0441\u0442\u0438\u0435 \u0432 \u043e\u0431\u0449\u0435\u043c \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0435\n+ \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0438 \u0438\u0442\u043e\u0433\u0438 \u0431\u043e\u0451\u0432 \u0434\u0440\u0443\u0433\u0438\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432\n+ \u0440\u0435\u043f\u043b\u0435\u0438 \u0434\u0440\u0443\u0433\u0438\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432\n","meta.ui.gdpr.profile_stats_explainer_subtitle":"\u0412 \u0434\u0430\u043b\u044c\u043d\u0435\u0439\u0448\u0435\u043c \u0432\u044b \u0441\u043c\u043e\u0436\u0435\u0442\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0443 \u0432 \u043e\u043f\u0446\u0438\u044f\u0445 \u0438\u0433\u0440\u044b.","meta.ui.gdpr.profile_stats_hide":"\u0421\u043a\u0440\u044b\u0432\u0430\u0442\u044c \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443","meta.ui.gdpr.profile_stats_show":"\u041e\u0442\u043a\u0440\u044b\u0442\u044c \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443","meta.ui.gdpr.profile_decline":"\u041d\u0435 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u044e","meta.ui.gdpr.profile_accept":"\u041f\u0440\u0438\u043d\u0438\u043c\u0430\u044e","meta.ui.gdpr.delete.title":"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430","meta.ui.gdpr.delete.desc":'\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442? \n\u0412\u0441\u0435 \u0432\u0430\u0448\u0438 \u0438\u0433\u0440\u043e\u0432\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u0443\u0434\u0430\u043b\u0435\u043d\u044b.\n\u0427\u0442\u043e\u0431\u044b \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435, \u0412\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0432\u0432\u0435\u0441\u0442\u0438 "#{keyword}" \u0432 \u043f\u043e\u043b\u0435 \u043d\u0438\u0436\u0435:',"meta.ui.gdpr.delete.recovery":"\u041f\u043e\u0441\u043b\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430 \u0443 \u0432\u0430\u0441 \u0435\u0441\u0442\u044c 3 \u0434\u043d\u044f, \u0432 \u0442\u0435\u0447\u0435\u043d\u0438\u0438 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043c\u043e\u0436\u043d\u043e \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c. \u0414\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u043d\u0443\u0436\u043d\u043e \u043f\u0440\u043e\u0441\u0442\u043e \u0432\u043e\u0439\u0442\u0438 \u0432 \u0438\u0433\u0440\u0443.","meta.ui.gdpr.delete.keyword":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c","meta.ui.gdpr.delete.submit":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442","meta.ui.gdpr.delete.decline":"\u041d\u0435 \u0443\u0434\u0430\u043b\u044f\u0442\u044c","meta.hint.gdpr.acception_helper":"\u041f\u0440\u0438 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432 \u0432\u044b \u0443\u0432\u0438\u0434\u0438\u0442\u0435 \u043d\u0438\u0436\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u2014 \u043a\u0430\u043a \u0438\u0433\u0440\u0430 \u0431\u0443\u0434\u0435\u0442 \u0441\u0435\u0431\u044f \u0432\u0435\u0441\u0442\u0438 \u043f\u0440\u0438 \u043a\u0430\u0436\u0434\u043e\u043c \u0432\u044b\u0431\u043e\u0440\u0435."},en:{"meta.ui.load.connecting":"Connecting to server...","meta.ui.load.reload_button":"Retry","meta.ui.load.login":"Logging in...","meta.ui.load.localization":"Syncing locales...","meta.ui.load.information":"Syncing knowledge database...","meta.ui.load.commanders_templates":"Syncing commanders templates...","meta.ui.load.commanders":"Syncing commanders...","meta.ui.load.troops":"Syncing units...","meta.ui.load.tech":"Syncing technology tree...","meta.ui.load.tech_amount":"Syncing barracks...","meta.ui.load.failed":"Unable to login to server","meta.ui.load.maps":"Syncing maps...","meta.ui.load.campaigns":"Syncing campaigns...","meta.ui.load.inventory":"Syncing inventory...","meta.ui.button_exit":"Close game","meta.ui.error.auth":"Unauthorized connections are denied","meta.ui.error.connect":"Connection error","meta.ui.error.player_deleted":"This player's account has been deleted","meta.ui.error.player_will_be_deleted":"This player's account will be deleted at #{deleteAt}","meta.ui.error.auth_failed":"Player authorization failed","meta.ui.error.auth_server_response":"Error in server reply authorization","meta.ui.error.auth_server_timeout":"No reply from authorization server","meta.ui.error.bad_cache":"Player data discrepancy between server and client detected. \nWe're sorry about that. \nTry reloading the interface. If the problem persists, restart the game","meta.ui.error.bad_config":"Error in server configuration. \nPlease notify the developers","meta.ui.error.bad_format":"Error in data passed to server. \nPlease notify the developers","meta.ui.error.bad_id":"Requested object not found on server. \nPlease notify the developers","meta.ui.error.bad_value":"Wrong values passed to server. \nPlease notify the developers","meta.ui.error.login_disabled":"Game is closed","meta.ui.error.login_disabled_until":"Game is temporarily closed until #{date}","meta.ui.error.player_busy":"Operation is not possible for current player state","meta.ui.error.auth_server_ban_temporary":"You are banned until #{date}","meta.ui.error.auth_server_ban_permanent":"You are permanently banned","meta.ui.error.bad_operation":"Invalid command requested","meta.ui.error.socket.no_response":"Lost connection to server","meta.ui.error.socket.not_initialised":"No connection to server","meta.ui.error.steam_server_response":"Incorrect Steam server response","meta.ui.error.attention":"Attention","meta.ui.error.not_authenticated":"Not authenticated","meta.ui.reason.auth_server_ban_temporary":"You are banned until #{date}","meta.ui.reason.auth_server_ban_permanent":"You are permanently banned","meta.ui.reason.auth_failed":"Unable to authenticate","meta.ui.reason.maintenance":"Servers closed for maintenance","meta.ui.reason.maintenance_until":"Servers closed for maintenance until #{date}","meta.ui.reason.test_not_started":"Servers closed until start of test: #{date}","meta.ui.reason.player_not_exist":"That player does not exist","meta.ui.reason.player_will_be_deleted":"The account will be deleted","meta.ui.reason.gdpr_accept_required":"GDPR verification required","meta.ui.reason.friends_and_family_test":"The servers will be online from 12:00 to 8:00 p.m. (UTC). Next start #{date}","meta.ui.gdpr.acception_text":"I have read and agree to the End User License Agreement","meta.ui.gdpr.profile_delete":"Delete account","meta.ui.gdpr.profile_stats_label":"Show game stats for other players?","meta.ui.gdpr.profile_stats_explainer_open":"If you plan to play multiplayer, we recommend that you select @Open stats@ to get the best gaming experience.\n<br><br>\nIn open mode, you can:\n+ participate in the rating\n+ see other people's statistics\n+ see the results of other people's battles\n+ launch replays of other people's battles\n+ other players will also be able to see your stats.","meta.ui.gdpr.profile_stats_explainer_close":"In private mode, your stats are hidden from other persons.\nWe don\u2019t recommend this option if you plan to play multiplayer.\n<br><br>\nThe following features will not be available to you in this mode:\n+ Global ranking placement\n+ Other players\u2019 stats and battle results\n+ Other players\u2019 replays","meta.ui.gdpr.profile_stats_explainer_subtitle":"You can change this setting later in the game options.","meta.ui.gdpr.profile_stats_hide":"Hide stats","meta.ui.gdpr.profile_stats_show":"Open stats","meta.ui.gdpr.profile_decline":"Decline","meta.ui.gdpr.profile_accept":"Accept","meta.ui.gdpr.delete.title":"Delete account","meta.ui.gdpr.delete.desc":'Are you sure you want to delete your account?\nAll the data will be erased forever.\nIf you want to continue, please type "#{keyword}" in the field below:',"meta.ui.gdpr.delete.recovery":"You have 3 days after this action to recover your account. To do that you just need to log in.","meta.ui.gdpr.delete.keyword":"Delete","meta.ui.gdpr.delete.submit":"Delete account","meta.ui.gdpr.delete.decline":"No, keep it","meta.hint.gdpr.acception_helper":"When switching options, you will see below a description of how the game will behave with each choice."},fr:{"meta.ui.load.connecting":"Connexion au serveur...","meta.ui.load.reload_button":"R\xe9essayer","meta.ui.load.login":"Connexion en cours...","meta.ui.load.localization":"Synchronisation des lieux...","meta.ui.load.information":"Synchronisation de la base de connaissances...","meta.ui.load.commanders_templates":"Synchronisation des mod\xe8les de commandant...","meta.ui.load.commanders":"Synchronisation des commandants...","meta.ui.load.troops":"Synchronisation des unit\xe9s...","meta.ui.load.tech":"Synchronisation de l'arborescence technologique...","meta.ui.load.tech_amount":"Synchronisation des casernes...","meta.ui.load.failed":"Connexion au serveur impossible","meta.ui.load.maps":"Synchronisation des cartes...","meta.ui.load.campaigns":"Synchronisation des campagnes...","meta.ui.load.inventory":"Synchronisation de l'inventaire...","meta.ui.button_exit":"Fermer le jeu","meta.ui.error.auth":"Connexions non autoris\xe9es refus\xe9es","meta.ui.error.connect":"Erreur de connexion","meta.ui.error.player_deleted":"Le compte de ce joueur a \xe9t\xe9 supprim\xe9","meta.ui.error.player_will_be_deleted":"Le compte du joueur sera supprim\xe9 #{deleteAt}","meta.ui.error.auth_failed":"\xc9chec d'autorisation de joueur","meta.ui.error.auth_server_response":"Erreur de r\xe9ponse de serveur d'autorisation","meta.ui.error.auth_server_timeout":"Absence de r\xe9ponse de serveur d'autorisation","meta.ui.error.bad_cache":"D\xe9tection d'incoh\xe9rence de donn\xe9es de joueur entre serveur et client. \nNous en sommes d\xe9sol\xe9s. \nEssayez de recharger l'interface. Si le probl\xe8me persiste, red\xe9marrez le jeu.","meta.ui.error.bad_config":"Erreur de configuration de serveur.\nVeuillez en avertir les d\xe9veloppeurs.","meta.ui.error.bad_format":"Erreur de donn\xe9es transmises au serveur.\nVeuillez en avertir les d\xe9veloppeurs.","meta.ui.error.bad_id":"Objet demand\xe9 introuvable sur le serveur.\nVeuillez en avertir les d\xe9veloppeurs.","meta.ui.error.bad_value":"Donn\xe9es incorrectes transmises au serveur.\nVeuillez en avertir les d\xe9veloppeurs.","meta.ui.error.login_disabled":"Acc\xe8s au jeu impossible","meta.ui.error.login_disabled_until":"Acc\xe8s au jeu impossible jusqu'au #{date}","meta.ui.error.player_busy":"L'op\xe9ration n'est pas possible pour l'\xe9tat actuel du joueur","meta.ui.error.auth_server_ban_temporary":"Vous \xeates banni(e) jusqu'au #{date}","meta.ui.error.auth_server_ban_permanent":"Vous \xeates banni(e) d\xe9finitivement","meta.ui.error.bad_operation":"Requ\xeate de commande incorrecte","meta.ui.error.socket.no_response":"Connexion perdue avec le serveur","meta.ui.error.socket.not_initialised":"Aucune connexion avec le serveur","meta.ui.error.steam_server_response":"R\xe9ponse incorrecte du serveur Steam","meta.ui.error.attention":"Attention","meta.ui.error.not_authenticated":"Non authentifi\xe9","meta.ui.reason.auth_server_ban_temporary":"Vous \xeates exclu jusqu'au #{date}","meta.ui.reason.auth_server_ban_permanent":"Vous \xeates d\xe9finitivement exclu","meta.ui.reason.auth_failed":"Authentification impossible","meta.ui.reason.maintenance":"Serveurs ferm\xe9s pour maintenance","meta.ui.reason.maintenance_until":"Serveurs ferm\xe9s pour maintenance jusqu'au #{date}","meta.ui.reason.test_not_started":"Serveurs ferm\xe9s jusqu'au d\xe9but du test\xa0: #{date}","meta.ui.reason.player_not_exist":"Joueur inexistant","meta.ui.reason.player_will_be_deleted":"Le compte va \xeatre supprim\xe9","meta.ui.reason.gdpr_accept_required":"V\xe9rification RGPD requise","meta.ui.reason.friends_and_family_test":"Les serveurs seront en ligne de 12h00 \xe0 20h00 (UTC). Prochain d\xe9but\xa0: #{date}","meta.ui.gdpr.acception_text":"J'ai lu et j'accepte le Contrat de licence d'utilisateur final","meta.ui.gdpr.profile_delete":"Supprimer le compte","meta.ui.gdpr.profile_stats_label":"Afficher les statistiques des autres joueurs ?","meta.ui.gdpr.profile_stats_explainer_open":"Si vous avez l'intention de jouer en multijoueur, nous vous recommandons de s\xe9lectionner le mode ouvert pour profiter au maximum de votre exp\xe9rience de jeu.\n<br><br>\nEn mode ouvert, vous pourrez :\n+ participer aux classements \n+ voir les statistiques des autres joueurs \n+ voir les scores des autres joueurs\n+ rejouer les batailles d'un autre joueur\n+ les autres joueurs pourront \xe9galement consulter vos statistiques.","meta.ui.gdpr.profile_stats_explainer_close":"En mode priv\xe9, vos statistiques sont cach\xe9es des regards indiscrets. Nous vous d\xe9conseillons cette option si vous envisagez de jouer en multijoueur.\n<br><br>\nDans ce mode, les fonctionnalit\xe9s suivantes ne seront pas disponible :\n+ les classements g\xe9n\xe9raux\n+ les statistiques et les combats des autres joueurs\n+ les rediffusions des autres joueurs","meta.ui.gdpr.profile_stats_explainer_subtitle":"Vous pouvez modifier ce param\xe8tre plus tard dans les options du jeu.","meta.ui.gdpr.profile_stats_hide":"Masquer les statistiques","meta.ui.gdpr.profile_stats_show":"Ouvrir les statistiques","meta.ui.gdpr.profile_decline":"D\xe9cliner","meta.ui.gdpr.profile_accept":"Accepter","meta.ui.gdpr.delete.title":"Supprimer le compte","meta.ui.gdpr.delete.desc":'\xcates-vous s\xfbr de vouloir supprimer votre compte\xa0?\nToutes les donn\xe9es seront d\xe9finitivement effac\xe9es.\nSi vous souhaitez continuer, veuillez saisir "#{keyword}" dans le champ ci-dessous\xa0:',"meta.ui.gdpr.delete.recovery":"Vous avez 3 jours apr\xe8s cette action pour r\xe9cup\xe9rer votre compte. Pour ce faire, il vous suffit de vous connecter.","meta.ui.gdpr.delete.keyword":"Supprimer","meta.ui.gdpr.delete.submit":"Supprimer le compte","meta.ui.gdpr.delete.decline":"Non, gardez-le","meta.hint.gdpr.acception_helper":"Lorsque vous changez d'option, vous verrez ci-dessous une description de la fa\xe7on dont le jeu se comportera en fonction de chaque s\xe9lection."},de:{"meta.ui.load.connecting":"Verbinde mit dem Server ...","meta.ui.load.reload_button":"Erneuter Versuch","meta.ui.load.login":"Logge ein ...","meta.ui.load.localization":"Synchronisiere Regionen ...","meta.ui.load.information":"Synchronisiere Wissensdatenbank ...","meta.ui.load.commanders_templates":"Synchronisiere Kommandantenvorlagen ...","meta.ui.load.commanders":"Synchronisiere Kommandanten ...","meta.ui.load.troops":"Synchronisiere Einheiten ...","meta.ui.load.tech":"Synchronisiere Technologiebaum ...","meta.ui.load.tech_amount":"Synchronisiere Kaserne ...","meta.ui.load.failed":"Login zum Server nicht m\xf6glich","meta.ui.load.maps":"Synchronisiere Karten ...","meta.ui.load.campaigns":"Synchronisiere Kampagnen ...","meta.ui.load.inventory":"Synchronisiere Inventar ...","meta.ui.button_exit":"Spiel schlie\xdfen","meta.ui.error.auth":"Unautorisierte Verbindungen werden verweigert","meta.ui.error.connect":"Verbindungsfehler","meta.ui.error.player_deleted":"Das Konto dieses Spielers wurde gel\xf6scht","meta.ui.error.player_will_be_deleted":"Spielerkonto wird gel\xf6scht #{deleteAt}","meta.ui.error.auth_failed":"Spielerautorisierung fehlgeschlagen","meta.ui.error.auth_server_response":"Fehler beim Antworten des Autorisierungsservers","meta.ui.error.auth_server_timeout":"Keine Antwort vom Autorisierungsserver","meta.ui.error.bad_cache":"Spielerdaten-Abweichung zwischen Server und Client entdeckt.\nDas tut uns leid.\nVersuchen Sie, die Benutzeroberfl\xe4che neu zu laden. Sollte das Problem bestehen bleiben, starten Sie das Spiel neu.","meta.ui.error.bad_config":"Fehler bei der Server-Konfiguration.\nBitte benachrichtigen Sie die Entwickler.","meta.ui.error.bad_format":"Falsche Daten zum Server \xfcbermittelt.\nBitte benachrichtigen Sie die Entwickler.","meta.ui.error.bad_id":"Gew\xfcnschtes Objekt nicht auf dem Server gefunden.\nBitte benachrichtigen Sie die Entwickler.","meta.ui.error.bad_value":"Falsche Werte zum Server \xfcbermittelt.\nBitte benachrichtigen Sie die Entwickler.","meta.ui.error.login_disabled":"Spiel geschlossen","meta.ui.error.login_disabled_until":"Das Spiel ist vor\xfcbergehend bis #{date} geschlossen.","meta.ui.error.player_busy":"Operation ist beim aktuellen Spielerstatus nicht m\xf6glich","meta.ui.error.auth_server_ban_temporary":"Sie sind bis #{date} gebannt.","meta.ui.error.auth_server_ban_permanent":"Sie sin dauerhaft gebannt.","meta.ui.error.bad_operation":"Ung\xfcltige Befehlsanfrage","meta.ui.error.socket.no_response":"Verbindung zum Server abgebrochen","meta.ui.error.socket.not_initialised":"Keine Verbindung zum Server","meta.ui.error.steam_server_response":"Inkorrekte Steam-Serverantwort","meta.ui.error.attention":"Achtung","meta.ui.error.not_authenticated":"Nicht authentifiziert","meta.ui.reason.auth_server_ban_temporary":"Sie sind bis #{date} gebannt.","meta.ui.reason.auth_server_ban_permanent":"Sie sin dauerhaft gebannt.","meta.ui.reason.auth_failed":"Authentifizierung nicht m\xf6glich.","meta.ui.reason.maintenance":"Server wegen Wartungsarbeiten geschlossen.","meta.ui.reason.maintenance_until":"Server wegen Wartungsarbeiten bis #{date} geschlossen.","meta.ui.reason.test_not_started":"Server bis zum Teststart geschlossen: #{date}.","meta.ui.reason.player_not_exist":"Dieser Spieler existiert nicht","meta.ui.reason.player_will_be_deleted":"Das Konto wird gel\xf6scht","meta.ui.reason.gdpr_accept_required":"Er muss die Vereinbarung erneut best\xe4tigen","meta.ui.reason.friends_and_family_test":"Die Server werden von 12:00 bis 20:00 (UTC) offen sein. N\xe4chster Start #{date}.","meta.ui.gdpr.acception_text":"Ich habe die Endbenutzer-Lizenzvereinbarung gelesen und akzeptiert","meta.ui.gdpr.profile_delete":"Konto l\xf6schen","meta.ui.gdpr.profile_stats_label":"Spielstatistiken f\xfcr andere Spieler anzeigen?","meta.ui.gdpr.profile_stats_explainer_open":"Wenn Sie vorhaben, im Mehrspielermodus zu spielen, empfehlen wir Ihnen, die offene Statistik zu w\xe4hlen, um das maximale Spielerlebnis zu erhalten.\n<br><br>\nIm offenen Modus k\xf6nnen Sie:\n+ an Ranglisten teilnehmen \n+ die Statistiken anderer Spieler einsehen \n+ die Spielst\xe4nde anderer Spieler einsehen\n+ die K\xe4mpfe eines anderen Spielers nachspielen\n+ andere Spieler k\xf6nnen auch Ihre Statistiken einsehen.","meta.ui.gdpr.profile_stats_explainer_close":"Im privaten Modus werden Ihre Statistiken vor neugierigen Blicken verborgen. Wir empfehlen diese Option nicht, wenn Sie vorhaben, im Mehrspielermodus zu spielen.\n<br><br>\nIn diesem Modus haben Sie kein Zugriff auf folgende Funktionen:\n+ Gesamtranglisten\n+ Statistiken und K\xe4mpfe anderer Spieler\n+ Replays von anderen Spielern","meta.ui.gdpr.profile_stats_explainer_subtitle":"Sie k\xf6nnen diese Einstellung sp\xe4ter in den Spieloptionen \xe4ndern.","meta.ui.gdpr.profile_stats_hide":"Statistiken ausblenden","meta.ui.gdpr.profile_stats_show":"Statistiken anzeigen","meta.ui.gdpr.profile_decline":"Ablehnen","meta.ui.gdpr.profile_accept":"Akzeptieren","meta.ui.gdpr.delete.title":"Konto l\xf6schen","meta.ui.gdpr.delete.desc":"Sind Sie sicher, dass Sie Ihr Konto l\xf6schen m\xf6chten?\nAlle Daten werden f\xfcr immer gel\xf6scht.\nWenn Sie fortfahren m\xf6chten, geben Sie bitte \u201e#{keyword}\u201c in das Feld unten ein:","meta.ui.gdpr.delete.recovery":"Nach dieser Aktion haben Sie drei Tage Zeit, um Ihr Konto wiederherzustellen. Dazu m\xfcssen Sie sich lediglich anmelden.","meta.ui.gdpr.delete.keyword":"L\xf6schen","meta.ui.gdpr.delete.submit":"Konto l\xf6schen","meta.ui.gdpr.delete.decline":"Nein, ich behalte es","meta.hint.gdpr.acception_helper":"Wenn du die Optionen wechselst, siehst du unten eine Beschreibung, wie sich das Spiel bei jeder Auswahl verh\xe4lt."},es:{"meta.ui.load.connecting":"Conectando al servidor...","meta.ui.load.reload_button":"Reintentar","meta.ui.load.login":"Iniciando sesi\xf3n...","meta.ui.load.localization":"Sincronizando configuraci\xf3n regional...","meta.ui.load.information":"Sincronizando base de datos...","meta.ui.load.commanders_templates":"Sincronizando plantillas de comandantes...","meta.ui.load.commanders":"Sincronizando comandantes...","meta.ui.load.troops":"Sincronizando unidades...","meta.ui.load.tech":"Sincronizando \xe1rbol de tecnolog\xeda...","meta.ui.load.tech_amount":"Sincronizando barracones...","meta.ui.load.failed":"Error al unirse al servidor.","meta.ui.load.maps":"Sincronizando mapas\u2026","meta.ui.load.campaigns":"Sincronizando campa\xf1as...","meta.ui.load.inventory":"Sincronizando inventario...","meta.ui.button_exit":"Cerrar partida","meta.ui.error.auth":"Conexiones no autorizadas denegadas.","meta.ui.error.connect":"Error de conexi\xf3n.","meta.ui.error.player_deleted":"La cuenta de este jugador ha sido eliminada.","meta.ui.error.player_will_be_deleted":"La cuenta del jugador ser\xe1 eliminada #{deleteAt}","meta.ui.error.auth_failed":"Error al autorizar jugador.","meta.ui.error.auth_server_response":"Error en la respuesta del servidor de autorizaci\xf3n.","meta.ui.error.auth_server_timeout":"El servidor de autorizaci\xf3n no responde.","meta.ui.error.bad_cache":"Se ha detectado una discrepancia entre el servidor y el cliente. \nSentimos lo ocurrido. \nPrueba a recargar la interfaz. Si el problema persiste, reinicia el juego.","meta.ui.error.bad_config":"Error en la configuraci\xf3n del servidor. \nAvisa a los desarrolladores.","meta.ui.error.bad_format":"Error en los datos comunicados al servidor. \nAvisa a los desarrolladores.","meta.ui.error.bad_id":"El objeto solicitado no se encuentra en el servidor. \nAvisa a los desarrolladores.","meta.ui.error.bad_value":"Valores incorrectos comunicados al servidor. \nAvisa a los desarrolladores.","meta.ui.error.login_disabled":"La partida est\xe1 cerrada.","meta.ui.error.login_disabled_until":"La partida est\xe1 temporalmente cerrada hasta el #{date}.","meta.ui.error.player_busy":"La operaci\xf3n no es posible para el estado actual del jugador","meta.ui.error.auth_server_ban_temporary":"Est\xe1s expulsado hasta el #{date}.","meta.ui.error.auth_server_ban_permanent":"Est\xe1s expulsado permanentemente.","meta.ui.error.bad_operation":"Acci\xf3n no v\xe1lida","meta.ui.error.socket.no_response":"Se ha perdido la conexi\xf3n con el servidor.","meta.ui.error.socket.not_initialised":"No hay conexi\xf3n con el servidor.","meta.ui.error.steam_server_response":"Respuesta incorrecta del servidor de Steam.","meta.ui.error.attention":"Atenci\xf3n","meta.ui.error.not_authenticated":"No se ha autenticado.","meta.ui.reason.auth_server_ban_temporary":"Est\xe1s expulsado hasta el #{date}.","meta.ui.reason.auth_server_ban_permanent":"Est\xe1s expulsado permanentemente.","meta.ui.reason.auth_failed":"Error de autenticaci\xf3n.","meta.ui.reason.maintenance":"Servidores cerrados por mantenimiento.","meta.ui.reason.maintenance_until":"Servidores cerrados por mantenimiento hasta el #{date}.","meta.ui.reason.test_not_started":"Servidores cerrados hasta el inicio de la prueba: #{date}.","meta.ui.reason.player_not_exist":"Ese jugador no existe.","meta.ui.reason.player_will_be_deleted":"La cuenta se eliminar\xe1.","meta.ui.reason.gdpr_accept_required":"Necesita volver a aceptar el acuerdo","meta.ui.reason.friends_and_family_test":"Los servidores estar\xe1n en l\xednea de 13:00 a 21:00 CET. Siguiente fecha: #{date}.","meta.ui.gdpr.acception_text":"He le\xeddo y acepto el Acuerdo de licencia de usuario final.","meta.ui.gdpr.profile_delete":"Borrar cuenta","meta.ui.gdpr.profile_stats_label":"\xbfMostrar las estad\xedsticas de otros jugadores?","meta.ui.gdpr.profile_stats_explainer_open":"Si planeas jugar en modo multijugador, te recomendamos que selecciones @Mostrar estad\xedsticas@ para obtener la m\xe1xima experiencia de juego.\n<br><br>\nEn el modo P\xfablico, podr\xe1s:\n+ participar en clasificaciones \n+ ver las estad\xedsticas de otras personas \n+ ver los resultados de otros jugadores\n+ repetir las batallas de otros jugadores\n+ otros jugadores tambi\xe9n podr\xe1n ver tus estad\xedsticas.","meta.ui.gdpr.profile_stats_explainer_close":"En el modo Privado tus estad\xedsticas se ocultan de miradas indiscretas. No recomendamos esta opci\xf3n si planeas jugar en modo multijugador.\n<br><br>\nEn este modo, no podr\xe1s:\n+ participar en clasificaciones \n+ ver las estad\xedsticas y resultados de otras personas \n+ repetir las batallas de otros jugadores.","meta.ui.gdpr.profile_stats_explainer_subtitle":"Puedes cambiar esta configuraci\xf3n m\xe1s adelante en las opciones del juego.","meta.ui.gdpr.profile_stats_hide":"Ocultar estad\xedsticas","meta.ui.gdpr.profile_stats_show":"Mostrar estad\xedsticas","meta.ui.gdpr.profile_decline":"Rechazar","meta.ui.gdpr.profile_accept":"Aceptar","meta.ui.gdpr.delete.title":"Borrar cuenta","meta.ui.gdpr.delete.desc":"\xbfEst\xe1s seguro de que quieres eliminar tu cuenta?\nTodos los datos ser\xe1n borrados para siempre.\nSi deseas continuar, escribe \xab#{keyword}\xbb en el campo a continuaci\xf3n:","meta.ui.gdpr.delete.recovery":"Tienes 3 d\xedas despu\xe9s de esta acci\xf3n para recuperar tu cuenta. Para hacerlo solo necesitas iniciar sesi\xf3n.","meta.ui.gdpr.delete.keyword":"Borrar","meta.ui.gdpr.delete.submit":"Borrar cuenta","meta.ui.gdpr.delete.decline":"Convervar","meta.hint.gdpr.acception_helper":"Cuando cambies de opci\xf3n, ver\xe1s a continuaci\xf3n una descripci\xf3n de c\xf3mo se comportar\xe1 el juego con cada selecci\xf3n."},pt:{"meta.ui.load.connecting":"Conectando-se ao servidor...","meta.ui.load.reload_button":"Tentar novamente","meta.ui.load.login":"Fazendo login...","meta.ui.load.localization":"Sincronizando localidades...","meta.ui.load.information":"Sincronizando banco de dados de informa\xe7\xf5es...","meta.ui.load.commanders_templates":"Sincronizando modelos de comandantes...","meta.ui.load.commanders":"Sincronizando comandantes...","meta.ui.load.troops":"Sincronizando unidades...","meta.ui.load.tech":"Sincronizando \xe1rvore de tecnologia...","meta.ui.load.tech_amount":"Sincronizando quartel...","meta.ui.load.failed":"N\xe3o foi poss\xedvel fazer login no servidor","meta.ui.load.maps":"Sincroniza\xe7\xe3o de mapas...","meta.ui.load.campaigns":"Sincroniza\xe7\xe3o de campanhas...","meta.ui.load.inventory":"Sincronizando o invent\xe1rio...","meta.ui.button_exit":"Fechar o jogo","meta.ui.error.auth":"Conex\xf5es n\xe3o autorizadas ser\xe3o recusadas","meta.ui.error.connect":"Erro de conex\xe3o","meta.ui.error.player_deleted":"A conta deste jogador foi exclu\xedda.","meta.ui.error.player_will_be_deleted":"A conta do jogador ser\xe1 exclu\xedda #{deleteAt}","meta.ui.error.auth_failed":"Falha na autoriza\xe7\xe3o de jogador","meta.ui.error.auth_server_response":"Erro na resposta de autoriza\xe7\xe3o do servidor","meta.ui.error.auth_server_timeout":"Sem resposta de autoriza\xe7\xe3o do servidor","meta.ui.error.bad_cache":"Detectamos uma discrep\xe2ncia de dados do jogador entre servidor e cliente. \nPedimos desculpas pelo ocorrido. \nTente recarregar a interface. Se o problema persistir, reinicie o jogo.","meta.ui.error.bad_config":"Erro na configura\xe7\xe3o do servidor. \nNotifique os desenvolvedores sobre o erro.","meta.ui.error.bad_format":"Erro na transmiss\xe3o de dados para o servidor. \nNotifique os desenvolvedores sobre o erro.","meta.ui.error.bad_id":"O objeto solicitado n\xe3o foi encontrado no servidor. \nNotifique os desenvolvedores sobre o erro.","meta.ui.error.bad_value":"Valores errados transmitidos ao servidor. \nNotifique os desenvolvedores sobre o erro.","meta.ui.error.login_disabled":"O jogo est\xe1 fechado.","meta.ui.error.login_disabled_until":"O jogo est\xe1 temporariamente fechado at\xe9 #{date}","meta.ui.error.player_busy":"A opera\xe7\xe3o n\xe3o \xe9 poss\xedvel no estado atual do jogador","meta.ui.error.auth_server_ban_temporary":"Voc\xea foi banido(a) at\xe9 #{date}","meta.ui.error.auth_server_ban_permanent":"Voc\xea foi banido(a) de forma permanente.","meta.ui.error.bad_operation":"Comando solicitado inv\xe1lido.","meta.ui.error.socket.no_response":"Conex\xe3o com o servidor perdida.","meta.ui.error.socket.not_initialised":"Conex\xe3o com o servidor inexistente.","meta.ui.error.steam_server_response":"Resposta incorreta do servidor Steam","meta.ui.error.attention":"Aten\xe7\xe3o","meta.ui.error.not_authenticated":"N\xe3o autenticado","meta.ui.reason.auth_server_ban_temporary":"Voc\xea foi banido(a) at\xe9 #{date}","meta.ui.reason.auth_server_ban_permanent":"Voc\xea foi banido(a) de forma permanente.","meta.ui.reason.auth_failed":"Falha na autentica\xe7\xe3o","meta.ui.reason.maintenance":"Servidores fechados para manuten\xe7\xe3o.","meta.ui.reason.maintenance_until":"Servidores fechados para manuten\xe7\xe3o at\xe9 #{date}","meta.ui.reason.test_not_started":"Servidores fechados at\xe9 o in\xedcio do teste: #{date}","meta.ui.reason.player_not_exist":"O jogador n\xe3o existe","meta.ui.reason.player_will_be_deleted":"A conta ser\xe1 exclu\xedda","meta.ui.reason.gdpr_accept_required":"\xc9 necess\xe1rio aprovar novamente o contrato","meta.ui.reason.friends_and_family_test":"Os servidores estar\xe3o on-line das 12h \xe0s 20h (UTC). Pr\xf3xima sess\xe3o em #{date}","meta.ui.gdpr.acception_text":"Eu li e concordo com o Contrato de Licen\xe7a de Usu\xe1rio Final","meta.ui.gdpr.profile_delete":"Excluir conta","meta.ui.gdpr.profile_stats_label":"Mostrar estat\xedsticas de jogo para outros jogadores?","meta.ui.gdpr.profile_stats_explainer_open":'Se voc\xea planeja jogar com v\xe1rios jogadores, recomendamos selecionar "Estat\xedsticas Abertas" para obter o m\xe1ximo de experi\xeancia de jogo.\n<br><br>\nNo Modo Aberto, voc\xea poder\xe1:\n+ Participar de classifica\xe7\xf5es \n+ Ver as estat\xedsticas de outras pessoas \n+ Ver as pontua\xe7\xf5es de outros jogadores\n+ Reproduzir Replays de batalhas de outra pessoa\n+ Outros jogadores tamb\xe9m poder\xe3o ver suas estat\xedsticas.',"meta.ui.gdpr.profile_stats_explainer_close":"No modo privado, suas estat\xedsticas ficam ocultas de olhos curiosos. N\xe3o recomendamos essa op\xe7\xe3o se voc\xea planeja jogar no modo multijogador.\n<br><br>\nNesse modo, voc\xea n\xe3o ter\xe1 acesso a:\n+ Classifica\xe7\xf5es gerais\n+ Estat\xedsticas e lutas de outros jogadores\n+ Replays de outros jogadores","meta.ui.gdpr.profile_stats_explainer_subtitle":"Voc\xea pode alterar essa configura\xe7\xe3o posteriormente nas op\xe7\xf5es do jogo.","meta.ui.gdpr.profile_stats_hide":"Ocultar estat\xedsticas","meta.ui.gdpr.profile_stats_show":"Mostrar estat\xedsticas","meta.ui.gdpr.profile_decline":"Recusar","meta.ui.gdpr.profile_accept":"Aceitar","meta.ui.gdpr.delete.title":"Deletar conta","meta.ui.gdpr.delete.desc":'Tem certeza de que deseja excluir sua conta?\nTodos os dados ser\xe3o apagados para sempre.\nSe voc\xea deseja continuar, digite "#{keyword}" no campo abaixo:',"meta.ui.gdpr.delete.recovery":"Voc\xea tem 3 dias ap\xf3s esta a\xe7\xe3o para recuperar sua conta. Para fazer isso, voc\xea s\xf3 precisa fazer o login.","meta.ui.gdpr.delete.keyword":"Excluir","meta.ui.gdpr.delete.submit":"Deletar conta","meta.ui.gdpr.delete.decline":"N\xe3o, guarde","meta.hint.gdpr.acception_helper":"Ao alternar as op\xe7\xf5es, voc\xea ver\xe1 uma descri\xe7\xe3o abaixo de como o jogo se comportar\xe1 com cada sele\xe7\xe3o."},pl:{"meta.ui.load.connecting":"\u0141\u0105czenie z serwerem...","meta.ui.load.reload_button":"Ponowna pr\xf3ba","meta.ui.load.login":"Logowanie...","meta.ui.load.localization":"Synchronizacja narodowo\u015bci...","meta.ui.load.information":"Synchronizacja bazy danych wiedzy...","meta.ui.load.commanders_templates":"Synchronizacja szablon\xf3w dow\xf3dc\xf3w...","meta.ui.load.commanders":"Synchronizacja dow\xf3dc\xf3w...","meta.ui.load.troops":"Synchronizacja jednostek...","meta.ui.load.tech":"Synchronizacja drzewka technologii","meta.ui.load.tech_amount":"Synchronizacja baraku...","meta.ui.load.failed":"Nie mo\u017cna zalogowa\u0107 si\u0119 na serwer","meta.ui.load.maps":"Synchronizacja map...","meta.ui.load.campaigns":"Synchronizacja kampanii...","meta.ui.load.inventory":"Synchronizacja zapas\xf3w...","meta.ui.button_exit":"Zamknij gr\u0119","meta.ui.error.auth":"Zabrania si\u0119 nieuwierzytelnionych po\u0142\u0105cze\u0144","meta.ui.error.connect":"B\u0142\u0105d po\u0142\u0105czenia","meta.ui.error.player_deleted":"Konto tego gracza zosta\u0142o usuni\u0119te","meta.ui.error.player_will_be_deleted":"Konto gracza zostanie usuni\u0119te #{deleteAt}","meta.ui.error.auth_failed":"Uwierzytelnianie gracza nieudane","meta.ui.error.auth_server_response":"B\u0142\u0105d uwierzytelniania odpowiedzi serwera","meta.ui.error.auth_server_timeout":"Brak odpowiedzi z serwera uwierzytelniania","meta.ui.error.bad_cache":"Wykryto rozbie\u017cno\u015b\u0107 danych gracza mi\u0119dzy serwerem a klientem. \nPrzepraszamy. \nSpr\xf3buj ponownie wczyta\u0107 interfejs. Je\u015bli problem nie zniknie, uruchom gr\u0119 ponownie","meta.ui.error.bad_config":"B\u0142\u0105d konfiguracji serwera. \nPowiadom deweloper\xf3w","meta.ui.error.bad_format":"B\u0142\u0105d danych przekazywanych na serwer. \nPowiadom deweloper\xf3w","meta.ui.error.bad_id":"\u017b\u0105danego obiektu nie znaleziono na serwerze. \nPowiadom deweloper\xf3w","meta.ui.error.bad_value":"Na serwer przes\u0142ano b\u0142\u0119dne warto\u015bci. \nPowiadom deweloper\xf3w","meta.ui.error.login_disabled":"Gra zamkni\u0119ta","meta.ui.error.login_disabled_until":"Gra jest chwilowo zamkni\u0119ta a\u017c do #{date}","meta.ui.error.player_busy":"Operacja nie jest mo\u017cliwa dla obecnego stanu gracza","meta.ui.error.auth_server_ban_temporary":"Zablokowano ci\u0119 a\u017c do #{date}","meta.ui.error.auth_server_ban_permanent":"Zablokowano ci\u0119 na sta\u0142e","meta.ui.error.bad_operation":"Podano niepoprawny rozkaz","meta.ui.error.socket.no_response":"Utracono po\u0142\u0105czenie z serwerem","meta.ui.error.socket.not_initialised":"Brak po\u0142\u0105czenia z serwerem","meta.ui.error.steam_server_response":"Nieprawid\u0142owa odpowied\u017a serwera Steam","meta.ui.error.attention":"Uwaga","meta.ui.error.not_authenticated":"Nie uwierzytelniono","meta.ui.reason.auth_server_ban_temporary":"Zablokowano ci\u0119 a\u017c do #{date}","meta.ui.reason.auth_server_ban_permanent":"Zablokowano ci\u0119 na sta\u0142e","meta.ui.reason.auth_failed":"Nie mo\u017cna uwierzytelni\u0107","meta.ui.reason.maintenance":"Serwery nieczynne ze wzgl\u0119du na przerw\u0119 techniczn\u0105","meta.ui.reason.maintenance_until":"Serwery nieczynne ze wzgl\u0119du na przerw\u0119 techniczn\u0105 a\u017c do #{date}","meta.ui.reason.test_not_started":"Serwery nieczynne a\u017c do rozpocz\u0119cia pr\xf3by: #{date}","meta.ui.reason.player_not_exist":"Ten gracz nie istnieje","meta.ui.reason.player_will_be_deleted":"Konto zostanie usuni\u0119te","meta.ui.reason.gdpr_accept_required":"Musi ponownie zatwierdzi\u0107 umow\u0119","meta.ui.reason.friends_and_family_test":"Serwery b\u0119d\u0105 dzia\u0142a\u0107 od godz. 12:00 do 20:00 (UTC). Nast\u0119pne uruchomienie #{date}","meta.ui.gdpr.acception_text":"Zapozna\u0142em/am si\u0119 z umow\u0105 u\u017cytkownika ko\u0144cowego i zgadzam si\u0119 na jej warunki.","meta.ui.gdpr.profile_delete":"Usu\u0144 konto","meta.ui.gdpr.profile_stats_label":"Czy pokaza\u0107 statystyki gry innym graczom?","meta.ui.gdpr.profile_stats_explainer_open":"Je\u015bli planujesz bra\u0107 udzia\u0142 w rozgrywce sieciowej, zalecamy wybranie opcji @Poka\u017c statystyki@, aby uzyska\u0107 maksymalne wra\u017cenia z gry.\n<br><br>\nW trybie otwartym masz mo\u017cliwo\u015b\u0107:\n+ uczestniczenia w rankingach,\n+ zobaczenia statystyk innych os\xf3b, \n+ zobaczenia wynik\xf3w bitew innych graczy,\n+ odtworzenia powt\xf3rek bitew innych graczy,\n+ pokazania innym graczom swoich statystyk.","meta.ui.gdpr.profile_stats_explainer_close":"W trybie prywatnym twoje statystyki s\u0105 ukryte przed innymi graczami. Nie polecamy tej opcji, je\u015bli planujesz bra\u0107 udzia\u0142 w rozgrywce sieciowej.\n<br><br>\nW tym trybie niedost\u0119pne s\u0105:\n+ miejsce w rankingu og\xf3lnym,\n+ statystyki oraz wyniki bitew innych graczy,\n+ powt\xf3rki z walk innych graczy.","meta.ui.gdpr.profile_stats_explainer_subtitle":"Mo\u017cesz p\xf3\u017aniej zmieni\u0107 to ustawienie w opcjach gry.","meta.ui.gdpr.profile_stats_hide":"Ukryj statystyki","meta.ui.gdpr.profile_stats_show":"Poka\u017c statystyki","meta.ui.gdpr.profile_decline":"Odrzu\u0107","meta.ui.gdpr.profile_accept":"Przyjmij","meta.ui.gdpr.delete.title":"Usu\u0144 konto","meta.ui.gdpr.delete.desc":"Czy na pewno chcesz usun\u0105\u0107 swoje konto?\nWszystkie dane zostan\u0105 usuni\u0119te na zawsze.\nJe\u015bli chcesz kontynuowa\u0107, wpisz \u201e#{keyword}\u201d w poni\u017cszym polu:","meta.ui.gdpr.delete.recovery":"Po wykonaniu tej czynno\u015bci masz 3 dni na odzyskanie konta. Aby to zrobi\u0107 wystarczy si\u0119 zalogowa\u0107.","meta.ui.gdpr.delete.keyword":"Usu\u0144","meta.ui.gdpr.delete.submit":"Usu\u0144 konto","meta.ui.gdpr.delete.decline":"Nie, zatrzymaj","meta.hint.gdpr.acception_helper":"Gdy b\u0119dziesz prze\u0142\u0105cza\u0142 opcje, poni\u017cej zobaczysz opis, jak gra zachowa si\u0119 przy ka\u017cdym wyborze."},jp:{"meta.ui.load.connecting":"\u30b5\u30fc\u30d0\u30fc\u306b\u63a5\u7d9a\u3057\u3066\u3044\u307e\u3059\u2026","meta.ui.load.reload_button":"\u30ea\u30c8\u30e9\u30a4","meta.ui.load.login":"\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3044\u307e\u3059\u2026","meta.ui.load.localization":"\u5730\u57df\u5225\u306e\u8a2d\u5b9a\u60c5\u5831\u3092\u540c\u671f\u3057\u3066\u3044\u307e\u3059\u2026","meta.ui.load.information":"\u77e5\u8b58\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u540c\u671f\u3057\u3066\u3044\u307e\u3059\u2026","meta.ui.load.commanders_templates":"\u6307\u63ee\u5b98\u306e\u57fa\u790e\u30c7\u30fc\u30bf\u3092\u540c\u671f\u3057\u3066\u3044\u307e\u3059\u2026","meta.ui.load.commanders":"\u6307\u63ee\u5b98\u3092\u540c\u671f\u3057\u3066\u3044\u307e\u3059\u2026","meta.ui.load.troops":"\u30e6\u30cb\u30c3\u30c8\u3092\u540c\u671f\u3057\u3066\u3044\u307e\u3059\u2026","meta.ui.load.tech":"\u6280\u8853\u30c4\u30ea\u30fc\u3092\u540c\u671f\u3057\u3066\u3044\u307e\u3059\u2026","meta.ui.load.tech_amount":"\u5175\u820e\u3092\u540c\u671f\u3057\u3066\u3044\u307e\u3059\u2026","meta.ui.load.failed":"\u30b5\u30fc\u30d0\u30fc\u306b\u30ed\u30b0\u30a4\u30f3\u3067\u304d\u307e\u305b\u3093","meta.ui.load.maps":"\u30de\u30c3\u30d7\u3092\u540c\u671f\u3059\u308b...","meta.ui.load.campaigns":"\u30ad\u30e3\u30f3\u30da\u30fc\u30f3\u3092\u540c\u671f\u3059\u308b...","meta.ui.load.inventory":"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306e\u540c\u671f...","meta.ui.button_exit":"\u30b2\u30fc\u30e0\u3092\u9589\u3058\u308b","meta.ui.error.auth":"\u4e0d\u6b63\u30a2\u30af\u30bb\u30b9\u306f\u906e\u65ad\u3055\u308c\u307e\u3059","meta.ui.error.connect":"\u63a5\u7d9a\u30a8\u30e9\u30fc","meta.ui.error.player_deleted":"\u3053\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u306f\u524a\u9664\u3055\u308c\u307e\u3057\u305f","meta.ui.error.player_will_be_deleted":"\u30d7\u30ec\u30a4\u30e4\u30fc\u30a2\u30ab\u30a6\u30f3\u30c8\u306f\u524a\u9664\u3055\u308c\u307e\u3059 #{deleteAt}.","meta.ui.error.auth_failed":"\u30d7\u30ec\u30a4\u30e4\u30fc\u8a8d\u8a3c\u306b\u5931\u6557\u3057\u307e\u3057\u305f","meta.ui.error.auth_server_response":"\u30b5\u30fc\u30d0\u30fc\u5fdc\u7b54\u8a8d\u8a3c\u4e2d\u306b\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f","meta.ui.error.auth_server_timeout":"\u8a8d\u8a3c\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u5fdc\u7b54\u304c\u3042\u308a\u307e\u305b\u3093","meta.ui.error.bad_cache":"\u30b5\u30fc\u30d0\u30fc\u3068\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u30c7\u30fc\u30bf\u304c\u4e00\u81f4\u3057\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u7533\u3057\u8a33\u3054\u3056\u3044\u307e\u305b\u3093\u3002\n\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3092\u30ea\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u554f\u984c\u304c\u89e3\u6c7a\u3057\u306a\u3044\u5834\u5408\u306f\u30b2\u30fc\u30e0\u3092\u518d\u8d77\u52d5\u3057\u3066\u304f\u3060\u3055\u3044","meta.ui.error.bad_config":"\u30b5\u30fc\u30d0\u30fc\u8a2d\u5b9a\u3067\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\n\u958b\u767a\u5143\u306b\u5831\u544a\u3057\u3066\u304f\u3060\u3055\u3044","meta.ui.error.bad_format":"\u30b5\u30fc\u30d0\u30fc\u306b\u9001\u3089\u308c\u305f\u30c7\u30fc\u30bf\u306b\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\n\u958b\u767a\u5143\u306b\u5831\u544a\u3057\u3066\u304f\u3060\u3055\u3044","meta.ui.error.bad_id":"\u30ea\u30af\u30a8\u30b9\u30c8\u3055\u308c\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u30b5\u30fc\u30d0\u30fc\u5185\u3067\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\n\u958b\u767a\u5143\u306b\u5831\u544a\u3057\u3066\u304f\u3060\u3055\u3044","meta.ui.error.bad_value":"\u4e0d\u6b63\u306a\u6570\u5024\u304c\u30b5\u30fc\u30d0\u30fc\u306b\u9001\u3089\u308c\u307e\u3057\u305f\u3002\n\u958b\u767a\u5143\u306b\u5831\u544a\u3057\u3066\u304f\u3060\u3055\u3044","meta.ui.error.login_disabled":"\u30b2\u30fc\u30e0\u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093","meta.ui.error.login_disabled_until":"#{date}\u307e\u3067\u3001\u30b2\u30fc\u30e0\u306f\u4e00\u6642\u7684\u306b\u5229\u7528\u3067\u304d\u307e\u305b\u3093","meta.ui.error.player_busy":"\u73fe\u5728\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306e\u72b6\u614b\u3067\u306f\u64cd\u4f5c\u304c\u3067\u304d\u306a\u3044","meta.ui.error.auth_server_ban_temporary":"#{date}\u307e\u3067\u3042\u306a\u305f\u306fBAN\u3055\u308c\u3066\u3044\u307e\u3059","meta.ui.error.auth_server_ban_permanent":"\u3042\u306a\u305f\u306f\u6c38\u4e45\u7684\u306bBAN\u3055\u308c\u3066\u3044\u307e\u3059","meta.ui.error.bad_operation":"\u7121\u52b9\u306a\u30b3\u30de\u30f3\u30c9\u304c\u5165\u529b\u3055\u308c\u307e\u3057\u305f","meta.ui.error.socket.no_response":"\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u5207\u65ad\u3055\u308c\u307e\u3057\u305f","meta.ui.error.socket.not_initialised":"\u30b5\u30fc\u30d0\u30fc\u306b\u63a5\u7d9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093","meta.ui.error.steam_server_response":"Steam\u30b5\u30fc\u30d0\u30fc\u306e\u5fdc\u7b54\u306b\u4e0d\u5177\u5408\u304c\u3042\u308a\u307e\u3057\u305f","meta.ui.error.attention":"\u6ce8\u610f","meta.ui.error.not_authenticated":"\u672a\u627f\u8a8d","meta.ui.reason.auth_server_ban_temporary":"#{date}\u307e\u3067\u3042\u306a\u305f\u306fBAN\u3055\u308c\u3066\u3044\u307e\u3059","meta.ui.reason.auth_server_ban_permanent":"\u3042\u306a\u305f\u306f\u6c38\u4e45\u7684\u306bBAN\u3055\u308c\u3066\u3044\u307e\u3059","meta.ui.reason.auth_failed":"\u8a8d\u8a3c\u3067\u304d\u307e\u305b\u3093","meta.ui.reason.maintenance":"\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u306e\u305f\u3081\u30b5\u30fc\u30d0\u30fc\u304c\u9589\u9396\u3055\u308c\u3066\u3044\u307e\u3059","meta.ui.reason.maintenance_until":"#{date}\u307e\u3067\u3001\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u306e\u305f\u3081\u30b5\u30fc\u30d0\u30fc\u304c\u9589\u9396\u3055\u308c\u3066\u3044\u307e\u3059","meta.ui.reason.test_not_started":"\u30c6\u30b9\u30c8\u958b\u59cb\u307e\u3067\u30b5\u30fc\u30d0\u30fc\u306f\u9589\u9396\u3055\u308c\u307e\u3059: #{date}","meta.ui.reason.player_not_exist":"\u305d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306f\u5b58\u5728\u3057\u307e\u305b\u3093","meta.ui.reason.player_will_be_deleted":"\u30a2\u30ab\u30a6\u30f3\u30c8\u304c\u524a\u9664\u3055\u308c\u307e\u3059","meta.ui.reason.gdpr_accept_required":"\u5951\u7d04\u66f8\u306e\u518d\u627f\u8a8d\u304c\u5fc5\u8981","meta.ui.reason.friends_and_family_test":"\u30b5\u30fc\u30d0\u30fc\u306f21:00\u304b\u3089\u7fcc\u65e505:00\u307e\u3067\u30aa\u30f3\u30e9\u30a4\u30f3\u306b\u306a\u308a\u307e\u3059\u3002\u6b21\u306e\u958b\u59cb\u6642\u523b\u306f#{date}\u3067\u3059","meta.ui.gdpr.acception_text":"\u30bd\u30d5\u30c8\u30a6\u30a7\u30a2\u5229\u7528\u8a31\u8afe\u5951\u7d04\u3092\u78ba\u8a8d\u3057\u3001\u305d\u306e\u5185\u5bb9\u306b\u540c\u610f\u3057\u307e\u3059","meta.ui.gdpr.profile_delete":"\u30a2\u30ab\u30a6\u30f3\u30c8\u524a\u9664","meta.ui.gdpr.profile_stats_label":"\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306e\u30b2\u30fc\u30e0\u30b9\u30bf\u30c3\u30c4\u3092\u8868\u793a\u3059\u308b\uff1f","meta.ui.gdpr.profile_stats_explainer_open":"\u30de\u30eb\u30c1\u30d7\u30ec\u30a4\u3092\u3059\u308b\u5834\u5408\u306f\u3001\u6700\u5927\u9650\u306e\u30b2\u30fc\u30e0\u4f53\u9a13\u3092\u5f97\u308b\u305f\u3081\u306b\u3001\u300c\u30aa\u30fc\u30d7\u30f3\u7d71\u8a08\u300d\u3092\u9078\u629e\u3059\u308b\u3053\u3068\u3092\u304a\u52e7\u3081\u3057\u307e\u3059\u3002\n<br><br>\n\u30aa\u30fc\u30d7\u30f3\u30e2\u30fc\u30c9\u3067\u306f\u3001\u4ee5\u4e0b\u306e\u3053\u3068\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\uff1a\n+ \u30e9\u30f3\u30ad\u30f3\u30b0\u306b\u53c2\u52a0\u3059\u308b \n+ \u661f\u3092\u898b\u308b \n+ \u30b9\u30b3\u30a2\u3092\u898b\u308b\n+ \u3048\u3093\u304e\u3092\u306a\u304a\u3059\n+ \u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u3082\u3042\u306a\u305f\u306e\u7d71\u8a08\u60c5\u5831\u3092\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002","meta.ui.gdpr.profile_stats_explainer_close":"\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u30e2\u30fc\u30c9\u3067\u306f\u3001\u3042\u306a\u305f\u306e\u7d71\u8a08\u60c5\u5831\u306f\u8997\u304d\u898b\u3055\u308c\u306a\u3044\u3088\u3046\u306b\u96a0\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u30de\u30eb\u30c1\u30d7\u30ec\u30a4\u3092\u3059\u308b\u4e88\u5b9a\u304c\u3042\u308b\u5834\u5408\u306f\u3001\u3053\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u304a\u52e7\u3081\u3057\u307e\u305b\u3093\u3002\n<br><br>\n\u3053\u306e\u30e2\u30fc\u30c9\u3067\u306f\u3001\u3042\u306a\u305f\u306f\u3067\u304d\u306a\u3044\u3067\u3057\u3087\u3046\uff1a\n+  \u7dcf\u5408\u30e9\u30f3\u30ad\u30f3\u30b0\n+ \u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u3068\u30d5\u30a1\u30a4\u30c8\n+ \u30ea\u30d7\u30ec\u30a4\u30b9","meta.ui.gdpr.profile_stats_explainer_subtitle":"\u3053\u306e\u8a2d\u5b9a\u306f\u3001\u5f8c\u3067\u30b2\u30fc\u30e0\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u5909\u66f4\u3067\u304d\u307e\u3059\u3002","meta.ui.gdpr.profile_stats_hide":"\u7d71\u8a08\u3092\u975e\u8868\u793a\u306b\u3059\u308b","meta.ui.gdpr.profile_stats_show":"\u30aa\u30fc\u30d7\u30f3\u7d71\u8a08","meta.ui.gdpr.profile_decline":"\u540c\u610f\u3057\u306a\u3044","meta.ui.gdpr.profile_accept":"\u540c\u610f\u3059\u308b","meta.ui.gdpr.delete.title":"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u524a\u9664\u3059\u308b","meta.ui.gdpr.delete.desc":"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u524a\u9664\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b?\n\u3059\u3079\u3066\u306e\u30c7\u30fc\u30bf\u306f\u6c38\u4e45\u306b\u6d88\u53bb\u3055\u308c\u307e\u3059\u3002\n\u7d9a\u884c\u3059\u308b\u5834\u5408\u306f\u3001\u4e0b\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u300c#{keyword}\u300d\u3068\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002","meta.ui.gdpr.delete.recovery":"\u3053\u306e\u64cd\u4f5c\u5f8c 3 \u65e5\u4ee5\u5185\u306b\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u56de\u5fa9\u3057\u3066\u304f\u3060\u3055\u3044\u3002 \u3053\u308c\u3092\u884c\u3046\u306b\u306f\u3001\u30ed\u30b0\u30a4\u30f3\u3059\u308b\u3060\u3051\u3067\u6e08\u307f\u307e\u3059\u3002","meta.ui.gdpr.delete.keyword":"\u6d88\u53bb","meta.ui.gdpr.delete.submit":"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u524a\u9664\u3059\u308b","meta.ui.gdpr.delete.decline":"\u3044\u3044\u3048\u3001\u305d\u306e\u307e\u307e\u306b\u3057\u3066\u304a\u3044\u3066\u304f\u3060\u3055\u3044","meta.hint.gdpr.acception_helper":"\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u5207\u308a\u66ff\u3048\u308b\u3068\u3001\u305d\u308c\u305e\u308c\u306e\u9078\u629e\u3067\u30b2\u30fc\u30e0\u304c\u3069\u306e\u3088\u3046\u306b\u52d5\u4f5c\u3059\u308b\u306e\u304b\u3001\u4e0b\u306b\u8aac\u660e\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002"},ko:{"meta.ui.load.connecting":"\uc11c\ubc84\uc5d0 \uc811\uc18d \uc911...","meta.ui.load.reload_button":"\uc7ac\uc2dc\ub3c4","meta.ui.load.login":"\ub85c\uadf8\uc778 \uc911...","meta.ui.load.localization":"\ub85c\uce98 \ub3d9\uae30\ud654 \uc911...","meta.ui.load.information":"\uae30\uc220 \uc790\ub8cc \ub3d9\uae30\ud654 \uc911...","meta.ui.load.commanders_templates":"\uc9c0\ud718\uad00 \ud15c\ud50c\ub9bf \ub3d9\uae30\ud654 \uc911...","meta.ui.load.commanders":"\uc9c0\ud718\uad00 \ub3d9\uae30\ud654 \uc911...","meta.ui.load.troops":"\uc720\ub2db \ub3d9\uae30\ud654 \uc911...","meta.ui.load.tech":"\uae30\uc220 \uacc4\ud1b5\ub3c4 \ub3d9\uae30\ud654 \uc911...","meta.ui.load.tech_amount":"\ub9c9\uc0ac \ub3d9\uae30\ud654 \uc911...","meta.ui.load.failed":"\uc11c\ubc84\uc5d0 \ub85c\uadf8\uc778\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4","meta.ui.load.maps":"\uc9c0\ub3c4 \ub3d9\uae30\ud654 \uc911...","meta.ui.load.campaigns":"\ucea0\ud398\uc778 \ub3d9\uae30\ud654...","meta.ui.load.inventory":"\uc778\ubca4\ud1a0\ub9ac \ub3d9\uae30\ud654...","meta.ui.button_exit":"\uac8c\uc784 \ub2eb\uae30","meta.ui.error.auth":"\ube44\uc778\uac00 \uc811\uc18d\uc774 \uac70\ubd80\ub418\uc5c8\uc2b5\ub2c8\ub2e4.","meta.ui.error.connect":"\uc811\uc18d \uc624\ub958","meta.ui.error.player_deleted":"\uc774 \ud50c\ub808\uc774\uc5b4\uc758 \uacc4\uc815\uc740 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.","meta.ui.error.player_will_be_deleted":"\ud50c\ub808\uc774\uc5b4 \uacc4\uc815\uc774 \uc0ad\uc81c\ub428 #{deleteAt}","meta.ui.error.auth_failed":"\ud50c\ub808\uc774\uc5b4 \uc778\uc99d \uc2e4\ud328","meta.ui.error.auth_server_response":"\uc11c\ubc84 \ud68c\uc2e0 \uc778\uc99d \uc624\ub958","meta.ui.error.auth_server_timeout":"\uc778\uc99d \uc11c\ubc84 \ud68c\uc2e0 \uc5c6\uc74c","meta.ui.error.bad_cache":"\uc11c\ubc84-\ud074\ub77c\uc774\uc5b8\ud2b8 \uac04 \ud50c\ub808\uc774\uc5b4 \ub370\uc774\ud130 \ubd88\uc77c\uce58\uac00 \uac10\uc9c0\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \n\uc8c4\uc1a1\ud569\ub2c8\ub2e4. \n\uc778\ud130\ud398\uc774\uc2a4\ub97c \ub2e4\uc2dc \ub85c\ub529\ud574 \ubcf4\uc2ed\uc2dc\uc624. \uacc4\uc18d \ubb38\uc81c\uac00 \ubc1c\uc0dd\ud55c\ub2e4\uba74 \uac8c\uc784\uc744 \ub2e4\uc2dc \uc2dc\uc791\ud574 \ubcf4\uc2ed\uc2dc\uc624.","meta.ui.error.bad_config":"\uc11c\ubc84 \uad6c\uc131 \uc624\ub958. \n\uac1c\ubc1c\uc790\uc5d0\uac8c \uc5f0\ub77d\ud574 \uc8fc\uc2ed\uc2dc\uc624.","meta.ui.error.bad_format":"\uc11c\ubc84\uc5d0 \uc804\ub2ec\ub41c \ub370\uc774\ud130 \uc624\ub958. \n\uac1c\ubc1c\uc790\uc5d0\uac8c \uc5f0\ub77d\ud574 \uc8fc\uc2ed\uc2dc\uc624.","meta.ui.error.bad_id":"\uc694\uccad\ud55c \uc624\ube0c\uc81d\ud2b8\uac00 \uc11c\ubc84\uc5d0 \uc5c6\uc2b5\ub2c8\ub2e4. \n\uac1c\ubc1c\uc790\uc5d0\uac8c \uc5f0\ub77d\ud574 \uc8fc\uc2ed\uc2dc\uc624.","meta.ui.error.bad_value":"\uc798\ubabb\ub41c \uac12\uc774 \uc11c\ubc84\uc5d0 \uc804\ub2ec\ub410\uc2b5\ub2c8\ub2e4. \n\uac1c\ubc1c\uc790\uc5d0\uac8c \uc5f0\ub77d\ud574 \uc8fc\uc2ed\uc2dc\uc624.","meta.ui.error.login_disabled":"\uac8c\uc784 \ub2eb\ud798","meta.ui.error.login_disabled_until":"#{date}\uae4c\uc9c0 \uac8c\uc784\uc774 \uc77c\uc2dc\uc801\uc73c\ub85c \uc11c\ube44\uc2a4 \uc911\ub2e8\ub429\ub2c8\ub2e4.","meta.ui.error.player_busy":"\ud604\uc7ac \ud50c\ub808\uc774\uc5b4 \uc0c1\ud0dc\uc5d0\uc11c\ub294 \uc870\uc791\uc774 \ubd88\uac00\ub2a5\ud569\ub2c8\ub2e4.","meta.ui.error.auth_server_ban_temporary":"#{date}\uae4c\uc9c0 \ucc28\ub2e8\ub418\uc5c8\uc2b5\ub2c8\ub2e4.","meta.ui.error.auth_server_ban_permanent":"\uc601\uad6c \ucc28\ub2e8\ub418\uc5c8\uc2b5\ub2c8\ub2e4.","meta.ui.error.bad_operation":"\uc798\ubabb\ub41c \ucee4\ub9e8\ub4dc \uc694\uccad\uc785\ub2c8\ub2e4.","meta.ui.error.socket.no_response":"\uc11c\ubc84\uc640 \uc5f0\uacb0\uc774 \ub04a\uacbc\uc2b5\ub2c8\ub2e4.","meta.ui.error.socket.not_initialised":"\uc11c\ubc84\uc5d0 \uc5f0\uacb0\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.","meta.ui.error.steam_server_response":"\uc798\ubabb\ub41c Steam \uc11c\ubc84 \uc751\ub2f5","meta.ui.error.attention":"\uacbd\uace0","meta.ui.error.not_authenticated":"\ubbf8\uc778\uc99d","meta.ui.reason.auth_server_ban_temporary":"#{date}\uae4c\uc9c0 \ucc28\ub2e8\ub418\uc5c8\uc2b5\ub2c8\ub2e4.","meta.ui.reason.auth_server_ban_permanent":"\uc601\uad6c \ucc28\ub2e8\ub418\uc5c8\uc2b5\ub2c8\ub2e4.","meta.ui.reason.auth_failed":"\uc778\uc99d \ubd88\uac00","meta.ui.reason.maintenance":"\uc810\uac80\uc73c\ub85c \uc778\ud55c \uc11c\ubc84 \uc885\ub8cc","meta.ui.reason.maintenance_until":"\uc810\uac80\uc73c\ub85c #{date}\uae4c\uc9c0 \uc11c\ubc84\ub97c \ub2eb\uc2b5\ub2c8\ub2e4.","meta.ui.reason.test_not_started":"\ud14c\uc2a4\ud2b8\ub85c \uc778\ud574 \uc11c\ubc84\ub97c \ub2eb\uc2b5\ub2c8\ub2e4. \ud14c\uc2a4\ud2b8 \uc2dc\uc791 \uc2dc\uac04: #{date}","meta.ui.reason.player_not_exist":"\uc874\uc7ac\ud558\uc9c0 \uc54a\ub294 \ud50c\ub808\uc774\uc5b4","meta.ui.reason.player_will_be_deleted":"\uacc4\uc815\uc774 \uc0ad\uc81c\ub429\ub2c8\ub2e4","meta.ui.reason.gdpr_accept_required":"\uacc4\uc57d\uc744 \uc7ac\uc2b9\uc778\ud574\uc57c \ud568","meta.ui.reason.friends_and_family_test":"12:00~\uc624\ud6c4 8:00\uae4c\uc9c0 \uc11c\ubc84\uac00 \uc628\ub77c\uc778\uc785\ub2c8\ub2e4. (UTC \uae30\uc900) \ub2e4\uc74c \uc2dc\uc791 #{date}","meta.ui.gdpr.acception_text":"\ucd5c\uc885 \uc0ac\uc6a9\uc790 \ub77c\uc774\uc120\uc2a4 \uacc4\uc57d\uc744 \uc77d\uc5c8\uc73c\uba70 \uc774\uc5d0 \ub3d9\uc758\ud569\ub2c8\ub2e4","meta.ui.gdpr.profile_delete":"\uacc4\uc815 \uc0ad\uc81c","meta.ui.gdpr.profile_stats_label":"\ub2e4\ub978 \ud50c\ub808\uc774\uc5b4\uc758 \uac8c\uc784 \ud1b5\uacc4\ub97c \ud45c\uc2dc\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?","meta.ui.gdpr.profile_stats_explainer_open":"\uba40\ud2f0\ud50c\ub808\uc774\uc5b4\ub97c \ud50c\ub808\uc774\ud560 \uacc4\ud68d\uc774\ub77c\uba74 \ud1b5\uacc4 \uacf5\uac1c \ubaa8\ub4dc\ub97c \uc120\ud0dd\ud574 \ucd5c\uace0\uc758 \uac8c\uc784 \ud658\uacbd\uc744 \uacbd\ud5d8\ud558\ub294 \uac83\uc774 \uc88b\uc2b5\ub2c8\ub2e4.\n<br><br>\n\uacf5\uac1c \ubaa8\ub4dc\uc5d0\uc11c\ub294 \ub2e4\uc74c\uc744 \uc218\ud589\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4:\n+ \ub7ad\ud0b9 \ucc38\uc5ec \n+ \ub2e4\ub978 \uc0ac\ub78c\uc758 \ud1b5\uacc4 \ubcf4\uae30 \n+ \ub2e4\ub978 \ud50c\ub808\uc774\uc5b4\uc758 \uc810\uc218 \ubcf4\uae30\n+ \ub2e4\ub978 \ud50c\ub808\uc774\uc5b4\uc758 \uc804\ud22c \ub9ac\ud50c\ub808\uc774\n+ \ub2e4\ub978 \ud50c\ub808\uc774\uc5b4\ub3c4 \ub0b4 \ud1b5\uacc4\ub97c \ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4.","meta.ui.gdpr.profile_stats_explainer_close":"\ube44\uacf5\uac1c \ubaa8\ub4dc\uc5d0\uc11c\ub294 \ud1b5\uacc4\uac00 \ubcf4\uc774\uc9c0 \uc54a\uac8c \uc228\uaca8\uc9d1\ub2c8\ub2e4. \uba40\ud2f0\ud50c\ub808\uc774\uc5b4\ub97c \ud50c\ub808\uc774\ud560 \uacc4\ud68d\uc774\ub77c\uba74 \uc774 \uc635\uc158\uc744 \uc0ac\uc6a9\ud558\uc9c0 \uc54a\ub294 \uac83\uc774 \uc88b\uc2b5\ub2c8\ub2e4.\n<br><br>\n\uc774 \ubaa8\ub4dc\uc5d0\uc11c\ub294 \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4:\n+ \uc804\uccb4 \uc21c\uc704\n+ \ub2e4\ub978 \ud50c\ub808\uc774\uc5b4\uc758 \uc2a4\ud0ef \ubc0f \uc804\ud22c\n+ \ub2e4\ub978 \ud50c\ub808\uc774\uc5b4\uc758 \ub9ac\ud50c\ub808\uc774","meta.ui.gdpr.profile_stats_explainer_subtitle":"\ub098\uc911\uc5d0 \uac8c\uc784 \uc635\uc158\uc5d0\uc11c \uc774 \uc124\uc815\uc744 \ubcc0\uacbd\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.","meta.ui.gdpr.profile_stats_hide":"\ud1b5\uacc4 \uc228\uae30\uae30","meta.ui.gdpr.profile_stats_show":"\uc5f4\ub9b0 \ud1b5\uacc4","meta.ui.gdpr.profile_decline":"\uac10\uc18c","meta.ui.gdpr.profile_accept":"\uc218\uc6a9\ud558\ub2e4","meta.ui.gdpr.delete.title":"\uacc4\uc815 \uc0ad\uc81c","meta.ui.gdpr.delete.desc":'\uacc4\uc815\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?\n\ubaa8\ub4e0 \ub370\uc774\ud130\ub294 \uc601\uc6d0\ud788 \uc9c0\uc6cc\uc9d1\ub2c8\ub2e4.\n\uacc4\uc18d\ud558\ub824\uba74 \uc544\ub798 \ud544\ub4dc\uc5d0 "#{keyword}"\ub97c \uc785\ub825\ud558\uc2ed\uc2dc\uc624.',"meta.ui.gdpr.delete.recovery":"\uc774 \uc870\uce58 \ud6c4 3\uc77c \uc774\ub0b4\uc5d0 \uacc4\uc815\uc744 \ubcf5\uad6c\ud574\uc57c \ud569\ub2c8\ub2e4. \uadf8\ub7ec\uae30 \uc704\ud574\uc11c\ub294 \ub85c\uadf8\uc778\ub9cc \ud558\uba74 \ub429\ub2c8\ub2e4.","meta.ui.gdpr.delete.keyword":"\uc0ad\uc81c","meta.ui.gdpr.delete.submit":"\uacc4\uc815 \uc0ad\uc81c","meta.ui.gdpr.delete.decline":"\uc544\ub2c8\uc694, \uacc4\uc18d \ud558\uaca0\uc2b5\ub2c8\ub2e4","meta.hint.gdpr.acception_helper":"\uc635\uc158\uc744 \uc804\ud658\ud558\uba74 \uac01 \uc120\ud0dd \ud56d\ubaa9\uc5d0 \ub530\ub77c \uac8c\uc784\uc774 \uc5b4\ub5bb\uac8c \uc791\ub3d9\ud558\ub294\uc9c0\uc5d0 \ub300\ud55c \uc124\uba85\uc774 \uc544\ub798\uc5d0 \ud45c\uc2dc\ub429\ub2c8\ub2e4."},zh:{"meta.ui.load.connecting":"\u6b63\u5728\u8fde\u63a5\u670d\u52a1\u5668\u2026\u2026","meta.ui.load.reload_button":"\u91cd\u8bd5","meta.ui.load.login":"\u6b63\u5728\u767b\u5f55\u2026\u2026","meta.ui.load.localization":"\u6b63\u5728\u540c\u6b65\u672c\u5730\u4fe1\u606f\u2026\u2026","meta.ui.load.information":"\u6b63\u5728\u540c\u6b65\u6570\u636e\u5e93\u2026\u2026","meta.ui.load.commanders_templates":"\u6b63\u5728\u540c\u6b65\u6307\u6325\u5b98\u6a21\u677f\u2026\u2026","meta.ui.load.commanders":"\u6b63\u5728\u540c\u6b65\u6307\u6325\u5b98\u2026\u2026","meta.ui.load.troops":"\u6b63\u5728\u540c\u6b65\u5355\u4f4d\u2026\u2026","meta.ui.load.tech":"\u6b63\u5728\u540c\u6b65\u79d1\u6280\u6811\u2026\u2026","meta.ui.load.tech_amount":"\u6b63\u5728\u540c\u6b65\u8425\u623f\u2026\u2026","meta.ui.load.failed":"\u65e0\u6cd5\u767b\u5f55\u670d\u52a1\u5668","meta.ui.load.maps":"\u540c\u6b65\u5730\u56fe...","meta.ui.load.campaigns":"\u540c\u6b65\u6218\u5f79...","meta.ui.load.inventory":"\u540c\u6b65\u5e93\u5b58...","meta.ui.button_exit":"\u5173\u95ed\u6e38\u620f","meta.ui.error.auth":"\u9519\u8bef\uff1a\u68c0\u6d4b\u5230\u672a\u8ba4\u8bc1\u7684\u8fde\u63a5","meta.ui.error.connect":"\u8fde\u63a5\u9519\u8bef","meta.ui.error.player_deleted":"\u8be5\u73a9\u5bb6\u8d26\u53f7\u5df2\u88ab\u5220\u9664\u3002","meta.ui.error.player_will_be_deleted":"\u73a9\u5bb6\u8d26\u6237\u5c06\u88ab\u5220\u9664#{deleteAt}\u3002","meta.ui.error.auth_failed":"\u73a9\u5bb6\u8eab\u4efd\u8ba4\u8bc1\u5931\u8d25","meta.ui.error.auth_server_response":"\u670d\u52a1\u5668\u8ba4\u8bc1\u54cd\u5e94\u5931\u8d25","meta.ui.error.auth_server_timeout":"\u8ba4\u8bc1\u670d\u52a1\u5668\u65e0\u54cd\u5e94","meta.ui.error.bad_cache":"\u68c0\u6d4b\u5230\u670d\u52a1\u5668\u4e0e\u5ba2\u673a\u7684\u73a9\u5bb6\u6570\u636e\u5b58\u5728\u5dee\u5f02\u3002\n\u6211\u4eec\u5bf9\u6b64\u6df1\u611f\u62b1\u6b49\u3002\n\u8bf7\u5c1d\u8bd5\u91cd\u65b0\u52a0\u8f7d\u3002\u5982\u679c\u95ee\u9898\u6301\u7eed\uff0c\u8bf7\u91cd\u542f\u6e38\u620f","meta.ui.error.bad_config":"\u670d\u52a1\u5668\u914d\u7f6e\u51fa\u9519\n\u8bf7\u5c06\u95ee\u9898\u6c47\u62a5\u7ed9\u5f00\u53d1\u8005\u3002","meta.ui.error.bad_format":"\u670d\u52a1\u5668\u6570\u636e\u4f20\u8f93\u51fa\u9519\u3002\n\u8bf7\u5c06\u95ee\u9898\u6c47\u62a5\u7ed9\u5f00\u53d1\u8005\u3002","meta.ui.error.bad_id":"\u670d\u52a1\u5668\u672a\u627e\u5230\u8bf7\u6c42\u76ee\u6807\u3002\n\u8bf7\u5c06\u95ee\u9898\u6c47\u62a5\u7ed9\u5f00\u53d1\u8005\u3002","meta.ui.error.bad_value":"\u670d\u52a1\u5668\u4f20\u8f93\u6570\u636e\u51fa\u9519\u3002\n\u8bf7\u5c06\u95ee\u9898\u6c47\u62a5\u7ed9\u5f00\u53d1\u8005\u3002","meta.ui.error.login_disabled":"\u6e38\u620f\u5df2\u5173\u95ed","meta.ui.error.login_disabled_until":"\u6e38\u620f\u6682\u65f6\u5173\u95ed\uff0c\u91cd\u542f\u65f6\u95f4\uff1a#{date}","meta.ui.error.player_busy":"\u5728\u5f53\u524d\u73a9\u5bb6\u72b6\u6001\u4e0b\u65e0\u6cd5\u8fdb\u884c\u64cd\u4f5c","meta.ui.error.auth_server_ban_temporary":"\u4f60\u5df2\u7ecf\u88ab\u5c01\u7981\uff0c\u89e3\u5c01\u65f6\u95f4\uff1a#{date}","meta.ui.error.auth_server_ban_permanent":"\u4f60\u5df2\u88ab\u6c38\u4e45\u5c01\u7981","meta.ui.error.bad_operation":"\u65e0\u6548\u6307\u4ee4","meta.ui.error.socket.no_response":"\u5df2\u4e22\u5931\u4e0e\u670d\u52a1\u5668\u8fde\u63a5","meta.ui.error.socket.not_initialised":"\u65e0\u6cd5\u8fde\u63a5\u81f3\u670d\u52a1\u5668","meta.ui.error.steam_server_response":"Steam\u670d\u52a1\u5668\u54cd\u5e94\u9519\u8bef","meta.ui.error.attention":"\u6ce8\u610f\uff01","meta.ui.error.not_authenticated":"\u672a\u8ba4\u8bc1","meta.ui.reason.auth_server_ban_temporary":"\u4f60\u5df2\u7ecf\u88ab\u5c01\u7981\uff0c\u89e3\u5c01\u65f6\u95f4\uff1a#{date}","meta.ui.reason.auth_server_ban_permanent":"\u4f60\u5df2\u88ab\u6c38\u4e45\u5c01\u7981","meta.ui.reason.auth_failed":"\u9a8c\u8bc1\u5931\u8d25","meta.ui.reason.maintenance":"\u670d\u52a1\u5668\u7ef4\u62a4\u5173\u95ed","meta.ui.reason.maintenance_until":"\u670d\u52a1\u5668\u7ef4\u62a4\u5173\u95ed\uff0c\u91cd\u65b0\u5f00\u653e\u65f6\u95f4\uff1a#{date}","meta.ui.reason.test_not_started":"\u670d\u52a1\u5668\u5173\u95ed\u4e2d\uff0c\u6d4b\u8bd5\u5f00\u542f\u65f6\u95f4\uff1a#{date}","meta.ui.reason.player_not_exist":"\u4e0d\u5b58\u5728\u8be5\u73a9\u5bb6","meta.ui.reason.player_will_be_deleted":"\u8d26\u53f7\u5c06\u88ab\u5220\u9664","meta.ui.reason.gdpr_accept_required":"\u9700\u8981\u91cd\u65b0\u6279\u51c6\u534f\u8bae","meta.ui.reason.friends_and_family_test":"\u670d\u52a1\u5668\u5c06\u4e8e12:00 \u81f3 \u4e0b\u53488:00 \u95f4\u5f00\u653e\uff08UTC\uff09\u3002\u4e0b\u4e00\u8f6e\u5f00\u59cb\u65f6\u95f4\uff1a#{date}","meta.ui.gdpr.acception_text":"\u6211\u5df2\u7ecf\u9605\u8bfb\u5e76\u540c\u610f\u6700\u7ec8\u7528\u6237\u8bb8\u53ef\u534f\u8bae\uff08EULA\uff09","meta.ui.gdpr.profile_delete":"\u5220\u9664\u8d26\u6237","meta.ui.gdpr.profile_stats_label":"\u663e\u793a\u5176\u4ed6\u73a9\u5bb6\u7684\u6e38\u620f\u6570\u636e\uff1f","meta.ui.gdpr.profile_stats_explainer_open":"\u5982\u679c\u4f60\u6253\u7b97\u73a9\u591a\u4eba\u6e38\u620f\uff0c\u6211\u4eec\u5efa\u8bae\u9009\u62e9\u5f00\u653e\u7edf\u8ba1\uff0c\u4ee5\u83b7\u5f97\u6700\u5927\u7684\u6e38\u620f\u4f53\u9a8c\u3002\n<br><br>\n\u5728\u5f00\u653e\u6a21\u5f0f\u4e0b\uff0c\u4f60\u5c06\u80fd\u591f\uff1a\n+ \u53c2\u4e0e\u6392\u540d \n+ \u67e5\u770b\u5176\u4ed6\u4eba\u7684\u7edf\u8ba1\u8d44\u6599 \n+ \u67e5\u770b\u5176\u4ed6\u73a9\u5bb6\u7684\u5206\u6570\n+ \u91cd\u65b0\u6e38\u73a9\u548c\u522b\u4eba\u7684\u6218\u6597\n+ \u5176\u4ed6\u73a9\u5bb6\u4e5f\u53ef\u4ee5\u67e5\u770b\u4f60\u7684\u7edf\u8ba1\u8d44\u6599\u3002","meta.ui.gdpr.profile_stats_explainer_close":"\u5728\u79c1\u4eba\u6a21\u5f0f\u4e0b\uff0c\u4f60\u7684\u7edf\u8ba1\u8d44\u6599\u4f1a\u88ab\u9690\u85cf\u8d77\u6765\uff0c\u4e0d\u88ab\u4eba\u7aa5\u89c6\u3002\u5982\u679c\u4f60\u6253\u7b97\u73a9\u591a\u4eba\u6e38\u620f\uff0c\u6211\u4eec\u4e0d\u63a8\u8350\u8fd9\u4e2a\u9009\u9879\u3002\n<br><br>\n\u5728\u8fd9\u79cd\u6a21\u5f0f\u4e0b\uff0c\u4f60\u5c06\u65e0\u6cd5\uff1a\n+ \u603b\u6392\u540d\n+ \u5176\u4ed6\u73a9\u5bb6\u7684\u7edf\u8ba1\u8d44\u6599\u548c\u6218\u6597\n+ \u5176\u4ed6\u73a9\u5bb6\u7684\u56de\u653e","meta.ui.gdpr.profile_stats_explainer_subtitle":"\u60a8\u53ef\u4ee5\u7a0d\u540e\u5728\u6e38\u620f\u9009\u9879\u4e2d\u66f4\u6539\u6b64\u8bbe\u7f6e\u3002","meta.ui.gdpr.profile_stats_hide":"\u9690\u85cf\u7edf\u8ba1\u6570\u636e","meta.ui.gdpr.profile_stats_show":"\u6253\u5f00\u7edf\u8ba1","meta.ui.gdpr.profile_decline":"\u5a49\u62d2","meta.ui.gdpr.profile_accept":"\u63a5\u53d7","meta.ui.gdpr.delete.title":"\u5220\u9664\u5e10\u6237","meta.ui.gdpr.delete.desc":"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u60a8\u7684\u5e10\u6237\u5417\uff1f\n\u6240\u6709\u6570\u636e\u5c06\u88ab\u6c38\u4e45\u5220\u9664\u3002\n\u5982\u679c\u60a8\u60f3\u7ee7\u7eed\uff0c\u8bf7\u5728\u4e0b\u9762\u7684\u5b57\u6bb5\u4e2d\u8f93\u5165\u201c#{keyword}\u201d\uff1a","meta.ui.gdpr.delete.recovery":"\u5728\u6b64\u64cd\u4f5c\u4e4b\u540e\uff0c\u60a8\u6709 3 \u5929\u7684\u65f6\u95f4\u6765\u6062\u590d\u60a8\u7684\u5e10\u6237\u3002 \u4e3a\u6b64\uff0c\u60a8\u53ea\u9700\u767b\u5f55\u5373\u53ef\u3002","meta.ui.gdpr.delete.keyword":"\u5220\u9664","meta.ui.gdpr.delete.submit":"\u5220\u9664\u5e10\u6237","meta.ui.gdpr.delete.decline":"\u4e0d\uff0c\u7559\u7740","meta.hint.gdpr.acception_helper":"\u5f53\u4f60\u5207\u6362\u9009\u9879\u65f6\uff0c\u4f60\u4f1a\u770b\u5230\u4e0b\u9762\u7684\u63cf\u8ff0\uff0c\u8bf4\u660e\u6e38\u620f\u5728\u6bcf\u4e2a\u9009\u62e9\u4e0b\u4f1a\u6709\u4ec0\u4e48\u8868\u73b0\u3002"},tr:{"meta.ui.load.connecting":"Sunucuya ba\u011flan\u0131l\u0131yor...","meta.ui.load.reload_button":"Yeniden dene","meta.ui.load.login":"Giri\u015f yap\u0131l\u0131yor...","meta.ui.load.localization":"Yerel dosyalar e\u015fle\u015ftiriliyor...","meta.ui.load.information":"Bilgi veritaban\u0131 e\u015fle\u015ftiriliyor...","meta.ui.load.commanders_templates":"Kumandan \u015fablonlar\u0131 e\u015fle\u015ftiriliyor...","meta.ui.load.commanders":"Kumandanlar e\u015fle\u015ftiriliyor...","meta.ui.load.troops":"Birimler e\u015fle\u015ftiriliyor...","meta.ui.load.tech":"Teknoloji a\u011fac\u0131 e\u015fle\u015ftiriliyor...","meta.ui.load.tech_amount":"K\u0131\u015fla e\u015fle\u015ftiriliyor...","meta.ui.load.failed":"Sunucuya giri\u015f yap\u0131lam\u0131yor","meta.ui.load.maps":"Haritalar\u0131 senkronize etme...","meta.ui.load.campaigns":"Harek\xe2tlar senkronize ediliyor...","meta.ui.load.inventory":"Envanter senkronizasyonu...","meta.ui.button_exit":"Oyunu kapat","meta.ui.error.auth":"Yetkilendirilmemi\u015f ba\u011flant\u0131lar reddedilir","meta.ui.error.connect":"Ba\u011flant\u0131 hatas\u0131","meta.ui.error.player_deleted":"Bu oyuncunun hesab\u0131 silinmi\u015f","meta.ui.error.player_will_be_deleted":"Oyuncu hesab\u0131 silinecek #{deleteAt}","meta.ui.error.auth_failed":"Oyuncu yetkilendirmesi ba\u015far\u0131s\u0131z","meta.ui.error.auth_server_response":"Sunucu yan\u0131tlama yetkilendirmesinde hata","meta.ui.error.auth_server_timeout":"Yetkilendirme sunucusundan yan\u0131t al\u0131namad\u0131","meta.ui.error.bad_cache":"Sunucu ve istemci aras\u0131nda veri uyu\u015fmazl\u0131\u011f\u0131 tespit edildi.\nBundan dolay\u0131 \xfczg\xfcn\xfcz.\nAray\xfcz\xfc yeniden y\xfcklemeyi dene. Sorun devam ederse oyunu yeniden ba\u015flat","meta.ui.error.bad_config":"Sunucu yap\u0131land\u0131rmas\u0131nda hata meydana geldi.\nL\xfctfen geli\u015ftiricilere haber ver","meta.ui.error.bad_format":"Sunucuya veri aktarmada hata meydana geldi.\nL\xfctfen geli\u015ftiricilere haber ver","meta.ui.error.bad_id":"Talep edilen \xf6\u011fe sunucuda bulunamad\u0131.\nL\xfctfen geli\u015ftiricilere haber ver","meta.ui.error.bad_value":"Sunucuya yanl\u0131\u015f de\u011ferler g\xf6nderildi.\nL\xfctfen geli\u015ftiricilere haber ver","meta.ui.error.login_disabled":"Oyun kapand\u0131","meta.ui.error.login_disabled_until":"Oyun \u015fu tarihe kadar ge\xe7ici olarak kapal\u0131: #{date}","meta.ui.error.player_busy":"Mevcut oyuncu durumu i\xe7in i\u015flem m\xfcmk\xfcn de\u011fil","meta.ui.error.auth_server_ban_temporary":"#{date} tarihine kadar uzakla\u015ft\u0131r\u0131ld\u0131n","meta.ui.error.auth_server_ban_permanent":"S\xfcresiz uzakla\u015ft\u0131r\u0131ld\u0131n","meta.ui.error.bad_operation":"Ge\xe7ersiz komut talebi","meta.ui.error.socket.no_response":"Sunucuyla ba\u011flant\u0131 kesildi","meta.ui.error.socket.not_initialised":"Sunucuyla ba\u011flant\u0131 yok","meta.ui.error.steam_server_response":"Hatal\u0131 Steam sunucusu yan\u0131t\u0131","meta.ui.error.attention":"Dikkat","meta.ui.error.not_authenticated":"Yetkilendirilemedi","meta.ui.reason.auth_server_ban_temporary":"#{date} tarihine kadar uzakla\u015ft\u0131r\u0131ld\u0131n","meta.ui.reason.auth_server_ban_permanent":"S\xfcresiz uzakla\u015ft\u0131r\u0131ld\u0131n","meta.ui.reason.auth_failed":"Yetkilendirilemiyor","meta.ui.reason.maintenance":"Sunucu bak\u0131m i\xe7in kapat\u0131ld\u0131","meta.ui.reason.maintenance_until":"Sunucu #{date} tarihine kadar bak\u0131m i\xe7in kapat\u0131ld\u0131","meta.ui.reason.test_not_started":"Sunucu test sebebiyle #{date} tarihine kadar kapat\u0131ld\u0131","meta.ui.reason.player_not_exist":"Oyuncu bulunamad\u0131","meta.ui.reason.player_will_be_deleted":"Hesap silinecek","meta.ui.reason.gdpr_accept_required":"Anla\u015fman\u0131n yeniden onaylanmas\u0131 gerekiyor","meta.ui.reason.friends_and_family_test":"Sunucular TS\u0130 15.00'ten 23.00'e kadar \xe7evrimi\xe7i olacak. Sonraki a\xe7\u0131l\u0131\u015f tarihi: #{date}","meta.ui.gdpr.acception_text":"Son Kullan\u0131c\u0131 Lisans S\xf6zle\u015fmesi'ni okudum ve kabul ediyorum","meta.ui.gdpr.profile_delete":"Hesap silme","meta.ui.gdpr.profile_stats_label":"Di\u011fer oyuncular\u0131n oyun istatistikleri g\xf6sterilsin mi?","meta.ui.gdpr.profile_stats_explainer_open":"\xc7ok oyunculu oynamay\u0131 planl\u0131yorsan\u0131z, maksimum oyun deneyimi elde etmek i\xe7in @\u0130statistikleri a\xe7@ se\xe7ene\u011fini belirlemenizi \xf6neririz.\n<br><br>\nA\xe7\u0131k Mod'da \u015funlar\u0131 yapabilirsiniz:\n+ s\u0131ralamaya kat\u0131lma\n+ ba\u015fkalar\u0131n\u0131n istatistiklerini g\xf6r\xfcnt\xfcleme \n+ ba\u015fkalar\u0131n\u0131n sava\u015f sonu\xe7lar\u0131n\u0131 g\xf6r\xfcnt\xfcleme\n+ ba\u015fkas\u0131n\u0131n sava\u015flar\u0131n\u0131n tekrar\u0131n\u0131 oynatma\n+ di\u011fer oyuncular da istatistiklerinizi g\xf6r\xfcnt\xfcleyebilir.","meta.ui.gdpr.profile_stats_explainer_close":"\xd6zel modda istatistikleriniz merakl\u0131 g\xf6zlerden gizlenir. \xc7ok oyunculu oynamay\u0131 planl\u0131yorsan\u0131z bu se\xe7ene\u011fi \xf6nermiyoruz.\n<br><br>\nBu modda \u015fu \xf6zellikler kullan\u0131lamaz:\n+ genel s\u0131ralamalar\n+ di\u011fer oyuncular\u0131n istatistikleri ve sava\u015f sonu\xe7lar\u0131\n+ di\u011fer oyuncular\u0131n tekrarlar\u0131","meta.ui.gdpr.profile_stats_explainer_subtitle":"Bu ayar\u0131 daha sonra oyun se\xe7eneklerinden de\u011fi\u015ftirebilirsiniz.","meta.ui.gdpr.profile_stats_hide":"\u0130statistikleri gizle","meta.ui.gdpr.profile_stats_show":"\u0130statistikleri A\xe7","meta.ui.gdpr.profile_decline":"Reddet","meta.ui.gdpr.profile_accept":"Kabul et","meta.ui.gdpr.delete.title":"Hesab\u0131 sil","meta.ui.gdpr.delete.desc":'Hesab\u0131n\u0131 silmek istedi\u011finden emin misin?\nT\xfcm veriler sonsuza kadar silinecek.\nDevam etmek istiyorsan l\xfctfen a\u015fa\u011f\u0131daki alana "#{keyword}" yaz:',"meta.ui.gdpr.delete.recovery":"Hesab\u0131n\u0131 kurtarmak i\xe7in bu i\u015flemden sonra 3 g\xfcn\xfcn var. Bunu yapmak i\xe7in giri\u015f yapman yeterli.","meta.ui.gdpr.delete.keyword":"Sil","meta.ui.gdpr.delete.submit":"Hesab\u0131 sil","meta.ui.gdpr.delete.decline":"hay\u0131r, sende kals\u0131n","meta.hint.gdpr.acception_helper":"Se\xe7enekleri de\u011fi\u015ftirdi\u011finizde, a\u015fa\u011f\u0131da oyunun her se\xe7imde nas\u0131l davranaca\u011f\u0131na dair bir a\xe7\u0131klama g\xf6receksiniz."},ua:{"meta.ui.load.connecting":"\u0412\u0438\u0445\u043e\u0434\u0438\u043c\u043e \u043d\u0430 \u0437\u0432'\u044f\u0437\u043e\u043a","meta.ui.load.reload_button":"\u041f\u0456\u0434\u043a\u043b\u044e\u0447\u0430\u0454\u043c\u043e\u0441\u044c \u0449\u0435 \u0440\u0430\u0437","meta.ui.load.login":"\u041f\u0435\u0440\u0435\u0432\u0456\u0440\u044f\u0454\u043c\u043e \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0438...","meta.ui.load.localization":"\u0412\u0438\u0437\u043d\u0430\u0447\u0430\u0454\u043c\u043e \u043d\u0430\u0446\u0456\u043e\u043d\u0430\u043b\u044c\u043d\u0456\u0441\u0442\u044c...","meta.ui.load.information":"\u041e\u043d\u043e\u0432\u043b\u044e\u0454\u043c\u043e \u0431\u0430\u0437\u0443 \u0437\u043d\u0430\u043d\u044c...","meta.ui.load.commanders_templates":"\u0412\u0438\u0432\u0447\u0430\u0454\u043c\u043e \u0456\u0441\u0442\u043e\u0440\u0456\u044e...","meta.ui.load.commanders":"\u041f\u0435\u0440\u0435\u0431\u0438\u0440\u0430\u0454\u043c\u043e \u043e\u0441\u043e\u0431\u0438\u0441\u0442\u0456 \u0441\u043f\u0440\u0430\u0432\u0438...","meta.ui.load.troops":"\u0413\u043e\u0442\u0443\u0454\u043c\u043e \u0432\u0456\u0439\u0441\u044c\u043a\u0430...","meta.ui.load.tech":"\u0412\u0438\u0432\u0447\u0430\u0454\u043c\u043e \u043d\u043e\u0432\u0456 \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0456\u0457.....","meta.ui.load.tech_amount":"\u041f\u0440\u0438\u0447\u0435\u043f\u0443\u0440\u044e\u0454\u043c\u043e \u043a\u0430\u0437\u0430\u0440\u043c\u0438....","meta.ui.load.failed":"\u041d\u0435\u043c\u043e\u0436\u043b\u0438\u0432\u043e \u043f\u0456\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0438\u0441\u044c \u0434\u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0430","meta.ui.load.maps":"\u0420\u043e\u0437\u0433\u043e\u0440\u0442\u0430\u0454\u043c\u043e \u043a\u0430\u0440\u0442\u0443 \u043c\u0456\u0441\u0446\u0435\u0432\u043e\u0441\u0442\u0456...","meta.ui.load.campaigns":"\u041e\u0442\u0440\u0438\u043c\u0443\u0454\u043c\u043e \u0437\u0430\u0432\u0434\u0430\u043d\u043d\u044f \u0433\u0435\u043d\u0448\u0442\u0430\u0431\u0443...","meta.ui.load.inventory":"\u041e\u0442\u0440\u0438\u043c\u0443\u0454\u043c\u043e \u0431\u043e\u0454\u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0442, \u043f\u0456\u0434\u0433\u0430\u043d\u044f\u0454\u043c\u043e \u0441\u043f\u043e\u0440\u044f\u0434\u0436\u0435\u043d\u043d\u044f...","meta.ui.button_exit":"\u0417\u0430\u043a\u0440\u0438\u0442\u0438 \u0433\u0440\u0443","meta.ui.error.auth":"\u041d\u0435\u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u0456 \u043f\u0456\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044f \u0437\u0430\u0431\u043e\u0440\u043e\u043d\u0435\u043d\u0456","meta.ui.error.connect":"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0456\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044f","meta.ui.error.player_deleted":"\u0410\u043a\u0430\u0443\u043d\u0442 \u0433\u0440\u0430\u0432\u0446\u044f \u0431\u0443\u043b\u043e \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u043e","meta.ui.error.player_will_be_deleted":"\u0410\u043a\u0430\u0443\u043d\u0442 \u0433\u0440\u0430\u0432\u0446\u044f \u0431\u0443\u0434\u0435 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u043e #{deleteAt}","meta.ui.error.auth_failed":"\u0412\u0456\u0434\u043c\u043e\u0432\u0430 \u0432 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0456\u0457 \u0433\u0440\u0430\u0432\u0446\u044f","meta.ui.error.auth_server_response":"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u0443 \u0432\u0456\u0434\u043f\u043e\u0432\u0456\u0434\u0456 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0456\u0457","meta.ui.error.auth_server_timeout":"\u041d\u0435\u043c\u0430\u0454 \u0432\u0456\u0434\u043f\u043e\u0432\u0456\u0434\u0456 \u0432\u0456\u0434 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0456\u0457","meta.ui.error.bad_cache":"\u0412\u0438\u044f\u0432\u043b\u0435\u043d\u043e \u0440\u043e\u0437\u0431\u0456\u0436\u043d\u0456\u0441\u0442\u044c \u0434\u0430\u043d\u0438\u0445. \n\u041f\u0435\u0440\u0435\u043f\u0440\u043e\u0448\u0443\u0454\u043c\u043e \u0437\u0430 \u043f\u043e\u043c\u0438\u043b\u043a\u0438 \u0432 \u0433\u0440\u0456. \n\u0421\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043e\u043d\u043e\u0432\u0438\u0442\u0438 \u0456\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441. \u042f\u043a\u0449\u043e \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430 \u043d\u0435 \u0437\u043d\u0438\u043a\u043d\u0435, \u0441\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0438 \u0433\u0440\u0443.","meta.ui.error.bad_config":"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u0456 \u043d\u0430\u043b\u0430\u0448\u0442\u0443\u0432\u0430\u043d\u043d\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430. \n\u041f\u043e\u0432\u0456\u0434\u043e\u043c\u0442\u0435 \u0440\u043e\u0437\u0440\u043e\u0431\u043d\u0438\u043a\u0456\u0432 \u043f\u0440\u043e \u043f\u043e\u043c\u0438\u043b\u043a\u0443","meta.ui.error.bad_format":"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u0432 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u0438\u0445 \u0434\u0430\u043d\u0438\u0445. \n\u041f\u043e\u0432\u0456\u0434\u043e\u043c\u0442\u0435 \u0440\u043e\u0437\u0440\u043e\u0431\u043d\u0438\u043a\u0456\u0432 \u043f\u0440\u043e \u043f\u043e\u043c\u0438\u043b\u043a\u0443","meta.ui.error.bad_id":"\u041f\u043e\u0442\u0440\u0456\u0431\u043d\u0438\u0439 \u043e\u0431'\u0454\u043a\u0442 \u043d\u0435 \u0437\u043d\u0430\u0439\u0434\u0435\u043d\u043e. \n\u041f\u043e\u0432\u0456\u0434\u043e\u043c\u0442\u0435 \u0440\u043e\u0437\u0440\u043e\u0431\u043d\u0438\u043a\u0456\u0432 \u043f\u0440\u043e \u043f\u043e\u043c\u0438\u043b\u043a\u0443","meta.ui.error.bad_value":"\u041f\u0435\u0440\u0435\u0434\u0430\u043d\u043e \u043d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u0456 \u0434\u0430\u043d\u0456 \u0432 \u0437\u0430\u043f\u0438\u0442\u0456. \n\u041f\u043e\u0432\u0456\u0434\u043e\u043c\u0442\u0435 \u0440\u043e\u0437\u0440\u043e\u0431\u043d\u0438\u043a\u0456\u0432 \u043f\u0440\u043e \u043f\u043e\u043c\u0438\u043b\u043a\u0443","meta.ui.error.login_disabled":"\u0412\u0445\u0456\u0434 \u0443 \u0433\u0440\u0443 \u0437\u0430\u043a\u0440\u0438\u0442\u043e","meta.ui.error.login_disabled_until":"\u0412\u0445\u0456\u0434 \u0443 \u0433\u0440\u0443 \u0442\u0438\u043c\u0447\u0430\u0441\u043e\u0432\u043e \u0437\u0430\u043a\u0440\u0438\u0442\u043e \u0434\u043e #{date}","meta.ui.error.player_busy":"\u041e\u043f\u0435\u0440\u0430\u0446\u0456\u044f \u043d\u0435\u043c\u043e\u0436\u043b\u0438\u0432\u0430 \u0434\u043b\u044f \u043f\u043e\u0442\u043e\u0447\u043d\u043e\u0433\u043e \u0441\u0442\u0430\u043d\u0443 \u0433\u0440\u0430\u0432\u0446\u044f","meta.ui.error.auth_server_ban_temporary":"\u0412\u0430\u0441 \u0442\u0438\u043c\u0447\u0430\u0441\u043e\u0432\u043e \u0437\u0430\u0431\u043b\u043e\u043a\u043e\u0432\u0430\u043d\u043e \u0434\u043e #{date}","meta.ui.error.auth_server_ban_permanent":"\u0412\u0430\u0441 \u0437\u0430\u0431\u043b\u043e\u043a\u043e\u0432\u0430\u043d\u043e \u043d\u0430\u0437\u0430\u0432\u0436\u0434\u0438","meta.ui.error.bad_operation":"\u0417\u0430\u043f\u0440\u043e\u0448\u0435\u043d\u043e \u043d\u0435\u043f\u0440\u0438\u043f\u0443\u0441\u0442\u0438\u043c\u0443 \u043e\u043f\u0435\u0440\u0430\u0446\u0456\u044e","meta.ui.error.socket.no_response":"\u0417\u0430\u0433\u0443\u0431\u043b\u0435\u043d\u043e \u0437'\u0454\u0434\u043d\u0430\u043d\u043d\u044f \u0456\u0437 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c","meta.ui.error.socket.not_initialised":"\u0417'\u0454\u0434\u043d\u0430\u043d\u043d\u044f \u0456\u0437 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c \u043d\u0435 \u0432\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e","meta.ui.error.steam_server_response":"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u0430 \u0432\u0456\u0434\u043f\u043e\u0432\u0456\u0434\u044c \u0432\u0456\u0434 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 Steam","meta.ui.error.attention":"\u0423\u0432\u0430\u0433\u0430","meta.ui.error.not_authenticated":"\u041d\u0435 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0456\u043a\u043e\u0432\u0430\u043d\u0438\u0439","meta.ui.reason.auth_server_ban_temporary":"\u0412\u0430\u0441 \u0442\u0438\u043c\u0447\u0430\u0441\u043e\u0432\u043e \u0437\u0430\u0431\u043b\u043e\u043a\u043e\u0432\u0430\u043d\u043e \u0434\u043e #{date}","meta.ui.reason.auth_server_ban_permanent":"\u0412\u0430\u0441 \u0437\u0430\u0431\u0430\u043d\u0435\u043d\u0456 \u043d\u0430\u0437\u0430\u0432\u0436\u0434\u0438","meta.ui.reason.auth_failed":"\u041d\u0435 \u0432\u0434\u0430\u043b\u043e\u0441\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0443\u0432\u0430\u0442\u0438\u0441\u044f","meta.ui.reason.maintenance":"\u0421\u0435\u0440\u0432\u0435\u0440\u0438 \u0437\u0430\u043a\u0440\u0438\u0442\u0456 \u043d\u0430 \u043e\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044f","meta.ui.reason.maintenance_until":"\u0421\u0435\u0440\u0432\u0435\u0440\u0438 \u0437\u0430\u043a\u0440\u0438\u0442\u0456 \u043d\u0430 \u043e\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044f \u0434\u043e #{date}","meta.ui.reason.test_not_started":"\u0421\u0435\u0440\u0432\u0435\u0440\u0438 \u0437\u0430\u043a\u0440\u0438\u0442\u0456 \u0434\u043e \u043f\u043e\u0447\u0430\u0442\u043a\u0443 \u0442\u0435\u0441\u0442\u0443\u0432\u0430\u043d\u043d\u044f - #{date}","meta.ui.reason.player_not_exist":"\u0422\u0430\u043a\u043e\u0433\u043e \u0433\u0440\u0430\u0432\u0446\u044f \u043d\u0435 \u0456\u0441\u043d\u0443\u0454","meta.ui.reason.player_will_be_deleted":"\u0410\u043a\u0430\u0443\u043d\u0442 \u0431\u0443\u0434\u0435 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u043e","meta.ui.reason.gdpr_accept_required":"\u041f\u043e\u0442\u0440\u0456\u0431\u043d\u043e \u043f\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0438 \u0443\u0433\u043e\u0434\u0443 \u0437\u0430\u043d\u043e\u0432\u043e","meta.ui.reason.friends_and_family_test":"\u0421\u0435\u0440\u0432\u0435\u0440\u0438 \u0433\u0440\u0438 \u0431\u0443\u0434\u0443\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0456 \u0437 15:00 \u0434\u043e 23:00 \u041c\u0421\u041a. \u041d\u0430\u0441\u0442\u0443\u043f\u043d\u0438\u0439 \u0437\u0430\u043f\u0443\u0441\u043a #{date}","meta.ui.gdpr.acception_text":"\u042f \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0432 \u0456 \u043f\u0440\u0438\u0439\u043c\u0430\u044e \u043b\u0456\u0446\u0435\u043d\u0437\u0456\u0439\u043d\u0443 \u0443\u0433\u043e\u0434\u0443 \u0437 \u043a\u0456\u043d\u0446\u0435\u0432\u0438\u043c \u043a\u043e\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447\u0435\u043c","meta.ui.gdpr.profile_delete":"\u0412\u0438\u0434\u0430\u043b\u0435\u043d\u043d\u044f \u0430\u043a\u0430\u0443\u043d\u0442\u0430","meta.ui.gdpr.profile_stats_label":"\u0412\u0456\u0434\u043a\u0440\u0438\u0442\u0438 \u0456\u0433\u0440\u043e\u0432\u0443 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443 \u0434\u043b\u044f \u0456\u043d\u0448\u0438\u0445 \u0433\u0440\u0430\u0432\u0446\u0456\u0432?","meta.ui.gdpr.profile_stats_explainer_open":"\u042f\u043a\u0449\u043e \u0432\u0438 \u043f\u043b\u0430\u043d\u0443\u0454\u0442\u0435 \u0433\u0440\u0430\u0442\u0438 \u0432 \u043c\u0443\u043b\u044c\u0442\u0438\u043f\u043b\u0435\u0454\u0440, \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0454\u043c\u043e \u0432\u0438\u0431\u0440\u0430\u0442\u0438 @\u0412\u0456\u0434\u043a\u0440\u0438\u0442\u0438 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443@, \u0449\u043e\u0431 \u043e\u0442\u0440\u0438\u043c\u0430\u0442\u0438 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0438\u0439 \u0456\u0433\u0440\u043e\u0432\u0438\u0439 \u0434\u043e\u0441\u0432\u0456\u0434.\n<br><br>\n\u0423 \u0432\u0456\u0434\u043a\u0440\u0438\u0442\u043e\u043c\u0443 \u0440\u0435\u0436\u0438\u043c\u0456 \u0432\u0438 \u0437\u043c\u043e\u0436\u0435\u0442\u0435:\n+ \u0431\u0440\u0430\u0442\u0438 \u0443\u0447\u0430\u0441\u0442\u044c \u0443 \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0443\n+ \u0431\u0430\u0447\u0438\u0442\u0438 \u0447\u0443\u0436\u0443 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443\n+ \u0434\u0438\u0432\u0438\u0442\u0438\u0441\u044f \u043f\u0456\u0434\u0441\u0443\u043c\u043a\u0438 \u0447\u0443\u0436\u0438\u0445 \u0431\u043e\u0457\u0432\n+ \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u0438 \u0440\u0435\u043f\u043b\u0435\u0457 \u0447\u0443\u0436\u0438\u0445 \u0431\u043e\u0457\u0432\n+ \u0406\u043d\u0448\u0456 \u0433\u0440\u0430\u0432\u0446\u0456 \u0442\u0430\u043a\u043e\u0436 \u0437\u043c\u043e\u0436\u0443\u0442\u044c \u0431\u0430\u0447\u0438\u0442\u0438 \u0432\u0430\u0448\u0443 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443.","meta.ui.gdpr.profile_stats_explainer_close":"\u0423 \u0437\u0430\u043a\u0440\u0438\u0442\u043e\u043c\u0443 \u0440\u0435\u0436\u0438\u043c\u0456 \u0432\u0430\u0448\u0430 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043f\u0440\u0438\u0445\u043e\u0432\u0430\u043d\u0430 \u0432\u0456\u0434 \u0441\u0442\u043e\u0440\u043e\u043d\u043d\u0456\u0445.\n\u041d\u0435 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0454\u043c\u043e \u0446\u044e \u043e\u043f\u0446\u0456\u044e, \u044f\u043a\u0449\u043e \u0432\u0438 \u043f\u043b\u0430\u043d\u0443\u0454\u0442\u0435 \u0433\u0440\u0430\u0442\u0438 \u0443 \u043c\u0443\u043b\u044c\u0442\u0438\u043f\u043b\u0435\u0454\u0440.\n<br><br>\n\u0423 \u0446\u044c\u043e\u043c\u0443 \u0440\u0435\u0436\u0438\u043c\u0456 \u0432\u0430\u043c \u0431\u0443\u0434\u0443\u0442\u044c \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0456:\n+ \u0443\u0447\u0430\u0441\u0442\u044c \u0443 \u0437\u0430\u0433\u0430\u043b\u044c\u043d\u043e\u043c\u0443 \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0443\n+ \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0442\u0430 \u043f\u0456\u0434\u0441\u0443\u043c\u043a\u0438 \u0431\u043e\u0457\u0432 \u0456\u043d\u0448\u0438\u0445 \u0433\u0440\u0430\u0432\u0446\u0456\u0432\n+ \u0440\u0435\u043f\u043b\u0435\u0457 \u0456\u043d\u0448\u0438\u0445 \u0433\u0440\u0430\u0432\u0446\u0456\u0432","meta.ui.gdpr.profile_stats_explainer_subtitle":"\u041d\u0430\u0434\u0430\u043b\u0456 \u0432\u0438 \u0437\u043c\u043e\u0436\u0435\u0442\u0435 \u0437\u043c\u0456\u043d\u0438\u0442\u0438 \u043d\u0430\u043b\u0430\u0448\u0442\u0443\u0432\u0430\u043d\u043d\u044f \u0432 \u043e\u043f\u0446\u0456\u044f\u0445 \u0433\u0440\u0438.","meta.ui.gdpr.profile_stats_hide":"\u041f\u0440\u0438\u0445\u043e\u0432\u0443\u0432\u0430\u0442\u0438 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443","meta.ui.gdpr.profile_stats_show":"\u0412\u0456\u0434\u043a\u0440\u0438\u0442\u0438 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443","meta.ui.gdpr.profile_decline":"\u041d\u0435 \u043f\u0440\u0438\u0439\u043c\u0430\u044e","meta.ui.gdpr.profile_accept":"\u041f\u0440\u0438\u0439\u043c\u0430\u044e","meta.ui.gdpr.delete.title":"\u0412\u0438\u0434\u0430\u043b\u0435\u043d\u043d\u044f \u0430\u043a\u0430\u0443\u043d\u0442\u0430","meta.ui.gdpr.delete.desc":'\u0412\u0438 \u0432\u043f\u0435\u0432\u043d\u0435\u043d\u0456, \u0449\u043e \u0445\u043e\u0447\u0435\u0442\u0435 \u0432\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u0430\u043a\u0430\u0443\u043d\u0442? \n\u0423\u0441\u0456 \u0432\u0430\u0448\u0456 \u0456\u0433\u0440\u043e\u0432\u0456 \u0434\u0430\u043d\u0456 \u0431\u0443\u0434\u0435 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u043e.\n\u0429\u043e\u0431 \u043f\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0438 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u043d\u044f, \u0412\u0438 \u043c\u0430\u0454\u0442\u0435 \u0432\u0432\u0435\u0441\u0442\u0438 "#{keyword}" \u0432 \u043f\u043e\u043b\u0435 \u043d\u0438\u0436\u0447\u0435:',"meta.ui.gdpr.delete.recovery":"\u041f\u0456\u0441\u043b\u044f \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u043d\u044f \u043e\u0431\u043b\u0456\u043a\u043e\u0432\u043e\u0433\u043e \u0437\u0430\u043f\u0438\u0441\u0443 \u0443 \u0432\u0430\u0441 \u0454 3 \u0434\u043d\u0456, \u043f\u0440\u043e\u0442\u044f\u0433\u043e\u043c \u044f\u043a\u0438\u0445 \u043c\u043e\u0436\u043d\u0430 \u0441\u043a\u0430\u0441\u0443\u0432\u0430\u0442\u0438 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u043d\u044f. \u0414\u043b\u044f \u0446\u044c\u043e\u0433\u043e \u043f\u043e\u0442\u0440\u0456\u0431\u043d\u043e \u043f\u0440\u043e\u0441\u0442\u043e \u0443\u0432\u0456\u0439\u0442\u0438 \u0434\u043e \u0433\u0440\u0438.","meta.ui.gdpr.delete.keyword":"\u0432\u0438\u0434\u0430\u043b\u0438\u0442\u0438","meta.ui.gdpr.delete.submit":"\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u0430\u043a\u0430\u0443\u043d\u0442","meta.ui.gdpr.delete.decline":"\u041d\u0435 \u0432\u0438\u0434\u0430\u043b\u044f\u0442\u0438","meta.hint.gdpr.acception_helper":"\u041f\u0456\u0434 \u0447\u0430\u0441 \u043f\u0435\u0440\u0435\u043c\u0438\u043a\u0430\u043d\u043d\u044f \u0432\u0430\u0440\u0456\u0430\u043d\u0442\u0456\u0432 \u0432\u0438 \u043f\u043e\u0431\u0430\u0447\u0438\u0442\u0435 \u043d\u0438\u0436\u0447\u0435 \u043e\u043f\u0438\u0441 \u2014 \u044f\u043a \u0433\u0440\u0430 \u043f\u043e\u0432\u043e\u0434\u0438\u0442\u0438\u043c\u0435\u0442\u044c\u0441\u044f \u043f\u0440\u0438 \u043a\u043e\u0436\u043d\u043e\u043c\u0443 \u0432\u0438\u0431\u043e\u0440\u0456."}}),al=(()=>{class t{constructor(){if(this.devMode=Object(o.X)(),this.data=new Nc,t.instance)return t.instance;t.instance=this,t.authenticationService=new Gc,t.gameSparks=t.authenticationService.getGameSparks()}init(){let t=Wc(location.hash);t.lng||(t.lng="en");let e=localStorage.getItem(Xc);e!==t.lng?(this.setLanguage(t.lng),this.clear()):this.setLanguage(e),this.checkIsEmpty(),this.release()}checkIsEmpty(){localStorage.getItem(Kc)?(t.languages=JSON.parse(localStorage.getItem(Kc)),t.flatLanguages=this.makeFlatCopy()):(Object(Pc.a)("LOCALIZATOR:","No localization for now, setting up an empty one"),t.languages=JSON.parse(nl),t.flatLanguages=JSON.parse(sl),localStorage.setItem(Kc,nl))}onload(e){t.flatLanguages&&e(t.flatLanguages),t.subscribers.push(e)}getData(e){return e||(e=t.selectedLanguage),t.flatLanguages[e]}checkChanges(e){let i=new Nc,n=JSON.parse(localStorage.getItem(Kc));if(console.log(n),n.version!==e){t.version=e,Object(Pc.a)("LOCALIZATOR:"," ["+this.getLocale()+"] languages aren't relevant! [x] "+n.version+" < "+e),this.devMode&&console.log("%cLocalizator %c:: Current localization: ","font-weight: bold;","font-weight: normal;",JSON.parse(JSON.stringify(n)));let s=0;this.loadFilesList({language:t.selectedLanguage}).subscribe(a=>{if(a.scriptData&&a.scriptData.file){let r=[];for(let e=0;e<a.scriptData.file.length;e++){let i=a.scriptData.file[e],o=n[t.selectedLanguage][i.name];o&&o.version==i.version||(s++,r.push(i.id))}if(!r.length)return Object(Pc.a)("[x] Error","localizator idsToLoad is empty, going to re-init"),this.clear(),void setTimeout(()=>{location.reload()},100);Object(Pc.a)("LOCALIZATOR:","Id's list to update localization: "+JSON.parse(JSON.stringify(r)));let o=()=>{let n=r.shift();n?this.loadFiles([n]).subscribe(e=>{e.scriptData.files.map(e=>{Object(Pc.a)("LOCALIZATOR:",`Loaded part of localization: ${e.id} (${e.name})`),this.injectNewPart(t.selectedLanguage,e),o()})}):(t.flatLanguages=this.makeFlatCopy(),t.languages.version=e,localStorage.setItem(Kc,JSON.stringify(t.languages)),Object(Pc.a)("LOCALIZATOR:","languages was updated [\u2714]"),this.release(),i.next({cache:!1}))};o()}})}else t.version=n.version,Object(Pc.a)("LOCALIZATOR:","current languages ["+this.getLocale()+"] ["+n.version+"] are relevant [\u2714]"),t.languages=JSON.parse(localStorage.getItem(Kc)),t.flatLanguages=this.makeFlatCopy(),this.release(),i.next({cache:!0});return i}getLanguage(e){if(e||(e=t.selectedLanguage),il){let i=new rl(t.flatLanguages[e],t.modsLocalization);"meta.ui.commander.type.art"===il("meta.ui.commander.type.art")?console.warn("failed localization init. Bootstrap localization used instead"):il=i}else t.flatLanguages=JSON.parse(sl),il=new rl(t.flatLanguages[e],t.modsLocalization);return il}setLanguage(e){t.selectedLanguage=e,localStorage.setItem(Xc,t.selectedLanguage)}getLocale(){return`${t.selectedLanguage}-${t.selectedLanguage.toUpperCase()}`}clear(){Object(Pc.a)("LOCALIZATOR:"," ["+this.getLocale()+"] clear [x]"),localStorage.removeItem(Kc),localStorage.removeItem("METAGAME_LANGUAGES"),this.init()}addModLocalization(e){for(let i in e)t.modsLocalization[i]=e[i];il=new rl(t.flatLanguages[t.selectedLanguage],t.modsLocalization),this.data.next(this.getLanguage(t.selectedLanguage))}injectNewPart(e,i){t.languages[e][i.name]={},t.languages[e][i.name].data=Hc(i.content),t.languages[e][i.name].id=i.id,t.languages[e][i.name].version=i.version}makeFlatCopy(){let e={};return tl.map(i=>{let n=t.languages[i];e[i]={},Zc.map(t=>{Object.assign(e[i],n[t]?n[t].data:{})})}),e}release(){this.data.next(this.getLanguage(t.selectedLanguage))}loadFilesList(e){let i=new Nc;return t.gameSparks.sendWithData("LogEventRequest",{eventKey:"localizationList",option:{language:e.language||"",name:e.name||""}},t=>{i.next(t)}),i}loadFile(e){let i=new Nc;return t.gameSparks.sendWithData("LogEventRequest",{eventKey:"localizationGet",file:e},t=>{i.next(t)}),i}loadFiles(e){let i=new Nc;return t.gameSparks.sendWithData("LogEventRequest",{eventKey:"localizationGet",files:e},t=>{i.next(t)}),i}}return t.selectedLanguage="en",t.subscribers=[],t.version="",t.modsLocalization={},t})();class rl{constructor(t,e){return this.data={},this.mods={},this.data=Object.assign({},t),this.mods=Object.assign({},e),console.log(this.get("meta.hint.loading.tip01")),this.get.bind(this)}get(t,e){if(t.match(/^level/gim)){let e=parseInt(t.split(".")[1]);return e>=0?el[e]||t:this.get("meta.ui.profile.preferences.selection.all")}return this.mods[t]?this.extend(this.mods[t],e):this.data[t]?this.extend(this.data[t],e):t}extend(t,e){t.match(/icon\:/gim)&&(t=t.replace(new RegExp("(#{icon:(.*?)})","gim"),'<img src="assets/img/icons/svg/$2.svg" class="icon">'));for(let i in e)t=t.replace(new RegExp("#{"+i+"}","gim"),e[i]);return t}}const ol="METAGAME_INFORMATION",cl=["actor_icon","unit_data","input_filter","commander_task"],ll=["budget"];let ul=`{\n\t"version": 0,\n\t${""+cl.slice().map(t=>`"${t}": {"version": 0, "data": {}, "id": "${t}" }`).join(",")}\n}`.replace(/(\n|\t|\r)/gim,""),dl=(()=>{class t{constructor(){if(this.data=new ke(null),this.rawData={},t.instance)return t.instance;t.instance=this,t.authenticationService=new Gc,t.gameSparks=t.authenticationService.getGameSparks()}init(){this.checkIsEmpty(),this.release()}checkIsEmpty(){t.information=JSON.parse(ul),t.flatInformation=this.makeFlatCopy(),localStorage.getItem(ol)||(console.warn("No information for now, setting up an empty one"),localStorage.setItem(ol,ul))}onload(e){t.flatInformation&&e(t.flatInformation),t.subscribers.push(e)}checkChanges(e){let i=new Nc,n=JSON.parse(localStorage.getItem(ol));if(n.version!==e||localStorage.getItem(ol).length<1e3){t.version=e,Object(Pc.a)("INFORMATOR","information is't relevant! [x] "+n.version+" < "+e);let s=0,a=0;this.loadFilesList().subscribe(r=>{if(r.scriptData&&r.scriptData.file){let o=[];for(let t of r.scriptData.file){let e=n[t.id];e&&e.version==t.version||(s++,o.push(t.id))}this.loadFiles(o).subscribe(n=>{n.scriptData.files.map(n=>{a++,this.injectNewPart(n),console.log(n),a>=s&&(t.flatInformation=this.makeFlatCopy(),t.information.version=e,localStorage.setItem(ol,JSON.stringify(t.information)),Object(Pc.a)("INFORMATOR","information was updated [\u2714]"),this.release(),i.next({cache:!1}))})})}})}else t.version=n.version,Object(Pc.a)("INFORMATOR","current information ["+n.version+"] is relevant [\u2714]"),t.information=JSON.parse(localStorage.getItem(ol)),t.flatInformation=this.makeFlatCopy(),this.release(),i.next({cache:!0});return i}getLanguage(e){return new hl(t.flatInformation)}clear(){Object(Pc.a)("INFORMATOR","clear [x]"),localStorage.removeItem(ol),this.init()}injectNewPart(e){this.rawData[e.id]=e.content,t.information[e.id]={},t.information[e.id].data=ll.indexOf(e.id)>=0?e.content:Hc(e.content),t.information[e.id].id=e.id,t.information[e.id].version=e.version}makeFlatCopy(){let e={},i=t.information;return cl.map(t=>{Object.assign(e,i[t]?i[t].data:{})}),e.data&&delete e.data,e}release(){this.data.next(this.getLanguage())}loadFilesList(){let e=new Nc;return t.gameSparks.sendWithData("LogEventRequest",{eventKey:"infoList"},t=>{e.next(t)}),e}loadFile(e){let i=new Nc;return t.gameSparks.sendWithData("LogEventRequest",{eventKey:"infoGet",file:e},t=>{i.next(t)}),i}loadFiles(e){let i=new Nc;return t.gameSparks.sendWithData("LogEventRequest",{eventKey:"infoGet",files:e},t=>{i.next(t)}),i}getMatchmakingHints(e,i=5,n){if(!t.information||!t.information.hint)return console.error("Informator does not conain hints"),[];let s=t.information.hint.data,a=[],r={};for(let t in s){let e=t.split(".")[0],i=t.split(".")[1];r[e]||(r[e]={}),r[e][i]=s[t]}s=r;let o=t=>{for(let i=0;i<e.length;i++){if(!t||!t.length)return!1;if(t.indexOf(e[i])>=0)return!0}return!1};for(let t in s)t.match(/tip/)&&o(s[t].mode)&&a.push({id:t,mode:s[t].mode,icon:s[t].icon||null,bg:s[t].background||null});if(!a.length)return[];let c=[];if(n)c=n.map(t=>a.find(e=>e.id===t)).filter(t=>!!t);else for(;c.length<i&&c.length!==i;){let t=a[Math.randomInt(0,a.length-1)];c.find(e=>e.id===t.id)||c.push(t)}return c}getBudget(){let e=t.information.budget;return e?e.data:{}}}return t.subscribers=[],t.version="",t})();class hl{constructor(t){return this.data={},this.data=Object.assign({},t),this.get.bind(this)}get(t,e){return this.data.hasOwnProperty(t)?this.data[t]:t}}var bl=function(t){return t.CommanderCreate="commanderCreate",t.CommanderList="commanderList",t.CommanderGet="commanderGet",t.CommanderTemplateList="commanderTemplateList",t.UnitTemplateGetAll="unitTemplateList",t.UnitTreeGet="unitTreeGet",t.UnitTreeGetAll="unitTreeGetAll",t.UnitTreeOpenUnit="unitTreeOpenUnit",t.UnitTreeGetAmount="unitTreeGetAmount",t.UnitTreeBuyAmount="unitTreeBuyAmount",t.SquadList="metaSquadList",t.SquadSetAmount="squadSetAmount",t.SquadReset="squadReset",t.SquadCreate="squadSet",t.ShopExchangeGold="shopExchangeGold",t.ShopConvertXp="shopConvertXp",t.ShopOpenPremiumUnit="shopOpenPremiumUnit",t.ShopItemList="shopItemList",t.ShopTxnInit="shopTxnInit",t.SessionList="sessionList",t.SessionGet="sessionGet",t.SessionSet="sessionSet",t.MapList="mapTemplateList",t.CampaignTemplateList="campaignTemplateList",t.CampaignList="campaignList",t.CampaignStart="campaignStart",t.CampaignJoin="campaignJoin",t.CampaignNextTurn="campaignNextTurn",t.CampaignSetMoves="campaignSetMoves",t.MatchGet="matchGet",t.MatchCancel="matchCancel",t.MatchCancelAnyway="matchCancelAnyway",t.MatchOpen="matchOpen",t.mmRequest="mmRequest",t.mmCancel="mmCancel",t.localizationGetList="localizationGetList",t.FriendList="friendList",t.FriendOperation="friendOperation",t.FriendChat="friendChat",t.TeamCreate="teamCreate",t.TeamGet="teamGet",t.TeamChat="teamChat",t.TeamDelete="teamDelete",t.TeamOperation="teamOperation",t.FriendSetOnlineMode="friendSetOnlineMode",t.TaskTemplateList="taskTemplateList",t.TaskList="taskList",t.ContainerTemplateList="containerTemplateList",t.ContainerList="containerList",t.ContainerOpen="containerOpen",t.CounterSet="counterSet",t.CounterList="counterList",t.UnitXpBoosterApply="unitXpBoosterApply",t.MoneyBoxOpen="moneyBoxOpen",t.PlayerGetProfile="playerGetProfile",t.LeaderBoardGetAroundMe="leaderboardGetAroundMe",t.LeaderBoardGetTop="leaderboardGetTop",t.LeaderBoardGetFriends="leaderboardGetFriends",t.LeagueRulesGet="leagueRulesGet",t.LeagueStateGet="leagueStateGet",t.LobbyCreate="lobbyCreate",t.LobbyGet="lobbyGet",t.LobbyInvite="lobbyInvite",t.LobbyJoin="lobbyJoin",t.LobbyKick="lobbyKick",t.LobbySetOptions="lobbySetOptions",t.LobbyChat="lobbyChat",t.LobbyStart="lobbyStart",t.LobbyLeave="lobbyLeave",t.LobbyList="lobbyList",t.LobbyJoinByOwner="lobbyJoinByOwner",t.LobbyTakeSlot="lobbyTakeSlot",t.LobbyKickPlayer="lobbyKickPlayer",t.LobbySetupSlot="lobbySetupSlot",t.LobbySetCommander="lobbySetCommander",t.LobbySetReady="lobbySetReady",t.LobbySideChat="lobbySideChat",t.LobbyShuffle="lobbyShuffle",t.FriendSearch="friendSearch",t.PlayerOptionsSet="playerOptionsSet",t.PlayerOptionsGet="playerOptionsGet",t.InventoryTemplateList="inventoryTemplateList",t.InventorySelect="inventorySelect",t.GetDownloadableRequest=".GetDownloadableRequest",t}({});function ml(){let t=arguments,e=Object.assign({},JSON.parse(JSON.stringify(pl[t[0].toString()])));return null===t[1]||Object.keys(t[1]).map(i=>e.options[i]=t[1][i]),e}const pl={CommanderTemplateList:{requestKey:bl.CommanderTemplateList,options:{option:{full:!0}}},CommanderList:{requestKey:bl.CommanderList,options:{option:{slot:!0,slotDetails:!0,rank:!1,perk:!1,template:!0,battleRank:!1,unitLevel:!0}},patch:ml.bind(void 0,"CommanderList")},CommanderGet:{requestKey:bl.CommanderGet,options:{commander:""},patch:ml.bind(void 0,"CommanderGet")},CommanderCreate:{requestKey:bl.CommanderCreate,options:{template:"",silver:0,gold:0},patch:ml.bind(void 0,"CommanderCreate")},UnitTemplateGetAll:{requestKey:bl.UnitTemplateGetAll,options:null},UnitTreeGet:{requestKey:bl.UnitTreeGet,options:{campaign:""},patch:ml.bind(void 0,"UnitTreeGet")},UnitTreeGetAll:{requestKey:bl.UnitTreeGetAll,options:{campaign:""},patch:ml.bind(void 0,"UnitTreeGetAll")},UnitTreeOpenUnit:{requestKey:bl.UnitTreeOpenUnit,options:{xp:0,unit:"",campaign:""},patch:ml.bind(void 0,"UnitTreeOpenUnit")},UnitTreeGetAmount:{requestKey:bl.UnitTreeGetAmount,options:{campaign:""},patch:ml.bind(void 0,"UnitTreeGetAmount")},UnitTreeBuyAmount:{requestKey:bl.UnitTreeBuyAmount,options:{unit:[{id:"",amount:0}],silver:0,gold:0,campaign:""},patch:ml.bind(void 0,"UnitTreeBuyAmount")},SquadList:{requestKey:bl.SquadList,options:{option:{squad:{show:"",list:[""]},perk:{show:""}}}},SquadSetAmount:{requestKey:bl.SquadSetAmount,options:{commander:"",squad:[{slot:"",amount:0}]},patch:ml.bind(void 0,"SquadSetAmount")},SquadReset:{requestKey:bl.SquadReset,options:{slot:"",commander:""},patch:ml.bind(void 0,"SquadReset")},SquadCreate:{requestKey:bl.SquadCreate,options:{commander:"",slot:"",unit:""},patch:ml.bind(void 0,"SquadCreate")},ShopExchangeGold:{requestKey:bl.ShopExchangeGold,options:{gold:0},patch:ml.bind(void 0,"ShopExchangeGold")},ShopConvertXp:{requestKey:bl.ShopConvertXp,options:{unit:[""],gold:0},patch:ml.bind(void 0,"ShopConvertXp")},ShopOpenPremiumUnit:{requestKey:bl.ShopOpenPremiumUnit,options:{unit:""}},ShopItemList:{requestKey:bl.ShopItemList,options:{tag:""}},ShopTxnInit:{requestKey:bl.ShopTxnInit,options:{language:"",item:[{id:"",count:0}]},patch:ml.bind(void 0,"ShopTxnInit")},SessionList:{requestKey:bl.SessionList,options:{option:{}},patch:ml.bind(void 0,"SessionList")},SessionGet:{requestKey:bl.SessionGet,options:{session:""},patch:ml.bind(void 0,"SessionGet")},SessionSet:{requestKey:bl.SessionSet,options:{},patch:ml.bind(void 0,"SessionSet")},MapList:{requestKey:bl.MapList,options:null},CampaignTemplateList:{requestKey:bl.CampaignTemplateList,options:null},CampaignList:{requestKey:bl.CampaignList,options:{},patch:ml.bind(void 0,"CampaignList")},CampaignStart:{requestKey:bl.CampaignStart,options:{},patch:ml.bind(void 0,"CampaignStart")},MatchGet:{requestKey:bl.MatchGet,options:{match:"",option:{server:!0,card:!0}}},MatchCancel:{requestKey:bl.MatchCancel,options:{match:""}},MatchCancelAnyway:{requestKey:bl.MatchCancelAnyway,options:{}},MatchOpen:{requestKey:bl.MatchOpen,options:{players:[""],card:""}},mmRequest:{requestKey:bl.mmRequest,options:{mode:"",commander:"",option:{commander_template:"",map:"",difficulty:"",solo:"",local:""},team:!0}},mmCancel:{requestKey:bl.mmCancel,options:null},FriendOperation:{requestKey:bl.FriendOperation,options:{player:"",operation:""},patch:ml.bind(void 0,"FriendOperation")},FriendList:{requestKey:bl.FriendList,options:{option:{}}},FriendChat:{requestKey:bl.FriendChat,options:{player:"",text:""},patch:ml.bind(void 0,"FriendChat")},TeamChat:{requestKey:bl.TeamChat,options:{team:"",text:""},patch:ml.bind(void 0,"TeamChat")},FriendSetOnlineMode:{requestKey:bl.FriendSetOnlineMode,options:{mode:""},patch:ml.bind(void 0,"FriendSetOnlineMode")},TaskTemplateList:{requestKey:bl.TaskTemplateList,options:{},patch:ml.bind(void 0,"TaskTemplateList")},TaskList:{requestKey:bl.TaskList,options:{},patch:ml.bind(void 0,"TaskList")},ContainerTemplateList:{requestKey:bl.ContainerTemplateList,options:{},patch:ml.bind(void 0,"ContainerTemplateList")},ContainerList:{requestKey:bl.ContainerList,options:{},patch:ml.bind(void 0,"ContainerList")},ContainerOpen:{requestKey:bl.ContainerOpen,options:{},patch:ml.bind(void 0,"ContainerOpen")},CounterSet:{requestKey:bl.CounterSet,options:{},patch:ml.bind(void 0,"CounterSet")},CounterList:{requestKey:bl.CounterList,options:{},patch:ml.bind(void 0,"CounterList")},UnitXpBoosterApply:{requestKey:bl.UnitXpBoosterApply,options:{},patch:ml.bind(void 0,"UnitXpBoosterApply")},MoneyBoxOpen:{requestKey:bl.MoneyBoxOpen,options:{},patch:ml.bind(void 0,"MoneyBoxOpen")},PlayerGetProfile:{requestKey:bl.PlayerGetProfile,options:{},patch:ml.bind(void 0,"PlayerGetProfile"),messageInit:"->  fetching frofile [%player%]...",messageSuccess:"[\u2713] profile fetched",messageError:"[x] profile fetch error"},LeaderBoardGetAroundMe:{requestKey:bl.LeaderBoardGetAroundMe,options:{},patch:ml.bind(void 0,"LeaderBoardGetAroundMe")},LeaderBoardGetTop:{requestKey:bl.LeaderBoardGetTop,options:{},patch:ml.bind(void 0,"LeaderBoardGetTop")},LeaderBoardGetFriends:{requestKey:bl.LeaderBoardGetFriends,options:{},patch:ml.bind(void 0,"LeaderBoardGetFriends")},LeagueRulesGet:{requestKey:bl.LeagueRulesGet,options:{},patch:ml.bind(void 0,"LeagueRulesGet")},LeagueStateGet:{requestKey:bl.LeagueStateGet,options:{},patch:ml.bind(void 0,"LeagueStateGet")},LobbyCreate:{requestKey:bl.LobbyCreate,options:{},patch:ml.bind(void 0,"LobbyCreate"),messageInit:"->  creating lobby...",messageSuccess:"[\u2713] lobby created",messageError:"[x] lobby creating error"},LobbyGet:{requestKey:bl.LobbyGet,returnKeys:["lobby"],options:{},patch:ml.bind(void 0,"LobbyGet"),messageInit:"->  fetching lobby [%lobby%]...",messageSuccess:"[\u2713] lobby fetched",messageError:"[x] lobby fetch error"},LobbyInvite:{requestKey:bl.LobbyInvite,returnKeys:[],options:{},patch:ml.bind(void 0,"LobbyInvite"),messageInit:"->  inviting to lobby [player %player% to lobby %lobby%]...",messageSuccess:"[\u2713] invite completed",messageError:"[x] invite error"},LobbyJoin:{requestKey:bl.LobbyJoin,options:{},patch:ml.bind(void 0,"LobbyJoin"),messageInit:"->  joining to lobby [player %player% to lobby %lobby%]...",messageSuccess:"[\u2713] joining completed",messageError:"[x] joining error"},LobbyKick:{requestKey:bl.LobbyKick,options:{},patch:ml.bind(void 0,"LobbyKick"),messageInit:"->  kicking from lobby [player %player% from lobby %lobby%]...",messageSuccess:"[\u2713] profile fetched",messageError:"[x] profile fetch error"},LobbySetOptions:{requestKey:bl.LobbySetOptions,options:{},patch:ml.bind(void 0,"LobbySetOptions"),messageInit:"->  setting lobby options...",messageSuccess:"[\u2713] setting lobby completed",messageError:"[x] setting lobby error"},LobbyChat:{requestKey:bl.LobbyChat,options:{},patch:ml.bind(void 0,"LobbyChat")},LobbyStart:{requestKey:bl.LobbyStart,options:{},patch:ml.bind(void 0,"LobbyStart"),messageInit:"->  starting lobby [%lobby%]...",messageSuccess:"[\u2713] starting completed",messageError:"[x] starting error"},LobbyLeave:{requestKey:bl.LobbyLeave,options:{},patch:ml.bind(void 0,"LobbyLeave"),messageInit:"->  leaving lobby [player %player% from lobby %lobby%]...",messageSuccess:"[\u2713] leaving completed",messageError:"[x] leaving error"},LobbyList:{requestKey:bl.LobbyList,options:{},patch:ml.bind(void 0,"LobbyList"),messageInit:"->  fetching lobby list...",messageSuccess:"[\u2713] list completed",messageError:"[x] list error"},LobbyJoinByOwner:{requestKey:bl.LobbyJoinByOwner,options:{},patch:ml.bind(void 0,"LobbyJoinByOwner"),messageInit:"->  joining lobby by owner...",messageSuccess:"[\u2713] lobby completed",messageError:"[x] lobby error"},LobbyTakeSlot:{requestKey:bl.LobbyTakeSlot,options:{},patch:ml.bind(void 0,"LobbyTakeSlot"),messageInit:"->  taking slot...",messageSuccess:"[\u2713] completed",messageError:"[x] error"},LobbyKickPlayer:{requestKey:bl.LobbyKickPlayer,options:{},patch:ml.bind(void 0,"LobbyKickPlayer"),messageInit:"->  kicking player out of lobby...",messageSuccess:"[\u2713] completed",messageError:"[x] error"},LobbySetupSlot:{requestKey:bl.LobbySetupSlot,options:{},patch:ml.bind(void 0,"LobbySetupSlot"),messageInit:"->  setting up slot [%slot%] to [%state%] for lobby [%lobby%]...",messageSuccess:"[\u2713] completed",messageError:"[x] error"},LobbySetCommander:{requestKey:bl.LobbySetCommander,options:{},patch:ml.bind(void 0,"LobbySetCommander"),messageInit:"->  setting commander [%commander.template%] to lobby [%lobby%]...",messageSuccess:"[\u2713] completed",messageError:"[x] error"},LobbySetReady:{requestKey:bl.LobbySetReady,options:{},patch:ml.bind(void 0,"LobbySetReady"),messageInit:"->  setting ready [%ready%] to lobby [%lobby%]...",messageSuccess:"[\u2713] completed",messageError:"[x] error"},LobbySideChat:{requestKey:bl.LobbySideChat,options:{},patch:ml.bind(void 0,"LobbySideChat"),messageInit:"->  sending message for team [%team%] to lobby [%lobby%]...",messageSuccess:"[\u2713] completed",messageError:"[x] error"},LobbyShuffle:{requestKey:bl.LobbyShuffle,options:{},patch:ml.bind(void 0,"LobbyShuffle"),messageInit:"->  shuffle lobby [%lobby%]...",messageSuccess:"[\u2713] completed",messageError:"[x] error"},FriendSearch:{requestKey:bl.FriendSearch,returnKeys:["list"],options:{},patch:ml.bind(void 0,"FriendSearch"),messageInit:"",messageSuccess:"",messageError:""},PlayerOptionsSet:{requestKey:bl.PlayerOptionsSet,returnKeys:[],options:{},patch:ml.bind(void 0,"PlayerOptionsSet"),messageInit:"",messageSuccess:"",messageError:""},PlayerOptionsGet:{requestKey:bl.PlayerOptionsGet,options:{},patch:ml.bind(void 0,"PlayerOptionsGet"),messageInit:"",messageSuccess:"",messageError:""},InventoryTemplateList:{requestKey:bl.InventoryTemplateList,options:{},patch:ml.bind(void 0,"InventoryTemplateList"),messageInit:"",messageSuccess:"",messageError:""},InventorySelect:{requestKey:bl.InventorySelect,options:{},patch:ml.bind(void 0,"InventorySelect"),messageInit:"",messageSuccess:"",messageError:""},CampaignJoin:{requestKey:bl.CampaignJoin,options:{},patch:ml.bind(void 0,"CampaignJoin")},CampaignNextTurn:{requestKey:bl.CampaignNextTurn,options:{},patch:ml.bind(void 0,"CampaignNextTurn")},CampaignSetMoves:{requestKey:bl.CampaignSetMoves,options:{},patch:ml.bind(void 0,"CampaignSetMoves")}};var gl=function(t){return t.Default="default",t.Echelon="echelon",t.Calculator="calculator",t.Barrack="barrack",t.Exchanger="exchanger",t}({});function fl(t){return t*(Math.PI/180)}function vl(t){return t*(180/Math.PI)}let yl=(()=>{class t{constructor(e=0,i=0){this.getMiddleWith=function(t){return this.clone().add(t).divide(2)},this.getMiddleWithOffset=function(t,e){let i=this.getMiddleWith(t),n=e.multiply(t.distanceTo(this));return i.add(n)},this.scaleAroundPivot=function(e,i){let n=new t,s=e.subtract(this);return s.x*=i,s.y*=i,n=e.clone().add(s),n},this.x=e,this.y=i}add(e){return new t(this.x+e.x,this.y+e.y)}subtract(e){return new t(this.x-e.x,this.y-e.y)}multiply(e){return"number"!=typeof e?new t(this.x*e.x,this.y*e.y):new t(this.x*e,this.y*e)}divide(e){return new t(this.x/e,this.y/e)}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y)}getAngle(){return Math.atan2(this.y,this.x)}setLength(t){let e=this.getAngle();return this.x=t*Math.cos(e),this.y=t*Math.sin(e),this}setAngle(t){let e=this.getLength();return this.x=e*Math.cos(t),this.y=e*Math.sin(t),this}rotateAround(t){let e=this.clone(),i=this.getAngle();return e.setAngle(i+t),e}rotateAroundPivot(t,e){let i=this.subtract(t);return i.setAngle(e),i.add(t)}rotateShapeAroundPivot(t,e,i,n){let s={};for(let a in i)a!==n&&(s[a]=i[a].subtract(t).getAngle()-i[n].subtract(t).getAngle());i[n]=i[n].rotateAroundPivot(t,e);for(let a in i)a!==n&&(i[a]=i[a].rotateAroundPivot(t,e+s[a]));return i}scale(t=1,e=1){return this.x*=t,this.y*=e,this}distanceTo(t){return t.subtract(this).getLength()}clone(){return new t(this.x,this.y)}abs(){return this.x<0&&(this.x*=-1),this.y<0&&(this.y*=-1),this}fill(e){return new t(this.x||e,this.y||e)}floor(){return new t(Math.floor(this.x),Math.floor(this.y))}static lerp(e,i,n){let s=new t;return s.x=Math.lerp(e.x,i.x,n),s.y=Math.lerp(e.y,i.y,n),s}min(e){return new t(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new t(Math.max(this.x,e.x),Math.max(this.y,e.y))}crossVector(e,i){let n=e.subtract(this),s=new t(n.y,-n.x),a=this.distanceTo(e),r=s.getAngle();return(r<0&&r>-Math.PI/2||r>Math.PI/2&&r<Math.PI)&&(s=new t(-n.y,n.x)),s.setLength(null==i?a/10:i),s.add(this).add(n.divide(2))}lerp(e,i){let n=e.subtract(this);return new t(this.x+n.x*i,this.y+n.y*i)}}return t.deg2rad=fl,t.rad2deg=vl,t})();const _l=function(t){return t.replace(/(\.|\_|\-)/gim,"")},kl={createUnitByInterface:function(t,e,i){if(!t)return null;if(i&&t.campaign&&t.campaign[i]){let n=JSON.parse(JSON.stringify(t));for(let e in t.campaign[i])n[e]=t.campaign[i][e];if(e)for(let t in e)n[t]=e[t];return kl.createUnitByInterface(n)}let n={id:t._id,image:t._id,unit:t._id,name:t.name,icon:t.icon,level:t.level,available:!1,army:t.army,silverCost:t.silver_cost,silverBase:t.silver_base,opens:t.open_up,opensQueue:{},opensBy:t.opened_by||[],opensByQueue:{},open:t.open,hidden:t.hidden,elite:t.elite,collectible:t.collectible&&!t.premium,premium:t.premium||!1,premiumGold:t.premium_gold,type:t.type,subtype:t.subtype,tooltip:null,position:new yl(t.tree_x-1,t.tree_y-1),amount:{multiplier:t.amount_display_multiplier||1,limit:t.amount_slot,spawn:t.amount_spawn,count:1},battleRank:t.battle_rank,modifyRank:t.modifyRank||0,xpOpen:t.xp_open,xpBase:t.xp_base,xpAvailable:t.xp_available||0,xpOnParents:0,inProgress:!!t.in_progress,storePrice:null,unitForPreview:t.unit_for_preview||t._id,freemium:t.freemium||!1,campaign:t.campaign||null};if(e)for(let s in e)n[s]=e[s];return n},clone:function(t,e){let i=JSON.parse(JSON.stringify(t));return e?Object.assign(i,e):i},isUnitAttachebleToSlot:function(t,e,i){return!(function(t,e){return t.amount_unit&&t.amount_unit[e.id]?t.amount_unit[e.id]:e.amount_slot}(e,t)<=0||!(e.amount_unit&&e.amount_unit[t.id]>0)&&(i!==t.army||!e.subtype||-1===e.subtype.indexOf(t.subtype)||e.level<t.level))},getModifyBattleRank:function(t,e){if(t.modifyRank)return t.modifyRank;var i=1,n=t.battle_rank||t.battleRank;return Array.isArray(e)?(e.forEach((e,n,s)=>{const a=n%2==0,r=e.indexOf("battle_rank")>-1,o=e.indexOf("subtype")>-1,c=!!o&&_l(t.subtype)===_l(e.slice(e.indexOf("subtype")+8)),l=e.indexOf("unit")>-1,u=!!l&&e.slice(e.indexOf("unit")+5)===(t._id||t.id);a&&r&&(o?c&&(i=+s[n+1]):l&&u&&(i=+s[n+1]))}),{br:n*i,modificator:i}):{br:n,modificator:1}},sortingUnits:function(t,e){return t.sort((t,i)=>t[e]<i[e]?-1:t[e]>i[e]?1:0)},sortingLevelUnits:function(t){return t.sort((t,e)=>t.level-e.level)},sortingPremiumUnits:function(t){return t.sort((t,e)=>t.premium||t.elite?1:t.premium||t.elite?0:-1)},createSimpleUnitById(t,e,i){let n;(new al).data.subscribe(t=>n=t);let s=`\n\t\t\t<div class="unit simple">\n\t\t\t\t<div class="wrapper">\n\t\t\t\t\t<div class="name" tooltip-hint="${n(i?"actor."+t+".name":"unit."+t+".name")}">\n\t\t\t\t\t\t${n(i?"actor."+t+".name":"unit."+t+".short")}\n\t\t\t\t\t</div>\n\t\t\t\t\t<img src="${"assets/img/unit/"+t+".png"}" class="image-unit" draggable="false">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`.replace(/\t/gim,"");return e?e.bypassSecurityTrustHtml(s):s},createUnitByTemplate(t,e={},i){let n;function s(){return t?t.mode===gl.Barrack?Math.ceil(t.modifyRank):Math.ceil(t.modifyRank*t.amount.count):0}return(new al).data.subscribe(t=>n=t),t&&!t.mode&&(t.mode=gl.Default),t&&(t.premiumGold||t.available)&&(e.animated=!0),window.globalImageFallback=function(t,e="assets/img/noise.gif"){t=t.toString();let i=document.querySelector(`[data-fallback="${t}"]`);i&&i.setAttribute("src",e)},Math.floor(1e7*Math.random()),`\n\t\t\t<div class="unit\n\t\t\t\t\t${t&&!t.disabled&&(t.available||t.open)?"":"disabled"}\n\t\t\t\t\t${t.premium?"premium":""}\n\t\t\t\t\t${e.animated&&"default"==t.mode?"animated":""}\n\t\t\t\t\t${!t.open&&t.available&&"default"==t.mode?"available":""}\n\t\t\t\t\t${"grayscaled"===e.state?"grayscaled":""}\n\t\t\t\t"\n\t\t\t\tdata-id="${t.id}"\n\t\t\t>\n\t\t\t\t<div class="wrapper ${"battleRank"===e.error?"error":""}">\n\t\t\t\t\t<div class="name">${n("unit."+t.unit+".short")}</div>\n\t\t\t\t\t<div class="level">${["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"][t.level-1]}</div>\n\t\t\t\t\t${t.subtype?'<img src="assets/img/subtypes/'+t.subtype+'.svg" class="image-subtype" draggable="false">':""}\n\t\t\t\t\t${t.elite||t.premium||t.premiumGold?'<img src="assets/img/subtypes/premium.svg" class="elite-mark" draggable="false">':""}\n\t\t\t\t\t<div class="image-background ${t.army}"></div>\n\t\t\t\t\t${t.image?'<img src="assets/img/unit/'+t.image+'.png" class="image-unit" draggable="false" image-load">':""}\n\t\t\t\t\t${"default"!=t.mode||t.open?"":`\n\t\t\t\t\t\t<div class="price-cost ${t.premiumGold?"premium":""}">\n\t\t\t\t\t\t\t<span>${t.premiumGold?t.premiumGold.cat():t.xpOpen.cat()}</span>\n\t\t\t\t\t\t\t${t.premiumGold||t.premium?"":'<img src="assets/img/icons/svg/exp.svg" class="offset-left" draggable="false">'}\n\t\t\t\t\t\t\t${t.premiumGold?'<img src="assets/img/icons/svg/bonds.svg" class="offset-left">':""}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`}\n\t\t\t\t\t${"default"==t.mode&&t.open&&t.xpAvailable?`\n\t\t\t\t\t\t<div class="price-base ${t.premiumGold?"premium":""}">\n\t\t\t\t\t\t\t${t.premiumGold?"":'<img src="assets/img/icons/svg/exp.svg" class="offset-right" draggable="false">'}\n\t\t\t\t\t\t\t${t.premiumGold?'<img src="assets/img/icons/svg/free_xp.svg" class="offset-right" draggable="false">':""}\n\t\t\t\t\t\t\t<span data-tooltip-hide>${t.xpAvailable.cat()}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`:""}\n\t\t\t\t\t${"barrack"!=t.mode||t.premiumGold?"":`\n\t\t\t\t\t\t<div class="price-cost" style="color: white">\n\t\t\t\t\t\t\t<span>${t.silverCost.cat()}</span>\n\t\t\t\t\t\t\t<img src="assets/img/icons/svg/silver.svg" class="offset-left" draggable="false">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`}\n\t\t\t\t\t${"barrack"==t.mode&&t.premiumGold?`\n\t\t\t\t\t\t<div class="price-cost premium">\n\t\t\t\t\t\t\t<span>${t.premiumGold.cat()}</span>\n\t\t\t\t\t\t\t<img src="assets/img/icons/svg/bonds.svg" class="offset-left" draggable="false">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`:""}\n\t\t\t\t\t${"echelon"==t.mode||"calculator"==t.mode?`\n\t\t\t\t\t\t<div class="price-base ${"battleRank"===e.error?"error":""}" data-battle-rank>\n\t\t\t\t\t\t\t<span>${s()}</span>\n\t\t\t\t\t\t\t<img src="assets/img/icons/br.svg" alt="" draggable="false" class="offset-left">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`:""}\n\t\t\t\t\t${"barrack"==t.mode&&s()>0?`\n\t\t\t\t\t\t<div class="price-base ${"battleRank"===e.error?"error":""}">\n\t\t\t\t\t\t\t<img src="assets/img/icons/br.svg" alt="" draggable="false">\n\t\t\t\t\t\t\t<span>${s()}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`:""}\n\t\t\t\t</div>\n\t\t\t\t<div class="shadow ${e.highlighted&&"default"!=t.mode?"active":""} ${e.attach?"attach":""}"></div>\n\t\t\t\t${"default"==t.mode&&(t.available||!t.open&&t.premiumGold)?`\n\t\t\t\t\t<div class="new">${n("meta.ui.tech.available")}</div>\n\t\t\t\t`:""}\n\t\t\t</div>\n\t\t`.replace(/\t/gim,"")}},wl="METAGAME_VISITS";let Sl=(()=>{class t{constructor(){if(this._visits={},this.onVisit=new ke(null),t.instance)return t.instance;localStorage.getItem(wl)&&(this._visits=JSON.parse(localStorage.getItem(wl))),t.instance=this}visit(t){if(t.push)for(let e=0;e<t.length;e++)this._visits[t[e]]=!0;else{if(!0===this._visits[t])return;this._visits[t]=!0}localStorage.setItem(wl,JSON.stringify(this._visits)),this.onVisit.next(t),this.onVisit.next(null)}clear(t){this._visits[t]&&delete this._visits[t],localStorage.setItem(wl,JSON.stringify(this._visits)),this.onVisit.next(t),this.onVisit.next(null)}clearOutdated(t){for(let e in this._visits)t[e.split("_").last()]||(this.clear(e),console.warn("clearing outdated task: "+e))}isVisited(t){return!!this._visits[t]}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})();function Il(t,e=!0){let i=new XMLHttpRequest;return i.open("GET",t),new Promise((t,n)=>{i.send(),i.onload=function(){200!=i.status||t(e?JSON.parse(i.responseText||"{}"):i.responseText)},i.onerror=function(){n()}})}const Cl="METAGAME_TASKS_TEMPLATES",Ll="METAGAME_CONTAINERS_TEMPLATES",Rl={campaign:0,commanderDiscount:1,commander:2,premium:3,gold:4,hard_gold:5,silver:6,freeXp:7,free_xp:8,unit:9};function Ol(t){let e=performance.now();return Object(Pc.a)("-> "+t.appendSpaces(20)),function(){let i=performance.now();Object(Pc.a)("<- "+t.appendSpaces(20)+" taken in "+(i-e).toFixed(3)+" ms.")}}let Tl=(()=>{class t{constructor(){if(this._tasksTemplates={},this._tasks=[],this._tasksKeys={},this._containersTemplates={},this._containers=[],this._containersKeys={},this.visitService=new Sl,this.onContainerAdd=new ke(null),this.onContainerOpen=new ke(null),this.onLevelChange=new ke(null),this.fetch=Gc.Fetch,t.instance)return t.instance;t.instance=this}init(t,e,i,n){return this.gameSparks=e,this.cache=t,Object(Pc.a)("INIT :: TasksService"),this.api=this.cache.getAPIUrl(),this.cache.getAuthService().onMessage.subscribe(t=>{if(t&&"onContainerAdded"===t.extCode&&t.data&&t.data.container&&t.data.container.length){if(!t.data.container.filter(t=>{if(!this._containers.find(e=>e.id===t.id))return t;Object(Pc.a)("CONTAINER",t.id+" doubled so wont be added")}).length)return;this._containers=this._containers.concat(t.data.container),t.data.container.map(t=>this._containersKeys[t.id]=t),this.onContainerAdd.next({added:t.data.container.length,container:t.data.container}),this.onContainerAdd.next(null);let e=this.getNewLevelContainers(t.data.container);if(e.length){let t=parseInt(e.last().containerTemplate.replace(/\D/gim,""));this.onLevelChange.next({level:t,oldLevel:Math.min(this.cache.getUserLevel(),t-1),container:e}),this.onLevelChange.next(null)}}}),new Promise((t,e)=>{this.checkTasksTemplates(i.taskTemplateVersion,n.taskTemplateVersion).then(()=>{this.checkContainersTemplates(i.containerTemplateVersion,n.containerTemplateVersion).then(()=>{this.checkTasks().then(()=>{this.checkContainers().then(()=>{this.processVisitedTasks(),this.cache.devMode&&this.log(),t(null),this.cache.completed.subscribe(()=>{let t=this.getNewLevelContainers(this._containers);if(t.length){let e=parseInt(t.last().containerTemplate.replace(/\D/gim,""));this.onLevelChange.next({level:e,oldLevel:Math.min(this.cache.getUserLevel(),e-1),container:t}),this.onLevelChange.next(null)}})})})})})})}grab(){return this.checkTasks()}log(){console.log("_tasksTemplates",this._tasksTemplates),console.log("_tasks",this._tasks),console.log("all tasks",this.getTasks()),console.log("_tasksKeys",this._tasksKeys),console.log("_containersTemplates",this._containersTemplates),console.log("_containers",this._containers),console.log("_containersKeys",this._containersKeys)}save(){}exist(t){return!!this._tasksKeys[t]}completeTask(t,e){Il(`${this.api}&cmd=playerCompleteTask&task=${e}`).then(t=>{console.log(t)},t=>{console.error(t)})}checkTasksTemplates(t,e){let i=Ol("tasksTemplates"),n=localStorage.getItem(Cl);return new Promise((s,a)=>{n&&t===e?(this._tasksTemplates=JSON.parse(n),i(),s(null)):(Object(Pc.a)("-> tasks templates are outdated"),this.fetchTasksTemplates().subscribe(t=>{this._tasksTemplates=t.scriptData.task,Object(Pc.a)("<- tasks templates"),localStorage.setItem(Cl,JSON.stringify(this._tasksTemplates)),i(),s(null),this.save()},()=>{s(null)}))})}checkTasks(){let t=Ol("tasks");return new Promise((e,i)=>{this.fetchTasks().subscribe(i=>{this._tasks=i.scriptData.task,this._tasks.map(t=>this._tasksKeys[t.id]=t),this.save(),t(),e(null)},()=>{e(null)})})}checkContainersTemplates(t,e){let i=Ol("containersTemplates"),n=localStorage.getItem(Ll);return new Promise((s,a)=>{n&&t===e?(this._containersTemplates=JSON.parse(n),i(),s(null)):(Object(Pc.a)("-> containers templates are outdated"),this.fetchContainersTemplates().subscribe(t=>{this._containersTemplates=t.scriptData.container,Object(Pc.a)("<- new containers templates"),localStorage.setItem(Ll,JSON.stringify(this._containersTemplates)),i(),s(null),this.save()},()=>{s(null)}))})}checkContainers(){let t=Ol("containers");return new Promise((e,i)=>{this.fetchContainers().subscribe(i=>{this._containers=i.scriptData.container,this._containers.map(t=>this._containersKeys[t.id]=t),t(),e(null),this.save()},()=>{e(null)})})}fetchTasksTemplates(){return this.fetch(pl.TaskTemplateList)}fetchTasks(){return this.fetch(pl.TaskList)}fetchContainersTemplates(){return this.fetch(pl.ContainerTemplateList)}fetchContainers(){return this.fetch(pl.ContainerList)}createTaskById(t,e=""){let i=t?this._tasksKeys[t]:this._tasks.find(t=>t.taskTemplate===e);if(!i&&!e)return null;let n=this._tasksTemplates[e]||this._tasksTemplates[i&&i.source?i.source.taskTemplate:i?i.taskTemplate:""];if(!n)return null;let s=JSON.parse(JSON.stringify(n));return s.reward=this.getReward(i&&i.container?i.container:n.container,n.id),s.task=i,s}createContainerById(t){let e=this._containersKeys[t];if(!e)return console.warn("No container "+t),null;let i=this._containersTemplates[e.containerTemplate];if(!i)return console.warn(`No container template ${e.containerTemplate} for ${t}`),null;let n=JSON.parse(JSON.stringify(e)),s=this.getReward([e.containerTemplate]);return n.template=i,n.reward=s,n.createdTimeString=new Date(n.createdTime).parseDate("dd.mm.yyyy h:m"),n.expireAtString=new Date(n.expiresAt).parseDate("dd.mm.yyyy h:m"),n.source&&(n.taskTemplate=n.source.taskTemplate),n}getTasks(t,e){let i=[];if(!this._tasks.length)return i;for(let n=0;n<this._tasks.length;n++){let s=this.createTaskById(this._tasks[n].id);s&&!s.task.campaign&&s&&(t||e||i.push(s),t&&!e&&s.type===t&&i.push(s),t&&e&&s.type===t&&s.category===e&&i.push(s),!t&&e&&s.category===e&&i.push(s))}return i.sort((t,e)=>t.display_order-e.display_order)}getTask(t,e){return this.createTaskById(t,e)}getTasksCount(t,e){return t||e?this.getTasks(t,e).length:this._tasks.length||0}isFreemimTaskOpen(t){return"string"==typeof t&&(t=this.getTask(t)),this.cache.isPremium()||t.freemium}getReward(t,e){let i=[],n=this._tasksTemplates[e];if(n&&n.tags&&n.tags.join(",").match(/commander\./gim)){let t=n.tags.find(t=>t.match(/commander\./gim)),e=t?t.replace(/commander\./gim,""):null;e&&i.push({commanderDiscount:{id:e,amount:0}})}else if(n&&n.on_complete&&n.on_complete.length)for(let s=0;s<n.on_complete.length;s++){let t=n.on_complete[s];t.commander_discount&&i.push({commanderDiscount:{id:t.commander_discount.commander,amount:t.commander_discount.percent}})}return(t||[]).map(t=>{if(!this._containersTemplates[t])return Object(Pc.a)("[warn] no container for reward",t),null;let e=this._containersTemplates[t].content;for(let n in e)if("unit"===n)for(let t in e[n]){let s=parseInt(e[n][t]||"1");i.push({unit:{id:t,amount:s}})}else if("campaign_unit"===n)for(let t in e[n])for(let s in e[n][t])i.push({campaign_unit:{[t]:{id:s,amount:e[n][t][s]||1}}});else if("campaign"===n)for(let t=0;t<e.campaign.length;t++)i.push({campaign:e.campaign[t]});else if("commander"===n)for(let t=0;t<e.commander.length;t++)i.push({commander:e.commander[t]});else{let t={};t[n]=e[n],i.push(t)}}),i.filter(t=>!!t).map(t=>{let e=Object.keys(t)[0],i={key:e,amount:"unit"===e?t.unit.amount:"commanderDiscount"===e?t.commanderDiscount.amount:t[e],unitId:"unit"===e?t.unit.id:"",commanderId:"commanderDiscount"===e?t.commanderDiscount.id:""};if("campaign_unit"===e){let n=Object.keys(t[e])[0],s=t[e][n].id;i={key:"unit",amount:parseInt(t[e][n].amount||"1"),unitId:s,campaignId:n}}if("campaign_silver"===e){let n=Object.keys(t[e])[0];i={key:"silver",amount:parseInt(t[e][n]||"1"),campaignId:n}}if("campaign_free_xp"===e){let n=Object.keys(t[e])[0];i={key:"free_xp",amount:parseInt(t[e][n]||"1"),campaignId:n}}return"campaign"===e&&(i={key:"campaign",amount:1,campaignId:t.campaign}),"commander"===e&&(i={key:"commander",amount:1,commanderId:t.commander}),i.unitId&&(i.unit=kl.clone(this.cache.getTreeUnit(i.unitId),{open:!0,mode:gl.Exchanger})),i.commanderId&&(i.commander=this.cache.getCommander(i.commanderId),i.campaignId=i.commander.campaign||null),i}).sort((t,e)=>Rl[t.key]-Rl[e.key])}getNewLevelContainers(t){let e=/^tutorial\.level[0-9]{1,2}$/gim;return t.filter(t=>!(!t||!t.containerTemplate.match(e))).sort((t,e)=>parseInt(t.containerTemplate.replace(/\D/gim,""))-parseInt(e.containerTemplate.replace(/\D/gim,""))).map(t=>this.createContainerById(t.id))}getContainers(){return this._containers.map(t=>this.createContainerById(t.id)).filter(t=>null!==t).sort((t,e)=>e.createdTime-t.createdTime)}getContainersCount(){return this._containers.length||0}getUnvisitedTasksCount(t=""){let e=0;if(!t)return e+=this.getUnvisitedTasksCount("this_day"),e+=this.getUnvisitedTasksCount("this_week"),e+=this.getUnvisitedTasksCount("special"),e+=this.getUnvisitedTasksCount("trial"),e+=this.getUnvisitedTasksCount("commander"),e+=this.getUnvisitedTasksCount("league"),e;for(let i=0;i<this._tasks.length;i++){let n=this.createTaskById(this._tasks[i].id);n&&n.expiresAt&&n.expiresAt<(new Date).getTime()||n&&!n.task.campaign&&n&&n.type&&"task"===n.type&&n.tags.indexOf(t)>=0&&!this.visitService.isVisited(`task_${n.task.taskTemplate}_${n.task.id}`)&&e++}return e}getUnvisitedContainersCount(){return this._containers.filter(t=>!this.visitService.isVisited("container_"+t.id)).length}getUnvisitedContainers(){return this._containers.filter(t=>!this.visitService.isVisited("container_"+t.id))}openContainer(t){let e=this.createContainerById(t),i=new Nc;return e?(this.visitService.visit("container_"+t),Object(Pc.a)(`-> opening container [${t}](${e.containerTemplate})...`),this.fetch(pl.ContainerOpen.patch({container:t})).subscribe(n=>{if(n.scriptData){let s=n.scriptData;if(Object(Pc.a)(`<- container [${t}](${e.containerTemplate}) opened`,n.scriptData),this.removeCompletedTask(t,e.containerTemplate),s.gold&&this.cache.setUserGold(s.gold),s.silver&&this.cache.setUserSilver(s.silver),s.freeXp&&this.cache.setUserFreeXp(s.freeXp),s.premium&&this.cache.setPremium(s.premium),s.unit&&Object.keys(s.unit).map(t=>{let e=this.cache.getBarrackUnit(t);this.cache.patchUnit(t,{amount:s.unit[t]-(e?e.barrack.total:0)}),this.cache.computeUnitsTree([t]),setTimeout(()=>{},10)}),s.campaign_unit)for(let t in s.campaign_unit)for(let e in s.campaign_unit[t])this.cache.patchUnit(e,{amount:s.campaign_unit[t][e]},t);if(s.campaign_silver)for(let t in s.campaign_silver)this.cache.getCampaign(t),this.cache.setCampaignCurrency(t,null,s.campaign_silver[t]);if(s.campaign_free_xp)for(let t in s.campaign_free_xp)this.cache.getCampaign(t),this.cache.setCampaignCurrency(t,s.campaign_free_xp[t],null);if(s.commander)for(let t in s.commander)this.cache.grabCommander(s.commander[t]);this.removeContainer(t,n),i.next(n),this.cache.alertSound("money")}},n=>{i.error(n),Object(Pc.a)(`<[x] container [${t}](${e.containerTemplate}) error`,n)}),i):(Object(Pc.a)(`-> no container data ${t}...`),i.next(null),i)}removeContainer(t,e){let i=this._containers.findIndex(e=>e.id===t),n=this._containers[i];i>=0&&(this.visitService.visit(`task_${n.source.taskTemplate}_${n.source.task}`),this._containers.splice(i,1),delete this._containersKeys[t],this.onContainerOpen.next({id:t,result:e,taskTemplate:n.source.taskTemplate}),this.onContainerOpen.next(null))}removeCompletedTask(t,e){for(let i in this._tasksTemplates){let t=this._tasksTemplates[i];if(t.container&&t.container.length&&t.container.indexOf(e)>=0){let e=this._tasks.findIndex(e=>e.taskTemplate===t.id);e>=0&&this._tasks.splice(e,1)}}}isCalendarDayContainsReward(t,e){return!!this.getContainers().find(i=>i.containerTemplate===`${t}.d${e+1}`)}getTaskSequence(t,e){let i=[];if(!t){let i=this.getTaskForCommanderDiscount(e);i&&(t=i.id)}let n=this.getTask(t);if(!n)return null;if(n.tags&&n.tags.indexOf("commander_chain")>=0){let t=n.tags.find(t=>!!t.match(/^commander\./gim));if(!t)return null;for(let e in this._tasksTemplates){let n=this._tasksTemplates[e];n&&n.tags&&n.tags.indexOf(t)>=0&&i.push(n)}return i=i.sort((t,e)=>t.chain_order-e.chain_order).map(t=>(t.reward=this.getReward(null,t.id),t)),i.length?i:null}return null}getTaskSequencePrice(t,e){let i={oldPrice:0,newPrice:0,currentAmount:0,totalAmount:0,resultPrice:0,percent:0,currentPercent:0},n=this.getTask(t),s=this.getTaskSequence(null,e?e.id:null),a=this.getTaskProgress(t),r=this.getTasksFromCounters(e?e.id:null);if(!s&&!r.length||!e)return i;let o=0,c=[];s&&s.length?c=s:r.length&&(c=r);for(let l=0;l<c.length;l++)if(c[l].reward)for(let t=0;t<c[l].reward.length;t++)"commanderDiscount"===c[l].reward[t].key&&(i.percent+=c[l].reward[t].amount,(r.length&&(!s||s&&!s.length)||a.sequenceCurrent-1>l)&&(o+=c[l].reward[t].amount));return n&&n.reward&&n.reward.map(t=>{"commanderDiscount"===t.key&&(i.currentPercent+=t.amount,i.currentAmount+=t.amount/100*(t.commander.gold_cost||t.commander.silver_cost))}),i.percent=Math.min(o,100),i.oldPrice=e.gold_cost||e.silver_cost||0,i.newPrice=Math.floor(i.oldPrice-i.oldPrice*(o/100)),i.resultPrice=Math.floor(i.oldPrice-i.oldPrice*(i.percent/100)),i.totalAmount=i.oldPrice-i.resultPrice,i}getTasksFromCounters(t){let e=[];if(!t)return e;let i=this.cache.getCounter("task.complete.commander."+t);if(i)for(let n in i){let i=this._tasksTemplates[`commander.${t}.${n}`];i&&e.push(i)}return e.map(t=>(t.reward=this.getReward(null,t.id),t))}getTaskProgress(t){let e=this.getTask(t);if(!e)return{current:0,target:0,sequenceCurrent:0,sequenceTarget:0};let i=1,n=1;if(e.tags&&e.tags.indexOf("commander")>=0){let s=this.getTaskSequence(t);if(s){for(let t=0;t<s.length;t++)if(s[t].id===e.id){i=t+1;break}n=s.length}}return{current:("local_counter"===e.complete_condition[0].type?e.task.localCounter:this.cache.getCounter(e.complete_condition[0].id))||0,target:e.complete_condition[0].value||1,sequenceCurrent:i||0,sequenceTarget:n||0}}getTaskTemplateProgress(t){let e=this._tasksTemplates[t];return e?{current:("local_counter"===e.complete_condition[0].type?0:this.cache.getCounter(e.complete_condition[0].id))||0,target:e.complete_condition[0].value||1}:{current:0,target:0,sequenceCurrent:0,sequenceTarget:0}}getTaskForCommanderDiscount(t){return this._tasks.find(e=>e.taskTemplate.match(new RegExp("commander."+t,"gim")))||null}processVisitedTasks(){this.visitService.clearOutdated(this._tasksKeys)}getTaskForMission(t){for(let e in this._tasksTemplates){let i=this._tasksTemplates[e];if(i.map===t)return this.getTask(null,i.id)}return null}getTasksForCampaign(t,e=""){let i=[];for(let n=0;n<this._tasks.length;n++)if(this._tasks[n].campaign===t){let t=this.getTask(this._tasks[n].id,null);t&&(e&&e!==t.category||i.push(t))}return i.sort((t,e)=>t.display_order-e.display_order)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})();const xl="METAGAME_LOBBY_TAB";let Bl=(()=>{class t{constructor(){if(this.onLobbyCreated=new o.o,this.onLobbyChange=new o.o,this.onLobbyInvite=new o.o,this.onLobbyStart=new o.o,this.onLobbyClosed=new o.o,this.onLobbyJoin=new o.o,this.onLobbyLeave=new o.o,this.onLobbyListChange=new o.o,this.lobbyId="",this._lobbyData=null,this.fetch=Gc.Fetch,t.instance)return t.instance;(new al).data.subscribe(t=>this.L=t),t.instance=this}init(t,e,i,n){this.gameSparks=e,this.cache=t,this.cache.getUser().lobbyOwner?this.lobbySetId(this.cache.getUser().lobbyOwner):this.cache.getUser().lobbyMember&&this.lobbySetId(this.cache.getUser().lobbyMember),Object(Pc.a)("INIT :: LobbyService"),this.cache.getAuthService().onMessage.subscribe(t=>{if(t&&t.extCode&&!this.cache.isMatching){let e=t.data;switch(t.extCode){case"onLobbyChange":this._lobbyData=t.data.lobby||{},this.lobbyId||(console.log(">>>>>>>> lobbyID",this._lobbyData.id),this.lobbyId=this._lobbyData.id,this.onLobbyCreated.next(this.lobbyId),this.onLobbyCreated.next(null)),this._getOptionsFromData(),this.onLobbyChange.next(this.lobbyGetTeams()),this.onLobbyChange.next(null);break;case"onLobbyInvite":this.onLobbyInvite.next({date:e.date,from:{displayName:e.from.displayName,id:e.from.id},lobbyId:e.lobby,lobbyType:e.lobbyType,type:e.type,slot:e.slot}),this.onLobbyInvite.next(null);break;case"onLobbyStart":break;case"onLobbyJoin":this.onLobbyJoin.next(e),this.onLobbyJoin.next(null);break;case"onLobbyLeave":this.onLobbyLeave.next(e),this.onLobbyLeave.next(null),this.lobbyClose();break;case"onLobbyListUpdate":this.onLobbyListChange.next({key:"change",data:t.data}),this.onLobbyListChange.next(null);break;case"onLobbyListBatchUpdate":this.onLobbyListChange.next({key:"batch",data:t.data}),this.onLobbyListChange.next(null);break;case"onLobbyListDelete":this.onLobbyListChange.next({key:"delete",data:t.data}),this.onLobbyListChange.next(null)}}else this.cache.isMatching&&this.cache.devMode&&console.log("message skipped since isMatching true",t)})}lobbySetId(t){this.lobbyId=t||""}lobbyGetOptions(){return JSON.parse(JSON.stringify(this._options||Ul))}lobbyCreate(t,e){return this.fetch(pl.LobbyCreate.patch({type:t,options:e}),null,!0)}redirectToLobby(t){this.cache.devMode&&console.log("redirectToLobby");let e=()=>["multiplayer","lobby",t];this._lobbyData?this.cache.redirect(e()):this.lobbyGet(t).subscribe(t=>{this.cache.redirect(e())})}lobbyClose(t){if(this.cache.setReadyToFight(!1),t)return console.warn("Forced LobbyClose"),this.lobbyId=null,void(this._lobbyData=null);this.lobbyId&&(this._lobbyData&&this.cache.getUserId(),this.onLobbyClosed.emit(this.lobbyId),this.lobbyId=null,this._lobbyData=null,this.onLobbyClosed.emit(null),this.cache.isMatching||(Object(Pc.a)("redirecting after lobby close..."),this.cache.redirect(["multiplayer/lobby"])),this.saveLobbyTab(null))}lobbyGetType(){return this._lobbyData&&"gm"===this._lobbyData.type?jl.GM:jl.Custom}lobbyGetData(){return this._lobbyData}hasLobby(){return!!this.lobbyId}hasTournament(){return this.hasLobby()&&this.lobbyGetType()===jl.GM}hasCustomLobby(){return this.hasLobby()&&this.lobbyGetType()===jl.Custom}lobbyGet(t){let e=this.fetch(pl.LobbyGet.patch({lobby:t}),null,!0);return e.subscribe(t=>{this.cache.devMode&&console.log("LOBBY GET: ",t),this._lobbyData=t||{},this.lobbyId=this._lobbyData.id,this._lobbyData||console.warn("LobbyData is null (lobbyGet)"),this._lobbyData&&this._getOptionsFromData()},t=>{t&&t.lobby_not_found&&(console.warn("lobby_not_found"),this.lobbyClose(!0),this.onLobbyChange.next(this.lobbyGetTeams()),this.onLobbyChange.next(null),this.cache.redirect(["multiplayer/lobby"]))}),e}lobbyGetId(){return this.lobbyId}lobbyGetTeam(t){let e=[];if(!this._lobbyData)return[];for(let i in this._lobbyData.members)this._lobbyData.members[i]&&e.push(Object.assign(Object.assign({},this._lobbyData.members[i]),{id:i}));return e.filter(e=>e.type===t)}lobbyGetTeams(){return{teamA:this.lobbyGetTeam(Al.TeamA),teamB:this.lobbyGetTeam(Al.TeamB),spectators:this.lobbyGetTeam(Al.Spectators),unbound:this.lobbyGetTeam(Al.Unbound)}}lobbyGetUserTeam(t){let e={id:null,members:[]};if(!this._lobbyData)return e;for(let i in this._lobbyData.members)this._lobbyData.members[i]&&i===t&&(e.id=this._lobbyData.members[i].type);return e.members=this.lobbyGetTeam(e.id),e}lobbyGetUser(t){if(!this._lobbyData)return null;for(let e in this._lobbyData.members)if(this._lobbyData.members[e]&&e===t)return this._lobbyData.members[e];return null}lobbyInvite(t,e,i){return this.fetch(pl.LobbyInvite.patch({lobby:t,player:e,slot:i}),null,!0)}lobbyJoin(t,e,i){return this.fetch(pl.LobbyJoin.patch({lobby:t,password:i||""}),null,!0)}lobbyKick(t,e){return this.fetch(pl.LobbyKick.patch({lobby:t,team:e}),null,!0)}lobbyLeave(t){let e=this.fetch(pl.LobbyLeave,null,!0);return e.subscribe(()=>{this.lobbyClose()}),e}lobbyStart(){return this.fetch(pl.LobbyStart.patch({lobby:this.lobbyId}),null,!0)}lobbyJoinByOwner(t,e){return this.fetch(pl.LobbyJoinByOwner.patch({lobby:t,type:e}),null,!0)}lobbySetOptions(t){let e=this.fetch(pl.LobbySetOptions.patch({lobby:this.lobbyId,options:{mode:t.mode,commanderVisibility:t.commanderVisibility,map:"random"===t.map?null:t.map,difficulty:t.difficulty,size:t.size,maxUnitLevel:t.unitLevel,armyMode:t.armyMode,armyA:t.armyA,armyB:t.armyB,submode:t.submode,name:t.name,environment:t.environment,password:t.password,realism:t.realism||!1,serverPlacement:t.serverPlacement,hidden:t.hidden,victoryPoints:t.victoryPoints,duration:t.duration,budget:t.budget}}),null,!0);return e.subscribe(t=>{this._getOptionsFromData(t.scriptData)}),e}_getOptionsFromData(t){let e=t||this._lobbyData;if(!e||e&&!e.options)return Ul;let i=e.options;this._options={mode:i.mode||Ul.mode,commanderVisibility:i.commanderVisibility||Ul.commanderVisibility,map:i.map||Ul.map,difficulty:i.difficulty||Ul.difficulty,unitLevel:i.maxUnitLevel||Ul.unitLevel,size:i.size||Ul.size,armyMode:i.armyMode||Ul.armyMode,armyA:i.armyA||Ul.armyA,armyB:i.armyB||Ul.armyB,submode:i.submode||Ul.submode,name:i.name||Ul.name,environment:i.environment||Ul.environment,password:i.password||Ul.password,realism:i.realism||Ul.realism,serverPlacement:i.serverPlacement||Ul.serverPlacement,hidden:i.hidden||Ul.hidden,victoryPoints:i.victoryPoints,duration:i.duration,budget:i.budget},this._options||(this._options.map="random")}lobbyGetList(){return this.fetch(pl.LobbyList)}lobbyKickPlayer(t,e){return this.fetch(pl.LobbyKickPlayer.patch({lobby:t,player:e}),null,!0)}lobbyTakeSlot(t,e){return this.fetch(pl.LobbyTakeSlot.patch({lobby:t,slot:e}),null,!0)}lobbySetupSlot(t,e,i,n){let s=this.fetch(pl.LobbySetupSlot.patch({lobby:t,slot:e,state:i,id:i===zl.Bot&&n?n:""}),null,!0);return s.subscribe(t=>{this._getOptionsFromData(t.scriptData)}),s}lobbySetCommander(t,e){let i=this.cache.getCommander(e);if(i)return this.fetch(pl.LobbySetCommander.patch(i.available&&i.available.id?{lobby:t,commander:{id:i.available.id,template:i.id}}:{lobby:t,commander:{template:i.id}}),null,!0);console.warn(`No commander found for [${e}] in lobbySetCommander!`)}lobbySetReady(t,e){return this.fetch(pl.LobbySetReady.patch({lobby:t,ready:e?1:0}),null,!0)}lobbySideChat(t,e){if(e)return this.fetch(pl.LobbySideChat.patch({lobbyId:t,text:e}),null,!0);console.warn("cannot send message because there is no message!!!")}lobbyShuffle(t){return this.fetch(pl.LobbyShuffle.patch({lobby:t}),null,!0)}lobbyGetSlots(){let t={teamA:[],teamB:[],teamS:[],unbound:[]};if(!this._lobbyData||!this._lobbyData.slots)return t;let e=t=>t.match(/^a/gim)?"teamA":t.match(/^b/gim)?"teamB":t.match(/^s/gim)?"teamS":"unbound";for(let i in this._lobbyData.slots){let n=JSON.parse(JSON.stringify(this._lobbyData.slots[i]));if(n.playerId=n.id,n.id=i,"player"!==n.state&&"invited"!==n.state||(n.player=this._lobbyData.members[n.playerId],n.player.id=n.playerId,t[e(i)].notEmpty=!0),"bot"===n.state){let s=this.cache.getBotCommanders().commanders.find(t=>t.id===n.playerId);n.bot=s,t[e(i)].notEmpty=!0}t[e(i)].push(n)}return t}lobbyIsAllyNation(t,e){return t===El.None||!e||Pl[t].indexOf(e)>=0}getLobbyTeam(){let t=this.cache.getUserId(),e=this.lobbyGetData();return e&&e.members&&e.members.hasOwnProperty(t)?e.members[t].type:""}getSavedLobbyTab(){return JSON.parse(localStorage.getItem(xl+"_"+this.cache.getUserId()))}saveLobbyTab(t){localStorage.setItem(xl+"_"+this.cache.getUserId(),JSON.stringify(t))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})();var jl=function(t){return t.GM="gm",t.Custom="custom",t}({}),Ml=function(t){return t.All="all",t.Team="team_only",t.TeamAndGM="team_and_gm",t}({}),Ql=function(t){return t.All="",t.Morning="morning",t.Day="day",t.Rain="rain",t.Evening="evening",t.Night="night",t}({}),Al=function(t){return t.TeamA="team_a",t.TeamB="team_b",t.Spectators="team_s",t.Unbound="none",t}({}),Dl=function(t){return t.PVP="pvp",t.PVE="pve",t.COOP="coop",t.DUEL="duel",t.TANKS="tanks",t.CLASSIC="classic",t}({}),El=function(t){return t.None="",t.Rus="rus",t.Ger="ger",t.USA="usa",t.Eng="eng",t.Jap="jap",t.All="all",t}({}),Nl=function(t){return t.All="all",t.Exact="exact",t.Ally="ally",t}({}),Fl=function(t){return t.Local="local",t.Dedicated="dedicated",t}({});const Pl={rus:["rus","usa"],ger:["ger"],usa:["rus","usa"],all:[]},Ul={mode:Dl.PVP,commanderVisibility:Ml.TeamAndGM,map:"random",difficulty:"novice",size:0,unitLevel:0,armyMode:Nl.All,armyA:El.None,armyB:El.None,submode:function(t){return t.None="",t.Groundcontrol="groundcontrol",t.Deathmatch="groundcontrol_deathmatch",t.Mission="mission",t.Polygon="polygon",t}({}).None,environment:Ql.All,password:"",realism:!1,serverPlacement:Fl.Local,hidden:!1};var zl=function(t){return t.Open="open",t.Closed="closed",t.Bot="bot",t}({}),Jl=function(t){return t.Teams="teams",t.Troops="troops",t.Options="options",t}({}),ql=function(t){return t.Jap="jap",t.Rus="rus",t.Ger="ger",t.Usa="usa",t.Eng="eng",t.param="army",t}({}),Vl=function(t){return t.Coop="coop",t.Ai="ai",t.Training="training",t.Pve="pve",t.Pvp="pvp",t.Tutorial="tutorial",t.Duel="duel",t.Classic="classic",t}({}),$l=function(t){return t.Commander="commander:",t.Unit="unit:",t.MatchRequest="match_request:",t.Options="options",t.Connect="connect:",t}({}),Gl=function(t){return t.NONE="NONE",t.CANCELLING="CANCELLING",t.OPENING="OPENING",t.WAITING="WAITING",t.LOADING="LOADING",t.READY="READY",t.RUNNING="RUNNING",t.ENDED="ENDED",t.REQUESTED="REQUESTED",t.LOCAL_REQUESTED="LOCAL_REQUESTED",t}({}),Hl=function(t){return t.IDLE="IDLE",t.REQUEST_ISSUED="REQUEST_ISSUED",t.REQUEST_RUNNING="REQUEST_RUNNING",t}({}),Yl=function(t){return t.waiting="waiting",t.gamelifting="gamelifting",t.loading="session.loading",t.ready="session.ready",t.running="session.running",t.ended="session.ended",t.closed="closed",t.requested="server.requested",t.local_requested="local.requested",t}({}),Wl=function(t){return t.OnMatchOpened="onMatchOpened",t.OnMatchUpdate="onMatchUpdate",t.OnMatchClosed="onMatchClosed",t.OnServerClosed="onServerClosed",t.OnMatchRequest="onMatchRequest",t.MatchNotFoundMessage="MatchNotFoundMessage",t.MatchFoundMessage="MatchFoundMessage",t.MatchUpdatedMessage="MatchUpdatedMessage",t.ShopTransactionComplete="onShopTransactionComplete",t.TeamMatchStarted="onMmRequest",t.TeamMatchCanceled="onMmCancel",t.OnMatchBucketChanged="onMatchBucketChanged",t}({}),Kl=function(t){return t.Request="Match request",t}({}),Xl=function(t){return t.All="all",t.NotEmpty="not_empty",t}({}),Zl=function(t){return t.Default="default",t.Decreasing="decreasing",t}({}),tu=function(t){return t.All="all",t.Rus="rus",t.Ger="ger",t.USA="usa",t}({}),eu=function(t){return t.All="all",t.Tank="tnk",t.Infantry="inf",t.Artillery="art",t}({}),iu=function(t){return t.All="all",t.Tank="tnk",t.Infantry="inf",t.Artillery="art",t}({}),nu=function(t){return t.All="all",t.Apk="apc",t.Artillery="art",t.ArtPoint="art_point",t.ArtSpec="art_spec",t.InfBasic="inf_basic",t.InfHeavy="inf_heavy",t.InfSpec="inf_spec",t.InfSup="inf_sup",t.Sup="sup",t.TnkHeavy="tnk_heavy",t.TnkHunt="tnk_hunt",t.TnkLight="tnk_light",t.TnkMed="tnk_med",t.Spg="spg",t.InfAi="inf_ai",t.InfParatrooper="inf_paratrooper",t.Aviation="aviation",t.SupVeh="sup_veh",t}({}),su=function(t){return t.All="all",t.Completed="completed",t.InProgress="active",t.IDLE="idle",t}({}),au=function(t){return t.Around="around",t.Top="top",t.Friends="friends",t}({}),ru=function(t){return t.Top1="top1",t.Top2="top2",t.Top3="top3",t.Legend="legend",t.Elite="elite",t.Veteran="veteran",t.Regular="regular",t.Recruit="recruit",t}({});const ou=[ql.Rus,ql.Ger,ql.Usa,ql.Eng,ql.Jap];class cu{constructor(t,e,i){this.value=t,this.disabled=e,this.selected=i}}class lu{constructor(t){t||(t={selected:!1,disabled:!0}),ou.map(e=>{this[e]=new cu(e,t.disabled,t.selected)})}}class uu{constructor(){if(this.events=[],this.subject=new Nc(null),uu.instance)return uu.instance;uu.instance=this,window.addEventListener("mousedown",t=>{let e=this.createDOMTrigger("scroll-to",t);e&&(this.subject.next(e),this.subject.next(null),Object(Pc.a)("global event [scroll-to] "+JSON.stringify(e.data)))})}trigger(t,e){let i={key:t,data:e||null,timestamp:(new Date).getTime()};return this.subject.next(i),this.subject.next(null),this.events.push(i),Object(Pc.a)(`global event [${t}] ${e?JSON.stringify(e):"null"}`),this.subject}subscribe(t){return t||console.warn("no callback for GlobalEvent subscribe"),this.subject.pipe(We(t=>null!==t)).subscribe(t)}createDOMTrigger(t,e){if(!e||!e.target)return null;let i=e.target.closest(`[${t}]`);return i?{key:t,data:{selector:i.getAttribute(t)},timestamp:(new Date).getTime()}:null}}var du=function(t){return t.DoNotDisturb="dnd",t.Offline="offline",t.Online="online",t}({});const hu={createMissionByInterface:function(t){return{id:t._id,_id:t._id,commanderTag:t.commander_tag,mode:t.mode,modificator:t.modificator,tags:t.tags,order:"number"==typeof t.order?t.order:0,mission:t,image:t.image||"",image_preview:t.image_preview||"",background:t.background||""}},hasTag:function(t,e){return!(!t||!t.tags)&&t.tags.indexOf(e)>-1},hasModificator:function(t,e){return!(!t||!t.modificator)&&t.modificator.indexOf(e)>-1},getArmy:function(t){let e=[ql.Eng,ql.Ger,ql.Jap,ql.Rus,ql.Usa];for(let i=0;i<e.length;i++)if(this.hasTag(t,e[i]))return e[i];return null}},bu=function(t,e,i){let n={id:t._id,map:[],tags:t.tags,order:t.display_order||0,progress:e||null,tasks:i||[],nodes:[],modId:t.modId||null,image:t.image||"",image_preview:t.image_preview||"",currency:t.currency||"",inProgress:t.in_progress||!1,category:t.category||"",mission_results:t.mission_results,phase:t.phase};if(t.node)for(let s in t.node)t.node[s]._id=s,n.nodes.push(t.node[s]),n.map.push(t.node[s].map[0]);return n},mu={getPointInLine(t,e,i){let n=new yl;return n.x=t.x-(t.x-e.x)*i,n.y=t.y-(t.y-e.y)*i,n},getPointInCubic(t,e,i,n,s){let a=this.getPointInLine(t,e,s),r=this.getPointInLine(e,i,s),o=this.getPointInLine(i,n,s),c=this.getPointInLine(a,r,s),l=this.getPointInLine(r,o,s);return this.getPointInLine(c,l,s)},getPointInQuadrant(t,e,i,n){let s=this.getPointInLine(t,e,n),a=this.getPointInLine(e,i,n);return this.getPointInLine(s,a,n)},getPointInPath(t,e){let i=new yl,n=Math.floor(e*t.length),s=e/t.length;if(n<=1){let n={a:t[0],b:t[1],c:t[1].getMiddleWith(t[2])};i=this.getPointInQuadrant(n.a,n.b,n.c,e*t.length/2).clone()}if(n>=t.length-2){let n={a:t.last(2).getMiddleWith(t.last(1)),b:t.last(1),c:t.last()};i=this.getPointInQuadrant(n.a,n.b,n.c,(e*t.length-t.length)/2+1).clone()}if(n>1&&n<t.length-2){let a={a:t[n-1].getMiddleWith(t[n]),b:t[n],c:t[n].getMiddleWith(t[n+1])};i=this.getPointInQuadrant(a.a,a.b,a.c,e*t.length-n+s*(n%2)).clone()}return i},getArrayLength(t){let e=0;if(!t||t.length<=1)return e;for(let i=1;i<t.length;i++)e+=t[i-1].distanceTo(t[i]);return e}};let pu=(()=>{class t{constructor(e,i,n){if("number"==typeof e&&"number"==typeof i&&"number"==typeof n)this.r=e,this.g=i,this.b=n;else{let e=t.next();this.r=e.r,this.g=e.g,this.b=e.b}}getRGB(){return`rgb(${this.r}, ${this.g}, ${this.b})`}static HEXToRGB(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}static reset(){t.lastHue=40}static next(){let e=function(t,e,i){let n=.55*Math.min(i,1-i),s=(e,s=(e+t/30)%12)=>i-n*Math.max(Math.min(s-3,9-s,1),-1);return[s(0),s(8),s(4)]}(t.lastHue,0,.55-Math.floor(t.lastHue/360)/15);return t.lastHue+=36,new t(Math.floor(255*e[0]),Math.floor(255*e[1]),Math.floor(255*e[2]))}}return t.lastHue=40,t})();function gu(t,e,i){this.x=t,this.y=e,this.z=i}function fu(t){return t*t*t*(t*(6*t-15)+10)}function vu(t,e,i){return(1-i)*t+i*e}function yu(){let t=[new gu(1,1,0),new gu(-1,1,0),new gu(1,-1,0),new gu(-1,-1,0),new gu(1,0,1),new gu(-1,0,1),new gu(1,0,-1),new gu(-1,0,-1),new gu(0,1,1),new gu(0,-1,1),new gu(0,1,-1),new gu(0,-1,-1)],e=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],i=new Array(512),n=new Array(512),s=.5*(Math.sqrt(3)-1),a=(3-Math.sqrt(3))/6,r=1/6;this.seed=function(s){s>0&&s<1&&(s*=65536),(s=Math.floor(s))<256&&(s|=s<<8);for(let a=0;a<256;a++){let r;r=1&a?e[a]^255&s:e[a]^s>>8&255,i[a]=i[a+256]=r,n[a]=n[a+256]=t[r%12]}},this.simplex2=function(t,e){let r,o,c,l,u,d=(t+e)*s,h=Math.floor(t+d),b=Math.floor(e+d),m=(h+b)*a,p=t-h+m,g=e-b+m;p>g?(l=1,u=0):(l=0,u=1);let f=p-l+a,v=g-u+a,y=p-1+2*a,_=g-1+2*a;h&=255,b&=255;let k=n[h+l+i[b+u]],w=n[h+1+i[b+1]],S=.5-p*p-g*g;S<0?r=0:(S*=S,r=S*S*n[h+i[b]].dot2(p,g));let I=.5-f*f-v*v;I<0?o=0:(I*=I,o=I*I*k.dot2(f,v));let C=.5-y*y-_*_;return C<0?c=0:(C*=C,c=C*C*w.dot2(y,_)),70*(r+o+c)},this.simplex3=function(t,e,s){let a,o,c,l,u,d,h,b,m,p,g=.3333333333333333*(t+e+s),f=Math.floor(t+g),v=Math.floor(e+g),y=Math.floor(s+g),_=(f+v+y)*r,k=t-f+_,w=e-v+_,S=s-y+_;k>=w?w>=S?(u=1,d=0,h=0,b=1,m=1,p=0):k>=S?(u=1,d=0,h=0,b=1,m=0,p=1):(u=0,d=0,h=1,b=1,m=0,p=1):w<S?(u=0,d=0,h=1,b=0,m=1,p=1):k<S?(u=0,d=1,h=0,b=0,m=1,p=1):(u=0,d=1,h=0,b=1,m=1,p=0);let I=k-u+r,C=w-d+r,L=S-h+r,R=k-b+2*r,O=w-m+2*r,T=S-p+2*r,x=k-1+.5,B=w-1+.5,j=S-1+.5;f&=255,v&=255,y&=255;let M=n[f+u+i[v+d+i[y+h]]],Q=n[f+b+i[v+m+i[y+p]]],A=n[f+1+i[v+1+i[y+1]]],D=.6-k*k-w*w-S*S;D<0?a=0:(D*=D,a=D*D*n[f+i[v+i[y]]].dot3(k,w,S));let E=.6-I*I-C*C-L*L;E<0?o=0:(E*=E,o=E*E*M.dot3(I,C,L));let N=.6-R*R-O*O-T*T;N<0?c=0:(N*=N,c=N*N*Q.dot3(R,O,T));let F=.6-x*x-B*B-j*j;return F<0?l=0:(F*=F,l=F*F*A.dot3(x,B,j)),32*(a+o+c+l)},this.perlin2=function(t,e){let s=Math.floor(t),a=Math.floor(e);t-=s,e-=a,s&=255,a&=255;let r=n[s+i[a]].dot2(t,e),o=n[s+i[a+1]].dot2(t,e-1),c=n[s+1+i[a]].dot2(t-1,e),l=n[s+1+i[a+1]].dot2(t-1,e-1),u=fu(t);return vu(vu(r,c,u),vu(o,l,u),fu(e))},this.perlin3=function(t,e,s){let a=Math.floor(t),r=Math.floor(e),o=Math.floor(s);t-=a,e-=r,s-=o,a&=255,r&=255,o&=255;let c=n[a+i[r+i[o]]].dot3(t,e,s),l=n[a+i[r+i[o+1]]].dot3(t,e,s-1),u=n[a+i[r+1+i[o]]].dot3(t,e-1,s),d=n[a+i[r+1+i[o+1]]].dot3(t,e-1,s-1),h=n[a+1+i[r+i[o]]].dot3(t-1,e,s),b=n[a+1+i[r+i[o+1]]].dot3(t-1,e,s-1),m=n[a+1+i[r+1+i[o]]].dot3(t-1,e-1,s),p=n[a+1+i[r+1+i[o+1]]].dot3(t-1,e-1,s-1),g=fu(t),f=fu(e),v=fu(s);return vu(vu(vu(c,h,g),vu(l,b,g),v),vu(vu(u,m,g),vu(d,p,g),v),f)}}gu.prototype.dot2=function(t,e){return this.x*t+this.y*e},gu.prototype.dot3=function(t,e,i){return this.x*t+this.y*e+this.z*i};const _u={drawPoint(t,e,i){i=i||3,t.beginPath(),t.arc(e.x,e.y,i,0,2*Math.PI),t.fill()},drawLine(t,e,i,n){if(t.beginPath(),n&&(n.color&&(t.strokeStyle=n.color),n.strokePattern&&t.setLineDash(n.strokePattern),n.opacity&&(t.globalAlpha=n.opacity),n.lineWidth&&(t.lineWidth=n.lineWidth),t.lineCap="round"),e.x!==i.x&&e.y!==i.y||n&&n.forceUseLine)t.moveTo(e.x,e.y),t.lineTo(i.x,i.y),t.stroke();else{let n=e.x===i.x,s=e.y===i.y,a=e.min(i),r=e.max(i).subtract(a);s&&t.rect(a.x,a.y-Math.floor(t.lineWidth/2),r.x,t.lineWidth),n&&t.rect(a.x+Math.floor(t.lineWidth/2),a.y,t.lineWidth,r.y),t.fill()}},drawText(t,e,i,n){n||(n="center center");let s=n.split(" ")[0],a=n.split(" ")[1],r=t.textBaseline,o=t.textAlign;t.textBaseline=s,t.textAlign=a,t.beginPath(),t.fillText(e,i.x,i.y),t.textBaseline=r,t.textAlign=o},drawBezierArray(t,e){for(let a=0;a<e.length;a++){var i,n,s;i=n=s=new yl,t.beginPath(),0==a&&(i=e[0].clone(),n=e[1].clone(),s=e[1].clone().lerp(e[2].clone(),.5)),a>1&&a<e.length-2&&(i=e[a-1].clone().lerp(e[a].clone(),.5),n=e[a].clone(),s=e[a].clone().lerp(e[a+1].clone(),.5)),a==e.length-1&&(i=e.last(2).clone().lerp(e.last(1),.5),n=e.last(1).clone(),s=e.last().clone()),t.moveTo(i.x,i.y),t.quadraticCurveTo(n.x,n.y,s.x,s.y),t.stroke()}},drawBezierArrayDashed(t,e,i){i=i||50,mu.getPointInPath(e,0);let n=.001,s=(i,s=!1,a)=>{let r=0,o=mu.getPointInPath(e,i);for(s&&t.beginPath();r<a-a/5;){let a=mu.getPointInPath(e,i+n);r+=a.distanceTo(o),s&&(t.moveTo(o.x,o.y),t.lineTo(a.x,a.y)),i+=n,o=a}return s&&t.stroke(),Math.clamp(i+n,0,1)},a=0;for(;a<1;)a=s(a,!1,i/5),a=s(a,!0,i)},drawBezierArrayBounded(t,e,i,n){mu.getPointInPath(e,0);let s=.001,a=e[0].distanceTo(e.last());t.lineCap="square";let r=(i,n=!1,a)=>{let r=0,o=mu.getPointInPath(e,i);for(n&&t.beginPath();r<a;){let a=mu.getPointInPath(e,i+s);r+=a.distanceTo(o),n&&(t.moveTo(o.x,o.y),t.lineTo(a.x,a.y)),i+=s,o=a}return n&&t.stroke(),Math.clamp(i+s,0,1)},o=0;for(o=r(o,!1,i);o<1-n/a;)o=r(o,!0,5)},drawBezierSegment(t,e,i=0,n=1,s=5){void 0===n&&(n=i,i=0);let a=mu.getPointInPath(e,i);t.beginPath(),t.moveTo(a.x,a.y);let r=Math.floor(mu.getArrayLength(e)/s*(n-i));for(var o=0;o<r;o++){let s=mu.getPointInPath(e,i+o/(r-1)*(n-i));t.lineTo(s.x,s.y)}t.stroke()},randomizePath(t,e,i){void 0===e&&(e=2);let n=[],s=i||t[0].distanceTo(t.last())/e/10,a=parseInt(t[0].distanceTo(t.last()).toString().substr(0,4)),r=Math.pseudoRandom(a);for(let o=0;o<t.length-1;o++){let i=t[o],a=t[o+1];n.push(i);for(let t=1;t<=e;t++){let o=i.lerp(a,1/(e+1)*t).add(new yl(r.next(!0)*s,r.next(!0)*s));n.push(o)}}return n.push(t.last()),n},drawImage(t,e,i,n){e&&("number"==typeof n?n=new yl(Math.floor(e.width*n),Math.floor(e.height*n)):n||(n=new yl(e.width,e.height)),t.drawImage(e,i.x,i.y,n.x,n.y))},createRadialGradient(t,e,i,n,s,a,r){let o="object"==typeof i&&i?i.x:t.canvas.width/2,c="object"==typeof i&&i?i.y:t.canvas.height/2,l="object"==typeof i&&i?i.x:t.canvas.width/2,u="object"==typeof i&&i?i.y:t.canvas.height/2;n="number"==typeof n?n:0,s="number"==typeof s?s:Math.min(l,u);let d=e.push?e[0]:`rgba(${e.replace(/(r|g|b|a|\(|\))/gim,"")},0)`,h=e.push?e[1]:`rgba(${e.replace(/(r|g|b|a|\(|\))/gim,"")},1)`,b=e.push?e[2]:`rgba(${e.replace(/(r|g|b|a|\(|\))/gim,"")},0)`,m=t.createRadialGradient(o,c,n,l,u,s);return r||(r=.5),m.addColorStop(0,d),a?(m.addColorStop(Math.clamp(r-a,0,1),d),m.addColorStop(r,h),m.addColorStop(Math.clamp(r+a,0,1),b)):m.addColorStop(r,h),m.addColorStop(1,b),m},drawDonutSegment(t,e,i,n,s,a){let r=e.x,o=e.y,c=yl.deg2rad(s),l=yl.deg2rad(a),u=new yl(r+Math.cos(c)*i,o+Math.sin(c)*i),d=new yl(r+Math.cos(c)*n,o+Math.sin(c)*n),h=new yl(r+Math.cos(l)*n,o+Math.sin(l)*n),b=new yl(r+Math.cos(l)*i,o+Math.sin(l)*i);t.beginPath(),t.moveTo(u.x,u.y),t.lineTo(d.x,d.y),t.arc(r,o,n,c,l),t.moveTo(h.x,h.y),t.lineTo(b.x,b.y),t.arc(r,o,i,l,c,!0),t.fill()},getBoxInCircle(t){let e=new yl,i=t/2,n=Math.sqrt(Math.pow(i,2)+Math.pow(i,2));return e.x=n,e.y=n,e},drawStarMask(t,e,i){t.setTransform(1,0,0,1,0,0);let n=t.fillStyle;t.fillStyle="white";let s=i.divide(-2);t.translate(e.x,e.y),t.rect(s.x,s.y,i.x,i.y),t.rotate(yl.deg2rad(45)),t.rect(s.x,s.y,i.x,i.y),t.fill(),t.fillStyle=n,t.setTransform(1,0,0,1,0,0)},resizeImage(t,e=new yl,i="image/png"){let n=document.createElement("canvas"),s=n.getContext("2d"),a=n.width=e.x,r=n.height=e.y;s.drawImage(t,0,0,a,r);let o=new Image,c=new Promise((t,e)=>{o.onload=()=>{t(o)}});return o.src="image/jpeg"===i?n.toDataURL(i,.95):n.toDataURL(i),c},cropImage(t,e=new yl,i="image/png"){let n=document.createElement("canvas"),s=n.getContext("2d"),a=(n.width=e.x,n.height=e.y,new yl(t.width,t.height)),r=e.clone(),o=new Image;return new Promise((e,c)=>{t.width>t.height?(s.drawImage(t,(r.x-a.x)/2,0,t.width,t.height),o.onload=()=>{e(o)},o.src="image/jpeg"===i?n.toDataURL(i,.95):n.toDataURL(i)):e(t)})},imageToBlob(t,e,i="image/png"){let n=document.createElement("canvas"),s=n.getContext("2d"),a=n.width=t.width,r=n.height=t.height;return s.drawImage(t,0,0,a,r),new Promise((t,e)=>{"image/jpeg"===i?n.toBlob(t,i,.95):n.toBlob(t,i)})},drawArrow(t,e,i,n=0,s="#fff"){let a=(i*=1.5)/1.5;t.beginPath(),t.fillStyle=s;let r=(0===n||n===-Math.PI||n===Math.PI?new yl(0,.5):new yl(-.5,0)).rotateAround(n),o=new yl(r.x-i,r.y-i+a).rotateAround(n),c=new yl(r.x-i,r.y+i-a).rotateAround(n);r=r.add(e),o=o.add(e),c=c.add(e),t.moveTo(r.x,r.y),t.lineTo(o.x,o.y),t.lineTo(c.x,c.y),t.lineTo(r.x,r.y),t.fill()},drawCampaignMapArrow(t,e,i,n,s,a){n||(n="rgb(100,100,100)");let r=new yl,o=Math.abs(i.subtract(e).getAngle()),c=o<Math.PI/2+.1&&o>Math.PI/2-.1,l={a:new yl(-.5,-1),b:new yl(.5,-1),c:new yl(1,0),d:new yl(0,-1),e:new yl(-1,0)},u={a:new yl(0,-1e-4),b:new yl(.5,1.5),c:new yl(.25,1.3),d:new yl(-.25,1.3),e:new yl(-.5,1.5)},d=e.distanceTo(i),h=i.subtract(e).getAngle(),b=e.crossVector(i,c?0:null),m=c?0:d/10,p=c?d/-100:d/50,g={},f={};["a","b","c","d","e"].map(t=>{g[t]=e.add(l[t].multiply(20)),f[t]=e.add(u[t].multiply(20).subtract(new yl(0,d)))}),g=r.rotateShapeAroundPivot(e,h,g,"d"),f=r.rotateShapeAroundPivot(e,h,f,"a");let v=b.subtract(e).getAngle(),y=i.subtract(b).getAngle(),_=e.crossVector(i,m-p),k=e.crossVector(i,m+p),w=e.crossVector(i,m);if(null===t)return{posA:e.clone(),posB:i.clone(),cross:e.crossVector(i,m)};(h<0&&h>-Math.PI/2||h>Math.PI/2&&h<Math.PI)&&([_,k]=[k,_]),g=r.rotateShapeAroundPivot(e,v,g,"d"),f=r.rotateShapeAroundPivot(i,y,f,"a");let S=a&&a.fgOpacity?a.fgOpacity:[0,.5],I=pu.HEXToRGB(n),C=t.createLinearGradient(e.x,e.y,i.x,i.y);C.addColorStop(0,`rgba(${I.r},${I.g},${I.b},${S[0]})`),C.addColorStop(1,`rgba(${I.r},${I.g},${I.b},${S[1]})`);let L=t.createLinearGradient(e.x,e.y,i.x,i.y);return L.addColorStop(0,`rgba(${I.r},${I.g},${I.b},${S[0]})`),L.addColorStop(1,`rgba(${I.r},${I.g},${I.b},${S[1]})`),t.strokeStyle=L,t.fillStyle=C,s&&(t.shadowColor="rgba(0,0,0,.5)",t.shadowBlur=20),t.setLineDash([]),t.globalAlpha=1,t.lineWidth=5,a&&(a.strokePattern&&t.setLineDash(a.strokePattern),a.opacity&&(t.globalAlpha=a.opacity),a.filled||(t.fillStyle="rgba(255,255,255,0)"),a.lineWidth&&(t.lineWidth=a.lineWidth)),a&&a.style&&a.style===ku.Simple?(t=>{let e=yl.lerp(f.d,f.c,.5);t.beginPath(),t.moveTo(e.x,e.y),t.quadraticCurveTo(w.x,w.y,g.d.x,g.d.y),t.moveTo(e.x,e.y),t.closePath(),t.stroke(),t.beginPath(),t.lineTo(f.e.x,f.e.y),t.lineTo(f.a.x,f.a.y),t.lineTo(f.b.x,f.b.y),t.lineTo(f.c.x,f.c.y),t.lineTo(f.d.x,f.d.y),t.closePath(),t.fill()})(t):((R=t).beginPath(),R.moveTo(g.d.x,g.d.y),R.lineTo(g.e.x,g.e.y),R.quadraticCurveTo(_.x,_.y,f.d.x,f.d.y),R.lineTo(f.e.x,f.e.y),R.lineTo(f.a.x,f.a.y),R.lineTo(f.b.x,f.b.y),R.lineTo(f.c.x,f.c.y),R.quadraticCurveTo(k.x,k.y,g.c.x,g.c.y),R.lineTo(g.d.x,g.d.y),R.closePath(),R.fill(),R.stroke()),null;var R},drawCampaignMap(t){let e=new yu;e.seed(Math.random());let i=t.canvas.width,n=t.canvas.height,s=[];for(let a=0;a<i;a++){s[a]||(s[a]=[]);for(let t=0;t<n;t++)s[a][t]=(1+e.simplex2(a/(i/2),t/(i/2)))/2}for(let a=0;a<i;a++)for(let e=0;e<n;e++)t.fillStyle=`rgba(0,0,0,${s[a][e]})`,t.fillRect(a,e,1,1);console.log(s)}};var ku=function(t){return t.Default="default",t.Simple="simple",t}({});new class{constructor(){this.cache={},this.isLoading={},this.images={},this.urls=[],this.placeholder="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="}loadImages(t,e){let i=new Nc;for(let n=0;n<t.length;n++){let s=e?e[n]:t[n],a=new Image;this.images[s]?a.complete?i.next([]):a.addEventListener("load",()=>{i.next([])}):(a.setAttribute("cache-image","true"),a.setAttribute("crossorigin","anonymous"),this.images[s]=a,a.addEventListener("load",()=>{this.cache[s]=this.getUrlImageData(a),i.next([])}),a.src=t[n],document.body.appendChild(a))}return this.urls=this.urls.concat(e||t).unique(),i}OnLoad(){}getImages(){let t=[];for(let e=0;e<this.urls.length;e++)this.cache[this.urls[e]]&&t.push(this.getImage(this.urls[e]));return t}getImage(t){let e=new Image;return e.src=this.cache[t]?this.cache[t]:this.placeholder,e}getUrlImageData(t){let e=document.createElement("canvas"),i=e.getContext("2d"),n=e.width=t.width,s=e.height=t.height;return t.src.match(/\.svg$/gim)&&(n=e.width=t.width=512,s=e.height=t.height=512),i.clearRect(0,0,n,s),i.drawImage(t,0,0,n,s),e.toDataURL()}};const wu=(Su={},function(t,e,i){i||(i="Don't call this twice without a uniqueId"),Su[i]&&clearTimeout(Su[i]),Su[i]=setTimeout(t,e)});var Su;function Iu(t,e){let i=t,n=e.split("."),s="";if(!t)return s;for(let a=0;a<n.length;a++){let t=n[a];if(!i[t])return"number"==typeof i[t]&&(s=i[t]),s;if(a==n.length-1)return i[t];"object"==typeof i[t]&&(i=i[t]),s=i[t]}return s}function Cu(t,e,i){let n=t,s=e.split(".");for(let a=0;a<s.length;a++){let t=s[a];void 0===n[t]&&(n[t]={}),"object"==typeof n[t]&&a<s.length-1&&(n=n[t]),a===s.length-1&&(n[t]=i)}return i}const Lu={battleCategory:"meta.hint.profile.category.battle",technologyCategory:"meta.hint.profile.category.technology",army:"meta.ui.menu.nation.%id%",level:"meta.ui.level_common.label",type:"meta.ui.commander.type.%id%",levels:["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],commander:"commander.%id%.name",armyCategory:"meta.ui.profile.preferences.army",levelCategory:"meta.ui.profile.preferences.level",typeCategory:"meta.ui.profile.preferences.type",commanderCategory:"meta.ui.profile.preferences.commander"},Ru={idle:3,active:1,completed:2};let Ou=(()=>{class t{constructor(){if(this.cachedData={},this.profileAvatar={},this.onAvatarChange=new o.o,this.openTimeout="",this.nations=[],this.fetch=Gc.Fetch,t.instance)return t.instance;(new al).data.subscribe(t=>this.L=t),t.instance=this,this.nations=Object.values(tu).filter(t=>"all"!==t)}init(t,e,i,n,s){this.gameSparks=e,this.cache=t,this.tasksService=s,this.cache.getAuthService().onMessage.subscribe(t=>{}),this.setUserAvatar(this.cache.getUser())}fetchProfile(t){let e=this.fetch(pl.PlayerGetProfile.patch({player:t}));return e.subscribe(e=>{this.cache.devMode&&console.log("    profile cached",e.scriptData),this.cachedData[t]=e.scriptData}),e}getPlayerProfile(t){return this.fetchProfile(t)}getPlayerProfileData(t){return this.cachedData[t]||null}getSummary(t){return this.cachedData[t]?this.cachedData[t].summary:null}getProfileOpen(t){return this.cachedData[t]&&this.cachedData[t].open?this.cachedData[t].open:null}handleFloatValues(t,e){for(let i in t)"number"==typeof t[i]&&(e&&e.indexOf(i)>=0&&(t[i]*=100),t[i]=Math.floor(t[i]));return t}getPlayerPreferences(t,e){let i={},n=this.cachedData[t];if(n&&n.preference&&n.preference.battle&&(i.battles=this.filterPreferences(this.processPreference(n.preference.battle,"battle",e),e),i.battles.tooltip=this.getPreferenceLocalization("battleCategory",null),e&&e.sorting===Zl.Default))for(let s=0;s<i.battles.length;s++)if("commander"===i.battles[s].id){let t={},e=i.battles[s].data;e.map(t=>{t.army=this.cache.getCommander(t.id).army});for(let i of this.nations)t[i]=[],t[i]=e.filter(t=>t.army==i);i.battles[s].commandersFiltered=t}return n&&n.preference&&n.preference.technology&&(i.technologies=this.filterPreferences(this.processPreference(n.preference.technology,"technology"),e),i.technologies.tooltip=this.getPreferenceLocalization("technologyCategory")),i}filterPreferences(t,e){return t.map(t=>(t.data=t.data.filter(t=>this.filterPreferenceSelection(t,e)).sort((t,i)=>this.filterPreferenceSorting(t,i,e)),t))}filterPreferenceSelection(t,e){return e.selection!==Xl.NotEmpty||!this.isPreferenceEmpty(t)}isPreferenceEmpty(t){return!(t.data.length&&t.data[0]>0)}filterPreferenceSorting(t,e,i){let n=t=>t.data[0]/Math.max(t.max[0],1);return i.sorting===Zl.Decreasing?n(t)>n(e)?-1:n(t)<n(e)?1:0:0}processPreference(t,e,i){let n=[],s={};for(let a in t){let r={id:a,data:[],label:this.getPreferenceLocalization(a+"Category",null,i)};for(let n=0;n<t[a].length;n++){let o=t[a][n],c={id:o.id,data:[],max:[],raw:[o],labels:[this.getPreferenceLocalization(a,o.id,i)],tooltips:[]};for(let t in o)"number"==typeof o[t]&&(s[e+"."+a+"."+t]||(s[e+"."+a+"."+t]=0),s[e+"."+a+"."+t]=Math.max(o[t],s[e+"."+a+"."+t]));r.data.push(c)}for(let i=0;i<t[a].length;i++){let t=r.data[i];switch(e){case"battle":t.data[0]=t.raw[0].count;break;case"technology":t.data[0]=Math.floor(t.raw[0].count/t.raw[0].total*100),t.max[0]=100,t.relative=!0,t.tooltips[0]=this.L("meta.hint.profile.preferences.tech_progress",{current:t.raw[0].count,total:t.raw[0].total})}delete t.raw}let o=0;for(let e=0;e<t[a].length;e++)o+=r.data[e].data[0];if("battle"===e)for(let e=0;e<t[a].length;e++)r.data[e].max[0]=o;n.push(r)}return n}getPreferenceLocalization(t,e,i){let n,s="",a=null;return"level"===t&&(a={level:Lu.levels[e-1]}),s+=this.L(Lu[t].replace(/\%id\%/gim,e),a),"commander"===t&&i&&i.sorting===Zl.Decreasing&&(n=this.cache.getCommander(e),s+=`&nbsp;&nbsp;&nbsp;&nbsp;[${this.L("meta.ui.menu.nation."+n.army)}]`),s}getCommanders(t,e){let i=[],n=this.cachedData[t].stats.commander;if(n&&n.length)for(let s=0;s<n.length;s++){let t=JSON.parse(JSON.stringify(n[s]));t=this.handleFloatValues(t,["winRate"]);let e=this.cache.getCommander(t.id);t.name=this.L("commander."+t.id+".name"),t.nation=e&&e.army?this.L("meta.ui.menu.nation."+e.army):"",t.desc=this.L("commander."+t.id+".desc"),t.commander=e,i.push(t)}return this.filterCommanders(i,e)}filterCommanders(t,e){return t.filter(t=>!e||e.nation===tu.All||t.commander.army===e.nation).filter(t=>!e||e.type===eu.All||t.commander.type===e.type)}getUnits(t,e){let i=this.cachedData[t],n=[],s=i&&i.stats?i.stats.unit:null;if(s&&s.length)for(let a=0;a<s.length;a++){let t=JSON.parse(JSON.stringify(s[a]));t=this.handleFloatValues(t,["winRate"]);let e=this.cache.getTreeUnit(t.id);if(!e){Object(Pc.a)("Profile broken unit: ",t.id);continue}let i=kl.clone(e,{mode:gl.Exchanger,open:!0,available:!1});i&&(t.nation=this.L("meta.ui.menu.nation."+i.army),t.name=this.L("unit."+t.id+".short"),t.desc=this.L("unit."+t.id+".desc"),t.unit=i),n.push(t)}return this.filterUnits(n,e)}filterUnits(t,e){return t.filter(t=>!!t.unit).filter(t=>!e||e.nation===tu.All||!t.unit||t.unit.army===e.nation).filter(t=>!e||e.type===iu.All||!t.unit||t.unit.type===e.type).filter(t=>!e||e.level<0||!t.unit||t.unit.level===e.level)}getAchievements(t,e){let i=this.cachedData[t],n=[];i||console.error("Profile requested before fetch");let s=i&&i.achievement?i.achievement.list:null;if(s&&s.length)for(let a=0;a<s.length;a++){let t=this.tasksService.getTask(null,s[a].taskTemplate);t&&n.push(t),t.achievementData=s[a],t.title=this.L("meta.task."+s[a].taskTemplate+".short"),t.desc=this.L("meta.task."+s[a].taskTemplate+".desc",{target:t.complete_condition&&t.complete_condition[0]?parseInt(t.complete_condition[0].value).cat():""}),t.progress=t.task&&s[a].counter?{current:s[a].counter.value,target:s[a].counter.max}:null,t.progressValue=t.progress?t.progress.current/t.progress.target:0,t.status="complete"===s[a].state?su.Completed:"active"===s[a].state?su.InProgress:su.IDLE}return this.filterAchievements(n,e)}filterAchievements(t,e){return t.filter(t=>!e||e.status===su.All||t.status===e.status).sort((t,e)=>Ru[t.status]-Ru[e.status])}isFreemiumAchievementOpen(t){return this.cache.isPremium()||t.freemium}getGlobalRating(t,e,i){return this.fetch({around:pl.LeaderBoardGetAroundMe,top:pl.LeaderBoardGetTop,friends:pl.LeaderBoardGetFriends}[e.mode].patch({leaderboard:i}))}setUserAvatar(t){t.wreath&&(this.profileAvatar.wreath=t.wreath),t.portrait&&(this.profileAvatar.portrait=t.portrait),this.onAvatarChange.next(this.profileAvatar),this.onAvatarChange.next(null)}selectPortrait(t){let e=this.fetch(pl.InventorySelect.patch({portrait:t}),null,!0);return e.subscribe(e=>{this.profileAvatar.portrait=t,this.onAvatarChange.next(this.profileAvatar),this.onAvatarChange.next(null)}),e}selectWreath(t){let e=this.fetch(pl.InventorySelect.patch({wreath:t}),null,!0);return e.subscribe(e=>{this.profileAvatar.wreath=t,this.onAvatarChange.next(this.profileAvatar),this.onAvatarChange.next(null)}),e}getUserAvatar(){return this.profileAvatar}setTimeoutTick(t){if(!t)return"";let e=new Date,i=new Date(t);if(e.isLess(i)){let n=e.diff(i);this.openTimeout=(new Date).getDifferenceString(n,"%d %h:%m:%s",!0,this.L,!0),setTimeout(()=>{this.setTimeoutTick(t)},1e3)}else this.openTimeout="";return this.openTimeout}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})();var Tu=function(t){return t.PVP="pvp",t.Classic="classic",t.Duel="duel",t}({});d.b(t=>{try{return h.b().getClient(),t.tags&&t.tags.report_type&&(console.log(t),t.extra.attachments&&t.extra.attachments.length&&(nd.instance.sendAttachmentToEvent(t.event_id,t.extra.attachments),delete t.extra.attachments)),t}catch(e){console.error(e)}}),window,JSON;const xu=JSON.stringify,Bu=dr.a,ju="METAGAME_ACCOUNT",Mu="METAGAME_GDPR",Qu="METAGAME_COMMANDERS_TEMPLATES",Au="METAGAME_UNIT_TEMPLATES",Du="METAGAME_MAPS",Eu="METAGAME_CAMPAIGN_TEMPLATES",Nu="METAGAME_ARMY",Fu="METAGAME_CURRENT_COMMANDER",Pu="METAGAME_CURRENT_SLOT",Uu="METAGAME_CACHE_VERSION",zu="METAGAME_DIFFICULTY",Ju="METAGAME_PLAY_MODE",qu="METAGAME_INVENTORY",Vu="METAGAME_VIEW_MODE",$u="METAGAME_FUTURE_REDIRECT",Gu=1e3,Hu=[Mu],Yu={premium:!0,gold:!0},Wu="-> Commanders",Ku="-> Units tree get",Xu="-> Units tree amount",Zu="-> Campaigns",td="-> Sessions",ed="-> Single Session";function id(t){let e=performance.now();return function(i){let n=performance.now();Object(Pc.a)("<- "+t.appendSpaces(20)+" taken in "+(n-e).toFixed(3)+" ms."+(i?" (from cache)":""))}}let nd=(()=>{class t{constructor(e,i,n,s){if(this.unitSize=new yl(190,100),this.missionSize=new yl(150,150),this.arrowSize=4.5,this.currencyRate={silver:80,expo:25},this.purchaseUnitAmount=100,this.onResize=new o.o,this.resolveTimeout=100,this._cacheVersion=dr.a,this._commandersVersion="",this._unitsVersion="",this._localizationVersion="",this._informationVersion="",this._mapsVersion="",this._gdpr=null,this._gdprText=null,this._gdprVersion="",this.showSystemInfo=!0,this.devMode=Object(o.X)(),this.isMatching=!1,this.isTraining=!1,this.isLoaded=!1,this.viewMode="live",this._oldViewMode=localStorage.getItem(Vu),this.metagameMatching=!1,this._alreadyStartedMatch="",this._onlineStatus=du.Online,this._account=null,this._userName="",this._userId="",this._userGold=0,this._userSilver=0,this._userFreeXp=0,this._userOptions={},this._army=ql.Rus,this._commandersTemplates=[],this._commandersTemplatesKeys={},this._commanders=[],this._commandersComputed=[],this._commandersAllList=[],this._commandersAllListKeys=[],this._missionCommanders={},this._botCommandersKeys={},this.onCommanderAdded=new ke(null),this._unitsTemplates=[],this._unitsTemplatesKeys={},this._unitsTreeGet=[],this._unitsTreeAmount={},this._unitsTreeComputed=[],this._unitsTreeComputedKeys={},this._campaignUnitsTreeGet={},this._campaignUnitsTreeAmount={},this._campaignUnitsTreeComputed=[],this._campaignUnitsTreeComputedKeys={},this._unitsTree=[],this._unitsTreeKeys={},this._unitsTreePositions=[],this._campaignUnitsTree=[],this._campaignUnitsTreeKeys={},this._campaignUnitsTreePositions=[],this._showBarrack=!1,this._barrack=[],this._barrackKeys={},this.tempBarrack=[],this._selectedCommanders={},this._commanderId="",this._missionId="",this._slotId="",this._slotAmountCache={},this._slotAmountCacheTimeout=null,this._slotAmountCacheTime=3e3,this._maps=[],this._campaignTemplates=[],this._campaigns=[],this._leaderOverridedCampaigns=[],this.campaignChange=new ke(null),this.onCampaignStart=new ke(null),this.ownerChange=new ke(null),this._playDifficulty=2,this._difficultiesString=["novice","easy","normal","hard","nightmare"],this._playMode="ai",this._loadedSessions=[],this._cachedSessions=[],this._localSessions=[],this._friendsAndChatCachedMessages=[],this._lastLogItems={},this._userTeam=null,this._userTeamId=null,this._isTeamOwner=!1,this._isReadyForTeamFight=!1,this._progressTimers={},this._progressValues={},this._progressSubjects={},this._tasksService=new Tl,this._lobbyService=new Bl,this._storeItems=[],this._inventory=null,this.onlineStatus=new ke(du.Online),this.playerLevel=new Nc(0),this.premium=new ke(null),this.premiumExpired=new ke(null),this.league=new ke(null),this.userGold=new Nc,this.userSilver=new Nc,this.userFreeXp=new Nc,this.userOptions=new Nc(null),this.team=new ke(null),this.teamOwner=new ke(!1),this.teamChange=new ke(null),this.readyForTeamFight=new ke(!1),this.playNavigationVisibility=new ke(!0),this.army=new ke(""),this.commandersTemplates=new ke([]),this.commanders=new ke([]),this.commandersAllList=new ke([]),this.unitsTemplates=new ke([]),this.unitsTree=new ke(null),this.maps=new ke([]),this.commanderId=new ke(""),this.missionId=new Nc,this.slotId=new ke(""),this.slot=new ke(null),this.slotPatch=new ke(null),this.showBarrack=new ke(this._showBarrack),this.playDifficulty=new ke(this._playDifficulty),this.playMode=new ke(this._playMode),this.authorized=new Nc,this.authError=new Nc,this.completed=new Nc,this.error=new Nc,this.clearing=new Nc,this.loading=new Nc,this.loadingKeys=["login","localization","information","commandersTemplates","commanders","unitsTemplates","unitsTreeGet","unitsTreeAmount","maps","campaigns"],this.localizator=new al,this.informator=new dl,this.unitToOpenInTree=new ke(null),this.unitToPurchaseInBarrack=new ke(null),this.unitToPurchaseInSlot=new ke(null),this.bugReportModal=new ke(null),this.transactionCompleteModal=new ke(null),this.dlcModal=new ke(null),this.goldExhanger=new ke(null),this.silverExhanger=new ke(null),this.expoExhanger=new ke(null),this.isCommandersCollapsed=!1,this.counterChange=new ke(null),this.globalEvent=new uu,this._storeBuyRequests={},this.onShopTransactionComplete=new ke(null),this._transactionsQueue=[],this._confirm={},this.confirm=new ke(null),this._invitation={},this.invitation=new ke(null),this.onMoneyBoxOpen=new ke(null),this.matchmakingEvent=new ke(null),this._globalCampaign=null,this.globalCampaign=new ke(null),this.fetch=Gc.Fetch,this.onAndreyTextMessageReceived=new ke(null),t.instance)return t.instance;Object(Pc.a)("INIT :: CacheService"),this.alertBackgroundMusicForState(cd.Meta),this._router=e,this._notificatorService=i,this._visitService=n,this._defaultArmy=ql.Rus,this._profileService=s,this.calculateUnitSize(),this.calculateMissionSize(),setTimeout(()=>{this.calculateUnitSize(),this.calculateMissionSize()},1e3),setTimeout(()=>{this.calculateUnitSize(),this.calculateMissionSize()},3e3),setTimeout(()=>{this.calculateUnitSize(),this.calculateMissionSize()},5e3),window.addEventListener("resize",()=>{this.calculateUnitSize(),this.calculateMissionSize(),setTimeout(()=>{this.onResize.emit()})}),window.addEventListener("hashchange",()=>{setTimeout(()=>{this.checkReset()})}),window.onPushState(()=>{setTimeout(()=>{this.checkReset()})}),window.addEventListener("keydown",t=>{116===t.keyCode&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),this.showBugReportModal())}),window.modCommanderGet=this.modCommanderGet.bind(this),window.modCampaignsGet=this.modCampaignsGet.bind(this),window.modCampaignsGetEnd=this.modCampaignsGetEnd.bind(this),window.modMissionsGet=this.modMissionsGet.bind(this),window.modMissionsGetEnd=this.modMissionsGetEnd.bind(this),window.modLocalizationGet=this.modLocalizationGet.bind(this),window.replayGet=this.replayGet.bind(this),window.replayDataGet=this.replayDataGet.bind(this),window.replayGetEnd=this.replayGetEnd.bind(this),window.backendRequest=this.backendRequest.bind(this),window.loadGameStart=this.loadGameStart.bind(this),window.buttonsGet=this.buttonsGet.bind(this),window.onTextSubst=this.matchMakingHintsGet.bind(this),window.printCache=()=>{["_gdpr","_gdprText","_playDifficulty","_playMode","_commanderId","_missionId","_slotId","_slot","_account","_userName","_userGold","_userSilver","_userFreeXp","_inventory","_army","_armiesForTree","_armiesForPlay","_armiesForMissions","_armiesForCampaigns","_commandersTemplates","_commandersTemplatesKeys","_commanders","_commandersComputed","_commandersAllList","_commandersAllListKeys","_botCommandersKeys","_unitsTemplates","_unitsTemplatesKeys","_unitsTreeGet","_unitsTreeAmount","_unitsTreeComputed","_unitsTreeComputedKeys","_unitsTree","_unitsTreeKeys","_unitsTreePositions","_unitsTreeSizeX","_unitsTreeSizeY","_campaignUnitsTreeGet","_campaignUnitsTreeAmount","_campaignUnitsTreeComputed","_campaignUnitsTreeComputedKeys","_campaignUnitsTree","_campaignUnitsTreeKeys","_campaignUnitsTreePositions","_selectedCommanders","_maps","_campaignTemplates","_campaigns","_leaderOverridedCampaigns","_transactionsQueue","_cachedSessions"].map(t=>{console.groupCollapsed(t),console.log(this[t]),console.groupEnd()}),console.groupCollapsed("Localization"),console.log(al.modsLocalization),console.log(al.languages),console.log(al.flatLanguages),console.groupEnd(),console.groupCollapsed("Information"),console.log(dl.information),console.log(this.informator.getBudget()),console.groupEnd(),console.groupCollapsed("Matchmaking hints");let t=this.informator.getMatchmakingHints(["pvp"],9999);for(let e=0;e<t.length;e++){let i=t[e],n=this.L("meta.hint.loading."+i.id);console.log(i.id.appendSpaces(5)+" | "+n.length+" "+(n.length>380?" | +"+Math.abs(380-n.length):""))}console.groupEnd(),console.groupCollapsed("Lobby"),console.log(this._lobbyService.lobbyGetId(),this._lobbyService.lobbyGetData()),console.groupEnd(),console.groupCollapsed("Tasks"),this._tasksService.log(),console.groupEnd()},t.authenticationService=new Gc,t.authenticationService.onError.subscribe(t=>{this.error.next(t)}),t.gameSparks=t.authenticationService.getGameSparks(),t.instance=this,t.authenticationService.onGDPRFound.subscribe(e=>{this._gdpr=e;let i=this._getGDPR().object,n=localStorage.getItem(Mu);if(n&&n===i.version)Object(Pc.a)("GDPR :: is valid"),t.authenticationService.authenticate();else{Object(Pc.a)(`GDPR :: is oudated (${n} < ${i.version})`);let e={shortCode:i.download};t.authenticationService.getGameSparks().sendWithData(".GetDownloadableRequest",e,t=>{Object(Pc.a)("GDPR Error :: ",t.error),this._notificatorService.push({response:t.error,decline:{key:"button_exit",callback:()=>{this.alert("exit"),Object(Pc.a)("GDPR Error :: Closing game...")}}})})}}),this.globalEvent.subscribe(e=>{let i=this._getGDPR();"gdpr_accept"===e.key&&(localStorage.setItem(Mu,i.version),t.authenticationService.authenticate(i.version,i.locale,!1,e.data.stats_open)),"gdpr_decline"===e.key&&(this.isLoaded?console.warn("GDPR modal closed"):(this.alert("exit"),console.warn("Trigger exit because user do not accept GDPR"))),"delete_account"===e.key&&t.authenticationService.authenticate(null,null,!0),"exit_game"===e.key&&this.alert("exit")}),t.authenticationService.onMessage.subscribe(t=>{if(t&&".AuthenticationResponse"===t["@class"]&&!t.error&&setTimeout(()=>{this.checkUpdates()}),t&&".AuthenticationResponse"===t["@class"]&&t.error){this.globalEvent.trigger("gdpr_close");let e=Object.keys(t.error)[0],i=t.error[e];this._notificatorService.push({textError:"meta.ui.error."+i.dcode,textErrorParameters:{deleteAt:new Date(i.value.deleteAt).toLocaleDateString()},exit:!0})}if(t&&".GetDownloadableResponse"===t["@class"]&&t.text&&(this._gdprText=t,this.globalEvent.trigger("gdpr_open")),t&&t.extCode&&t.extCode.match(/(onTeamChange|onTeamInvite|onTeamJoin|onTeamLeave|onPlayerRelationChange|onChat)/gim)&&(this.isMatching&&t.data&&t.data.lobby?this.devMode&&console.log("skipped cache message",t):this._friendsAndChatCachedMessages.push(t),"onTeamChange"!==t.extCode||this.isMatching||(this.setUserTeam(t.data),this.teamChange.next(t),this.teamChange.next(null))),t.extCode&&t.extCode===Wl.OnMatchOpened&&!this.metagameMatching){this.isMatching=!0,Object(Pc.a)("onMessage (redirect to match (via session)) ",t),e.url.match(/lobby/)?this.setFutureRedirect("/multiplayer/lobby"):this.setFutureRedirect(e.url);let i=e.createUrlTree(["match","resume",t.data.match],{queryParamsHandling:"merge"});e.navigateByUrl(i)}if(t.extCode&&t.extCode===Wl.TeamMatchStarted){this.isMatching=!0,Object(Pc.a)("onMessage (redirect to match (team match)) "),this.setFutureRedirect(e.url);let t=e.createUrlTree(["match","team"],{queryParamsHandling:"merge"});e.navigateByUrl(t)}if(t.data&&t.data.match&&t.playerId===this.getUserId()&&!this.isMatching){this.isMatching=!0,Object(Pc.a)("[event + redirect to match (broken match)]",t.data.match),this.setFutureRedirect(e.url);let i=e.createUrlTree(["match","resume",t.data.match],{queryParamsHandling:"merge"});e.navigateByUrl(i)}if(t.extCode&&"onShopTransactionComplete"===t.extCode){let e=t.data.update;if(e.gold&&this.setUserGold(e.gold),e.silver&&this.setUserSilver(e.silver),e.premium){let t="number"==typeof e.premium.expiresAt?e.premium.expiresAt:new Date(e.premium.expiresAt.$date).getTime();this.setPremium({active:!0,expiresAt:t})}if(e.unit){let t=[];for(let i in e.unit){let n=e.unit[i];this._unitsTreeAmount[i]||(this._unitsTreeAmount[i]={total:0,paid:0,used:0});let s=n-this._unitsTreeAmount[i].total;this._unitsTreeAmount[i].total+=s,this._unitsTreeAmount[i].paid+=s,t.push(i)}this.computeUnitsTree(t)}this.globalEvent.trigger("store.purchase_complete",{units:e.unit?Object.keys(e.unit).map(t=>({id:t,amount:e.unit[t]})):[],premium:e.premium?this.getPremium():null}),this._transactionsQueue.push(t),this.onShopTransactionComplete.next(t),this.onShopTransactionComplete.next(null),this.alertSound("money"),Object(Pc.a)("<- store buy success",e),setTimeout(()=>{this.stopLoadingProgress("store.buy.item")},500)}if(t.extCode&&"onLeagueChanged"===t.extCode&&t.data){if(this.isMatching)return;Object(Pc.a)("[\u2713] league changed => ",t.data.id),this.setUserLeague(t.data)}if(".UploadCompleteMessage"===t["@class"]&&this.alertWithParts("backendNotify",xu(t),"UploadCompleteMessage"),t.extCode&&["onSignal","onGameliftLatencyRequest","onMatchSelectLocalHost"].indexOf(t.extCode)>=0&&this.alertWithParts("backendNotify",xu(t),t.extCode),t.extCode&&"onCampaignChanged"===t.extCode){let e=t.data.changes;this.updateCampaignMoves(t.data.id,e.commander?e:{commander:e}),this.globalEvent.trigger("conquest_campaign_change",t.data)}t.extCode&&"onCampaignStart"===t.extCode&&(this.isTeamOwner()||(this.invalidateCampaignUnits(t.data&&t.data.template),this.fetchOwnerReplaceableData(()=>{this.onCampaignStart.next(t.data),this.onCampaignStart.next(null)}))),t.extCode&&"onCommanderAdded"===t.extCode&&this.injectCommanders([t.data.commander])}),this.localizator.init(),this.informator.init(),this.localizator.data.subscribe(t=>this.L=t),this.informator.data.subscribe(t=>{this.I=t,this.alertInputFilter()}),window.playerOptionsSet=(function(t){t?this.playerOptionsSet(t):console.warn("No options passed in playerOptionsSet()")}).bind(this),window.gdprShowPolicy=(function(){let e=this._getGDPR().object;localStorage.getItem(Mu),Object(Pc.a)("GDPR :: triggered by gdprShowPolicy()");let i={shortCode:e.download};t.authenticationService.getGameSparks().sendWithData(".GetDownloadableRequest",i,t=>{Object(Pc.a)("GDPR Error :: ",t.error),this._notificatorService.push({response:t.error,decline:{key:"button_exit",callback:()=>{this.alert("exit"),Object(Pc.a)("GDPR Error :: Closing game...")}}})})}).bind(this);let a=localStorage.getItem(Uu);(!a||a<dr.a||"2"===a)&&(Object(Pc.a)(`Clearing cache because of invalid version... [${a} => ${dr.a}]`),this.clear(),localStorage.setItem(Uu,dr.a.toString())),this.premium.subscribe(t=>{t&&!t.active&&(this.computeCommanders(),this.premiumExpired.next(t),this.premiumExpired.next(null))}),this.globalEvent.subscribe(t=>{t&&"team_owner_update"===t.key&&(this._account.scriptData.teamOwner=t.data.owner,(this.getUserId()!==this.getTeamLeader()||"onTeamChangeLeader"==t.data.case&&this.getUserId()==this.getTeamLeader())&&(console.warn(`fetching owner data [${t.data.owner}]`),this.fetchOwnerReplaceableData()))})}_getGDPR(){let t=this.localizator.getLocale().substr(0,2),e=this._gdpr.gdpr[t];return e||(Object(Pc.a)(`GDPR Error :: not found for [${t}]. Setting default`),e=this._gdpr.gdpr.default,t="default"),{version:e.version,locale:t,object:e}}calculateUnitSize(){let t=getComputedStyle(document.documentElement),e=t.getPropertyValue("--unit-width"),i=t.getPropertyValue("--unit-height"),n=t.getPropertyValue("--unit-name-height"),s=parseFloat(t.getPropertyValue("--unit-arrow-size"));this.arrowSize=s,this.unitSize=new yl(parseInt(e),parseInt(i)+parseInt(n))}calculateMissionSize(){let t=getComputedStyle(document.documentElement),e=t.getPropertyValue("--mission-side"),i=t.getPropertyValue("--mission-side");this.missionSize=new yl(parseInt(e),parseInt(i))}reset(){this.clear(),setTimeout(()=>{this.clearing.next(!0)},1)}getAuthService(){return t.authenticationService}auth(e){this.viewMode=e.preview?"preview":"live",this.viewMode!==this._oldViewMode&&(Object(Pc.a)(`Cache view mode: changed from [${this._oldViewMode}] to [${this.viewMode}]. Clearing...`),this.clear()),Object(Pc.a)("INIT :: LoginRequest");let i=t.authenticationService.login(e);return i.subscribe(t=>{if(t.error)return Object(Pc.a)("[x] Auth Error",t.error),void this.authError.next(t.error);this._account=t;let e=this.getUser();this._userName=t.displayName,this._userId=t.userId,this._userGold=e.gold,this._userSilver=e.silver,this._userFreeXp=e.freeXp,this._userTeamId=e.team||null,this._onlineStatus=e.onlineMode,this._userOptions=e.options,this.alert("player_options:"+JSON.stringify(this._userOptions)),this.alertUser(),Object(Pc.a)("[\u2713] Login success "),Object(Pc.a)(`Account: freeXp -> ${e.freeXp}, gold -> ${e.gold}, silver -> ${e.silver}`),this.releaseLoading("login"),this.authorized.next(t),this.devMode&&console.log(t)}),i}constructAPIUrl(t){return`https://${t.callback}.execute-api.${t.region}.amazonaws.com/${this.viewMode}/callback/autotest/${t.secret}?player=${this.getUserId()}`}getAPIUrl(){const t=new URLSearchParams(location.href).get("key");let e=[{user:"pcekvt2lmg",callback:"ey9dt15zs3",region:"us-east-2",secret:"0eeSwuAX22ICkY17euYCiUafVylbArim"},{user:"17knjy8qkb",callback:"7wbg37j27l",region:"eu-central-1",secret:"sMeIxkbej6xI5JCyfAJNvcScVtlSRzFk"},{user:"dh8mdsdz12",callback:"kq1p026fhj",region:"us-east-1",secret:"4sZ563ZDgMMg7UL8vQKhJgyAOMxkX1WB"}],i=e[1];for(const n of e)if(t==n.user){i=n;break}return this.constructAPIUrl(i)}checkReset(){let t=this._router.parseUrl(this._router.url);return!!t.queryParams.reset&&(delete t.queryParams.reset,this._router.navigateByUrl(t),this.clear(),setTimeout(()=>{this.clearing.next(!0)},1),!0)}init(){this.checkReset()||(this.grab(),this.setMode(this._playMode),this.setDifficulty(this._playDifficulty),this.onlineStatus.next(this._onlineStatus),this.team.next(this._userTeam),this.teamOwner.next(this._isTeamOwner),this.army.next(this._army),this.commanderId.next(this._commanderId),this.slotId.next(this._slotId),this.commandersTemplates.next(this._commandersTemplates),this.commanders.next(this._commandersComputed),this.commanders.next(null),this.unitsTemplates.next(this._unitsTemplates),this.unitsTree.next({campaign:"",tree:this._unitsTree}),this.maps.next(this._maps))}clear(){Object.keys(localStorage).map(t=>{Hu.indexOf(t)<0&&localStorage.removeItem(t)}),Object(Pc.a)("[c] CACHE:clear done"),this.localizator.clear(),this.informator.clear()}grab(){this._army=localStorage.getItem(Nu)?localStorage.getItem(Nu):this._defaultArmy,localStorage.getItem(Fu)&&(this._selectedCommanders=JSON.parse(localStorage.getItem(Fu))),localStorage.getItem(Du)&&(this._maps=JSON.parse(localStorage.getItem(Du))),this._commanderId=this._selectedCommanders[this._army],this._slotId=localStorage.getItem(Pu)?localStorage.getItem(Pu):"a1",localStorage.getItem(zu)&&(this._playDifficulty=parseInt(localStorage.getItem(zu)||"2")),localStorage.getItem(Ju)&&(this._playMode=localStorage.getItem(Ju))}save(){localStorage.setItem(Uu,Bu.toString());let t=JSON.parse(JSON.stringify(this._account));["counter","flags","freeXp","gold","premium","silver","inventory","connection","auth","player"].map(e=>delete t.scriptData[e]),localStorage.setItem(ju,JSON.stringify(t)),localStorage.setItem(Qu,JSON.stringify(this._commandersTemplates)),this._unitsTemplates.length&&localStorage.setItem(Au,JSON.stringify(this._unitsTemplates)),localStorage.setItem(Fu,JSON.stringify(this._selectedCommanders)),localStorage.setItem(Nu,this._army||""),localStorage.setItem(Pu,this._slotId||""),localStorage.setItem(Du,JSON.stringify(this._maps.filter(t=>!t.mod))),localStorage.setItem(Eu,JSON.stringify(this._campaignTemplates)),localStorage.setItem(Vu,this.viewMode),this._inventory&&localStorage.setItem(qu,JSON.stringify(this._inventory))}checkUpdates(){let e=this._account.scriptData,i=JSON.parse(localStorage.getItem(ju)||'{\n\t"scriptData": {\n\t\t"commanderTemplateVersion": 0,\n\t\t"commanderVersion": {},\n\t\t"unitListVersion": 0\n\t}\n}').scriptData,n=this._account.scriptData.infoVersion;this.checkLocalization(this._account.scriptData.localizationVersion).then(()=>{this.checkInformation(n).then(()=>{this.checkCommandersTemplates(e.commanderTemplateVersion,i.commanderTemplateVersion).then(()=>{this.checkCommanders(e.commanderVersion,i.commanderVersion).then(()=>{this.checkUnitsTemplates(e.unitListVersion,i.unitListVersion).then(()=>{this.checkUnitsTreeGetAll().then(()=>{this.computeUnitsTree(),this.checkMaps(e.mapVersion,i.mapVersion).then(()=>{this.checkCampaigns(e.mapVersion,i.mapVersion).then(()=>{this._tasksService.init(t.instance,t.gameSparks,e,i).then(()=>{this.checkInventory(e.inventoryVersion,i.inventoryVersion).then(()=>{this.OnCompleted(),this._profileService.init(t.instance,t.gameSparks,e,i,this._tasksService),this._lobbyService.init(t.instance,t.gameSparks,e,i)})})})})})})})})})})}OnCompleted(){this.modCommanderRequest(),this.modCampaignsRequest(),this.modMissionsRequest(),this.modLocalizationRequest(),this.buttonsRequest(),this.localSessionsGet(),this.setUserLevel(this.getUser().level),(this.allow("play.pvp.menu")||this.allow("play.pve.menu")||this.allow("play.mission.menu")||this.allow("play.campaign.menu"))&&this.setCounter("ui.allow.play.menu",1,!0),this.isMatching||(this.setArmy(this._army),this._commanderId&&this.setCommander(this._commanderId)),setTimeout(()=>{this.completed.next(null)},100),setTimeout(()=>{this.userGold.next(this._userGold),this.userSilver.next(this._userSilver),this.userFreeXp.next(this._userFreeXp)},1e3),this.isLoaded=!0}checkLocalization(t){let e=id("localization");return new Promise((i,n)=>{this.localizator.checkChanges(t).subscribe(t=>{this.releaseLoading("localization",t.cache),e(),this.resolveTimeout?setTimeout(()=>{i(null)},this.resolveTimeout):i(null)})})}checkInformation(t){let e=id("information");return new Promise((i,n)=>{this.informator.checkChanges(t).subscribe(t=>{this.releaseLoading("information",t.cache),e(),this.resolveTimeout?setTimeout(()=>{i(null)},this.resolveTimeout):i(null)})})}checkCommandersTemplates(t,e){let i=id("commandersTemplates"),n=localStorage.getItem(Qu);return new Promise((s,a)=>{n&&t===e?(this._commandersVersion=e,this._commandersTemplates=JSON.parse(n),this.computeCommanderKeys(),this.resolveTimeout?setTimeout(()=>{s(null)},this.resolveTimeout):s(null),this.commandersTemplates.next(this._commandersTemplates),this.releaseLoading("commandersTemplates",!0),i(!0)):(this._commandersVersion=t,this.fetchCommandersTemplates().subscribe(t=>{this._commandersTemplates=t.scriptData.template,this.computeCommanderKeys(),this.resolveTimeout?setTimeout(()=>{s(null)},this.resolveTimeout):s(null),this.commandersTemplates.next(this._commandersTemplates),this.releaseLoading("commandersTemplates"),i()}))})}fetchAndComputeCommanders(){let t=new Nc;return this.fetchCommanders().subscribe(e=>{this._commanders=e.scriptData.commander,this.computeCommanders(),t.next(!0)}),t}checkCommanders(t,e){let i=localStorage.getItem("METAGAME_COMMANDERS"),n=id("commanders");Object(Pc.a)("Commanders versions:",t,e);let s=Object.keys(t),a=(()=>{for(let i=0;i<s.length;i++)if(!e[s[i]]||e[s[i]]<t[s[i]])return!0;return!1})();return a&&Object(Pc.a)("[x]> commanders are outdated"),new Promise((t,e)=>{a||!i?this.fetchCommanders().subscribe(e=>{this._commanders=e.scriptData.commander,this.computeCommanders(),this.resolveTimeout?setTimeout(()=>{t(null)},this.resolveTimeout):t(null),this.releaseLoading("commanders"),this._alertCommanders(),n()}):(this._commanders=JSON.parse(i),this.computeCommanders(),this.resolveTimeout?setTimeout(()=>{t(null)},this.resolveTimeout):t(null),this._alertCommanders(),n(!0),this.releaseLoading("commanders",!0))})}checkUnitsTemplates(t,e){let i=id("unitsTemplates"),n=localStorage.getItem(Au);return new Promise((s,a)=>{n&&t===e?(this._unitsVersion=e,this._unitsTemplates=JSON.parse(n),this.computeUnitsTemplatesKeys(),this.resolveTimeout?setTimeout(()=>{s(null)},this.resolveTimeout):s(null),this.unitsTemplates.next(this._unitsTemplates),this.releaseLoading("unitsTemplates",!0),i(!0)):(this._unitsVersion=t,this.fetchUnitsTemplates().subscribe(t=>{this._unitsTemplates=t.scriptData.unit,this.computeUnitsTemplatesKeys(),this.resolveTimeout?setTimeout(()=>{s(null)},this.resolveTimeout):s(null),this.unitsTemplates.next(this._unitsTemplates),this.releaseLoading("unitsTemplates"),i()}))})}checkUnitsTreeGet(t=""){let e=id("unitsTreeGet"+(t?" ("+t+")":""));return new Promise((i,n)=>{this.fetchUnitTreeGet(t).subscribe(n=>{t?this._campaignUnitsTreeGet[t]=n.scriptData.unitTree.unit:this._unitsTreeGet=n.scriptData.unitTree.unit,this.releaseLoading("unitsTreeGet"+(t?" ("+t+")":"")),e(),i(null)})})}checkUnitsTreeGetAll(t=""){let e=id("unitsTreeGetAll"+(t?" ("+t+")":""));return new Promise((i,n)=>{this.fetchUnitTreeGetAll(t).subscribe(n=>{t?(this._campaignUnitsTreeGet[t]=n.scriptData.unitTree.unit,this._campaignUnitsTreeAmount[t]=n.scriptData.unit):(this._unitsTreeGet=n.scriptData.unitTree.unit,this._unitsTreeAmount=n.scriptData.unit),this.releaseLoading("unitsTreeGetAll"+(t?" ("+t+")":"")),e(),i(null)})})}checkUnitsTreeAmount(t=""){let e=id("unitsTreeAmount"+(t?" ("+t+")":""));return new Promise((i,n)=>{this.fetchUnitTreeAmount(t).subscribe(n=>{t?this._campaignUnitsTreeAmount[t]=n.scriptData.unit:this._unitsTreeAmount=n.scriptData.unit,this.releaseLoading("unitsTreeAmount"+(t?" ("+t+")":"")),e(),i(null)})})}checkBarrack(){let t=id("barrack");return new Promise((e,i)=>{this.fetchBarrack().subscribe(i=>{this.releaseLoading("barrack"),t(),e(null)})})}checkStore(){let t=id("store");return new Promise((e,i)=>{this.fetchStoreItems().subscribe(i=>{this._storeItems=i.scriptData&&i.scriptData.item?i.scriptData.item:[],this._storeItems=this._storeItems.sort((t,e)=>t.display_order-e.display_order),this._storeItems.length&&this._storeItems.map(t=>{t.container&&(t.content=this._tasksService.getReward([t.container]));let e=t.price.provided?t.price.provided.currency:t.price.gold?"gold":"silver",i=t.price.provided?t.price.provided.amount:t.price.gold?t.price.gold:t.price.silver||0,n=t.price&&t.price.saleAmount?t.price.saleAmount:i,s=t.price&&t.price.saleExpires?t.price.saleExpires:0;return t._price=t.price,t.price={currency:e,cost:i,sale:n,expiresAt:s},t}),t(),e(null)},t=>{e(null),this._notificatorService.push({response:t})})})}checkMaps(t,e){let i=id("maps"),n=localStorage.getItem(Du);return new Promise((s,a)=>{n&&t===e?(this._mapsVersion=e,this._maps=JSON.parse(n).sort((t,e)=>t._id<e._id?-1:t._id>e._id?1:0),this.releaseLoading("maps",!0),i(!0),this.resolveTimeout?setTimeout(()=>{s(null)},this.resolveTimeout):s(null)):(this._mapsVersion=t,this.fetchMaps().subscribe(t=>{this._maps=t.scriptData.map.sort((t,e)=>t._id<e._id?-1:t._id>e._id?1:0),this.releaseLoading("maps"),i(),this.resolveTimeout?setTimeout(()=>{s(null)},this.resolveTimeout):s(null)}))})}checkCampaigns(t,e){let i=id("campaigns"),n=localStorage.getItem(Eu);return new Promise((s,a)=>{n&&t===e?(this._campaignTemplates=JSON.parse(n),this.releaseLoading("campaigns",!0),this.fetchCampaignsProgress(),i(!0),this.resolveTimeout?setTimeout(()=>{s(null)},this.resolveTimeout):s(null)):this.fetchCampaigns().subscribe(t=>{this._campaignTemplates=t.scriptData.campaign,this.releaseLoading("campaigns"),this.fetchCampaignsProgress(),i(),this.resolveTimeout?setTimeout(()=>{s(null)},this.resolveTimeout):s(null)})})}checkInventory(t,e){let i=id("inventory"),n=localStorage.getItem(qu);return new Promise((s,a)=>{n&&t===e?(this._inventory=JSON.parse(n),this.releaseLoading("inventory",!0),i(!0),this.resolveTimeout?setTimeout(()=>{s(null)},this.resolveTimeout):s(null)):this.fetchInventory().subscribe(t=>{this._inventory=t.scriptData,this.releaseLoading("inventory"),i(),this.resolveTimeout?setTimeout(()=>{s(null)},this.resolveTimeout):s(null)})})}releaseLoading(t,e){let i=this.loadingKeys.indexOf(t);this.loading.next({key:t,index:i,total:this.loadingKeys.length-1,skipped:e})}fetchCommandersTemplates(){return this.fetch(pl.CommanderTemplateList,"<- Commanders templates")}fetchCommanders(){let t=this.getTeamLeader();return this.fetch(pl.CommanderList.patch(t?{owner:t}:null),Wu+(t?" ==> owner:"+t:""))}fetchCommander(t){return this.fetch(pl.CommanderList.patch({option:{slot:!0,slotDetails:!0,rank:!1,perk:!1,template:!0,battleRank:!1,unitLevel:!0,selectCommander:t}}),Wu)}fetchUnitsTemplates(){return this.fetch(pl.UnitTemplateGetAll,"-> Units templates")}fetchUnitTreeGet(t=""){return this.fetch(pl.UnitTreeGet.patch({campaign:t}),Ku)}fetchUnitTreeGetAll(t=""){return this.fetch(pl.UnitTreeGetAll.patch({campaign:t}),Ku)}fetchUnitTreeAmount(t=""){return this.fetch(pl.UnitTreeGetAmount.patch({campaign:t}),Xu)}fetchUnitTreeGetCampaigns(t){let e=this.getTeamLeader();return this.fetch(pl.UnitTreeGet.patch(e?{campaign:t,owner:e}:{campaign:t}),Ku+(e?" ==> owner:"+e:""))}fetchUnitTreeGetAllCampaigns(t){let e=this.getTeamLeader();return this.fetch(pl.UnitTreeGetAll.patch(e?{campaign:t,owner:e}:{campaign:t}),"-> Units tree get all"+(e?" ==> owner:"+e:""))}fetchUnitTreeAmountCampaigns(t){let e=this.getTeamLeader();return this.fetch(pl.UnitTreeGetAmount.patch(e?{campaign:t,owner:e}:{campaign:t}),Xu+(e?" ==> owner:"+e:""))}fetchBarrack(){return this.fetch(pl.SquadList,"-> Barrack")}fetchMaps(){return this.fetch(pl.MapList,"-> Maps")}fetchCampaigns(){return this.fetch(pl.CampaignTemplateList,Zu)}fetchCampaignsProgress(t){let e=this.getTeamLeader(),i={};e&&(i.owner=e),this.fetch(pl.CampaignList.patch(i),Zu+(e?" ==> owner:"+e:"")).subscribe(e=>{console.log("campaigns",e),this._campaigns=e.scriptData&&e.scriptData.campaign?e.scriptData.campaign:[],t?t():(this.ownerChange.next({campaigns:this._campaigns,owner:this.getTeamLeader()}),this.ownerChange.next(null))})}requestCampaignNextTurn(t){return this.fetch(pl.CampaignNextTurn.patch({campaign:t}))}requestCampaignSetMoves(t,e){return this.fetch(pl.CampaignSetMoves.patch({campaign:t,moves:e}))}fetchSessions(){return this.fetch(pl.SessionList.patch({option:{}}),td)}fetchSession(t){return this.fetch(pl.SessionGet.patch({session:t}),ed)}fetchPlayerSessions(t){return this.fetch(pl.SessionGet.patch({player:t}),ed)}fetchSessionFromList(t){return this.fetch(pl.SessionList.patch({option:{session:t}}),td)}fetchPlayerSessionFromList(t){return this.fetch(pl.SessionList.patch({option:{player:t}}),td)}fetchStoreItems(){return this.fetch(pl.ShopItemList,"<- Shop items loaded")}requestSetCounter(t,e){return this.fetch(pl.CounterSet.patch({counter:t,value:e}))}fetchInventory(){return this.fetch(pl.InventoryTemplateList,"<- Inventory items loaded")}setInventory(t,e){let i={};return t&&(i.portrait=t),e&&(i.wreath=e),this.fetch(pl.InventorySelect.patch(i))}fetchOwnerReplaceableCommmanders(t){let e=this._globalCampaign?this._globalCampaign.id:"";this.fetchCommanders().subscribe(i=>{this._commanders=i.scriptData.commander,this.computeCommanders(),t?t():(this.ownerChange.next({campaignId:e,owner:this.getTeamLeader()}),this.ownerChange.next(null))})}fetchOwnerReplaceableData(t){let e=this._globalCampaign?this._globalCampaign.id:"";this.fetchCommanders().subscribe(i=>{this._commanders=i.scriptData.commander,this.computeCommanders(),this.fetchCampaignsProgress(()=>{t?t():(this.ownerChange.next({campaignId:e,owner:this.getTeamLeader()}),this.ownerChange.next(null))})})}computeCommanderKeys(){this._commandersTemplatesKeys={},this._commandersTemplates.map(t=>{this._commandersTemplatesKeys[t._id]=t,t.tags.join().match(/mission/gim)&&(this._missionCommanders[t.tags[0]]||(this._missionCommanders[t.tags[0]]=[]),this._missionCommanders[t.tags[0]].push(t))})}sortCommandersAllList(){this._commandersAllList=this._commandersAllList.sort((t,e)=>t.available&&!e.available?-1:!t.available&&e.available?1:t.type<e.type?-1:t.type>e.type?1:t._id<e._id?-1:t._id>e._id?1:0)}computeCommanders(t){if(t)return this.commanders.next(this._commandersComputed),this.commanders.next(null),void this.commandersAllList.next(this._commandersAllList);this._commandersComputed=[],this._commandersAllList=[],this._commanders.map(t=>{let e=JSON.parse(JSON.stringify(this._commandersTemplatesKeys[t.template]));e&&(e.available=t,this._commandersComputed.push(e))}),this._commandersTemplates.map(t=>{t.bot&&(this._botCommandersKeys[t.bot.id]=t);let e=this._commandersComputed.find(e=>t._id===e._id)||t;this._commandersAllList.push(e),this._commandersAllListKeys[t._id]=e}),this.sortCommandersAllList(),this.commanders.next(this._commandersComputed),this.commanders.next(null),this.commandersAllList.next(this._commandersAllList),Object(Pc.a)("commanders computed")}computeUnitsTemplatesKeys(){this._unitsTemplatesKeys={},this._unitsTemplates.map(t=>{this._unitsTemplatesKeys[t._id]=t})}computeUnitsTreeAvailability(t=""){let e=t?this._campaignUnitsTree[t]||(this._campaignUnitsTree[t]=[]):this._unitsTree,i=t?this._campaignUnitsTreeKeys[t]||(this._campaignUnitsTreeKeys[t]={}):this._unitsTreeKeys;e.map(t=>{t.open?t.available=!1:t.opensBy&&t.opensBy.length&&t.opensBy.some(t=>i[t].open)&&(t.available=!0)}),e.map(e=>e.xpOnParents=this.getTreeUnitParentsExpo(e.id,t))}computeUnitsTree(t,e){let i=e?this._campaignUnitsTreeKeys[e]||(this._campaignUnitsTreeKeys[e]={}):this._unitsTreeKeys;if(t&&t.length){let i=t.map(t=>kl.createUnitByInterface(this._unitsTemplatesKeys[t],null,e));return this.computeUnitsTreeAvailability(e),console.log(t,e),this.unitsTree.next({campaign:e,tree:i,patch:!0}),void this.unitsTree.next(null)}e?(this._campaignUnitsTree[e]=[],this._campaignUnitsTreeComputed[e]=[]):(this._unitsTree=[],this._unitsTreeComputed=[]);let n=e?this._campaignUnitsTree[e]||(this._campaignUnitsTree[e]=[]):this._unitsTree,s=e?this._campaignUnitsTreeKeys[e]||(this._campaignUnitsTreeKeys[e]={}):this._unitsTreeKeys,a=e?this._campaignUnitsTreeComputed[e]||(this._campaignUnitsTreeComputed[e]=[]):this._unitsTreeComputed,r=e?this._campaignUnitsTreeGet[e]||(this._campaignUnitsTreeGet[e]=[]):this._unitsTreeGet,o=e?this._campaignUnitsTreeAmount[e]||(this._campaignUnitsTreeAmount[e]=[]):this._unitsTreeAmount,c=e?this._campaignUnitsTreePositions[e]||(this._campaignUnitsTreePositions[e]=[]):this._unitsTreePositions;this._unitsTemplates.map(t=>{if(e&&(!t.campaign||!t.campaign[e]))return;let l,u=Object.assign({},t),d={};Object.assign(d,r[t._id]),Object.assign(d,o[t._id]),i[t._id]=u,a.push(u),Object.assign(u,d),l=kl.createUnitByInterface(u,e?d:null,e),n.push(l),s[l.id]=l,c[l.position.y]||(c[l.position.y]=[]),c[l.position.y][l.position.x]||(c[l.position.y][l.position.x]=[]),c[l.position.y][l.position.x].push(l)}),this.computeUnitsTreeAvailability(e),this.unitsTree.next({campaign:e,tree:n}),this.unitsTree.next(null)}computeCampaignUnitsTree(){}patchUnit(t,e,i){if(i&&!this._campaignUnitsTree[i])return void console.warn(t+" belongs to another campaign which hasn't been grabbed yet, so update skipped and unit will be received with next launch of campaign");let n=this.getTreeUnit(t,i);if(this.devMode&&n){console.group(`patching unit ${t}${i?" ("+i+")":""}`);for(let t in e)console.log(`old ${t}:`,n[t],`new ${t}: `,e[t]);console.groupEnd()}let s=[];s=i?[this._campaignUnitsTreeComputed[i].find(e=>e._id===t),this._campaignUnitsTree[i].find(e=>e.id===t),this._campaignUnitsTreeKeys[i][t]]:[this._unitsTreeComputed.find(e=>e._id===t),this._unitsTree.find(e=>e.id===t),this._unitsTreeKeys[t]];let a=i?this._campaignUnitsTreeGet[i]||(this._campaignUnitsTreeGet[i]=[]):this._unitsTreeGet,r=i?this._campaignUnitsTreeAmount[i]||(this._campaignUnitsTreeAmount[i]=[]):this._unitsTreeAmount;if(a[t]||(a[t]={}),e.amount)return r[t]||(r[t]={total:0,paid:0,used:0}),r[t].total+=e.amount,void(r[t].paid+=e.amount);s.push(a[t]),s.map(i=>{for(let n in e)"amount"!==n&&(i?i[n]=e[n]:Object(Pc.a)("Error",`unit:${t} cant be patched`))})}requestOpenUnit(t,e){let i=new Nc;Object(Pc.a)("-> opening unit "+t.id+"... ");let n={xp:t.xpOpen,unit:t.id,campaign:e};return this.getTeamLeader()&&(n.owner=this.getTeamLeader()),this.fetch(pl.UnitTreeOpenUnit.patch(n)).subscribe(n=>{Object(Pc.a)("<- unit "+t.id+" opened",n),this.patchUnit(t.id,{open:!0,available:!1},e);let s=[t.id];if(n.scriptData.unit&&n.scriptData.unit.length){let i=[];if(n.scriptData.unit.map(t=>{console.log(t),i.find(e=>e.id===t.id)||i.push({id:t.id}),Object.assign(i.find(e=>e.id===t.id),t)}),i.map(t=>{this.patchUnit(t.id,{xpAvailable:t.xp_available,elite:t.elite},e),s.push(t.id)}),t.opensBy&&t.opensBy.length)for(let n=0;n<t.opensBy.length;n++){s.push(t.opensBy[n]);let i=this.getTreeUnit(t.opensBy[n],e);i.opens&&i.opens.length&&i.opens.map(t=>{s.push(t);let i=this.getTreeUnit(t,e);i.opens&&i.opens.length&&i.opens.map(t=>{s.push(t)})})}}if(s=s.filter(function(t,e){return s.indexOf(t)==e}),this.computeUnitsTree(s,e),this.dismissOpenUnitInTree(),this._userFreeXp-=n.scriptData.xp,this.userFreeXp.next(this._userFreeXp),e){let t=n.scriptData&&n.scriptData.hasOwnProperty("freeXp")?n.scriptData.freeXp:this.getCampaignFreeXp(e),i=n.scriptData&&n.scriptData.hasOwnProperty("silver")?n.scriptData.silver:this.getCampaignSilver(e);this.setCampaignCurrency(e,t,i)}i.next(n)},e=>{this._notificatorService.push({response:e}),Object(Pc.a)("<[x] unit "+t.id+" wasnt opened",e),i.error(e)}),i}requestOpenPremiumUnit(){}requestOpenCommander(t){let e=new Nc,i=this._commandersTemplatesKeys[t];return Object(Pc.a)("-> opening commander "+t+"..."),this.fetch(pl.CommanderCreate.patch({template:t,silver:i.silver_cost||0,gold:i.gold_cost||0})).subscribe(i=>{let n=i.scriptData.id;i.scriptData.silver&&(this._userSilver-=i.scriptData.silver,this.userSilver.next(this._userSilver)),i.scriptData.gold&&(this._userGold-=i.scriptData.gold,this.userGold.next(this._userGold)),this.fetch(pl.CommanderList.patch({option:{slot:!0,slotDetails:!0,rank:!1,perk:!1,template:!0,battleRank:!1,unitLevel:!0,selectCommander:n}})).subscribe(s=>{console.log(s),Object(Pc.a)("<- Commander ["+t+"|"+n+"] opened"),this.injectCommanders(s.scriptData.commander),e.next(i)})},e=>{this._notificatorService.push({response:e}),Object(Pc.a)("<[x] Commander "+t+" wasnt opened",e)}),e}injectCommanders(t,e=!1){console.log("injectCommanders:",e,t);let i={};if(t.map(t=>{const e=this._commandersTemplatesKeys[t.template];e&&(i[e.campaign?e.campaign:""]=!0);let n=this._commanders.findIndex(e=>t.template===e.template);n>=0?this._commanders.splice(n,1,t):this._commanders.push(t)}),this.computeCommanders(),this.sortCommandersAllList(),this.onCommanderAdded.next(t.map(t=>this.getCommander(t.template))),this.onCommanderAdded.next(null),!e){console.log("injectCommanders.fetchingAmount:",i);for(const t in i)t?this.fetchUnitTreeAmountCampaigns(t).subscribe(e=>{this._campaignUnitsTreeAmount[t]=e.scriptData.unit,this.computeUnitsTree(null,t)}):this.fetchUnitTreeAmount(t).subscribe(t=>{this._unitsTreeAmount=t.scriptData.unit,this.computeUnitsTree()})}}requestUnitTreeBuyAmount(t,e,i){let n=new Nc;const s={id:t.id,amount:t.pay||1},a=t.premiumGold?0:t.silverCost*t.pay,r=t.premiumGold?t.premiumGold*t.pay:0,o=e?e.getRemainingCount():0,c=e?Math.floor(e.parent.getRemainingBattleRank()/t.modifyRank):100,l=Math.min(o,c,t.pay);let u=i?this._campaignUnitsTreeAmount[i]||(this._campaignUnitsTreeAmount[i]={total:0,paid:0,used:0}):this._unitsTreeAmount;i?Object(Pc.a)("-> purchasing "+t.id+" unit to campaign: "+i+"..."):Object(Pc.a)("-> purchasing "+t.id+" unit to barack..."),e&&Object(Pc.a)(`for current slot ${e.id}, BR left: ${c}, amount left: ${o}, trying to buy: ${t.pay}`);let d={campaign:i||"",unit:[s],silver:a,gold:r};return this.getTeamLeader()&&(d.owner=this.getTeamLeader()),this.fetch(pl.UnitTreeBuyAmount.patch(d)).subscribe(t=>{Object(Pc.a)("<- "+s.amount+"x "+s.id+" units bought"),t.scriptData.gold&&(this._userGold-=t.scriptData.gold,this.userGold.next(this._userGold)),t.scriptData.silver&&(this._userSilver-=t.scriptData.silver,this.userSilver.next(this._userSilver)),this.getTreeUnit(s.id);let a=[];t.scriptData.unit&&t.scriptData.unit.length&&t.scriptData.unit.map(t=>{u[t.id]||(u[t.id]={total:0,paid:0,used:0}),u[t.id].total+=t.amount,u[t.id].paid+=t.amount,a.push(t.id)}),this.computeUnitsTree(a,i),this.dismissPurchaseUnitsToBarrack(),this.dismissPurchaseUnitsToSlot(),e&&e.setAmount(l),n.next(t.scriptData.unit),this.globalEvent.trigger("troops.unit_purchase",{slotId:e?e.id:"",unitId:s.id,amount:s.amount,gold:t.scriptData.gold||0,silver:t.scriptData.silver||0}),this.alertSound("money")},t=>{this._notificatorService.push({response:t}),Object(Pc.a)("<[x] Error:","units wasnt purchased",t),n.error(t)}),n}requestSquadReset(t){let e=new Nc,i=t.parent.commander.id,n=t.parent.commander.available.id,s=t.unit.id;return console.log(t),this.saveAmount(),Object(Pc.a)("-> resetting "+t.id+" slot..."),this.fetch(pl.SquadReset.patch({slot:t.id,commander:n})).subscribe(n=>{Object(Pc.a)("<- slot "+t.id+" resetted successfully"),delete this._commanders.find(t=>t.template===i).slot.find(e=>e.id===t.id).squad,e.next(n.scriptData),this.globalEvent.trigger("troops.slot_reset",{slotId:t.id,oldUnitId:s,tutorial:!0,template:t.parent.commander._id})},i=>{let n=Yc(i);e.error("meta.ui.error."+n.dcode),Object(Pc.a)("<[x] slot "+t.id+" reset error",i)}),e}requestSquadCreate(t,e,i=""){let n=new Nc,s=t.parent.commander.id,a=t.parent.commander.available.id;return Object(Pc.a)(`-> creading squad in slot ${t.id} with unit ${e.id}, campaign [${i}]...`),this.fetch(pl.SquadCreate.patch({unit:e.id,commander:a,slot:t.id})).subscribe(a=>{Object(Pc.a)(`<- slot ${t.id} created with unit ${e.id}, campaign [${i}]`);let r=this.getCommander(s).available.slot.find(e=>e.id===t.id);r.squad={unit:e.id,amount:a.scriptData.amount,id:a.scriptData.id},this.patchUnit(e.id,{amount:e.amount.count-2},i),console.log(r);let o=this.getCommanderSlot(s,t.id,{open:!0,available:!1,mode:gl.Calculator},i);setTimeout(()=>{this.slotPatch.next(o),this.slotPatch.next(null)},100),n.next(a.scriptData)},e=>{let i=Yc(e);n.error("meta.ui.error."+i.dcode),Object(Pc.a)(`<[x] slot ${t.id} creating error`,e)}),n}pushSlotAmountChangeId(t,e){if(!t)return void console.log("no slot for saving");let i=t.parent.commander.id,n=t.id;this._slotAmountCache[i]||(this._slotAmountCache[i]={}),this._slotAmountCache[i][n]=e,this._slotAmountCacheTimeout&&window.clearTimeout(this._slotAmountCacheTimeout),this._slotAmountCacheTimeout=setTimeout(()=>{this.saveAmount()},this._slotAmountCacheTime)}requestSquadSetAmount(t){let e=new Nc;return Object(Pc.a)("-> saving slots amount..."),this.startLoadingProgress("amount_save"),this.fetch(pl.SquadSetAmount.patch(t)).subscribe(i=>{e.next(i),Object(Pc.a)("<- saving slots amount success",t),setTimeout(()=>{this.stopLoadingProgress("amount_save")},1500)},t=>{this._notificatorService.push({response:t}),Object(Pc.a)("<- saving slots amount error",t),setTimeout(()=>{this.stopLoadingProgress("amount_save")},1500)}),e}requestMapsList(){let t=new Nc;return this.fetch(pl.MapList).subscribe(e=>{t.next(e)}),t}requestStoreBuyItem(t){return Object(Pc.a)("-> buying store items...",t.join(", ")),this.startLoadingProgress("store.buy.item"),this.fetch(pl.ShopTxnInit.patch({language:al.selectedLanguage,item:t.map(t=>({id:t,count:1}))})).subscribe(t=>{Object(Pc.a)("<- buy request success",t),this._storeBuyRequests[t.scriptData.orderId]=!0,t.scriptData.url&&(Object(Pc.a)("opening external website...",t.scriptData.url),this.alert("shell_open_web_browser:"+t.scriptData.url)),this.stopLoadingProgress("store.buy.item")},e=>{t.join().match(/gold/gim)||this._notificatorService.push({response:e}),Object(Pc.a)("<-[x] store buy error",e),this.stopLoadingProgress("store.buy.item")})}requestUpdateCounters(){this.fetch(pl.CounterList).subscribe(t=>{if(t.scriptData&&t.scriptData.counter){this._account.scriptData.counter=t.scriptData.counter;let e=Hc(t.scriptData.counter);for(let t in e)e[t]!==this.getCounter(t)&&this.counterChange.next({path:t,value:e[t]})}})}saveAmount(){for(let t in this._slotAmountCache){let e=this.getCommander(t);if(!e.available)continue;let i={commander:e.available.id,squad:[]},n=this._slotAmountCache[t];for(let s in n){let a=this.getCommanderSlot(t,s),r=this._commanders.find(t=>t.id===e.available.id);a.unit&&(r.slot.find(t=>t.id===s),i.squad.push({slot:a.id,amount:n[s]}))}i.squad.length&&this.requestSquadSetAmount(i)}this._slotAmountCache={},this._slotAmountCacheTimeout&&window.clearTimeout(this._slotAmountCacheTimeout)}LogMessage(t){console.log.apply(null,t)}setArmy(t){this._army=t,console.log("------------------------set army"),this.slotPatch.next(null),this.army.next(this._army),this.commanderId.next(this._commanderId),this.commandersAllList.next(this._commandersAllList),this.slotId.next(this._slotId),this.save()}getCurrentArmy(){return this._army}getArmies(t){return new lu}getSelectedCommanderForArmy(t){return this._selectedCommanders[t]||null}setCommander(t,e=!1){if(this._selectedCommanders[this._army]===t&&!e)return;let i=this.getCommander(t);t.match(/(mission|tutorial)\_/gim)&&i.const||(this._selectedCommanders[this._army]=t,Object(Pc.a)(`Saving ${t} to selected commanders`)),this._commanderId=t,this.commanderId.next(this._commanderId),this.save()}setSlotId(t){this._slotId=t,this.slotId.next(this._slotId),this.save()}setSlot(t){this._slot=t,this.slot.next(this._slot)}setBarrackState(t){this._showBarrack=t,this.showBarrack.next(this._showBarrack)}setSlotAmount(t,e,i,n){let s=i.parent.campaignId,a=s?this._campaignUnitsTreeAmount[s]||(this._campaignUnitsTreeAmount[s]=[]):this._unitsTreeAmount;if(a[t]||(a[t]={total:0,used:0,paid:0}),a[t].used+=e,this.computeUnitsTree([t],s),console.log(n),i){let t=i.parent.commander.id,s=this._commanders.find(e=>e.template===t),a=s&&s.slot.find(t=>t.id===i.id)?s.slot.find(t=>t.id===i.id):null;a&&a.squad&&(a.squad.amount+=e,this._commandersComputed.find(e=>e.id===t).available.slot.find(t=>t.id===i.id).amount=a.squad.amount,this._commandersAllList.find(e=>e.id===t).available.slot.find(t=>t.id===i.id).amount=a.squad.amount,this._commandersAllListKeys[t].available.slot.find(t=>t.id===i.id).amount=a.squad.amount),n||this.pushSlotAmountChangeId(i,i.amount)}}setMode(t){this._playMode=t,localStorage.setItem(Ju,this._playMode.toString()),this.playMode.next(this._playMode)}setDifficulty(t){this._playDifficulty=t,localStorage.setItem(zu,this._playDifficulty.toString()),this.playDifficulty.next(this._playDifficulty)}getDifficultiesString(){return this._difficultiesString}getDifficulty(){return parseInt(localStorage.getItem(zu))}setUserTeam(t){this._userTeamId=t?t.id:null,this._userTeam=t,this._isTeamOwner=this.isTeamOwner(),this._userTeamId&&this._lobbyService.lobbySetId(t.lobby),this.team.next(this._userTeam),this.teamOwner.next(this._isTeamOwner)}setReadyToFight(t){this._isReadyForTeamFight!==t&&(this._isReadyForTeamFight=t,this.readyForTeamFight.next(this._isReadyForTeamFight))}demoModeEnabled(){let t=this.getUser();return!!(t&&t.optionsGlobal&&t.optionsGlobal.demo)}getUser(t=!1){return t?this._account:this._account.scriptData}getUserName(){return this._userName}getUserId(){return this._userId}getUserGold(){return this._userGold}getUserSilver(){return this._userSilver}getTeamLeader(){return this._userTeam?this._userTeam.owner:this._account.scriptData.teamOwner||""}getUserSilverLimit(){let t={target:0,current:0,progress:0,progressRaw:0};return this.isPremium()||(t.current=this.getUserSilver(),t.target=this.getUser().silverLimitWithoutPremium||999999999),t.progressRaw=t.current/t.target,t.progress=Math.clamp(t.progressRaw,0,1),t}getUserFreeXp(){return this._userFreeXp}getUserTeamId(){return this._userTeamId}getUserTeam(){return this._userTeam}getUserTeamSelectedCampaign(){return this._userTeam&&this._userTeam.game&&this._userTeam.game.option&&this._userTeam.game.option.campaign?this._userTeam.game.option.campaign.template:null}getUserTeamSelectedMission(){return this._userTeam&&this._userTeam.game?this._userTeam.game.option.map:null}getUserTeamSelectedNode(){return this._userTeam&&this._userTeam.game&&this._userTeam.game.option&&this._userTeam.game.option.campaign?this._userTeam.game.option.campaign.node:null}isReadyToFight(){return this._isReadyForTeamFight}getUnitTemplates(){return this._unitsTemplates}getUserLevel(){return this.getUser().level||0}setUserLevel(t){this.getUser().level=t,this.playerLevel.next(t)}getUserLeague(){return this.getUser().league?this.getUser().league.id:null}setUserLeague(t){for(let e in t)this.getUser().league||(this.getUser().league={}),this.getUser().league[e]=t[e];this.league.next(this.getUser().league||null),this.league.next(null)}getUserInventory(){return this._inventory}getProfileInventory(){return this._account.scriptData.inventory}updateCounters(){this.requestUpdateCounters()}isPremium(){return this.getUser().premium&&!0===this.getUser().premium.active}getPremiumCountDown(){return this.isPremium()?Math.max(0,this.getUser().premium.expiresAt-(new Date).getTime()):0}getPremiumEndDate(){return this.isPremium()?new Date(this.getUser().premium.expiresAt):new Date}setPremium(t){this._account.scriptData.premium=t,this.premium.next(t)}getPremium(){return this.getUser().premium}setUserGold(t=0){t!==this._userGold&&(this._userGold=t,this.userGold.next(this._userGold))}setUserSilver(t=0){t!==this._userSilver&&(this._userSilver=t,this.userSilver.next(this._userSilver))}setUserFreeXp(t=0){t!==this._userFreeXp&&(this._userFreeXp=t,this.userFreeXp.next(this._userFreeXp))}getCounter(t){var e;let i=this.getUser().counter,n=null===(e=this.getUser().optionsGlobal)||void 0===e?void 0:e.uiAllowOverride;if(!i)return 0;let s=null;return s=Iu(n,t.replace(/ui\.allow\./gim,""))?Iu(n,t.replace(/ui\.allow\./gim,"")):Iu(i,t),s?"object"==typeof s||"string"==typeof s?s:parseInt(s):0}getCounters(){return Hc(this._account?this.getUser().counter:null)||{}}getCounterData(t){return Iu(this.getUser().counter,t)}hasCounter(t){var e;let i=this.getUser().counter,n=null===(e=this.getUser().optionsGlobal)||void 0===e?void 0:e.uiAllowOverride;return!!i&&(""!==Iu(n,t.replace(/ui\.allow\./gim,""))?!!Iu(n,t.replace(/ui\.allow\./gim,"")):!!Iu(i,t))}allow(t){return!(!this.hasFlag("all_content_open")||"tutorial"===t)||this.hasCounter("ui.allow."+t)}setCounter(t,e,i){let n=this.getUser().counter;if(i)return Object(Pc.a)(`-> [LOCAL] setting counter ${t} to ${e}`),Cu(n,t,e),void this.counterChange.next({path:t,value:e});n&&this.getCounter(t)!==e&&(Object(Pc.a)(`-> setting counter ${t} to ${e}`),this.requestSetCounter(t,parseInt(e.toString())).subscribe(i=>{Cu(n,t,e),this.counterChange.next({path:t,value:parseInt(e.toString())}),Object(Pc.a)("<- success")},t=>{Object(Pc.a)("<- error",t)}))}hasFlag(t){return!!(this._account&&this._account.scriptData&&this._account.scriptData.flags)&&!!this._account.scriptData.flags.find(e=>e===t)}isUnitAvailableInProgress(t){return this.hasFlag("features_in_progress")&&(t.inProgress||t.in_progress)}isCommanderAvailableInProgress(t){return!t.in_progress||this.hasFlag("features_in_progress")&&t.in_progress}getBarrack(t,e,i){let n,s=[],a=e||this._slot,r=i?this._campaignUnitsTreeAmount[i]||(this._campaignUnitsTreeAmount[i]={total:0,used:0,paid:0}):this._unitsTreeAmount;if(!a)return this.tempBarrack=s,s;let o=i?this._campaignUnitsTree[i]:this._unitsTree;n=t&&t.length?t.map(t=>this.getTreeUnit(t,i)):o.filter(t=>t.army===a.parent.commander.army&&t.level<=a.level);let c=[],l=[],u=[];n.filter(t=>this.hasFlag("features_in_progress")?this.hasFlag("features_in_progress"):t&&!1===t.inProgress).filter(t=>this.isUnitAttachableToSlot(t,a)).sort((t,e)=>t.battleRank-e.battleRank).map(t=>{if(!t)return;let e=r[t.id]||{total:0,used:0,paid:0};e.commander=e.total-e.paid,e.available=e.total-e.used,e.amount=a.amount;let i=kl.getModifyBattleRank(t,a.parent.commander.extra);(!t.open&&e.available<=0?u:t.premium?l:c).push(kl.clone(t,{available:!1,mode:gl.Barrack,disabled:!a.parent.commander.available||!t.open,barrack:e,modifyRank:i.br,battleRankModificator:i.modificator}))}),c=c.sort((t,e)=>t.level-e.level),l=l.sort((t,e)=>t.level-e.level),u=u.sort((t,e)=>t.level-e.level);let d=c.concat(l).concat(u);return this.tempBarrack=d,d}getBarrackUnit(t,e,i=""){return this.getBarrack([t],e,i)[0]}getTreeAmount(t,e=""){return this._unitsTreeAmount[t]||{total:0,used:0,paid:0}}getCommanders(t){let e=this.getMission(t.mission),i=e?e.commander_tag||e.commanderTag:"pvp",n=this._commandersAllList;return n=n.filter(t=>!t.bot),n=n.filter(t=>!t.in_progress||t.in_progress&&this.hasFlag("features_in_progress")),n=n.filter(t.tag?e=>e.tags&&e.tags.indexOf(t.tag)>-1:t.campaign?e=>e.campaign===t.campaign&&!e.const&&e.available:t=>t.tags&&t.tags.indexOf(i)>-1&&(t.available||t.const)),n.map(t=>{t.freemiumOpen=this.isFreemiumCommanderOpen(t)}),n.options=t,n}checkCommanderAvailability(t){return t.containsForbiddenUnits=this.isCommanderContainsForbiddenUnits(t),t.freemiumOpen=this.isFreemiumCommanderOpen(t),t}getCommander(t){return this._commandersAllListKeys[t]}getBotCommandersByLevels(){let t=[[],[],[],[],[],[]],e=this._commandersAllList.filter(t=>t.bot);for(let i=0;i<e.length;i++){let n=e[i];n.bot?t[n.bot.level-1].push(n):console.warn("no bot commander! ",n)}return t}grabCommander(t){this.fetchCommander(t).subscribe(t=>{this.injectCommanders(t.scriptData.commander)})}getBotCommanders(){let t={rus:!1,ger:!1,usa:!1,jap:!1,eng:!1},e=this._commandersAllList.filter(t=>t.bot&&this.isCommanderAvailableInProgress(t)).slice();return e.map(e=>{t[e.army]=!0}),{states:t,commanders:e.sort((t,e)=>t.bot.order-e.bot.order)}}getBotCommander(t){return this._botCommandersKeys[t]||null}getCommanderFromBotCommander(t){let e=this._botCommandersKeys[t];return e?this.getCommander(e.bot.icon):null}getCommanderEchelons(t,e,i){let n=this.getCommander(t),s=[];if(!n)return s;let a=[];a=n.available?n.available.slot:n.slot;for(let r=0;r<a.length;r++){let t=a[r];if(!t.hidden){s[t.echelon-1]||(s[t.echelon-1]=new rd(t.echelon-1,i),s[t.echelon-1].commander=n,s[t.echelon-1].limit=n.echelon_battle_rank[t.echelon-1]);let a=s[t.echelon-1],r=this.getCommanderSlot(n.id,t.id,e,i);r.parent=a,a.addSlot(r)}}for(let r=0;r<s.length;r++)s[r].sort();return s}getCommanderTemplate(t){return this._commandersTemplatesKeys[t]}getCommanderSlot(t,e,i,n){let s=this.getCommander(t),a=!!s.available,r={},o={};s.available?(o=s.available.slot.find(t=>t.id===e),a=!0):(o=s.slot.find(t=>t.id===e),s.slot.map(t=>{r[t.id]=t.squad||t.unit}));let c=function(t){return a?t.squad:r[t.id]}(o),l=null,u=c?s.const?this._unitsTreeKeys[c.unit]:this.getTreeUnit(c.unit,n):null;if(c&&u){l=kl.clone(u);let t=kl.getModifyBattleRank(l,s.extra);if(l.modifyRank=t.br,l.battleRankModificator=t.modificator,l.amount.count=c.amount,o.amount_unit&&o.amount_unit[l.id]&&(l.amount.limit=o.amount_unit[l.id]),l.open=!0,l.available=!1,i)for(let e in i)l[e]=i[e];l.mode=gl.Calculator,a||(l.mode=gl.Echelon,s.const||(l.disabled=!0))}return new ad({unit:l,id:o.id,squadId:c?c.id:null,amount:c&&c.amount||0,skill:c&&c.skill||0,xp:c&&c.xp||0,battleRank:c&&c.battleRank||0,level:o.level||0,echelon:o.echelon||0,subtype:o.subtype.filter(t=>!!t.length),amountUnit:o.amount_unit||o.amountUnit||{}})}getCommanderSlotsLevels(t){let e={min:1,max:1},i="string"==typeof t?this.getCommander(t):t;return i&&i.available?i.available.slot.map(t=>{if(!t.hidden){let i=t.squad?this.getTreeUnit(t.squad.unit).level:1;e.min=Math.min(i,e.min),e.max=Math.max(i,e.max)}}):i&&i.const&&i.slot.map(t=>{if(t&&!t.hidden){let i=t.unit?this.getTreeUnit(t.unit).level:1;e.min=Math.min(i,e.min),e.max=Math.max(i,e.max)}}),e}getCommanderProgress(t){let e={currentXp:0,targetXp:0,currentLevel:0,commanderLevel:0,nextLevel:0,unitLevel:0,reached:!1},i=this._account.scriptData.progression,n=this.getCommander(t);if(i&&n){let t=this.getCommanderSlotsLevels(n).max,s=n&&n.available&&n.available.progression?n.available.progression.level:i.levelStart,a=Math.max(i.levelStart,t),r=a+1,o=Math.min(i.levelByXp.length-1,Math.max(s-i.levelStart,0));e.commanderLevel=s,e.currentXp=n.available&&n.available.progression?n.available.progression.counterXp:0,e.targetXp=i.levelByXp[o],e.currentLevel=a,e.nextLevel=r,e.unitLevel=t,e.reached=o>=i.levelByXp.length-1}return e}isCommanderFilled(t){if(!t||t.const)return!0;let e=this.getCommanderEchelons(t.id);for(let i=0;i<e.length;i++)if(!e[i].isComplete())return!1;return!0}isCommanderActive(t){return t&&t._id===this._commanderId}isCommanderIdValid(t){return!!this._commandersTemplatesKeys[t]}isCommanderBot(t){return!!t.bot}isCommanderAvailableToBuy(t){let e=this.getCommander(t);return e.gold_cost?e.gold_cost<=this.getUserGold():e.silver_cost<=this.getUserSilver()}isUnitAttachableToSlot(t,e){return!(!(t&&e&&e.amountUnit&&e.amountUnit[t.id]>0)&&(!e.subtype||t&&-1===e.subtype.indexOf(t.subtype)||t&&e.level<t.level))}isTeamOwner(){return!!this._userTeam&&this._userTeam.owner===this._userId}getActiveCommanderId(){return this._selectedCommanders[this._army]}getCommanderId(){return this._commanderId}getActiveCommanderAvailableId(){let t=this.getActiveCommanderId(),e=this.getCommander(t);return e.available?e.available.id:""}getTreeUnits(t=""){let e=new yl,i=[],n=((t?this._campaignUnitsTree[t]:this._unitsTree)||[]).slice().filter(t=>(t.hidden&&i.push(t.id),t.inProgress?this.isUnitAvailableInProgress(t):!t.hidden)).filter(i=>(t&&(i=this.getTreeUnit(i.id,t)),!!(t&&i.campaign&&i.campaign[t]||i.army===this._army)&&(e.x=Math.max(e.x,i.position.x),e.y=Math.max(e.y,i.position.y),!0))).sort((t,e)=>t.premium&&!e.premium?1:!t.premium&&e.premium?-1:0);return n.size=e,n}getUnits(t){return this._unitsTree.filter(e=>!t||t.nation===tu.All||!e||e.army===t.nation).filter(e=>!t||t.type===iu.All||!e||e.type===t.type).filter(e=>!t||t.subtype===nu.All||!e||e.subtype===t.subtype).filter(e=>!t||t.level<0||!e||e.level===t.level).filter(e=>!(t&&(!t.inProgress||!0!==t.inProgress)&&e)||e.inProgress===t.inProgress)}invalidateAllCampaignUnits(){console.log("invalidate campaign units cache"),this._campaignUnitsTreeGet={},this._campaignUnitsTreeAmount={}}invalidateCampaignUnits(t){t&&(console.log("invalidate campaign units cache for campaign:",t),this._campaignUnitsTreeGet[t]=null,this._campaignUnitsTreeAmount[t]=null)}getCampaignUnits(t,e){return new Promise((e,i)=>{this._campaignUnitsTreeGet[t]&&this._campaignUnitsTreeAmount[t]?(console.log("get campaign units from cache",t),e(this.getTreeUnits(t))):(console.log("fetching campaign units",t),this.fetchUnitTreeGetAllCampaigns(t).subscribe(i=>{this._campaignUnitsTreeGet[t]=i.scriptData.unitTree.unit,this._campaignUnitsTreeAmount[t]=i.scriptData.unit,this.computeUnitsTree(null,t),e(this.getTreeUnits(t))}))})}getCampaignUnitsPreview(t=""){let e=this.getTreeUnits(t),i=this.getCampaignFreeXp(t),n=[];if(e&&e.length)for(let s of e)if(s.available){let e,a=s.opensBy,r=s,o=s.xpOpen,c={},l=this.getParentsExpoLack(s,t);for(let n=0;n<a.length;n++){let s=this.getTreeUnit(a[n],t);if(s.open){if((s.premium||s.collectible)&&s.xpAvailable>r.xpOpen){e=s;break}if(!s.premium&&!s.collectible&&s.xpAvailable+i>r.xpOpen){e=s;break}}}0==l&&e&&(c.opensBy=e,c.child=r,c.xpNeeded=o,n.push(c))}return n}getTreeUnit(t,e=""){return e&&this._campaignUnitsTreeKeys[e]?this._campaignUnitsTreeKeys[e][t]:this._unitsTreeKeys[t]}getTreeUnitParentsExpo(t,e=""){let i=0,n=this.getTreeUnit(t,e);return n&&n.opensBy&&n.opensBy.length&&(i+=(t=>{let i=0;if(!t||!t.length)return i;for(let n of t){let t=this.getTreeUnit(n,e);t&&t.open&&(i+=t.xpAvailable||0)}return i})(n.opensBy)),i}getTreeUnitByPosition(t){return this._unitsTreePositions[t.y]&&this._unitsTreePositions[t.y][t.x]&&this._unitsTreePositions[t.y][t.x].find(t=>"rus"===t.army)||null}getActiveSlot(){return this._slot}getTreeUnitParents(t,e=""){return t&&t.opensBy?t.opensBy.map(t=>this.getTreeUnit(t,e)):[]}canUseFreeXp(t,e=""){let i=this.getTreeUnitParents(t,e);for(let n of i)if(!n.premium&&!n.collectible&&n.open)return!0;return!1}isUnitHaveEnouthExpoOnParent(t,e=""){return this.getParentsExpoLack(t,e)<=0}isUnitParentOpen(t,e=""){let i=this.getTreeUnitParents(t,e);for(let n=0;n<i.length;n++)if(i[n].open)return!0;return!1}isFreemiumCommanderOpen(t){return"string"==typeof t&&(t=this.getCommander(t)),!!t.const||t.freemium||!1}isCommanderContainsForbiddenUnits(t){return!1}isFreemiumUnitOpen(t){return"string"==typeof t&&(t=this.getTreeUnit(t)),this.isPremium()||t.freemium}getParentsExpoLack(t,e=""){let i=this.getTreeUnitParentsExpo(t.id,e),n=this.canUseFreeXp(t,e)?e?this.getCampaignFreeXp(e):this.getUserFreeXp():0;return Math.max(t.xpOpen-i-n,0)}isUnitAvailableToOpen(t,e,i){return this.getParentsExpoLack(t,e)<=0}isUnitUnlimited(t,e){return!(!t||!e)&&e.unlimited&&!t.collectible&&!t.premium}getMissions(t){if(t){let e=this._campaignTemplates.find(e=>e._id===t);return e?Object.keys(e.node).map(t=>{let i=e.node[t],n=this._maps.find(t=>t._id===i.map[0]),s=hu.createMissionByInterface(n);return s.task=this._tasksService.getTaskForMission(s.id),s}):[]}return this._maps.filter(t=>hu.hasTag(t,"mission")).map(t=>{let e=hu.createMissionByInterface(t);return e.task=this._tasksService.getTaskForMission(e._id),e})}getMission(t){let e=this._maps.find(e=>e._id===t);return e?(e=hu.createMissionByInterface(e),e.task=this._tasksService.getTaskForMission(e._id),e):null}getTrainingMissions(){return this._maps.filter(t=>hu.hasTag(t,"tutorial")&&hu.hasTag(t,this._army)).map(t=>hu.createMissionByInterface(t))}getLobbyMaps(t){let e={modes:[],submodes:[],maps:[]};return e.maps=this._maps.filter(i=>{let n=!t||i.mode&&i.mode.length&&i.mode.indexOf(t)>=0;return n&&(i.mode&&i.mode.map(t=>{e.modes.indexOf(t)<0&&e.modes.push(t)}),i.submode&&"dc_mission"!=i.submode&&i.submode.map(t=>{e.submodes.indexOf(t)<0&&e.submodes.push(t)})),n}),e.maps=e.maps.filter(t=>t.submode&&"dc_mission"!=t.submode),e}getCampaigns(){return this._campaignTemplates.filter(t=>!t.in_progress||this.hasFlag("features_in_progress")).map(t=>{let e=this._campaigns.find(e=>e.template===t._id),i=this._tasksService.getTasksForCampaign(t._id);return bu(t,e,i)}).filter(t=>this.isDlcCampaignPresent(t))}setGlobalCampaign(t){this._globalCampaign=t&&t.length?this.getCampaign(t):null,this.globalCampaign.next(this._globalCampaign),this.globalCampaign.next(null)}getGlobalCampaign(){return this._globalCampaign}getCampaignsDefault(){return this.getCampaigns().filter(t=>!t.modId)}getCampaignsMod(){let t=this.getCampaigns().filter(t=>t.modId),e=[];for(let i=0;i<t.length;i++)e.find(e=>e.modId===t[i].modId)||e.push({modId:t[i].modId,campaigns:[]}),e.find(e=>e.modId===t[i].modId).campaigns.push(t[i]);return e}getCampaignTree(t){var e,i,n,s,a,r,o,c,l,u,d,h;let b=[],m=this.getCampaign(t),p=new yl(1,1);if(m&&m.nodes)for(let g=0;g<m.nodes.length;g++){let t=JSON.parse(JSON.stringify(m.nodes[g]));if(t&&m.progress&&m.progress.node){if(t.position=new yl(t.tree_x,t.tree_y),t.opens=t.open_up,t.opensBy=t.opened_by,"conquest"===m.category){let e=m.progress&&m.progress.phase&&"map"+(m.progress.phase.match(/attack|defence/)?"_"+m.progress.phase:""),i=m.nodes.find(e=>e._id==t._id);t.id=m.progress.node[t._id]&&m.progress.node[t._id][e]?m.progress.node[t._id][e]:i&&i.map_groups&&i.map_groups[0]?i.map_groups[0].defence[0]:""}else t.id=m.progress.node[t._id]&&m.progress.node[t._id].map?m.progress.node[t._id].map:"";t.open="conquest"===m.category?null===(e=m.progress.node[t._id])||void 0===e?void 0:e.open:(null===(i=m.progress.node[t._id])||void 0===i?void 0:i.open)||t.open||!1,t.completed=(null===(n=m.progress.node[t._id])||void 0===n?void 0:n.completed)||t.completed||!1,t.hidden=(null===(s=m.progress.node[t._id])||void 0===s?void 0:s.hidden)||t.hidden||!1,t.final=(null===(a=m.progress.node[t._id])||void 0===a?void 0:a.final)||t.final||!1,t.bonus=(null===(r=m.progress.node[t._id])||void 0===r?void 0:r.bonus)||t.bonus||!1,t.owner=(null===(o=m.progress.node[t._id])||void 0===o?void 0:o.owner)||t.owner||"",t.level=(null===(c=m.progress.node[t._id])||void 0===c?void 0:c.level)||1,t.icon=m.progress&&m.progress.node&&t._id&&m.progress.node[t._id]&&m.progress.node[t._id].map?null===(l=this._maps.find(e=>e._id===m.progress.node[t._id].map))||void 0===l?void 0:l.icon:"",t.map=(null===(u=m.progress.node[t._id])||void 0===u?void 0:u.map)||"",t.map_attack=(null===(d=m.progress.node[t._id])||void 0===d?void 0:d.map_attack)||"",t.map_deffence=(null===(h=m.progress.node[t._id])||void 0===h?void 0:h.map_deffence)||"",t.position.x>p.x&&(p.x=t.position.x),t.position.y>p.y&&(p.y=t.position.y),delete t.open_up,delete t.opened_by,delete t.tree_x,delete t.tree_y,b.push(t)}}return b.size=p,b}getCampaignCurrency(t){let e=this._campaigns.find(e=>e.template===t);return{silver:e&&e.money?e.money.silver:0,freeXp:e&&e.money?e.money.freeXp:0}}getCampaign(t){let e=this._campaignTemplates.find(e=>e._id===t),i=this._campaigns.find(e=>e.template===t),n=this._tasksService.getTasksForCampaign(t),s=this._leaderOverridedCampaigns.find(e=>e.template===t);return s&&(i=s,console.warn("leader overrided campaign progerss")),e?bu(e,i,n):null}campaignNextTurn(t){return this.requestCampaignNextTurn(t)}setCampaignMoves(t,e){return this.requestCampaignSetMoves(t,e)}getCampaignSilver(t){let e=this.getCampaignCurrency(t);return e&&e.silver?e.silver:0}getCampaignFreeXp(t){let e=this.getCampaignCurrency(t);return e&&e.freeXp?e.freeXp:0}setCampaignCurrency(t,e,i){let n=this._campaigns.find(e=>e.node&&e.template===t);n&&(null!==i&&(i=parseInt(i.toString()),n.money.silver=i,console.log("silver set",i,n.money.silver)),null!==e&&(e=parseInt(e.toString()),n.money.freeXp=e,console.log("xp set",e))),this.campaignChange.next(n),this.campaignChange.next(null)}_injectOrReplaceCampaign(t){if(console.log(t),!t)return;let e=this._campaigns.findIndex(e=>e.node&&t.node&&e.template===t.template);e>=0?this._campaigns.splice(e,1,t):this._campaigns.push(t),this.campaignChange.next(t),this.campaignChange.next(null)}_injectOrReplaceCampaignTemplate(t){if(!t)return;let e=this._campaignTemplates.findIndex(e=>e._id===t._id);e>=0?this._campaignTemplates.splice(e,1,t):this._campaignTemplates.push(t)}_injectOrReplaceMissionTemplate(t){if(!t)return;let e=this._maps.findIndex(e=>e._id===t._id);e>=0?this._maps.splice(e,1,t):this._maps.push(t)}fetchCampaign(t){this.fetch(pl.CampaignList.patch({option:{template:t}})).subscribe(t=>{t&&t.scriptData&&t.scriptData.campaign&&t.scriptData.campaign[0]&&this._injectOrReplaceCampaign(t.scriptData.campaign[0])})}campaignStart(t,e){let i=new Nc,n=null;return this.invalidateCampaignUnits(t),this.fetch(pl.CampaignStart.patch({campaign:t,restart:e})).subscribe(e=>{this._tasksService.grab().then(()=>{this.getCampaignUnits(t).then(s=>{this._commanders=this._commanders.filter(e=>this.getCommanderTemplate(e.template).campaign!==t),console.log("campaignStart:",e);let a=e.scriptData&&e.scriptData.commander?e.scriptData.commander:null;a&&a.length>0&&this.injectCommanders(a,!0),console.log(a),n=e.scriptData&&e.scriptData.campaign?e.scriptData.campaign:null,this._injectOrReplaceCampaign(n),this.onCampaignStart.next(n),this.onCampaignStart.next(null),i.next(n),this.setCampaignCurrency(t,n.money.freeXp,n.money.silver),this.setDifficulty(2)})})},t=>{this._notificatorService.push({response:t}),Object(Pc.a)("<-[x] campaign start error",t)}),i}isDlcCampaignPresent(t){return!(!this.hasFlag("all_content_open")&&t.tags.indexOf("check_campaign")>=0&&!(this._account.scriptData.inventory&&this._account.scriptData.inventory.campaign&&this._account.scriptData.inventory.campaign.indexOf(t.id)>=0))}updateCampaignMoves(t,e){console.log("updateCampaignMoves >> ",t,e);let i=this._campaigns.find(e=>e.id===t);if(!i)return void console.warn("no campaign found");let n=JSON.parse(JSON.stringify(this.getCampaign(i.template)));for(let s in e)n.progress[s]=e[s];this._injectOrReplaceCampaign(n.progress)}openUnitInTree(t,e){this.unitToOpenInTree.next({unit:this.getTreeUnit(t,e),campaign:e})}dismissOpenUnitInTree(){this.unitToOpenInTree.next(null)}openUnit(t,e=""){return this.requestOpenUnit(t,e)}openPremiumUnit(t){}openCommander(t){return this.requestOpenCommander(t)}purchaseUnitsToBarrack(t,e=""){this.unitToPurchaseInBarrack.next({unit:this.getTreeUnit(t,e),campaign:e})}dismissPurchaseUnitsToBarrack(){this.unitToPurchaseInBarrack.next(null)}purchaseUnitsToSlot(t,e=""){this.unitToPurchaseInSlot.next({slot:t,campaign:e})}dismissPurchaseUnitsToSlot(){this.unitToPurchaseInSlot.next(null)}buyUnit(t,e,i){return this.requestUnitTreeBuyAmount(t,e,i)}isUnitFitSlot(t,e){let i="";if(e&&e.id)if(t.unit&&t.unit.modifyRank<=t.parent.getRemainingBattleRank(t.id)||!t.unit&&e.modifyRank<=t.parent.getRemainingBattleRank())if(this.isUnitUnlimited(e,t.parent.commander)||e.barrack.available>0||e.silverCost&&e.silverCost<=this.getUserSilver())if(t.parent.isCommanderAvailableToCreateSquad(t.id)){if(this.isUnitUnlimited(e,t.parent.commander)||e.barrack.available>0)return{success:!0,error:i};i="recruit.message_no_units"}else i="error.bad_cache";else i="error.silver_not_enough";else i="error.echelon_overflow";else i="error.bad_cache";return{success:!1,error:"meta.ui."+i}}slotCreate(t,e,i){let n=new Nc,s=this.isUnitFitSlot(t,e);return s.success?this.requestSquadCreate(t,e,i).subscribe(s=>{this.computeUnitsTree([e.id],i),n.next(s),this.globalEvent.trigger("troops.slot_create",{tutorial:!0,role:"hint",slotId:t.id,unitId:e.id,template:t.parent.commander._id,campaignId:i})},t=>{n.error(t)}):n.error(s.error),n}slotReset(t){return this.requestSquadReset(t)}slotSet(t,e,i){let n=new Nc;if(t.unit&&t.unit.id===e.id)return n;let s=this.isUnitFitSlot(t,e);if(s.success||"meta.ui.error.slot_occupied"===s.error){let s=t.unit.id||"";t.reset(!0),this.slotCreate(t,e,i).subscribe(i=>{n.next(i),this.globalEvent.trigger("troops.slot_replace",{slotId:t.id,unitId:e.id,oldUnitId:s,template:t.parent.commander._id})},t=>{this._notificatorService.push({response:t})})}else n.error(s.error);return n}showPlayNavigation(){this.playNavigationVisibility.next(!0)}hidePlayNavigation(){this.playNavigationVisibility.next(!1)}setOnlineStatus(t){this._onlineStatus=t,this.onlineStatus.next(this._onlineStatus)}enableOnlineStatus(){this.setOnlineStatus(du.Online)}enableOfflineStatus(){this.setOnlineStatus(du.Offline)}enableDoNotDisturbStatus(){this.setOnlineStatus(du.DoNotDisturb)}getSessions(){let t=new Nc;return this.fetchSessions().subscribe(e=>{console.log(e),this._loadedSessions=e.scriptData.session,this._cachedSessions=this._loadedSessions.concat(this._localSessions),t.next(e.scriptData.session)},e=>{t.error(e)}),t}getSessionsLocal(){return this._localSessions}addSessionLocal(t){t?this._localSessions.push(t):console.warn("Empty local session passed")}removeSessionLocal(t){let e=this._localSessions.find(e=>e._id===t),i=this._localSessions.indexOf(e);i>=0&&this._localSessions.splice(i,1)}getCachedSessions(){return this._cachedSessions}getSession(t){for(let e=0;e<this._cachedSessions.length;e++)if(t===this._cachedSessions[e]._id)return this._cachedSessions[e];return null}setSessionVisibility(t,e){return this.fetch(pl.SessionSet.patch({session:t,option:{public:e}}))}getLastSession(){return this._cachedSessions[0]}getSessionDetail(t){let e=new Nc,i=this._cachedSessions.find(e=>e._id===t);return!i||i&&!i.local?this.fetchSession(t).subscribe(t=>{console.log(t),e.next(t.scriptData.session)},t=>{e.error(t)}):(this._localLoadingSubject=e,this.alert("replay_data_get:"+t),this.devMode&&setTimeout(()=>{this.replayDataGet({})},500)),e}searchSession(t){return this.fetchSession(t)}searchPlayerSessions(t){return this.fetchSession(t)}searchSessionFromList(t){return this.fetchSessionFromList(t)}searchPlayerSessionFromList(t){return this.fetchPlayerSessionFromList(t)}replayGet(t){this.devMode&&(t=[{_id:"af2c7fcf-2400-4d38-98c1-d53797a068d0",closeTime:1643704492997,duration:2020,game:{map:"multi/groundcontrol/arena_death_valley:groundcontrol",mode:"groundcontrol",mapId:"death_valley",submode:"groundcontrol",type:"pvp"},public:!1,playerTeam:{team:"a",count:7,playerCount:1},opponentTeam:{team:"b",count:8,playerCount:0}}]),console.log("local sesstion received:",t),t.map(t=>{t.local=!0,this._localSessions.push(t)})}replayGetEnd(){}alertWithParts(t,e,i){let n=Math.ceil(e.length/Gu);for(let s=0;s<n;s++)this.alert(s<n-1?t+":part "+(i.length?i+" ":"")+e.slice(s*Gu,(s+1)*Gu):t+":"+(i.length?i+" ":"")+e.slice(s*Gu),!1)}backendRequest(e,i,n){t.gameSparks.sendWithData(e,n,t=>{t.error?Object(Pc.a)("backendRequest fail:",t.error):this.alertWithParts("backendAnswer",JSON.stringify(t),i)})}loadGameStart(){this.globalEvent.trigger("load_game"),this.devMode&&Object(Pc.a)("Game loading started")}localSessionsGet(){this.alert("replay_get"),this.devMode&&setTimeout(()=>{this.replayGet([])},100)}replayDataGet(t){this._localLoadingSubject.next(t),this._localLoadingSubject=null}openGoldExchanger(){this.goldExhanger.next(!0)}dismissGoldExchanger(){this.goldExhanger.next(!1)}openSilverExchanger(){this.silverExhanger.next(!0)}dismissSilverExchanger(){this.silverExhanger.next(!1)}openExpoExchanger(){this.expoExhanger.next(!0)}dismissExpoExchanger(){this.expoExhanger.next(!1)}exchangeGold(){}exchangeSilver(t){let e=new Nc;return Object(Pc.a)("-> exchanging gold to silver..."),this.fetch(pl.ShopExchangeGold.patch({gold:t})).subscribe(t=>{this._userGold-=t.scriptData.gold,this._userSilver+=t.scriptData.silver,this.userGold.next(this._userGold),this.userSilver.next(this._userSilver),this.dismissSilverExchanger(),e.next(t),this.globalEvent.trigger("store.gold_exchange",{gold:t.scriptData.gold,silver:t.scriptData.silver}),Object(Pc.a)(`<- ${t.scriptData.gold} gold exchanged to ${t.scriptData.silver} silver`),this.alertSound("money")},t=>{this.dismissSilverExchanger(),e.error(t),this._notificatorService.push({response:t}),Object(Pc.a)("<[x] exchanging error",t)}),e}exchangeExpo(t,e){let i=new Nc;return Object(Pc.a)("-> exchanging units expo to gold..."),this.fetch(pl.ShopConvertXp.patch({unit:t,gold:e})).subscribe(t=>{if(this._userGold=t.scriptData.gold,this._userFreeXp=t.scriptData.xp,this.userGold.next(this._userGold),this.userFreeXp.next(this._userFreeXp),t.scriptData.unit){for(let e in t.scriptData.unit)this._unitsTreeGet[e].xp_available=t.scriptData.unit[e];this.computeUnitsTree()}this.dismissExpoExchanger(),i.next(t),this.globalEvent.trigger("store.xp_exchange",{gold:t.scriptData.gold,xp:t.scriptData.xp}),Object(Pc.a)(`<- expo exchanged to ${t.scriptData.gold} gold`),this.alertSound("money")},t=>{this.dismissExpoExchanger(),i.error(t),this._notificatorService.push({response:t}),Object(Pc.a)("<[x] exchanging error",t)}),i}openTransactionResultModal(t){this.transactionCompleteModal.next(t)}dismissTransactionResultModal(){this.transactionCompleteModal.next(!1)}openDlcModal(t){this.dlcModal.next(t)}dismissDlcModal(){this.dlcModal.next(!1)}openConfirmModal(t,e,i=null,n){this._confirm[t.key+"_accept"]=e,n&&(this._confirm[t.key+"_decline"]=n),this.confirm.next({options:t,callback:e,data:i,declineCallback:n||null})}dismissConfirmModal(){for(let t in this._confirm)if(t.match(/\_(decline)/gim)){let e=t.replace(/\_(decline)/gim,"");this._confirm[e+"_decline"]?this._confirm[e+"_decline"]():console.warn("No dismiss invitation callback for "+e)}this._confirm={},this.confirm.next(null)}acceptConfirm(t){this._confirm[t+"_accept"]?this._confirm[t+"_accept"]():console.warn("No confirm callback for "+t),this._confirm={},this.confirm.next(null)}openInvitation(t,e,i=null,n){this._invitation[t.key+"_accept"]=e,n&&(this._invitation[t.key+"_decline"]=n),this.invitation.next({options:t,callback:e,data:i,declineCallback:n||null})}dismissInvitation(){for(let t in this._invitation){let e=t.replace(/\_(accept|decline)/gim,"");this._invitation[e+"_decline"]?(this._confirm[e+"_decline"](),this.dismissInvitation()):console.warn("No dismiss invitation callback for "+e)}this._invitation={},this.invitation.next(null)}acceptInvitation(t){this._invitation[t+"_accept"]?(this._confirm[t+"_accept"](),this.dismissInvitation()):console.warn("No invitation callback for "+t)}getUnitBoosters(){return this._account.scriptData.unitXpBooster||null}setUnitBoosters(t){this._account.scriptData.unitXpBooster=t}applyUnitBoosters(t,e){let i=new Nc;return this.fetch(pl.UnitXpBoosterApply.patch({session:t,units:e})).subscribe(t=>{if(t.scriptData.unitXpBooster&&this.setUnitBoosters(t.scriptData.unitXpBooster),t.scriptData.unitTreeUnit)for(let e in t.scriptData.unitTreeUnit)this.patchUnit(e,{xpAvailable:t.scriptData.unitTreeUnit[e].xp_available});i.next(t)},t=>{let e=Object.keys(t)[0];this._notificatorService.push({textError:"meta.ui.error."+t[e].ucode,textErrorParameters:{unit:this.L("unit."+t[e].value.unit+".short")}}),i.error(t)}),i}getCurrencyWithMultiplier(t,e=""){let i=t.toString();return t>=1e6?e=this.L("meta.ui.menu.multiplier_m"):t>=1e3&&(e=this.L("meta.ui.menu.multiplier_k")),t>=1e7?i=(t/1e6).toFixed(1):t>=1e6?i=(t/1e6).toFixed(2):t>=1e5?i=(t/1e3).toFixed(0):t>=1e4?i=(t/1e3).toFixed(1):t>=1e3&&(i=(t/1e3).toFixed(2)),`${i} ${e}`}getMoneyBox(){return this._account.scriptData.moneyBox||null}isMoneyBoxExist(){let t=this.getMoneyBox();return!!(t&&t.silver&&t.silver>0)}isMoneyBoxVisited(){let t=this.getMoneyBox();return!(t&&(!t||t.silver)&&t&&t.silver&&!this._visitService.isVisited("money_box_"+t.openTime))}openMoneyBox(){let t=new Nc;return Object(Pc.a)("-> opening money box..."),this.fetch(pl.MoneyBoxOpen).subscribe(e=>{Object(Pc.a)("<- money box opened.");let i=this.getMoneyBox();e.scriptData.gold&&this.setUserGold(e.scriptData.gold),e.scriptData.silver&&this.setUserSilver(e.scriptData.silver),e.scriptData.freeXp&&this.setUserFreeXp(e.scriptData.freeXp),e.scriptData.premium&&this.setPremium(e.scriptData.premium),i&&(i.silver&&(i.silver=0),i.gold&&(i.gold=0),i.freeXp&&(i.freeXp=0)),this.alertSound("money"),t.next(e),this.onMoneyBoxOpen.next(e.scriptData),this.onMoneyBoxOpen.next(null)},e=>{t.error(e),this._notificatorService.push({response:e}),Object(Pc.a)("<[x] money box opening error",e)}),t}getStoreItems(t=""){return t?this._storeItems.slice().filter(e=>e.type&&e.type===t):this._storeItems}getStoreIds(){let t=[];if(!this._storeItems||!this._storeItems.length)return t;for(let e=0;e<this._storeItems.length;e++)t.indexOf(this._storeItems[e].type)<0&&t.push(this._storeItems[e].type);return t}getStoreItem(t){return this._storeItems.find(e=>e.id===t)}getStoreItemsCount(){return this._storeItems.length}storeBuyItem(t){this.requestStoreBuyItem([t])}getNextTransaction(){if(!this._transactionsQueue.length)return null;if(this._transactionsQueue[0]&&this._transactionsQueue[0].data){let t=this._transactionsQueue.shift();return t.data.dlc&&t.data.content.campaign&&(this._account.scriptData.inventory||(this._account.scriptData.inventory={}),this._account.scriptData.inventory.campaign=(this._account.scriptData.inventory.campaign||[]).concat(t.data.content.campaign),Object(Pc.a)("DLC campaigns added",t.data.content.campaign)),t.data}return null}getTransactions(){return this._transactionsQueue}getTransactionArrays(t){let e=JSON.parse(JSON.stringify(t));if(e&&e.content){let t=e.content.unit;if(e.content.units=[],t)for(let i in t)e.content.units.push({id:i,amount:t[i],data:this.getTreeUnit(i)}),e.content.units=this.filterDlcUnits(e.content.units)}if(e&&e.update){let t=e.update.unit;if(e.update.units=[],t)for(let i in t)e.update.units.push({id:i,amount:t[i],data:this.getTreeUnit(i)}),e.update.units=this.filterDlcUnits(e.update.units)}return e&&!e.content.campaign&&(e.content.campaign=[]),e}filterDlcUnits(t){let e={art:0,inf:1,tnk:2};function i(t,i){return e[t.data.type]<e[i.data.type]?-1:e[t.data.type]>e[i.data.type]?1:t.data.level-i.data.level}let n={rus:0,ger:1,usa:2,jap:3,eng:4};for(let s in n)n[s]=t.filter(t=>t.data.army===s).sort(i);return n.rus.concat(n.ger).concat(n.usa).concat(n.jap).concat(n.eng)}getStoreItemPrice(t){let e={isSale:!1,price:0},i=this.getStoreItems().find(e=>{let i=new RegExp(t.replace(/\(/gim,"\\(").replace(/\)/gim,"\\)"),"gim");return e.id&&e.id.match(i)});if(!i){let i=this.getTreeUnit(t);return i&&(e.price=i.premium?i.premiumGold:i.silverCost),e}let n=new Date,s=new Date(i.price.expiresAt);return e.isSale=i.price.sale&&i.price.sale>0&&i.price.sale<i.price.cost&&n.isLess(s),e.price=e.isSale?i.price.sale:i.price.cost,e.isSale&&(e.oldPrice=i.price.cost),e}getStoreUnvisitedItems(t){let e=Yu,i=[],n=this.getStoreItems();for(let s=0;s<n.length;s++){let a=n[s];a.type&&e[a.type]||(t&&a.type===t||!t)&&(this._visitService.isVisited(`store_case_${a.id}_${a.price.cost}_${a.price.sale}_${a.price.expiresAt}`)||i.push(a))}return i}getStoreUnvisitedItemsLength(t){return this.getStoreUnvisitedItems(t).length}getLeagueRules(){return this.fetch(pl.LeagueRulesGet,null,!0)}getLeagueState(){return this.fetch(pl.LeagueStateGet,null,!0)}friendsCacheIsEmpty(){return 0===this._friendsAndChatCachedMessages.length}getFriendsAndChatCachedMessages(){return this._friendsAndChatCachedMessages}clearFriendsAndChatCachedMessages(){this._friendsAndChatCachedMessages=[]}alert(t,e=!0){location.href.match(/noAlert\=1/gim)||(!this.devMode&&t.match(/^sound/gim)||e&&Object(Pc.a)(`Alert => [${t}]`),Object(o.X)()||location.href.match(/\/dist\//)||alert(t))}alertUrl(t){this.alert("shell_open_web_browser:"+t)}alertReload(){this.alert("reload")}alertReset(){this.alert("reset")}alertEscape(){this.alert("esc")}alertSound(t){this.alert("sound:"+t+".ogg")}alertBackgroundMusicForState(t){this.alert("music:"+t)}alertUser(){this.alert("userId:"+this.getUserId()),this.alert("userName:"+this.getUser(!0).displayName||!1)}alertCommander(t,e=!1){if(!this.isTraining){if(!e){if(!t||!this.isCommanderIdValid(t))return void console.warn(`Commander id [${t}] is not valid, slert skipped`);if(this._lastLogItems.commander===t)return}this._lastLogItems.commander=t,wu(()=>{this.alert("commander:"+t)},100,"commanderSystemAlert")}}_alertCommanders(){this.alert("commander_list_start");for(let t=0;t<this._commanders.length;t++)this.alert("commander_list_data:"+JSON.stringify(this._commanders[t]),!1);this.alert("commander_list_end")}alertSlot(){}alertUnit(t,e=1,i=!1){t&&this._unitsTemplatesKeys[t]?(this._lastLogItems.unit!==t||i)&&(this._lastLogItems.unit=t,wu(()=>{let i=this.getTreeUnit(t).unitForPreview;this.alert("unit:"+i+":"+e)},1e3,"unitSystemAlert")):console.warn(`Unit id [${t}] is not valid, slert skipped`)}alertInputFilter(){if(dl.information.input_filter){if(this.alert("filter_start"),dl.information.input_filter){let t=JSON.stringify(dl.information.input_filter.data),e=Math.ceil(t.length/Gu);for(let i=0;i<e;i++)this.alert("filter_part:"+t.slice(i*Gu,(i+1)*Gu),!1)}this.alert("filter_end"),this.alert("filter_settings:"+JSON.stringify(this.getPlayerOptions()))}else console.warn("Curse filter skipped, no data")}getSystemInfo(t){return{commanders:this._commandersVersion,units:this._unitsVersion,cache:this._cacheVersion,maps:this._mapsVersion}[t]}showBugReportModal(){this.bugReportModal.next(!0)}hideBugReportModal(){this.bugReportModal.next(!1)}startLoadingProgress(t){console.log("start_"+t),this._progressTimers[t]&&clearInterval(this._progressTimers[t]);let e=20,i=new Nc(e);return this._progressTimers[t]=setInterval(()=>{e=Math.min(e+20,100),i.next(e),this._progressValues[t]=e},100),this._progressSubjects[t]=i,i}stopLoadingProgress(t){this._progressTimers[t]&&(console.log("stop_"+t),clearInterval(this._progressTimers[t]),this._progressValues[t]=101,this._progressSubjects[t].next(101),setTimeout(()=>{this._progressSubjects[t].complete(),this._progressValues[t]=0},10))}isLoadingProgressRunning(t){return this._progressValues[t]&&this._progressValues[t]>0&&this._progressValues[t]<=100}getLoadingProgress(t){return this._progressValues[t]?Math.min(this._progressValues[t],100):0}playerOptionsSet(t,e=!1){e?(this._userOptions=t,this.userOptions.next(this._userOptions),this.userOptions.next(null)):this.fetch(pl.PlayerOptionsSet.patch({options:t})).subscribe(t=>{this._userOptions=t.scriptData.options,this.userOptions.next(this._userOptions),this.userOptions.next(null)})}getPlayerOptions(){return this._userOptions}redirect(t){Object(Pc.a)("redirect to "+t);let e=this._router.createUrlTree(t,{queryParamsHandling:"merge"});this._router.navigateByUrl(e,{})}futureRedirect(t){this.devMode&&console.log("=>> future redirect saved: ",t.join(",")),localStorage.setItem($u,t.join(","))}checkFutureRedirect(t){let e=localStorage.getItem($u);if(t&&!e&&(e="multiplayer"),e){this.devMode&&console.log("=>> future redirect found: ",e);let t=e.split(",");setTimeout(()=>{this.redirect(t),localStorage.removeItem($u)})}}setFutureRedirect(t){let e=t.replace(/\?(.*?)$/,"").split("/");e.shift(),console.log("redirect saved",e),this.futureRedirect(e)}report(t,e,i,n){let s=this;ut(function(a){a.setTag("report_type",i),a.setTag("user_name",s.getUserName()),a.setLevel(j.Info);let r=new TypeError;r.name=t,r.message=i,r.stack=`at \u2063\u2063\u2063\u2063\u2063\u2063\u2063\u2000 (${s.getUserName()}:${s.getUserId()})`,console.dir(a),console.dir(r),lt(r,{extra:{user_name:s.getUserName(),user_id:s.getUserId(),title:t,message:e,attachments:n}})})}sendAttachmentToEvent(t,e){const i=((t,e)=>{const{host:i,path:n,projectId:s,port:a,protocol:r,user:o}=t;return`${r}://${i}${""!==a?":"+a:""}${""!==n?"/"+n:""}/api/${s}/events/${e}/attachments/?sentry_key=${o}&sentry_version=7&sentry_client=custom-javascript`})(h.b().getClient().getDsn(),t),n=new FormData;let s=[],a=[];for(let r=0;r<e.length;r++){let t=_u.imageToBlob(e[r].image,`${this.getUserName()}_screenshot_${r}`,"image/jpeg");t.then(t=>{a[r]=t,console.log(t)}),s.push(t)}Promise.all(s).then(()=>{for(let t=0;t<a.length;t++)n.append(`${this.getUserName()}_screenshot_${t}.png`,a[t],`${this.getUserName()}_screenshot_${t}.png`);fetch(i,{method:"POST",body:n}).catch(t=>{console.error(t)})})}modLocalizationRequest(){this.alert("mod:localization_get"),this.devMode&&this.modLocalizationGet({})}modLocalizationGet(t){this.devMode&&(t={"meta.campaign.mod_example.desc":"Mod example campaign description.","meta.campaign.mod_example.name":"Mod example","meta.mission.mission_example_00.desc":"Mod example mission_example_00 description.","meta.mission.mission_example_00.name":"Mod example mission"}),console.log("[MOD] localization taken from mod: ",t),this.localizator.addModLocalization(t)}buttonsRequest(){this.alert("controls:buttons_get")}buttonsGet(t){console.log("[CONTROLS] buttons received:",t)}modCommanderRequest(){this.alert("mod:commander_get")}modCommanderGet(t,e){console.log("[MOD] commanders taken from mod:",t,e)}modCampaignsRequest(){this.alert("mod:campaigns_get"),setTimeout(()=>{this.modCampaignsGet([],[])},100)}modCampaignsGet(t,e){this.devMode&&(t=[{_id:"mod_example",category:"story",modId:"mod_example",currency:"rub",display_order:2,enabled:!0,mission_results:"only_first_win",money:{freeXp:0,silver:0},node:{n00:{level:2,map:["bonusmission_2"],open:!0,open_up:["n01"],tree_x:2.5,tree_y:1},n01:{final:!0,level:2,map:["bonusmission_5"],opened_by:["n00"],tree_x:2.5,tree_y:2}},tags:["rus"],image:"example.jpg",image_preview:"example_preview.jpg"}],e=[{template:"mod_example",startTime:1638893906707,ts:1638893906707,modId:"mod_example",money:{freeXp:0,silver:0},node:{n00:{map:"mission_example_00",slot:{b1:{bot:"bot_usa_tnk_mechanized_level_4"},b4:{bot:"bot_usa_art_howitzer_level_4"},b5:{bot:"bot_ger_tnk_mechanized_level_4"}}}},id:"645634g563g456g3456g3456g345"}]),console.log("[MOD] campaigns taken from mod:",t,e);for(let i=0;i<t.length;i++)this._injectOrReplaceCampaignTemplate(t[i]);for(let i=0;i<e.length;i++)this._injectOrReplaceCampaign(e[i])}modCampaignsGetEnd(){}modMissionsRequest(){this.alert("mod:missions_get"),this.modMissionsGet([])}modMissionsGet(t){this.devMode&&(t=[{_id:"mission_example_00",activity_tags_on_start:["Arena_SovietCampaignBegin"],commander_tag:"mission_rus_01_00",fact_tags:["mission_rus_01_00"],map:"single/mod_example/bonusmission_1:0",mode:["coop"],modificator:["solo","online","difficulty","commander_template"],order:0,silver_rate:1,submode:["mission"],tags:["coop","rus","difficulty"],weight:1,xp_rate:1,image:"/assets/img/main_page.jpg",image_preview:"/assets/img/main_page.jpg"}]),console.log("[MOD] missions taken from mod:",t);for(let e=0;e<t.length;e++){let i=t[e];i.mod=!0,this._injectOrReplaceMissionTemplate(i)}}modMissionsGetEnd(){}getGDPRHTML(){return this._gdprText?this._gdprText.text:""}requestMatchmakingHints(t){this.alertWithParts("backendNotify",JSON.stringify({"@class":".TextSubst",data:t}),"onTextSubst")}matchMakingHintsGet(t){this.onAndreyTextMessageReceived.next(t),this.onAndreyTextMessageReceived.next(null)}getReviewModalContent(){let t={lang:"rus",avatar:"rus_rev",commander:""},e=this.localizator.getLocale().split("-")[0].toLowerCase(),i={rus:"ua|ru|zh|tr",usa:"en|es|pt|pl|ko|fr",ger:"de|jp"};for(let n in i)if(e.match(new RegExp(i[n]))){t.lang=n,t.avatar=n+"_rev";break}return t.commander={rus:["rus_inf_apc_big","rus_tank_art_big","rus_tank_heavy_big","rus_tank_medium_big","rus_art_spg_big"],usa:["usa_art_at_big","usa_inf_airborne_big","usa_tank_heavy_big","usa_tank_medium_big","usa_inf_apc_big"],ger:["ger_art_art_big","ger_art_spg_big","ger_inf_aviation_big","ger_tank_heavy_big","ger_inf_heavy_big"]}[t.lang][Math.randomInt(0,4)],t}callReviewModal(){let t=this.getCounter("total.session.complete_pvp")||0,e=this.getCounter("total.session.complete_pve")||0;this.allow("review")&&!this.getCounter("ui.mark.review")&&(t>=6||e>=4)&&(this.globalEvent.trigger("review_modal.open",this.getReviewModalContent()),this.setCounter("ui.mark.review",1))}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(Ys),o.Vb(Uc),o.Vb(Sl),o.Vb(Ou))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})();const sd=["?","I","II","III","IV","V","VI","VII","VIII","IX","X"];class ad{constructor(t){this.globalEvent=new uu,this.amountUnit={},this.faded=!1,this.goingToBeEmpty=!1;for(let e in t)this[e]=t[e];this.levelRoman=sd[this.level]}getRemainingCount(){return this.unit?this.unit.amount.limit-this.amount:this.amount}getTotalBattleRank(){return this.unit?Math.ceil(this.unit.modifyRank*this.unit.amount.count):0}canBeIncreased(){let t=nd.instance.getBarrackUnit(this.unit.id,this,this.parent.campaignId);return!(!this.unit||!t)&&this.amount<this.unit.amount.limit&&(t.barrack.available>0||nd.instance.isUnitUnlimited(this.unit,this.parent.commander))}isLimitReached(){return!this.unit||this.amount>=this.unit.amount.limit}canBeDecreased(){let t=nd.instance.getBarrackUnit(this.unit.id,this,this.parent.campaignId);return!(!this.unit||!t)&&this.amount>1}increase(){this.canBeIncreased()&&this.unit&&(nd.instance.getBarrackUnit(this.unit.id,this,this.parent.campaignId),this.amount++,this.unit.amount.count++,nd.instance.setSlotAmount(this.unit.id,1,this),this.globalEvent.trigger("troops.slot_increase",{slotId:this.id,unitId:this.unit?this.unit.id:"",amount:this.amount,template:this.parent.commander._id,tutorial:!0}))}decrease(){this.unit&&(nd.instance.getBarrackUnit(this.unit.id,this,this.parent.campaignId),this.amount--,this.unit.amount.count--,nd.instance.setSlotAmount(this.unit.id,-1,this),this.globalEvent.trigger("troops.slot_decrease",{slotId:this.id,unitId:this.unit?this.unit.id:"",amount:this.amount,template:this.parent.commander._id}))}increaseMaximum(){if(!this.unit)return;let t=nd.instance.getBarrackUnit(this.unit.id,this,this.parent.campaignId),e=Math.min(this.unit.amount.limit-this.unit.amount.count,t.barrack.available);nd.instance.isUnitUnlimited(this.unit,this.parent.commander)&&(e=this.unit.amount.limit-this.unit.amount.count);let i=Math.min(Math.floor(this.parent.getRawRemainingBattleRank()/(this.unit.modifyRank*this.unit.amount.count)),e);this.amount+=i,this.unit.amount.count+=i,nd.instance.setSlotAmount(this.unit.id,i,this)}setAmount(t){this.unit&&(nd.instance.getBarrackUnit(this.unit.id,this,this.parent.campaignId),this.amount+=t,this.unit.amount.count+=t,nd.instance.setSlotAmount(this.unit.id,t,this))}purchase(){if(!this.unit)return;let t=nd.instance.getBarrackUnit(this.unit.id,this,this.parent.campaignId);t.open?t.barrack.available<=0&&nd.instance.purchaseUnitsToSlot(this):Object(Pc.a)("Warn",t.id+" is not open, so couldnt be purchased")}reset(t=!1){this.goingToBeEmpty=!1,this.unit&&(nd.instance.setSlotAmount(this.unit.id,-this.amount,this,t),this.amount=0,this.unit=null,this.squadId="",this.faded=!1,nd.instance.slotPatch.next(this),nd.instance.slotPatch.next(null))}update(t=!1){this.goingToBeEmpty=!1,this.unit&&!t&&nd.instance.setSlotAmount(this.unit.id,0,this,t)}}class rd{constructor(t,e){this._lowThreshold=.25,this.slots=[],this.index=t,this.totalBattleRank=0,this.campaignId=e}isComplete(){return!!this.commander.const||this.getTotalBattleRank()>this.limit*this._lowThreshold}addSlot(t){this.slots.push(t)}getSlot(t){let e=null;for(let i=0;i<this.slots.length;i++)this.slots[i].id===t&&(e=this.slots[i]);return e}sort(){this.slots=this.slots.sort((t,e)=>t.id<e.id?-1:t.id>e.id?1:0)}getTotalBattleRank(t=""){let e=0;return e=this.slots.reduce((e,i)=>e+(t.indexOf(i.id)>-1?0:i.getTotalBattleRank()),e),Math.ceil(e)}getRawTotalBattleRank(t=""){let e=0;return e=this.slots.reduce((e,i)=>e+(t.indexOf(i.id)>-1?0:i.getTotalBattleRank()),e),+e.toFixed(2)}getRemainingBattleRank(t=""){return this.limit-this.getTotalBattleRank(t)}getRawRemainingBattleRank(t=""){return+(this.limit-this.getRawTotalBattleRank(t)).toFixed(2)}isCommanderAvailableToCreateSquad(t){if(!this.commander.available)return!1;for(let e=0;this.commander.available.slot.length;e++)if(this.commander.available.slot[e].id===t)return!0;return!1}checkIfSuits(t){if(console.log(t),t)for(let e=0;e<this.slots.length;e++){let i=this.slots[e];i.amountUnit[t.id]||(i.subtype.indexOf(t.subtype)<0||i.level<t.level)&&(i.faded=!0,console.log(i.id,i.faded))}else this.restore()}restore(){for(let t=0;t<this.slots.length;t++)this.slots[t].faded=!1}}var od=function(t){return t.Start="start",t.Cancel="cancel",t}({}),cd=function(t){return t.Meta="meta",t.Matchmaking="mm",t.MatchFound="match_found",t.Authors="authors",t}({});let ld={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:(4-2*t)*t-1},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}};class ud{constructor(t,e=500){this.node=document.createElement("div"),this.unitSize=nd.instance.unitSize.clone(),this.duration=e,this.unit=t,this.node.classList.add("unit","animation-drop"),this.node.style.width=this.unitSize.x+"px",this.node.style.height=this.unitSize.y+"px",document.body.appendChild(this.node),this.node.innerHTML=function(t){return`\n\t\t<div class="wrapper">\n\t\t\t<div class="image-background ${t.army}"></div>\n\t\t\t<img src="assets/img/unit/${t.image}.png" class="image-unit">\n\t\t</div>\n\t\t<div class="shadow" \n\t\t\t[class.active]="highlighted && data?.mode != 'default'"\n\t\t\t[class.attach]="attach"\n\t\t></div>\n\t`}(t)}animate(t,e){let i=new ke(null),n=t.getBoundingClientRect(),s=e.getBoundingClientRect(),a=new yl(n.left,n.top),r=new yl(s.left,s.top);this.node.style.top=a.y+"px",this.node.style.left=a.x+"px";let o=(new Date).getTime(),c=0,l=()=>{let t=(new Date).getTime(),e=t-o;c<=this.duration?requestAnimationFrame(l):(i.next({done:!0,t:1}),setTimeout(()=>{document.body.removeChild(this.node)},10));let n=Math.clamp(c/this.duration,0,1);n=ld.easeInOutCubic(n);let s=yl.lerp(a,r,n).subtract(a);this.node.style.transform=`translate(${s.x}px,${s.y}px)`,c+=e,o=t,i.next({done:!1,t:n})};return l(),i}}var dd=function(t){return t.Start="start",t.Progress="progress",t.End="end",t}({});class hd{constructor(t,e){this.progress=0,this.finished=!1,this.running=!1,this.startValue=0,this.targetValue=0,this.callbacks={start:null,progress:null,end:null},this.startValue=t,this.timeout=e||300}goTo(t){return this.targetValue=t,this.running=!0,this.startTime=(new Date).getTime(),this.callbacks.start&&this.callbacks.start(),this.animate(),this}animate(){let t=(new Date).getTime();this.progress+=(t-this.startTime)/this.timeout,this.progress=this.progress<0?0:this.progress>1?1:this.progress,this.startTime=t,this.callbacks.progress&&this.callbacks.progress(this.startValue-(this.startValue-this.targetValue)*this.progress),this.progress>=1&&(this.progress=1,this.running=!1,this.callbacks.end&&this.callbacks.end()),this.running&&requestAnimationFrame(this.animate.bind(this))}on(t,e){return this.callbacks[t]=e,this}}const bd=window.document;let md=new yl,pd={initialized:!1,onKeyDown:new ke(null),onKeyUp:new ke(null),getKey:function(t){return!!this[t]},getMousePosition:function(t){let e;return t&&t&&t.length&&(t=document.querySelector(t))&&(e=t.getBoundingClientRect()),e?new yl(Math.clamp(md.x-e.left,0,e.width),Math.clamp(md.y-e.top,0,e.height)):md}};function gd(t){let e=0,i=0;do{e+=t.offsetLeft-t.scrollLeft,i+=t.offsetTop-t.scrollTop}while(t=t.offsetParent);return{left:e,top:i}}function fd(t){let e={};for(let i in t)e[t[i]]=t[i];return e}function vd(t){let e=[];for(let i in t)e.push(t[i]);return e}function yd(t){Object.keys(t.controls).forEach(e=>{const i=t.get(e);i instanceof sc||i instanceof rc?_d(i):i instanceof ac&&yd(i)})}function _d(t){if(t.hasOwnProperty("controls")){t.markAsDirty({onlySelf:!0});let e=t;for(let t in e.controls)_d(e.controls[t])}else t.markAsDirty({onlySelf:!0})}function kd(t){return this.controls[t]&&this.controls[t].errors&&!this.controls[t].pristine}function wd(t){return this.controls[t]&&!this.controls[t].errors&&this.controls[t].valid&&this.controls[t].value}pd.initialized||(document.addEventListener("keydown",t=>{pd[t.keyCode]||(pd[t.keyCode]=!0,pd[t.key]=!0,pd.onKeyDown.next(t),pd.onKeyDown.next(null))}),document.addEventListener("keyup",t=>{pd[t.keyCode]=!1,pd[t.key]=!1,pd.onKeyUp.next(t),pd.onKeyUp.next(null)}),document.addEventListener("mousemove",t=>{md.x=t.clientX,md.y=t.clientY}),pd.initialized=!0);const Sd=[{levelKey:"level1",steps:[{key:"level1.greet",role:"main",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.tutorial.next",link:"play/pvp"}]},{key:"level1.campaign.route",role:"hint",events:[{keys:["button.navigation.play"],marker:"ui.tutorial.mark.play.menu",link:"play/pvp"},{keys:["button.navigation.tutorial"],marker:"ui.tutorial.mark.tutorial.menu",link:"play/pvp"}]},{key:"level1.campaign.detail",role:"hint",events:[{keys:["continue.select_campaign"],campaignId:"tutorial_rus",marker:"ui.tutorial.mark.continue.campaign.tutorial_rus",link:"/play/campaigns/tutorial_rus"}]},{key:"level1.mission.play",role:"main",events:[{keys:["play.select_mission"],marker:"ui.tutorial.mark.play.mission",link:"play/campaigns/tutorial_rus/missions"},{key:"button.play",link:"play/campaigns/tutorial_rus/missions",marker:"ui.tutorial.mark.play_button",doNotComplete:!0}]}],opens:[{key:"opening.pre_order_missions"},{key:"opening.shop"},{key:"opening.campaign"}]},{levelKey:"level2",steps:[{key:"level2.stats.presonal",role:"hint",events:[{keys:["button.stats.personal_info"],link:"profile",marker:"ui.tutorial.mark.stats.personal_info"},{keys:["button.modal.close"],marker:"ui.tutorial.modal.close"}]},{key:"level2.greet",role:"main",events:[{keys:["button.tutorial.next"],link:"profile",marker:"ui.tutorial.mark.tutorial.next"}]},{key:"level2.stats.currency",role:"hint",events:[{keys:["button.tutorial.next"],link:"profile",marker:"ui.tutorial.campaign.currency"}]},{key:"level3.reward.route",role:"hint",events:[{keys:["button.navigation.rewards"],link:"play",marker:"ui.tutorial.button.rewards.select",doNotComplete:!0}]}],opens:[{key:"opening.stats"}]},{levelKey:"level3",steps:[{key:"level3.greet",role:"main",events:[{keys:["button.tutorial.next"],link:"play",marker:"ui.tutorial.mark.tutorial.next"}]},{key:"level3.campaign.route",role:"hint",events:[{keys:["button.tutorial.next"],link:"play",marker:"ui.tutorial.mark.tutorial.next",doNotComplete:!0}]}],opens:[{key:"opening.rewards"},{key:"opening.newcomer_calendar"}]},{levelKey:"level4",link:"play",steps:[{key:"level4.greet",role:"main",events:[{keys:["button.tutorial.next"],link:"play",marker:"ui.tutorial.mark.tutorial.next",doNotComplete:!0}]}],opens:[{key:"opening.pve"},{key:"opening.unit_purchase"},{key:"opening.troops_edit"}]},{levelKey:"level5",steps:[{key:"level5.greet",role:"main",events:[{keys:["button.tutorial.next"],link:"play",marker:"ui.tutorial.mark.tutorial.next",doNotComplete:!0}]}],opens:[{key:"opening.pvp"},{key:"opening.tech"},{key:"opening.friends"},{key:"opening.pve_coop"},{key:"opening.daily_calendar"}]},{levelKey:"level6",opens:[{key:"opening.task"},{key:"opening.xp_conversion"}]},{levelKey:"level7",opens:[{key:"opening.challenge"},{key:"opening.silver_exchange"}]},{levelKey:"level8",opens:[{key:"opening.rank_battles"}]}],Id=[{globalKey:"button.navigation.troops",steps:[{key:"troops.route",role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.tutorial.next",global:!0,link:"troops",doNotComplete:!0}]}]},{globalKey:"troops.select_commander",steps:[{key:"troops.select_echelon",role:"hint",events:[{keys:["troops_echelons"],link:"troops",global:!0,marker:"ui.tutorial.mark.troops.echelons"}]},{key:"echelons.tutorial",role:"hint",events:[{keys:["button.tutorial.next"],global:!0,link:"echelons",marker:"ui.tutorial.mark.troops.echelon"}]},{key:"slots.route.tutorial",role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.tutorial.slot_echelon",global:!0,link:"echelons"}]},{key:"slots.select_slot.tutorial",role:"hint",events:[{keys:["troops.slot_select"],global:!0,link:"echelons",marker:"ui.tutorial.mark.troops.slot_a3"}]},{key:"slots.select_add.tutorial",role:"hint",events:[{keys:["troops.slot_create","troops.barack.select_unit","troops.slot_increase"],global:!0,link:"echelons",marker:"ui.tutorial.mark.troops.slot_a3"}]},{key:"br.tutorial",role:"hint",events:[{keys:["button.tutorial.next"],global:!0,link:"echelons",marker:"ui.tutorial.mark.troops.br"}]},{key:"gold_squads.tutorial",role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.gold_squads",global:!0,link:"echelons",doNotComplete:!0}]}]},{globalKey:"button.navigation.tech",steps:[{key:"tech",global:!0,role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.tutorial.next",link:"technology",doNotComplete:!0}]}]},{globalKey:"button.play.campaigns",steps:[{key:"campaign.start",role:"main",events:[{keys:["button.tutorial.next"],global:!0,link:"play/campaigns",marker:"ui.tutorial.mark.tutorial.next",doNotComplete:!0}]}]},{globalKey:"button.navigation.campaign.troops",steps:[{key:"campaign.troops",role:"hint",events:[{keys:["troops_echelons"],global:!0,link:"play/campaigns",marker:"ui.tutorial.mark.troops.echelons"}]},{key:"campaign.echelons.tutorial",role:"hint",events:[{keys:["button.tutorial.next"],global:!0,link:"play/campaigns",marker:"ui.tutorial.mark.troops.echelon"}]},{key:"campaign.slots",role:"hint",events:[{keys:["troops.slot_create"],global:!0,link:"play/campaigns",marker:"ui.tutorial.mark.troops.slot_campaign"}]},{key:"campaign.currency.tutorial",role:"hint",events:[{keys:["button.tutorial.next"],global:!0,link:"play/campaigns",marker:"ui.tutorial.mark.troops.price"}]},{key:"campaign.br.tutorial",role:"hint",events:[{keys:["button.tutorial.next"],global:!0,link:"play/campaigns",marker:"ui.tutorial.mark.troops.br",doNotComplete:!0}]}]},{globalKey:"button.navigation.campaign.tech",steps:[{key:"campaign.tech.tutorial",role:"hint",events:[{keys:["button.tutorial.next"],link:"technology",global:!0,marker:"ui.tutorial.mark.compare.button"}]},{key:"campaign.opened_units.tutorial",role:"hint",events:[{keys:["button.tutorial.next"],link:"technology",global:!0,marker:"ui.tutorial.mark.tutorial.next"}]},{key:"campaign.unit_xp.tutorial",role:"hint",events:[{keys:["troops.hightligt_branch"],link:"technology",global:!0,marker:"ui.tutorial.mark.campaign.unit_xp"}]},{key:"campaign.unit_discovering.tutorial",role:"hint",events:[{keys:["button.tech.open_unit","modal.unit_specifications.open","modal.unit_explore.open"],link:"technology",global:!0,marker:"ui.tutorial.mark.tech.open_unit"}]},{key:"campaign.free_xp.tutorial",role:"hint",events:[{keys:["button.tutorial.next"],link:"technology",global:!0,marker:"ui.tutorial.campaign.currency",doNotComplete:!0}]}]},{globalKey:"button.navigation.profile.summary",steps:[{key:"profile.summary",role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.tutorial.next",global:!0,link:"summary",doNotComplete:!0}]}]},{globalKey:"button.navigation.profile.preferences",steps:[{key:"profile.preferences",role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.tutorial.next",global:!0,link:"preferences",doNotComplete:!0}]}]},{globalKey:"button.navigation.profile.sessions",steps:[{key:"profile.battles",role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.tutorial.next",global:!0,link:"sessions",doNotComplete:!0}]}]},{globalKey:"button.navigation.profile.achievements",steps:[{key:"profile.achievements",role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.tutorial.next",global:!0,link:"achievements",doNotComplete:!0}]}]},{globalKey:"button.navigation.profile.troops",steps:[{key:"profile.troops",role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.tutorial.next",global:!0,link:"troops/units",doNotComplete:!0}]}]},{globalKey:"button.navigation.profile.rating",steps:[{key:"profile.rating",role:"hint",events:[{keys:["button.tutorial.next"],global:!0,marker:"ui.tutorial.mark.tutorial.next",link:"rating",doNotComplete:!0}]}]},{globalKey:"button.navigation.profile.leagues",steps:[{key:"profile.league",role:"hint",events:[{keys:["button.tutorial.next"],global:!0,marker:"ui.tutorial.mark.tutorial.next",link:"leagues",doNotComplete:!0}]}]},{globalKey:"button.navigation.task",steps:[{key:"task_this_day.help",global:!0,role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.tutorial.next",link:"task",doNotComplete:!0}]}]},{globalKey:"button.navigation.task.day",steps:[{key:"task_this_day.help",global:!0,role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.tutorial.next",link:"task",doNotComplete:!0}]}]},{globalKey:"button.navigation.task.week",steps:[{key:"task_this_week.help",global:!0,role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.tutorial.next",link:"task",doNotComplete:!0}]}]},{globalKey:"button.navigation.task.special",steps:[{key:"task_special.help",global:!0,role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.tutorial.next",link:"task",doNotComplete:!0}]}]},{globalKey:"button.navigation.task.challenges",steps:[{key:"task_trial.help",global:!0,role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.tutorial.next",link:"task",doNotComplete:!0}]}]},{globalKey:"button.navigation.task.commander",steps:[{key:"task_commander.help",global:!0,role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.tutorial.next",link:"task",doNotComplete:!0}]}]},{globalKey:"button.navigation.play.custom",steps:[{key:"play.lobby.tutorial",role:"hint",events:[{keys:["button.lobby.custom.create"],marker:"ui.tutorial.mark.play.custom",global:!0,link:"custom"}]},{key:"play.lobby.created.tutorial",role:"hint",events:[{keys:["button.tutorial.next"],link:"custom",global:!0,marker:"ui.tutorial.mark.custom.teams"}]},{key:"play.lobby.about.tutorial",role:"hint",events:[{keys:["button.tutorial.next"],link:"/custom/",global:!0,marker:"ui.tutorial.mark.custom.about"}]},{key:"play.lobby.settings.tutorial",role:"hint",events:[{keys:["button.lobby.setting"],link:"/custom/",global:!0,marker:"ui.tutorial.mark.custom.settings"}]},{key:"play.lobby.options.game",role:"hint",events:[{keys:["select.lobby.submodes.groundcontrol_deathmatch"],link:"/custom/",global:!0,marker:"ui.tutorial.mark.options.submodes"}]},{key:"play.lobby.options.map",role:"hint",events:[{keys:["select.lobby.map.deathmatch_champagne"],link:"/custom/",global:!0,marker:"ui.tutorial.mark.options.maps"}]},{key:"play.lobby.options.size",role:"hint",events:[{keys:["select.lobby.size.3"],link:"/custom/",global:!0,marker:"ui.tutorial.mark.options.team_size"}]},{key:"play.lobby.options.troops",role:"hint",events:[{keys:["select.lobby.unit_level.4"],link:"/custom/",global:!0,marker:"ui.tutorial.mark.options.unit_level"}]},{key:"play.lobby.options.army",role:"hint",events:[{keys:["select.lobby.army_mode.exact"],link:"/custom/",global:!0,marker:"ui.tutorial.mark.options.army_mode"}]},{key:"play.lobby.options.team",role:"hint",events:[{keys:["select.lobby.army_a.rus.army_b.ger"],link:"/custom/",global:!0,marker:"ui.tutorial.mark.options.team"}]},{key:"play.lobby.troops.tutorial",role:"hint",events:[{link:"/custom/",global:!0,keys:["play.lobby.options.save"],marker:"ui.tutorial.mark.options.save",doNotComplete:!0}]}]},{globalKey:"friends.open",steps:[{key:"friend.list.tutorial",global:!0,role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.tutorial.next",link:"/"}]},{key:"add.friend.tutorial",global:!0,role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.copy_id",link:"/"}]},{key:"type.friend.tutorial",global:!0,role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.id_field",link:"/",doNotComplete:!0}]}]},{globalKey:"add.friend",steps:[{key:"add.friend.complete.tutorial",global:!0,role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.tutorial.friends_menu",link:"/"}]},{key:"add.friend_to_team.tutorial",global:!0,role:"hint",events:[{keys:["button.add_friend_to_team"],marker:"ui.tutorial.mark.add_to_team",link:"/"}]},{key:"join.friend_to_team.tutorial",global:!0,role:"hint",events:[{keys:["button.tutorial.next"],marker:"ui.tutorial.mark.tutorial.team_chat",link:"/",doNotComplete:!0}]}]}],Cd="METAGAME_TUTORIAL_GLOBAL",Ld="METAGAME_TUTORIAL_DATA_AUTO",Rd="METAGAME_TUTORIAL_GLOBAL_DATA",Od="METAGAME_TUTORIAL_GLOBAL_KEY";let Td=(()=>{class t{constructor(e,i){if(this.cache=e,this.router=i,this.onStepComplete=new Nc,this.onTutorialDataChange=new Nc,this.onEventChange=new Nc,this.onLevelChange=new Nc,this.ontutorialModalStatus=new Nc,this.tutorialActive=!1,this.isTraining=!1,this.tutorialModalStatus=!1,this.globalEvent=new uu,this._playerLevel=0,this._tutorialLevels=Sd,this._tutorialGlobal=Id,this._currentIndexLevel=0,this._currentStepIndex=0,this._currentEventIndex=0,this._global=!!localStorage.getItem(Cd)&&JSON.parse(localStorage.getItem(Cd)),this._currentStepList=[],this._currentEventsList=[],this._modalIsOpened=!1,this.friendKeys=["friends.open","add.friend","button.add_friend_to_team"],this.tutorialTotalKeys=[],this.counterExist=!1,t.instance)return t.instance;t.instance=this,this.tutorialActive=!1}onGlobalEvent(t){this.tutorialActive=!1}checkUrlForGlobalEvent(t){if(!t&&!t.link)return;let e=new RegExp(t.link,"gim").exec(this.router.url);e&&e[0]&&e[0]==t.link&&(this.tutorialData=t,this.saveTutorialGlobal(this._global),this.updateOnDataChange(this.tutorialData),this.saveTutorialData(this.tutorialData),this.showModal())}clearGlobal(){this._global=!1,this._globalKey=""}goToTheNextEvent(t){if(this.tutorialData){if(this.tutorialData.currentEvent&&this.tutorialData.currentEvent.doNotComplete)return this.completeTutorial(),this.saveTutorialData(this.tutorialData),this.setCompletedMarker(),this.saveGlobalKey(""),this._global=!1,this.saveTutorialGlobal(!1),this.updateOnDataChange(null),void this.hideModal();this._currentEventIndex==this.tutorialData.currentStep.events.length-1?(this._currentEventIndex=0,this.completeEvent(),this._currentStepIndex<this.tutorialData.currentStepList.length-1&&this._currentStepIndex++,this.completeStep()):this._currentEventIndex<this.tutorialData.currentStep.events.length-1&&(this._currentEventIndex++,this.completeEvent()),this.setIndexes(this._currentStepIndex,this._currentEventIndex,this.tutorialData.playerLevel-1),this.tutorialData=this.setTutorialData(t,this._globalKey),this.hideModal(),setTimeout(()=>{this.checkUrlForTutorial()},650)}}completeTutorial(){this.tutorialData.completed=!0}completeStep(){this.onStepComplete.next(this.getCurrentStep()),this.onStepComplete.next(null)}completeEvent(){this.onEventChange.next(this.getCurrentEvent()),this.onEventChange.next(null)}setGlobalKey(t){if(!this._tutorialGlobal||!this._tutorialGlobal.length)return;let e=this._tutorialGlobal.find(e=>e.globalKey==t);(!this._globalKey||this._globalKey!=t&&e)&&(this._globalKey=t,this.saveGlobalKey(t))}changeSavedTutorialData(t){let e=this.getSavedTutorialData(t);if(e){if(e.completed)return;e.playerLevel&&e.playerLevel!=this._playerLevel?(this.setIndexes(0,0,e.playerLevel-1),this.tutorialData=this.setTutorialData(t,this._globalKey)):(this.setIndexes(e.stepIndex,e.eventIndex,e.playerLevel-1),this.tutorialData=e)}else this.setIndexes(0,0,this._playerLevel-1),this.tutorialData=this.setTutorialData(t,this._globalKey)}setLastGlobalKey(){let t="";return t=localStorage.getItem(Od)?JSON.parse(localStorage.getItem(Od)):"",t}setTutorialGlobal(t){let e=!1;return e=!!(t&&t.data&&t.data.tutorial)&&t.data.tutorial,e}updatePlayerLevel(t){this._playerLevel=t,this.onLevelChange.next(this._playerLevel),this.onLevelChange.next(null)}setTutorialData(t,e){let i=this._currentStepList=this.getCurrentStepList(t,e),n=this._currentEventsList=this.getCurrentEventList(),s=null;return s={playerLevel:this._playerLevel,totalLevels:this._tutorialLevels&&this._tutorialLevels.length?this._tutorialLevels.length:0,currentStepList:i,totalSteps:i?i.length:0,currentStep:this.getCurrentStep(),stepIndex:this._currentStepIndex,currentEventsList:n,totalEvents:n?n.length:0,currentEvent:this.getCurrentEvent(),eventIndex:this._currentEventIndex,global:t,globalKey:t?e:"",link:this.getCurrentLink(this.getCurrentEvent()),completed:!1},Object(Pc.a)("setTutorialData :: TutorialService"),Object(Pc.a)("\u2502 Tutorial Link: "+s.link),Object(Pc.a)("\u2502 Index Level: "+this._currentIndexLevel),Object(Pc.a)("\u2502 Step Index: "+s.stepIndex),Object(Pc.a)("\u2514 Event Index: "+s.eventIndex),s}setIndexes(t,e,i){this._currentStepIndex=t,this._currentEventIndex=e,this._currentIndexLevel=i>0?i-1:0}getSavedTutorialData(t){let e=null;return e=t?localStorage.getItem(Rd)&&JSON.parse(localStorage.getItem(Rd))&&JSON.parse(localStorage.getItem(Rd))[this._globalKey]?JSON.parse(localStorage.getItem(Rd))[this._globalKey]:null:localStorage.getItem(Ld)&&JSON.parse(localStorage.getItem(Ld))?JSON.parse(localStorage.getItem(Ld)):null,e}checkUrlForTutorial(){if(!this.tutorialData||!this.tutorialData.link)return;if(this.tutorialData&&this.tutorialData.completed)return;let t=new RegExp(this.tutorialData.link,"gim").exec(this.router.url);t&&t[0]&&t[0]==this.tutorialData.link&&!this._modalIsOpened?(console.log("SHOW TUTORIAL MODAL"),this.updateOnDataChange(this.tutorialData),this.saveTutorialData(this.tutorialData),this.showModal()):this.tutorialModalStatus&&(console.log("HIDE TUTORIAL MODAL"),this.updateOnDataChange(null),this.hideModal())}showModal(){this.ontutorialModalStatus.next(!0),this.tutorialModalStatus=!0}hideModal(){this.ontutorialModalStatus.next(!1),this.tutorialModalStatus=!1}updateOnDataChange(t){this.onTutorialDataChange.next(t),this.onTutorialDataChange.next(null)}clearAllTutorialData(){this._globalKey="",this._global=!1,this.tutorialData=null,this._currentStepList=[],this._currentEventsList=[],this._currentLink=""}setMarker(t){let e=t?t.marker:null;e&&this.cache.setCounter(e,1,!0)}clearMarker(t){let e=t?t.marker:null;e&&this.cache.setCounter(e,0,!0)}saveTutorialData(t){if(t&&1==t.global){let e=t.globalKey?t.globalKey:null,i=localStorage.getItem(Rd)?JSON.parse(localStorage.getItem(Rd)):{};i[e]=t,e&&localStorage.setItem(Rd,JSON.stringify(i))}else t&&0==t.global?localStorage.setItem(Ld,JSON.stringify(t)):void 0!==t&&(localStorage.setItem(Ld,JSON.stringify(t)),localStorage.setItem(Rd,JSON.stringify(t)))}saveTutorialGlobal(t){localStorage.setItem(Cd,JSON.stringify(t))}saveGlobalKey(t){localStorage.setItem(Od,JSON.stringify(t))}hasCounter(t){return this.cache.getCounter(t)}getCurrentStepList(t,e){let i=null;if(t&&e){if(this._tutorialGlobal&&this._tutorialGlobal.length){let t=this._tutorialGlobal.find(t=>t.globalKey==e);t&&(i=t.steps)}}else this._tutorialLevels[this._currentIndexLevel]&&this._tutorialLevels[this._currentIndexLevel].steps&&(i=this._tutorialLevels[this._currentIndexLevel].steps);return i}getCurrentStep(){let t=null,e=this._currentStepList;return e&&e[this._currentStepIndex]&&(t=e[this._currentStepIndex]),t}getCurrentEventList(){let t=null,e=this._currentStepList;return e&&e[this._currentStepIndex]&&e[this._currentStepIndex].events&&(t=this._currentStepList[this._currentStepIndex].events),t}getCurrentEvent(){let t=null,e=this.getCurrentStep(),i=this._currentEventIndex?this._currentEventIndex:0;return t=e?e.events[i]?e.events[i]:e.events[0]:null,t}getTutorialLevelByIndex(t){return this._tutorialLevels[t]||null}getCurrentLink(t){if(!t)return;let e="";return e=t.link?t.link:"play",e}getOpeningLevel(t){if(this._tutorialLevels&&!this._tutorialLevels.length){for(let e=0;e<this._tutorialLevels.length;e++)if(this._tutorialLevels[e].opens&&this._tutorialLevels[e].opens.find(e=>e.key==t))return e+1;return 1}}isTutorialMissionsCompleted(t=!1){let e=this.cache.getCampaign("tutorial_rus");if(!e)return!!t&&0;let i=e.map;if(!i||i&&!i.length)return!!t&&0;let n=0;for(let s=0;s<i.length;s++)this.cache.getCounter(`map.${i[s]}.played`)&&n++;return t?n:n>=3}isEventEquals(t,e){if(!t||!e)return!1;if(t.key!==e.key)return!1;if(t.key===e.key){let i=Object.keys(t).filter(t=>!"key,marker,doNotComplete,link,modal".match(new RegExp(t,"gim")));if(!i.length)return!0;for(let n=0;n<i.length;n++){let s=i[n];if(!e.data||t[s]!==e.data[s])return!1}return!0}return!1}detectModalOpen(t){if(!this.tutorialActive||!t||!t.key)return;let e=this.checkIfFriendTutorialCompleted();"modal.open"==t.key&&(t.data&&t.data.id&&"friends_list"!=t.data.id||e)&&(this.hideModal(),this._global=!1,this._modalIsOpened=!0),("modal.close"==t.key||"modal.close"==t.key&&t.data&&t.data.id&&"friends_list"==t.data.id)&&(this._modalIsOpened=!1,"modal.close"==t.key&&t.data&&t.data.id&&"friends_list"==t.data.id&&this.hideModal(),setTimeout(()=>{this.savedTutorialData&&(this.tutorialData=this.savedTutorialData,this._global=this.savedTutorialData.global,this.saveTutorialGlobal(this._global),this._globalKey=this.savedTutorialData.globalKey,this.saveGlobalKey(this._globalKey),this.updateOnDataChange(this.tutorialData),this.saveTutorialData(this.tutorialData)),this.checkUrlForTutorial()}))}checkIfFriendTutorialCompleted(){let t=!1,e=this.friendKeys,i=JSON.parse(localStorage.getItem(Rd));if(!i)return t;for(let n of e){if(i[n]&&i[n].completed&&i[n]==this._globalKey)return t=!0,t;if(i[n]&&!i[n].completed)return t}}completeTutorialData(){if(!this.tutorialData)return;let t=this.tutorialData.currentStepList[this.tutorialData.totalSteps-1],e=t.events,i=e[e.length-1],n=null;n={currentStep:t,stepIndex:this.tutorialData.currentStepList.length,currentEventsList:e,currentEvent:i,eventIndex:e.length,link:i.link,completed:!0},Object.assign(this.tutorialData,n),this.updateOnDataChange(this.tutorialData),this.saveTutorialData(this.tutorialData),this.clearMarker(i),this.hideModal(),this.setCompletedMarker()}setCompletedMarker(){this.tutorialData&&(this.tutorialData.globalKey&&this.setKeyAsCounter(this.tutorialData.globalKey),!this.tutorialData.globalKey&&this._tutorialLevels&&this._tutorialLevels.length&&this._tutorialLevels[this._playerLevel-1]&&this.setKeyAsCounter(this._tutorialLevels[this._playerLevel-1].levelKey?this._tutorialLevels[this._playerLevel-1].levelKey:""))}setKeyAsCounter(t){if(t&&this.tutorialTotalKeys.includes(t)){let e=this.tutorialTotalKeys.indexOf(t),i=this.cache.getCounter("ui.mark.chain");this.cache.setCounter("ui.mark.chain",i?i|1<<e:1<<e)}}checkSavedCounter(){let t="";if(this._global?t=this._globalKey:this._tutorialLevels&&this._tutorialLevels.length&&this._tutorialLevels[this._playerLevel-1]&&(t=this._tutorialLevels[this._playerLevel-1].levelKey?this._tutorialLevels[this._playerLevel-1].levelKey:""),t&&this.tutorialTotalKeys.includes(t)){let e=this.tutorialTotalKeys.indexOf(t),i=this.cache.getCounter("ui.mark.chain");this.counterExist=!!(i&1<<e)}}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(nd),o.Vb(Ys))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})();const xd=/campaigns\/(?<campaignId>.*?)\/missions\/(?<missionId>.*?)(?:\/|\?)/,Bd=/multiplayer\/(?<multiplayerMode>.*?)(?:\/|\?)/,jd=/campaigns\/(?<campaignId>.*?)\//;let Md=(()=>{class t{constructor(e,i){if(this.cache=e,this.router=i,this.onLocationChange=new o.o,t.instance)return t.instance;this.cache.team.pipe(We(t=>null!==t)).subscribe(t=>{this.onTeamGet(t)}),nd.authenticationService.onMessage.subscribe(t=>{if(t&&t.extCode&&"onTeamChange"===t.extCode){let e=t.data.info;e&&e.location&&wu(()=>{this.processLocation(e.location,t.data)},200,"team_process_location")}}),t.instance=this}onTeamGet(t){console.log(">>>>>>>>>>>>>>>>>>.",t),t&&t.info&&t.info.location&&this.processLocation(t.info.location,t)}setLocation(t){console.warn("new location set: ",t),this.requestSetLocation(t)}processLocation(t,e){if(this.location=t,this.teamData=e,void 0===t)return;if(this.onLocationChange.next(this.location),null===t)return;if(this.cache.isTeamOwner())return;let i=this.getRouteParams();wu(()=>{if(t.multiplayer&&t.multiplayer!=i.multiplayerMode)this.cache.redirect(["multiplayer",t.multiplayer]);else if(t.node){let e=this.cache.getCampaign(t.campaign),n=e.progress.node[t.node];"conquest"!==e.category||n.open?n.map==i.missionId&&t.campaign===i.campaignId||this.cache.redirect(["campaigns",t.campaign,"missions",n.map]):this.cache.redirect(["campaigns",t.campaign,"missions"])}else if(t.campaign){if(this.router.url.match(new RegExp("campaigns/"+t.campaign,"gim")))return;this.cache.redirect(["campaigns"]),setTimeout(()=>{this.cache.redirect(["campaigns",t.campaign,"detail","missions"])})}},1,"user_redirect_leader")}redirectToCurrentLocation(){this.processLocation(this.location,this.teamData)}requestSetLocation(t){nd.gameSparks.sendWithData("LogEventRequest",{eventKey:"teamGameSetInfo",team:this.cache.getUserTeamId(),info:{location:t}},t=>{t.error&&(Object(Pc.a)("<[x] teamGameSetInfo (leader) fail:",t.error),Gc.notificatorService.push({response:t.error,parameters:""})),t.error||Object(Pc.a)("<- teamGameSetInfo (leader) success")})}removeCampaignNode(){this.location&&this.location.node&&(delete this.location.node,this.setLocation(this.location))}removeMultiplayer(){this.location&&this.location.multiplayer&&this.setLocation(null)}getRouteParams(){let t=new RegExp(xd,"gim").exec(this.router.url)||new RegExp(jd,"gim").exec(this.router.url),e=new RegExp(Bd,"gim").exec(this.router.url),i={};return Object.assign(i,t?t.groups:{}),Object.assign(i,e?e.groups:{}),i}getLocationFromRouteParams(t){let e=null;if("main"===t.multiplayerMode&&(t.multiplayerMode=null),t.multiplayerMode)e={multiplayer:t.multiplayerMode};else if(t.campaignId&&(e={campaign:t.campaignId},t.missionId)){let i=this.cache.getCampaign(t.campaignId);for(let n in i.progress.node)i.progress.node[n].map===t.missionId&&(e.node=n)}return e}resetLocation(){this.teamData=null,this.location=null,this.onLocationChange.next(this.location)}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(nd),o.Vb(Ys))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})();const Qd=["%cChatService%c: <= firendsList \u2714","font-weight: bold;","font-weight: normal;"],Ad="METAGAME_CHAT_",Dd="METAGAME_TEAM_",Ed="METAGAME_LOBBY_",Nd="METAGAME_LOBBY_CHAT_",Fd="METAGAME_PLAYER_LEVEL";let Pd=(()=>{class t{constructor(e,i,n,s,a,r){if(this.notificatorService=e,this.authenticationService=i,this.cache=n,this.lobbyService=s,this.router=a,this.redirectService=r,this.messageLifeTime=864e5,this.userId="",this._messages=localStorage.getItem(Ad+this.userId)?JSON.parse(localStorage.getItem(Ad+this.userId)):{},this.loaded=new Nc,this.globalMessages=new Nc,this._globalMessages=[],this.requestFriendAddSuccess=new Nc,this._requestFriendAddSuccess=!1,this.friendRemoved=new Nc,this._friendRemoved=!1,this._chatsRawData=[],this._chats=[],this.chats=new ke(null),this.teamsData=new ke(null),this._teamsData=null,this.userMessages=new ke(null),this.requestedTeam=null,this.teamOwner={},this.userIsTeamOwner=!1,this.systemMessage={},this.teamCreated=!1,this.groupChatExist=!1,this.teamSystemChat={},this.hqChatExist=!1,this.lobbyId="",this.lobbyCreated=!1,this.savedLobbyTeam="",this.savedlobbyData=null,this._loadedFriendsList={},this.matchStarted=!1,this.onTeamCreate=new o.o,this.onTeamInvite=new o.o,this.onTeamJoin=new o.o,this.onTeamChange=new o.o,this.onTeamLeave=new o.o,this.onTeamLoad=new o.o,this._teamInvitation=null,this.localizator=new al,this.informator=new dl,this._tutorialService=new Td(null,null),this.friendRequestIn=new ke(null),this._friendRequestIn=null,this._playerLevel=0,this.globalEvent=new uu,this.difficultiesString=[],this.openedChatId="",this.fetch=Gc.Fetch,t.instance)return t.instance;t.instance=this,this.localizator.data.subscribe(t=>this.L=t),this.informator.data.subscribe(t=>this.I=t),this.userId=this.cache.getUserId(),this.difficultiesString=this.cache.getDifficultiesString(),this.systemMessage={team:{player:{leave:this.L("meta.ui.chat.system.team.player_leave"),leader:this.L("meta.ui.chat.system.team.leader_changed"),accepted:this.L("meta.ui.chat.system.team_new_accepted"),requested:this.L("meta.ui.chat.system.team_new_requested"),member:this.L("meta.ui.chat.system.team.new_player_add")},user:{join:this.L("meta.ui.chat.system.team.joined"),leader:this.L("meta.ui.chat.system.team.player_is_leader")}},custom:{player:{join:this.L("meta.ui.chat.system.lobby.player_join"),leave:this.L("meta.ui.chat.system.lobby.player_leave"),change:this.L("meta.ui.chat.system.lobby.player_slot_change"),team:{change:this.L("meta.ui.chat.system.lobby.player_team_change")}},user:{join:this.L("meta.ui.chat.system.lobby.joined"),leave:this.L("meta.ui.chat.system.lobby.leave"),change:this.L("meta.ui.chat.system.lobby.slot_change"),team:{change:this.L("meta.ui.chat.system.lobby.user_team_change"),join:this.L("meta.ui.chat.system.lobby.user_team_join")}}},gm:{player:{join:this.L("meta.ui.chat.system.tournament.player_join"),leave:this.L("meta.ui.chat.system.tournament.player_leave"),change:this.L("meta.ui.chat.system.tournament.player_slot_change"),team:{change:this.L("meta.ui.chat.system.tournament.player_team_change")}},user:{join:this.L("meta.ui.chat.system.tournament.joined"),change:this.L("meta.ui.chat.system.tournament.slot_change"),team:{change:this.L("meta.ui.chat.system.tournament.user_team_change"),join:this.L("meta.ui.chat.system.tournament.user_team_join")}}}},this.onMessageSubscription=this.authenticationService.onMessage.subscribe(t=>{t.error||!t||this.cache.isMatching||this.handleOnMessageSubscription(t),setTimeout(()=>{this.cache.isMatching&&(this.matchStarted=!0)})}),this.fetchFriendsList().then(()=>{if(this.LogMessage(Qd),this.fetchMessages(),this.computeMessages(),this.loadGlobalMessages(),this.setTeamsOwner(),this.getTeamFromStorage(),this.cache.isTraining&&this.cache.getUserTeamId()){let t={operation:"leave",player:this.cache.getUserId(),team:this.cache.getUserTeamId()};this.teamOperation(t)}this.loaded.next(this._chats)}),this.onPlayerLevelSubscription=this.cache.playerLevel.subscribe(t=>{this._playerLevel=this.getSavedPlayerLevel(),this._playerLevel!=t&&(this._playerLevel=t,localStorage.setItem(Fd+"_"+this.userId,JSON.stringify(t)))}),this.cache.friendsCacheIsEmpty()||this.cache.getFriendsAndChatCachedMessages().forEach(t=>{"onChat"==t.extCode?this.putMessageToChat(t.data,t.data.from.type,!1):"onTeamInvite"==t.extCode&&(this.requestedTeam=t.data.team,this._teamInvitation=t.data,this.onTeamInvite.next(this._teamInvitation)),this.getLastMessage(t.data,t.extCode)})}ngOnDestroy(){this.onTutorialStepChange&&this.onTutorialStepChange.unsubscribe()}alertFriendsData(t){if(this.cache.alert("friends_data_start"),dl.information.input_filter){let e=JSON.stringify({friendData:t}),i=Math.ceil(e.length/Gu);for(let t=0;t<i;t++)this.cache.alert("friends_data_part:"+e.slice(t*Gu,(t+1)*Gu),!1)}this.cache.alert("friends_data_end")}LogMessage(t){console.log.apply(null,t)}handleOnMessageSubscription(t){switch((t=JSON.parse(JSON.stringify(t))).extCode){case"onChat":t&&t.data&&t.data.from&&!this.checkIfMuted(t.data.from.id)&&(this.putMessageToChat(t.data,t.data.from.type,!1),this.cache.alertSound("ui_pm"));break;case"onPlayerRelationChange":if(this.updateFriendData(t.data.id,{update:t.data}),t.data.relation==Ud.None)return;break;case"onTeamInvite":this.requestedTeam=t.data,this._teamInvitation=t.data,this.onTeamInvite.next(this._teamInvitation);break;case"onTeamJoin":this.cache.devMode&&console.log(t,t.extCode),this.setTeamData(t.data.team).then(()=>{this.teamCreated=!0,this.saveTeam()}),this.onTeamJoin.next(t.data),this.onTeamJoin.next(null);break;case"onTeamChange":this.cache.devMode&&console.log(t,t.extCode),this.updateOnTeamChange(t.data),this.onTeamChange.next(t.data),this.onTeamChange.next(null);break;case"onTeamLeave":if(!t.data||!t.data.team)return;this.removeSavedTeam(t.data.team),this.onTeamLeave.next(t.data),this.onTeamLeave.next(null);break;case"onLobbyChange":if(!t.data&&t.data.lobby)return;this.lobbyCreated?this.updateLobbyData(t.data.lobby):(this.saveLobby(t.data.lobby.id),this.appendLobbyChatToGeneral(t.data.lobby.id));break;case"onLobbyLeave":if(!t.data&&t.data.lobby)return;this.removeSavedLobby(t.data.lobby,!0);break;case"onDlcApply":if(!t.data.dlc)return;this.sendMessageToHQChat(this.L("meta.shop.item.dlc_"+t.data.dlc+".subtitle").markdown({list:{prefix:"\u2014"}}).br(),this.L("meta.shop.item.dlc_"+t.data.dlc+".desc").markdown({list:{prefix:"\u2014"}}).br(),"dlc_"+(new Date).getTime(),{src:"logo",logo:!0},null,null);break;case"onLeagueChanged":if(!t.data.id)return;this.sendMessageToHQChat(this.L("meta.ui.league.message.title"),this.L("meta.ui.league."+t.data.id+".name"),"league_"+(new Date).getTime(),{league:t.data.id},null,null)}}checkIfMuted(t){let e=!1,i=this._chats.find(e=>e.id==t),n=(new Date).getTime();return i&&i.muteExpires&&new Date(i.muteExpires).getTime()>n&&(e=!0),e}setTeamData(t){return new Promise((e,i)=>{this._teamsData="string"==typeof t?{id:t}:t})}loadGlobalMessages(){let t=[];for(let e in this._messages)if(this._messages[e].length)for(let i=0;i<this._messages[e].length;i++){let n=this._messages[e][i];n.id=e,t.push(n)}this._globalMessages=t,this.globalMessages.next(this._globalMessages)}getMessagesCount(){return this._globalMessages.length}getUnreadedMessagesCount(){return this._globalMessages.filter(t=>t.id!==Ud.System&&!1!==t.showInGlobal).filter(t=>!t.readed).length}getUnreadedHQNotificationCount(){return this._globalMessages.filter(t=>t.id==Ud.System).filter(t=>!t.readed).length}getTeamDataFromStorage(){return localStorage.getItem(Dd+this.userId)}getLastMessage(t,e){t&&("onChat"==e&&t.from&&this._globalMessages.push(this.createGlobalMessage(!t.global||t.global,t.from.id,t.from.displayName,t.text,t.chat?t.chat.type:zd.System,null)),this.globalMessages.next(this._globalMessages))}createGlobalMessage(t,e,i,n,s,a){let r={};return r={id:e,displayName:i,type:s,text:n,key:a,showInGlobal:t},r}updateFriendData(t,e){if(!e||!e.update)return;let i=e.update;i.id=t;let n={};this._loadedFriendsList&&this._loadedFriendsList[t]?Object.assign(this._loadedFriendsList[t],i):this._loadedFriendsList[t]=e.update,n={[t]:this._loadedFriendsList[t]},e.update.relation&&e.update.relation==Ud.RequestIn&&(this._friendRequestIn=e.update,this.cache.alertSound("ui_invite_arrived"),this.friendRequestIn.next(this._friendRequestIn)),e.update.relation&&e.update.relation==Ud.Friend&&this.cache.alertSound("ui_invite_accepted"),this.computeFriends(i),this.alertFriendsData(n)}getUserMessages(t){return this._messages&&this._messages[t]?this._messages[t]:[]}messageSend(t,e,i,n){let s=null;if(e&&t&&n){switch(n){case Ud.Friend:s=this.fetch(pl.FriendChat.patch({player:e,text:t}),null,!0),s.subscribe(n=>{(n.scriptData||n.scriptData.result)&&n.scriptData.result.sent&&1==n.scriptData.result.sent&&(this.putMessageToChat(this.convertToMessage(!0,t,e,i,zd.Private),zd.Private,!1,!0),this.cache.alertSound("ui_message_sent"))});break;case Ud.Group:s=this.fetch(pl.TeamChat.patch({team:e,text:t}),null,!0);break;case zd.Lobby:s=this.fetch(pl.LobbyChat.patch({lobby:e,text:t}),null,!0);break;case zd.LobbyCustom:s=this.fetch(pl.LobbySideChat.patch({lobby:e,text:t}),null,!0)}return s}}convertToMessage(t,e,i,n,s,a){let r={};return r={from:{id:i,displayName:n},chat:{type:s,team:s&&s==zd.Team?i:"",side:a,lobby:i},text:e,date:(new Date).getTime(),global:t},r}putMessageToChat(t,e,i,n){if(!t||!t.chat||!t.from)return;let s="";if(t.chat.type&&t.chat.type==zd.Private?s=t.from.id:t.chat.type&&t.chat.type==zd.Team&&t.chat.team?s=t.chat.team:t.chat.type&&t.chat.type==zd.Lobby&&t.chat.lobby&&(s=t.chat.side?t.chat.lobby+"_"+t.chat.side:t.chat.lobby),!s)return;n=n||t.from.id==this.cache.getUserId(),this._messages[s]||(this._messages[s]=[]);let a=t.from?t.from.displayName:t.displayName,r=t.chat&&t.chat.side?t.chat.side:"",o=t.from&&t.from.id?t.from.id:null,c=!(!t.from||!t.from.id)&&this.checkIfUserIsAFriend(o),l=t.global;if(this.userIsMuted(o))return;let u=this.getOpenedChatId();function d(t,e,i,n){return!!t||e===zd.System||!(!n||!n.length||n!==i)}let h={displayName:a,originalText:t.text,text:i?t.text:this.escapeCussWords(t.text),time:(new Date).getTime(),self:n,type:e,readed:d(n,e,s,u),messageText:e,side:r,groupKey:this.setGroupKey(t,s),isFriend:c};this._messages[s].push(h),this.computeMessages(s,h),this.save(),d(n,e,s,u)||(this._globalMessages.push(this.createGlobalMessage(l,s,a,t.text,e,null)),this.globalMessages.next(this._globalMessages))}setGroupKey(t,e){let i=0;if(t.chat.type&&t.chat.type==zd.Team&&t.from.id!=t.chat.team&&this.getTeamMembers().length)return i=this.getTeamMembers().findIndex(e=>e.id==t.from.id)+1,i;if(t.chat.type&&t.chat.type==zd.Lobby){let e=this.lobbyService.getLobbyTeam();return i=this.lobbyService.lobbyGetTeam(e).findIndex(e=>e.id==t.from.id)+1,i}return i}userIsMuted(t){let e=!1,i=this._chatsRawData.find(e=>e.id==t),n=(new Date).getTime();return i&&i.muteExpires&&i.muteExpires>n&&(e=!0),e}clearChatStorage(t){this._messages[t]&&this._messages[t].length>0&&(delete this._messages[t],this.save())}save(){localStorage.setItem(Ad+this.userId,JSON.stringify(this._messages))}saveTeam(){localStorage.setItem(Dd+this.userId,JSON.stringify(this.teamCreated))}clearSystemMessages(){for(let t in this._messages)this._messages[t]&&this._messages[t].length&&this._messages[t].map(e=>{if(e.type==zd.System||e.type==zd.TeamRequest){let i=this._messages[t].indexOf(e);this._messages[t].splice(i,1)}})}friendRemoveSubcription(){this._friendRemoved=!0,this.friendRemoved.next(this._friendRemoved),setTimeout(()=>{this._friendRemoved=!1,this.friendRemoved.next(this._friendRemoved)},1050)}computeFriends(t){if(!t)return;let e=this._chatsRawData.find(e=>e.id===t.id);if(t.id!=this.cache.getUserId()){if(e){if(t.relation==Ud.None){this.markAsReaded(t.id),this.clearChatStorage(t.id);let i=this._chatsRawData.findIndex(t=>t===e);this._chatsRawData.splice(i,1),this.friendRemoveSubcription()}else{Object.assign(e,t);for(let i in e)t.hasOwnProperty(i)||"muteExpires"!=i||delete e[i];"ban"==t.relation&&this.friendRemoveSubcription()}if(!e.isGroup&&!e.relation){let t=this._chatsRawData.findIndex(t=>t===e);this._chatsRawData.splice(t,1)}}else this._chatsRawData.push(t);this.chats.next({chats:null,friend:t,messages:null}),this.chats.next(null)}}getFriends(){return this._chatsRawData}getFriendsByRelation(t){if(!this._chats||!this._chats.length)return[];let e=[];return this._chats.filter(i=>{i.relation==t&&e.push(i)}),e}getFriendsById(t){return this._chats&&this._chats.length?this._chats.find(e=>e.id==t):[]}checkIfUserIsAFriend(t){let e=!0,i=this.getFriendsByRelation("friend");return e=!!i.find(e=>e.id==t),!!i.length&&e}getLastFriendMessage(t,e){if(!t||!e||!e.length)return;let i=[];return t.messages&&t.messages.length&&(i=t.messages),i.concat(e),i}computeMessages(t,e){if(!this._chatsRawData||!this._chatsRawData.length)return;let i=e||null;if(t){if(t){let e=this._chatsRawData.find(e=>e.id==t);e&&(this.applyMessages(e),this.userMessages.next({friend:e,messages:e.messages,lastMessage:i}),this.userMessages.next(null))}}else this._chats=[],this._chatsRawData.map(t=>{let e=JSON.parse(JSON.stringify(t));this.applyMessages(e),this._chats.push(e)}),this.chats.next({chats:this._chats,friend:null,messages:null}),this.chats.next(null)}getMessages(){return this._messages}applyMessages(t){t&&t.id&&this._messages&&(t.messages=this._messages[t.id]||[],t.messages.length&&(t.messages.map(e=>{(new Date).getTime()-e.time>this.messageLifeTime&&this.clearChatStorage(t.id)}),t.unreaded=this.findUnreadedMessages(t.id,t.messages)))}friendAdd(t){t&&this.requestFriendAdd(t).subscribe(e=>{e.scriptData&&(this.updateFriendData(t,e.scriptData),this._requestFriendAddSuccess=!0,this.requestFriendAddSuccess.next(this._requestFriendAddSuccess),setTimeout(()=>{this._requestFriendAddSuccess=!1,this.requestFriendAddSuccess.next(this._requestFriendAddSuccess)},1050))},e=>{Object(Pc.a)("<- add friend error",t)})}friendRemove(t){t&&this.requestFriendRemove(t).subscribe(e=>{e.scriptData&&(this.clearChatStorage(t),this.updateFriendData(t,e.scriptData),Object(Pc.a)("<- remove friend success",t))},e=>{Object(Pc.a)("<- remove friend error",t)})}friendBan(t){t&&this.requestFriendBan(t).subscribe(e=>{e.scriptData&&(this.clearChatStorage(t),this.updateFriendData(t,e.scriptData),Object(Pc.a)("<- ban friend success",t))},e=>{Object(Pc.a)("<- ban friend error",t)})}friendUnban(t){t&&this.requestFriendUnban(t).subscribe(e=>{e.scriptData&&(this.updateFriendData(t,e.scriptData),Object(Pc.a)("<- unban friend success",t))},e=>{Object(Pc.a)("<- unban friend error",t)})}friendMute(t,e){if(t)return this.requestFriendMute(t,e)}friendUnmute(t){if(t)return this.requestFriendUnmute(t)}fetchFriendsList(){return new Promise((t,e)=>{this.fetch(pl.FriendList,null,!0).subscribe(e=>{if(e.scriptData&&e.scriptData.list&&0!==e.scriptData.list.length){this._loadedFriendsList=e.scriptData.list;for(let t in e.scriptData.list){let i=e.scriptData.list[t];i.id=t,this._chatsRawData.push(i)}this.alertFriendsData(this._loadedFriendsList)}else e.error&&this.notificatorService.push({response:e.error,parameters:""});this._chatsRawData.push(this.createHQChat()),t(null)})})}fetchMessages(){let t=localStorage.getItem(Ad+this.userId);t?(this._messages=this.clearOutdatedMessages(JSON.parse(t)),this.clearSystemMessages()):this._messages={}}clearOutdatedMessages(t){if(!this._chatsRawData||!this._chatsRawData.length)return;let e={};return Object.keys(t).forEach(e=>{!this._chatsRawData.find(t=>t.id==e)&&e&&delete t[e]}),e=t,e}findUnreadedMessages(t,e){let i=[];return i=e.filter(t=>{if(0==t.readed)return t}),i.length}markAsReaded(t){this._messages[t]&&(this._messages[t].map(t=>{t.readed=!0}),this._globalMessages.map(e=>{e.id==t&&(e.readed=!0)}),this.globalMessages.next(this._globalMessages),this.save())}clearMessages(t){this._messages[t]&&(this.markAsReaded(t),this._messages[t]=[],this.save())}saveChangedNotification(t,e,i){let n=this._chats.find(t=>t.id==Ud.System);n&&n.messages&&n.messages.length&&(n.messages[t]=Object.assign(n.messages[t],i));let s=this._globalMessages.find(t=>t.key&&t.key==e);s=Object.assign(s,i);let a=this._messages[zd.System].find(t=>t.key==e);a=Object.assign(a,i),this.chats.next({chats:null,friend:n,messages:null}),this.chats.next(null),this.globalMessages.next(this._globalMessages),this.save()}requestFriendAdd(t){return this.fetch(pl.FriendOperation.patch({player:t,operation:"add"}),null,!0)}requestFriendRemove(t){return this.fetch(pl.FriendOperation.patch({player:t,operation:"delete"}),null,!0)}requestFriendBan(t){return this.fetch(pl.FriendOperation.patch({player:t,operation:"ban"}),null,!0)}requestFriendUnban(t){return this.fetch(pl.FriendOperation.patch({player:t,operation:"unban"}),null,!0)}requestFriendMute(t,e){if(!t||!e)return;let i=this.getMuteTime(e);this.fetch(pl.FriendOperation.patch({player:t,operation:"mute",time:i}),null,!0).subscribe(e=>{e.scriptData&&this.updateFriendData(t,e.scriptData)},i=>{Object(Pc.a)("<- mute friend error",t,e)})}getMuteTime(t){return{hour:(new Date).getTime()+36e5,day:(new Date).getTime()+864e5,week:(new Date).getTime()+6048e5,year:(new Date).getTime()+314496e5,forever:(new Date).getTime()+314496e7}[t]}requestFriendUnmute(t){t&&this.fetch(pl.FriendOperation.patch({player:t,operation:"unmute"}),null,!0).subscribe(e=>{e.scriptData&&(e.scriptData.update.muteExpires=null,this.updateFriendData(t,e.scriptData))},e=>{Object(Pc.a)("<- unmute friend error",t)})}friendSetOnlineMode(t){t&&this.fetch(pl.FriendSetOnlineMode.patch({mode:t}),null,!0).subscribe(e=>{this.cache.setOnlineStatus(t)})}teamOperation(t){return new Promise((e,i)=>{t?this.teamOperationRequest(t).subscribe(i=>{Object(Pc.a)("<[\u2713] team "+t.operation+" operation success",i),e(null)},e=>{"leave"==t.operation&&this._teamsData&&this.removeSavedTeam(this._teamsData.id)}):console.warn(`No requestData found for [${t}]`)})}teamCreate(t){t?this.teamCreateRequest(t).subscribe(t=>{if(t&&t.scriptData&&t.scriptData.team){let e=t.scriptData.team;this.saveCreatedTeam(e),this.updateTeamMembersData(null,e),this.onTeamCreate.next(e),this.onTeamCreate.next(null)}},t=>{Object(Pc.a)("<[x] team teamCreate error",t)}):console.warn(`No user found for [${t}]`)}teamOperationRequest(t){return new Nc,this.fetch({requestKey:bl.TeamOperation,options:t},null,!0)}teamCreateRequest(t){let e=this.redirectService.getRouteParams(),i=this.redirectService.getLocationFromRouteParams(e),n=[];return n.push(t),this.fetch({requestKey:bl.TeamCreate,options:{invited:n,info:i?{location:i}:null}},null,!0)}saveCreatedTeam(t){this.teamCreated=!0,this.saveTeam(),this._teamsData=t,this.updateOnTeamChange(t),this.teamsData.next(this._teamsData),this.teamsData.next(null)}teamDelete(t){let e=new Nc;return this.fetch({requestKey:bl.TeamDelete,options:{team:t}},null,!0).subscribe(t=>{this.teamsData.next(this._teamsData),this.teamsData.next(null),e.next(t)},t=>{Object(Pc.a)("<[x] team delete on login error",t)}),e}teamGet(t){let e=new Nc;return this.fetch({requestKey:bl.TeamGet,options:{team:t}},null,!0).subscribe(t=>{this._teamsData=t.scriptData.team,t.error&&Object(Pc.a)("<[x] teamGet on login error",t.error),e.next(t)},t=>{Object(Pc.a)("<[x] teamGet error",t)}),e}getCurrentTeam(){let t={};return t=this.teamGet(this._teamsData.id),t}updateOnTeamChange(t){let e=t.team?t.team:t;this.updateTeamMembersData(this._teamsData,e),this._teamsData=e,this.cache.setUserTeam(this._teamsData),t&&t.game&&t.game.option&&t.game.option.difficulty&&this.setDifficulty(t.game.option.difficulty),this.teamsData.next(this._teamsData),this.teamsData.next(null)}updateTeamMembersData(t,e){if(!e)return;let i=e.members,n=t?t.members:null;if(this.groupChatExist||(this.triggerGlobalEvent("team_owner_update",{owner:e.owner,case:"onTeamJoin"}),this.appendTeamChatToGeneral()),n){t&&t.owner!=e.owner&&this.triggerGlobalEvent("team_owner_update",{owner:e.owner,case:"onTeamChangeLeader"});for(let t in i)n[t]?n[t]&&n[t].state!=i[t].state&&this.updateTeamMemberStatus(i[t],t):this.setNewTeamMember(i[t],t);for(let t in n)i[t]||(this.removeTeamMember(n[t],t),this.cache.alertSound("ui_team_leave"))}else for(let s in i)this.setNewTeamMember(i[s],s),this.cache.alertSound("ui_team_join");this.save()}setNewTeamMember(t,e){let i=null;i=Object.assign({},t),i=this.updateFriend(i,{id:e,isGroup:!0});let n="",s=e==this.userId?"user":"player";n=e==this.userId?this.systemMessage.team[s][t.state]:t.displayName+" "+this.systemMessage.team[s][t.state],n&&this.teamSystemMessageSend(n),i&&this.computeFriends(i)}updateTeamMemberStatus(t,e){let i=null;i=Object.assign({},t),i=this.updateFriend(i,{id:e,state:t.state});let n="",s=e==this.userId?"user":"player";n=e==this.userId?this.systemMessage.team[s][t.state]:t.displayName+" "+this.systemMessage.team[s][t.state],n&&this.teamSystemMessageSend(n),i&&this.computeFriends(i)}removeTeamMember(t,e){let i=this.createTeamDataObj(e,!1,qd.None,Jd.Meta,null),n=null;n=Object.assign({},t),n=this.updateFriend(n,i);let s="";s=t.displayName+" "+this.systemMessage.team.player.leave,s&&this.teamSystemMessageSend(s),n&&this.computeFriends(n)}createTeamDataObj(t,e,i,n,s){return{id:t,state:i,isGroup:e,game:{state:n,team:s}}}getTeamFromStorage(){this.cache.getUserTeamId()||Object(Pc.a)("<- User is not in the team",this.cache.getUserTeamId()),this.cache.getUserTeamId()&&this.teamGet(this.cache.getUserTeamId()).subscribe(t=>{this._teamsData=t.scriptData.team;let e=this._teamsData.members[this.cache.getUserId()];if(this._teamsData.members&&e&&e.state==qd.Requested)return!1;this.teamCreated=!0,this.updateTeamMembersData(null,this._teamsData),this.saveTeam();for(let i in this._teamsData.members)this.cache.getUserId()==i&&this._teamsData.members[i].ready&&this.cache.setReadyToFight(!0);this.teamCreated&&this.cache.getUserTeamId()&&this.cache.setUserTeam(t.scriptData.team),this.teamsData.next(this._teamsData),this.teamsData.next(null),this.onTeamLoad.next(this._teamsData),this.onTeamLoad.next(null)})}appendTeamChatToGeneral(){this._teamsData&&(this.teamSystemChat=this.createTeamChat(),this.computeFriends(this.teamSystemChat),!this.groupChatExist&&this.teamSystemChat&&this.teamSystemMessageSend(this.systemMessage.team.user.join),this.groupChatExist=!0)}teamSystemMessageSend(t){if(!t||!t.length||!this.teamSystemChat)return;let e=this.convertToMessage(!0,t,this.teamSystemChat.id,this.teamSystemChat.displayName,zd.Team);this.putMessageToChat(e,zd.System,!0)}lobbyTeamSystemMessageSend(t,e,i){if(!(t&&t.length&&e&&i))return;let n=this.convertToMessage(!1,t,e,this.L(i==Al.Unbound?"meta.ui.lobby.custom.reserve":"meta.ui.lobby."+i),zd.Lobby,i);this.putMessageToChat(n,zd.System,!0)}lobbySystemMessageSend(t,e,i){if(!t||!t.length||!e)return;let n=this.convertToMessage(!1,t,e,this.L("meta.ui.play."+i+".title"),zd.Lobby);this.putMessageToChat(n,zd.System,!0)}createTeamChat(){if(this._teamsData&&this._teamsData.id)return{relation:"group",id:this._teamsData.id,isGroup:!0,type:"team",displayName:this.L("meta.ui.team.title")}}createHQChat(){if(this.hqChatExist)return;let t={relation:Ud.System,id:"system",isGroup:!1,type:zd.System,displayName:this.L("meta.ui.chat.notifications")};return this.hqChatExist=!0,t}setTeamsOwner(){this.teamCreated&&this._teamsData&&(this.userIsTeamOwner=this._teamsData.id==this.cache.getUserId())}removeSavedTeam(t){if(t){if(this.markAsReaded(t),this.clearChatStorage(t),this.computeFriends({id:t,relation:Ud.None,isGroup:!1}),this._teamsData&&this._teamsData.members)for(let t in this._teamsData.members){let e=this.createTeamDataObj(t,!1,qd.Empty,Jd.Meta,null);this.computeFriends(e)}this.cache.setUserTeam(null),this._teamsData=null,this._teamInvitation=null,this.teamCreated=!1,this.teamSystemChat=null,this.saveTeam(),this.groupChatExist=!1,this.userIsTeamOwner=!1,this.redirectService.resetLocation(),this.triggerGlobalEvent("team_owner_update",{owner:null,case:"onTeamLeave"}),this.teamsData.next({leave:!0}),this.teamsData.next(null),this.onTeamInvite.next(this._teamInvitation)}}sendMessageToHQChat(t,e,i,n,s,a){let r=JSON.parse(localStorage.getItem(Ad+this.userId));if(r&&r[zd.System]&&r[zd.System].find(t=>t.key===i))return!1;let o={from:{id:zd.System,displayName:this.L("meta.ui.chat.notifications")},chat:{type:zd.Private},text:e,title:t,key:i,date:(new Date).getTime(),icon:n,readed:!1,accept:s,decline:a,callBackApplied:null};this._messages[zd.System]&&this._messages[zd.System].length||(this._messages[zd.System]=[]),this._messages[zd.System].push(o),this.computeMessages(zd.System,o),this.save(),this._globalMessages.push(this.createGlobalMessage(!0,zd.System,zd.System,e,zd.System,i)),this.globalMessages.next(this._globalMessages)}getHQMessages(){return this._messages[zd.System]}convertToPremiumMessage(t){if(!t||!t.premium)return"";let e="",i="";if(t.premium.active){let n=t.premium.expiresAt?new Date(t.premium.expiresAt.$date).toLocaleString(this.localizator.getLocale()):null;e=this.L("meta.ui.store.purchase_message.premium"),i=n?this.L("meta.ui.store.premium_active_time")+` <b class="color-primary">${n}</b>`:""}else e=this.L("meta.ui.store.premium_deactivated.title"),i=this.L("meta.ui.store.premium_deactivated.message");return{title:e,text:i}}removeSavedLobby(t,e){if(!t)return;let i=this.lobbyService.lobbyGetData();this.clearAllLobbyChatsMessages(t),i&&this.clearLobbyFriendStatus(i),this.savedLobbyTeam="",this.savedlobbyData=null,this.lobbyCreated=!1,this.saveSavedLobbyStatus(!1),this.saveLobby(""),this.sendMessageToHQChat(this.L("meta.ui.menu.multiplayer.lobby"),this.L(this.systemMessage.custom.user.leave),"leave_lobby_"+(new Date).getTime(),null,null,null)}clearAllLobbyChatsMessages(t){this.markAsReaded(t),this.clearChatStorage(t),this.computeFriends({id:t,relation:Ud.None,isGroup:!1,isLobby:!1}),this.markAsReaded(t+"_"+this.savedLobbyTeam),this.clearChatStorage(t+"_"+this.savedLobbyTeam),this.computeFriends({id:t+"_"+this.savedLobbyTeam,relation:Ud.None,isGroup:!1,isLobby:!1})}clearLobbyFriendStatus(t){if(t&&t.members)for(let e in t.members)this.computeFriends({id:e,isLobby:!1,game:{state:Jd.Meta,lobby:null}})}getSavedLobbyId(){return JSON.parse(localStorage.getItem(Ed+this.userId))}getSavedLobbyStatus(){return JSON.parse(localStorage.getItem(Nd+this.userId))}saveSavedLobbyStatus(t){localStorage.setItem(Nd+this.userId,JSON.stringify(t))}saveLobby(t){this.lobbyId=t,localStorage.setItem(Ed+this.userId,JSON.stringify(t))}createGeneralLobbyChat(t){let e=this.lobbyService.lobbyGetData(),i={};return i={id:t,relation:Ud.Group,isGroup:!0,type:zd.Lobby,side:"",displayName:this.L(e&&e.type&&e.type==zd.LobbyCustom?"meta.ui.play.custom.title":"meta.ui.play.lobby.title")},i}createTeamLobbyChat(t,e){let i={};return i={id:t,relation:Ud.Group,isGroup:!0,type:zd.LobbyCustom,side:this.savedLobbyTeam,displayName:this.L("none"==e?"meta.ui.lobby.custom.reserve":"meta.ui.lobby."+this.savedLobbyTeam+".title")},i}appendLobbyChatToGeneral(t){if(!t)return;let e=(this.savedlobbyData=this.lobbyService.lobbyGetData()).type,i=this.createGeneralLobbyChat(t);this.computeFriends(i),this.savedLobbyTeam=this.lobbyService.getLobbyTeam();let n=this.createTeamLobbyChat(t+"_"+this.savedLobbyTeam,this.savedLobbyTeam);this.computeFriends(n),this.lobbySystemMessageSend(this.systemMessage[e].user.join,t,e),this.lobbyTeamSystemMessageSend(this.systemMessage[e].user.team.join,t,this.savedLobbyTeam),this.saveSavedLobbyStatus(!0),this.lobbyCreated=!0}updateLobbyData(t){if(!t)return;let e=this.lobbyService.getLobbyTeam(),i=t.id,n=t.type;if(this.savedLobbyTeam&&this.savedLobbyTeam!=e&&i==this.lobbyId){this.markAsReaded(this.lobbyId+"_"+this.savedLobbyTeam),this.computeFriends({id:this.lobbyId+"_"+this.savedLobbyTeam,relation:Ud.None,isGroup:!1,isLobby:!1}),this.savedLobbyTeam=e;let t=this.createTeamLobbyChat(i+"_"+this.savedLobbyTeam,this.savedLobbyTeam);this.computeFriends(t),this.lobbyTeamSystemMessageSend(this.systemMessage[n].user.team.change,i,this.savedLobbyTeam)}else i!==this.lobbyId&&(this.clearAllLobbyChatsMessages(this.lobbyId),this.lobbyId=i,this.appendLobbyChatToGeneral(i));this.lobbyMembersUpdate(t)}lobbyMembersUpdate(t){if(!t)return;let e=t.type,i=this.savedlobbyData&&this.savedlobbyData.members?this.savedlobbyData.members:null,n=t.members;for(let s in n)if((i[s]&&i[s].state==Vd.Invited||!i[s])&&n[s].state==Vd.Member)this.lobbySystemMessageSend(n[s].displayName+" "+this.systemMessage[e].player.join,t.id,e);else if(i[s]&&n[s].slot!==i[s].slot){let i="";i=s==this.userId?this.systemMessage[e].user.change:n[s].displayName+" "+this.systemMessage[e].player.change,this.lobbySystemMessageSend(i,t.id,e)}for(let s in i)i[s]&&!n[s]&&this.lobbySystemMessageSend(i[s].displayName+" "+this.systemMessage[e].player.leave,t.id,e);this.savedlobbyData=t}updateLobbyMember(t,e,i){let n=i?zd.Lobby:zd.Tournament,s={isLobby:t&&t.members.hasOwnProperty(e.id),game:{state:t&&t.members.hasOwnProperty(e.id)?n:"",lobby:t}};e=this.updateFriend(e,s),this.computeFriends(e)}clearLobbyMember(t,e,i){e=this.updateFriend(e,{isLobby:!1,game:{state:Jd.Meta,lobby:null}}),this.computeFriends(e)}updateFriend(t,e){for(let i in e)t[i]=e[i];return t}getMessagesFromStorage(t){if(!t||!this._messages)return;let e=[];return this._messages.hasOwnProperty(t)&&(e=this._messages[t]),e}searchFriends(t){return this.fetch(pl.FriendSearch.patch({name:t=t}))}escapeCussWords(t){let e=t.slice();(this.I("words.alternatives").push?this.I("words.alternatives"):[]).map(t=>{e=e.replace(new RegExp(`[${t}]`,"gm"),t[0])}),(this.I("words.obscene").push?this.I("words.obscene"):[]).map(t=>{(this.I("words.alternatives").push?this.I("words.alternatives"):[]).map(e=>{t=t.slice().replace(new RegExp(`[${e}]`,"gm"),e[0])});let i=t.split(",")[0],n=t.split(",")[1]||null;e.match(new RegExp(""+i,"gm"))&&(e=e.replace(new RegExp(""+i,"gm"),(t,i)=>((t,i)=>{let s=[...e.matchAll(new RegExp(""+n,"gm"))];if(!s)return!1;for(let e=0;e<s.length;e++){let n=s[e];if(n.index<=i&&n.index+n[0].length>=i+t.length)return!0}return!1})(t,i)?t:"*".repeat(t.length)))});for(let i=0;i<e.length;i++)"*"!==e.charAt(i)&&(e=e.replaceAt(i,t.charAt(i)));return e}redirectIfNotTeamLeader(t){if(this.cache.isTeamOwner()||!t)return;if(t.owner&&t.members[t.owner]&&0==t.members[t.owner].ready)return;let e=t.game&&t.game.mode?t.game.mode:"";if(!e)return;let i=this.router.url.split("/");i.shift(),i[i.length-1]=i[i.length-1].split("?")[0],wu(()=>{"coop"==e&&i.indexOf(t.game.option.map)<0?(this.cache.redirect(["campaigns",t.game.option.campaign.template,"missions",t.game.option.map]),this.cache.devMode&&console.log("[campaigns/redirect]",t.game.option.campaign.template)):"coop"!==e&&i.indexOf(e)<0&&(this.cache.redirect(["multiplayer",e]),this.cache.devMode&&console.log("[multiplayer/redirect]",e))},500,"user_redirect_leader")}redirectIfTutorialCampaign(){JSON.parse(JSON.stringify(this.router.url)).match(/tutorial/gim)&&(this.cache.isTeamOwner()?this.cache.redirect(["campaigns"]):this.cache.redirect(["multiplayer"]))}setDifficulty(t){if(!this.difficultiesString.length)return;let e=this.difficultiesString.indexOf(t);e>=0&&this.cache.setDifficulty(e)}getTeamMembers(){let t=[],e=this._teamsData&&this._teamsData.members?this._teamsData.members:null;if(e)for(let i in e){let n=Object.assign({},e[i]);n.id=i,t.push(n)}return t}getTeamData(){return this._teamsData?this._teamsData:null}getSavedPlayerLevel(){return JSON.parse(localStorage.getItem(Fd+"_"+this.userId))}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}setOpenedChatId(t){this.openedChatId=t}getOpenedChatId(){return this.openedChatId}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(Uc),o.Vb(Gc),o.Vb(nd),o.Vb(Bl),o.Vb(Ys),o.Vb(Md))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})();var Ud=function(t){return t.Friend="friend",t.RequestIn="request_in",t.RequestOut="request_out",t.Ban="ban",t.Group="group",t.None="none",t.System="system",t}({}),zd=function(t){return t.Team="team",t.Lobby="lobby",t.Tournament="gm",t.LobbyCustom="custom",t.System="system",t.Private="private",t.TeamRequest="team_request",t}({}),Jd=function(t){return t.Team="team",t.Lobby="lobby",t.Meta="meta",t}({}),qd=function(t){return t.Accepted="accepted",t.Requested="requested",t.Member="member",t.Leader="leader",t.None="none",t.Empty="",t}({}),Vd=function(t){return t.Invited="invited",t.Member="member",t.None="none",t}({});const $d=JSON.stringify;let Gd=(()=>{class t{constructor(){this.state=Gl.NONE,this.connectRequested=!1,this.log=new o.o,this.timer=null}insertGameSparks(t){this.gameSparks=t}Clear(){this.canConnect=!1,this.connectRequested=!1,this.matchId="",this.state=Gl.NONE,this.progress=0,this.serverNode=""}OnOpenOk(t){this.matchId=t,this.state=Gl.WAITING,this.log.emit(["meta.ui.match.log.on_open_ok"])}Cancel(t){let e=new Nc;return t&&(this.matchId=t),this.matchId?(this.matchCancel().subscribe(t=>{e.next(t)},t=>{e.error(t)}),this.Clear(),this.state=Gl.CANCELLING):(this.Clear(),setTimeout(()=>{e.next({})},50)),e}CancelAnyway(t){let e=new Nc;return this.matchCancelAnyway().subscribe(t=>{e.next(t)},t=>{e.error(t)}),this.Clear(),this.state=Gl.CANCELLING,e}OnCancel(t){this.log.emit(t?["meta.ui.match.log.on_cancel_ok"]:["meta.ui.match.log.on_cancel_not_ok"]),this.Clear()}OnLoginInfo(t){this.log.emit(["meta.ui.match.log.on_login_info"]),this.matchId=t,this.GetInfo()}GetInfo(){this.matchId&&(this.log.emit(["meta.ui.match.log.get_info"]),this.matchGet(this.matchId,!0,!1))}OnMatchInfo(t){this.log.emit(["meta.ui.match.log.on_match_info"]),this.SetInfo(t),this.AutoConnect()}SetInfo(t){this.canConnect=t.canConnect,this.matchId=t.match,this.progress=t.progress,this.serverNode=t.node,console.log("info for getting state",t),this.state=this.getMatchState(t.state)}CanConnect(){return Boolean(this.canConnect&&this.serverNode)}Connect(){this.CanConnect()&&(this.log.emit(["meta.ui.match.log.connect"]),alert(`${$l.Connect}${this.serverNode}`))}TimeSinceRequested(){return this.timer?(Date.now()-this.timer.getTime())/1e3:0}AutoConnect(){this.CanConnect()&&this.Connect()}OnMatchOpened(t){this.log.emit(["meta.ui.match.log.on_match_opened"]),this.state=Gl.WAITING,this.matchId=t,this.matchGet(t,!0)}OnMatchContinue(){this.state=this.lastStateFromOnMessage}OnMatchUpdated(t){this.state!==Gl.CANCELLING&&(this.log.emit(["meta.ui.match.state."+t.state,{progress:t.progress||"0"}]),this.SetInfo(t),this.AutoConnect())}OnMatchClosed(t,e){this.Clear(),this.log.emit(["meta.ui.match.log.on_match_closed",{reason:e}])}OnServerClosed(t,e){this.log.emit(["meta.ui.match.log.on_server_closed",{reason:e}]),this.Clear()}OnError(t){this.log.emit(["meta.ui.match.log.on_error",{text:t}])}matchGet(t,e,i){"local"!==t?(Object(Pc.a)("-> matchGet",t),this.gameSparks.sendWithData("LogEventRequest",{eventKey:bl.MatchGet,match:t,option:{server:e||!1,card:i||!1}},t=>{t.error&&this.OnError($d(t.error)),t.scriptData&&this.OnMatchInfo(t.scriptData.match)})):Object(Pc.a)("--\x3e matchGet skipped because match is local")}matchCancel(){Object(Pc.a)("-> matchCancel",this.matchId);let t=new Nc;return this.gameSparks.sendWithData("LogEventRequest",{eventKey:bl.MatchCancel,match:this.matchId},e=>{e.error?(t.error(e.error),Object(Pc.a)("<[x] matchCancel error",e.error),this.OnError($d(e.error))):(t.next({}),Object(Pc.a)("<- matchCancel success"),this.OnCancel(!0))}),t}matchCancelAnyway(){Object(Pc.a)("-> matchCancelAnyway");let t=new Nc;return this.gameSparks.sendWithData("LogEventRequest",{eventKey:bl.MatchCancelAnyway},e=>{e.error?(this.lastStateFromOnMessage=this.state,t.error(e.error),Object(Pc.a)("<[x] matchCancelAnyway error",e.error),this.OnError($d(e.error))):(t.next({}),Object(Pc.a)("<- matchCancelAnyway success"),this.OnCancel(!0))}),t}matchOpen(t,e){this.gameSparks.sendWithData("LogEventRequest",{eventKey:bl.MatchOpen,players:t,card:e},t=>{if(t.error)return this.OnError($d(t.error));t.scriptData&&this.OnOpenOk(t.scriptData.match)})}OnSoloMatchStarting(t){this.Clear(),t?(this.log.emit(["meta.ui.match.log.on_solo_starting_ok"]),this.state=Gl.LOADING):this.log.emit(["meta.ui.match.log.on_solo_starting_not_ok"])}getMatchState(t){switch(t){case Yl.waiting:return Gl.WAITING;case Yl.loading:return Gl.LOADING;case Yl.ready:return Gl.READY;case Yl.running:return Gl.RUNNING;case Yl.ended:return Gl.ENDED;case Yl.closed:return Gl.NONE;case Yl.gamelifting:case Yl.requested:return Gl.REQUESTED;case Yl.local_requested:return Gl.LOCAL_REQUESTED}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})();const Hd=JSON.stringify;let Yd=(()=>{class t{constructor(){this.log=new o.o,this.state=Hl.IDLE}insertGameSparks(t){this.gameSparks=t}Clear(){this.state=Hl.IDLE,this.Timers(!1)}TimeSinceRequest(){return this.requestStartTime?(Date.now()-this.requestStartTime.getTime())/1e3:0}CanStartRequest(){return this.state!==Hl.REQUEST_ISSUED}Request(t){return this.CanStartRequest()?(this.log.emit(["meta.ui.match.log.request",{mode:t.mode,difficulty:t.option.difficulty}]),this.state=Hl.REQUEST_ISSUED,this.Timers(!0),t.team?this.mmRequestTeam():this.mmRequest(t)):new Nc}CanCancel(){return this.state!==Hl.IDLE}Cancel(){this.CanCancel()&&(this.log.emit(["meta.ui.match.log.cancel"]),this.mmCancel(),this.Clear())}onTimeout(t){this.timeout=setTimeout(()=>{this.OnTimer(),clearTimeout(this.timeout)},t)}Timers(t){t?(this.requestStartTime=new Date,this.onTimeout(5e3)):(this.requestStartTime=null,this.timeout&&clearTimeout(this.timeout))}OnTimer(){this.state===Hl.REQUEST_ISSUED&&(this.log.emit(["meta.ui.match.log.on_timer"]),this.Clear())}OnRequest(t){t?(this.log.emit(["meta.ui.match.log.on_request_ok"]),this.state=Hl.REQUEST_RUNNING):(this.log.emit(["meta.ui.match.log.on_request_not_ok"]),this.Clear())}OnTeamRequest(){Object(Pc.a)("<- onTeamRequest"),this.state=Hl.REQUEST_RUNNING,this.Timers(!0)}OnMatchFound(){this.log.emit(["meta.ui.match.log.on_match_found"]),this.Clear()}OnMatchNotFound(){this.log.emit(["meta.ui.match.log.on_match_not_found"]),this.Clear()}OnMatchUpdated(t){const e=[];if(Array.isArray(t)){for(let i=0;i<t.length;i++)e.push(t[i].displayName);this.log.emit(["meta.ui.match.log.on_mm_updated_ok",{players:e.join(),length:t.length}])}else this.log.emit(["meta.ui.match.log.on_mm_updated_not_ok"])}OnSoloMatchStarting(){this.Clear()}OnError(t){this.log.emit(["meta.ui.match.log.on_mm_error",{text:t}])}teamGameSetOptions(t){t=this.dropEmptyOptions(t),Object(Pc.a)("-> teamGameSetOptions (leader)",t);let e=new Nc;return this.gameSparks.sendWithData("LogEventRequest",{eventKey:"teamGameSetOptions",mode:t.mode,commander:t.commander,option:t.option,team:t.team},t=>{t.error&&(Object(Pc.a)("<[x] teamGameSetOptions (leader) fail:",t.error),Gc.notificatorService.push({response:t.error,parameters:""}),e.error(t)),t.error||(Object(Pc.a)("<- teamGameSetOptions (leader) success"),e.next(t))}),e}teamGameSetCommander(t){t=this.dropEmptyOptions(t),Object(Pc.a)("-> teamGameSetCommander",t);let e=new Nc;return this.gameSparks.sendWithData("LogEventRequest",{eventKey:"teamGameSetCommander",commander:t.commander,team:t.team},t=>{t.error&&(Object(Pc.a)("<[x] teamGameSetCommander fail:",t.error),Gc.notificatorService.push({response:t.error,parameters:""}),e.error(t)),t.error||(Object(Pc.a)("<- teamGameSetCommander success"),e.next(t))}),e}teamGameReady(t,e){Object(Pc.a)("-> teamGameReady",t,e);let i=new Nc;return this.gameSparks.sendWithData("LogEventRequest",{eventKey:"teamGameReady",team:t,ready:e?1:0},n=>{n.error&&(Object(Pc.a)("<[x] teamGameReady fail:",n.error),Gc.notificatorService.push({response:n.error,parameters:""}),i.error(n)),n.error||(Object(Pc.a)("<- teamGameReady success",t,e),i.next(n))}),i}mmRequest(t){let e=new Nc;return Object(Pc.a)("-> mmRequest",t),this.gameSparks.sendWithData("LogEventRequest",{eventKey:bl.mmRequest,mode:t.mode,commander:t.commander,option:t.option},t=>{t.error?(Object(Pc.a)("<[x] mmRequest","fail: "+JSON.stringify(t.error)),Gc.notificatorService.push({response:t.error,parameters:""}),this.OnRequest(!1),this.OnError(Hd(t.error)),e.error(t.error)):(Object(Pc.a)("<- mmRequest","success"),this.OnRequest(!0),e.next(t.scriptData))}),e}mmRequestTeam(){let t=new Nc;return Object(Pc.a)("-> mmRequestTeam"),this.gameSparks.sendWithData("LogEventRequest",{eventKey:"mmRequestTeam"},e=>{e.error?(Object(Pc.a)("<[x] mmRequestTeam","fail: "+JSON.stringify(e.error)),Gc.notificatorService.push({response:e.error,parameters:""}),this.OnRequest(!1),this.OnError(Hd(e.error)),t.error(e.error)):(Object(Pc.a)("<- mmRequestTeam","success"),this.OnRequest(!0),t.next(e.scriptData))}),t}mmCancel(){Object(Pc.a)("-> mmCancel..."),this.gameSparks.sendWithData("LogEventRequest",{eventKey:bl.mmCancel},t=>{Object(Pc.a)("<- mmCancel","success")})}dropEmptyOptions(t){let e={commander:{template:t.commander.template}};if(t.commander.id&&(e.commander.id=t.commander.id),t.mode&&(e.mode=t.mode),t.team&&(e.team=t.team),t.option){e.option={};for(let i in t.option)t.option[i]&&(e.option[i]=t.option[i])}return e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})();const Wd=[{url:"/summary",key:"profile.summary"},{url:"/preferences",key:"profile.preferences"},{url:"/sessions",key:"profile.battles"},{url:"/achievements",key:"profile.achievements"},{url:"/troops/units",key:"profile.troops"},{url:"/rating",key:"profile.rating"},{url:"/leagues",key:"profile.league"},{url:"/technology",key:"tech"},{url:"/play/pvp",key:"pvp.help"},{url:"/play/pve",key:"pve.help"},{url:"/troops/",key:"troops.route"},{url:"/echelons",key:"slots.help"},{url:"/play/custom",key:"custom.help"},{url:"/play/lobby",key:"play.lobby.tutorial"},{url:"/tasks/this_day",key:"task_this_day.help"},{url:"/tasks/this_week",key:"task_this_week.help"},{url:"/tasks/special",key:"task_special.help"},{url:"/tasks/trial",key:"task_trial.help"},{url:"/tasks/challenges",key:"task_trial.help"},{url:"/tasks/commander",key:"task_commander.help"},{url:"/editor",key:"editor.help"},{url:"/play/campaigns",key:"campaign.start"},{url:"/missions",key:"play.campaign.missions.help",campaign:!0},{url:"/troops",key:"campaign.troops",campaign:!0},{url:"/tasks",key:"play.campaign.tasks",campaign:!0},{url:"/technology",key:"play.campaign.tech.help",campaign:!0},{url:"/play/campaigns/tutorial_rus",key:"level1.campaign.detail",campaign:!0}];let Kd=(()=>{class t{constructor(e,i){if(this.cache=e,this.router=i,this.globalEvent=new uu,this.helpId="",this.globalCampaign=null,this.campaignLinks=[],this.multiLinks=[],t.instance)return t.instance;t.instance=this,Object(Pc.a)("INIT :: HelpService"),this.setLinksData()}setLinksData(){Wd&&Wd.length&&(this.campaignLinks=Wd.filter(t=>t.campaign),this.multiLinks=Wd.filter(t=>!t.campaign))}openWindow(t,e){t.stopPropagation(),t.stopImmediatePropagation(),this.helpId=e||"",this.globalEvent.trigger("help.open",{})}closeWindow(){this.helpId="",this.globalEvent.trigger("help.close",{})}getHelp(){let t=this.router.url.toString(),e=[];if(this.globalCampaign=this.cache.getGlobalCampaign(),e=this.globalCampaign&&this.globalCampaign.id&&this.globalCampaign.id.length?this.campaignLinks:this.multiLinks,this.helpId)return{key:this.helpId};for(let i=0;i<e.length;i++)if(e[i]&&e[i].url&&t.match(new RegExp(e[i].url,"gim")))return e[i];return null}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(nd),o.Vb(Ys))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})();const Xd="METAGAME_MESSAGE_OF_THE_DAY";let Zd=(()=>{class t{constructor(t){this.cache=t,this.active=!0,this.index=0,this._messages=[];let e=[],i=al.languages[al.selectedLanguage].hint.data;for(let n in i)n.toString().match(/message_of_the_day/gim)&&e.push(n);this._messages=e,this.index=parseInt(localStorage.getItem(Xd)||"0"),this.index>=this._messages.length&&(this.index=0,localStorage.setItem(Xd,this.index.toString()))}getMessagesKeys(){return this._messages}next(){this.index=this.index>=this._messages.length?0:++this.index,localStorage.setItem(Xd,this.index.toString())}}return t.\u0275fac=function(e){return new(e||t)(o.Vb(nd))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac}),t})();const th=["openModal"];function eh(t,e){if(1&t&&(o.Rb(0,"article"),o.Ob(1,"p",8),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("innerHTML",t.L("meta.ui.error."+t.responseCode).markdown().br(),o.Ac)}}function ih(t,e){if(1&t&&(o.Rb(0,"article"),o.Ob(1,"p",8),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("innerHTML",t.L("meta.ui.error.error_title").markdown().br(),o.Ac)}}function nh(t,e){if(1&t&&(o.Rb(0,"li"),o.Lc(1),o.cc(2,"json"),o.Qb()),2&t){const t=e.$implicit;o.Bb(1),o.Nc(" ",o.dc(2,1,t).markdown()," ")}}function sh(t,e){if(1&t&&(o.Rb(0,"ul",9),o.Jc(1,nh,3,3,"li",10),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("ngForOf",t.responseValues)}}const ah=function(){return["/troops"]};function rh(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",11),o.Rb(1,"a",12),o.Yb("click",function(){return o.zc(t),o.bc(2).closeMatch()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.Bb(1),o.kc("tooltip-hint",t.L("meta.ui.play.echelon_edit")),o.jc("routerLink",o.mc(5,ah))("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.play.button_edit")),o.Bb(1),o.Nc(" ",t.L("meta.ui.play.button_edit")," ")}}function oh(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",11),o.Rb(1,"a",12),o.Yb("click",function(){return o.zc(t),o.bc(2).closeMatch()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.Bb(1),o.kc("tooltip-hint",t.L("meta.hint.menu.troops")),o.jc("routerLink",o.mc(5,ah))("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.menu.troops")),o.Bb(1),o.Nc(" ",t.L("meta.ui.menu.troops")," ")}}function ch(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",11),o.Rb(1,"button",13),o.Yb("click",function(){return o.zc(t),o.bc(2).reloadPage()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.Bb(1),o.kc("tooltip-hint",t.L("meta.ui.match.reload_server")),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.match.reload_server")),o.Bb(1),o.Nc(" ",t.L("meta.ui.match.reload_server")," ")}}function lh(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",11),o.Rb(1,"button",14),o.Yb("click",function(){return o.zc(t),o.bc(2).exitGame()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.Bb(1),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.button_exit")),o.Bb(1),o.Nc(" ",t.L("meta.ui.button_exit")," ")}}function uh(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",11),o.Rb(1,"button",14),o.Yb("click",function(){return o.zc(t),o.bc(2).notification.decline.callback()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.Bb(1),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui."+t.notification.decline.key)),o.Bb(1),o.Nc(" ",t.L("meta.ui."+t.notification.decline.key)," ")}}function dh(t,e){if(1&t){const t=o.Sb();o.Rb(0,"modal",1,2),o.Yb("onClose",function(){return o.zc(t),o.bc().clearData()}),o.Rb(2,"div",3),o.Jc(3,eh,2,1,"article",4),o.Jc(4,ih,2,1,"article",4),o.Jc(5,sh,2,1,"ul",5),o.Rb(6,"ul",6),o.Jc(7,rh,3,6,"li",7),o.Jc(8,oh,3,6,"li",7),o.Jc(9,ch,3,4,"li",7),o.Jc(10,lh,3,3,"li",7),o.Jc(11,uh,3,3,"li",7),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.jc("header",t.L("meta.ui.error.attention"))("id","notificator")("nonClosing",t.notification.exit)("ignoreBackgroundClick",t.notification.exit)("icon","warning")("error",!0),o.Bb(3),o.jc("ngIf",t.responseCode),o.Bb(1),o.jc("ngIf",!t.responseCode),o.Bb(1),o.jc("ngIf",t.cache.hasFlag("debug")&&t.responseValues.length),o.Bb(2),o.jc("ngIf","echelon_empty"==t.responseCode||"echelon_filling"==t.responseCode),o.Bb(1),o.jc("ngIf","commander_empty"==t.responseCode),o.Bb(1),o.jc("ngIf",t.notification.reload||"bad_cache"==t.responseCode||!t.responseCode),o.Bb(1),o.jc("ngIf",t.notification.exit),o.Bb(1),o.jc("ngIf",t.notification.decline)}}let hh=(()=>{class t{constructor(t,e,i,n){this.matchService=t,this.matchMakingService=e,this.authenticationService=i,this.cache=n,this.goToEdit=new o.o,this.onOpen=new o.o,this.onClose=new o.o,this.notification=null,this.parameters="",this.responseCode="",this.responseValues=[],this.globalEvent=new uu,(new al).data.subscribe(t=>this.L=t),this.notificatorService=new Uc,this.notificatorService.notifications.subscribe(t=>{t&&t.response&&(this.notification=t,t.parameters&&(this.parameters=t.parameters),this.responseCode=this.setResponseCode(t.response),this.responseValues=this.setResponseValues(t.response),this.responseCode&&this.showModal())})}ngOnDestroy(){this.clearData()}setResponseCode(t){let e="";for(let i in t)t[i].dcode&&(e=t[i].dcode);return e}setResponseValues(t){let e=[],i=null;for(let n in t)t[n].value&&(i=t[n].value);if(i)for(let n in i){let t={};t[n]=i[n],e.push(t)}return e}clearData(){this.notification=null,this.responseValues=[],this.responseCode="",this.parameters=""}closeMatch(){this.goToEdit.emit(null),this.matchService.Cancel(),this.matchMakingService.Cancel(),this.goToEdit.emit(null),this.openModal.close()}reloadPage(){window.location.reload()}showModal(){setTimeout(()=>{this.openModal&&(this.cache.alertSound("ui_modal_error"),this.openModal.open(null,!0))})}exitGame(){this.globalEvent.trigger("exit_game")}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Gd),o.Nb(Yd),o.Nb(Gc),o.Nb(nd))},t.\u0275cmp=o.Hb({type:t,selectors:[["notificator"]],viewQuery:function(t,e){if(1&t&&o.Qc(th,!0),2&t){let t;o.vc(t=o.Zb())&&(e.openModal=t.first)}},outputs:{goToEdit:"goToEdit",onOpen:"onOpen",onClose:"onClose"},features:[o.Ab([Gd,Yd,nd])],decls:1,vars:1,consts:[["class","full",3,"header","id","nonClosing","ignoreBackgroundClick","icon","error","onClose",4,"ngIf"],[1,"full",3,"header","id","nonClosing","ignoreBackgroundClick","icon","error","onClose"],["openModal",""],[1,"body","align-center","collapsed-top"],[4,"ngIf"],["class","clear spaced-top",4,"ngIf"],[1,"clear","buttons-list","spaced-top"],["class","list-item",4,"ngIf"],[3,"innerHTML"],[1,"clear","spaced-top"],[4,"ngFor","ngForOf"],[1,"list-item"],["href","","routerLinkActive","active","queryParamsHandling","merge",1,"button",3,"tooltip-hint","routerLink","alertSound","click"],[1,"button","large",3,"tooltip-hint","alertSound","click"],[1,"button","transparent",3,"alertSound","click"]],template:function(t,e){1&t&&o.Jc(0,dh,12,14,"modal",0),2&t&&o.jc("ngIf",e.notification)},encapsulation:2}),t})();const bh=["input"];let mh=(()=>{class t{constructor(){this.min=1,this.max=10,this.value=1,this.step=1,this.onChange=new o.o,this.onReset=new o.o,this.pressed=0,this.activeMinus=!1,this.activePlus=!1;let t=this;window.CALCULATOR_MOUSEUP||(window.CALCULATOR_MOUSEUP={callbacks:[],onMouseUp:t=>{window.CALCULATOR_MOUSEUP.callbacks.push(t)}},document.addEventListener("mouseup",e=>{for(let i=0;i<window.CALCULATOR_MOUSEUP.callbacks.length;i++)window.CALCULATOR_MOUSEUP.callbacks[i].call(t,e)})),window.CALCULATOR_MOUSEUP.onMouseUp(t=>{this.handleMouseUp(t)}),this.focused=!1,(new al).data.subscribe(t=>this.L=t)}onMousewheel(t){Math.max(-1,Math.min(1,t.wheelDelta||-t.detail))>0?(this.activePlus=!0,this.value<this.max&&this.setValue(this.value+this.step),wu(()=>{this.activePlus=!1},550,"")):(this.activeMinus=!0,this.value>this.min&&this.setValue(this.value-this.step),wu(()=>{this.activeMinus=!1},550,""))}ngOnChanges(t){t.hasOwnProperty("max")&&t.max.currentValue<this.value&&this.setValue(t.max.currentValue),t.hasOwnProperty("min")&&t.min.currentValue<this.value&&this.setValue(t.min.currentValue)}stopScroll(){}setValue(t,e=!1){(t=(t=t?parseInt(t):0)>this.max?this.max:t<this.min?this.min:t)!=this.value&&(this.value=t,this.onChange.emit(this)),e&&(this.input.nativeElement.value=t)}onInput(t){let e=t.target.value.replace(/^0|\D/gim,"");e.toString().length>=this.getMaxLength()&&(e=this.max,t.target.value=e),t.target.value===e?this.setValue(e):this.setValue(e,!0)}getValue(){return this.value}reset(){this.value=this.min,this.onReset.emit(this)}decrease(){this.value>this.min&&this.setValue(this.value-this.step),0===this.pressed&&(this.leftSideTimeout=setTimeout(()=>{this.pressed=-1,this.runChangingLoop()},500))}increase(){this.value<this.max&&this.setValue(this.value+this.step),0===this.pressed&&(this.rightSideTimeout=setTimeout(()=>{this.pressed=1,this.runChangingLoop()},500))}getMaxLength(){return this.max?this.max.toString().length+1:0}checkEmpty(t){""===t.target.value&&(this.input&&(this.input.nativeElement.value=this.min),this.setValue(this.min))}onKeyDown(t){}handleMouseUp(t){this.pressed=0,clearTimeout(this.leftSideTimeout),clearTimeout(this.rightSideTimeout)}runChangingLoop(){0!==this.pressed&&(this.pressed<0&&this.decrease(),this.pressed>0&&this.increase(),requestAnimationFrame(this.runChangingLoop.bind(this)))}onFocus(t){this.focused=!0}onBlur(t){this.focused=!1,t&&this.checkEmpty(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Hb({type:t,selectors:[["calculator"]],viewQuery:function(t,e){if(1&t&&o.Fc(bh,!0),2&t){let t;o.vc(t=o.Zb())&&(e.input=t.first)}},hostVars:4,hostBindings:function(t,e){1&t&&o.Yb("mousewheel",function(t){return e.onMousewheel(t)}),2&t&&o.Fb("max",e.value>=e.max)("min",e.value>=e.min)},inputs:{min:"min",max:"max",value:"value",step:"step"},outputs:{onChange:"onChange",onReset:"onReset"},features:[o.zb],decls:6,vars:8,consts:[["type","text",3,"value","focus","blur","input"],["input",""],["type","button",1,"plus",3,"alertSound","mousedown"],["src","assets/img/icons/svg/round_plus.svg","alt",""],["type","button",1,"minus",3,"alertSound","mousedown"],["src","assets/img/icons/svg/round_minus.svg","alt",""]],template:function(t,e){1&t&&(o.Rb(0,"input",0,1),o.Yb("focus",function(t){return e.onFocus(t)})("blur",function(t){return e.onBlur(t)})("input",function(t){return e.onInput(t)}),o.Qb(),o.Rb(2,"button",2),o.Yb("mousedown",function(){return e.increase()}),o.Ob(3,"img",3),o.Qb(),o.Rb(4,"button",4),o.Yb("mousedown",function(){return e.decrease()}),o.Ob(5,"img",5),o.Qb()),2&t&&(o.jc("value",e.value),o.Cb("maxlength",e.getMaxLength()),o.Bb(2),o.Fb("active",e.activePlus),o.jc("alertSound","ui_click_default"),o.Bb(2),o.Fb("active",e.activeMinus),o.jc("alertSound","ui_click_default"))},encapsulation:2}),t})();const ph=["scrollableContent"],gh=["scrollableContentWrapper"],fh=["scrollbarVertical"],vh=["scrollbarHorizontal"];function yh(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",11,12),o.Yb("mousedown",function(){return o.zc(t),o.bc(2).movePrev()}),o.Ob(2,"span",13),o.Qb()}if(2&t){const t=o.bc(2);o.Fb("disabled",t.noMorePrev)}}function _h(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",14,15),o.Yb("mousedown",function(){return o.zc(t),o.bc(2).moveNext()}),o.Ob(2,"span",16),o.Qb()}if(2&t){const t=o.bc(2);o.Fb("disabled",t.noMoreNext)}}function kh(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",6,7),o.Rb(2,"div",8),o.Yb("mousedown",function(e){return o.zc(t),o.bc().bindDraggind(e)}),o.Qb(),o.Jc(3,yh,3,2,"button",9),o.Jc(4,_h,3,2,"button",10),o.Qb()}if(2&t){const t=o.bc();o.Ic("height",t.height?t.height:""),o.Fb("active",t.activeY)("shifted",t.shiftScrollbar),o.Cb("data-origin",t.origin),o.Bb(2),o.Ic("height",100*t.thumbSize.y+"%")("top",t.thumbTop+"%"),o.Bb(1),o.jc("ngIf",t.options.buttons),o.Bb(1),o.jc("ngIf",t.options.buttons)}}function wh(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",11,12),o.Yb("mousedown",function(){return o.zc(t),o.bc(2).movePrev()}),o.Ob(2,"span",20),o.Qb()}if(2&t){const t=o.bc(2);o.Fb("disabled",t.noMorePrev)}}function Sh(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",14,15),o.Yb("mousedown",function(){return o.zc(t),o.bc(2).moveNext()}),o.Ob(2,"span",21),o.Qb()}if(2&t){const t=o.bc(2);o.Fb("disabled",t.noMoreNext)}}function Ih(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",17,18),o.Rb(2,"div",19),o.Yb("mousedown",function(e){return o.zc(t),o.bc().bindDraggind(e)}),o.Qb(),o.Jc(3,wh,3,2,"button",9),o.Jc(4,Sh,3,2,"button",10),o.Qb()}if(2&t){const t=o.bc();o.Ic("width",t.width?t.width:""),o.Fb("active",t.activeX),o.Cb("data-origin",t.origin),o.Bb(2),o.Ic("width",100*t.thumbSize.x+"%")("left",t.thumbLeft+"%"),o.Bb(1),o.jc("ngIf",t.options.buttons),o.Bb(1),o.jc("ngIf",t.options.buttons)}}const Ch=["*"],Lh=150*(window.devicePixelRatio||1);let Rh=(()=>{class t{constructor(t,e){this.renderer=e,this.step=Lh,this.frames=20,this.easing="easeOutQuart",this.thumbSize=new yl(0),this.animationRunningY=!1,this.animationRunningX=!1,this.scrollFrom=new yl,this.scrollTarget=new yl,this.animationFrame=new yl,this.lastScroll=0,this.activeThumb=null,this.activeY=!1,this.activeX=!1,this.keys={},this.id=Math.randomInt(1e3,9999),this.origin="right",this.fade=!1,this.shiftScrollbar=!1,this.disableControls=!1,this.disabled=!1,this.contentBottom=!1,this.onScrollStart=new o.o,this.onScroll=new o.o,this.onScrollEnd=new o.o,this.onScrollEnded=new o.o,this.globalEvent=new uu,this.did=0,this.scroll={left:0,top:0,maxLeft:0,maxTop:0},this.options={orientation:"vertical",buttons:!1},this.host=t.nativeElement,this.isDragging=!1,this.dragStartOffset={left:0,top:0},this.thumbTop=0,this.scrollbarTop=0,this.thumbLeft=0,this.scrollbarLeft=0}static globalRender(e=!1){if(e&&t.isGlobalAnimationRunning)return;let i=t.instances.filter(t=>t.animationRunningX||t.animationRunningY);i.length?(t.isGlobalAnimationRunning=!0,i.map(t=>{t.animate()}),requestAnimationFrame(t.globalRender.bind(t,!1))):t.isGlobalAnimationRunning=!1}handleScrollTo(t){if(!t||!t.target.closest("a"))return;let e=t.target.closest(".alert-link");e&&alert("shell_open_web_browser:"+e.getAttribute("href")),t.stopImmediatePropagation(),t.preventDefault(),t.stopPropagation()}handleMouseWheel(e){if(!this.host)return;if(this.disabled)return;let i=e.deltaY>0?1:e.deltaY<0?-1:0;t.globalRender(!0),this.setRects(),this.update(),this.moveBy(this.step*i)}ngOnInit(){this.did=t.did,t.did++,t.instances.push(this),this.disabled&&(this.disableControls=!0),this._orientation&&(this.options.orientation=this._orientation),this._buttons&&(this.options.buttons=this._buttons),this.globalEventSubscription=this.globalEvent.subject.pipe(We(t=>null!==t)).subscribe(t=>{"scroll-to"===t.key&&this.scrollToMiddlePoint(t.data.selector)}),this.disableControls||(this.mousewheelHandler=this.renderer.listen(this.host,"mousewheel",t=>this.handleMouseWheel(t)),this.mouseupHandler=this.renderer.listen(document,"mouseup",t=>this.handleMouseUp(t)),this.keyDownSubscription=pd.onKeyDown.pipe(We(t=>null!==t)).subscribe(t=>{this.keys[t.key]=!0}),this.keyUpSubscription=pd.onKeyUp.pipe(We(t=>null!==t)).subscribe(t=>{this.keys[t.key]=!1}))}ngAfterContentChecked(){this.scrollableContent&&(this.content=this.scrollableContent.nativeElement,this.contentWrapper=this.scrollableContentWrapper.nativeElement,this.scrollbarElementVertical&&(this.scrollbarVertical=this.scrollbarElementVertical.nativeElement),this.scrollbarElementHorizontal&&(this.scrollbarHorizontal=this.scrollbarElementHorizontal.nativeElement),this.setRects(),this.update())}ngOnDestroy(){this.globalEventSubscription&&this.globalEventSubscription.unsubscribe(),this.mousewheelHandler&&this.mousewheelHandler(),this.mouseoutHandler&&this.mouseoutHandler(),this.mouseupHandler&&this.mouseupHandler(),this.keyDownSubscription&&this.keyDownSubscription.unsubscribe(),this.keyUpSubscription&&this.keyUpSubscription.unsubscribe();let e=t.instances.findIndex(t=>t.did===this.did);t.instances.splice(e,1),t.isGlobalAnimationRunning=!1}getSize(){return new yl(this.content.scrollWidth,this.content.scrollHeight)}setRects(){if(!this.content)return!1;this.scroll.maxTop=this.content.scrollHeight-this.content.clientHeight,this.scroll.maxLeft=this.content.scrollWidth-this.content.clientWidth,this.thumbSize.y=this.content.clientHeight/this.content.scrollHeight,this.thumbSize.x=this.content.clientWidth/this.content.scrollWidth,this.activeY=this.thumbSize.y<1,this.activeX=this.thumbSize.x<1,this.scroll.top=Math.clamp(this.scroll.top,0,this.scroll.maxTop),this.scroll.left=Math.clamp(this.scroll.left,0,this.scroll.maxLeft)}update(){this.host&&this.content&&(this.css3||this.content.scrollTo(this.scroll.left,this.scroll.top),this.css3&&(this.contentWrapper.style.transform=`translate(${-1*this.scroll.left}px, ${-1*this.scroll.top}px)`),this.thumbTop=this.scroll.top/this.scroll.maxTop*(100-100*this.thumbSize.y),this.scrollbarTop=this.scroll.top,this.thumbLeft=this.scroll.left/this.scroll.maxLeft*(100-100*this.thumbSize.x),this.scrollbarLeft=this.scroll.left,this.isVertical()?(this.noMorePrev=this.thumbTop<.001,this.noMoreNext=this.scroll.top/this.scroll.maxTop>.999):this.isHorizontal()&&(this.noMorePrev=this.thumbLeft<.001,this.noMoreNext=this.scroll.left/this.scroll.maxLeft>.999))}bindDraggind(t){if(this.disableControls)return;this.activeThumb=t.target,this.isDragging=!0,this.animationFrame.x=0,this.animationFrame.y=0,this.animationRunningX=!1,this.animationRunningY=!1;let e=t.target.getBoundingClientRect();this.dragStartOffset.top=t.clientY-e.top,this.dragStartOffset.left=t.clientX-e.left,this.mousemoveHandler=this.renderer.listen(document,"mousemove",t=>this.handleMouseMove(t))}unbindDragging(){this.mousemoveHandler&&this.mousemoveHandler(),this.isDragging=!1}handleMouseMove(t){if(!this.isDragging)return;if(this.disableControls)return;let e=(this.activeThumb.closest(".thumb-vertical")?this.scrollbarVertical:this.scrollbarHorizontal).getBoundingClientRect(),i=this.content.scrollHeight,n=Math.clamp(t.clientY-e.top-this.dragStartOffset.top,0,e.height),s=this.content.scrollWidth,a=Math.clamp(t.clientX-e.left-this.dragStartOffset.left,0,e.width);this.setRects(),"vertical"!==this.options.orientation&&"all"!==this.options.orientation||!this.activeThumb.closest(".thumb-vertical")?"horizontal"!==this.options.orientation&&"all"!==this.options.orientation||!this.activeThumb.closest(".thumb-horizontal")||(this.scroll.left=Math.clamp(a/e.width*s,0,this.scroll.maxLeft)):this.scroll.top=Math.clamp(n/e.height*i,0,this.scroll.maxTop),this.clone&&(this.clone.scroll.top=this.scroll.top,this.clone.update()),this.cloneHorizontal&&(this.cloneHorizontal.scroll.left=this.scroll.left,this.cloneHorizontal.update()),this.update(),this.onScroll.emit(this)}handleMouseOut(t){this.unbindDragging()}handleMouseUp(t){this.unbindDragging()}animate(t){let e=t?1:this.frames;this.isVerticalShift()?(this.scroll.top=Math.lerp(this.scrollFrom.y,this.scrollTarget.y,ld[this.easing](this.animationFrame.y/e)),this.animationFrame.y++,1===this.animationFrame.y&&this.onScrollStart.emit(this),this.animationFrame.y>1&&this.animationFrame.y<20&&this.onScroll.emit(this),this.animationFrame.y>e&&(this.animationRunningY=!1,this.onScrollEnd.emit(this)),this.isVeryBottomEnd()&&(this.onScrollEnd.emit(this),this.onScrollEnded.emit(this))):this.isHorizontalShift()&&(this.scroll.left=Math.lerp(this.scrollFrom.x,this.scrollTarget.x,ld[this.easing](this.animationFrame.x/e)),this.animationFrame.x++,1===this.animationFrame.x&&this.onScrollStart.emit(this),this.animationFrame.x>1&&this.animationFrame.x<20&&this.onScroll.emit(this),this.animationFrame.x>e&&(this.animationRunningX=!1,this.onScrollEnd.emit(this)),this.isVeryRightEnd()&&(this.onScrollEnd.emit(this),this.onScrollEnded.emit(this))),this.update()}moveBy(e,i,n){n&&(this.frames=n),this.isVerticalShift()?this.animationRunningY?(this.scrollFrom.y=this.scrollTarget.y,this.animationFrame.y=0,this.scrollTarget.y=Math.clamp(this.scrollTarget.y+e,0,this.scroll.maxTop),this.clone&&(this.clone.scrollFrom.y=this.scrollFrom.y,this.clone.animationFrame.y=this.animationFrame.y,this.clone.scrollTarget.y=this.scrollTarget.y)):(this.scrollFrom.y=this.scroll.top,this.animationRunningY=!0,this.animationFrame.y=0,this.scrollTarget.y=Math.clamp(this.scroll.top+e,0,this.scroll.maxTop),this.clone&&(this.clone.scrollFrom.y=this.scrollFrom.y,this.clone.animationRunningY=this.animationRunningY,this.clone.animationFrame.y=this.animationFrame.y,this.clone.scrollTarget.y=this.scrollTarget.y),t.globalRender(!0)):this.isHorizontalShift()&&(this.animationRunningX?(this.scrollFrom.x=this.scrollTarget.x,this.animationFrame.x=0,this.scrollTarget.x=Math.clamp(this.scrollTarget.x+e,0,this.scroll.maxLeft),this.cloneHorizontal&&(this.cloneHorizontal.scrollFrom.x=this.scrollFrom.x,this.cloneHorizontal.animationFrame.x=this.animationFrame.x,this.cloneHorizontal.scrollTarget.x=this.scrollTarget.x)):(this.scrollFrom.x=this.scroll.left,this.animationRunningX=!0,this.animationFrame.x=0,this.scrollTarget.x=Math.clamp(this.scroll.left+e,0,this.scroll.maxLeft),this.cloneHorizontal&&(this.cloneHorizontal.scrollFrom.x=this.scrollFrom.x,this.cloneHorizontal.animationRunningX=this.animationRunningX,this.cloneHorizontal.animationFrame.x=this.animationFrame.x,this.cloneHorizontal.scrollTarget.x=this.scrollTarget.x),t.globalRender(!0)))}isVertical(){return"vertical"===this.options.orientation||"all"===this.options.orientation}isVerticalShift(){return"vertical"===this.options.orientation||"all"===this.options.orientation&&!this.isShiftPressed()}isHorizontal(){return"horizontal"===this.options.orientation||"all"===this.options.orientation}isHorizontalShift(){return"horizontal"===this.options.orientation||"all"===this.options.orientation&&this.isShiftPressed()}isShiftPressed(){return!(!this.keys.shift&&!this.keys.Shift)}isVeryBottomEnd(){return!!this.content&&this.scroll.top+this.content.clientHeight>=this.content.scrollHeight}isVeryRightEnd(){return!!this.content&&this.scroll.left+this.content.clientWidth>=this.content.scrollWidth}movePrev(){this.moveBy(-this.step)}moveNext(){this.moveBy(this.step)}moveUp(){this.moveBy(-99999)}moveDown(){this.moveBy(99999)}moveUpImmediate(){this.moveBy(-99999,!0)}moveDownImmediate(){this.moveBy(99999,!0)}reset(){this.activeY=!1,this.activeX=!1,setTimeout(()=>{this.setRects(),this.scroll.top=0,this.scroll.left=0,this.update(),this.activeY=!0,this.activeX=!0},210)}scrollToMiddlePoint(t){let e=this.host.querySelector(t);if(!e)return;let i=gd(this.host.querySelector(t)),n=gd(this.host),s=this.host.getBoundingClientRect().height/2,a=e.getBoundingClientRect().height/2,r=this.host.getBoundingClientRect().width/2,o=e.getBoundingClientRect().width/2;this.isVertical()?this.moveBy(i.top-s+a-n.top-this.scroll.top):this.isHorizontal()&&this.moveBy(i.left-r-o-n.left-this.scroll.left)}constantScroll(t=1e4){console.log("constansScroll",t),this.moveBy(this.getSize().y,!1,t)}}return t.did=0,t.instances=[],t.isGlobalAnimationRunning=!1,t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m),o.Nb(o.H))},t.\u0275cmp=o.Hb({type:t,selectors:[["scrollable"]],viewQuery:function(t,e){if(1&t&&(o.Qc(ph,!0),o.Qc(gh,!0),o.Qc(fh,!0),o.Qc(vh,!0)),2&t){let t;o.vc(t=o.Zb())&&(e.scrollableContent=t.first),o.vc(t=o.Zb())&&(e.scrollableContentWrapper=t.first),o.vc(t=o.Zb())&&(e.scrollbarElementVertical=t.first),o.vc(t=o.Zb())&&(e.scrollbarElementHorizontal=t.first)}},hostVars:14,hostBindings:function(t,e){1&t&&o.Yb("click",function(t){return e.handleScrollTo(t)}),2&t&&o.Fb("has-buttons",e.options.buttons)("bbox",e.bbox)("horizontal","horizontal"===e.options.orientation)("vertical","vertical"===e.options.orientation)("frozen",e.animationRunning)("fade",e.fade)("disabled",e.disabled)},inputs:{step:"step",frames:"frames",easing:"easing",_orientation:["orientation","_orientation"],_buttons:["buttons","_buttons"],bbox:"bbox",css3:"css3",innerSpace:"innerSpace",innerSpaceVertical:"innerSpaceVertical",height:"height",origin:"origin",fade:"fade",shiftScrollbar:"shiftScrollbar",disableControls:"disableControls",disabled:"disabled",contentBottom:"contentBottom",clone:"clone",cloneHorizontal:"cloneHorizontal"},outputs:{onScrollStart:"onScrollStart",onScroll:"onScroll",onScrollEnd:"onScrollEnd",onScrollEnded:"onScrollEnded"},ngContentSelectors:Ch,decls:7,vars:8,consts:[[1,"scrollable-content"],["scrollableContent",""],[1,"content-wrapper"],["scrollableContentWrapper",""],["class","scrollbar",3,"active","height","shifted",4,"ngIf"],["class","scrollbar horizontal",3,"active","width",4,"ngIf"],[1,"scrollbar"],["scrollbarVertical",""],[1,"thumb","thumb-vertical",3,"mousedown"],["class","prev-btn",3,"disabled","mousedown",4,"ngIf"],["class","next-btn",3,"disabled","mousedown",4,"ngIf"],[1,"prev-btn",3,"mousedown"],["prev",""],[1,"chevron","up"],[1,"next-btn",3,"mousedown"],["next",""],[1,"chevron","down"],[1,"scrollbar","horizontal"],["scrollbarHorizontal",""],[1,"thumb","thumb-horizontal",3,"mousedown"],[1,"chevron","left"],[1,"chevron","right"]],template:function(t,e){1&t&&(o.ic(),o.Rb(0,"div",0,1),o.Rb(2,"div",2,3),o.hc(4),o.Qb(),o.Qb(),o.Jc(5,kh,5,13,"div",4),o.Jc(6,Ih,5,11,"div",5)),2&t&&(o.Fb("inner-space",e.innerSpace)("inner-space-vertical",e.innerSpaceVertical)("verticaly-bottom",e.contentBottom),o.Bb(5),o.jc("ngIf",!e.disabled&&("vertical"===e.options.orientation||"all"===e.options.orientation)),o.Bb(1),o.jc("ngIf",!e.disabled&&("horizontal"===e.options.orientation||"all"===e.options.orientation)))},directives:[ee],encapsulation:2}),t})();function Oh(t,e){if(1&t&&(o.Rb(0,"figure",12),o.Ob(1,"img",13),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("src","assets/img/icons/svg/"+t.icon+".svg",o.Cc)}}function Th(t,e){if(1&t&&(o.Rb(0,"div",9),o.Jc(1,Oh,2,1,"figure",10),o.Rb(2,"h3",11),o.Lc(3),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf",t.icon),o.Bb(2),o.Mc(t.header)}}function xh(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",14),o.Yb("click",function(e){return o.zc(t),o.bc().close(e)}),o.Ob(1,"img",15),o.Qb()}if(2&t){const t=o.bc();o.kc("tooltip-hint",t.L("meta.hint.modal.close")),o.jc("alertSound","ui_click_default")}}function Bh(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",16),o.Yb("click",function(e){return o.zc(t),o.bc().close(e)}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc();o.kc("tooltip-hint",t.L("meta.ui.store.close")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" \u2715 ",t.L("meta.ui.store.close")," ")}}function jh(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",17),o.Rb(1,"button",18),o.Yb("click",function(){return o.zc(t),o.bc().onPrev.emit()}),o.Ob(2,"img",19),o.Qb(),o.Rb(3,"button",20),o.Yb("click",function(){return o.zc(t),o.bc().onNext.emit()}),o.Ob(4,"img",21),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(1),o.kc("tooltip-hint",t.navTooltips[0]),o.jc("alertSound","ui_click_default"),o.Bb(2),o.kc("tooltip-hint",t.navTooltips[1]),o.jc("alertSound","ui_click_default")}}const Mh=["*"];let Qh=(()=>{class t{constructor(e){this.cache=e,this.id="",this.header="",this.title="",this.showNavigationButtons="",this.navTooltips=["Previous","Next"],this.ignoreBackgroundClick=!1,this.nonClosing=!1,this.icon="",this.error=!1,this.ignoreCloseOnClick=!1,this.opened=!1,this.active=!1,this.onOpen=new o.o,this.onClose=new o.o,this.onPrev=new o.o,this.onNext=new o.o,this.onTransparencyOn=new o.o,this.onTransparencyOff=new o.o,this.globalEvent=new uu,this.counters={},this.did=0,this.transparent=!1,this.keydownHandler=function(t){27===t.keyCode&&this.opened&&!this.nonClosing&&this.close()},(new al).data.subscribe(t=>this.L=t),t.instances.push(this),this.did=t.did,t.did++}ngOnInit(){this.keydownSubscription=pd.onKeyDown.pipe(We(t=>null!==t)).subscribe(t=>{this.keydownHandler(t)}),this.counters=this.cache.getCounters(),this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>{this.counters[t.path]=t.value}),this.confirmation&&setTimeout(()=>{this.confirmationSubscription=this.confirmation.modal.onClose.subscribe(()=>{this.confirmation.confirmed&&this.close(null,!0)})})}ngOnDestroy(){this.confirmationSubscription&&this.confirmationSubscription.unsubscribe(),this.keydownSubscription&&this.keydownSubscription.unsubscribe(),this.opened&&this.close()}open(t,e){this.opened=!0,setTimeout(()=>{this.active=!0,this.onOpen.emit(this),this.triggerGlobalEvent("modal.open",{id:this.id,did:this.did}),e||this.cache.alertSound("ui_modal_open_default")})}close(t,e=!1){if(this.disableTransparency(),this.confirmation&&this.confirmation.modal&&!e&&!this.confirmation.confirmed&&!this.confirmation.declined)return this.confirmation.modal.open(),void Object(Pc.a)("Confirmation opened");this.active=!1,setTimeout(()=>{this.opened&&(this.opened=!1,this.onClose.emit(this),this.triggerGlobalEvent("modal.close",{id:this.id,did:this.did}))})}hostClickHandler(t){this.transparent||this.ignoreBackgroundClick||this.ignoreCloseOnClick||t.target.closest(".dialog")||t.target.closest("button[ignore-modal-close]")||this.close(t)}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}static isAllModalsClosed(){for(let e=0;e<t.instances.length;e++)if(t.instances[e]&&t.instances[e].opened)return console.warn(`modal ${t.instances[e].did} (${t.instances[e].id}) is not closed`),!1;return!0}enableTransparency(){this.transparent||(this.transparent=!0,this.onTransparencyOn.emit(this.transparent),this.globalEvent.trigger("motal.transparent_on",{id:this.id,did:this.did}))}disableTransparency(){this.transparent&&(this.transparent=!1,this.onTransparencyOff.emit(this.transparent),this.globalEvent.trigger("motal.transparent_off",{id:this.id,did:this.did}))}}return t.did=0,t.instances=[],t.\u0275fac=function(e){return new(e||t)(o.Nb(nd))},t.\u0275cmp=o.Hb({type:t,selectors:[["modal"]],hostVars:6,hostBindings:function(t,e){1&t&&o.Yb("click",function(t){return e.hostClickHandler(t)}),2&t&&o.Fb("opened",e.opened)("active",e.active)("transparent",e.transparent)},inputs:{id:"id",header:"header",title:"title",showNavigationButtons:["nav","showNavigationButtons"],navTooltips:"navTooltips",ignoreBackgroundClick:"ignoreBackgroundClick",nonClosing:"nonClosing",icon:"icon",error:"error",ignoreCloseOnClick:"ignoreCloseOnClick",confirmation:"confirmation"},outputs:{onOpen:"onOpen",onClose:"onClose",onPrev:"onPrev",onNext:"onNext",onTransparencyOn:"onTransparencyOn",onTransparencyOff:"onTransparencyOff"},ngContentSelectors:Mh,decls:10,vars:7,consts:[[1,"verticaly-middle"],[1,"inner"],["draggableWindow","",1,"dialog-cover",3,"resize"],[1,"dialog"],["class","header align-center","drag-anchor","",4,"ngIf"],[1,"dialog-content"],["class","close",3,"tooltip-hint","alertSound","click",4,"ngIf"],["class","button white close-large",3,"tooltip-hint","alertSound","click",4,"ngIf"],["modal-navigation","",4,"ngIf"],["drag-anchor","",1,"header","align-center"],["class","spaced-bottom modal-icon",4,"ngIf"],[1,"dialog-header"],[1,"spaced-bottom","modal-icon"],["draggable","false",3,"src"],[1,"close",3,"tooltip-hint","alertSound","click"],["src","assets/img/icons/svg/close-modal-icon.svg","draggable","false"],[1,"button","white","close-large",3,"tooltip-hint","alertSound","click"],["modal-navigation",""],["type","button",1,"prev",3,"tooltip-hint","alertSound","click"],["src","assets/img/icons/svg/arrow_left_white.svg",1,"icon","larger"],["type","button",1,"next",3,"tooltip-hint","alertSound","click"],["src","assets/img/icons/svg/arrow_right_white.svg",1,"icon","larger"]],template:function(t,e){1&t&&(o.ic(),o.Rb(0,"div",0),o.Rb(1,"div",1),o.Rb(2,"div",2),o.Rb(3,"div",3),o.Jc(4,Th,4,2,"div",4),o.Rb(5,"div",5),o.Jc(6,xh,2,2,"button",6),o.Jc(7,Bh,2,3,"button",7),o.hc(8),o.Qb(),o.Jc(9,jh,5,4,"div",8),o.Qb(),o.Qb(),o.Qb(),o.Qb()),2&t&&(o.Bb(2),o.jc("resize",!1),o.Bb(1),o.Fb("error",e.error),o.Bb(1),o.jc("ngIf",e.header),o.Bb(2),o.jc("ngIf",!e.nonClosing),o.Bb(1),o.jc("ngIf",!e.nonClosing),o.Bb(2),o.jc("ngIf",e.showNavigationButtons))},encapsulation:2}),t})();const Ah=["dropdown"];function Dh(t,e){if(1&t&&(o.Rb(0,"div",9),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.label)}}function Eh(t,e){if(1&t&&o.Ob(0,"img",10),2&t){const t=o.bc();o.Eb("icon ",t.iconClass,""),o.jc("src","assets/img/icons/svg/"+t.icon+".svg",o.Cc)}}function Nh(t,e){1&t&&o.Ob(0,"span",11)}function Fh(t,e){if(1&t&&o.Ob(0,"img",17),2&t){const t=o.bc().$implicit,e=o.bc(2);o.jc("src",e.selectionIcons.root+"/"+t+"."+e.selectionIcons.ext,o.Cc)}}function Ph(t,e){1&t&&(o.Rb(0,"span"),o.Lc(1,","),o.Qb())}function Uh(t,e){if(1&t&&(o.Rb(0,"span",18),o.Lc(1),o.Jc(2,Ph,2,0,"span",19),o.Qb()),2&t){const t=o.bc(),e=t.$implicit,i=t.index,n=o.bc(2);o.Bb(1),o.Mc(e),o.Bb(1),o.jc("ngIf",i<n.selectionIcons.icons.length-1)}}function zh(t,e){if(1&t&&(o.Rb(0,"span"),o.Jc(1,Fh,1,1,"img",16),o.Jc(2,Uh,3,2,"span",14),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("ngIf","icon"==t.selectionIcons.showMode),o.Bb(1),o.jc("ngIf","label"==t.selectionIcons.showMode)}}function Jh(t,e){if(1&t&&(o.Rb(0,"span",18),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Mc(t.selectionIcons.iconCaption)}}function qh(t,e){if(1&t&&(o.Rb(0,"span",20),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Nc("+",t.selectionIcons.icons.length-t.maxSelectedLength[t.selectionIcons.showMode],"")}}function Vh(t,e){if(1&t&&(o.Rb(0,"span",12),o.Jc(1,zh,3,2,"span",13),o.Jc(2,Jh,2,1,"span",14),o.Jc(3,qh,2,1,"span",15),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngForOf",t.selectionIcons.icons.slice(0,t.maxSelectedLength[t.selectionIcons.showMode])),o.Bb(1),o.jc("ngIf",t.selectionIcons.iconCaption&&t.selectionIcons.iconCaption.length),o.Bb(1),o.jc("ngIf",t.selectionIcons.icons.length>t.maxSelectedLength[t.selectionIcons.showMode])}}const $h=function(t,e,i){return{left:t,top:e,width:i}},Gh=function(){return{}},Hh=["*"];let Yh=(()=>{class t{constructor(e,i){this.renderer=e,this.host=i,this.open=!1,this.disabled=!1,this.inline=!1,this.origin="top",this.text="",this.selectionIcons=null,this.label="",this.btn="",this.tooltipHint="",this.icon="",this.iconClass="",this.global=!1,this.position=new yl,this.width=null,this.onOpen=new o.o,this.onClose=new o.o,this.lastChild=!1,this.did=0,this.maxSelectedLength={icon:8,label:2},t.instances.push(this),this.did=t.did,t.did++,t.hostListener||(document.addEventListener("mousedown",e=>{let i=e.target.closest("dropdown");for(let n=0;n<t.instances.length;n++)i&&i.getAttribute("did")===t.instances[n].did.toString()||t.instances[n].hide()}),t.hostListener=!0)}ngOnChanges(t){t&&t.selectionIcons&&t.selectionIcons.currentValue&&(this.selectionIcons=t.selectionIcons.currentValue)}hide(){this.onClose.emit(this),this.open=!1}show(){if(this.disabled)return this.onClose.emit(this),void(this.open=!1);this.global?(this.setGlobalSize(),setTimeout(()=>{this.setGlobalPosition(),setTimeout(()=>{this.open=!0,this.onOpen.emit(this)},50)})):(this.open=!0,this.onOpen.emit(this))}toggle(){if(this.disabled)return this.onClose.emit(this),void(this.open=!1);this.open?this.hide():this.show()}setGlobalPosition(){let t=this.host.nativeElement.getBoundingClientRect(),e=this.dropdown.nativeElement.getBoundingClientRect();this.position=new yl(t.left+t.width-e.width,this.lastChild?t.top-e.height-t.height/2.5:t.top+t.height)}setGlobalSize(){let t=this.host.nativeElement.getBoundingClientRect();this.width=t.width}}return t.instances=[],t.hostListener=!1,t.did=0,t.\u0275fac=function(e){return new(e||t)(o.Nb(o.H),o.Nb(o.m))},t.\u0275cmp=o.Hb({type:t,selectors:[["dropdown"]],viewQuery:function(t,e){if(1&t&&o.Qc(Ah,!0),2&t){let t;o.vc(t=o.Zb())&&(e.dropdown=t.first)}},hostVars:15,hostBindings:function(t,e){2&t&&(o.Cb("did",e.did),o.Fb("open",e.open)("inline",e.inline)("origin-top","top"===e.origin)("origin-bottom","bottom"===e.origin)("origin-bottom-right","bottom-right"===e.origin)("origin-top-right","top-right"===e.origin)("disabled",e.disabled))},inputs:{open:"open",disabled:"disabled",inline:"inline",origin:"origin",text:"text",selectionIcons:"selectionIcons",label:"label",btn:"btn",tooltipHint:["tooltip-hint","tooltipHint"],icon:"icon",iconClass:"iconClass",global:"global",parentScroll:"parentScroll",lastChild:"lastChild"},outputs:{onOpen:"onOpen",onClose:"onClose"},features:[o.zb],ngContentSelectors:Hh,decls:10,vars:27,consts:[["class","dropdown-label",4,"ngIf"],["type","button",3,"alertSound","tooltip-hint","click"],[1,"text",3,"innerHTML"],[3,"src","class",4,"ngIf"],["class","arrow-icon",4,"ngIf"],["class","icons-selection",4,"ngIf"],[1,"dropdown-menu",3,"ngStyle"],["dropdown",""],[1,"content"],[1,"dropdown-label"],[3,"src"],[1,"arrow-icon"],[1,"icons-selection"],[4,"ngFor","ngForOf"],["class","icon-caption",4,"ngIf"],["class","more-count",4,"ngIf"],["class","icon",3,"src",4,"ngIf"],[1,"icon",3,"src"],[1,"icon-caption"],[4,"ngIf"],[1,"more-count"]],template:function(t,e){1&t&&(o.ic(),o.Jc(0,Dh,2,1,"div",0),o.Rb(1,"button",1),o.Yb("click",function(){return e.toggle()}),o.Ob(2,"span",2),o.Jc(3,Eh,1,4,"img",3),o.Jc(4,Nh,1,0,"span",4),o.Jc(5,Vh,4,3,"span",5),o.Qb(),o.Rb(6,"div",6,7),o.Rb(8,"div",8),o.hc(9),o.Qb(),o.Qb()),2&t&&(o.jc("ngIf",e.label&&!e.inline),o.Bb(1),o.Eb("button block ",e.btn,""),o.Fb("lined",!e.inline)("bordered",!e.inline)("transparent",e.inline)("active",e.open),o.kc("tooltip-hint",e.tooltipHint?e.tooltipHint:null),o.jc("alertSound",e.disabled?null:"ui_click_default"),o.Cb("data-tooltip",e.inline?"":e.text),o.Bb(1),o.jc("innerHTML",e.text||"\xa0",o.Ac),o.Bb(1),o.jc("ngIf",e.icon),o.Bb(1),o.jc("ngIf",!e.icon&&(e.text||e.selectionIcons)),o.Bb(1),o.jc("ngIf",e.selectionIcons&&e.selectionIcons.icons&&e.selectionIcons.icons.length),o.Bb(1),o.Fb("global",e.global),o.jc("ngStyle",e.global?o.pc(22,$h,e.position.x+"px",e.position.y+"px",e.width+"px"):o.mc(26,Gh)))},encapsulation:2}),t})();var Wh=function(t){return t.Label="label",t.Icon="icon",t}({});const Kh=["friendsModal"],Xh=["chat"],Zh=["userMainImage"];function tb(t,e){if(1&t&&o.Ob(0,"span",12),2&t){const t=o.bc(2);o.Cb("data-value",t.teamChat.unreaded)}}function eb(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",9),o.Rb(1,"button",10),o.Yb("click",function(){o.zc(t);const e=o.bc();return e.goToContactsTab(),e.teamChat?e.onMessageReaded(e.teamChat):e.void()}),o.Lc(2),o.Qb(),o.Rb(3,"button",10),o.Yb("click",function(){return o.zc(t),o.bc().goToTeamTab()}),o.Lc(4),o.Jc(5,tb,1,1,"span",11),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(1),o.Fb("active","contact"==t.activeChatTab),o.kc("tooltip-hint",t.L("meta.ui.chat.tab_contacts")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.chat.tab_contacts")," "),o.Bb(1),o.Fb("active","team"==t.activeChatTab),o.kc("tooltip-hint",t.L("meta.ui.chat.tab_party")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.chat.tab_party")," "),o.Bb(1),o.jc("ngIf",t.teamChat&&t.teamChat.unreaded>0)}}const ib=function(t,e){return{portrait:t,wreath:e}},nb=function(t,e,i,n){return{displayName:t,onlineStatus:e,league:i,avatar:n}};function sb(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",30),o.Yb("click",function(){return o.zc(t),o.bc(3).clearChatData()}),o.Ob(1,"user-image",31),o.Qb()}if(2&t){const t=o.bc(3);o.jc("alertSound","ui_click_default"),o.Bb(1),o.jc("player",o.qc(5,nb,t.user.scriptData.displayName,t.onlineStatus,t.user.scriptData.league&&t.user.scriptData.league.id?t.user.scriptData.league.id:"",o.oc(2,ib,t.userAvatar.portrait,t.userAvatar.wreath)))}}function ab(t,e){1&t&&o.Ob(0,"img",38)}function rb(t,e){1&t&&o.Ob(0,"img",39)}function ob(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",32),o.Yb("click",function(){o.zc(t);const e=o.bc(3);return e.copyUserID(e.user.userId)}),o.Ob(1,"nickname",33),o.Rb(2,"div",34),o.Lc(3),o.Rb(4,"button",35),o.Jc(5,ab,1,0,"img",36),o.Jc(6,rb,1,0,"img",37),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc(3);o.kc("tooltip-hint",t.L("meta.ui.chat.copy_user_id")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.jc("name",t.user&&t.user.displayName||"No Name"),o.Bb(2),o.Nc("ID: ",t.user.userId," "),o.Bb(2),o.jc("ngIf",!t.copied||t.copiedId!==t.user.userId),o.Bb(1),o.jc("ngIf",t.copied&&t.copiedId==t.user.userId)}}function cb(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",18),o.Rb(1,"div",19),o.Jc(2,sb,2,10,"div",20),o.Jc(3,ob,7,6,"div",21),o.Rb(4,"div",22),o.Rb(5,"dropdown",23,24),o.Rb(7,"ul",25),o.Rb(8,"li"),o.Rb(9,"button",26),o.Yb("click",function(){o.zc(t);const e=o.wc(6);return o.bc(2).friendSetOnlineMode("online"),e.hide()}),o.Lc(10),o.Ob(11,"img",27),o.Qb(),o.Qb(),o.Rb(12,"li"),o.Rb(13,"button",26),o.Yb("click",function(){o.zc(t);const e=o.wc(6);return o.bc(2).friendSetOnlineMode("dnd"),e.hide()}),o.Lc(14),o.Ob(15,"img",28),o.Qb(),o.Qb(),o.Rb(16,"li"),o.Rb(17,"button",26),o.Yb("click",function(){o.zc(t);const e=o.wc(6);return o.bc(2).friendSetOnlineMode("hidden"),e.hide()}),o.Lc(18),o.Ob(19,"img",29),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.Bb(2),o.jc("ngIf",t.user&&t.user.scriptData),o.Bb(1),o.jc("ngIf",t.user),o.Bb(2),o.kc("tooltip-hint",t.L("meta.ui.member.options")),o.jc("icon","tree-points")("btn","control-button"),o.Bb(3),o.Fb("active","online"==t.onlineStatus),o.Bb(1),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.chat.status.online")," "),o.Bb(2),o.Fb("active","dnd"==t.onlineStatus),o.Bb(1),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.chat.status.dnd")," "),o.Bb(2),o.Fb("active","hidden"==t.onlineStatus),o.Bb(1),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.chat.status.invisible")," ")}}function lb(t,e){if(1&t&&o.Ob(0,"div",46),2&t){const t=o.bc(3);o.jc("innerHTML",t.L("meta.hint.chat.friend_code_enter").markdown().br(),o.Ac)}}function ub(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",40),o.Rb(1,"input",41,42),o.Yb("ngModelChange",function(e){return o.zc(t),o.bc(2).newUserId=e})("input",function(e){return o.zc(t),o.bc(2).filterByName(e.target.value)})("keydown",function(e){o.zc(t);const i=o.bc(2);return i.onFriendSearch(e,{id:i.newUserId,key:"add"})})("focus",function(){return o.zc(t),o.bc(2).searchInputActive=!0})("focusout",function(){return o.zc(t),o.bc(2).searchInputActive=!1}),o.Qb(),o.Jc(3,lb,1,1,"div",43),o.Rb(4,"button",44),o.Yb("click",function(e){o.zc(t);const i=o.bc(2);return i.onFriendSearch(e,{id:i.newUserId,key:"add"}),i.checkIfNotEmpty(i.newUserId)}),o.Ob(5,"img",45),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.Fb("success",t.requestSuccess&&t.newUserId.length>0)("error",t.searchError),o.Bb(1),o.kc("placeholder",t.L("meta.ui.friend.request.friend_code_enter")),o.jc("ngModel",t.newUserId),o.Bb(2),o.jc("ngIf",t.searchInputActive||!t.detailsOpened),o.Bb(1),o.kc("tooltip-hint",t.L("meta.ui.chat.start_search_title"))}}function db(t,e){1&t&&o.Ob(0,"img",54)}function hb(t,e){1&t&&o.Ob(0,"img",55)}function bb(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",56),o.Yb("click",function(){o.zc(t);const e=o.bc(3);return e.addUserToNewTeam(e.activeChat.id),e.triggerGlobalEvent("button.add_to_team",e.activeChat.id)}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(3);o.kc("tooltip-hint",t.L("meta.ui.chat.system.team_new_friend_add")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.chat.send_invite")," ")}}function mb(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",56),o.Yb("click",function(){o.zc(t);const e=o.bc(3);return e.removeUserFromTeam(e.activeChat.id),e.triggerGlobalEvent("button.remove_from_team",e.activeChat.id)}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(3);o.kc("tooltip-hint",t.L("meta.ui.chat.system.team_friend_remove")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L(t.activeChat.state&&"accepted"==t.activeChat.state?"meta.ui.chat.cancel_invite":"meta.ui.chat.kick_from_party")," ")}}const pb=function(t,e,i,n,s){return{displayName:t,onlineStatus:e,league:i,commander:n,avatar:s}};function gb(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",47),o.Rb(1,"div",19),o.Rb(2,"div",48),o.Yb("click",function(){o.zc(t);const e=o.bc(2);return e.viewProfile(e.activeChat.id)}),o.Ob(3,"user-image",31),o.Qb(),o.Rb(4,"div",32),o.Yb("click",function(){o.zc(t);const e=o.bc(2);return e.copyUserID(e.activeChat.id)}),o.Ob(5,"nickname",33),o.Rb(6,"div",34),o.Lc(7),o.Rb(8,"button",35),o.Jc(9,db,1,0,"img",49),o.Jc(10,hb,1,0,"img",50),o.Qb(),o.Qb(),o.Qb(),o.Rb(11,"div",51),o.Jc(12,bb,2,3,"button",52),o.Jc(13,mb,2,3,"button",53),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.Bb(2),o.kc("tooltip-hint",t.L("meta.ui.chat.profile_option.view_profile")),o.Bb(1),o.jc("player",o.rc(13,pb,t.activeChat.displayName,t.activeChat.online?t.activeChat.online.state:null,t.activeChat.league,t.activeChat.commander?t.getUserCommander(t.activeChat.commander.template):null,o.oc(10,ib,t.activeChat.portrait,t.activeChat.wreath))),o.Bb(1),o.kc("tooltip-hint",t.L("meta.ui.chat.copy_user_id")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.jc("name",t.activeChat.displayName||"No Name"),o.Bb(2),o.Nc("ID: ",t.activeChat.id," "),o.Bb(2),o.jc("ngIf",!t.copied||t.copiedId!==t.activeChat.id),o.Bb(1),o.jc("ngIf",t.copied&&t.copiedId==t.activeChat.id),o.Bb(2),o.jc("ngIf",!t.activeChat.isGroup),o.Bb(1),o.jc("ngIf",t.userIsTeamOwner&&t.activeChat.isGroup)}}function fb(t,e){if(1&t&&(o.Rb(0,"h3",60),o.Lc(1),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.Mc(t.L("meta.ui.chat.pending_approval"))}}function vb(t,e){if(1&t&&(o.Rb(0,"h3",60),o.Lc(1),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.Mc(t.L("meta.ui.chat.block_users"))}}function yb(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",57),o.Rb(1,"button",58),o.Yb("click",function(){return o.zc(t),o.bc(2).goToContactsTab()}),o.Lc(2),o.Qb(),o.Jc(3,fb,2,1,"h3",59),o.Jc(4,vb,2,1,"h3",59),o.Qb()}if(2&t){const t=o.bc(2);o.Bb(1),o.kc("tooltip-hint",t.L("meta.ui.play.back")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" \u2190 ",t.L("meta.ui.play.back")," "),o.Bb(1),o.jc("ngIf","request"==t.activeChatTab),o.Bb(1),o.jc("ngIf","banned"==t.activeChatTab)}}function _b(t,e){if(1&t&&(o.Rb(0,"div",13),o.Jc(1,cb,20,17,"div",14),o.Jc(2,ub,6,8,"div",15),o.Jc(3,gb,14,19,"div",16),o.Jc(4,yb,5,5,"div",17),o.Qb()),2&t){const t=o.bc();o.Fb("verticaly-middle","request"==t.activeChatTab||"banned"==t.activeChatTab),o.Bb(1),o.jc("ngIf","contact"==t.activeChatTab),o.Bb(1),o.jc("ngIf","contact"==t.activeChatTab&&!t.activeChat),o.Bb(1),o.jc("ngIf","contact"==t.activeChatTab&&t.activeChat),o.Bb(1),o.jc("ngIf","request"==t.activeChatTab||"banned"==t.activeChatTab)}}function kb(t,e){if(1&t&&(o.Rb(0,"div",79),o.Ob(1,"span"),o.Qb()),2&t){const t=o.bc(5);o.Bb(1),o.Ic("width",t.cache.getLoadingProgress("addToLobby")+"%")}}function wb(t,e){if(1&t&&o.Ob(0,"span",12),2&t){const t=o.bc().$implicit;o.Cb("data-value",t.unreaded)}}function Sb(t,e){if(1&t&&o.Ob(0,"img",80),2&t){const t=o.bc(5);o.kc("tooltip-hint",t.L("meta.hint.chat.friend.muted"))}}function Ib(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc(3).$implicit,e=o.bc(4);o.Bb(1),o.Mc(e.L("meta.ui.members.state."+t.state))}}function Cb(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc(3).$implicit,e=o.bc(4);o.Bb(1),o.Mc(e.L("meta.ui.friend.game.state."+t.game.state))}}function Lb(t,e){if(1&t&&(o.Rb(0,"span"),o.Jc(1,Ib,2,1,"span",67),o.Jc(2,Cb,2,1,"span",67),o.Qb()),2&t){const t=o.bc(2).$implicit;o.Bb(1),o.jc("ngIf",t.state&&"none"!=t.state),o.Bb(1),o.jc("ngIf",(!t.state||"none"==t.state)&&t.game&&t.game.state&&"offline"!=t.online.state)}}function Rb(t,e){if(1&t&&(o.Rb(0,"div",81),o.Jc(1,Lb,3,2,"span",67),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.jc("ngIf",t.online&&t.online.state)}}function Ob(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",95),o.Yb("click",function(){o.zc(t);const e=o.bc(4).$implicit,i=o.bc(4);return i.addUserToNewTeam(e.id),i.triggerGlobalEvent("button.add_friend_to_team",{tutorial:!0})}),o.Ob(1,"img",96),o.Qb()}if(2&t){const t=o.bc(8);o.Fb("disabled",t.buttonsLocked),o.kc("tooltip-hint",t.L("meta.ui.chat.system.team_new_friend_add")),o.jc("alertSound","ui_click_default")}}function Tb(t,e){if(1&t&&(o.Rb(0,"span"),o.Jc(1,Ob,2,4,"button",94),o.Qb()),2&t){const t=o.bc(3).$implicit;o.Bb(1),o.jc("ngIf","friend"==t.relation&&!t.isGroup)}}function xb(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",95),o.Yb("click",function(){o.zc(t);const e=o.bc(4).$implicit;return o.bc(4).addUserToNewTeam(e.id)}),o.Ob(1,"img",96),o.Qb()}if(2&t){const t=o.bc(8);o.Fb("disabled",t.buttonsLocked),o.kc("tooltip-hint",t.L("meta.ui.chat.system.team_new_friend_add")),o.jc("alertSound","ui_click_default")}}function Bb(t,e){if(1&t&&(o.Rb(0,"span"),o.Jc(1,xb,2,4,"button",97),o.Qb()),2&t){const t=o.bc(3).$implicit;o.Bb(1),o.jc("ngIf","friend"==t.relation&&!t.isGroup||"requested"==t.state)}}function jb(t,e){if(1&t&&(o.Rb(0,"span",93),o.Jc(1,Tb,2,1,"span",67),o.Jc(2,Bb,2,1,"span",67),o.Qb()),2&t){const t=o.bc(2).$implicit,e=o.bc(4);o.Bb(1),o.jc("ngIf",!t.game||t.game&&"team"!==t.game.state||e.teamId),o.Bb(1),o.jc("ngIf",t.game&&"team"==t.game.state&&!e.teamId)}}function Mb(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",95),o.Yb("click",function(){o.zc(t);const e=o.bc(2).$implicit;return o.bc(4).removeUserFromTeam(e.id)}),o.Ob(1,"img",98),o.Qb()}if(2&t){const t=o.bc(6);o.kc("tooltip-hint",t.L("meta.ui.chat.system.team_friend_remove")),o.jc("alertSound","ui_click_default")}}function Qb(t,e){if(1&t){const t=o.Sb();o.Rb(0,"span",93),o.Rb(1,"button",99),o.Yb("click",function(){o.zc(t);const e=o.bc(2).$implicit;return o.bc(4).addUserToNewLobby(e.id)}),o.Ob(2,"img",96),o.Qb(),o.Qb()}if(2&t){const t=o.bc(6);o.Bb(1),o.Fb("disabled",t.buttonsLocked),o.kc("tooltip-hint",t.L("meta.ui.chat.system.lobby_new_friend_add")),o.jc("alertSound","ui_click_default")}}function Ab(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",100),o.Rb(1,"ul",101),o.Rb(2,"li",102),o.Rb(3,"button",90),o.Yb("click",function(){o.zc(t),o.bc();const e=o.wc(5),i=o.bc().$implicit,n=o.bc(4);return e.hide(),n.handleRequest({id:i.id,key:"mute",timeKey:"hour"})}),o.Lc(4),o.Qb(),o.Qb(),o.Rb(5,"li",102),o.Rb(6,"button",90),o.Yb("click",function(){o.zc(t),o.bc();const e=o.wc(5),i=o.bc().$implicit,n=o.bc(4);return e.hide(),n.handleRequest({id:i.id,key:"mute",timeKey:"day"})}),o.Lc(7),o.Qb(),o.Qb(),o.Rb(8,"li",102),o.Rb(9,"button",90),o.Yb("click",function(){o.zc(t),o.bc();const e=o.wc(5),i=o.bc().$implicit,n=o.bc(4);return e.hide(),n.handleRequest({id:i.id,key:"mute",timeKey:"week"})}),o.Lc(10),o.Qb(),o.Qb(),o.Rb(11,"li",102),o.Rb(12,"button",90),o.Yb("click",function(){o.zc(t),o.bc();const e=o.wc(5),i=o.bc().$implicit,n=o.bc(4);return e.hide(),n.handleRequest({id:i.id,key:"mute",timeKey:"forever"})}),o.Lc(13),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2).$implicit,e=o.bc(4);o.Bb(2),o.Fb("active","hour"==e.setMuteKey(t)),o.Bb(1),o.kc("tooltip-hint",e.L("meta.ui.chat.system.player_mute_hour")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.chat.system.player_mute_hour")," "),o.Bb(1),o.Fb("active","day"==e.setMuteKey(t)),o.Bb(1),o.kc("tooltip-hint",e.L("meta.ui.chat.system.player_mute_day")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.chat.system.player_mute_day")," "),o.Bb(1),o.Fb("active","week"==e.setMuteKey(t)),o.Bb(1),o.kc("tooltip-hint",e.L("meta.ui.chat.system.player_mute_week")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.chat.system.player_mute_week")," "),o.Bb(1),o.Fb("active","forever"==e.setMuteKey(t)),o.Bb(1),o.kc("tooltip-hint",e.L("meta.ui.chat.system.player_mute_forever")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.chat.system.player_mute_forever")," ")}}function Db(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",90),o.Yb("click",function(){o.zc(t),o.bc();const e=o.wc(5),i=o.bc().$implicit,n=o.bc(4);return e.hide(),n.handleRequest({id:i.id,key:"unmute"}),n.muteOptionsActive=!1}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(6);o.Bb(1),o.kc("tooltip-hint",t.L("meta.ui.chat.system.player_unmute")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.chat.system.player_unmute")," ")}}function Eb(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",82),o.Jc(1,jb,3,2,"span",83),o.Jc(2,Mb,2,2,"button",84),o.Jc(3,Qb,3,4,"span",83),o.Rb(4,"dropdown",85,86),o.Yb("onOpen",function(){o.zc(t);const e=o.bc().index;return o.bc(4).openedChatIndex=e})("onClose",function(){return o.zc(t),o.bc(5).openedChatIndex=null}),o.Rb(6,"ul"),o.Rb(7,"li"),o.Rb(8,"button",87),o.Yb("click",function(){return o.zc(t),o.bc(5).toggleMuteOptions()}),o.Lc(9),o.Ob(10,"img",88),o.Qb(),o.Jc(11,Ab,14,20,"div",89),o.Qb(),o.Jc(12,Db,3,3,"li",67),o.Rb(13,"li"),o.Rb(14,"button",90),o.Yb("click",function(){o.zc(t);const e=o.wc(5),i=o.bc().$implicit,n=o.bc(4);return n.handleRequest({id:i.id,key:"remove"}),e.hide(),n.activeChat=null}),o.Lc(15),o.Qb(),o.Qb(),o.Rb(16,"li"),o.Rb(17,"button",91),o.Yb("click",function(){o.zc(t);const e=o.wc(5),i=o.bc().$implicit,n=o.bc(4);return e.hide(),n.handleRequest({id:i.id,key:"ban"})}),o.Rb(18,"span",92),o.Lc(19,"!"),o.Qb(),o.Lc(20),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc().$implicit,e=o.bc(4);o.Bb(1),o.jc("ngIf",!e.hasLobby()),o.Bb(1),o.jc("ngIf",e.userIsTeamOwner&&t.isGroup&&"leader"!==t.state&&"requested"!==t.state),o.Bb(1),o.jc("ngIf",e.hasLobby()&&e.userIsLobbyOwner&&!t.isLobby),o.Bb(1),o.kc("tooltip-hint",e.L("meta.ui.member.options")),o.jc("icon","tree-points")("btn","control-button"),o.Bb(4),o.kc("tooltip-hint",e.L("meta.ui.chat.system.player_mute")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.chat.system.player_mute")," "),o.Bb(2),o.jc("ngIf",e.muteOptionsActive),o.Bb(1),o.jc("ngIf",t.muteExpires),o.Bb(2),o.kc("tooltip-hint",e.L("meta.ui.friend.action_remove")),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L("meta.ui.chat.profile_option.delete")),o.Bb(1),o.Nc(" ",e.L("meta.ui.chat.profile_option.delete")," "),o.Bb(2),o.kc("tooltip-hint",e.L("meta.ui.friend.action_ban")),o.jc("alertSound","ui_click_default"),o.Bb(3),o.Nc(" ",e.L("meta.ui.chat.profile_option.block")," ")}}const Nb=function(t,e,i,n,s,a){return{displayName:t,onlineStatus:e,league:i,commander:n,leader:s,avatar:a}};function Fb(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",70),o.Ob(1,"div",71),o.Jc(2,kb,2,2,"div",72),o.Rb(3,"div",73),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(4).viewProfile(i.id)}),o.Ob(4,"user-image",31),o.Qb(),o.Rb(5,"div",74),o.Yb("click",function(){o.zc(t);const i=e.$implicit,n=o.bc(4);return n.openChatWindow(i),n.saveActiveChat(),n.onMessageReaded(i)}),o.Ob(6,"nickname",75),o.Jc(7,wb,1,1,"span",11),o.Jc(8,Sb,1,1,"img",76),o.Jc(9,Rb,2,1,"div",77),o.Qb(),o.Jc(10,Eb,21,18,"div",78),o.Qb()}if(2&t){const t=e.$implicit,i=e.index,n=o.bc(4);o.Fb("active",n.activeChat&&t.id===n.activeChat.id||n.openedChatIndex==i),o.Bb(2),o.jc("ngIf",n.cache.isLoadingProgressRunning("addToLobby")&&n.invitedToLobbyPlayer===t.id),o.Bb(1),o.kc("tooltip-hint",n.L("meta.ui.chat.profile_option.view_profile")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.jc("player",o.sc(17,Nb,t.displayName,t.online?t.online.state:null,t.league,t.commander?n.getUserCommander(t.commander.template):null,"leader"==t.state,o.oc(14,ib,t.portrait,t.wreath))),o.Bb(1),o.kc("tooltip-hint",n.L("meta.ui.chat.open.private")+" "+t.displayName),o.jc("alertSound","ui_click_default"),o.Bb(1),o.jc("name",t&&t.displayName||"No Name")("search",n.friendNameFilter),o.Bb(1),o.jc("ngIf",t.unreaded>0),o.Bb(1),o.jc("ngIf",t.muteExpires),o.Bb(1),o.jc("ngIf","group"!=t.relation),o.Bb(1),o.jc("ngIf","friend"==t.relation||"group"==t.relation)}}function Pb(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,Fb,11,24,"div",69),o.Qb()),2&t){const t=e.ngIf;o.Bb(1),o.jc("ngForOf",t)}}function Ub(t,e){if(1&t&&(o.Rb(0,"div",103),o.Rb(1,"div",104),o.Ob(2,"img",105),o.Qb(),o.Lc(3),o.Qb()),2&t){const t=o.bc(3);o.Bb(3),o.Nc(" ",t.L("meta.ui.chat.friends_hidden")," ")}}function zb(t,e){if(1&t&&(o.Rb(0,"div",103),o.Rb(1,"div",104),o.Ob(2,"img",105),o.Qb(),o.Lc(3),o.Qb()),2&t){const t=o.bc(3);o.Bb(3),o.Nc(" ",t.L("meta.ui.chat.caption")," ")}}function Jb(t,e){if(1&t&&(o.Rb(0,"div",66),o.Jc(1,Pb,2,1,"div",67),o.cc(2,"filterList"),o.cc(3,"friendRelationFilter"),o.Jc(4,Ub,4,1,"div",68),o.cc(5,"filterList"),o.cc(6,"friendRelationFilter"),o.Jc(7,zb,4,1,"div",68),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("ngIf",o.gc(2,3,o.ec(3,8,t.allChats,"friend"),"displayName",t.friendNameFilter,!0)),o.Bb(3),o.jc("ngIf",t.allChats.length>1&&!o.gc(5,11,o.ec(6,16,t.allChats,"friend"),"displayName",t.friendNameFilter,!0).length&&t.newUserId.length),o.Bb(3),o.jc("ngIf",!t.allChats||t.allChats.length<=1)}}function qb(t,e){if(1&t&&o.Ob(0,"user-image",31),2&t){const t=o.bc().$implicit,e=o.bc(3);o.jc("player",o.sc(4,Nb,t.displayName,t.online?t.online.state:null,t.league,t.commander?e.getUserCommander(t.commander.template):null,"leader"==t.state,o.oc(1,ib,t.portrait,t.wreath)))}}function Vb(t,e){if(1&t&&o.Ob(0,"span",12),2&t){const t=o.bc().$implicit;o.Cb("data-value",t.unreaded)}}function $b(t,e){if(1&t&&o.Ob(0,"img",80),2&t){const t=o.bc(4);o.kc("tooltip-hint",t.L("meta.hint.chat.friend.muted"))}}function Gb(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).$implicit,e=o.bc(3);o.Bb(1),o.Mc(e.L("meta.ui.members.state."+t.state))}}function Hb(t,e){if(1&t&&(o.Rb(0,"div",81),o.Jc(1,Gb,2,1,"span",67),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.jc("ngIf",t.state&&"none"!=t.state)}}function Yb(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",95),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit;return o.bc(3).removeUserFromTeam(e.id)}),o.Ob(1,"img",98),o.Qb()}if(2&t){const t=o.bc(4);o.kc("tooltip-hint",t.L("meta.ui.chat.system.team_friend_remove")),o.jc("alertSound","ui_click_default")}}function Wb(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",95),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit;return o.bc(3).removeUserFromTeam(e.id)}),o.Ob(1,"img",98),o.Qb()}if(2&t){const t=o.bc(4);o.kc("tooltip-hint",t.L("meta.ui.team.invitation_reject")),o.jc("alertSound","ui_click_default")}}function Kb(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",56),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit;return o.bc(3).addUserToNewTeam(e.id)}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(4);o.kc("tooltip-hint",t.L("meta.ui.team.invitation_accept")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.team.request_accept_button")," ")}}function Xb(t,e){if(1&t&&(o.Rb(0,"span",110),o.Ob(1,"img",111),o.Qb()),2&t){const t=o.bc(4);o.kc("tooltip-hint",t.L("meta.ui.members.state.leader"))}}function Zb(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",90),o.Yb("click",function(){o.zc(t),o.bc();const e=o.wc(1),i=o.bc().$implicit;return o.bc(3).changeTeamLeader(i.id),e.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(5);o.Bb(1),o.kc("tooltip-hint",t.L("meta.hint.chat.system.team.change_leader")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.chat.system.team.change_leader")," ")}}function tm(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",90),o.Yb("click",function(){o.zc(t),o.bc();const e=o.wc(1),i=o.bc().$implicit;return o.bc(3).addNewFriendFromTeam(i.id),e.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(5);o.Bb(1),o.kc("tooltip-hint",t.L("meta.ui.chat.action_add")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.friend.action_add")," ")}}function em(t,e){if(1&t){const t=o.Sb();o.Rb(0,"dropdown",85,112),o.Yb("onOpen",function(){o.zc(t);const e=o.bc().index;return o.bc(3).openedChatIndex=e})("onClose",function(){return o.zc(t),o.bc(4).openedChatIndex=null}),o.Rb(2,"ul"),o.Jc(3,Zb,3,3,"li",67),o.Jc(4,tm,3,3,"li",67),o.Qb(),o.Qb()}if(2&t){const t=o.bc().$implicit,e=o.bc(3);o.Fb("not-visible",!e.userIsTeamOwner&&"friend"==t.relation),o.kc("tooltip-hint",e.L("meta.ui.member.options")),o.jc("icon","tree-points")("btn","control-button"),o.Bb(3),o.jc("ngIf",e.userIsTeamOwner&&t.state&&"requested"!==t.state&&t.id!==e.userId),o.Bb(1),o.jc("ngIf","friend"!==t.relation)}}function im(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",70),o.Ob(1,"div",71),o.Rb(2,"div",73),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(3).viewProfile(i.id)}),o.Jc(3,qb,1,11,"user-image",106),o.Qb(),o.Rb(4,"div",107),o.Ob(5,"nickname",75),o.Jc(6,Vb,1,1,"span",11),o.Jc(7,$b,1,1,"img",76),o.Jc(8,Hb,2,1,"div",77),o.Qb(),o.Rb(9,"div",82),o.Jc(10,Yb,2,2,"button",84),o.Jc(11,Wb,2,2,"button",84),o.Jc(12,Kb,2,3,"button",53),o.Jc(13,Xb,2,1,"span",108),o.Jc(14,em,5,7,"dropdown",109),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=e.index,n=o.bc(3);o.Fb("active",n.activeChat&&t.id===n.activeChat.id||n.openedChatIndex==i),o.Bb(2),o.kc("tooltip-hint",n.L("meta.ui.chat.profile_option.view_profile")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.jc("ngIf","group"!=t.relation&&"system"!=t.type),o.Bb(2),o.jc("name",t&&t.displayName||"No Name")("search",n.friendNameFilter),o.Bb(1),o.jc("ngIf",t.unreaded>0),o.Bb(1),o.jc("ngIf",t.muteExpires),o.Bb(1),o.jc("ngIf","group"!=t.relation),o.Bb(1),o.Fb("visible","leader"==t.state||"requested"==t.state),o.Bb(1),o.jc("ngIf",n.userIsTeamOwner&&"leader"!==t.state&&"requested"!==t.state),o.Bb(1),o.jc("ngIf",n.userIsTeamOwner&&"requested"==t.state),o.Bb(1),o.jc("ngIf",n.userIsTeamOwner&&"requested"==t.state),o.Bb(1),o.jc("ngIf","leader"==t.state),o.Bb(1),o.jc("ngIf","requested"!==t.state)}}function nm(t,e){if(1&t&&(o.Rb(0,"div",66),o.Jc(1,im,15,17,"div",69),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("ngForOf",t.teamMembers)}}function sm(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",113),o.Rb(1,"button",114),o.Yb("click",function(){return o.zc(t),o.bc(2).leaveFromCurrentTeam(!0)}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.Bb(1),o.kc("tooltip-hint",t.L("meta.ui.chat.system.team.leave")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.chat.system.team.leave")," ")}}function am(t,e){if(1&t&&(o.Rb(0,"div",61),o.Rb(1,"scrollable",62,63),o.Jc(3,Jb,8,19,"div",64),o.Jc(4,nm,2,1,"div",64),o.Qb(),o.Jc(5,sm,3,3,"div",65),o.Qb()),2&t){const t=o.bc();o.Fb("no-header","team"==t.activeChatTab),o.Bb(1),o.jc("height","100%")("bbox",!0)("origin","left"),o.Bb(2),o.jc("ngIf","contact"==t.activeChatTab),o.Bb(1),o.jc("ngIf",t.teamMembers&&t.teamMembers.length&&"team"==t.activeChatTab),o.Bb(1),o.jc("ngIf",t.teamMembers&&t.teamMembers.length&&"team"==t.activeChatTab)}}function rm(t,e){if(1&t&&(o.Rb(0,"div",103),o.Rb(1,"div",104),o.Ob(2,"img",105),o.Qb(),o.Lc(3),o.Qb()),2&t){const t=o.bc(3);o.Bb(3),o.Nc(" ",t.L("meta.ui.chat.type_search_more")," ")}}function om(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",56),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit;return o.bc(4).handleRequest({key:"add",id:e.id})}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(5);o.kc("tooltip-hint",t.L("meta.ui.friend.action_add")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.friend.action_add")," ")}}function cm(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",56),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit;return o.bc(4).handleRequest({id:e.id,key:"unban"})}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(5);o.kc("tooltip-hint",t.L("meta.ui.friend.action_unban")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.chat.profile_option.unblock")," ")}}function lm(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",56),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit;return o.bc(4).handleRequest({id:e.id,key:"remove"})}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc().$implicit,e=o.bc(4);o.Fb("transparent","request_in"==t.relation),o.kc("tooltip-hint",e.L("meta.ui.chat.cancel_my_invitation")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("request_out"==t.relation?"meta.ui.chat.cancel_my_invitation":"meta.ui.chat.decline_invitation")," ")}}function um(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",56),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit;return o.bc(4).handleRequest({id:e.id,key:"add"})}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(5);o.kc("tooltip-hint",t.L("meta.ui.chat.cancel_my_invitation")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.chat.accept_invitation")," ")}}const dm=function(t,e,i){return{displayName:t,league:e,avatar:i}};function hm(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",123),o.Rb(1,"div",124),o.Rb(2,"div",73),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(4).viewProfile(i.id)}),o.Ob(3,"user-image",31),o.Qb(),o.Rb(4,"div",107),o.Ob(5,"nickname",75),o.Qb(),o.Rb(6,"div",51),o.Jc(7,om,2,3,"button",52),o.Jc(8,cm,2,3,"button",52),o.Jc(9,lm,2,5,"button",125),o.Jc(10,um,2,3,"button",52),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(4);o.Bb(2),o.kc("tooltip-hint",i.L("meta.ui.chat.profile_option.view_profile")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.jc("player",o.pc(12,dm,t.displayName,t.league,o.oc(9,ib,t.portrait,t.wreath))),o.Bb(2),o.jc("name",t.displayName||"No Name")("search",i.friendNameFilter),o.Bb(2),o.jc("ngIf","none"==t.relation||!t.relation),o.Bb(1),o.jc("ngIf","ban"==t.relation),o.Bb(1),o.jc("ngIf","request_out"==t.relation||"request_in"==t.relation),o.Bb(1),o.jc("ngIf","request_in"==t.relation)}}function bm(t,e){if(1&t&&(o.Rb(0,"div",121),o.Jc(1,hm,11,16,"div",122),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.jc("ngForOf",t.searchFriendList)("ngForTrackBy",t.friendId)}}function mm(t,e){if(1&t&&(o.Rb(0,"div",103),o.Rb(1,"div",104),o.Ob(2,"img",105),o.Qb(),o.Lc(3),o.Qb()),2&t){const t=o.bc(3);o.Bb(3),o.Nc(" ",t.L("meta.ui.chat.no_search_result")," ")}}function pm(t,e){if(1&t&&(o.Rb(0,"div",117),o.Rb(1,"h3",118),o.Lc(2),o.Qb(),o.Jc(3,rm,4,1,"div",68),o.Rb(4,"scrollable",119,63),o.Jc(6,bm,2,2,"div",120),o.Qb(),o.Jc(7,mm,4,1,"div",68),o.Qb()),2&t){const t=o.bc(2);o.Bb(2),o.Mc(t.L("meta.ui.chat.search_result")),o.Bb(1),o.jc("ngIf",!t.searchFriendList.length),o.Bb(1),o.jc("bbox",!0),o.Bb(2),o.jc("ngIf",t.searchFriendList.length),o.Bb(1),o.jc("ngIf",t.searchIsEnd&&!t.searchFriendList.length)}}function gm(t,e){1&t&&o.Ob(0,"span",12)}function fm(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",127),o.Rb(1,"span",128),o.Rb(2,"button",129),o.Yb("click",function(){return o.zc(t),o.bc(3).goToRequestTab()}),o.Lc(3),o.cc(4,"friendRelationFilter"),o.cc(5,"friendRelationFilter"),o.Qb(),o.Jc(6,gm,1,0,"span",11),o.Qb(),o.Qb()}if(2&t){const t=o.bc(3);o.Bb(2),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Oc(" ",t.L("meta.ui.chat.pending_approval"),": ",o.ec(4,4,t.allChats,"request_in").length+o.ec(5,7,t.allChats,"request_out").length," "),o.Bb(3),o.jc("ngIf",t.newFriendRequest)}}function vm(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",127),o.Rb(1,"button",129),o.Yb("click",function(){return o.zc(t),o.bc(3).goToBannedTab()}),o.Lc(2),o.cc(3,"friendRelationFilter"),o.Qb(),o.Qb()}if(2&t){const t=o.bc(3);o.Bb(1),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Oc(" ",t.L("meta.ui.chat.block_users"),": ",o.ec(3,3,t.allChats,"ban").length," ")}}function ym(t,e){if(1&t&&(o.Rb(0,"div"),o.Rb(1,"div",103),o.Rb(2,"div",104),o.Ob(3,"img",105),o.Qb(),o.Lc(4),o.Qb(),o.Rb(5,"div",103),o.Rb(6,"div",104),o.Ob(7,"img",105),o.Qb(),o.Lc(8),o.Qb(),o.Jc(9,fm,7,10,"div",126),o.cc(10,"friendRelationFilter"),o.cc(11,"friendRelationFilter"),o.Jc(12,vm,4,6,"div",126),o.cc(13,"friendRelationFilter"),o.Qb()),2&t){const t=o.bc(2);o.Bb(4),o.Nc(" ",t.L("meta.ui.chat.info_message_id")," "),o.Bb(4),o.Nc(" ",t.L("meta.ui.chat.info_message_search")," "),o.Bb(1),o.jc("ngIf",o.ec(10,4,t.allChats,"request_in").length||o.ec(11,7,t.allChats,"request_out").length),o.Bb(3),o.jc("ngIf",o.ec(13,10,t.allChats,"ban").length)}}function _m(t,e){if(1&t&&(o.Rb(0,"div",115),o.Jc(1,pm,8,5,"div",116),o.Jc(2,ym,14,13,"div",67),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf",t.newUserId.length),o.Bb(1),o.jc("ngIf",!t.newUserId.length)}}function km(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",130),o.Rb(1,"chat",131,132),o.Yb("onChatClose",function(){return o.zc(t),o.bc().onChatClose()})("onMessageReaded",function(e){return o.zc(t),o.bc().onMessageReaded(e)}),o.Qb(),o.Qb()}}function wm(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",123),o.Rb(1,"div",124),o.Rb(2,"div",134),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(3).viewProfile(i.id)}),o.Ob(3,"user-image",31),o.Qb(),o.Rb(4,"div",107),o.Ob(5,"nickname",75),o.Qb(),o.Rb(6,"div",51),o.Rb(7,"button",135),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(3).handleRequest({id:i.id,key:"unban"})}),o.Lc(8),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(3);o.Bb(2),o.kc("tooltip-hint",i.L("meta.ui.chat.profile_option.view_profile")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.jc("player",o.pc(11,dm,t.displayName,t.league,o.oc(8,ib,t.portrait,t.wreath))),o.Bb(2),o.jc("name",t.displayName||"No Name")("search",i.friendNameFilter),o.Bb(2),o.kc("tooltip-hint",i.L("meta.ui.friend.action_unban")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",i.L("meta.ui.chat.profile_option.unblock")," ")}}function Sm(t,e){if(1&t&&(o.Rb(0,"div",121),o.Rb(1,"scrollable",119,63),o.Jc(3,wm,9,15,"div",122),o.cc(4,"friendRelationFilter"),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("bbox",!0),o.Bb(2),o.jc("ngForOf",o.ec(4,3,t.allChats,"ban"))("ngForTrackBy",t.friendId)}}function Im(t,e){if(1&t&&(o.Rb(0,"div",136),o.Rb(1,"div",104),o.Ob(2,"img",105),o.Qb(),o.Lc(3),o.Qb()),2&t){const t=o.bc(2);o.Bb(3),o.Nc(" ",t.L("meta.ui.chat.banned_list_empty")," ")}}function Cm(t,e){if(1&t&&(o.Rb(0,"div",115),o.Jc(1,Sm,5,6,"div",120),o.cc(2,"friendRelationFilter"),o.Jc(3,Im,4,1,"div",133),o.cc(4,"friendRelationFilter"),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf",o.ec(2,2,t.allChats,"ban").length),o.Bb(2),o.jc("ngIf",!o.ec(4,5,t.allChats,"ban").length)}}function Lm(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",135),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit;return o.bc(3).handleRequest({id:e.id,key:"add"})}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(4);o.kc("tooltip-hint",t.L("meta.ui.chat.cancel_my_invitation")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.chat.accept_invitation")," ")}}function Rm(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",123),o.Rb(1,"div",124),o.Rb(2,"div",134),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(3).viewProfile(i.id)}),o.Ob(3,"user-image",31),o.Qb(),o.Rb(4,"div",107),o.Ob(5,"nickname",75),o.Qb(),o.Rb(6,"div",51),o.Rb(7,"button",56),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(3).handleRequest({id:i.id,key:"remove"})}),o.Lc(8),o.Qb(),o.Jc(9,Lm,2,3,"button",140),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(3);o.Bb(2),o.kc("tooltip-hint",i.L("meta.ui.chat.profile_option.view_profile")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.jc("player",o.pc(14,dm,t.displayName,t.league,o.oc(11,ib,t.portrait,t.wreath))),o.Bb(2),o.jc("name",t.displayName||"No Name")("search",i.friendNameFilter),o.Bb(2),o.Fb("red","request_out"==t.relation),o.kc("tooltip-hint",i.L("meta.ui.chat.cancel_my_invitation")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",i.L("request_out"==t.relation?"meta.ui.chat.cancel_my_invitation":"meta.ui.chat.decline_invitation")," "),o.Bb(1),o.jc("ngIf","request_in"==t.relation)}}function Om(t,e){if(1&t&&(o.Rb(0,"div",139),o.Rb(1,"scrollable",119,63),o.Jc(3,Rm,10,18,"div",122),o.cc(4,"friendRelationFilter"),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("bbox",!0),o.Bb(2),o.jc("ngForOf",o.ec(4,3,t.allChats,t.selectedFriendRelation))("ngForTrackBy",t.friendId)}}function Tm(t,e){if(1&t&&(o.Rb(0,"div",136),o.Rb(1,"div",104),o.Ob(2,"img",105),o.Qb(),o.Lc(3),o.Qb()),2&t){const t=o.bc(2);o.Bb(3),o.Nc(" ",t.L("meta.ui.chat.requested_list_empty")," ")}}function xm(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",115),o.Rb(1,"button",137),o.Yb("click",function(){return o.zc(t),o.bc().selectedFriendRelation="request_in"}),o.cc(2,"friendRelationFilter"),o.cc(3,"friendRelationFilter"),o.Lc(4),o.Qb(),o.Rb(5,"button",137),o.Yb("click",function(){return o.zc(t),o.bc().selectedFriendRelation="request_out"}),o.cc(6,"friendRelationFilter"),o.cc(7,"friendRelationFilter"),o.Lc(8),o.Qb(),o.Jc(9,Om,5,6,"div",138),o.cc(10,"friendRelationFilter"),o.cc(11,"friendRelationFilter"),o.Jc(12,Tm,4,1,"div",133),o.cc(13,"friendRelationFilter"),o.cc(14,"friendRelationFilter"),o.Qb()}if(2&t){const t=o.bc();o.Bb(1),o.Fb("active","request_in"==t.selectedFriendRelation&&o.ec(2,14,t.allChats,"request_in").length)("disabled",!o.ec(3,17,t.allChats,"request_in").length),o.jc("alertSound","ui_click_default"),o.Bb(3),o.Nc(" ",t.L("meta.ui.chat.request_in")," "),o.Bb(1),o.Fb("active","request_out"==t.selectedFriendRelation&&o.ec(6,20,t.allChats,"request_out").length)("disabled",!o.ec(7,23,t.allChats,"request_out").length),o.jc("alertSound","ui_click_default"),o.Bb(3),o.Nc(" ",t.L("meta.ui.chat.request_out")," "),o.Bb(1),o.jc("ngIf",o.ec(10,26,t.allChats,"request_in").length||o.ec(11,29,t.allChats,"request_out").length),o.Bb(3),o.jc("ngIf",!o.ec(13,32,t.allChats,"request_in").length&&!o.ec(14,35,t.allChats,"request_out").length)}}JSON;let Bm=(()=>{class t{constructor(t,e,i,n,s,a,r,c,l){this.chatService=t,this.cache=e,this.authenticationService=i,this.notificatorService=n,this.visitService=s,this.lobbyService=a,this.router=r,this.helpService=c,this.profileService=l,this.onOpen=new o.o,this.onClose=new o.o,this.allChats=[],this.activeChat=null,this.chatsElementsList=[],this.savedActiveChat=null,this.friendsIdArray=[],this.searchFriendList=[],this.updateTimeout=1,this.time=new Date,this.userId="",this.userIsTeamOwner=!1,this.teamId="",this.teamMembers=[],this.invitedTeam={},this.progressLoadUser="",this.teamTabCreaded=!1,this.teamChat=null,this.userIsLobbyOwner=!1,this.lobbyData=null,this.invitedToLobbyPlayer="",this.globalEvent=new uu,this.demoModeEnabled=!1,this.counters={},this.userAvatar={},this.copied=!1,this.copiedId="",this.ChatTab=jm,this.activeChatTab=jm.Contact,this.newUserId="",this.friendNameFilter="",this.searchIsEnd=!1,this.searchError=!1,this.muteOptionsActive=!1,this.friendRequestData=null,this.newFriendRequest=!1,this.buttonsLocked=!1,(new al).data.subscribe(t=>this.L=t),this.userId=this.cache.getUserId()}ngOnInit(){this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>this.counters[t.path]=t.value),this.demoModeEnabled=this.cache.demoModeEnabled(),this.userOptions=this.cache.getPlayerOptions(),this.userOptionsSubscription=this.cache.userOptions.pipe(We(t=>null!==t)).subscribe(t=>this.userOptions=t),this.userAvatar=this.profileService.getUserAvatar(),this.friendsSubscription=this.chatService.chats.pipe(We(t=>null!==t)).subscribe(t=>{this.cache.devMode&&Object(Pc.a)("-> friends params: data",t),this.user=this.cache.getUser(!0),t&&t.chats?this.allChats=t.chats:t&&t.friend&&this.applyNewFriendData(t.friend.id,t.friend)}),this.cache.onlineStatus.subscribe(t=>{this.onlineStatus=t}),this.teamDataSubscription=this.chatService.teamsData.pipe(We(t=>null!==t)).subscribe(t=>{t&&t.id&&(this.teamId=t.id,this.teamMembers=this.computeTeamMembers()),t&&t.leave&&!0===t.leave&&setTimeout(()=>{this.clearTeamData()}),this.userIsTeamOwner=this.cache.isTeamOwner(),this.teamTabCreaded||this.createGroupTab()}),this.teamInviteSubscription=this.chatService.onTeamInvite.pipe(We(t=>null!==t)).subscribe(t=>{this.invitedTeam=t;let e=this.allChats.find(e=>e.id==t.from.id),i=null;t.from&&t.from.id&&e&&(i={displayName:e.displayName,league:e.league,avatar:{portrait:e.portrait,wreath:e.wreath}}),this.chatService.sendMessageToHQChat(this.L("meta.ui.chat.team.request_title"),this.L("meta.ui.chat.team.join_message",{name:t.from.displayName}),"invitation_team_"+(new Date).getTime(),{player:i},{key:"team_invitation.accept",data:t},{key:"team_invitation.decline",data:t}),this.cache.alertSound("ui_team_invite")}),this.userMessagesSubscription=this.chatService.userMessages.pipe(We(t=>null!==t)).subscribe(t=>{t&&t.friend&&this.setUnreadedCount(t.friend.id,t.friend.unreaded),t&&t.friend&&t.lastMessage&&this.putMessageToDate(t.friend.id,t.lastMessage)}),this.goToContactsTab(),this.globalEvent.subscribe(t=>{t&&(t&&"team_invitation.accept"==t.key&&t.data&&this.acceptTeamInvitation(t.data),t&&"team_invitation.decline"==t.key&&t.data&&this.rejectTeamInvitation(t.data),t&&"isMatching_true"==t.key&&(this.closeChatWindow(),this.friendsModal.close()))}),this.profileAvatarSubscription=this.profileService.onAvatarChange.pipe(We(t=>null!==t)).subscribe(t=>{this.userAvatar=this.profileService.getUserAvatar()}),this.chatService.friendRequestIn.pipe(We(t=>null!==t)).subscribe(t=>{t&&t.id&&(this.visitService.visit("friendRequest"+t.id),this.friendRequestData=t,this.newFriendRequest=!0)}),this.lobbyChangeSubscription=this.lobbyService.onLobbyChange.pipe(We(t=>null!==t)).subscribe(t=>{this.lobbyData=this.lobbyService.lobbyGetData(),this.userIsLobbyOwner=this.userId==this.lobbyData.owner,this.setPlayerLobbyStatus(!0)}),this.lobbyClosedSubscription=this.lobbyService.onLobbyClosed.subscribe(t=>{t&&this.lobbyData.id===t&&(this.lobbyData=null,this.userIsLobbyOwner=!1,this.setPlayerLobbyStatus(!1))})}ngOnDestroy(){this.userMessagesSubscription.unsubscribe()}open(t){this.friendsModal&&!this.friendsModal.opened&&(this.friendsModal.open(),this.activeChatTab===jm.Team&&this.teamMembers&&this.teamMembers.length&&this.teamChat&&this.openChatWindow(this.teamChat),this.onOpen.emit(this))}closeChatWindow(){this.onClose.emit(this),this.chat&&this.chat.isOpen&&this.chat.close()}applyNewFriendData(t,e){if(!e||!t)return;let i=e.relation,n=this.allChats.find(e=>e.id==t);e.id=t,n?Object.assign(n,e):i!=Ud.None&&this.allChats.push(e),this.sortFriendsListByTime()}createGroupTab(){this.teamChat=this.allChats.find(t=>t.id==this.teamId),this.teamTabCreaded=!0}removeGroupTab(){this.goToContactsTab(),this.teamTabCreaded=!1}clearTeamData(){this.teamMembers=[],this.teamId="",this.userIsTeamOwner=!1,this.removeGroupTab(),localStorage.removeItem("METAGAME_LAST_TEAMCHANGE_OPTIONS")}computeTeamMembers(){let t=this.chatService.getTeamMembers().filter(t=>t.id!==this.userId);for(let e of t){let t=this.allChats.find(t=>t.id==e.id);e.relation=t?t.relation:Ud.None}return t}sortFriendsListByTime(){this.allChats=this.allChats.slice().sort((t,e)=>(new Date).diff(new Date(t.updateTime)).delta-(new Date).diff(new Date(e.updateTime)).delta)}hasCustomLobby(){return this.lobbyService.hasCustomLobby()}hasTournament(){return this.lobbyService.hasTournament()}hasLobby(){return this.lobbyService.hasLobby()}copyUserID(t){const e=document.createElement("textarea");e.style.position="fixed",e.style.left="0",e.style.top="0",e.style.opacity="0",e.value=t,document.body.appendChild(e),e.focus(),e.select(),document.execCommand("copy"),document.body.removeChild(e),this.copied=!0,this.copiedId=t,setTimeout(()=>{this.copied=!1,this.copiedId=""},350)}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}addUserToNewTeam(t){this.teamId?(this.cache.startLoadingProgress("teamOperation"),this.buttonsLocked=!0,this.chatService.teamOperation({operation:"accept",player:t,team:this.teamId}).then(()=>{this.cache.stopLoadingProgress("teamOperation"),this.buttonsLocked=!1})):(this.cache.startLoadingProgress("teamOperation"),this.chatService.teamCreate(t))}removeUserFromTeam(t){this.userIsTeamOwner&&this.teamMembers.length&&(this.progressLoadUser=t,this.cache.startLoadingProgress("teamOperation"),this.buttonsLocked=!0,this.chatService.teamOperation({operation:"reject",player:t,team:this.teamId}).then(()=>{this.cache.stopLoadingProgress("teamOperation"),this.buttonsLocked=!1}))}sendRequestToTeam(t,e){if(!t||!e)return!1;this.cache.startLoadingProgress("teamOperation"),this.buttonsLocked=!0,this.chatService.teamOperation({operation:"request",player:this.userId,team:e}).then(()=>{this.cache.stopLoadingProgress("teamOperation"),this.buttonsLocked=!1})}acceptTeamInvitation(t){t&&t.team&&(this.cache.startLoadingProgress("teamOperation"),this.buttonsLocked=!0,this.chatService.teamOperation({operation:"request",player:this.userId,team:t.team}).then(()=>{this.cache.stopLoadingProgress("teamOperation"),this.buttonsLocked=!1}))}rejectTeamInvitation(t){t&&t.team&&(this.cache.startLoadingProgress("teamOperation"),this.buttonsLocked=!0,this.chatService.teamOperation({team:t.team,operation:"leave",player:this.userId}).then(()=>{this.cache.stopLoadingProgress("teamOperation"),this.buttonsLocked=!1}))}leaveFromCurrentTeam(t){if(!t)return;this.cache.startLoadingProgress("teamOperation"),this.buttonsLocked=!0;let e={team:this.cache.getUserTeamId(),operation:"leave",player:this.cache.getUserId()};this.chatService.teamOperation(e).then(()=>{this.cache.stopLoadingProgress("teamOperation"),this.clearTeamData(),this.buttonsLocked=!1})}changeTeamLeader(t){if(!this.userIsTeamOwner)return;this.cache.startLoadingProgress("teamOperation"),this.buttonsLocked=!0;let e={operation:"changeOwner",player:t,team:this.cache.getUserTeamId()};this.chatService.teamOperation(e).then(()=>{this.cache.stopLoadingProgress("teamOperation"),this.buttonsLocked=!1})}goToContactsTab(){setTimeout(()=>{this.activeChatTab=jm.Contact}),this.activeChat=this.savedActiveChat,this.selectedFriendRelation=Ud.Friend,this.openChatWindow(this.savedActiveChat)}goToTeamTab(){this.activeChatTab=jm.Team,this.teamMembers&&this.teamMembers.length&&this.teamChat&&this.openChatWindow(this.teamChat)}goToRequestTab(){setTimeout(()=>{this.activeChatTab=jm.Request}),this.selectedFriendRelation=this.allChats.filter(t=>t.relation==Ud.RequestIn).length?Ud.RequestIn:Ud.RequestOut,this.friendRequestData&&this.friendRequestData.id&&(this.visitService.clear("friendRequest"+this.friendRequestData.id),this.friendRequestData=null,this.newFriendRequest=!1)}goToBannedTab(){setTimeout(()=>{this.activeChatTab=jm.Banned}),this.selectedFriendRelation=Ud.Ban}saveActiveChat(){this.savedActiveChat=this.activeChat}openChatWindow(t){if(!t)return!1;this.activeChat=t,setTimeout(()=>{this.chat&&this.chat.open(this.activeChat)},10)}onMessageReaded(t){if(!t)return;let e=t.id;this.chatService.markAsReaded(e),this.setUnreadedCount(e,0)}setUnreadedCount(t,e){let i=this.allChats.find(e=>e.id===t);i&&(i.unreaded=e)}onChatClose(){this.clearChatData()}clearChatData(){this.activeChat=null,this.savedActiveChat=null,this.searchIsEnd=!1,this.searchError=!1,this.filterByName("")}viewProfile(t){t&&(this.friendsModal.close(),this.cache.redirect(["profile",t,"summary"]))}onFriendSearch(t,e){t&&t.target&&t.target.value&&t.target.value.length<3&&(this.searchIsEnd=!1),(13===t.keyCode||t&&t.target&&t.target.value&&t.target.value.length)&&(this.searchError=!1,wu(()=>{this.searchFriendList=[],this.newUserId.length>=3&&this.chatService.searchFriends(this.newUserId).subscribe(t=>{if(this.searchIsEnd=!0,this.searchError=!1,t&&t.length)for(let e of t.filter(t=>t.id!==this.userId))this.searchFriendList.push(e)},t=>{this.searchIsEnd=!0,this.searchError=!0,this.notificatorService.push({response:t,parameters:""})})},13===t.keyCode?10:2e3,"friend_search_request"))}checkIfNotEmpty(t){t&&t.length||(this.searchError=!0),setTimeout(()=>{this.searchError=!1},500)}filterByName(t){this.friendNameFilter=t,t&&t===this.newUserId||(this.newUserId="",this.searchFriendList=[])}handleRequest(t){t&&t.id&&t.key&&("add"==t.key?this.chatService.requestFriendAdd(t.id).subscribe(e=>{e&&e.scriptData&&e.scriptData.update&&(this.applyNewFriendData(t.id,e.scriptData.update),this.newUserId&&this.newUserId.length&&setTimeout(()=>{this.filterByName("")}))}):"remove"==t.key?this.chatService.requestFriendRemove(t.id).subscribe(e=>{e&&e.scriptData&&e.scriptData.update&&this.applyNewFriendData(t.id,e.scriptData.update)}):"ban"==t.key?this.chatService.requestFriendBan(t.id).subscribe(e=>{e&&e.scriptData&&e.scriptData.update&&this.applyNewFriendData(t.id,e.scriptData.update)}):"unban"==t.key?this.chatService.requestFriendUnban(t.id).subscribe(e=>{e&&e.scriptData&&e.scriptData.update&&this.applyNewFriendData(t.id,e.scriptData.update)}):"mute"==t.key&&t.timeKey?(this.chatService.friendMute(t.id,t.timeKey),setTimeout(()=>{this.muteOptionsActive=!1})):"unmute"==t.key&&this.chatService.friendUnmute(t.id))}checkIfMuted(t){let e=!1,i=(new Date).getTime();return t.muteExpires&&t.muteExpires>i&&(e=!0),e}setMuteKey(t){if(!t.muteExpires)return;let e=(new Date).getTime()+36e5,i=(new Date).getTime()+864e5,n=(new Date).getTime()+6048e5,s=(new Date).getTime()+314496e5,a=(new Date).getTime()+314496e7,r=new Date(t.muteExpires).getTime(),o="";return r<=e?o="hour":r>e&&r<=i?o="day":r>i&&r<=n?o="week":r>n&&r<=s?o="year":r>a&&(o="forever"),o}toggleMuteOptions(){this.muteOptionsActive=!this.muteOptionsActive}friendSetOnlineMode(t){t&&this.chatService.friendSetOnlineMode(t)}getUserCommander(t){return this.cache.getCommander(t)?this.cache.getCommander(t).type:null}void(){}putMessageToDate(t,e){if(!e||!t)return;let i=this.allChats.find(e=>e.id==t);if(i&&(i.messages&&i.messages.length||(i.messages=[],i.messages.push(e)),i.messages&&i.messages.length)){let t=i.messages[i.messages.length-1].time;t&&e.time&&t!==e.time&&i.messages.push(e)}}addUserToNewLobby(t){if(!this.lobbyData||!this.lobbyData.id||!t)return;let e=this.getLobbySlotToInvite("a1");this.lobbyData&&this.lobbyData.members&&this.lobbyData.members[t]||e&&(this.cache.startLoadingProgress("addToLobby"),this.invitedToLobbyPlayer=t,this.buttonsLocked=!0,this.lobbyService.lobbyInvite(this.lobbyData.id,t,e).subscribe(t=>{this.cache.stopLoadingProgress("addToLobby"),this.buttonsLocked=!1,this.invitedToLobbyPlayer=""},t=>{this.buttonsLocked=!1,this.invitedToLobbyPlayer="",this.notificatorService.push({response:t,parameters:""}),this.cache.stopLoadingProgress("addToLobby")}))}getLobbySlotToInvite(t){let e="",i=this.lobbyService.lobbyGetData().slots,n=Object.keys(i),s=n.indexOf(t);return e=i&&i[t]&&"open"!==i[t].state?n.indexOf(t)+1<=n.length-1?this.getLobbySlotToInvite(n[s+1]):this.getLobbySlotToInvite(n[0]):t,e}setPlayerLobbyStatus(t){this.allChats.map(e=>{e.isLobby=!!t&&!!(this.lobbyData&&this.lobbyData.members&&this.lobbyData.members[e.id])})}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Pd),o.Nb(nd),o.Nb(Gc),o.Nb(Uc),o.Nb(Sl),o.Nb(Bl),o.Nb(Ys),o.Nb(Kd),o.Nb(Ou))},t.\u0275cmp=o.Hb({type:t,selectors:[["friends"]],viewQuery:function(t,e){if(1&t&&(o.Qc(Kh,!0),o.Qc(Xh,!0),o.Qc(Zh,!0)),2&t){let t;o.vc(t=o.Zb())&&(e.friendsModal=t.first),o.vc(t=o.Zb())&&(e.chat=t.first),o.vc(t=o.Zb())&&(e.userMainImage=t.first)}},outputs:{onOpen:"onOpen",onClose:"onClose"},features:[o.Ab([Pd,nd,Sl,Kd,Ou])],decls:11,vars:12,consts:[["data-chat-modal","","id","friendsModal",1,"friends-modal",3,"id","onClose"],["friendsModal",""],["class","team-tabs",4,"ngIf"],[1,"main-body","grid-cover"],["drag-anchor","","class","header",3,"verticaly-middle",4,"ngIf"],["class","chats left-side side",3,"no-header",4,"ngIf"],[1,"details","right-side","side"],["class","chat-main",4,"ngIf"],["class","team chat-main",4,"ngIf"],[1,"team-tabs"],[1,"button","tab","back-color",3,"tooltip-hint","alertSound","click"],["class","marker",4,"ngIf"],[1,"marker"],["drag-anchor","",1,"header"],["class","left-side side",4,"ngIf"],["class","form-group with-icon right-side side",3,"success","error",4,"ngIf"],["class","right-side side border-left",4,"ngIf"],["class","title-header",4,"ngIf"],[1,"left-side","side"],[1,"chat-item"],["class","chat-image clickable",3,"alertSound","click",4,"ngIf"],["class","caption",3,"tooltip-hint","alertSound","click",4,"ngIf"],[1,"controls","bottom-position","visible"],[1,"title-dropdown","grey",3,"icon","btn","tooltip-hint"],["onlineMode",""],[1,"clear"],["type","button",1,"button","transparent","block","with-icon",3,"alertSound","click"],["src","assets/img/icons/svg/status_online.svg","draggable","false",1,"button-icon"],["src","assets/img/icons/svg/status_dnd.svg","draggable","false",1,"button-icon"],["src","assets/img/icons/svg/status_offline.svg","draggable","false",1,"button-icon"],[1,"chat-image","clickable",3,"alertSound","click"],[3,"player"],[1,"caption",3,"tooltip-hint","alertSound","click"],[3,"name"],[1,"chat-id"],["type","button",1,"copy-btn"],["src","assets/img/icons/svg/copy.svg","draggable","false",4,"ngIf"],["src","assets/img/icons/svg/check_active.svg","draggable","false",4,"ngIf"],["src","assets/img/icons/svg/copy.svg","draggable","false"],["src","assets/img/icons/svg/check_active.svg","draggable","false"],[1,"form-group","with-icon","right-side","side"],["type","text","id","formInput","autocomplete","off",1,"input","small-height",3,"ngModel","placeholder","ngModelChange","input","keydown","focus","focusout"],["input",""],["class","input-tooltip",3,"innerHTML",4,"ngIf"],["type","button",1,"form-icon","button","transparent","verticaly-middle",3,"tooltip-hint","click"],["src","assets/img/icons/svg/search-icon.svg","draggable","false","image-load",""],[1,"input-tooltip",3,"innerHTML"],[1,"right-side","side","border-left"],[1,"chat-image","clickable",3,"tooltip-hint","click"],["src","assets/img/icons/svg/copy.svg","alt","search","draggable","false",4,"ngIf"],["src","assets/img/icons/svg/check_active.svg","alt","search","draggable","false",4,"ngIf"],[1,"controls","visible"],["class","button small","type","button",3,"tooltip-hint","alertSound","click",4,"ngIf"],["type","button","class","button small",3,"tooltip-hint","alertSound","click",4,"ngIf"],["src","assets/img/icons/svg/copy.svg","alt","search","draggable","false"],["src","assets/img/icons/svg/check_active.svg","alt","search","draggable","false"],["type","button",1,"button","small",3,"tooltip-hint","alertSound","click"],[1,"title-header"],[1,"button","white",3,"tooltip-hint","alertSound","click"],["class","title",4,"ngIf"],[1,"title"],[1,"chats","left-side","side"],[3,"height","bbox","origin"],["scrollable",""],["class","chats-cover",4,"ngIf"],["class","bottom-part",4,"ngIf"],[1,"chats-cover"],[4,"ngIf"],["class","info-text",4,"ngIf"],["class","chat-item","fade-in","down",3,"active",4,"ngFor","ngForOf"],["fade-in","down",1,"chat-item"],[1,"texture-border"],["class","progress-bar simple",4,"ngIf"],[1,"chat-image","clickable",3,"tooltip-hint","alertSound","click"],[1,"caption","active",3,"alertSound","tooltip-hint","click"],[3,"name","search"],["src","assets/img/icons/svg/mute.svg","draggable","false","class","icon muted",3,"tooltip-hint",4,"ngIf"],["class","chat-status",4,"ngIf"],["class","controls",4,"ngIf"],[1,"progress-bar","simple"],["src","assets/img/icons/svg/mute.svg","draggable","false",1,"icon","muted",3,"tooltip-hint"],[1,"chat-status"],[1,"controls"],["class","group",4,"ngIf"],["type","button","class","control-button",3,"tooltip-hint","alertSound","click",4,"ngIf"],[3,"icon","btn","tooltip-hint","onOpen","onClose"],["friendOptions",""],["type","button",1,"button","transparent","block","with-icon",3,"tooltip-hint","alertSound","click"],["src","assets/img/icons/svg/dropdown_angle.svg","alt","icon",1,"button-icon"],["class","mute-options",4,"ngIf"],["type","button",1,"button","transparent","block",3,"tooltip-hint","alertSound","click"],["type","button",1,"button","transparent","block",3,"alertSound","tooltip-hint","click"],[1,"color-primary"],[1,"group"],["type","button","class","control-button",3,"disabled","tooltip-hint","alertSound","click",4,"ngIf"],["type","button",1,"control-button",3,"tooltip-hint","alertSound","click"],["src","assets/img/icons/svg/plus-round.svg","draggable","false"],["type","button","class","control-button",3,"tooltip-hint","alertSound","disabled","click",4,"ngIf"],["src","assets/img/icons/svg/remove.svg","draggable","false"],["type","button",1,"control-button",3,"alertSound","tooltip-hint","click"],[1,"mute-options"],[1,"clear","options-list"],[1,"item"],[1,"info-text"],[1,"text-icon"],["src","assets/img/icons/svg/attention-icon.svg","alt","search","draggable","false",1,"icon"],[3,"player",4,"ngIf"],[1,"caption"],["class","control-button",3,"tooltip-hint",4,"ngIf"],[3,"icon","btn","not-visible","tooltip-hint","onOpen","onClose",4,"ngIf"],[1,"control-button",3,"tooltip-hint"],["src","assets/img/icons/svg/leader.svg","draggable","false"],["teamMemberOptions",""],[1,"bottom-part"],["type","button",1,"button","transparent",3,"tooltip-hint","alertSound","click"],[1,"chat-main"],["style","height: 100%;",4,"ngIf"],[2,"height","100%"],[1,"spaced-bottom"],[2,"height","90%",3,"bbox"],["class","friends-list",4,"ngIf"],[1,"friends-list"],["class","list-item","fade-in","down",4,"ngFor","ngForOf","ngForTrackBy"],["fade-in","down",1,"list-item"],[1,"chat-item","darken"],["class","button small","type","button",3,"tooltip-hint","alertSound","transparent","click",4,"ngIf"],["class","button-cover",4,"ngIf"],[1,"button-cover"],[1,"marker-relative"],["type","button",1,"button",3,"alertSound","click"],[1,"team","chat-main"],[3,"onChatClose","onMessageReaded"],["chat",""],["class","info-text spaced-top",4,"ngIf"],[1,"chat-image","clickable",3,"alertSound","tooltip-hint","click"],["type","button",1,"button","small","red",3,"tooltip-hint","alertSound","click"],[1,"info-text","spaced-top"],[1,"button","tab",3,"alertSound","click"],["class","friends-list spaced-top",4,"ngIf"],[1,"friends-list","spaced-top"],["class","button small red","type","button",3,"tooltip-hint","alertSound","click",4,"ngIf"]],template:function(t,e){1&t&&(o.Rb(0,"modal",0,1),o.Yb("onClose",function(){return e.closeChatWindow()}),o.Jc(2,eb,6,11,"div",2),o.Rb(3,"div",3),o.Jc(4,_b,5,6,"div",4),o.Jc(5,am,6,8,"div",5),o.Rb(6,"div",6),o.Jc(7,_m,3,2,"div",7),o.Jc(8,km,3,0,"div",8),o.Jc(9,Cm,5,8,"div",7),o.Jc(10,xm,15,38,"div",7),o.Qb(),o.Qb(),o.Qb()),2&t&&(o.jc("id","friends_list"),o.Bb(2),o.jc("ngIf",e.teamTabCreaded&&e.teamMembers.length),o.Bb(2),o.jc("ngIf","team"!==e.activeChatTab),o.Bb(1),o.jc("ngIf","team"==e.activeChatTab||"contact"==e.activeChatTab),o.Bb(1),o.Fb("no-header","team"==e.activeChatTab)("full-width","request"==e.activeChatTab||"banned"==e.activeChatTab),o.Bb(1),o.jc("ngIf","contact"==e.activeChatTab&&!e.activeChat),o.Bb(1),o.jc("ngIf",e.activeChat),o.Bb(1),o.jc("ngIf","banned"==e.activeChatTab),o.Bb(1),o.jc("ngIf","request"==e.activeChatTab))},encapsulation:2}),t})();var jm=function(t){return t.Contact="contact",t.Team="team",t.Request="request",t.Banned="banned",t}({});const Mm=["input"],Qm=["scrollable"];function Am(t,e){if(1&t&&(o.Rb(0,"div"),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).$implicit;o.Bb(1),o.Mc(t.originalText)}}function Dm(t,e){if(1&t&&(o.Rb(0,"div"),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).$implicit;o.Bb(1),o.Mc(t.text)}}function Em(t,e){if(1&t&&(o.Rb(0,"article",15),o.Jc(1,Am,2,1,"div",8),o.Jc(2,Dm,2,1,"div",8),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(4);o.Fb("system","system"==t.type),o.Bb(1),o.jc("ngIf",t.isFriend?!e.userOptions.chat_filter_friends:!e.userOptions.chat_filter_others),o.Bb(1),o.jc("ngIf",t.isFriend?e.userOptions.chat_filter_friends:e.userOptions.chat_filter_others)}}function Nm(t,e){if(1&t&&(o.Rb(0,"div",16),o.Lc(1),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(4);o.Bb(1),o.Mc(e.getTime(t.time))}}function Fm(t,e){if(1&t&&(o.Rb(0,"div",11),o.Rb(1,"div",12),o.Lc(2),o.Qb(),o.Jc(3,Em,3,4,"article",13),o.Jc(4,Nm,2,1,"div",14),o.Qb()),2&t){const t=e.$implicit,i=o.bc(4);o.Fb("self",t.self),o.Bb(1),o.Fb("system","system"==t.type)("not-readed",!t.readed),o.jc("ngClass",t.groupKey?"count-"+t.groupKey:t.self?"self":""),o.Bb(1),o.Mc("system"==t.type?i.L("meta.ui.chat.system_name"):t.displayName),o.Bb(1),o.jc("ngIf",t.text),o.Bb(1),o.jc("ngIf",t.time)}}function Pm(t,e){if(1&t&&(o.Rb(0,"div"),o.Rb(1,"div",9),o.Lc(2),o.Qb(),o.Jc(3,Fm,5,10,"div",10),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(2);o.Bb(2),o.Mc(e.convertToMonthDate(t)),o.Bb(1),o.jc("ngForOf",e.countedMessages[t])}}function Um(t,e){if(1&t&&(o.Rb(0,"div",7),o.Jc(1,Pm,4,2,"div",8),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2);o.Bb(1),o.jc("ngIf",i.countedMessages[t]&&i.countedMessages[t].length)}}function zm(t,e){if(1&t&&(o.Rb(0,"div",11),o.Rb(1,"div",17),o.Lc(2),o.Qb(),o.Rb(3,"article",18),o.Lc(4),o.Qb(),o.Rb(5,"div",16),o.Lc(6),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.Bb(2),o.Mc(t.L("meta.ui.chat.system_name")),o.Bb(2),o.Nc(" ",t.L("meta.ui.chat.no_messages")," "),o.Bb(2),o.Mc(t.getTime(t.dateNow))}}function Jm(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",2),o.Yb("click",function(){o.zc(t);const e=o.bc();return e.markReadedMessages(e.chat.id)}),o.Rb(1,"scrollable",3,4),o.Jc(3,Um,2,1,"div",5),o.Jc(4,zm,7,3,"div",6),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.jc("alertSound","ui_click_default"),o.Bb(1),o.jc("bbox",!0)("height","100%")("contentBottom",!0),o.Bb(2),o.jc("ngForOf",t.countedMessagesDates),o.Bb(1),o.jc("ngIf",!t.countedMessagesDates||!t.countedMessagesDates.length)}}function qm(t,e){if(1&t&&(o.Rb(0,"div",27),o.Rb(1,"div",28),o.Lc(2),o.Qb(),o.Rb(3,"div",29),o.Ob(4,"canvas-progress",30),o.Qb(),o.Qb()),2&t){const t=o.bc(3);o.Bb(2),o.Mc(t.floodCountdownString),o.Bb(2),o.jc("time",t.floodExpires)("fillColor","#c12a2a")}}function Vm(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",21),o.Rb(1,"input",22,23),o.Yb("ngModelChange",function(e){return o.zc(t),o.bc(2).model=e})("keydown",function(e){return o.zc(t),o.bc(2).onModelKeydown(e)}),o.Qb(),o.Rb(3,"button",24),o.Yb("click",function(){return o.zc(t),o.bc(2).send()}),o.Ob(4,"img",25),o.Qb(),o.Jc(5,qm,5,3,"div",26),o.Qb()}if(2&t){const t=o.bc(2);o.Bb(1),o.Fb("filled",t.model),o.jc("ngModel",t.model)("disabled",t.isFlooded)("placeholder",t.L("meta.ui.chat.whisper")+t.chat.displayName),o.Bb(2),o.kc("tooltip-hint",t.L("meta.ui.chat.send")),o.jc("alertSound","ui_click_default"),o.Bb(2),o.jc("ngIf",t.isFlooded)}}function $m(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",19),o.Yb("click",function(){o.zc(t);const e=o.bc();return e.markReadedMessages(e.chat.id)}),o.Jc(1,Vm,6,8,"div",20),o.Qb()}if(2&t){const t=o.bc();o.Fb("disabled",t.isFlooded),o.jc("alertSound","ui_click_default"),o.Bb(1),o.jc("ngIf","friend"==t.chat.relation||"group"==t.chat.relation)}}const Gm=["january","february","march","april","may","june","july","august","september","october","november","december"];let Hm=(()=>{class t{constructor(t,e,i,n){this.host=t,this.chatService=e,this.cache=i,this.lobbyService=n,this.isOpen=!1,this.chat=null,this.model="",this.countedMessages=null,this.countedMessagesDates=[],this.teamId="",this.isFlooded=!1,this.floodExpires=null,this.floodCountdownString="00:00",this.muteOptionsActive=!1,this.mutedSelect="",this.onChatOpen=new o.o,this.onChatClose=new o.o,this.onMessageReaded=new o.o,this.dateNow=(new Date).getTime(),(new al).data.subscribe(t=>this.L=t),this.isOpen=!1}ngOnInit(){this.userOptions=this.cache.getPlayerOptions(),this.userOptionsSubscription=this.cache.userOptions.pipe(We(t=>null!==t)).subscribe(t=>this.userOptions=t),this.userMessagesSubscription=this.chatService.userMessages.pipe(We(t=>null!==t)).subscribe(t=>{t&&t.friend&&t.lastMessage&&this.putMessageToDate(t.friend.id,t.lastMessage)})}ngOnDestroy(){this.userMessagesSubscription.unsubscribe()}getUserCommander(t){return this.cache.getCommander(t).type}checkIfMuted(){let t=!1,e=(new Date).getTime();return this.chat&&this.chat.muteExpires&&this.chat.muteExpires>e&&(t=!0),t}setMuteKey(){let t=(new Date).getTime()+36e5,e=(new Date).getTime()+864e5,i=(new Date).getTime()+6048e5,n=(new Date).getTime()+314496e5,s=(new Date).getTime()+314496e7,a=this.chat.muteExpires,r="";return a<=t?r="hour":a>t&&a<=e?r="day":a>e&&a<=i?r="week":a>i&&a<=n?r="year":a>s&&(r="forever"),r}open(t){t?(this.unbind(),this.chat=t,this.countedMessages=this.setCountedMessages(),this.checkIfMuted()&&(this.mutedSelect=this.setMuteKey()),this.isOpen=!0,setTimeout(()=>{this.input&&this.input.nativeElement.focus()}),setTimeout(()=>{this.chatService.setOpenedChatId(this.chat.id),this.scrollable&&this.scrollDown()},300),this.onChatOpen.emit(this)):console.warn("Chat :: no element!")}close(){this.unbind(),setTimeout(()=>{this.isOpen=!1,this.chatService.setOpenedChatId("")}),this.onChatClose.emit(this)}unbind(){this.chat=null,this.model="",this.countedMessagesDates=[],this.countedMessages=null}setCountedMessages(){let t=this.countedMessages||{},e="";if(this.chat&&this.chat.messages&&this.chat.messages.length)for(let i of this.chat.messages)e!==new Date(i.time).parseDate("DD.MM.YYYY")&&(e=new Date(i.time).parseDate("DD.MM.YYYY"),t[e]=[],this.countedMessagesDates.includes(e)||(this.countedMessagesDates.push(e),this.countedMessagesDates=this.sortByLastTime(this.countedMessagesDates))),new Date(i.time).parseDate("DD.MM.YYYY")==e&&t[e].push(i);return t}putMessageToDate(t,e){if(!e||!t)return;let i=new Date(e.time).parseDate("DD.MM.YYYY");this.chat&&this.chat.id&&t==this.chat.id&&(this.countedMessagesDates.includes(i)||this.countedMessagesDates.push(i),this.countedMessages[i]||(this.countedMessages||(this.countedMessages={}),this.countedMessages[i]=[]),this.countedMessages[i].push(e),this.scrollable&&setTimeout(()=>{this.scrollDown()},200))}convertToMonthDate(t){if(!t)return;let e=t.split("."),i=this.toTimeStamp(t),n=this.L("meta.ui.month."+Gm[new Date(i).getMonth()]);return e[0]+" "+n+" "+e[2]}toTimeStamp(t){if(!t)return;let e=t.split(".");return new Date(e[2],e[1]-1,e[0])}onModelKeydown(t){this.markReadedMessages(this.chat.id),13===t.keyCode&&this.send()}send(){if(!this.model.length)return;let t=this.chat.type==zd.Lobby||this.chat.type==zd.LobbyCustom?this.chat.type:this.chat.relation,e=this.cache.getUserName(),i=(this.chat.type==zd.LobbyCustom&&this.lobbyService.getLobbyTeam(),this.chat.type==zd.LobbyCustom?this.lobbyService.lobbyGetId():this.chat.id);this.chatService.messageSend(this.model.trim(),i,e,t).subscribe(t=>{(t.scriptData||t.scriptData.result||t.scriptData.result.sent)&&(1==t.scriptData.result.sent?(this.model="",this.isFlooded=!1,this.floodExpires=null,this.scrollable&&setTimeout(()=>{this.scrollDown()},200)):(this.isFlooded=t.scriptData.result.flood,this.floodExpires=t.scriptData.result.floodExpires,this.cache.alertSound("error"),this.runFloodCountown()))})}scrollDown(){this.scrollable&&(this.scrollable.setRects(),this.scrollable.update(),this.scrollable.moveDownImmediate())}runFloodCountown(){let t;this.isFlooded&&(t=setInterval(()=>{if(new Date(this.floodExpires).isGreaterEqual(new Date)){let t=new Date(this.floodExpires).diff(new Date);this.floodCountdownString=(new Date).getDifferenceString(t,"",!0,this.L)}else clearInterval(t),this.isFlooded=!1,this.floodExpires=null,setTimeout(()=>{this.input&&this.input.nativeElement.focus()})},250))}getTime(t){return new Date(t).parseDate("h:m")}markReadedMessages(t){this.chat&&(this.chatService.markAsReaded(t),this.chat.unreaded=0,this.onMessageReaded.emit({id:t}))}deleteSystemMessage(t){if(!this.chat)return;let e=this.chat.messages.indexOf(t);this.chat.messages.splice(e,1),this.chatService.save()}sortByLastTime(t){return t.slice().sort((t,e)=>new Date(this.toTimeStamp(t)).getTime()-new Date(this.toTimeStamp(e)).getTime())}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m),o.Nb(Pd),o.Nb(nd),o.Nb(Bl))},t.\u0275cmp=o.Hb({type:t,selectors:[["chat"]],viewQuery:function(t,e){if(1&t&&(o.Qc(Mm,!0),o.Qc(Qm,!0)),2&t){let t;o.vc(t=o.Zb())&&(e.input=t.first),o.vc(t=o.Zb())&&(e.scrollable=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("open",e.isOpen)},outputs:{onChatOpen:"onChatOpen",onChatClose:"onChatClose",onMessageReaded:"onMessageReaded"},features:[o.Ab([Pd,Bl])],decls:2,vars:2,consts:[["class","messages-body",3,"alertSound","click",4,"ngIf"],["class","form-body",3,"disabled","alertSound","click",4,"ngIf"],[1,"messages-body",3,"alertSound","click"],[3,"bbox","height","contentBottom"],["scrollable",""],["class","date-wrap",4,"ngFor","ngForOf"],["class","message",4,"ngIf"],[1,"date-wrap"],[4,"ngIf"],[1,"date"],["class","message",3,"self",4,"ngFor","ngForOf"],[1,"message"],[1,"name",3,"ngClass"],["class","text",3,"system",4,"ngIf"],["class","time",4,"ngIf"],[1,"text"],[1,"time"],[1,"name","system"],[1,"text","system"],[1,"form-body",3,"alertSound","click"],["class","form-group with-icon with-timer",4,"ngIf"],[1,"form-group","with-icon","with-timer"],["type","text","id","chatMessageInput","maxlength","250",1,"input","small",3,"ngModel","disabled","placeholder","ngModelChange","keydown"],["input",""],["type","button",1,"form-send-btn",3,"tooltip-hint","alertSound","click"],["src","assets/img/icons/svg/send.svg","alt","send",1,"icon"],["class","timer",4,"ngIf"],[1,"timer"],[1,"data"],[1,"progress"],[3,"time","fillColor"]],template:function(t,e){1&t&&(o.Jc(0,Jm,5,6,"div",0),o.Jc(1,$m,2,4,"div",1)),2&t&&(o.jc("ngIf",e.chat),o.Bb(1),o.jc("ngIf",e.chat&&"system"!==e.chat.type))},encapsulation:2}),t})();const Ym=["confirmModal"];function Wm(t,e){if(1&t&&(o.Rb(0,"figure",10),o.Ob(1,"img",11),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("src","assets/img/icons/svg/"+t.confirmation.options.icon+".svg",o.Cc)}}let Km=(()=>{class t{constructor(){this.confirmed=!1,this.declined=!1,this.localizator=new al,this.localizator.data.subscribe(t=>{this.L=t})}ngOnInit(){}ngOnDestroy(){this.modal&&this.modal.close(!0),this.reset()}confirm(){this.confirmCallback&&this.confirmCallback(),this.confirmed=!0,this.modal&&this.modal.close(!0),this.reset(),Object(Pc.a)(`[\u2713] Confirmation [${this.confirmation.options.key}] confirmed`)}decline(){this.declineCallback&&this.declineCallback(),this.declined=!0,this.modal&&this.modal.close(!0),this.reset(),Object(Pc.a)(`[x] Confirmation [${this.confirmation.options.key}] declined`)}reset(){setTimeout(()=>{this.confirmed=!1,this.declined=!1},10)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Hb({type:t,selectors:[["confirmation"]],viewQuery:function(t,e){if(1&t&&o.Qc(Ym,!0),2&t){let t;o.vc(t=o.Zb())&&(e.modal=t.first)}},inputs:{confirmation:"confirmation",confirmCallback:"confirmCallback",declineCallback:"declineCallback"},decls:13,vars:10,consts:[[1,"medium",3,"id","nonClosing"],["confirmModal",""],["drag-anchor","",1,"header","align-center"],["class","align-center spaced-bottom modal-icon",4,"ngIf"],[1,"dialog-header"],[1,"body","collapsed-top","align-center"],[3,"innerHTML"],[1,"body","align-center"],[1,"button","large","spaced-right",3,"alertSound","click"],[1,"button",3,"alertSound","click"],[1,"align-center","spaced-bottom","modal-icon"],["draggable","false",3,"src"]],template:function(t,e){1&t&&(o.Rb(0,"modal",0,1),o.Rb(2,"div",2),o.Jc(3,Wm,2,1,"figure",3),o.Rb(4,"h2",4),o.Lc(5),o.Qb(),o.Qb(),o.Rb(6,"div",5),o.Ob(7,"article",6),o.Qb(),o.Rb(8,"div",7),o.Rb(9,"button",8),o.Yb("click",function(){return e.confirm()}),o.Lc(10),o.Qb(),o.Rb(11,"button",9),o.Yb("click",function(){return e.decline()}),o.Lc(12),o.Qb(),o.Qb(),o.Qb()),2&t&&(o.jc("id","confirmation_component")("nonClosing",!0),o.Bb(3),o.jc("ngIf",e.confirmation.options.icon),o.Bb(2),o.Mc(e.L(e.confirmation.options.title)),o.Bb(2),o.jc("innerHTML",e.L(e.confirmation.options.key,e.confirmation.data),o.Ac),o.Bb(2),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L(e.confirmation.options.confirm)," "),o.Bb(1),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L(e.confirmation.options.decline)),o.Bb(1),o.Nc(" ",e.L(e.confirmation.options.decline)," "))},encapsulation:2}),t})();const Xm=["*"];let Zm=(()=>{class t{constructor(){this.open=!1,this.label="",this.tooltip="",this.disabled=!1,t.instances.push(this)}ngOnInit(){}hide(){this.open=!1}show(){this.open=!this.disabled}toggle(){this.disabled?this.open=!1:this.open?this.hide():this.show()}}return t.instances=[],t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Hb({type:t,selectors:[["accordeon"]],hostVars:4,hostBindings:function(t,e){2&t&&o.Fb("open",e.open)("disabled",e.disabled)},inputs:{open:"open",label:"label",tooltip:"tooltip",disabled:"disabled"},ngContentSelectors:Xm,decls:8,vars:5,consts:[["type","button",1,"button","accordeon-button",3,"alertSound","click"],[1,"text"],[1,"arrow-icon"],["src","assets/img/icons/svg/drop_up.svg","alt","icon","draggable","false"],[1,"accorden-menu"],[1,"content"]],template:function(t,e){1&t&&(o.ic(),o.Rb(0,"button",0),o.Yb("click",function(){return e.toggle()}),o.Rb(1,"span",1),o.Lc(2),o.Qb(),o.Rb(3,"span",2),o.Ob(4,"img",3),o.Qb(),o.Qb(),o.Rb(5,"div",4),o.Rb(6,"div",5),o.hc(7),o.Qb(),o.Qb()),2&t&&(o.Fb("active",e.open),o.jc("alertSound","ui_click_default"),o.Cb("tooltip-hint",e.tooltip),o.Bb(2),o.Mc(e.label))},encapsulation:2}),t})(),tp=(()=>{class t{constructor(e){this.el=e,this.x=0,this.y=0,this.timeout=null,this.hideTimeout=null,this.text="",this.active=!1,this.host=e.nativeElement,t.node||(t.node=document.createElement("div"),t.node.classList.add("hint-tooltip"),t.node.innerHTML=this.getText(),document.body.appendChild(t.node))}ngOnChanges(e){this.active&&(t.node.innerHTML=e.text.currentValue.markdown().br())}onMouseEnter(e){let i=this.host.getBoundingClientRect();parseInt(getComputedStyle(t.node).maxWidth),this.setPosition(i.left+i.width/2,i.top+i.height),this.show()}onMouseLeave(){this.hide()}ngOnDestroy(){this.hide()}getText(){return("function"==typeof this.text?this.text():this.text).markdown().br()}show(){this.timeout&&clearTimeout(this.timeout),this.hideTimeout&&clearTimeout(this.hideTimeout),this.timeout=setTimeout(()=>{t.node.innerHTML=this.getText(),setTimeout(()=>{this.text.length&&t.node.innerHTML.length&&(t.node.classList.add("active"),this.active=!0)},100),setTimeout(()=>{let e=t.node.getBoundingClientRect();(e.left+e.width>window.innerWidth||e.top+e.height>window.innerHeight)&&(t.node.style.top="0px",t.node.style.left="0px",setTimeout(()=>{let e=t.node.getBoundingClientRect(),i=Math.clamp(this.x,0,window.innerWidth-e.width),n=Math.clamp(this.y,0,window.innerHeight-e.height);this.setPosition(i,n)},50))},100)},250),this.hideTimeout=setTimeout(()=>{this.hide()},5250)}hide(){t.node.classList.remove("active"),t.node.classList.remove("right-origin"),t.node.innerHTML="",this.timeout&&clearTimeout(this.timeout),this.hideTimeout&&clearTimeout(this.hideTimeout),this.active=!1}setPosition(e,i){this.x=e,this.y=i,t.node.style.top=i+"px",t.node.style.left=e+"px"}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m))},t.\u0275dir=o.Ib({type:t,selectors:[["","tooltip-hint",""]],hostBindings:function(t,e){1&t&&o.Yb("mouseenter",function(t){return e.onMouseEnter(t)})("mouseleave",function(t){return e.onMouseLeave(t)})},inputs:{text:["tooltip-hint","text"]},features:[o.zb]}),t})();function ep(t,e){if(1&t&&o.Ob(0,"img",5),2&t){const t=o.bc();o.jc("src","assets/img/icons/svg/"+t.icon+".svg",o.Cc)}}function ip(t,e){if(1&t&&(o.Rb(0,"h2",6),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.title)}}function np(t,e){if(1&t&&(o.Rb(0,"h3",7),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.subtitle)}}function sp(t,e){if(1&t&&(o.Rb(0,"div",8),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.desc)}}function ap(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",9),o.Rb(1,"button",10),o.Yb("click",function(){return o.zc(t),o.bc().action.action()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(1),o.Fb("large",t.action.large&&1==t.action.large),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.action.label," ")}}let rp=(()=>{class t{constructor(){this.title="",this.subtitle="",this.desc="",this.icon="",this.centered=!0}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Hb({type:t,selectors:[["empty"]],inputs:{title:"title",subtitle:"subtitle",desc:"desc",action:"action",icon:"icon",centered:"centered"},decls:6,vars:7,consts:[["image-load","","draggable","false","class","spaced-bottom empty-icon",3,"src",4,"ngIf"],["fade-in","up","class","title",4,"ngIf"],["fade-in","up","class","subtitle",4,"ngIf"],["fade-in","down","class","desc",4,"ngIf"],["class","spaced-top-larger",4,"ngIf"],["image-load","","draggable","false",1,"spaced-bottom","empty-icon",3,"src"],["fade-in","up",1,"title"],["fade-in","up",1,"subtitle"],["fade-in","down",1,"desc"],[1,"spaced-top-larger"],[1,"button",3,"alertSound","click"]],template:function(t,e){1&t&&(o.Rb(0,"div"),o.Jc(1,ep,1,1,"img",0),o.Jc(2,ip,2,1,"h2",1),o.Jc(3,np,2,1,"h3",2),o.Jc(4,sp,2,1,"div",3),o.Jc(5,ap,3,4,"div",4),o.Qb()),2&t&&(o.Fb("align-center",e.centered),o.Bb(1),o.jc("ngIf",e.icon),o.Bb(1),o.jc("ngIf",e.title),o.Bb(1),o.jc("ngIf",e.subtitle),o.Bb(1),o.jc("ngIf",e.desc),o.Bb(1),o.jc("ngIf",e.action))},encapsulation:2}),t})();function op(t,e){if(1&t&&o.Ob(0,"unit",5),2&t){const t=o.bc();o.jc("data",t.data)}}function cp(t,e){if(1&t&&(o.Rb(0,"div",6),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Fb("collectible",t.data.collectible)("premium",t.data.premium),o.kc("tooltip-hint",t.data.collectible?t.L("meta.hint.collectible_unit"):t.data.premium?t.L("meta.hint.premium_unit"):""),o.Bb(1),o.Nc(" ",t.L("unit."+t.data.id+".short"),"\n")}}function lp(t,e){if(1&t&&(o.Rb(0,"div",7),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Fb("collectible",t.actor.collectible)("premium",t.actor.premium),o.kc("tooltip-hint",t.actor.collectible?t.L("meta.hint.collectible_unit"):t.actor.premium?t.L("meta.hint.premium_unit"):""),o.Bb(1),o.Nc(" ",t.L("actor."+t.actor+".name"),"\n")}}function up(t,e){if(1&t&&o.Ob(0,"div",8),2&t){const t=o.bc();o.jc("innerHTML",t.getSimpleUnit(t.actor),o.Ac)}}function dp(t,e){if(1&t&&(o.Rb(0,"div",9),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.raw.id)}}let hp=(()=>{class t{constructor(t){this.sanitizer=t,this.data=null,this.actor=null,this.raw=null,this.isOpen=!1,this.id=Math.randomInt(0,1e6),(new al).data.subscribe(t=>this.L=t)}ngOnInit(){t.instances.push(this)}ngOnDestroy(){let e=t.instances.findIndex(t=>t.id===this.id);e>=0&&t.instances.splice(e,1)}close(){this.isOpen=!1}open(){for(let e=0;e<t.instances.length;e++)t.instances[e].close();this.isOpen=!0}toggle(){setTimeout(()=>{this.isOpen?this.close():this.open()},10)}getSimpleUnit(t){return kl.createSimpleUnitById(t,this.sanitizer,!!this.actor)}}return t.instances=[],t.\u0275fac=function(e){return new(e||t)(o.Nb(Er))},t.\u0275cmp=o.Hb({type:t,selectors:[["unit-unwrap"]],inputs:{data:"data",actor:"actor",raw:"raw",isOpen:"isOpen"},decls:5,vars:5,consts:[[3,"data",4,"ngIf"],["class","align-left unit-title",3,"collectible","premium","tooltip-hint",4,"ngIf"],["class","align-left grey unit-title",3,"collectible","premium","tooltip-hint",4,"ngIf"],[3,"innerHTML",4,"ngIf"],["class","grey",4,"ngIf"],[3,"data"],[1,"align-left","unit-title",3,"tooltip-hint"],[1,"align-left","grey","unit-title",3,"tooltip-hint"],[3,"innerHTML"],[1,"grey"]],template:function(t,e){1&t&&(o.Jc(0,op,1,1,"unit",0),o.Jc(1,cp,2,6,"div",1),o.Jc(2,lp,2,6,"div",2),o.Jc(3,up,1,1,"div",3),o.Jc(4,dp,2,1,"div",4)),2&t&&(o.jc("ngIf",e.isOpen&&e.data),o.Bb(1),o.jc("ngIf",!e.isOpen&&e.data),o.Bb(1),o.jc("ngIf",!e.isOpen&&e.actor&&!e.data),o.Bb(1),o.jc("ngIf",e.isOpen&&e.actor&&!e.data),o.Bb(1),o.jc("ngIf",!e.data&&!e.actor))},encapsulation:2}),t})();function bp(t,e){if(1&t&&(o.Rb(0,"h3",13),o.Lc(1),o.Qb()),2&t){const t=o.bc().category,e=o.bc();o.Bb(1),o.Nc(" ",e.L("meta.ui.reward."+t+"_title")," ")}}function mp(t,e){if(1&t&&o.Ob(0,"h3",21),2&t){const t=o.bc().$implicit;o.jc("innerHTML",t.description.title,o.Ac)}}function pp(t,e){if(1&t&&o.Ob(0,"div",22),2&t){const t=o.bc().$implicit;o.jc("innerHTML",t.description.text,o.Ac)}}function gp(t,e){if(1&t&&(o.Rb(0,"figure"),o.Ob(1,"img",23),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.jc("src",t.description.icon,o.Cc)}}function fp(t,e){if(1&t&&(o.Rb(0,"div",18),o.Jc(1,mp,1,1,"h3",19),o.Jc(2,pp,1,1,"div",20),o.Jc(3,gp,2,1,"figure",9),o.Qb()),2&t){const t=e.$implicit;o.Bb(1),o.jc("ngIf",t.description&&t.description.title),o.Bb(1),o.jc("ngIf",t.description&&t.description.text),o.Bb(1),o.jc("ngIf",t.description&&t.description.icon)}}function vp(t,e){if(1&t&&(o.Rb(0,"div",16),o.Jc(1,fp,4,3,"div",17),o.Qb()),2&t){const t=e.$implicit,i=e.index,n=o.bc(3);o.Fb("single","single"==n.appearance)("active",n.sliderData.activeType=="description_"+i),o.Bb(1),o.jc("ngForOf",t)}}function yp(t,e){if(1&t&&(o.Rb(0,"div",14),o.Jc(1,vp,2,5,"div",15),o.Qb()),2&t){const t=o.bc().calculatedRewards;o.Bb(1),o.jc("ngForOf",t.description)}}function _p(t,e){if(1&t&&(o.Rb(0,"h4",26),o.Lc(1),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.Mc(t.L("meta.ui.reward.resources"))}}function kp(t,e){if(1&t&&(o.Rb(0,"div",27),o.Ob(1,"currency",28),o.Qb()),2&t){const t=e.$implicit,i=o.bc(3);o.Fb("spaced-bottom","inline"===i.appearance),o.Bb(1),o.jc("value",t.campaignId&&t.amount[t.campaignId]?t.amount[t.campaignId].cat():t.amount.cat())("type",t.currency?t.currency:t.key)("smallSize","inline"===i.appearance)("animated",!0)("largestSize","single"==i.appearance)}}function wp(t,e){if(1&t&&(o.Rb(0,"div",18),o.Jc(1,_p,2,1,"h4",24),o.Jc(2,kp,2,7,"div",25),o.Qb()),2&t){const t=o.bc().calculatedRewards,e=o.bc();o.Fb("single","single"==e.appearance)("active","resources"==e.sliderData.activeType)("single-flex","single"==e.appearance),o.Bb(1),o.jc("ngIf","inline"!==e.appearance&&"single"!==e.appearance),o.Bb(1),o.jc("ngForOf",t.resources)}}function Sp(t,e){if(1&t&&(o.Rb(0,"h4",26),o.Lc(1),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.Mc(t.L("meta.ui.reward.units"))}}function Ip(t,e){if(1&t&&(o.Rb(0,"div",37),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).$implicit;o.Bb(1),o.Nc("x",t.amount,"")}}function Cp(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,Ip,2,1,"div",35),o.Ob(2,"unit",36),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.jc("ngIf",t.amount),o.Bb(1),o.jc("data",t.unit)("campaignId",t.campaignId?t.campaignId:"")}}function Lp(t,e){if(1&t&&(o.Rb(0,"div",38),o.Ob(1,"img",39),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.jc("src","assets/img/rewards-unit/"+t.unit.image+".png",o.Cc)}}function Rp(t,e){if(1&t&&(o.Rb(0,"div",43),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).$implicit;o.Bb(1),o.Nc("x",t.amount,"")}}function Op(t,e){if(1&t&&(o.Rb(0,"div",44),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).$implicit,e=o.bc(4);o.Bb(1),o.Mc(e.L("unit."+t.unitId+".short"))}}function Tp(t,e){if(1&t&&(o.Rb(0,"div",40),o.Jc(1,Rp,2,1,"div",41),o.Jc(2,Op,2,1,"div",42),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(4);o.Fb("dlc-show",e.dlcShow),o.Bb(1),o.jc("ngIf",t.amount),o.Bb(1),o.jc("ngIf",t.unitId)}}function xp(t,e){if(1&t&&(o.Rb(0,"div",32),o.Jc(1,Cp,3,3,"div",9),o.Jc(2,Lp,2,1,"div",33),o.Jc(3,Tp,3,4,"div",34),o.Qb()),2&t){const t=o.bc(4);o.Bb(1),o.jc("ngIf",!t.dlcShow),o.Bb(1),o.jc("ngIf",t.dlcShow),o.Bb(1),o.jc("ngIf","single"==t.appearance)}}function Bp(t,e){if(1&t&&(o.Rb(0,"div",18),o.Rb(1,"div",30),o.Jc(2,xp,4,3,"div",31),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=e.index,n=o.bc(3);o.Fb("active",n.sliderData.activeType=="unit_"+i)("reward-item-dlc",n.dlcShow)("single","single"==n.appearance),o.Bb(2),o.jc("ngForOf",t)}}function jp(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,Sp,2,1,"h4",24),o.Jc(2,Bp,3,7,"div",29),o.Qb()),2&t){const t=o.bc().calculatedRewards,e=o.bc();o.Bb(1),o.jc("ngIf","inline"!==e.appearance&&"single"!==e.appearance),o.Bb(1),o.jc("ngForOf",t.unit)}}function Mp(t,e){if(1&t&&(o.Rb(0,"h4",26),o.Lc(1),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.Mc(t.L("meta.ui.reward.commander"))}}function Qp(t,e){if(1&t&&(o.Rb(0,"div",32),o.Rb(1,"div",46),o.Rb(2,"figure",47),o.Ob(3,"img",48),o.Rb(4,"figcaption"),o.Lc(5),o.Qb(),o.Qb(),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=o.bc(4);o.Bb(1),o.kc("tooltip-hint",null==t.hint?null:t.hint.markdown().br()),o.Bb(2),o.jc("src",t.commander.image?"assets/img/commanders/"+t.commander.image+".png":"assets/img/commanders/"+t.commander._id+".png",o.Cc),o.Bb(2),o.Nc(" ",i.L("commander."+t.commander._id+".name")," ")}}function Ap(t,e){if(1&t&&(o.Rb(0,"span"),o.Jc(1,Qp,6,3,"div",31),o.Qb()),2&t){const t=e.$implicit,i=o.bc(3);o.Fb("reward-list","single"==i.appearance),o.Bb(1),o.jc("ngForOf",t)}}function Dp(t,e){if(1&t&&(o.Rb(0,"div",18),o.Jc(1,Mp,2,1,"h4",24),o.Rb(2,"div"),o.Jc(3,Ap,2,3,"span",45),o.Qb(),o.Qb()),2&t){const t=o.bc().calculatedRewards,e=o.bc();o.Bb(1),o.jc("ngIf","inline"!==e.appearance&&"single"!==e.appearance),o.Bb(1),o.Fb("reward-list","single"!==e.appearance),o.Bb(1),o.jc("ngForOf",t.commander)}}function Ep(t,e){if(1&t&&(o.Rb(0,"div"),o.Ob(1,"img",48),o.Rb(2,"div",53),o.Rb(3,"div",54),o.Lc(4),o.Qb(),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=o.bc(4);o.Bb(1),o.jc("src",t.commander.image?"assets/img/commanders_full/"+t.commander.image+"_big.png":"assets/img/commanders_full/"+t.commander._id+"_big.png",o.Cc),o.Bb(3),o.Mc(i.L("commander."+t.commander._id+".name"))}}function Np(t,e){if(1&t&&(o.Rb(0,"div",51),o.Jc(1,Ep,5,2,"div",52),o.Qb()),2&t){const t=e.$implicit,i=e.index,n=o.bc(3);o.Fb("active",n.sliderData.activeType=="commander_"+i),o.Bb(1),o.jc("ngForOf",t)}}function Fp(t,e){if(1&t&&(o.Rb(0,"div",49),o.Jc(1,Np,2,3,"div",50),o.Qb()),2&t){const t=o.bc().calculatedRewards;o.Bb(1),o.jc("ngForOf",t.commander)}}function Pp(t,e){if(1&t&&(o.Rb(0,"h4",26),o.Lc(1),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.Mc(t.L("meta.ui.reward.campaign"))}}function Up(t,e){if(1&t&&o.Ob(0,"campaign",58),2&t){const t=o.bc().$implicit;o.jc("campaign",t.campaign)("noHover",!0)}}function zp(t,e){if(1&t&&(o.Rb(0,"h2"),o.Lc(1),o.Qb()),2&t){const t=o.bc(5);o.Bb(1),o.Mc(t.L("meta.campaign."+t.campaign.id+".name"))}}function Jp(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,Up,1,2,"campaign",57),o.Jc(2,zp,2,1,"h2",9),o.Qb()),2&t){const t=e.$implicit;o.Bb(1),o.jc("ngIf",t.campaign),o.Bb(1),o.jc("ngIf",!t.campaign&&t.campaignId)}}function qp(t,e){if(1&t&&(o.Rb(0,"div",56),o.Jc(1,Jp,3,2,"div",52),o.Qb()),2&t){const t=e.$implicit;o.Bb(1),o.jc("ngForOf",t)}}function Vp(t,e){if(1&t&&(o.Rb(0,"div",18),o.Jc(1,Pp,2,1,"h4",24),o.Rb(2,"div",30),o.Jc(3,qp,2,1,"div",55),o.Qb(),o.Qb()),2&t){const t=o.bc().calculatedRewards,e=o.bc();o.Fb("single","single"==e.appearance)("active","campaign"==e.sliderData.activeType),o.Bb(1),o.jc("ngIf","inline"!==e.appearance&&"single"!==e.appearance),o.Bb(2),o.jc("ngForOf",t.campaign)}}function $p(t,e){if(1&t&&(o.Rb(0,"div",43),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).$implicit;o.Bb(1),o.Nc("x",t.amount,"")}}function Gp(t,e){if(1&t&&(o.Rb(0,"div",44),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).$implicit,e=o.bc(4);o.Bb(1),o.Oc("",e.L("meta.ui.profile.profile_portrait"),": ",e.L("meta.shop.item.portrait."+t.portrait),"")}}function Hp(t,e){if(1&t&&(o.Rb(0,"div",40),o.Jc(1,$p,2,1,"div",41),o.Jc(2,Gp,2,2,"div",42),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.jc("ngIf",t.amount),o.Bb(1),o.jc("ngIf",t.portrait)}}function Yp(t,e){if(1&t&&(o.Rb(0,"li",62),o.Rb(1,"div",63),o.Ob(2,"img",64),o.Qb(),o.Jc(3,Hp,3,2,"div",65),o.Qb()),2&t){const t=e.$implicit,i=o.bc(4);o.Bb(2),o.jc("src","assets/img/portraits/"+t.portrait+".png",o.Cc),o.Bb(1),o.jc("ngIf","single"==i.appearance)}}function Wp(t,e){if(1&t&&(o.Rb(0,"div",18),o.Rb(1,"ul",60),o.Jc(2,Yp,4,2,"li",61),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=e.index,n=o.bc(3);o.Fb("single","single"==n.appearance)("active",n.sliderData.activeType=="portrait_"+i),o.Bb(2),o.jc("ngForOf",t)}}function Kp(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,Wp,3,5,"div",59),o.Qb()),2&t){const t=o.bc().calculatedRewards;o.Bb(1),o.jc("ngForOf",t.portrait)}}function Xp(t,e){if(1&t&&(o.Rb(0,"div",43),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).$implicit;o.Bb(1),o.Nc("x",t.amount,"")}}function Zp(t,e){if(1&t&&(o.Rb(0,"div",44),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).$implicit,e=o.bc(4);o.Bb(1),o.Oc("",e.L("meta.ui.profile.profile_wreath"),": ",e.L("meta.shop.item.wreath."+t.wreath),"")}}function tg(t,e){if(1&t&&(o.Rb(0,"div",40),o.Jc(1,Xp,2,1,"div",41),o.Jc(2,Zp,2,2,"div",42),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.jc("ngIf",t.amount),o.Bb(1),o.jc("ngIf",t.wreath)}}function eg(t,e){if(1&t&&(o.Rb(0,"li"),o.Rb(1,"figure",66),o.Ob(2,"img",67),o.Ob(3,"img",68),o.Ob(4,"img",69),o.Qb(),o.Jc(5,tg,3,2,"div",65),o.Qb()),2&t){const t=e.$implicit,i=o.bc(4);o.Bb(2),o.jc("src","assets/img/portraits/deluxe_oreol_"+t.wreath+".svg",o.Cc),o.Bb(1),o.jc("src","assets/img/portraits/deluxe_wreath_"+t.wreath+".svg",o.Cc),o.Bb(1),o.jc("src","assets/img/portraits/deluxe_tape_"+t.wreath+".svg",o.Cc),o.Bb(1),o.jc("ngIf","single"==i.appearance)}}function ig(t,e){if(1&t&&(o.Rb(0,"div",18),o.Rb(1,"ul",60),o.Jc(2,eg,6,4,"li",52),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=e.index,n=o.bc(3);o.Fb("single","single"==n.appearance)("active",n.sliderData.activeType=="wreath_"+i),o.Bb(2),o.jc("ngForOf",t)}}function ng(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,ig,3,5,"div",59),o.Qb()),2&t){const t=o.bc().calculatedRewards;o.Bb(1),o.jc("ngForOf",t.wreath)}}function sg(t,e){if(1&t&&(o.Rb(0,"div",3),o.Jc(1,bp,2,1,"h3",4),o.Rb(2,"div"),o.Jc(3,yp,2,1,"div",5),o.Rb(4,"div",6),o.Jc(5,wp,3,8,"div",7),o.Qb(),o.Rb(6,"div",8),o.Jc(7,jp,3,2,"div",9),o.Jc(8,Dp,4,4,"div",10),o.Jc(9,Fp,2,1,"div",11),o.Jc(10,Vp,4,6,"div",12),o.Jc(11,Kp,2,1,"div",9),o.Jc(12,ng,2,1,"div",9),o.Qb(),o.Qb(),o.Qb()),2&t){const t=e.category,i=e.calculatedRewards,n=o.bc();o.Fb("active","single"==n.appearance&&n.sliderData.activeCategory==t),o.jc("ngClass",n.appearance),o.Bb(1),o.jc("ngIf",i.totalLength&&!n.dlcShow&&"inline"!=n.appearance),o.Bb(1),o.Fb("grid-rewards","column"==n.appearance&&i.resources&&i.resources.length)("full","full"==n.appearance),o.Bb(1),o.jc("ngIf",i&&i.description&&i.description.length),o.Bb(2),o.jc("ngIf",i&&i.resources&&i.resources.length),o.Bb(1),o.Fb("full-width","single"==n.appearance),o.Bb(1),o.jc("ngIf",i&&i.unit&&i.unit.length),o.Bb(1),o.jc("ngIf",i&&i.commander&&i.commander.length&&"single"!==n.appearance),o.Bb(1),o.jc("ngIf","single"==n.appearance&&i&&i.commander&&i.commander.length),o.Bb(1),o.jc("ngIf",i&&i.campaign&&i.campaign.length),o.Bb(1),o.jc("ngIf",i&&i.portrait&&i.portrait.length),o.Bb(1),o.jc("ngIf",i&&i.wreath&&i.wreath.length)}}function ag(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",70),o.Yb("click",function(){return o.zc(t),o.bc().getNextReward()}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc();o.Fb("disabled",t.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L(t.sliderData.categoryIndex>=t.sliderData.allCategories.length-1&&t.sliderData.typeIndex>=t.sliderData.allTypesforCategory.length-1?"meta.ui.reward.button_done":"meta.ui.play.next"),"\n")}}const rg=function(t){return{category:"campaign",calculatedRewards:t}};function og(t,e){if(1&t&&o.Pb(0,71),2&t){const t=o.bc(),e=o.wc(1);o.jc("ngTemplateOutlet",e)("ngTemplateOutletContext",o.nc(2,rg,t.categoryRewards.campaign))}}const cg=function(t){return{category:"multiplayer",calculatedRewards:t}};function lg(t,e){if(1&t&&o.Pb(0,71),2&t){const t=o.bc(),e=o.wc(1);o.jc("ngTemplateOutlet",e)("ngTemplateOutletContext",o.nc(2,cg,t.categoryRewards.multiplayer))}}let ug=(()=>{class t{constructor(t){this.cache=t,this.appearance="",this.rewards=[],this.campaignId="",this.dlcShow=!1,this.buttonsLocked=!1,this.onRewardFinished=new o.o,this.rewardCategories=[dg.Description,dg.Resources,dg.Units,dg.Commander,dg.Campaign,dg.Wreath,dg.Portrait],this.resourceCurrencies=[hg.Silver,hg.FreeXp,hg.Gold,hg.LeaguePoint],this.gerenalRewardsCategories=[bg.Campaign,bg.Multiplayer],this.categoryRewards={campaign:{},multiplayer:{}},this.sliderData={categoryIndex:0,activeCategory:"",allCategories:[],typeIndex:0,allTypesforCategory:"",activeType:""},this.maxPerSlide=3,(new al).data.subscribe(t=>this.L=t)}ngOnInit(){}ngOnChanges(t){t&&t.rewards&&(this.setRewards(t.rewards.currentValue),"single"==this.appearance&&this.setSliderData())}setRewards(t){t&&t.length&&(this.calculateHardGold(t),this.setCampaignCurrency(t),this.setCampaignData(t),this.categoryRewards=this.setRewardsByCategory(t))}setCampaignData(t){t&&t.length&&t.forEach((t,e)=>{if(t.key==dg.Campaign&&t.campaignId){let e=this.cache.getCampaign(t.campaignId);e&&(e.army=hu.getArmy(e)?hu.getArmy(e):"",t.campaign=e)}})}setCampaignCurrency(t){t&&t.length&&t.forEach((t,e)=>{t.key==hg.Silver&&t.campaignId&&(t.currency=this.cache.getCampaign(t.campaignId)&&this.cache.getCampaign(t.campaignId).currency?this.cache.getCampaign(t.campaignId).currency:"")})}calculateHardGold(t){if(!t||!t.length)return;let e=0,i=0,n=0;t.forEach((t,n)=>{t.key==hg.HardGold&&t.amount&&(e=t.amount),t.key==hg.Gold&&t.amount&&(i=t.amount)}),n=i+e,t.map((t,e)=>{t.key==hg.Gold&&t.amount&&(t.amount=n)})}setRewardsByCategory(t){let e={campaign:{},multiplayer:{}},i=[],n=[];for(let s of t)s.campaignId?n.push(s):i.push(s);return n.length&&(e.campaign=this.setRewardsByType(n)),i.length&&(e.multiplayer=this.setRewardsByType(i)),e}setRewardsByType(t){let e={},i=0,n=[];for(let s of t)s.key&&this.resourceCurrencies.includes(s.key)&&n.push(s);for(let s of this.rewardCategories){s==dg.Resources&&n.length&&(e[dg.Resources]=n,i+=1),s==dg.Commander&&t.filter(t=>t.key==s).map(t=>{t.hint=this.getCommandersTooltip(t)});let a=t.filter(t=>t.key==s);a&&a.length&&(this.dlcShow&&s==dg.Units||s==dg.Commander?(e[s]=this.divideRewardsBySlide(a,1,s),i+=1):a.length>=this.maxPerSlide?(e[s]=this.divideRewardsBySlide(a,this.maxPerSlide,s),i+=1):(e[s]=[],e[s].push(a),i+=1))}return e.totalLength=i,e}divideRewardsBySlide(t,e,i){let n=[],s=0;for(let a=0;a<=t.length;a++){let i=e*a+e;if(i<=t.length){let e=t.slice(s,i);s=i,n.push(e)}}return n}setSliderData(){this.sliderData.categoryIndex=0,this.sliderData.allCategories=this.allSliderCategories(),this.sliderData.activeCategory=this.setActiveCategory(this.sliderData.categoryIndex),this.sliderData.typeIndex=0,this.sliderData.allTypesforCategory=this.allSliderTypes(),this.sliderData.activeType=this.setActiveType(this.sliderData.typeIndex)}allSliderCategories(){let t=[];for(let e of this.gerenalRewardsCategories)this.categoryRewards[e]&&this.categoryRewards[e].totalLength&&t.push(e);return t}allSliderTypes(){let t=[];for(let e in this.categoryRewards[this.sliderData.activeCategory])if("totalLength"!=e)if(this.categoryRewards[this.sliderData.activeCategory][e].length&&e!==dg.Resources)for(let[i,n]of this.categoryRewards[this.sliderData.activeCategory][e].entries())t.push(e+"_"+i);else t.push(e);return t}setActiveCategory(t){let e="";return e=this.sliderData.allCategories[t],e}setActiveType(t){let e="";return e=this.sliderData.allTypesforCategory[t],e}getNextReward(){"single"===this.appearance&&(this.sliderData.typeIndex<this.sliderData.allTypesforCategory.length-1?(this.cache.alertSound("ui_click_default"),this.sliderData.typeIndex++,this.sliderData.activeType=this.setActiveType(this.sliderData.typeIndex)):this.sliderData.categoryIndex<this.sliderData.allCategories.length-1?(this.sliderData.categoryIndex++,this.sliderData.activeCategory=this.setActiveCategory(this.sliderData.categoryIndex),this.sliderData.allTypesforCategory=this.allSliderTypes(),this.sliderData.typeIndex=0,this.sliderData.activeType=this.setActiveType(this.sliderData.typeIndex)):(this.cache.alertSound("ui_dlc"),this.onRewardFinished.emit(!0)))}getCommandersTooltip(t){if(t&&t.commander)return`<h4>${this.L("commander."+t.commander.id+".name")}</h4><div class="paragraph">${this.L("meta.ui.commander.type."+t.commander.type)+": "+this.L("meta.ui.troops.speciality."+t.commander.speciality)+", "+this.L("meta.ui.menu.nation."+t.commander.army)}</div>`}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd))},t.\u0275cmp=o.Hb({type:t,selectors:[["rewards"]],hostVars:8,hostBindings:function(t,e){2&t&&o.Fb("full","full"===e.appearance)("column","column"===e.appearance)("inline","inline"===e.appearance)("single","single"===e.appearance)},inputs:{appearance:"appearance",rewards:"rewards",taskSequencePrice:"taskSequencePrice",campaignId:"campaignId",dlcShow:"dlcShow",buttonsLocked:"buttonsLocked"},outputs:{onRewardFinished:"onRewardFinished"},features:[o.Ab([nd]),o.zb],decls:5,vars:3,consts:[["categoryTemplate",""],["type","button","class","button large",3,"alertSound","disabled","click",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],[1,"category-cover",3,"ngClass"],["class","spaced-bottom category-title",4,"ngIf"],["class","description","g-description","",4,"ngIf"],["g-resources","",1,"resources"],["class","reward-box",3,"single","active","single-flex",4,"ngIf"],["g-rewards","",1,"rewards"],[4,"ngIf"],["class","reward-box",4,"ngIf"],["class","reward-item-full",4,"ngIf"],["class","reward-box",3,"single","active",4,"ngIf"],[1,"spaced-bottom","category-title"],["g-description","",1,"description"],["class","spaced-top reward-box align-center","fade-in","down",3,"single","active",4,"ngFor","ngForOf"],["fade-in","down",1,"spaced-top","reward-box","align-center"],["class","reward-box",4,"ngFor","ngForOf"],[1,"reward-box"],[3,"innerHTML",4,"ngIf"],["class","spaced-top-larger",3,"innerHTML",4,"ngIf"],[3,"innerHTML"],[1,"spaced-top-larger",3,"innerHTML"],[3,"src"],["class","spaced-bottom-small",4,"ngIf"],["fade-in","down",3,"spaced-bottom",4,"ngFor","ngForOf"],[1,"spaced-bottom-small"],["fade-in","down"],[3,"value","type","smallSize","animated","largestSize"],["class","reward-box",3,"active","reward-item-dlc","single",4,"ngFor","ngForOf"],[1,"reward-list"],["class","item","fade-in","down",4,"ngFor","ngForOf"],["fade-in","down",1,"item"],["class","large-unit-image",4,"ngIf"],["class","detail",3,"dlc-show",4,"ngIf"],["class","unit-count",4,"ngIf"],[3,"data","campaignId"],[1,"unit-count"],[1,"large-unit-image"],["image-load","","draggable","false",1,"image-unit",3,"src"],[1,"detail"],["class","count",4,"ngIf"],["class","title",4,"ngIf"],[1,"count"],[1,"title"],[3,"reward-list",4,"ngFor","ngForOf"],[1,"commander",3,"tooltip-hint"],[1,"texture-border"],["image-load","","draggable","false",3,"src"],[1,"reward-item-full"],["class","item",3,"active",4,"ngFor","ngForOf"],[1,"item"],[4,"ngFor","ngForOf"],["fade-in","down",1,"caption"],[1,"reward-item-title"],["class","item campaign-item","fade-in","down",4,"ngFor","ngForOf"],["fade-in","down",1,"item","campaign-item"],["class","tile texture-border",3,"campaign","noHover",4,"ngIf"],[1,"tile","texture-border",3,"campaign","noHover"],["class","reward-box",3,"single","active",4,"ngFor","ngForOf"],[1,"clear","avatars-list"],["class","avatar-item round",4,"ngFor","ngForOf"],[1,"avatar-item","round"],[1,"image-contain"],["draggable","false",1,"user-image",3,"src"],["class","detail",4,"ngIf"],[1,"image-contain","user-image"],["draggable","false",1,"oreol",3,"src"],["draggable","false",1,"wreat",3,"src"],["draggable","false",1,"tape",3,"src"],["type","button",1,"button","large",3,"alertSound","click"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,e){1&t&&(o.Jc(0,sg,13,18,"ng-template",null,0,o.Kc),o.Jc(2,ag,2,4,"button",1),o.Jc(3,og,1,4,"ng-container",2),o.Jc(4,lg,1,4,"ng-container",2)),2&t&&(o.Bb(2),o.jc("ngIf","single"==e.appearance),o.Bb(1),o.jc("ngIf",e.categoryRewards.campaign),o.Bb(1),o.jc("ngIf",e.categoryRewards.multiplayer))},encapsulation:2}),t})();var dg=function(t){return t.Units="unit",t.Commander="commander",t.Resources="resources",t.Campaign="campaign",t.Wreath="wreath",t.Portrait="portrait",t.Description="description",t}({}),hg=function(t){return t.Silver="silver",t.FreeXp="free_xp",t.Gold="gold",t.HardGold="hard_gold",t.LeaguePoint="league_point",t}({}),bg=function(t){return t.Campaign="campaign",t.Multiplayer="multiplayer",t}({});let mg=(()=>{class t{constructor(){this.name="",this.search="",this.nickname="",this.hash=""}ngOnInit(){this.parseName()}ngOnChanges(t){this.parseName()}parseName(){this.nickname=this.search?this.name.nickname().name.replace(new RegExp(`^(${this.search.escapeSpecialChars()})`,"gim"),"<mark>$1</mark>"):this.name.nickname().name,this.hash=this.name.nickname().hash}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Hb({type:t,selectors:[["nickname"]],inputs:{name:"name",search:"search"},features:[o.Ab([]),o.zb],decls:4,vars:3,consts:[[3,"tooltip-hint"],[3,"innerHTML"],[1,"hash"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Ob(1,"div",1),o.Rb(2,"span",2),o.Lc(3),o.Qb(),o.Qb()),2&t&&(o.kc("tooltip-hint",e.name),o.Bb(1),o.jc("innerHTML",e.nickname,o.Ac),o.Bb(2),o.Mc(e.hash))},directives:[tp],encapsulation:2}),t})();function pg(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",1,2),o.Rb(2,"div",3),o.Rb(3,"button",4),o.Yb("click",function(){return o.zc(t),o.bc().decline()}),o.Lc(4,"\xd7"),o.Qb(),o.Rb(5,"h2",5),o.Lc(6),o.Qb(),o.Ob(7,"article",6),o.Rb(8,"ul",7),o.Rb(9,"li",8),o.Rb(10,"button",9),o.Yb("click",function(){return o.zc(t),o.bc().confirm()}),o.Lc(11),o.Qb(),o.Qb(),o.Rb(12,"li",8),o.Rb(13,"button",10),o.Yb("click",function(){return o.zc(t),o.bc().decline()}),o.Lc(14),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(3),o.kc("tooltip-hint",t.L("meta.hint.modal.close")),o.jc("alertSound","ui_click_default"),o.Bb(3),o.Mc(t.L(t.invitationData.options.title)),o.Bb(1),o.jc("innerHTML",t.L(t.invitationData.options.key,t.invitationData.data).markdown().br(),o.Ac),o.Bb(3),o.kc("tooltip-hint",t.L(t.invitationData.options.hint?t.invitationData.options.hint.confirm:t.invitationData.options.confirm)),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L(t.invitationData.options.confirm)),o.Bb(1),o.Nc(" ",t.L(t.invitationData.options.confirm)," "),o.Bb(2),o.kc("tooltip-hint",t.L(t.invitationData.options.hint?t.invitationData.options.hint.decline:t.invitationData.options.decline)),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L(t.invitationData.options.decline)),o.Bb(1),o.Nc(" ",t.L(t.invitationData.options.decline)," ")}}let gg=(()=>{class t{constructor(t){this.cache=t,this.onOpen=new o.o,this.onClose=new o.o,this.confirmed=!1,this.declined=!1,this.opened=!1,this.active=!1,this.invitationData=null,this.globalEvent=new uu,this.localizator=new al,this.localizator.data.subscribe(t=>{this.L=t}),this.globalEvent.subscribe(t=>{t&&t&&"invitation.close"==t.key&&this.close()})}ngOnDestroy(){this.reset()}open(t){t&&(this.invitationData=t,this.opened=!0,this.cache.alertSound("popup"),setTimeout(()=>{this.active=!0,this.onOpen.emit(this)}))}close(){this.active=!1,setTimeout(()=>{this.opened=!1,this.onClose.emit(this)})}confirm(){this.confirmed=!0,this.invitationData&&this.invitationData.callback&&this.invitationData.callback(),this.close(),this.reset(),Object(Pc.a)("[\u2713] Invitation confirmed")}decline(){this.declined=!0,this.invitationData&&this.invitationData.declineCallback&&this.invitationData.declineCallback(),this.close(),this.reset(),Object(Pc.a)("[x] Invitation declined")}reset(){this.confirmed=!1,this.declined=!1}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd))},t.\u0275cmp=o.Hb({type:t,selectors:[["invitation-confirm"]],hostVars:4,hostBindings:function(t,e){2&t&&o.Fb("opened",e.opened)("active",e.active)},outputs:{onOpen:"onOpen",onClose:"onClose"},decls:1,vars:1,consts:[["class","request-popup",4,"ngIf"],[1,"request-popup"],["invitationModal",""],[1,"popup-inner"],["type","button",1,"close",3,"tooltip-hint","alertSound","click"],[1,"title"],[3,"innerHTML"],[1,"buttons-list","clear"],[1,"item"],["type","button",1,"button","secondary","faded-in",3,"tooltip-hint","alertSound","click"],["type","button",1,"button","transparent","faded-in",3,"tooltip-hint","alertSound","click"]],template:function(t,e){1&t&&o.Jc(0,pg,15,12,"div",0),2&t&&o.jc("ngIf",e.invitationData)},encapsulation:2}),t})();const fg=["bugReportModal"];function vg(t,e){if(1&t&&(o.Rb(0,"div",28),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.L("meta.hint.bug_report.error_hint.required"))}}const yg=function(){return{min:10,max:50}};function _g(t,e){if(1&t&&(o.Rb(0,"div",28),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.L("meta.hint.bug_report.error_hint.length",o.mc(1,yg)))}}function kg(t,e){if(1&t&&(o.Rb(0,"div",28),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.L("meta.hint.bug_report.error_hint.required"))}}const wg=function(){return{min:20,max:5e3}};function Sg(t,e){if(1&t&&(o.Rb(0,"div",28),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.L("meta.hint.bug_report.error_hint.length",o.mc(1,wg)))}}const Ig=function(t){return{maximum:t}};function Cg(t,e){if(1&t&&(o.Rb(0,"div",29),o.Ob(1,"small",30),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("innerHTML",t.L("meta.hint.bug_report.attachments_tip",o.nc(1,Ig,t.maximumScreenshotsAmount)).markdown().br(),o.Ac)}}function Lg(t,e){if(1&t&&(o.Rb(0,"figure"),o.Ob(1,"img",39),o.Lc(2),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.jc("src",t.preview.src,o.Cc),o.Bb(1),o.Oc(" ",t.preview.width,"x",t.preview.height," ")}}function Rg(t,e){if(1&t&&o.Ob(0,"img",40),2&t){const t=o.bc().$implicit;o.jc("src",t.image.src,o.Cc)}}function Og(t,e){1&t&&(o.Rb(0,"span",41),o.Lc(1,"error"),o.Qb())}function Tg(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",34),o.Yb("mouseenter",function(){return e.$implicit.hover=!1})("mouseleave",function(){return e.$implicit.hover=!1}),o.Jc(1,Lg,3,3,"figure",35),o.Jc(2,Rg,1,1,"img",36),o.Jc(3,Og,2,0,"span",37),o.Rb(4,"button",38),o.Yb("click",function(){o.zc(t);const i=e.index;return o.bc(2).removeFile(i)}),o.Lc(5,"\xd7"),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Bb(1),o.jc("ngIf",t.preview),o.Bb(1),o.jc("ngIf",t.hover),o.Bb(1),o.jc("ngIf",!t.preview),o.Bb(1),o.kc("tooltip-hint",i.L("meta.hint.bug_report.attachment_remove")),o.jc("alertSound","ui_click_default")}}function xg(t,e){if(1&t&&(o.Rb(0,"div",29),o.Lc(1),o.Rb(2,"scrollable",31),o.Rb(3,"ul",32),o.Jc(4,Tg,6,5,"li",33),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Oc(" ",t.L("meta.ui.menu.bug_report.attachments")," (",t.attachments.length,") "),o.Bb(3),o.jc("ngForOf",t.attachments)}}let Bg=(()=>{class t{constructor(t){this.cache=t,this.maximumScreenshotsAmount=5,this.localizator=new al,this.attachments=[],this.localizator.data.subscribe(t=>{this.L=t})}ngOnInit(){this.form=(new Ic).group({type:["game"],title:["",[io.required,io.minLength(10)]],message:["",[io.required,io.minLength(20)]]}),this.ifError=kd.bind(this.form),this.ifSuccess=wd.bind(this.form),this.cache.bugReportModal.subscribe(t=>{t?this.bugReportModal&&this.bugReportModal.open():this.bugReportModal&&this.bugReportModal.opened&&this.bugReportModal.close()})}reload(){location.href.match(/noAlert\=1/gim)?location.reload():this.cache.alertReload()}reset(){location.href.match(/noAlert\=1/gim)?this.cache.reset():this.cache.alertReset()}control(t){return this.form.controls[t]}submit(){if(yd(this.form),this.form.valid){let t=this.form.value;this.cache.report(t.title,t.message,t.type,this.attachments),this.form.controls.type.setValue("game"),this.form.controls.title.setValue(""),this.form.controls.message.setValue(""),this.attachments=[],this.bugReportModal.close()}}hideBugReportModal(){this.cache.hideBugReportModal()}attachFile(t){if(this.attachments.length>=5)return console.warn("too many screenshots man, chill");let e=(t.clipboardData||t.originalEvent.clipboardData).items;for(let i in e){let t=e[i];if("file"===t.kind){let e=t.getAsFile(),i=new FileReader;i.onload=e=>{this.attachments.push(new jg("ImageName",t.type,e.target.result,this.cache.unitSize)),console.log("attachments",this.attachments)},i.readAsDataURL(e)}}}removeFile(t){this.attachments[t]&&setTimeout(()=>{this.attachments.splice(t,1)},5)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd))},t.\u0275cmp=o.Hb({type:t,selectors:[["bug-report"]],viewQuery:function(t,e){if(1&t&&o.Fc(fg,!0),2&t){let t;o.vc(t=o.Zb())&&(e.bugReportModal=t.first)}},decls:53,vars:45,consts:[[3,"header","id","onClose"],["bugReportModal",""],[3,"formGroup"],[1,"body","collapsed-top","collapsed-bottom"],[3,"innerHTML"],[1,"body","collapsed-bottom","nowrap"],[1,"checkbox","inline"],["type","radio","value","game","id","bugReportGame","formControlName","type"],["for","bugReportGame",3,"tooltip-hint"],["type","radio","value","metagame","id","bugReportMetagame","formControlName","type"],["for","bugReportMetagame",3,"tooltip-hint"],["type","radio","value","proposal","id","bugReportProposal","formControlName","type"],["for","bugReportProposal",3,"tooltip-hint"],["type","radio","value","other","id","bugReportOther","formControlName","type"],["for","bugReportOther",3,"tooltip-hint"],[1,"body"],[1,"form-group"],["type","text","maxlength","50","formControlName","title",1,"input"],["class","error-hint",4,"ngIf"],[1,"body","collapsed-top"],["rows","4","maxlength","5000","formControlName","message",1,"input","scrolled",3,"paste"],["class","body collapsed-top","style","height: calc(var(--unit-height) * 1.8)",4,"ngIf"],[1,"body","collapsed-top","align-right"],[1,"button","secondary",3,"alertSound","click"],[1,"button","transparent","margin-left",3,"alertSound","click"],[1,"or"],[2,"line-height","1.1","display","block"],["type","button",1,"button","transparent",3,"tooltip-hint","alertSound","click"],[1,"error-hint"],[1,"body","collapsed-top",2,"height","calc(var(--unit-height) * 1.8)"],[2,"line-height","1.42","display","block","height","calc(var(--unit-height) + var(--unit-list-gutter))",3,"innerHTML"],[2,"height","calc(var(--unit-height) + var(--unit-list-gutter))"],[1,"clear","attachments-list"],[3,"mouseenter","mouseleave",4,"ngFor","ngForOf"],[3,"mouseenter","mouseleave"],[4,"ngIf"],["image-load","","class","large-preview",3,"src",4,"ngIf"],["class","error",4,"ngIf"],["data-tooltip","\xd7",1,"button","transparent","small","round",3,"tooltip-hint","alertSound","click"],["image-load","",3,"src"],["image-load","",1,"large-preview",3,"src"],[1,"error"]],template:function(t,e){if(1&t){const t=o.Sb();o.Rb(0,"modal",0,1),o.Yb("onClose",function(){return e.hideBugReportModal()}),o.Rb(2,"form",2),o.Rb(3,"div",3),o.Rb(4,"article"),o.Ob(5,"p",4),o.Qb(),o.Qb(),o.Rb(6,"div",5),o.Rb(7,"div",6),o.Ob(8,"input",7),o.Rb(9,"label",8),o.Lc(10),o.Qb(),o.Qb(),o.Rb(11,"div",6),o.Ob(12,"input",9),o.Rb(13,"label",10),o.Lc(14),o.Qb(),o.Qb(),o.Rb(15,"div",6),o.Ob(16,"input",11),o.Rb(17,"label",12),o.Lc(18),o.Qb(),o.Qb(),o.Rb(19,"div",6),o.Ob(20,"input",13),o.Rb(21,"label",14),o.Lc(22),o.Qb(),o.Qb(),o.Qb(),o.Rb(23,"div",15),o.Rb(24,"div",16),o.Ob(25,"input",17),o.Jc(26,vg,2,1,"div",18),o.Jc(27,_g,2,2,"div",18),o.Qb(),o.Qb(),o.Rb(28,"div",19),o.Rb(29,"div",16),o.Rb(30,"textarea",20),o.Yb("paste",function(t){return e.attachFile(t)}),o.Qb(),o.Jc(31,kg,2,1,"div",18),o.Jc(32,Sg,2,2,"div",18),o.Qb(),o.Qb(),o.Jc(33,Cg,2,3,"div",21),o.Jc(34,xg,5,3,"div",21),o.Qb(),o.Rb(35,"div",22),o.Rb(36,"button",23),o.Yb("click",function(){return e.submit()}),o.Lc(37),o.Qb(),o.Rb(38,"button",24),o.Yb("click",function(){return o.zc(t),o.wc(1).close()}),o.Lc(39),o.Qb(),o.Qb(),o.Rb(40,"div",19),o.Rb(41,"article"),o.Rb(42,"div",25),o.Rb(43,"span"),o.Lc(44),o.Qb(),o.Qb(),o.Rb(45,"p"),o.Rb(46,"small",26),o.Lc(47),o.Rb(48,"button",27),o.Yb("click",function(){return e.reload()}),o.Lc(49),o.Qb(),o.Lc(50),o.Rb(51,"button",27),o.Yb("click",function(){return e.reset()}),o.Lc(52),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb()}2&t&&(o.jc("header",e.L("meta.ui.menu.bug_report.title"))("id","bug_report"),o.Bb(2),o.jc("formGroup",e.form),o.Bb(3),o.jc("innerHTML",e.L("meta.ui.menu.bug_report.message").br(),o.Ac),o.Bb(4),o.kc("tooltip-hint",e.L("meta.hint.bug_report.game")),o.Bb(1),o.Mc(e.L("meta.ui.menu.bug_report.option.game")),o.Bb(3),o.kc("tooltip-hint",e.L("meta.hint.bug_report.metagame")),o.Bb(1),o.Mc(e.L("meta.ui.menu.bug_report.option.metagame")),o.Bb(3),o.kc("tooltip-hint",e.L("meta.hint.bug_report.proposal")),o.Bb(1),o.Mc(e.L("meta.ui.menu.bug_report.option.proposal")),o.Bb(3),o.kc("tooltip-hint",e.L("meta.hint.bug_report.other")),o.Bb(1),o.Mc(e.L("meta.ui.menu.bug_report.option.other")),o.Bb(2),o.Fb("error",e.ifError("title"))("success",e.ifSuccess("title")),o.Bb(1),o.Cb("placeholder",e.L("meta.hint.bug_report.placeholder."+e.control("type").value+".title")),o.Bb(1),o.jc("ngIf",e.ifError("title")&&!e.control("title").value),o.Bb(1),o.jc("ngIf",e.ifError("title")&&e.control("title").value),o.Bb(2),o.Fb("error",e.ifError("message"))("success",e.ifSuccess("message")),o.Bb(1),o.Cb("placeholder",e.L("meta.hint.bug_report.placeholder."+e.control("type").value+".message")),o.Bb(1),o.jc("ngIf",e.ifError("message")&&!e.control("message").value),o.Bb(1),o.jc("ngIf",e.ifError("message")&&e.control("message").value),o.Bb(1),o.jc("ngIf",!e.attachments.length),o.Bb(1),o.jc("ngIf",e.attachments.length),o.Bb(2),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L("meta.ui.menu.bug_report.send_button")),o.Bb(1),o.Nc(" ",e.L("meta.ui.menu.bug_report.send_button")," "),o.Bb(1),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L("meta.ui.exchange.cancel_button")),o.Bb(1),o.Nc(" ",e.L("meta.ui.exchange.cancel_button")," "),o.Bb(5),o.Mc(e.L("meta.hint.bug_report.or")),o.Bb(3),o.Nc(" ",e.L("meta.hint.bug_report.message")," "),o.Bb(1),o.kc("tooltip-hint",e.L("meta.hint.bug_report.reload")),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L("meta.ui.menu.bug_report.reload_button")),o.Bb(1),o.Mc(e.L("meta.ui.menu.bug_report.reload_button")),o.Bb(1),o.Nc(" ",e.L("meta.hint.bug_report.or")," "),o.Bb(1),o.kc("tooltip-hint",e.L("meta.hint.bug_report.clear")),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L("meta.ui.menu.bug_report.clear_button")),o.Bb(1),o.Mc(e.L("meta.ui.menu.bug_report.clear_button")))},encapsulation:2}),t})();class jg{constructor(t,e,i,n){this.hover=!1,this.id="thumb_"+Math.randomInt(1e3,9999),this.name=t,this.type=e,this.data=i,this.image=new Image,this.image.onload=()=>{let t=this.image.width/this.image.height,e=this.image.height/n.y,i=new yl(2.3333*n.y,n.y);_u.resizeImage(this.image,new yl(this.image.width/e,this.image.height/e),"image/jpeg").then(e=>{t>2.3333?_u.cropImage(e,i,"image/jpeg").then(t=>{this.preview=t}):this.preview=e})},this.image.src=i}}const Mg={"%cp":{tooltip:{battle_rank:"battleRank",amount_slot:"amount.limit",level:"level",cost:""}},"%crew":{tooltip:{data:[{dataKey:"unit.%id%.actors",label:"L.actor.%id%.name",value:"%count%",auto:!0}]}},"%survival":{tooltip:{data:[{dataKeys:["hp","structure"],label:"L.meta.ui.unit.unit_props.%key%",value:"I.unit.%id%.%key%"},{dataKeys:["armor_body.front","armor_body.back","armor_body.side","armor_body.cover"],label:"L.meta.ui.unit.unit_props.%key%",value:"I.unit.%id%.%key%",title:"L.meta.ui.unit.unit_props.armor_body.title"},{dataKeys:["armor_turret.front","armor_turret.back","armor_turret.side","armor_turret.cover"],label:"L.meta.ui.unit.unit_props.%key%",value:"I.unit.%id%.%key%",title:"L.meta.ui.unit.unit_props.armor_turret.title"}]}},"%speed":{},"%visor":{tooltip:{data:[{dataKeys:["around","sector"],label:"L.meta.ui.unit.unit_props.visor_%key%",value:"I.unit.%id%.visor.%key%"}]}},"%weapons":{ammoKeys:["detonation.human","detonation.vehicle","hit.human","hit.vehicle","piercing","spread_radius"],ammoRanges:{"detonation.human":[0,3,6,9],"detonation.vehicle":[0,3,6,9],"hit.human":[30,60,90,120],"hit.vehicle":[30,60,90,120],piercing:[30,60,90,120],spread_radius:[30,60,90,120]},ammoUnits:{"detonation.human":"xp","detonation.vehicle":"xp","hit.human":"xp","hit.vehicle":"xp",piercing:"millimeters",spread_radius:"meters"},weaponKeys:["caliber","filling_amount","rate_of_fire","recharge_time","shots_per_minute"],tooltip:{data:[{dataKey:"unit.%id%.weapons",label:"L.weapon.%id%",value:"%count%",auto:!0}]}},"%weapon_main":{tooltip:{data:[{dataKeys:["caliber","filling_amount","rate_of_fire",".recharge_time","shots_per_minute"],label:"L.meta.ui.unit.unit_props.%key%",value:"I.weapon.%id%.%key%",id:"%id%",weapon:"I.unit.%id%.weapon_main"}]},ammoKeys:[{key:"detonation.vehicle",range:"high"},{key:"hit.human",range:"high"},{key:"hit.vehicle",range:"high"},{key:"piercing",range:"high"},{key:"spread_radius",range:"low"}],hiddenInPopup:!0},abilities:{},advantages:{},disadvantages:{}};function Qg(t,e){if(1&t&&(o.Rb(0,"div",11),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).tooltip;o.Bb(1),o.Mc(t.value)}}function Ag(t,e){1&t&&o.Ob(0,"img",18)}function Dg(t,e){if(1&t&&(o.Rb(0,"span",19),o.Lc(1),o.Qb()),2&t){const t=o.bc(3),e=t.tooltip,i=t.compare,n=t.compareIndex,s=o.bc();o.Bb(1),o.Oc(" ",e.value-i[n].value>0?"+":""," ",s.countDifference(e.value,i[n].value)," ")}}function Eg(t,e){if(1&t&&(o.Rb(0,"div",23),o.Lc(1),o.Qb()),2&t){const t=o.bc().$implicit;o.Cb("data-postfix",t.value),o.Bb(1),o.Nc(" ",t.label.toLowerCase()," ")}}function Ng(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,Eg,2,2,"div",32),o.Qb()),2&t){const t=e.$implicit;o.Bb(1),o.jc("ngIf",t.value)}}function Fg(t,e){if(1&t&&(o.Rb(0,"div",31),o.Jc(1,Ng,2,1,"div",21),o.Qb()),2&t){const t=o.bc(3).$implicit;o.Bb(1),o.jc("ngForOf",t.characteristics)}}function Pg(t,e){if(1&t&&(o.Rb(0,"div"),o.Ob(1,"ap-graph",34),o.Qb()),2&t){const t=o.bc(),e=t.index,i=t.$implicit,n=o.bc(5).$implicit,s=o.bc(6);o.Bb(1),o.Fb("spaced",e>0),o.jc("unitId",s.unit.id)("tooltipData",s.tooltip)("id",i.id)("data",i.values)("item",n)("distances",i.range)("title",s.L("meta.ui.unit.unit_props."+i.id))("labels",i.labels)("units",i.units)("type","range")}}function Ug(t,e){if(1&t&&(o.Rb(0,"li"),o.Jc(1,Pg,2,12,"div",6),o.Qb()),2&t){const t=e.$implicit;o.Bb(1),o.jc("ngIf",!t.isEmpty)}}function zg(t,e){if(1&t&&(o.Rb(0,"div"),o.Rb(1,"ul",33),o.Jc(2,Ug,2,1,"li",21),o.Qb(),o.Qb()),2&t){const t=o.bc(4).$implicit;o.Bb(2),o.jc("ngForOf",t.ammo.graph)}}function Jg(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,zg,3,1,"div",6),o.Qb()),2&t){const t=o.bc(3).$implicit;o.Bb(1),o.jc("ngIf",t.ammo.ammos&&t.ammo.ammos[0])}}function qg(t,e){if(1&t&&(o.Rb(0,"div",27),o.Rb(1,"accordeon",28),o.Rb(2,"div",29),o.Jc(3,Fg,2,1,"div",30),o.Jc(4,Jg,2,1,"div",6),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc(2).$implicit;o.Bb(1),o.jc("label",t.label)("open",!1)("tooltip",t.label),o.Bb(2),o.jc("ngIf",t.characteristics),o.Bb(1),o.jc("ngIf",t.ammo)}}function Vg(t,e){if(1&t&&(o.Rb(0,"div"),o.Rb(1,"span"),o.Lc(2),o.Qb(),o.Qb()),2&t){const t=o.bc(2).$implicit;o.Bb(2),o.Mc(t.label)}}function $g(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",35),o.Yb("click",function(){o.zc(t);const e=o.bc(2).$implicit;return o.bc(6).openGraph(e)}),o.Ob(1,"img",18),o.Lc(2),o.Qb()}if(2&t){const t=o.bc(8);o.jc("alertSound","ui_click_default"),o.Bb(2),o.Nc(" ",t.L("meta.ui.unit.unit_props.chart")," ")}}function Gg(t,e){if(1&t&&(o.Rb(0,"div",23),o.Jc(1,qg,5,5,"div",24),o.Jc(2,Vg,3,1,"div",6),o.Rb(3,"div",25),o.Jc(4,$g,3,2,"button",26),o.Qb(),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(5).tooltip,i=o.bc();o.Fb("title",!t.value)("contain-accordeon","accordeon"==e.display)("with-button","weapons"===e.key&&i.chart),o.Cb("data-postfix",i.isNumber(t.value)?t.value.cat():""),o.Bb(1),o.jc("ngIf",e.display&&"accordeon"==e.display),o.Bb(1),o.jc("ngIf",!e.display||"accordeon"!==e.display),o.Bb(2),o.jc("ngIf","weapons"===e.key&&i.chart)}}function Hg(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,Gg,5,10,"div",22),o.Qb()),2&t){const t=e.$implicit;o.Bb(1),o.jc("ngIf","0"!==t.value)}}function Yg(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,Hg,2,1,"div",21),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.jc("ngForOf",t)}}function Wg(t,e){if(1&t&&(o.Rb(0,"div",20),o.Jc(1,Yg,2,1,"div",6),o.Qb()),2&t){const t=e.$implicit;o.Bb(1),o.jc("ngIf",!t.isEmpty)}}function Kg(t,e){if(1&t){const t=o.Sb();o.Rb(0,"details"),o.Rb(1,"summary",12),o.Yb("click",function(e){return o.zc(t),o.bc(3).onDetailsToggle(e)}),o.Rb(2,"h4"),o.Lc(3),o.Rb(4,"span",13),o.Jc(5,Ag,1,0,"img",14),o.Qb(),o.Qb(),o.Jc(6,Dg,2,2,"span",15),o.Qb(),o.Rb(7,"div",16),o.Jc(8,Wg,2,1,"div",17),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2),e=t.tooltip,i=t.compare,n=t.compareIndex,s=o.bc();o.Cb("title-id",e.key)("open",!!s.details[e.key]||null),o.Bb(1),o.jc("alertSound","ui_click_default"),o.Bb(2),o.Nc(" ",e.label," "),o.Bb(1),o.kc("tooltip-hint",s.L("meta.ui.unit.unit_props.chart")),o.Bb(1),o.jc("ngIf","weapons"===e.key&&s.chart),o.Bb(1),o.jc("ngIf",i&&e.value-i[n].value!=0&&s.isNumber(i[n].value)&&s.isNumber(e.value)),o.Bb(2),o.jc("ngForOf",e.tooltipData)}}function Xg(t,e){if(1&t&&(o.Rb(0,"span",19),o.Lc(1),o.Qb()),2&t){const t=o.bc(3),e=t.tooltip,i=t.compare,n=t.compareIndex,s=o.bc();o.Bb(1),o.Oc(" ",e.value-i[n].value>0?"+":"","",s.countDifference(e.value,i[n].value)," ")}}function Zg(t,e){if(1&t&&(o.Rb(0,"h4",13),o.Lc(1),o.Jc(2,Xg,2,2,"span",15),o.Qb()),2&t){const t=o.bc(2),e=t.tooltip,i=t.compare,n=t.compareIndex,s=o.bc();o.kc("tooltip-hint",e.tooltipData&&e.tooltipData.isEmpty&&"survival"==e.key?s.L("meta.ui.unit.unit_props.disadvantages.no_armor"):e.tooltipData&&e.tooltipData.isEmpty&&"weapon_main"==e.key?s.L("meta.ui.unit.unit_props.no_weapon_main"):""),o.Bb(1),o.Nc(" ",e.label," "),o.Bb(1),o.jc("ngIf",i&&e.value-i[n].value!=0&&s.isNumber(i[n].value)&&s.isNumber(e.value))}}function tf(t,e){if(1&t&&(o.Rb(0,"div",8),o.Jc(1,Qg,2,1,"div",9),o.Jc(2,Kg,9,8,"details",6),o.Jc(3,Zg,3,3,"h4",10),o.Qb()),2&t){const t=o.bc(),e=t.compare,i=t.tooltip,n=t.compareIndex,s=o.bc();o.Fb("positive",e&&i.value>e[n].value)("negative",e&&i.value<e[n].value),o.Bb(1),o.jc("ngIf",s.isNumber(i.value)),o.Bb(1),o.jc("ngIf",i.tooltipData&&!i.tooltipData.isEmpty),o.Bb(1),o.jc("ngIf",!i.tooltipData||i.tooltipData.isEmpty)}}function ef(t,e){if(1&t&&o.Jc(0,tf,4,7,"div",7),2&t){const t=e.tooltip;o.jc("ngIf",t.isRelative&&!t.hiddenInPopup)}}function nf(t,e){if(1&t&&(o.Rb(0,"h2",36),o.Lc(1),o.Qb(),o.Rb(2,"div"),o.Lc(3),o.Qb(),o.Rb(4,"div"),o.Lc(5),o.Qb()),2&t){const t=e.unit,i=o.bc();o.Fb("premium",t&&t.premium),o.Bb(1),o.Nc(" ",i.L("unit."+(null==t?null:t.id)+".short")," "),o.Bb(1),o.Fb("premium",t&&t.premium),o.Bb(1),o.Nc(" ",i.L("unit."+(null==t?null:t.id)+".type")," "),o.Bb(2),o.Nc(" ",i.fullDescription?i.L("unit."+(null==t?null:t.unit)+".desc").markdown():i.L("unit."+(null==t?null:t.unit)+".desc_short").markdown()," ")}}function sf(t,e){if(1&t&&o.Ob(0,"div",37),2&t){const t=e.unit,i=o.bc();o.jc("innerHTML",i.fullDescription?i.L("unit."+(null==t?null:t.unit)+".desc").markdown():i.L("unit."+(null==t?null:t.unit)+".desc_short").markdown(),o.Ac)}}function af(t,e){if(1&t&&(o.Rb(0,"h4",41),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).key,e=o.bc();o.Bb(1),o.Nc(" ",e.L("meta.ui.unit.unit_props."+t+".title")," ")}}function rf(t,e){if(1&t&&(o.Rb(0,"li"),o.Lc(1),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2).tooltip,n=o.bc();o.Bb(1),o.Nc(" ",n.L("meta.ui.unit.unit_props."+i.key+"."+t)," ")}}function of(t,e){if(1&t&&(o.Rb(0,"div",39),o.Jc(1,af,2,1,"h4",40),o.Rb(2,"ul"),o.Jc(3,rf,2,1,"li",21),o.Qb(),o.Qb()),2&t){const t=o.bc(),e=t.tooltip,i=t.key;o.Bb(1),o.jc("ngIf",e.value.length),o.Bb(1),o.Eb("clear ",i,""),o.Bb(1),o.jc("ngForOf",e.value)}}function cf(t,e){1&t&&o.Jc(0,of,4,5,"div",38),2&t&&o.jc("ngIf",!e.tooltip.isRelative)}const lf=function(t,e,i){return{tooltip:t,compare:e,compareIndex:i}};function uf(t,e){if(1&t&&(o.Rb(0,"div",43),o.Pb(1,44),o.Qb()),2&t){const t=e.$implicit,i=e.index,n=o.bc(2),s=o.wc(1);o.Bb(1),o.jc("ngTemplateOutlet",s)("ngTemplateOutletContext",o.pc(2,lf,t,n.compare?n.compare.tooltip:null,i))}}function df(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,uf,2,6,"div",42),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngForOf",t.tooltip)}}const hf=function(t){return{tooltip:t,key:"advantages"}},bf=function(t){return{tooltip:t,key:"disadvantages"}},mf=function(t){return{tooltip:t,key:"abilities"}};function pf(t,e){if(1&t&&(o.Rb(0,"div",43),o.Pb(1,44),o.Pb(2,44),o.Pb(3,44),o.Qb()),2&t){const t=o.bc(2),e=o.wc(7);o.Bb(1),o.jc("ngTemplateOutlet",e)("ngTemplateOutletContext",o.nc(6,hf,t.tooltipKeys.advantages)),o.Bb(1),o.jc("ngTemplateOutlet",e)("ngTemplateOutletContext",o.nc(8,bf,t.tooltipKeys.disadvantages)),o.Bb(1),o.jc("ngTemplateOutlet",e)("ngTemplateOutletContext",o.nc(10,mf,t.tooltipKeys.abilities))}}const gf=function(t){return{unit:t}};function ff(t,e){if(1&t&&(o.Rb(0,"div"),o.Rb(1,"div",43),o.Pb(2,44),o.Qb(),o.Jc(3,pf,4,12,"div",45),o.Qb()),2&t){const t=o.bc(),e=o.wc(5);o.Bb(2),o.jc("ngTemplateOutlet",e)("ngTemplateOutletContext",o.nc(3,gf,t.unit)),o.Bb(1),o.jc("ngIf",t.advantages)}}const vf=/[A-Za-z]/gim,yf="METAGAME_UNIT_INFO_TAB";let _f=(()=>{class t{constructor(){this.compare=null,this.itemIndex=0,this.header=!1,this.advantages=!1,this.description=!1,this.counters=!1,this.fullDescription=!1,this.chart=!1,this.tooltipKeys={},this.campaignId="",this.campaignCurrency="",this.details={},this.tab=localStorage.getItem(yf)||"statistics",this.globalEvent=new uu,(new al).data.subscribe(t=>this.L=t),(new dl).data.subscribe(t=>this.I=t)}ngOnInit(){this.tooltip=this.generateTooltip(this.unit),this.tooltip.map(t=>this.tooltipKeys[t.key]=t)}setTab(t){this.tab=t,localStorage.setItem(yf,t)}ngOnChanges(t){t&&t.unit&&t.unit.currentValue&&(this.unit=t.unit.currentValue,this.tooltip=this.generateTooltip(this.unit),this.tooltip.map(t=>this.tooltipKeys[t.key]=t)),t&&t.header&&t.header.currentValue&&(this.header=t.header.currentValue),t&&t.description&&t.description.currentValue&&(this.description=t.description.currentValue),t&&t.advantages&&t.advantages.currentValue&&(this.advantages=t.advantages.currentValue),t&&t.fullDescription&&t.fullDescription.currentValue&&(this.fullDescription=t.fullDescription.currentValue),t&&t.campaignId&&t.campaignId.currentValue&&(this.campaignId=t.campaignId.currentValue),t&&t.campaignCurrency&&t.campaignCurrency.currentValue&&(this.campaignCurrency=t.campaignCurrency.currentValue),t&&t.chart&&t.chart.currentValue&&(this.chart=t.chart.currentValue)}generateTooltip(t){let e=JSON.parse(JSON.stringify(Mg));return this.unwrapConfig(e,t)}unwrapConfig(t,e,i=!1){if(!e)return;let n=[];for(let s in t){let a,r,o=!1,c=!1;if("%"===s[0]&&(o=!0,t[s.substr(1)]=t[s],s=s.substr(1),delete t["%"+s]),"."===s[0]&&(c=!0,t[s.substr(1)]=t[s],s=s.substr(1),delete t["."+s]),"data"===s){for(let i=0;i<t[s].length;i++){let a=this.unwrapDataArray(t[s][i],e);n.push(a)}continue}if(a=this.L("meta.ui.unit.unit_props."+s),i)r=Iu(e,t[s]);else{let t=e&&e.id?this.I(`unit.${e.id}.${s}`):"";a=this.L(o?"meta.ui.unit.unit_props."+s:`meta.ui.unit.unit_props.${s}.title`),r=o?this.ifSringToNum(t):this.ifSringToArray(t)}let l={key:s,label:a,value:r,isRelative:o,tooltipData:t[s].tooltip?this.unwrapConfig(t[s].tooltip,e,!0):null,display:"",hiddenInPopup:!(!t[s].hiddenInPopup||1!=t[s].hiddenInPopup)};if("cost"===s&&(e.premium?(l.label=this.L("meta.ui.unit.unit_props.bonds_cost"),l.value=e.premiumGold):(l.label=e.collectible||!this.campaignCurrency?"":this.L(`meta.ui.unit.unit_props.${this.campaignCurrency}_cost`),l.value=e.collectible||!this.campaignCurrency?"":e.silverCost)),"visor"==s&&(l.value=this.I(`unit.${e.id}.visor.around`)),"weapons"==s){l.value=[""],l.display="accordeon";let e=l.tooltipData[0];for(let i=0;i<e.length;i++){let n=e[i],s=this.I(`weapon.${n.key}.ammo_id`),a={id:n.key,graph:[],ammos:Array.isArray(s)?s.map(e=>t.weapons.ammoKeys.map(i=>{let s=this.I(`weapon.${n.key}.ammo.${e}.${i}`);return{id:i,ammoId:e,weaponId:n.key,range:t.weapons.ammoRanges[i],units:this.L("meta.ui.unit.unit_props."+t.weapons.ammoUnits[i]),values:s.push?s:null,isEmpty:!s.push||s.max()<=0}})):null};a.graph.isEmpty=!0,t.weapons.ammoKeys.map(t=>{let e={id:t,values:[],labels:[],range:[],units:""};a.ammos&&a.ammos.length&&a.ammos.map(i=>{i.map(i=>{i.id===t&&(i.isEmpty||(e.values.push({[i.ammoId]:i.values||[0,0,0,0]}),e.range=i.range,e.units=i.units,e.labels.push(this.L("ammo."+i.ammoId))))})}),e.values.length&&(a.graph.push(e),a.graph.isEmpty=!1)}),n.ammo=a;let r=t.weapons.weaponKeys.map(t=>{let e=this.isNumber(this.I(`weapon.${n.key}.${t}`))?this.I(`weapon.${n.key}.${t}`):null;return{label:this.L("meta.ui.unit.unit_props."+t),value:e}});n.characteristics=r}}if("survival"==s&&(l.value=this.I(`unit.${e.id}.structure`)&&this.I(`unit.${e.id}.structure`)>0?this.I(`unit.${e.id}.structure`):this.I(`unit.${e.id}.hp`)),"weapon_main"==s){let i=this.I(`unit.${e.id}.weapon_main`);l.value=this.I(`weapon.${i}.power.total`)&&this.I(`weapon.${i}.power.total`)>0?this.I(`weapon.${i}.power.total`):"",l.value.toString().match(vf)&&(l.value=0);let n=this.I(`weapon.${i}.ammo_id`),s=t.weapon_main.ammoKeys.map(t=>({key:t.key,range:t.range,value:n&&n.length&&n.map?n.map(e=>this.I(`weapon.${i}.ammo.${e}.${t.key}`).push?"high"==t.range?Math.max.apply(null,this.I(`weapon.${i}.ammo.${e}.${t.key}`)):Math.min.apply(null,this.I(`weapon.${i}.ammo.${e}.${t.key}`)):null):null})).map(t=>({key:t.key,value:"high"==t.range?Math.max.apply(null,t.value):Math.min.apply(null,t.value),isFloat:c,label:this.L("meta.ui.unit.unit_props."+t.key)}));l.tooltipData[0]=l.tooltipData[0].concat(s)}l&&l.tooltipData&&(l.tooltipData.isEmpty=this.checkEmptyTooltipdata(l.tooltipData)),n.push(l)}return i&&!t.data?[n]:n}unwrapDataArray(t,e){let i,n=[],s=!0,a=!(!t.hiddenInPopup||!t.hiddenInPopup);if(t.title){if(!t.value)return[{label:this.unwrapLabelOrValue(t.title,[]),value:"",isTitle:!0}];n.push({label:this.unwrapLabelOrValue(t.title,[]),value:"",isTitle:!0})}if(t.weapon&&(i=this.unwrapLabelOrValue(t.weapon,[e]),n.push({label:this.unwrapLabelOrValue("L.weapon.%id%",[{id:i}]),value:""})),t.auto){let i=t.dataKey.injectVariables(e),a=this.I(i);if(a.push)for(let e=0;e<a.length;e++){let i=a[e];n.push({key:i.id,label:this.unwrapLabelOrValue(t.label,[i]),value:this.unwrapLabelOrValue(t.value,[i],!0)}),parseFloat(n.last().value)&&(s=!1)}else console.warn(`Tooltip broken (%c${i}%c)`,"font-weight: bold","font-weight: normal")}else for(let r=0;r<t.dataKeys.length;r++){let a=t.dataKeys[r],o=!1;"."===a[0]&&(o=!0,a=a.substr(1)),n.push({key:a,isFloat:o,label:this.unwrapLabelOrValue(t.label,[i?{id:i}:e,{key:a}]),value:this.unwrapLabelOrValue(t.value,[i?{id:i}:e,{key:a}],!0,o)}),parseInt(n.last().value)&&(s=!1)}return n.isEmpty=s,n.hiddenInPopup=a,n}unwrapLabelOrValue(t,e,i=!1,n=!1){let s="",a=t.match(/^(L|I)\./gim)?t.substr(2):t;for(let r=0;r<e.length;r++)a=a.injectVariables(e[r]);if(t.match(/^L\./gim))s=this.L(a);else if(t.match(/^I\./gim))s=this.I(a);else{s=a;for(let t=0;t<e.length;t++)s=s.injectVariables(e[t])}return i?(n?s.toString().match(vf)?0:parseFloat(s).toFixed(1).toString()||0:parseInt(s)||0).toString():s}isNumber(t){return!(t instanceof Array)&&t-parseFloat(t)+1>=0}ifSringToArray(t){return t.match?[]:t}ifSringToNum(t){return t.match?0:t}countDifference(t,e){return Math.round(100*(t-e))/100}checkEmptyTooltipdata(t){let e=[];return t.map(t=>{e.push(t.isEmpty)}),e.every(t=>1==t)}onDetailsToggle(t){t.preventDefault(),setTimeout(()=>{let e=t.target.closest("details").getAttribute("title-id");this.details[e]=!this.details[e],t.target.closest("details").open=this.details[e],console.log(this.details[e])},0)}openGraph(t){this.globalEvent.trigger("ap-graph-modal.open",{tooltip:this.tooltip,unitId:this.unit.id,weaponId:t.key,parameterId:t.ammo.graph[0].id})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Hb({type:t,selectors:[["unit-characteristics"]],inputs:{unit:"unit",compare:"compare",itemIndex:"itemIndex",header:"header",advantages:"advantages",description:"description",counters:"counters",fullDescription:"fullDescription",chart:"chart",campaignId:"campaignId",campaignCurrency:"campaignCurrency"},features:[o.zb],decls:15,vars:10,consts:[["tooltipCountTemplate",""],["headerTemplate",""],["descriptionTemplate",""],["tooltipListTemplate",""],[1,"margin-bottom-small","tabs-cover"],["type","button",1,"button","tab",3,"alertSound","click"],[4,"ngIf"],["class","item",3,"positive","negative",4,"ngIf"],[1,"item"],["class","count",4,"ngIf"],[3,"tooltip-hint",4,"ngIf"],[1,"count"],[3,"alertSound","click"],[3,"tooltip-hint"],["src","assets/img/icons/svg/chart.svg","class","icon",4,"ngIf"],["class","difference",4,"ngIf"],[1,"details-inner"],["class","tooltip-list clear",4,"ngFor","ngForOf"],["src","assets/img/icons/svg/chart.svg",1,"icon"],[1,"difference"],[1,"tooltip-list","clear"],[4,"ngFor","ngForOf"],["class","list-item",3,"title","contain-accordeon","with-button",4,"ngIf"],[1,"list-item"],["class","accordeon-cover",4,"ngIf"],[1,"button-cover"],["class","button transparent small","type","button",3,"alertSound","click",4,"ngIf"],[1,"accordeon-cover"],[1,"inline","small-accordeon",3,"label","open","tooltip"],[1,"spaced-inner"],["class","additional-characteristics top",4,"ngIf"],[1,"additional-characteristics","top"],["class","list-item",4,"ngIf"],[1,"clear"],[3,"unitId","tooltipData","id","data","item","distances","title","labels","units","type"],["type","button",1,"button","transparent","small",3,"alertSound","click"],[1,"title"],[3,"innerHTML"],["class","caption",4,"ngIf"],[1,"caption"],["class","subtitle",4,"ngIf"],[1,"subtitle"],["class","relatives",4,"ngFor","ngForOf"],[1,"relatives"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","relatives",4,"ngIf"]],template:function(t,e){1&t&&(o.Jc(0,ef,1,1,"ng-template",null,0,o.Kc),o.Jc(2,nf,6,7,"ng-template",null,1,o.Kc),o.Jc(4,sf,1,1,"ng-template",null,2,o.Kc),o.Jc(6,cf,1,1,"ng-template",null,3,o.Kc),o.Rb(8,"div",4),o.Rb(9,"button",5),o.Yb("click",function(){return e.setTab("information")}),o.Lc(10),o.Qb(),o.Rb(11,"button",5),o.Yb("click",function(){return e.setTab("statistics")}),o.Lc(12),o.Qb(),o.Qb(),o.Jc(13,df,2,1,"div",6),o.Jc(14,ff,4,5,"div",6)),2&t&&(o.Bb(9),o.Fb("active","information"===e.tab),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.button.information_unit")," "),o.Bb(1),o.Fb("active","statistics"===e.tab),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.button.statistics_unit")," "),o.Bb(1),o.jc("ngIf","statistics"===e.tab),o.Bb(1),o.jc("ngIf","information"===e.tab))},encapsulation:2}),t})();const kf=["selectBotModal"];function wf(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",12),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(2);return o.bc().setOption("nation",i),n.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Fb("active",i.nation===t),o.Bb(1),o.Fb("disabled",!i.states[t]||i.armyIs),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L("meta.ui.menu.nation."+t)),o.Bb(1),o.Nc(" ",i.L("meta.ui.menu.nation."+t)," ")}}function Sf(t,e){if(1&t&&(o.Rb(0,"div",7),o.Rb(1,"dropdown",8,9),o.Rb(3,"ul",10),o.Jc(4,wf,3,7,"li",11),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("text",t.L("meta.ui.menu.nation."+t.nation))("label",t.L("meta.ui.profile.preferences.army"))("origin","bottom"),o.Bb(3),o.jc("ngForOf",t.availableArmies)}}function If(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",16),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc(2);const n=o.wc(2);return o.bc().selectBotCommander(i),n.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(3);o.Fb("active",i.commander===t),o.Bb(1),o.kc("tooltip-hint",i.L("commander."+t.text+".desc")==="commander."+t.text+".desc"?"":"<h4>"+i.L("commander."+t.text+".name")+"</h4>\n"+i.L("commander."+t.text+".desc")),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L("commander."+t.text+".name").dropDashSpace().dropWords(i.botNameTrimTreshold)),o.Bb(1),o.Nc(" ",i.L("commander."+t.text+".name").dropDashSpace().dropWords(i.botNameTrimTreshold)," ")}}function Cf(t,e){if(1&t&&(o.Rb(0,"ul",10),o.Jc(1,If,3,6,"li",11),o.cc(2,"filterList"),o.cc(3,"filterList"),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2);o.Bb(1),o.jc("ngForOf",o.fc(2,1,o.fc(3,5,i.availableCommanders,"type",t),"army",i.nation))}}const Lf=function(){return["art","inf","tnk"]};function Rf(t,e){if(1&t&&(o.Rb(0,"div",7),o.Rb(1,"dropdown",8,13),o.Rb(3,"scrollable",14),o.Jc(4,Cf,4,9,"ul",15),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("text",t.commander?t.L("commander."+t.commander.text+".name").dropDashSpace().dropWords(t.botNameTrimTreshold):t.L("meta.ui.lobby.options.submode.none"))("label",t.L("meta.ui.play.troops"))("origin","bottom"),o.Bb(3),o.jc("ngForOf",o.mc(4,Lf))}}function Of(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",19),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(1);return o.bc(2).setOption("level",i),n.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(3);o.Fb("active",i.level===t),o.Bb(1),o.Fb("disabled",i.maxUnitLevel>0&&t>i.maxUnitLevel),o.kc("tooltip-hint",i.maxUnitLevel>0&&t>i.maxUnitLevel?i.L("meta.hint.lobby.blocked_by_settings"):""),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L("level."+t)),o.Bb(1),o.Nc(" ",i.L("level."+t)," ")}}function Tf(t,e){if(1&t&&(o.Rb(0,"dropdown",8,18),o.Rb(2,"ul",10),o.Jc(3,Of,3,8,"li",11),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.jc("text",t.L("meta.ui.lobby.options.unit_level."+t.level))("label",t.L("meta.ui.lobby.options.unit_level.label"))("origin","bottom"),o.Bb(3),o.jc("ngForOf",t.levels[t.commander.bot.group])}}function xf(t,e){if(1&t&&(o.Rb(0,"div",7),o.Jc(1,Tf,4,4,"dropdown",17),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf",t.commander)}}function Bf(t,e){if(1&t&&(o.Rb(0,"div",7),o.Ob(1,"empty",20),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("desc",t.L("meta.ui.lobby.select_bot.no_bots"))}}function jf(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",21),o.Rb(1,"button",22),o.Yb("click",function(){return o.zc(t),o.bc().acceptRandom()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(1),o.Fb("disabled",!t.availableCommanders.length),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.select_bot.button_random")," ")}}let Mf=(()=>{class t{constructor(t){this.cache=t,this.onSelect=new o.o,this._commanders=this.cache.getBotCommanders(),this.nation="rus",this.level=6,this.slotId=null,this.commander=null,this.states={},this.nations={},this.commanders=[],this.availableCommanders=[],this.availableCommander=null,this.levels={},this.maxUnitLevel=0,this.availableArmies=[],this.botNameTrimTreshold=50,this.mode="",(new al).data.subscribe(t=>this.L=t),console.log(this._commanders),this.states=this._commanders.states,this._commanders.commanders.map(t=>{this.levels[t.bot.group]||(this.levels[t.bot.group]=[],this.commanders.push(t)),this.levels[t.bot.group].push(t.bot.level),this.nations[t.army]||(this.nations[t.army]=[]),this.nations[t.army].push(t)})}open(t=null,e,i,n){this.slotId=t,this.maxUnitLevel=e||0,this.availableArmies=i&&i.length?i:["rus","ger","usa"],this.nation=this.availableArmies[0],this.mode=n,this.maxUnitLevel>0&&(this.level=this.maxUnitLevel),this.setAvailableCommanders(),this.modal&&this.modal.open()}hide(){this.modal&&this.modal.close(),this.slotId=null,this.maxUnitLevel=1,this.mode="",this.availableArmies=[],this.commander=null,this.availableCommanders=[],this.nation=""}selectBotCommander(t){this.commander=t,this.commander&&this.commander.bot&&(this.level=this.maxUnitLevel>0&&this.levels[this.commander.bot.group].last()>this.maxUnitLevel?this.maxUnitLevel:this.levels[this.commander.bot.group].last())}setOption(t,e){this[t]=e,"nation"===t&&(this.nation=e,this.selectBotCommander(this.nations[this.nation].filter(t=>t.tags&&t.tags.indexOf(this.mode)>-1)[0])),"level"===t&&(this.level=this.maxUnitLevel&&this.level>this.maxUnitLevel?this.maxUnitLevel:e)}setAvailableCommanders(){let t=this.commanders.filter(t=>t.tags&&t.tags.indexOf(this.mode)>-1);this.availableCommanders=t,this.selectBotCommander(this.nations[this.nation].filter(t=>t.tags&&t.tags.indexOf(this.mode)>-1)[0])}accept(){let t=this.nations[this.nation].filter(t=>t.tags&&t.tags.indexOf(this.mode)>-1).find(t=>t.bot.level===this.level&&t.text===this.commander.text)||this.commander;this.selectBot(this.slotId,t),this.hide()}acceptRandom(){this.selectBot(this.slotId,"empty"),this.hide()}selectBot(t,e){this.onSelect.emit({slotId:t,commander:e})}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd))},t.\u0275cmp=o.Hb({type:t,selectors:[["bot-select"]],viewQuery:function(t,e){if(1&t&&o.Qc(kf,!0),2&t){let t;o.vc(t=o.Zb())&&(e.modal=t.first)}},outputs:{onSelect:"onSelect"},features:[o.Ab([nd])],decls:11,vars:11,consts:[[1,"smaller",3,"id","header","onClose"],["selectBotModal",""],[1,"body"],["class","spaced-bottom-larger",4,"ngIf"],["class","align-center",4,"ngIf"],[1,"body","align-center"],["type","button",1,"button","large",3,"alertSound","click"],[1,"spaced-bottom-larger"],[3,"text","label","origin"],["nationDropdown",""],[1,"clear"],[3,"active",4,"ngFor","ngForOf"],["type","button","seek-link","",1,"button","block","transparent",3,"alertSound","click"],["commandersDropdown",""],[2,"height","30vh"],["class","clear",4,"ngFor","ngForOf"],["type","button",1,"button","block","transparent",3,"tooltip-hint","alertSound","click"],[3,"text","label","origin",4,"ngIf"],["levelDropdown",""],[1,"button","transparent","block",3,"alertSound","tooltip-hint","click"],[3,"desc"],[1,"align-center"],["type","button",1,"button",3,"alertSound","click"]],template:function(t,e){1&t&&(o.Rb(0,"modal",0,1),o.Yb("onClose",function(){return e.hide()}),o.Rb(2,"div",2),o.Jc(3,Sf,5,4,"div",3),o.Jc(4,Rf,5,5,"div",3),o.Jc(5,xf,2,1,"div",3),o.Jc(6,Bf,2,1,"div",3),o.Jc(7,jf,3,4,"div",4),o.Rb(8,"div",5),o.Rb(9,"button",6),o.Yb("click",function(){return e.accept()}),o.Lc(10),o.Qb(),o.Qb(),o.Qb(),o.Qb()),2&t&&(o.jc("id","select_commander")("header",e.L("meta.ui.lobby.select_bot.title")),o.Bb(3),o.jc("ngIf",e.commanders.length),o.Bb(1),o.jc("ngIf",e.availableCommanders.length),o.Bb(1),o.jc("ngIf",e.availableCommanders.length),o.Bb(1),o.jc("ngIf",!e.availableCommanders.length),o.Bb(1),o.jc("ngIf",e.availableCommanders.length),o.Bb(2),o.Fb("disabled",!e.availableCommanders.length),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.lobby.select_bot_add")," "))},encapsulation:2}),t})(),Qf=(()=>{class t{constructor(t){this.host=t,this.loaded=!1,this.error=!1,this.image=this.host.nativeElement}onLoad(t){this.loaded=!0}onError(t){Object(Pc.a)("[img] error",this.image.src),this.image.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=",this.error=!0}}return t.queue=[],t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m))},t.\u0275dir=o.Ib({type:t,selectors:[["","image-load",""]],hostVars:2,hostBindings:function(t,e){1&t&&o.Yb("load",function(t){return e.onLoad(t)})("error",function(t){return e.onError(t)}),2&t&&o.Fb("loaded",e.loaded)}}),t})();function Af(t,e){if(1&t&&o.Ob(0,"b"),2&t){const t=o.bc();o.Ic("min-width",t.getTextWidth(t.type))}}function Df(t,e){if(1&t&&(o.Rb(0,"div",6),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.L("meta.ui.store.currency."+t.type))}}let Ef=(()=>{class t{constructor(t){this.cache=t,this.value="",this.type="",this.campaignId="",this.animated=!1,this.smallSize=!1,this.largestSize=!1,this.unitCurrency=!1,this.campaignMoney=null,this.currentCampaign=null,(new al).data.subscribe(t=>this.L=t)}ngOnInit(){this.campaignId&&(this.currentCampaign=this.cache.getCampaign(this.campaignId),this.currentCampaign&&this.currentCampaign.progress&&this.currentCampaign.progress.money&&(this.campaignMoney=this.currentCampaign.progress.money)),"gold"==this.type&&(this.type="bonds")}getTextWidth(t){let e=0;switch(t){case"bonds":e=this.cache.getUserGold();break;case"silver":e=this.cache.getUserSilver();break;case"free_xp":e=this.campaignMoney?this.campaignMoney.freeXp:this.cache.getUserFreeXp();break;case"rub":case"rem":case"usd":e=this.campaignMoney?this.campaignMoney.silver:0}return e.cat().toString().length/2+1+"em"}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd))},t.\u0275cmp=o.Hb({type:t,selectors:[["currency"]],hostVars:6,hostBindings:function(t,e){2&t&&o.Fb("small",e.smallSize)("largest",e.largestSize)("smallest",e.unitCurrency)},inputs:{value:"value",type:"type",campaignId:"campaignId",animated:"animated",smallSize:"smallSize",largestSize:"largestSize",unitCurrency:"unitCurrency"},features:[o.Ab([nd])],decls:8,vars:7,consts:[[1,"currency-inner"],[1,"currency-image",3,"tooltip-hint"],["draggable","false","image-load","",1,"image-icon",3,"src"],[1,"currency-caption"],[3,"min-width",4,"ngIf"],["class","currency-title",4,"ngIf"],[1,"currency-title"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Rb(1,"figure",1),o.Ob(2,"img",2),o.Qb(),o.Rb(3,"div",3),o.Jc(4,Af,1,2,"b",4),o.Rb(5,"span"),o.Lc(6),o.Qb(),o.Qb(),o.Jc(7,Df,2,1,"div",5),o.Qb()),2&t&&(o.Bb(1),o.kc("tooltip-hint",e.L("meta.hint.store.currency."+e.type)),o.Bb(1),o.jc("src",e.smallSize||e.unitCurrency?"assets/img/icons/svg/"+e.type+".svg":"assets/img/icons/currency/"+e.type+".png",o.Cc),o.Bb(2),o.jc("ngIf",e.animated),o.Bb(1),o.Fb("animated",e.animated),o.Bb(1),o.Mc(e.value.cat()),o.Bb(1),o.jc("ngIf",e.largestSize))},directives:[tp,Qf,ee],encapsulation:2}),t})();function Nf(t,e){if(1&t&&(o.Rb(0,"div",7),o.Ob(1,"span",8),o.Rb(2,"span",9),o.Lc(3),o.Qb(),o.Qb()),2&t){const t=e.$implicit;o.Bb(1),o.Cb("style","background-color:"+t.color.getRGB(),o.Bc),o.Bb(2),o.Mc(t.label)}}function Ff(t,e){if(1&t&&(o.Rb(0,"div",5),o.Jc(1,Nf,4,2,"div",6),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngForOf",t.lines)}}function Pf(t,e){if(1&t&&(o.ac(),o.Rb(0,"text",16),o.Lc(1),o.Qb()),2&t){const t=e.$implicit,i=e.index,n=o.bc(2);o.Cb("x",n.margin.x*n.scale/1.5+"px")("y",n.getLabelY(i))("fill",n.gizmosColor.getRGB()),o.Bb(1),o.Mc(t)}}function Uf(t,e){if(1&t&&(o.ac(),o.Rb(0,"text",17),o.Lc(1),o.Qb()),2&t){const t=e.$implicit,i=e.index,n=o.bc(2);o.Cb("x",n.getLabelX(i))("y",n.size.y-n.margin.y*n.scale/3)("fill",n.gizmosColor.getRGB()),o.Bb(1),o.Mc(t)}}function zf(t,e){if(1&t&&(o.ac(),o.Ob(0,"rect",13)),2&t){const t=e.index,i=o.bc(2);o.Cb("x",i.getLabelX(t))("y",0)("width",1)("height",i.size.y)("fill",i.gizmosColor.getRGB())}}function Jf(t,e){if(1&t&&(o.ac(),o.Ob(0,"rect",13)),2&t){const t=e.index,i=o.bc(2);o.Cb("y",i.getLabelY(t))("x",i.margin.x)("width",i.size.x-i.margin.x)("height",1)("fill",i.gizmosColor.getRGB())}}function qf(t,e){if(1&t&&(o.ac(),o.Rb(0,"g"),o.Ob(1,"circle",19),o.Ob(2,"circle",20),o.Qb()),2&t){const t=e.index,i=o.bc().$implicit,n=o.bc(2);o.Bb(1),o.Fb("selected",n.tooltipEnabled&&n.tooltipLastIndex===t),o.Cb("cx",i.getX(t)+1)("cy",i.getY(t))("r",10*n.scale)("stroke",i.color.getRGB()),o.Bb(1),o.Cb("cx",i.getX(t)+1)("cy",i.getY(t))("r",5*n.scale)("stroke",i.color.getRGB())("fill",i.color.getRGB())}}function Vf(t,e){if(1&t&&(o.ac(),o.Rb(0,"g"),o.Rb(1,"g"),o.Ob(2,"path",18),o.Qb(),o.Rb(3,"g"),o.Jc(4,qf,3,11,"g",15),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=e.index,n=o.bc(2);o.Bb(2),o.Cb("d",n.getPath(i))("stroke",t.color.getRGB()),o.Bb(2),o.jc("ngForOf",t.points)}}function $f(t,e){if(1&t){const t=o.Sb();o.ac(),o.Rb(0,"svg",10),o.Yb("mousemove",function(e){return o.zc(t),o.bc().updateTooltipPosition(e)})("mouseleave",function(){return o.zc(t),o.bc().removeTooltip()}),o.Rb(1,"g"),o.Jc(2,Pf,2,4,"text",11),o.Jc(3,Uf,2,4,"text",12),o.Ob(4,"rect",13),o.Ob(5,"rect",13),o.Jc(6,zf,1,5,"rect",14),o.Jc(7,Jf,1,5,"rect",14),o.Qb(),o.Jc(8,Vf,5,3,"g",15),o.Qb()}if(2&t){const t=o.bc();o.Cb("width",t.size.x)("height",t.size.y),o.Bb(2),o.jc("ngForOf",t.labelsY),o.Bb(1),o.jc("ngForOf",t.labelsX),o.Bb(1),o.Cb("x",t.margin.x*t.scale)("y",0)("width",1)("height",t.size.y)("fill",t.gizmosColor.getRGB()),o.Bb(1),o.Cb("x",t.margin.x*t.scale)("y",t.size.y-t.margin.y*t.scale)("width",t.size.x-t.margin.x*t.scale-t.margin.y*t.scale)("height",1)("fill",t.gizmosColor.getRGB()),o.Bb(1),o.jc("ngForOf",t.labelsX),o.Bb(1),o.jc("ngForOf",t.labelsY),o.Bb(1),o.jc("ngForOf",t.lines)}}function Gf(t,e){if(1&t&&(o.Rb(0,"div",21),o.Ob(1,"div",22),o.Qb()),2&t){const t=o.bc();o.Ic("left",t.getTooltipLeft()+"px")("top","auto")("height",t.size.y-t.margin.y*t.scale+"px")("bottom",t.margin.y*t.scale+"px"),o.Fb("active",!0),o.Bb(1),o.Fb("reverse",1===t.tooltipPosition.y),o.jc("innerHTML",t.tooltip,o.Ac)}}function Hf(t,e){if(1&t&&(o.Rb(0,"th"),o.Lc(1),o.Qb()),2&t){const t=e.$implicit;o.Bb(1),o.Mc(t)}}function Yf(t,e){if(1&t&&(o.Rb(0,"td"),o.Lc(1),o.Qb()),2&t){const t=e.$implicit;o.Bb(1),o.Mc(t<1?t:t.cat())}}function Wf(t,e){if(1&t&&(o.Rb(0,"tr"),o.Rb(1,"td"),o.Lc(2),o.Qb(),o.Jc(3,Yf,2,1,"td",15),o.Qb()),2&t){const t=e.$implicit;o.Bb(2),o.Mc(t.label),o.Bb(1),o.jc("ngForOf",t.points)}}function Kf(t,e){if(1&t&&(o.Rb(0,"table",23),o.Rb(1,"caption"),o.Lc(2),o.Qb(),o.Rb(3,"thead"),o.Rb(4,"tr"),o.Ob(5,"th"),o.Jc(6,Hf,2,1,"th",15),o.Qb(),o.Qb(),o.Rb(7,"tbody"),o.Jc(8,Wf,4,2,"tr",15),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(2),o.Oc("",t.title,", ",t.units,""),o.Bb(4),o.jc("ngForOf",t.labelsX),o.Bb(2),o.jc("ngForOf",t.lines)}}function Xf(t,e){if(1&t&&(o.Rb(0,"dl"),o.Rb(1,"dt"),o.Lc(2),o.Qb(),o.Rb(3,"dd"),o.Lc(4),o.Qb(),o.Qb()),2&t){const t=e.$implicit;o.Bb(2),o.Mc(t.label),o.Bb(2),o.Oc("",t.points.min(),"-",t.points.max(),"")}}function Zf(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",24),o.Yb("click",function(){return o.zc(t),o.bc().openDetailModal()}),o.Rb(1,"div",25),o.Lc(2),o.Qb(),o.Jc(3,Xf,5,3,"dl",15),o.Qb()}if(2&t){const t=o.bc();o.jc("alertSound","ui_click_default"),o.Bb(2),o.Oc("",t.title,", ",t.units,""),o.Bb(1),o.jc("ngForOf",t.lines)}}const tv=["100","500","1 000","2 000"],ev=["0","50","100"];let iv=[];for(let cP=1;cP<5;cP++)for(let t=1;t<=10;t++)iv.push(t*(cP>2?1e3:cP>1?100:cP>0?10:1));let nv=(()=>{class t{constructor(t,e){this.cache=t,this.sanitizer=e,this.title="",this.units="",this.labels=[],this.type=sv.Range,this.lines=[],this.scale=1,this.margin=new yl(60,30),this.labelsX=tv,this.labelsY=[],this.gizmosColor=new pu(100,100,100),this.gizmosColor2=new pu(70,70,70),this.primaryColor=new pu(255,189,75),this.secondaryColor=new pu(177,198,100),this.tooltip="",this.tooltipEnabled=!1,this.tooltipPosition=new yl,this.tooltipPoints=[],this.tooltipLastIndex=-1,this.max=0,this.globalEvent=new uu,this.size=this.cache.unitSize.multiply(4),this.scale=this.size.x/4/192}ngOnInit(){pu.reset(),this.isSingle()&&(this.data=[this.data]);for(let t=0;t<this.distances.length;t++)"string"!=typeof this.distances[t]&&(this.distances[t]=this.distances[t].toString());this.labelsX=this.distances;for(let t=0;t<this.data.length;t++){let e=Object.keys(this.data[t])[0],i=this,n={id:e,label:this.labels&&this.labels.length?this.labels[t]:e,points:this.data[t][e],color:pu.next(),getX:function(t){return i.getX(t/(this.points.length-1))},getY:function(t){return i.getY(this.points[t])}};this.lines.push(n),this.data[t][e]&&(this.max=Math.max(this.data[t][e].max()||1,this.max)),this.labelsY=this._calculateScaledBar(),this.max=this.labelsY.maximum}}ngAfterViewChecked(){this.size.x!==this.cache.unitSize.x&&(this.size=this.cache.unitSize.multiply(4),this.scale=this.size.x/4/192)}isSingle(){return!this.data.length}_calculateScaledBar(){for(let t=0;t<iv.length;t++)if(this.max<iv[t]){let e=[0,iv[t]/2,iv[t]].map(t=>t.toString().cat());return e.maximum=iv[t],e}return ev}getX(t){let e=this.getGraphSize();return this.margin.x*this.scale+e.x*t}getY(t){let e=this.getGraphSize();return this.margin.y*this.scale+(e.y-e.y*(t/this.max))}getLabelY(t){let e=this.getGraphSize();return this.margin.y*this.scale+(e.y-e.y*(t/(this.labelsY.length-1)))}getLabelX(t){let e=this.getGraphSize();return this.margin.x*this.scale+e.x*(t/(this.labelsX.length-1))}getGraphSize(){return new yl(this.size.x-this.margin.x*this.scale-this.margin.y*this.scale,this.size.y-2*this.margin.y*this.scale)}getPath(t){let e=this.lines[t],i="";for(let n=0;n<e.points.length;n++)i+=0===n?`M ${e.getX(n)} ${e.getY(n)} L `:`${e.getX(n)} ${e.getY(n)} `,n<e.points.length-1&&n>1&&(i+=", ");return i}updateTooltipPosition(t){let e=this.getGraphSize(),i=t.target.closest("svg").getBoundingClientRect().left+this.margin.x;this.tooltipPosition.x=Math.clamp(t.clientX-i,i,e.x)+this.margin.x,this.tooltipPosition.y=this.tooltipPosition.x-this.margin.x>e.x/2?1:0,this.tooltipEnabled=!0,this.tooltipPoints=this.selectClosestPoints((this.tooltipPosition.x-this.margin.x)/e.x),this.tooltipLastIndex!==this.tooltipPoints.index&&(this.tooltipLastIndex=this.tooltipPoints.index,this.tooltip=this.getTooltip())}getTooltipLeft(){return this.getGraphSize(),this.getLabelX(this.tooltipLastIndex)}removeTooltip(){this.tooltipEnabled=!1}selectClosestPoints(t){this.getGraphSize();let e=1/3,i=Math.ceil(Math.clamp((t-e/2)/e,0,3)),n=[];n.index=i;for(let s=0;s<this.lines.length;s++)n.push({id:this.lines[s].id,label:this.lines[s].label,color:this.lines[s].color,value:this.lines[s].points[i]});return n}getTooltip(){let t=`<b>${this.labelsX[this.tooltipPoints.index]}m</b>`;for(let e=0;e<this.tooltipPoints.length;e++)t+=`<span><i style="background: ${this.tooltipPoints[e].color.getRGB()}"></i>${this.tooltipPoints[e].label}: ${this.tooltipPoints[e].value.cat()}</span>`;return this.sanitizer.bypassSecurityTrustHtml(t)}isGraphType(t){return t===this.type}openDetailModal(){this.globalEvent.trigger("ap-graph-modal.open",{tooltip:this.tooltipData,unitId:this.unitId,weaponId:this.item.key,parameterId:this.id})}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Er))},t.\u0275cmp=o.Hb({type:t,selectors:[["ap-graph"]],hostVars:6,hostBindings:function(t,e){2&t&&o.Fb("graph-style","graph"===e.type)("table-style","table"===e.type)("range-style","range"===e.type)},inputs:{unitId:"unitId",tooltipData:"tooltipData",id:"id",data:"data",item:"item",distances:"distances",title:"title",units:"units",labels:"labels",type:"type",max:"max"},features:[o.Ab([nd])],decls:5,vars:5,consts:[["class","tooltip-detail",4,"ngIf"],[3,"mousemove","mouseleave",4,"ngIf"],["class","tooltip-wrapper",3,"left","top","height","bottom","active",4,"ngIf"],["class","table lined",4,"ngIf"],[3,"alertSound","click",4,"ngIf"],[1,"tooltip-detail"],["class","item",4,"ngFor","ngForOf"],[1,"item"],[1,"shape"],[1,"title"],[3,"mousemove","mouseleave"],["text-anchor","end","alignment-baseline","middle",4,"ngFor","ngForOf"],["text-anchor","middle","alignment-baseline","hanging",4,"ngFor","ngForOf"],["stroke-width","0"],["stroke-width","0",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["text-anchor","end","alignment-baseline","middle"],["text-anchor","middle","alignment-baseline","hanging"],["fill","transparent","stroke-width","2",1,"line"],["stroke-width","0",1,"point-fake"],["stroke-width","0",1,"point"],[1,"tooltip-wrapper"],[1,"tooltip",3,"innerHTML"],[1,"table","lined"],[3,"alertSound","click"],[1,"ap-graph-range-title"]],template:function(t,e){1&t&&(o.Jc(0,Ff,2,1,"div",0),o.Jc(1,$f,9,17,"svg",1),o.Jc(2,Gf,2,13,"div",2),o.Jc(3,Kf,9,4,"table",3),o.Jc(4,Zf,4,4,"div",4)),2&t&&(o.jc("ngIf",e.lines&&e.isGraphType("graph")),o.Bb(1),o.jc("ngIf",e.isGraphType("graph")),o.Bb(1),o.jc("ngIf",e.isGraphType("graph")),o.Bb(1),o.jc("ngIf",e.isGraphType("table")),o.Bb(1),o.jc("ngIf",e.isGraphType("range")))},encapsulation:2}),t})();var sv=function(t){return t.Graph="graph",t.Table="table",t.Range="range",t}({});const av=["modal"];function rv(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.L("weapon."+t.weapons[t.weaponIndex].key))}}function ov(t,e){if(1&t&&(o.Rb(0,"span",20),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.L("meta.ui.unit.unit_props."+t.graph.id))}}function cv(t,e){if(1&t&&o.Ob(0,"ap-graph",21),2&t){const t=o.bc();o.jc("data",t.graph.values)("distances",t.graph.range)("title",t.L("meta.ui.unit.unit_props."+t.graph.id))("labels",t.graph.labels)("units",t.graph.units)("type","graph")}}function lv(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",24),o.Yb("click",function(){o.zc(t);const i=e.index,n=o.bc(2),s=o.wc(21);return n.setGraphIndex(i),s.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Bb(2),o.Mc(i.L("meta.ui.unit.unit_props."+t.id))}}function uv(t,e){if(1&t&&(o.Rb(0,"ul",22),o.Jc(1,lv,3,1,"li",23),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngForOf",t.weapons[t.weaponIndex].ammo.graph)}}let dv=[];for(let cP=1;cP<5;cP++)for(let t=1;t<=10;t++)dv.push(t*(cP>2?1e3:cP>1?100:cP>0?10:1));let hv=(()=>{class t{constructor(){this.globalEvent=new uu,this.tooltip=[],this.weapons=[],this.weaponIndex=0,this.graphIndex=0,this.graph=null,(new al).data.subscribe(t=>this.L=t),this.globalEvent.subject.pipe(We(t=>null!=t)).subscribe(t=>{"ap-graph-modal.open"===t.key&&(this.tooltip=t.data.tooltip,this.weapons=this.tooltip.find(t=>"weapons"===t.key).tooltipData[0],console.log(this.weapons),this.weaponIndex=this.weapons.findIndex(e=>e.key===t.data.weaponId),this.graphIndex=this.weapons[this.weaponIndex].ammo.graph.findIndex(e=>e.id===t.data.parameterId),this.injectUpdatedGraph(),this.openModal())})}openModal(){this.modal&&this.modal.open()}injectUpdatedGraph(){this.graph=null,this.graphIndex>=this.weapons[this.weaponIndex].ammo.graph.length&&(this.graphIndex=0),setTimeout(()=>{this.graph=this.weapons[this.weaponIndex].ammo.graph[this.graphIndex]})}onModalClose(){this.graph=null}setGraphIndex(t){this.graphIndex=t,this.injectUpdatedGraph()}nextWeapon(){this.weaponIndex++,this.weaponIndex>=this.weapons.length&&(this.weaponIndex=0),this.injectUpdatedGraph()}prevWeapon(){this.weaponIndex--,this.weaponIndex<=0&&(this.weaponIndex=this.weapons.length-1),this.injectUpdatedGraph()}prevGraph(){this.graphIndex--,this.graphIndex<0&&(this.graphIndex=this.weapons[this.weaponIndex].ammo.graph.length-1),this.injectUpdatedGraph()}nextGraph(){this.graphIndex++,this.graphIndex>=this.weapons[this.weaponIndex].ammo.graph.length&&(this.graphIndex=0),this.injectUpdatedGraph()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Hb({type:t,selectors:[["ap-graph-modal"]],viewQuery:function(t,e){if(1&t&&o.Qc(av,!0),2&t){let t;o.vc(t=o.Zb())&&(e.modal=t.first)}},features:[o.Ab([nd])],decls:26,vars:10,consts:[[1,"medium","transparent-background",3,"ignoreBackgroundClick","onClose"],["modal",""],[1,"body","align-center"],[4,"ngIf"],[1,"category-title"],["fade-in","",4,"ngIf"],[1,"body","collapsed-top",2,"height","calc(var(--unit-height) * 7.2)"],["fade-in","",3,"data","distances","title","labels","units","type",4,"ngIf"],[1,"body","collapsed-top"],[1,"bottom-dark"],[1,"row","align-middle"],[1,"col-2"],["type","button",1,"button","white","transparent",3,"alertSound","click"],["src","assets/img/icons/svg/arrow_left_white.svg",1,"icon"],[1,"col-8","align-center"],[2,"width","70%","margin","0 auto",3,"text","origin","label"],["graphsDropdown",""],["class","clear",4,"ngIf"],[1,"col-2","align-right"],["src","assets/img/icons/svg/arrow_right_white.svg",1,"icon"],["fade-in",""],["fade-in","",3,"data","distances","title","labels","units","type"],[1,"clear"],[4,"ngFor","ngForOf"],["type","button","ignore-modal-close","",1,"button","transparent","block",3,"click"]],template:function(t,e){1&t&&(o.Rb(0,"modal",0,1),o.Yb("onClose",function(){return e.onModalClose()}),o.Rb(2,"div",2),o.Rb(3,"h3"),o.Lc(4,"\xa0"),o.Jc(5,rv,2,1,"span",3),o.Lc(6,"\xa0"),o.Qb(),o.Rb(7,"h4",4),o.Lc(8,"\xa0"),o.Jc(9,ov,2,1,"span",5),o.Lc(10,"\xa0"),o.Qb(),o.Qb(),o.Rb(11,"div",6),o.Jc(12,cv,1,6,"ap-graph",7),o.Qb(),o.Rb(13,"div",8),o.Rb(14,"div",9),o.Rb(15,"div",10),o.Rb(16,"div",11),o.Rb(17,"button",12),o.Yb("click",function(){return e.prevGraph()}),o.Ob(18,"img",13),o.Qb(),o.Qb(),o.Rb(19,"div",14),o.Rb(20,"dropdown",15,16),o.Jc(22,uv,2,1,"ul",17),o.Qb(),o.Qb(),o.Rb(23,"div",18),o.Rb(24,"button",12),o.Yb("click",function(){return e.nextGraph()}),o.Ob(25,"img",19),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb()),2&t&&(o.jc("ignoreBackgroundClick",!1),o.Bb(5),o.jc("ngIf",e.weapons&&e.weapons.length),o.Bb(4),o.jc("ngIf",e.graph),o.Bb(3),o.jc("ngIf",e.graph),o.Bb(5),o.jc("alertSound","ui_click_default"),o.Bb(3),o.jc("text",e.graph?e.L("meta.ui.unit.unit_props."+e.graph.id):"")("origin","top")("label",""),o.Bb(2),o.jc("ngIf",e.graph),o.Bb(2),o.jc("alertSound","ui_click_default"))},encapsulation:2}),t})();function bv(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",1),o.Ob(1,"div",2),o.Rb(2,"div",3),o.Rb(3,"div",4),o.Ob(4,"span"),o.Lc(5),o.Qb(),o.Rb(6,"button",5),o.Yb("click",function(){return o.zc(t),o.bc().hide()}),o.Lc(7),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Fb("animated",t.animated),o.Bb(5),o.Nc("",t.label," "),o.Bb(1),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.exchange.cancel_button")),o.Bb(1),o.Nc(" ",t.L("meta.ui.exchange.cancel_button")," ")}}let mv=(()=>{class t{constructor(){this.active=!1,this.label="",this.animated=!1,t.instances.push(this),(new al).data.subscribe(t=>this.L=t)}ngOnInit(){}hide(){this.animated=!1,setTimeout(()=>{this.active=!1},250)}show(){this.active=!0,setTimeout(()=>{this.animated=!0},250)}}return t.instances=[],t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Hb({type:t,selectors:[["preloader"]],hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("active",e.active)},inputs:{active:"active",label:"label"},decls:1,vars:1,consts:[["class","preloader-inner verticaly-middle",3,"animated",4,"ngIf"],[1,"preloader-inner","verticaly-middle"],[1,"shadow"],[1,"inner","align-center"],[1,"preloader"],[1,"button","transparent",3,"alertSound","click"]],template:function(t,e){1&t&&o.Jc(0,bv,8,6,"div",0),2&t&&o.jc("ngIf",e.active)},encapsulation:2}),t})(),pv=(()=>{class t{constructor(){this.open=!1,this.disabled=!1,this.difficulty=0,this.onChange=new o.o,this.localizator=new al,this.difficulties=[0,1,2,3,4],this.difficultiesString=["novice","easy","normal","hard","nightmare"],this.localizator.data.subscribe(t=>{this.L=t}),document.addEventListener("mousedown",t=>{t.target.closest("difficulty-select")||this.hide()})}ngOnInit(){}hide(){this.open=!1}show(){this.open=!this.disabled}toggle(){this.disabled?this.open=!1:this.open?this.hide():this.show()}updateDifficulty(t){this.difficulty=t,this.onChange.emit(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Hb({type:t,selectors:[["difficulty-select"]],hostVars:4,hostBindings:function(t,e){2&t&&o.Fb("open",e.open)("disabled",e.disabled)},inputs:{open:"open",disabled:"disabled",difficulty:"difficulty"},outputs:{onChange:"onChange"},decls:6,vars:4,consts:[[1,"range"],["type","range","min","0","max","4","step","1",3,"value","input"],[1,"description"]],template:function(t,e){1&t&&(o.Rb(0,"h5"),o.Lc(1),o.Qb(),o.Rb(2,"div",0),o.Rb(3,"input",1),o.Yb("input",function(t){return e.updateDifficulty(t.target.value)}),o.Qb(),o.Qb(),o.Rb(4,"div",2),o.Lc(5),o.Qb()),2&t&&(o.Bb(1),o.Mc(e.L("meta.ui.play.difficulty_level."+e.difficulty)),o.Bb(2),o.jc("value",e.difficulty),o.Cb("data-value",e.difficulty),o.Bb(2),o.Mc(e.L("meta.hint.play.difficulty_level."+e.difficulty)))},encapsulation:2}),t})();const gv=["scrollable"];function fv(t,e){if(1&t&&(o.Rb(0,"div",9),o.Rb(1,"div",10),o.Rb(2,"span",11),o.Lc(3,"!"),o.Qb(),o.Lc(4),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(4),o.Nc(" ",t.L("meta.ui.notification.no_items"),"")}}function vv(t,e){if(1&t&&o.Ob(0,"div",23),2&t){const t=o.bc().$implicit;o.jc("innerHTML",t.title.markdown().br(),o.Ac)}}function yv(t,e){if(1&t&&(o.Rb(0,"div",24),o.Lc(1),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(2);o.Bb(1),o.Mc(e.getTime(t.date))}}const _v=function(){return{prefix:"\u2014"}},kv=function(t){return{list:t}};function wv(t,e){if(1&t&&o.Ob(0,"div",25),2&t){const t=o.bc().$implicit;o.jc("innerHTML",t.text.markdown(o.nc(2,kv,o.mc(1,_v))).br(),o.Ac)}}function Sv(t,e){if(1&t&&(o.Rb(0,"figcaption",29),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).$implicit;o.Bb(1),o.Mc(t.icon.caption)}}function Iv(t,e){if(1&t&&(o.Rb(0,"figure",26),o.Ob(1,"img",27),o.Jc(2,Sv,2,1,"figcaption",28),o.Qb()),2&t){const t=o.bc().$implicit;o.Fb("logo",t.icon.logo),o.Bb(1),o.jc("src","assets/img/icons/svg/"+t.icon.src+".svg",o.Cc),o.Bb(1),o.jc("ngIf",t.icon.caption)}}const Cv=function(t){return{league:t,default:!0}};function Lv(t,e){if(1&t&&(o.Rb(0,"div",30),o.Ob(1,"user-image",31),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.jc("animated",!0)("player",o.nc(3,Cv,t.icon.league))("leagueOnly",!0)}}function Rv(t,e){if(1&t&&(o.Rb(0,"div",32),o.Ob(1,"user-image",33),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.jc("player",t.icon.player)}}function Ov(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",37),o.Yb("click",function(){o.zc(t);const e=o.bc(2),i=e.$implicit,n=e.index;return o.bc(2).accept(i.accept,n,i.key)}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(4);o.kc("tooltip-hint",t.L("meta.ui.team.request_accept_button")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.team.request_accept_button")," ")}}function Tv(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",8),o.Yb("click",function(){o.zc(t);const e=o.bc(2),i=e.$implicit,n=e.index;return o.bc(2).decline(i.decline,n,i.key)}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(4);o.kc("tooltip-hint",t.L("meta.ui.team.request_decline_button")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.team.request_decline_button")," ")}}function xv(t,e){if(1&t&&(o.Rb(0,"div",34),o.Jc(1,Ov,2,3,"button",35),o.Jc(2,Tv,2,3,"button",36),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.jc("ngIf",t.accept),o.Bb(1),o.jc("ngIf",t.decline)}}function Bv(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc(4);o.Bb(1),o.Mc(t.L("meta.ui.notification.accepted_action"))}}function jv(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc(4);o.Bb(1),o.Mc(t.L("meta.ui.notification.declined_action"))}}function Mv(t,e){if(1&t&&(o.Rb(0,"div",38),o.Jc(1,Bv,2,1,"span",39),o.Jc(2,jv,2,1,"span",39),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.jc("ngIf","accept"==t.callBackApplied),o.Bb(1),o.jc("ngIf","decline"==t.callBackApplied)}}function Qv(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",14),o.Yb("click",function(){o.zc(t);const i=e.index,n=e.$implicit;return o.bc(2).markAsRead(i,n.key,!1)}),o.Jc(1,vv,1,1,"div",15),o.Jc(2,yv,2,1,"div",16),o.Jc(3,wv,1,4,"div",17),o.Jc(4,Iv,3,4,"figure",18),o.Jc(5,Lv,2,5,"div",19),o.Jc(6,Rv,2,1,"div",20),o.Jc(7,xv,3,2,"div",21),o.Jc(8,Mv,3,2,"div",22),o.Qb()}if(2&t){const t=e.$implicit;o.Fb("unreaded",!t.readed||0==t.readed),o.jc("alertSound","ui_click_default"),o.Bb(1),o.jc("ngIf",t.title),o.Bb(1),o.jc("ngIf",t.date),o.Bb(1),o.jc("ngIf",t.text&&!t.callBackApplied),o.Bb(1),o.jc("ngIf",t.icon&&t.icon.src),o.Bb(1),o.jc("ngIf",t.icon&&t.icon.league),o.Bb(1),o.jc("ngIf",t&&t.icon&&t.icon.player),o.Bb(1),o.jc("ngIf",!t.callBackApplied||null==t.callBackApplied),o.Bb(1),o.jc("ngIf",t.callBackApplied&&null!==t.callBackApplied)}}function Av(t,e){if(1&t&&(o.Rb(0,"div",12),o.Jc(1,Qv,9,11,"div",13),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngForOf",t.hqChat.messages.slice().reverse())}}const Dv=["january","february","march","april","may","june","july","august","september","october","november","december"];let Ev=(()=>{class t{constructor(t,e,i){this.chatService=t,this.cache=e,this.lobbyService=i,this.onChatOpen=new o.o,this.onChatClose=new o.o,this.onMessageReaded=new o.o,this.dateNow=(new Date).getTime(),this.isOpen=!1,this.hqChat={},this.hqChatId="",this.unreadExist=!1,this.globalEvent=new uu,this.keydownHandler=function(t){27===t.keyCode&&this.isOpen&&this.close()},(new al).data.subscribe(t=>this.L=t),this.isOpen=!1}ngOnInit(){this.hqChatId=zd.System,this.chatService.globalMessages.subscribe(t=>{this.hqChat.messages=this.chatService.getHQMessages(),t&&t.length&&(this.unreadExist=!!this.chatService.getUnreadedHQNotificationCount())}),this.keydownSubscription=pd.onKeyDown.pipe(We(t=>null!==t)).subscribe(t=>{this.keydownHandler(t)}),this.globalEvent.subscribe(t=>{t&&"isMatching_true"==t.key&&this.close()})}ngOnDestroy(){this.userMessagesSubscription.unsubscribe()}open(){this.isOpen=!0,this.triggerGlobalEvent("hq_messages.open"),this.cache.alertSound("ui_panel_appear_woosh")}close(){this.isOpen=!1,this.triggerGlobalEvent("hq_messages.close")}toggle(){this.isOpen?this.close():this.open()}getTime(t){return new Date(t).getDate()+" "+this.L("meta.ui.month."+Dv[new Date(t).getMonth()])+" "+new Date(t).getFullYear()+" "+new Date(t).parseDate("h:m")}markAsRead(t,e,i){this.hqChat.messages&&this.hqChat.messages[t]&&!i&&(this.hqChat.messages[t].readed=!0,this.chatService.saveChangedNotification(t,e,{readed:!0}))}readAll(){this.chatService.markAsReaded(this.hqChatId)}clearAll(){this.chatService.clearMessages(this.hqChatId),this.hqChat.messages=[]}hasFlag(t){return this.cache.hasFlag(t)}accept(t,e,i){this.chatService.saveChangedNotification(e,i,{callBackApplied:"accept"}),this.markAsRead(e,i,!1),this.triggerGlobalEvent(t.key,t.data)}decline(t,e,i){this.chatService.saveChangedNotification(e,i,{callBackApplied:"decline"}),this.markAsRead(e,i,!1),this.triggerGlobalEvent(t.key,t.data)}void(){}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}acceptTestMessage(){console.log("acceptTestMessage")}declineTestMessage(){console.log("declineTestMessage")}allow(t){return this.cache.allow(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Pd),o.Nb(nd),o.Nb(Bl))},t.\u0275cmp=o.Hb({type:t,selectors:[["hq-messages"]],viewQuery:function(t,e){if(1&t&&o.Qc(gv,!0),2&t){let t;o.vc(t=o.Zb())&&(e.scrollable=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("open",e.isOpen)},outputs:{onChatOpen:"onChatOpen",onChatClose:"onChatClose",onMessageReaded:"onMessageReaded"},features:[o.Ab([Pd,Bl])],decls:12,vars:14,consts:[[1,"grid-default"],[1,"hq-messages-wrap"],[1,"main-body","tile","texture-border","no-hover"],[3,"height","bbox"],["scrollable",""],["class","message no-borders",4,"ngIf"],["class","messages",4,"ngIf"],[1,"bottom-side"],[1,"button","small",3,"tooltip-hint","alertSound","click"],[1,"message","no-borders"],[1,"subheader1"],[1,"color-primary"],[1,"messages"],["class","message","fade-in","down",3,"unreaded","alertSound","click",4,"ngFor","ngForOf"],["fade-in","down",1,"message",3,"alertSound","click"],["class","subheader1",3,"innerHTML",4,"ngIf"],["class","date",4,"ngIf"],["class","text",3,"innerHTML",4,"ngIf"],["class","message-icon rounded",3,"logo",4,"ngIf"],["class","league-icon",4,"ngIf"],["class","message-icon",4,"ngIf"],["class","message-buttons",4,"ngIf"],["class","message-callback",4,"ngIf"],[1,"subheader1",3,"innerHTML"],[1,"date"],[1,"text",3,"innerHTML"],[1,"message-icon","rounded"],["draggable","false",1,"image",3,"src"],["class","caption",4,"ngIf"],[1,"caption"],[1,"league-icon"],[3,"animated","player","leagueOnly"],[1,"message-icon"],[3,"player"],[1,"message-buttons"],["class","button small red",3,"tooltip-hint","alertSound","click",4,"ngIf"],["class","button small",3,"tooltip-hint","alertSound","click",4,"ngIf"],[1,"button","small","red",3,"tooltip-hint","alertSound","click"],[1,"message-callback"],[4,"ngIf"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Rb(1,"div",1),o.Rb(2,"div",2),o.Rb(3,"scrollable",3,4),o.Jc(5,fv,5,1,"div",5),o.Jc(6,Av,2,1,"div",6),o.Qb(),o.Rb(7,"div",7),o.Rb(8,"button",8),o.Yb("click",function(){return e.readAll()}),o.Lc(9),o.Qb(),o.Rb(10,"button",8),o.Yb("click",function(){return e.clearAll()}),o.Lc(11),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb()),2&t&&(o.Bb(3),o.jc("height","100%")("bbox",!0),o.Bb(2),o.jc("ngIf",!e.hqChat||!e.hqChat.messages||!e.hqChat.messages.length),o.Bb(1),o.jc("ngIf",e.hqChat&&e.hqChat.messages),o.Bb(2),o.Fb("disabled",!(e.hqChat&&e.hqChat.messages&&e.hqChat.messages.length&&e.unreadExist)),o.kc("tooltip-hint",e.L("meta.ui.notification.mark_as_read")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.notification.mark_as_read")," "),o.Bb(1),o.Fb("disabled",!e.hqChat||!e.hqChat.messages||!e.hqChat.messages.length),o.kc("tooltip-hint",e.L("meta.ui.notification.clear_all")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.notification.clear_all")," "))},encapsulation:2}),t})(),Nv=(()=>{class t{constructor(t){this.cache=t,this.links={twitter:"https://twitter.com/FulqrumPub",facebook:"https://www.facebook.com/FulqrumPublishing",discord:"https://discord.gg/cEKmM9yUQr",steam:"steam://openurl/https://store.steampowered.com/app/1128860/Men_of_War_II/"},(new al).data.subscribe(t=>this.L=t)}ngOnInit(){}openLink(t){this.cache.alert("shell_open_web_browser:"+this.links[t])}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd))},t.\u0275cmp=o.Hb({type:t,selectors:[["social-links"]],features:[o.Ab([nd])],decls:10,vars:3,consts:[[1,"links","clear"],[1,"item"],["tooltip-hint","Twitter",1,"button","transparent","wishlist-link",3,"alertSound","click"],["src","assets/img/icons/svg/social/twitter.svg","draggable","false",1,"icon"],["tooltip-hint","Facebook",1,"button","transparent","wishlist-link",3,"alertSound","click"],["src","assets/img/icons/svg/social/facebook.svg","draggable","false",1,"icon"],["tooltip-hint","Discord",1,"button","transparent","wishlist-link",3,"alertSound","click"],["src","assets/img/icons/svg/social/discord.svg","draggable","false",1,"icon"]],template:function(t,e){1&t&&(o.Rb(0,"ul",0),o.Rb(1,"li",1),o.Rb(2,"button",2),o.Yb("click",function(){return e.openLink("twitter")}),o.Ob(3,"img",3),o.Qb(),o.Qb(),o.Rb(4,"li",1),o.Rb(5,"button",4),o.Yb("click",function(){return e.openLink("facebook")}),o.Ob(6,"img",5),o.Qb(),o.Qb(),o.Rb(7,"li",1),o.Rb(8,"button",6),o.Yb("click",function(){return e.openLink("discord")}),o.Ob(9,"img",7),o.Qb(),o.Qb(),o.Qb()),2&t&&(o.Bb(2),o.jc("alertSound","ui_click_default"),o.Bb(3),o.jc("alertSound","ui_click_default"),o.Bb(3),o.jc("alertSound","ui_click_default"))},encapsulation:2}),t})();const Fv=function(){return{standalone:!0}};let Pv=(()=>{class t{constructor(e){this.cache=e,this.password="",this.onInputKeydown=new o.o,this.label="",this.placeholder="",this.showPassword=!1,(new al).data.subscribe(t=>this.L=t),t.instances.push(this)}ngOnInit(){}onKeydown(t){wu(()=>{this.onInputKeydown.emit({event:t,password:this.password})},500,"set_password")}onInput(t){setTimeout(()=>{this.cache.alertSound("ui_barrack_in")},50)}getLength(){let t=[];for(let e=0;e<this.password.length;e++)t.push(e);return t}}return t.instances=[],t.\u0275fac=function(e){return new(e||t)(o.Nb(nd))},t.\u0275cmp=o.Hb({type:t,selectors:[["input-password"]],hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("input-group",!0)},inputs:{password:"password",label:"label",placeholder:"placeholder"},outputs:{onInputKeydown:"onInputKeydown"},features:[o.Ab([nd])],decls:10,vars:11,consts:[["for","password",1,"input-label"],[2,"position","relative"],["maxlength","64","id","password","autocomplete","off",1,"input","small",3,"type","ngModel","ngModelOptions","ngModelChange","keydown","input"],["passwordInput",""],[1,"checkbox","labeled-group","right-label"],["type","checkbox","id","passShow",3,"ngModel","ngModelOptions","ngModelChange"],["for","passShow",1,"icon",3,"tooltip-hint"],[3,"src"]],template:function(t,e){1&t&&(o.Rb(0,"form"),o.Rb(1,"label",0),o.Lc(2),o.Qb(),o.Rb(3,"div",1),o.Rb(4,"input",2,3),o.Yb("ngModelChange",function(t){return e.password=t})("keydown",function(t){return e.onKeydown(t)})("input",function(t){return e.onInput(t)}),o.Qb(),o.Qb(),o.Rb(6,"div",4),o.Rb(7,"input",5),o.Yb("ngModelChange",function(t){return e.showPassword=t}),o.Qb(),o.Rb(8,"label",6),o.Ob(9,"img",7),o.Qb(),o.Qb(),o.Qb()),2&t&&(o.Bb(2),o.Nc(" ",e.label," "),o.Bb(2),o.jc("type",e.showPassword?"text":"password")("ngModel",e.password)("ngModelOptions",o.mc(9,Fv)),o.Cb("placeholder",e.placeholder),o.Bb(3),o.jc("ngModel",e.showPassword)("ngModelOptions",o.mc(10,Fv)),o.Bb(1),o.kc("tooltip-hint",e.L(e.showPassword?"meta.ui.lobby.hide_password":"meta.ui.lobby.show_password")),o.Bb(1),o.jc("src",e.showPassword?"assets/img/icons/svg/open.svg":"assets/img/icons/svg/closed.svg",o.Cc))},directives:[bc,_o,lc,Wr,_c,yo,hc,Gr,tp],encapsulation:2}),t})();function Uv(t,e){1&t&&o.Ob(0,"img",10),2&t&&o.jc("src","assets/img/icons/svg/open.svg",o.Cc)}function zv(t,e){if(1&t&&o.Ob(0,"img",11),2&t){const t=o.bc().$implicit,e=o.bc();o.Fb("flag-icon",t.flag&&1==t.flag),o.jc("src",e.data.root+"/"+t.icon+"."+e.data.ext,o.Cc)}}function Jv(t,e){if(1&t&&(o.Rb(0,"div",12),o.Ob(1,"input",13),o.Qb()),2&t){const t=o.bc().$implicit;o.Fb("checked",t.selected),o.Bb(1),o.jc("checked",t.selected)}}function qv(t,e){if(1&t&&(o.Rb(0,"div",14),o.Ob(1,"input",15),o.Qb()),2&t){const t=o.bc().$implicit;o.Fb("checked",t.selected),o.Bb(1),o.jc("checked",t.selected),o.Cb("value",t.key)}}function Vv(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",4),o.Rb(1,"label",5),o.Yb("click",function(){o.zc(t);const i=e.index,n=e.$implicit;return o.bc().toggleOption(i,n)}),o.Jc(2,Uv,1,1,"img",6),o.Jc(3,zv,1,3,"img",7),o.Lc(4),o.Qb(),o.Jc(5,Jv,2,3,"div",8),o.Jc(6,qv,2,4,"div",9),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc();o.Fb("active",!1),o.Bb(1),o.Fb("with-flag",t.flag&&1==t.flag&&"all"!==t.key)("label-checkbox","checkbox"==i.type)("label-radio","radio"==i.type),o.jc("alertSound","ui_click_default"),o.Bb(1),o.jc("ngIf","all"==t.key),o.Bb(1),o.jc("ngIf","all"!=t.key),o.Bb(1),o.Nc(" ",i.L(t.label)," "),o.Bb(1),o.jc("ngIf","checkbox"==i.type),o.Bb(1),o.jc("ngIf","radio"==i.type)}}let $v=(()=>{class t{constructor(){this.type=Gv.Checkbox,this.onChange=new o.o,this.selectionIcons=null,(new al).data.subscribe(t=>this.L=t)}ngOnInit(){if(this.data&&this.data.options&&this.data.options.length){let t=this.data.options.find(t=>1==t.selected);this.selectionIcons=this.setIconSelection(t),"all"==t.key&&this.data.options.map(t=>t.selected=!0)}}toggleOption(t,e){if(this.type==Gv.Checkbox)if(e.selected=!e.selected,"all"==e.key)this.data.options.map(t=>t.selected=e.selected);else{let t=this.data.options.find(t=>"all"==t.key);t&&(t.selected=!1),this.data.options.length==this.getSelectedOptions().selectedOptions.length+1&&t&&(t.selected=!0)}this.type==Gv.Radio&&(e.selected=!0,this.data.options.filter(t=>t.key!=e.key).map(t=>t.selected=!1)),this.selectionIcons=this.setIconSelection(e),this.onChange.emit(this.getSelectedOptions())}getSelectedOptions(){return{selectedOptions:this.data.options.filter(t=>t.selected),type:this.filterType}}setIconSelection(t){let e=this.getSelectedOptions().selectedOptions;if(e.length&&e.find(t=>"all"==t.key))return{root:"assets/img/icons/svg/",ext:"svg",showMode:Wh.Icon,icons:["open"],iconCaption:this.L("meta.ui.filter.all")};{let i={root:this.data.root,ext:this.data.ext,showMode:this.data.showMode,icons:[],iconCaption:""};for(let t of e)i.icons.push(this.data.showMode==Wh.Icon?t.key:this.L(t.label));return this.type==Gv.Radio&&(i.iconCaption=this.L(t.label)),i}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Hb({type:t,selectors:[["select-menu"]],inputs:{data:"data",filterType:"filterType",type:"type"},outputs:{onChange:"onChange"},decls:5,vars:5,consts:[[3,"label","origin","selectionIcons","text"],["dropdown",""],[1,"clear"],["class","with-input list-item",3,"active",4,"ngFor","ngForOf"],[1,"with-input","list-item"],["tooltip-hint","",1,"button","transparent","block",3,"alertSound","click"],["class","icon toned",3,"src",4,"ngIf"],["class","icon",3,"src","flag-icon",4,"ngIf"],["class","input-cover checkbox-small",3,"checked",4,"ngIf"],["class","input-cover checkbox-small radio",3,"checked",4,"ngIf"],[1,"icon","toned",3,"src"],[1,"icon",3,"src"],[1,"input-cover","checkbox-small"],["type","checkbox",3,"checked"],[1,"input-cover","checkbox-small","radio"],["type","radio","name","radio",3,"checked"]],template:function(t,e){1&t&&(o.Rb(0,"dropdown",0,1),o.Rb(2,"scrollable"),o.Rb(3,"ul",2),o.Jc(4,Vv,7,14,"li",3),o.Qb(),o.Qb(),o.Qb()),2&t&&(o.jc("label",e.L(e.data.label))("origin","bottom")("selectionIcons",e.selectionIcons)("text",e.selectionIcons&&e.selectionIcons.icons.length?"":e.L("meta.ui.filter.select_option")),o.Bb(4),o.jc("ngForOf",e.data.options))},encapsulation:2}),t})();var Gv=function(t){return t.Radio="radio",t.Checkbox="checkbox",t}({});const Hv=["canvasElement"];let Yv=(()=>{class t{constructor(t){this.host=t,this.width=0,this.height=0,this.quart=Math.PI/2,this.PI2=2*Math.PI,this.percent=0,this.radials=[],this.radial={}}ngOnInit(){this.canvas=this.canvasElement.nativeElement,this.ctx=this.canvas.getContext("2d"),this.setSize(),this.radial={x:this.canvas.width/2,y:this.canvas.height/2,radius:2*window.devicePixelRatio,color:this.fillColor,initialColor:"#55575B",lineWidth:1*window.devicePixelRatio},this.animate()}ngOnDestroy(){this.clearCounters()}onResize(t){this.setSize()}setSize(){let t=this.canvas.parentElement.getBoundingClientRect();this.width=t.width*window.devicePixelRatio,this.height=t.height*window.devicePixelRatio,this.canvas.width=this.width,this.canvas.height=this.height}render(t){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawCircle(this.radial.initialColor,this.canvas.width/2,this.canvas.height/2,this.height/2.5,0,this.PI2),this.drawCircle(this.radial.color,this.radial.x,this.radial.y,this.height/2.5,-this.quart,this.PI2*(t/100)-this.quart,!0)}animate(){let t=new Date(this.time).diff(new Date);this.percent+=1/(t&&t.delta?t.delta:250),this.render(this.percent),this.percent<=100?requestAnimationFrame(this.animate.bind(this)):(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawCircle(this.radial.initialColor,this.canvas.width/2,this.canvas.height/2,this.height/2.5,0,this.PI2))}drawCircle(t,e,i,n,s,a,r){this.ctx.lineWidth=this.radial.lineWidth,this.ctx.beginPath(),this.ctx.arc(e,i,n,s,a,r),this.ctx.strokeStyle=t,this.ctx.stroke()}clearCounters(){this.percent=0,this.time=0}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m))},t.\u0275cmp=o.Hb({type:t,selectors:[["canvas-progress"]],viewQuery:function(t,e){if(1&t&&o.Fc(Hv,!0),2&t){let t;o.vc(t=o.Zb())&&(e.canvasElement=t.first)}},hostBindings:function(t,e){1&t&&o.Yb("resize",function(t){return e.onResize(t)},!1,o.yc)},inputs:{time:"time",fillColor:"fillColor"},decls:2,vars:0,consts:[["canvasElement",""]],template:function(t,e){1&t&&o.Ob(0,"canvas",null,0)},encapsulation:2}),t})();function Wv(t,e){if(1&t&&(o.Rb(0,"small",5),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Nc("[index: ",t.messageOfTheDayService.index,"]")}}function Kv(t,e){if(1&t&&(o.Rb(0,"div",1),o.Rb(1,"scrollable",2),o.Jc(2,Wv,2,1,"small",3),o.Ob(3,"article",4),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("bbox",!0),o.Bb(1),o.jc("ngIf",t.devMode),o.Bb(1),o.jc("innerHTML",t.L(t.key).markdown(),o.Ac)}}let Xv=(()=>{class t{constructor(t,e){this.messageOfTheDayService=t,this.cache=e,this.active=!0,this.devMode=this.cache.devMode,(new al).data.subscribe(t=>{this.L=t}),(new dl).data.subscribe(t=>{this.I=t})}ngOnInit(){let t=this.messageOfTheDayService.getMessagesKeys();this.key=t[this.messageOfTheDayService.index]}ngOnDestroy(){this.messageOfTheDayService.next()}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Zd),o.Nb(nd))},t.\u0275cmp=o.Hb({type:t,selectors:[["message-of-the-day"]],features:[o.Ab([Zd])],decls:1,vars:1,consts:[["style","position: relative; height: 100%; width: 100%;",4,"ngIf"],[2,"position","relative","height","100%","width","100%"],[3,"bbox"],["class","grey",4,"ngIf"],[1,"article","regular-font",3,"innerHTML"],[1,"grey"]],template:function(t,e){1&t&&o.Jc(0,Kv,4,3,"div",0),2&t&&o.jc("ngIf",e.active)},encapsulation:2}),t})(),Zv=(()=>{class t{constructor(t,e){this.host=t,this.cache=e,this.Host=this.host.nativeElement}onMouseClick(){this.sound&&("string"==typeof this.sound?this.cache.alertSound(this.sound):"object"==typeof this.sound&&this.sound.click&&this.cache.alertSound(this.sound.click))}onMouseEnter(){this.sound&&"object"==typeof this.sound&&this.sound.hover&&this.cache.alertSound(this.sound.hover)}ngOnInit(){}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m),o.Nb(nd))},t.\u0275dir=o.Ib({type:t,selectors:[["","alertSound",""]],hostBindings:function(t,e){1&t&&o.Yb("click",function(){return e.onMouseClick()})("contextmenu",function(){return e.onMouseClick()})("mouseenter",function(){return e.onMouseEnter()})},inputs:{sound:["alertSound","sound"]}}),t})(),ty=(()=>{class t{constructor(e){this.host=e,this.did=0,t.instances.push(this),this.did=t.did,t.did++}static hasCancelButtonsOnDisplay(){let e=t.instances.filter(t=>!t.host.nativeElement.classList.contains("disabled"));return console.log(e),!!e.length}ngOnInit(){this.keydownSubscription=pd.onKeyDown.pipe(We(t=>null!==t)).subscribe(t=>{this.hostKeydownHandler(t)})}ngOnDestroy(){let e=t.instances.findIndex(t=>t.did===this.did);t.instances.splice(e,1),this.keydownSubscription&&this.keydownSubscription.unsubscribe()}hostKeydownHandler(e){if(!this.host.nativeElement.classList.contains("disabled")&&(Qh.isAllModalsClosed()||27!=e.keyCode||"Escape"!=e.key))if(t.instances&&t.instances.length<2)"string"==typeof this.keyMap?e.key==this.keyMap&&this.host.nativeElement.click():"number"==typeof this.keyMap?e.keyCode==this.keyMap&&this.host.nativeElement.click():this.keyMap&&this.keyMap.key&&e.keyCode==this.keyMap.key&&this.host.nativeElement.click();else{t.instances.map(t=>{(t&&t.keyMap&&"string"==typeof this.keyMap||"number"==typeof this.keyMap)&&(t.keyMap={key:t.keyMap,zIndex:0})});const i=t.instances.reduce(function(t,e){return t&&t.keyMap&&t.keyMap.zIndex&&t.keyMap.zIndex>e.keyMap.zIndex?t:e});"object"==typeof i.keyMap&&e.keyCode===i.keyMap.key&&i.host.nativeElement.click()}}}return t.did=0,t.instances=[],t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m))},t.\u0275dir=o.Ib({type:t,selectors:[["","key-duplicator",""]],hostBindings:function(t,e){1&t&&o.Yb("keydown",function(t){return e.hostKeyDown(t)})},inputs:{keyMap:["key-duplicator","keyMap"]}}),t})();const ey=["modal"],iy=["bodyScrollable"];function ny(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",29),o.Yb("mouseenter",function(){o.zc(t);const i=e.index;return o.bc(2).hoveredColumn=i})("mouseleave",function(){return o.zc(t),o.bc(2).hoveredColumn=-1})("click",function(){o.zc(t);const i=e.index;return o.bc(2).setActiveUnit(i)}),o.Rb(1,"div",30),o.Ob(2,"unit",31),o.Rb(3,"button",32),o.Yb("click",function(i){o.zc(t);const n=e.$implicit,s=o.bc(2);return s.remove(n.id,i),s.triggerGlobalEvent("button.remove_from_compare_"+n.id)}),o.Ob(4,"img",33),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=e.index,n=o.bc(2);o.Fb("hovered",n.hoveredColumn===i)("active",n.activeUnit===t),o.jc("alertSound","ui_click_default"),o.Bb(2),o.jc("data",t),o.Bb(1),o.kc("tooltip-hint",n.L("meta.hint.unit_compare.remove")),o.jc("alertSound","ui_click_default")}}function sy(t,e){1&t&&(o.Rb(0,"div"),o.Ob(1,"div",34),o.Qb())}function ay(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.Mc(t.key||t.isTitle?t.label:"\xa0")}}function ry(t,e){if(1&t&&(o.Rb(0,"li",38),o.Jc(1,ay,2,1,"span",39),o.Qb()),2&t){const t=e.$implicit,i=o.bc().$implicit,n=o.bc().$implicit,s=o.bc(2);o.Fb("title",t.isTitle)("smaller",(s.showLabels[n.key]||t.isTitle||i[0]&&i[0].isTitle&&n.isListView)&&!s.ignoreSubLabels[t.key]),o.kc("tooltip-hint",t.key||t.isTitle?t.label:""),o.Cb("data-key",t.isTitle?t.key:""),o.Bb(1),o.jc("ngIf",s.campaignId||!s.campaignId&&"cost"!==t.key)}}function oy(t,e){if(1&t&&(o.Rb(0,"ul",36),o.Jc(1,ry,2,7,"li",37),o.Qb()),2&t){const t=e.$implicit;o.Bb(1),o.jc("ngForOf",t)}}function cy(t,e){if(1&t&&(o.Rb(0,"div"),o.Rb(1,"div"),o.Rb(2,"h3"),o.Lc(3),o.Qb(),o.Jc(4,oy,2,1,"ul",35),o.Qb(),o.Qb()),2&t){const t=e.$implicit;o.Bb(3),o.Mc(t.label),o.Bb(1),o.jc("ngForOf",t.tooltipData)}}function ly(t,e){if(1&t&&(o.Rb(0,"span",43),o.Lc(1),o.Qb()),2&t){const t=o.bc(),e=t.value,i=t.key,n=o.bc(4);o.Fb("positive",e>0&&n.moreIsBetter[i]||e<0&&n.moreIsWorst[i])("negative",e>0&&n.moreIsWorst[i]||e<0&&n.moreIsBetter[i]),o.Bb(1),o.Oc(" ",e>0?"+":null,"",0!==e?n.parseValue(e):null," ")}}function uy(t,e){if(1&t&&o.Jc(0,ly,2,6,"span",42),2&t){const t=e.key,i=o.bc(4);o.jc("ngIf",t&&!i.excludeCompare[t])}}const dy=function(t,e,i,n){return{key:t,currentValue:e,activeValue:i,value:n}};function hy(t,e){if(1&t&&o.Pb(0,44),2&t){const t=o.bc().index,e=o.wc(2),i=o.bc(),n=i.$implicit,s=i.index,a=o.bc(2);o.jc("ngTemplateOutlet",e)("ngTemplateOutletContext",o.qc(2,dy,n.key,a.unwrapped[t][s].value,a.unwrapped[a.activeUnitIndex][s].value,a.unwrapped[t][s].value-a.unwrapped[a.activeUnitIndex][s].value))}}function by(t,e){1&t&&o.Ob(0,"img",54)}function my(t,e){if(1&t&&o.Ob(0,"img",55),2&t){const t=o.bc(7);o.jc("src","assets/img/icons/svg/"+t.campaignCurrency+".svg",o.Cc)}}function py(t,e){1&t&&o.Ob(0,"img",56)}function gy(t,e){if(1&t&&o.Lc(0),2&t){const t=o.bc(2).index,e=o.bc().index,i=o.bc().index,n=o.bc().index,s=o.bc(2);o.Mc(s.parseValue(s.getValue(i,n,e,t)))}}function fy(t,e){1&t&&(o.Rb(0,"span",58),o.Lc(1,"\u2014"),o.Qb())}function vy(t,e){if(1&t&&o.Jc(0,fy,2,0,"span",57),2&t){const t=o.bc(2).$implicit;o.jc("ngIf",t.key)}}function yy(t,e){1&t&&o.Ob(0,"span")}function _y(t,e){1&t&&(o.Rb(0,"span",59),o.Lc(1,"\xd7"),o.Qb())}function ky(t,e){if(1&t&&(o.Rb(0,"span",38),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).index,e=o.bc().index,i=o.bc().index,n=o.bc().index,s=o.bc(2);o.kc("tooltip-hint",s.getLabel(i,n,e,t,!1)),o.Bb(1),o.Nc(" ",s.getLabel(i,n,e,t)," ")}}function wy(t,e){if(1&t&&o.Pb(0,44),2&t){const t=o.bc(2),e=t.$implicit,i=t.index,n=o.bc().index,s=o.bc().index,a=o.wc(2),r=o.bc().index,c=o.bc(2);o.jc("ngTemplateOutlet",a)("ngTemplateOutletContext",o.qc(2,dy,e.key,c.getValue(s,r,n,i,!0),c.getValue(c.activeUnitIndex,r,n,i,!0),c.getValue(s,r,n,i,!0)-c.getValue(c.activeUnitIndex,r,n,i,!0)))}}function Sy(t,e){if(1&t&&(o.Rb(0,"span"),o.Jc(1,by,1,0,"img",46),o.Jc(2,my,1,1,"img",47),o.Jc(3,py,1,0,"img",48),o.Jc(4,gy,1,1,"ng-template",null,49,o.Kc),o.Jc(6,vy,1,1,"ng-template",null,50,o.Kc),o.Jc(8,yy,1,0,"span",51),o.Jc(9,_y,2,0,"span",52),o.Jc(10,ky,2,2,"span",53),o.Jc(11,wy,1,7,"ng-container",41),o.Qb()),2&t){const t=o.wc(5),e=o.wc(7),i=o.bc(),n=i.$implicit,s=i.index,a=o.bc(),r=a.index,c=a.$implicit,l=o.bc(),u=l.$implicit,d=l.index,h=o.bc(),b=h.index,m=h.$implicit,p=o.bc(2);o.Bb(1),o.jc("ngIf","cost"===n.key&&!u.premium&&!p.campaignCurrency),o.Bb(1),o.jc("ngIf","cost"===n.key&&!u.premium&&p.campaignCurrency),o.Bb(1),o.jc("ngIf","cost"===n.key&&u.premium),o.Bb(5),o.jc("ngIf",p.parseValue(p.getValue(d,b,r,s)))("ngIfThen",t)("ngIfElse",e),o.Bb(1),o.jc("ngIf",p.showLabels[m.key]&&p.getValue(d,b,r,s)&&!p.ignoreSubLabels[n.key]),o.Bb(1),o.jc("ngIf",(p.showLabels[m.key]||n.isTitle||c[0]&&c[0].isTitle&&m.isListView)&&!p.ignoreSubLabels[n.key]),o.Bb(1),o.jc("ngIf",p.activeUnit&&p.activeUnit!==u&&p.unwrapped[d]&&p.unwrapped[p.activeUnitIndex])}}function Iy(t,e){if(1&t&&(o.Rb(0,"li"),o.Jc(1,Sy,12,9,"span",39),o.Qb()),2&t){const t=e.$implicit,i=o.bc().$implicit,n=o.bc(2).$implicit,s=o.bc(2);o.Fb("title",t.isTitle)("smaller",(s.showLabels[n.key]||t.isTitle||i[0]&&i[0].isTitle&&n.isListView)&&!s.ignoreSubLabels[t.key]),o.Bb(1),o.jc("ngIf",s.campaignId||!s.campaignId&&"cost"!==t.key)}}function Cy(t,e){if(1&t&&(o.Rb(0,"ul",36),o.Jc(1,Iy,2,5,"li",45),o.Qb()),2&t){const t=e.$implicit;o.Bb(1),o.jc("ngForOf",t)}}function Ly(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",29),o.Yb("mouseenter",function(){o.zc(t);const i=e.index;return o.bc(3).hoveredColumn=i})("mouseleave",function(){return o.zc(t),o.bc(3).hoveredColumn=-1})("click",function(){o.zc(t);const i=e.index;return o.bc(3).setActiveUnit(i)}),o.Jc(1,uy,1,1,"ng-template",null,40,o.Kc),o.Rb(3,"h3"),o.Lc(4),o.Jc(5,hy,1,7,"ng-container",41),o.Qb(),o.Jc(6,Cy,2,1,"ul",35),o.Qb()}if(2&t){const t=e.$implicit,i=e.index,n=o.bc(),s=n.index,a=n.$implicit,r=o.bc(2);o.Fb("hovered",r.hoveredColumn===i)("active",r.activeUnit===t),o.jc("alertSound","ui_click_default"),o.Bb(4),o.Nc(" ",r.unwrapped[i][s].value||"\xa0"," "),o.Bb(1),o.jc("ngIf",r.activeUnit&&r.activeUnit!==t&&r.unwrapped[i]&&r.unwrapped[r.activeUnitIndex]),o.Bb(1),o.jc("ngForOf",a.tooltipData)}}function Ry(t,e){1&t&&o.Ob(0,"div")}function Oy(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,Ly,7,8,"div",21),o.Jc(2,Ry,1,0,"div",22),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("ngForOf",t.units),o.Bb(1),o.jc("ngForOf",t.fakesArray)}}function Ty(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",10),o.Rb(1,"div",11),o.Rb(2,"div",12),o.Rb(3,"div",13),o.Rb(4,"div"),o.Rb(5,"button",14),o.Yb("click",function(){o.zc(t);const e=o.bc(),i=o.wc(1);return e.triggerGlobalEvent("button.modal.close"),i.close()}),o.Lc(6),o.Qb(),o.Rb(7,"div",15),o.Rb(8,"button",16),o.Yb("click",function(){o.zc(t);const e=o.bc();return e.resetAll(),e.triggerGlobalEvent("button.clear_unit_compare_table")}),o.Lc(9),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(10,"div",17),o.Rb(11,"scrollable",18,19),o.Rb(13,"div",20),o.Rb(14,"div"),o.Jc(15,ny,5,8,"div",21),o.Jc(16,sy,2,0,"div",22),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(17,"div",23),o.Rb(18,"div",12),o.Rb(19,"scrollable",24,25),o.Rb(21,"div",26),o.Jc(22,cy,5,2,"div",22),o.Qb(),o.Qb(),o.Qb(),o.Rb(23,"div",17),o.Rb(24,"scrollable",27,28),o.Rb(26,"div",20),o.Jc(27,Oy,3,2,"div",22),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.wc(12),e=o.wc(20),i=o.bc();o.Bb(5),o.kc("tooltip-hint",i.L("meta.ui.play.back")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" \u2190 ",i.L("meta.ui.play.back")," "),o.Bb(2),o.kc("tooltip-hint",i.L("meta.hint.unit_compare.remove")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",i.L("meta.ui.unit.compare_remove_all")," "),o.Bb(2),o.jc("orientation","horizontal")("disableControls",!0),o.Bb(2),o.Ic("width","calc(var(--cell-size) * "+(i.units.length+i.fakes)+")"),o.Bb(2),o.jc("ngForOf",i.units),o.Bb(1),o.jc("ngForOf",i.fakesArray),o.Bb(3),o.jc("disableControls",!0),o.Bb(3),o.jc("ngForOf",i.labels),o.Bb(2),o.jc("clone",e)("cloneHorizontal",t)("orientation","all")("bbox",!0),o.Bb(2),o.Ic("width","calc(var(--cell-size) * "+(i.units.length+i.fakes)+")"),o.Bb(1),o.jc("ngForOf",i.labels)}}const xy=function(t,e){return{label:t,action:e,large:!0}};function By(t,e){if(1&t&&o.Ob(0,"empty",60),2&t){const t=o.bc(),e=o.wc(1);o.jc("title",t.L("meta.ui.troops.details.comparison"))("desc",t.L("meta.ui.troops.details.comparison_empty"))("action",o.oc(3,xy,t.L("meta.ui.unit.unit_select"),e.close.bind(e)))}}const jy=/[A-Za-z]/gim,My=["crew","power","weapon_main","weapons"],Qy=["advantages","disadvantages","abilities"],Ay={cost:!0},Dy={cp:!1,crew:!0,power:!0,survival:!1,speed:!1,weapon_main:!0,weapons:!0},Ey={"power.human":!0,"power.apc":!0,"power.tank":!0,filling_amount:!0,piercing:!0,rate_of_fire:!0,recharge_time:!0,shots_per_minute:!0,spread_radius:!0,caliber:!0,"detonation.human":!0,"detonation.vehicle":!0,"hit.human":!0,"hit.vehicle":!0},Ny={level:!0,amount_slot:!0,crew:!0,power:!0,"power.human":!0,"power.apc":!0,"power.tank":!0,survival:!0,"armor_body.front":!0,"armor_body.back":!0,"armor_body.side":!0,"armor_body.cover":!0,"armor_turret.front":!0,"armor_turret.back":!0,"armor_turret.side":!0,"armor_turret.cover":!0,speed:!0,weapon_main:!0,filling_amount:!0,piercing:!0,rate_of_fire:!0,shots_per_minute:!0,caliber:!0,"detonation.human":!0,"detonation.vehicle":!0,"hit.human":!0,"hit.vehicle":!0,visor:!0},Fy={cp:!0,battle_rank:!0,cost:!0,recharge_time:!0,spread_radius:!0};let Py=(()=>{class t{constructor(t){this.cache=t,this.ids=[],this.units=[],this.unwrapped=[],this.exclude=Qy,this.excludeCompare=Ay,this.showLabels=Dy,this.ignoreSubLabels=Ey,this.moreIsBetter=Ny,this.moreIsWorst=Fy,this.hightlighted=new yl,this.unitSize=new yl,this.fakes=0,this.fakesArray=[],this.campaignId="",this.campaignCurrency="",this.labels=[],this.activeUnit=null,this.activeUnitIndex=-1,this.hoveredColumnIndex=-1,this.counters={},this.globalEvent=new uu,(new al).data.subscribe(t=>this.L=t)}ngOnInit(){this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>this.counters[t.path]=t.value),this.campaignId&&this.cache.getCampaign(this.campaignId)&&(this.campaignCurrency=this.cache.getCampaign(this.campaignId).currency)}ngOnDestroy(){this.onModalClose()}add(t){this.ids.indexOf(t)<0&&this.ids.length<10&&this.ids.push(t)}contain(t){return!(this.ids.indexOf(t)<0)}remove(t,e){e&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()),console.log(this.units),setTimeout(()=>{let e=this.ids.findIndex(e=>e===t);"number"==typeof e?(this.ids.splice(e,1),this.units.splice(e,1),this.unwrapped.splice(e,1),console.log(this.units),this.process(),setTimeout(()=>{this.bodyScrollable&&(this.bodyScrollable.setRects(),this.bodyScrollable.update())},1e3),this.setActiveUnit(e>this.activeUnitIndex?this.activeUnitIndex:--this.activeUnitIndex)):console.log("error while removeing unit, no unit "+t)},50)}process(){let t={},e={};if(this.reset(),this.ids.length){this.units=this.ids.map(i=>{let n=kl.clone(this.cache.getTreeUnit(i),{open:!0,available:!1,mode:gl.Exchanger}),s=function(t){return(new _f).generateTooltip(t)}(n);this.unwrapped.push(s);for(let a=0;a<s.length;a++){let i=JSON.parse(JSON.stringify(s[a]));if(!(Qy.indexOf(i.key)>=0))if(t[i.key]||(My.indexOf(i.key)>=0&&(i.isListView=!0),t[i.key]=i,this.labels.push(i)),i.tooltipData&&My.indexOf(i.key)<0)for(let t=0;t<i.tooltipData.length;t++){let n=i.tooltipData[t];for(let s=0;s<n.length;s++)this.labels[a].tooltipData[t].find(t=>t.key===n[s].key)||(e[n[s].key]=i,this.labels[a].tooltipData[t].push(n[s]))}else i.tooltipData&&My.indexOf(i.key)>=0&&this.labels[a].tooltipData.flat().length<i.tooltipData.flat().length&&(this.labels[a].tooltipData=i.tooltipData)}return n}),this.labels.find(t=>"crew"===t.key).tooltipData[0]&&this.labels.find(t=>"crew"===t.key).tooltipData[0].map(t=>t.key=""),this.labels.find(t=>"weapons"===t.key).tooltipData[0]&&this.labels.find(t=>"weapons"===t.key).tooltipData[0].map(t=>t.key=""),this.labels.find(t=>"crew"===t.key).tooltipData[0]&&this.labels.find(t=>"cp"===t.key).tooltipData[0].find(t=>{"cost"===t.key&&(t.label=this.L("meta.ui.unit.unit_props.cost"))}),this.fakes=Math.clamp(7-this.ids.length,0,6);for(let t=0;t<this.fakes;t++)this.fakesArray[t]=t;this.activeUnit||this.setActiveUnit(0),console.log(">>>>>>>>",this.labels,e,this.unwrapped)}}getValue(t,e,i,n,s=!1){let a=this.unwrapped[t],r=a[e];if(!a||!r||r&&!r.tooltipData)return s?0:null;let o=r.tooltipData[i];if(!o||o.isEmpty)return s?0:null;let c=o[n];return c&&parseFloat(c.value)&&!c.value.toString().match(jy)?c.value:s?0:null}getLabel(t,e,i,n,s=!0){let a=this.unwrapped[t],r=a[e];if(!a||!r)return null;let o=r.tooltipData[i];if(!o)return null;if(o.isEmpty)return"\u2800";let c=o[n];return c?s?c.label.dropWords(30).toString():c.label.toString():null}parseValue(t){if(!t)return t;if(t.toString().match(jy))return"";let e=(t=t.toString()).indexOf(".")>=0;return t?(e?parseFloat(t).toFixed(1).toString()||0:(parseInt(t)||0).cat()).toString():t}reset(t=!1){this.fakes=0,this.fakesArray=[],this.labels=[],this.unwrapped=[],this.unitSize=this.cache.unitSize,t&&(this.activeUnit=null,this.activeUnitIndex=-1)}resetAll(){this.fakes=0,this.fakesArray=[],this.labels=[],this.units=[],this.unwrapped=[],this.unitSize=this.cache.unitSize,this.activeUnit=null,this.activeUnitIndex=-1,setTimeout(()=>{this.ids=[]})}setActiveUnit(t){this.activeUnitIndex=t,this.activeUnit=this.units[t]}open(){this.modal&&(this.process(),this.modal.open())}onModalOpen(t){document.body.classList.add("modal-z-index-override")}onModalClose(t){document.body.classList.remove("modal-z-index-override"),this.reset(!0)}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}getCompareIds(){return this.ids}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd))},t.\u0275cmp=o.Hb({type:t,selectors:[["unit-compare-table"]],viewQuery:function(t,e){if(1&t&&(o.Qc(ey,!0),o.Qc(iy,!0)),2&t){let t;o.vc(t=o.Zb())&&(e.modal=t.first),o.vc(t=o.Zb())&&(e.bodyScrollable=t.first)}},inputs:{campaignId:"campaignId"},decls:11,vars:5,consts:[[1,"window",3,"onOpen","onClose"],["modal",""],["class","modal-main-content",4,"ngIf"],[1,"verticaly-middle","compare-empty"],["g-back","",1,"button","white",3,"tooltip-hint","alertSound","click"],[1,"icon-group"],["src","assets/img/icons/svg/back-button-icon.svg","draggable","false",1,"icon","hover-hidden"],["src","assets/img/icons/svg/back-button-icon_hover.svg","draggable","false",1,"icon","hover-visible"],[1,"inner"],[3,"title","desc","action",4,"ngIf"],[1,"modal-main-content"],[1,"compare-wrapper","small"],[1,"definitions"],[1,"definition-wrapper"],[1,"button","white","spaced-bottom",3,"tooltip-hint","alertSound","click"],[2,"height","calc(var(--unit-height) + var(--margin) / 2)"],["type","button",1,"button","small",3,"tooltip-hint","alertSound","click"],[1,"units"],[3,"orientation","disableControls"],["unitsScroll",""],[1,"units-wrapper"],[3,"hovered","active","alertSound","mouseenter","mouseleave","click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"compare-wrapper"],[3,"disableControls"],["definitions",""],[1,"definitions-wrapper"],[3,"clone","cloneHorizontal","orientation","bbox"],["bodyScrollable",""],[3,"alertSound","mouseenter","mouseleave","click"],[1,"unit-cover"],[3,"data"],["type","button",1,"button","icon-button",3,"tooltip-hint","alertSound","click"],["src","assets/img/icons/svg/compare_remove_dark.svg","draggable","false"],[1,"unit-fake"],["class","clear",4,"ngFor","ngForOf"],[1,"clear"],[3,"title","smaller","tooltip-hint",4,"ngFor","ngForOf"],[3,"tooltip-hint"],[4,"ngIf"],["valueDifference",""],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],["style","pointer-events: none","class","compared-value",3,"positive","negative",4,"ngIf"],[1,"compared-value",2,"pointer-events","none"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"title","smaller",4,"ngFor","ngForOf"],["src","assets/img/icons/svg/silver.svg","class","icon margin-right","draggable","false",4,"ngIf"],["class","icon margin-right","draggable","false",3,"src",4,"ngIf"],["src","assets/img/icons/svg/bonds.svg","class","icon margin-right","draggable","false",4,"ngIf"],["withValue",""],["withoutValue",""],[4,"ngIf","ngIfThen","ngIfElse"],["class","times",4,"ngIf"],[3,"tooltip-hint",4,"ngIf"],["src","assets/img/icons/svg/silver.svg","draggable","false",1,"icon","margin-right"],["draggable","false",1,"icon","margin-right",3,"src"],["src","assets/img/icons/svg/bonds.svg","draggable","false",1,"icon","margin-right"],["class","empty",4,"ngIf"],[1,"empty"],[1,"times"],[3,"title","desc","action"]],template:function(t,e){if(1&t){const t=o.Sb();o.Rb(0,"modal",0,1),o.Yb("onOpen",function(t){return e.onModalOpen(t)})("onClose",function(t){return e.onModalClose(t)}),o.Jc(2,Ty,28,21,"div",2),o.Rb(3,"div",3),o.Rb(4,"button",4),o.Yb("click",function(){o.zc(t);const i=o.wc(1);return e.triggerGlobalEvent("button.modal.close"),i.close()}),o.Rb(5,"span",5),o.Ob(6,"img",6),o.Ob(7,"img",7),o.Qb(),o.Lc(8),o.Qb(),o.Rb(9,"div",8),o.Jc(10,By,1,6,"empty",9),o.Qb(),o.Qb(),o.Qb()}2&t&&(o.Bb(2),o.jc("ngIf",e.ids.length),o.Bb(2),o.kc("tooltip-hint",e.L("meta.ui.play.back")),o.jc("alertSound","ui_back"),o.Bb(4),o.Nc(" ",e.L("meta.ui.play.back")," "),o.Bb(2),o.jc("ngIf",!e.ids.length))},encapsulation:2}),t})();function Uy(t,e){if(1&t&&o.Ob(0,"img",22),2&t){const t=o.bc();o.kc("tooltip-hint",t.L("meta.hint.play.echelon.subclass-header")+" "+t.L("meta.hint.play.echelon.subclass."+t.data.subtype)),o.jc("src","assets/img/subtypes/"+t.data.subtype+".svg",o.Cc)}}function zy(t,e){1&t&&(o.Rb(0,"div",23),o.Ob(1,"img",24),o.Qb())}function Jy(t,e){if(1&t){const t=o.Sb();o.Rb(0,"img",25),o.Yb("error",function(){return o.zc(t),o.bc().setImageFallback("no-unit")}),o.Qb()}if(2&t){const t=o.bc();o.jc("src","assets/img/unit/"+t.data.image+".png",o.Cc)}}function qy(t,e){if(1&t&&(o.Rb(0,"div",26),o.Ob(1,"currency",27),o.Qb()),2&t){const t=o.bc();o.Fb("premium",null==t.data?null:t.data.premiumGold)("collectible",null==t.data?null:t.data.collectible)("error",!t.isUnitAvailableToOpen()),o.jc("tooltip-hint",t.getXpTooltip.bind(t)),o.Bb(1),o.jc("type",null!=t.data&&t.data.premiumGold||null!=t.data&&t.data.premium?"gold":"exp")("value",t.data.premiumGold?t.data.premiumGold.cat():t.data.xpOpen.cat())("unitCurrency",!0)}}function Vy(t,e){if(1&t&&(o.Rb(0,"div",28),o.Rb(1,"span",29),o.Lc(2),o.Qb(),o.Ob(3,"img",30),o.Qb()),2&t){const t=o.bc();o.kc("tooltip-hint",t.L("meta.hint.unit.xp_available")),o.Bb(2),o.Nc("",null==t.data?null:t.data.xpAvailable.cat(),"\xa0")}}function $y(t,e){if(1&t&&o.Ob(0,"currency",27),2&t){const t=o.bc(2);o.jc("type",t.campaignCurrency)("value",t.data.silverCost.cat())("unitCurrency",!0)}}function Gy(t,e){if(1&t&&(o.Rb(0,"div",31),o.Jc(1,$y,1,3,"currency",32),o.Qb()),2&t){const t=o.bc();o.kc("tooltip-hint",t.L("meta.hint.play.unit."+t.campaignCurrency+"_cost")),o.Bb(1),o.jc("ngIf",t.campaignId&&t.campaignCurrency)}}function Hy(t,e){if(1&t&&o.Ob(0,"currency",27),2&t){const t=o.bc(2);o.jc("type","gold")("value",t.data.premiumGold.cat())("unitCurrency",!0)}}function Yy(t,e){if(1&t&&o.Ob(0,"currency",27),2&t){const t=o.bc(2);o.jc("type","gold")("value",t.data.storePrice.price.cat())("unitCurrency",!0)}}function Wy(t,e){if(1&t&&(o.Rb(0,"span"),o.Rb(1,"s"),o.Lc(2),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.Bb(2),o.Nc("\xa0",t.data.storePrice.oldPrice.cat(),"")}}function Ky(t,e){if(1&t&&(o.Rb(0,"div",31),o.Jc(1,Hy,1,3,"currency",32),o.Jc(2,Yy,1,3,"currency",32),o.Jc(3,Wy,3,1,"span",33),o.Qb()),2&t){const t=o.bc();o.Fb("collectible",null==t.data?null:t.data.collectible),o.kc("tooltip-hint",t.L("meta.hint.play.unit.gold_cost")),o.Bb(1),o.jc("ngIf",!t.hasSale()),o.Bb(1),o.jc("ngIf",t.hasSale()),o.Bb(1),o.jc("ngIf",t.hasSale())}}function Xy(t,e){1&t&&(o.Rb(0,"span",39),o.Lc(1,"\u25bc"),o.Qb())}function Zy(t,e){1&t&&(o.Rb(0,"span",39),o.Lc(1,"\u25b2"),o.Qb())}function t_(t,e){if(1&t&&(o.Rb(0,"span",37),o.Jc(1,Xy,2,0,"span",38),o.Jc(2,Zy,2,0,"span",38),o.Qb()),2&t){const t=o.bc(2);o.Fb("positive",t.data.battleRankModificator<1)("negative",t.data.battleRankModificator>1),o.kc("tooltip-hint",t.getBattleRankModificator()),o.Bb(1),o.jc("ngIf",t.data.battleRankModificator<1),o.Bb(1),o.jc("ngIf",t.data.battleRankModificator>1)}}function e_(t,e){if(1&t&&(o.Rb(0,"div",34),o.Ob(1,"img",35),o.Rb(2,"span"),o.Lc(3),o.Qb(),o.Jc(4,t_,3,7,"span",36),o.Qb()),2&t){const t=o.bc();o.Fb("error","battleRank"===t.error),o.kc("tooltip-hint",t.L("meta.hint.play.echelon.battle_rank")),o.Bb(3),o.Nc("\xa0",t.getBattleRank(),""),o.Bb(1),o.jc("ngIf",1!==t.data.battleRankModificator)}}function i_(t,e){1&t&&(o.Rb(0,"span",39),o.Lc(1,"\u25bc"),o.Qb())}function n_(t,e){1&t&&(o.Rb(0,"span",39),o.Lc(1,"\u25b2"),o.Qb())}function s_(t,e){if(1&t&&(o.Rb(0,"span",37),o.Jc(1,i_,2,0,"span",38),o.Jc(2,n_,2,0,"span",38),o.Qb()),2&t){const t=o.bc(2);o.Fb("positive",t.data.battleRankModificator<1)("negative",t.data.battleRankModificator>1),o.kc("tooltip-hint",t.getBattleRankModificator()),o.Bb(1),o.jc("ngIf",t.data.battleRankModificator<1),o.Bb(1),o.jc("ngIf",t.data.battleRankModificator>1)}}function a_(t,e){if(1&t&&(o.Rb(0,"div",40),o.Ob(1,"img",41),o.Rb(2,"span"),o.Lc(3),o.Qb(),o.Jc(4,s_,3,7,"span",36),o.Qb()),2&t){const t=o.bc();o.Fb("error","battleRank"===t.error),o.kc("tooltip-hint",t.L("meta.hint.play.echelon.battle_rank")),o.Bb(3),o.Nc("\xa0",t.getBattleRank(),""),o.Bb(1),o.jc("ngIf",1!==t.data.battleRankModificator)}}function r_(t,e){if(1&t&&(o.Rb(0,"div",42),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Nc(" ",null==t.data?null:t.data.barrack.available," ")}}function o_(t,e){1&t&&o.Ob(0,"img",43)}function c_(t,e){1&t&&o.Ob(0,"img",44)}function l_(t,e){1&t&&o.Ob(0,"img",45)}function u_(t,e){1&t&&o.Ob(0,"span",20)}let d_=(()=>{class t{constructor(t){this.cache=t,this.animatedCount=0,this.stripDots=_l,this.error="",this.campaignId="",this.campaignCurrency="",this.levels=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],this.globalEvent=new uu,this.counters={},this.L=t.L}isVisible(){return"technology"===this.parentRoute}isUnitAvailableToOpen(){return!this.isDisabled()&&this.cache.isUnitAvailableToOpen(this.data,this.campaignId)}setImageFallback(t){this.data&&(this.data.image=t)}ngOnInit(){this.data&&!this.data.mode&&(this.data.mode=gl.Default),this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>this.counters[t.path]=t.value),this.campaignId&&this.cache.getCampaign(this.campaignId)&&(this.campaignCurrency=this.cache.getCampaign(this.campaignId).currency)}isDisabled(){return!(this.data&&(this.data.barrack&&this.data.barrack.available&&this.data.barrack.available>0||(this.data.available||this.data.open)&&this.cache.isFreemiumUnitOpen(this.data)&&!this.data.disabled))}isPremiumOnly(){return!this.cache.isFreemiumUnitOpen(this.data)}getBattleRank(){return this.data?this.data.mode===gl.Barrack?Math.ceil(this.data.modifyRank):Math.ceil(+(this.data.modifyRank*this.data.amount.count).toFixed(2)):0}getBattleRankModificator(){return 1===this.data.battleRankModificator?"-":this.L("meta.ui.unit.unit_props.battle_rank").firstCapital()+": "+(this.data.battleRankModificator>1?"+":"")+100*+(this.data.battleRankModificator-1).toFixed(2)+"%"}priceNeedsMoreSpace(){return"default"==this.data.mode&&this.data.xpAvailable>0}brNeedsMoreSpace(){return"echelon"==this.data.mode||"calculator"==this.data.mode||"barrack"==this.data.mode&&this.getBattleRank()>0}getXpTooltip(){let t=this.cache.getTreeUnitParentsExpo(this.data.id,this.campaignId),e=this.data.premiumGold?this.data.premiumGold:this.data.xpOpen,i=Math.min(this.campaignId?this.cache.getCampaignFreeXp(this.campaignId):this.cache.getUserFreeXp(),e-t),n=this.cache.getParentsExpoLack(this.data,this.campaignId),s=Math.min(t,e)/e*100,a=Math.min(e-Math.min(t,e),i)/e*100;return this.cache.canUseFreeXp(this.data,this.campaignId)||t||(a=0),`\n\t\t\t${this.data.open?"":`\n\t\t\t\t<div class="heading">\n\t\t\t\t\t${this.data.available&&"default"==this.data.mode&&this.cache.getParentsExpoLack(this.data,this.campaignId)<=0?"<h4>"+this.L("meta.ui.open_troop.title")+"</h4>":""}\n\t\t\t\t\t<div>\n\t\t\t\t\t\t${this.L("meta.ui.open_troop.xp_available")}\n\t\t\t\t\t\t<span> ${t.cat()} <img src="assets/img/icons/svg/exp.svg" alt="" class="icon smaller"></span>\n\t\t\t\t\t\t${this.cache.canUseFreeXp(this.data,this.campaignId)&&i>0?` + <span>${i.cat()} <img src="assets/img/icons/currency/free_xp.png" alt="" class="icon smaller"></span>`:""}\n\t\t\t\t\t\t${n>0?`<div>\n\t\t\t\t\t\t\t<span class="red" style="font-weight: normal">${this.L("meta.ui.open_troop.xp_lack")}</span> <span>${n.cat()} <img src="assets/img/icons/currency/exp.png" alt="" class="icon smaller"></span>\n\t\t\t\t\t\t</div>`:""}\n\t\t\t\t\t\t<div class="progress-bar static active">\n\t\t\t\t\t\t\t<span style="width:${s}%"></span>\n\t\t\t\t\t\t\t<span class="gold" style="width:${a}%"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`}\n\t\t\t${this.L("meta.hint.play.unit.xp_cost")}\n\t\t`.flat()}getUnitTooltip(){let t=this.data.collectible||this.campaignId&&this.data.campaign&&this.data.campaign[this.campaignId]&&this.data.campaign[this.campaignId].collectible;return`${"<h4>"+this.L("unit."+this.data.unit+".name")+"</h4>"+this.L("unit."+this.data.unit+".desc_short")+(t?"\n\n".br()+this.L("meta.hint.collectible_unit").br():this.data.premium?"\n\n".br()+this.L("meta.hint.premium_unit").br():"")}${this.isPremiumOnly()?"\n\n".br()+this.L("meta.hint.unit_premium_required"):""}`}isOpensUnit(){return this.data&&this.data.opens&&this.data.opens.length>0}isOpenUnitOnNext(){if(!this.isOpensUnit())return!1;for(let t=0;t<this.data.opens.length;t++)if(this.cache.getTreeUnit(this.data.opens[t]).position.x>this.data.position.x)return!0;return!1}isOpenUnitOnTop(){if(!this.isOpensUnit())return!1;for(let t=0;t<this.data.opens.length;t++){let e=this.cache.getTreeUnit(this.data.opens[t]);if(e.position.x===this.data.position.x&&e.position.y<this.data.position.y)return!0}return!1}isOpenUnitOnBottom(){if(!this.isOpensUnit())return!1;for(let t=0;t<this.data.opens.length;t++){let e=this.cache.getTreeUnit(this.data.opens[t]);if(e.position.x===this.data.position.x&&e.position.y>this.data.position.y)return!0}}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}hasSale(){return this.data.storePrice&&this.data.storePrice.isSale}void(){}openUnit(t){this.data&&this.campaignId&&(this.cache.openUnit(this.data,this.campaignId).subscribe(t=>{this._playUnlockSound(this.data),this.triggerGlobalEvent("troops.unit_explore",{unitId:this.data.id,campaign:this.campaignId})}),t.preventDefault(),t.stopImmediatePropagation(),t.stopPropagation())}_playUnlockSound(t){this.cache.alertSound("ui_unlock_"+t.subtype)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd))},t.\u0275cmp=o.Hb({type:t,selectors:[["unit"]],hostVars:8,hostBindings:function(t,e){2&t&&o.Fb("active",e.highlighted||(null==e.data?null:e.data.highlighted))("animated",e.animated||(null==e.data?null:e.data.animated))("progress",null==e.data?null:e.data.progress)("disabled",e.isDisabled())},inputs:{parentRoute:"parentRoute",data:"data",highlighted:"highlighted",animated:"animated",attach:"attach",fontSize:"fontSize",state:"state",error:"error",campaignId:"campaignId"},decls:24,vars:57,consts:[[1,"unit"],[1,"wrapper"],[1,"name",3,"tooltip-hint"],["u-level","","data-tooltip-hide","",3,"tooltip-hint"],["u-subtype",""],["class","image-subtype","draggable","false","data-tooltip-hide","",3,"src","tooltip-hint",4,"ngIf"],["u-elite","",4,"ngIf"],["data-tooltip-hide","",1,"image-wrapper",3,"tooltip-hint"],["image-load","","class","image-unit","draggable","false",3,"src","error",4,"ngIf"],["u-xp-unlock","","data-tooltip-hide","",3,"premium","collectible","tooltip-hint","error",4,"ngIf"],["u-xp-available","","data-tooltip-hide","",3,"tooltip-hint",4,"ngIf"],["u-price","","data-tooltip-hide","",3,"tooltip-hint",4,"ngIf"],["u-price","","data-tooltip-hide","",3,"tooltip-hint","collectible",4,"ngIf"],["u-br-echelon","","data-tooltip-hide","","data-battle-rank","",3,"error","tooltip-hint",4,"ngIf"],["u-br","","class","price-base br","data-tooltip-hide","",3,"error","tooltip-hint",4,"ngIf"],["u-amount","",4,"ngIf"],[1,"lock-icon",3,"tooltip-hint","click"],["src","assets/img/icons/svg/unit-unlock.svg","draggable","false","image-load","",4,"ngIf"],["src","assets/img/icons/svg/unit-locked.svg","draggable","false","image-load","",4,"ngIf"],["src","assets/img/icons/svg/unit-disabled.svg","draggable","false","image-load","",4,"ngIf"],[1,"animator"],["class","animator",4,"ngIf"],["draggable","false","data-tooltip-hide","",1,"image-subtype",3,"src","tooltip-hint"],["u-elite",""],["src","assets/img/subtypes/premium.svg","draggable","false"],["image-load","","draggable","false",1,"image-unit",3,"src","error"],["u-xp-unlock","","data-tooltip-hide","",3,"tooltip-hint"],[3,"type","value","unitCurrency"],["u-xp-available","","data-tooltip-hide","",3,"tooltip-hint"],["data-tooltip-hide",""],["src","assets/img/icons/svg/exp.svg","draggable","false","data-tooltip-hide","",1,"offset-left"],["u-price","","data-tooltip-hide","",3,"tooltip-hint"],[3,"type","value","unitCurrency",4,"ngIf"],[4,"ngIf"],["u-br-echelon","","data-tooltip-hide","","data-battle-rank","",3,"tooltip-hint"],["src","assets/img/icons/svg/br.svg","alt","","draggable","false",1,"offset-left"],["u-br-modificator","",3,"positive","negative","tooltip-hint",4,"ngIf"],["u-br-modificator","",3,"tooltip-hint"],["class","triangle",4,"ngIf"],[1,"triangle"],["u-br","","data-tooltip-hide","",1,"price-base","br",3,"tooltip-hint"],["src","assets/img/icons/svg/br.svg","alt","","draggable","false"],["u-amount",""],["src","assets/img/icons/svg/unit-unlock.svg","draggable","false","image-load",""],["src","assets/img/icons/svg/unit-locked.svg","draggable","false","image-load",""],["src","assets/img/icons/svg/unit-disabled.svg","draggable","false","image-load",""]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Rb(1,"div",1),o.Rb(2,"div",2),o.Lc(3),o.Qb(),o.Rb(4,"div",3),o.Lc(5),o.Qb(),o.Rb(6,"div",4),o.Jc(7,Uy,1,2,"img",5),o.Jc(8,zy,2,0,"div",6),o.Qb(),o.Rb(9,"div",7),o.Jc(10,Jy,1,1,"img",8),o.Qb(),o.Jc(11,qy,2,10,"div",9),o.Jc(12,Vy,4,2,"div",10),o.Jc(13,Gy,2,2,"div",11),o.Jc(14,Ky,4,6,"div",12),o.Jc(15,e_,5,5,"div",13),o.Jc(16,a_,5,5,"div",14),o.Jc(17,r_,2,1,"div",15),o.Rb(18,"div",16),o.Yb("click",function(t){return e.isUnitAvailableToOpen()?e.openUnit(t):e.void()}),o.Jc(19,o_,1,0,"img",17),o.Jc(20,c_,1,0,"img",18),o.Jc(21,l_,1,0,"img",19),o.Qb(),o.Qb(),o.Ob(22,"span",20),o.Jc(23,u_,1,0,"span",21),o.Qb()),2&t&&(o.Fb("disabled",e.isDisabled())("premium-required",e.isPremiumOnly())("blured",null==e.data?null:e.data.blured)("premium",null==e.data?null:e.data.premium)("collectible",(null==e.data?null:e.data.collectible)||e.campaignId&&(null==e.data?null:e.data.campaign)&&(null==e.data?null:e.data.campaign[e.campaignId])&&(null==e.data?null:e.data.campaign[e.campaignId].collectible))("animated",(null==e.data?null:e.data.animated)||e.animated)("available",!(null!=e.data&&e.data.open)&&(null==e.data?null:e.data.available)&&"default"==(null==e.data?null:e.data.mode))("grayscaled",e.state&&"grayscaled"===e.state)("active",e.highlighted)("opens","default"==(null==e.data?null:e.data.mode)&&e.isOpensUnit())("opens-next","default"==(null==e.data?null:e.data.mode)&&e.isOpenUnitOnNext())("opens-top","default"==(null==e.data?null:e.data.mode)&&e.isOpenUnitOnTop())("opens-bottom","default"==(null==e.data?null:e.data.mode)&&e.isOpenUnitOnBottom())("rank-error","battleRank"===e.error),o.Cb("data-id",e.data.id),o.Bb(1),o.Fb("error","battleRank"===e.error),o.Bb(1),o.Fb("short",e.priceNeedsMoreSpace())("shorter",e.brNeedsMoreSpace()),o.kc("tooltip-hint",e.L("unit."+e.data.unit+".name")),o.Bb(1),o.Nc(" ",e.L("unit."+e.data.unit+".short")," "),o.Bb(1),o.kc("tooltip-hint",e.L("meta.hint.play.unit.level")),o.Bb(1),o.Mc(e.levels[(null==e.data?null:e.data.level)-1]),o.Bb(2),o.jc("ngIf",null==e.data?null:e.data.subtype),o.Bb(1),o.jc("ngIf",(null==e.data?null:e.data.elite)||(null==e.data?null:e.data.premium)||(null==e.data?null:e.data.premiumGold)),o.Bb(1),o.kc("tooltip-hint",e.getUnitTooltip()),o.Bb(1),o.jc("ngIf",null==e.data?null:e.data.image),o.Bb(1),o.jc("ngIf","default"==(null==e.data?null:e.data.mode)&&!e.data.open),o.Bb(1),o.jc("ngIf","default"==(null==e.data?null:e.data.mode)&&(null==e.data?null:e.data.xpAvailable)>0),o.Bb(1),o.jc("ngIf","barrack"==(null==e.data?null:e.data.mode)&&!(null!=e.data&&e.data.premiumGold)&&!(null!=e.data&&e.data.collectible)&&e.campaignId&&e.campaignCurrency),o.Bb(1),o.jc("ngIf","barrack"==(null==e.data?null:e.data.mode)&&(null==e.data?null:e.data.premiumGold)&&!(null!=e.data&&e.data.collectible)),o.Bb(1),o.jc("ngIf","echelon"==(null==e.data?null:e.data.mode)||"calculator"==(null==e.data?null:e.data.mode)),o.Bb(1),o.jc("ngIf","barrack"==(null==e.data?null:e.data.mode)&&e.getBattleRank()>0),o.Bb(1),o.jc("ngIf","barrack"==(null==e.data?null:e.data.mode)&&(null==e.data?null:e.data.premium)),o.Bb(1),o.Fb("clickable",!(null!=e.data&&e.data.open)&&(null==e.data?null:e.data.available)&&"default"==(null==e.data?null:e.data.mode)),o.jc("tooltip-hint",e.isDisabled()?e.L("meta.ui.open_troop.message_open_previous"):e.getXpTooltip.bind(e)),o.Bb(1),o.jc("ngIf",!(null!=e.data&&e.data.open)&&(null==e.data?null:e.data.available)&&"default"==(null==e.data?null:e.data.mode)&&e.isUnitAvailableToOpen()),o.Bb(1),o.jc("ngIf",e.isDisabled()),o.Bb(1),o.jc("ngIf",1==(null==e.data?null:e.data.available)&&!e.isUnitAvailableToOpen()),o.Bb(2),o.jc("ngIf",e.isOpensUnit()&&(e.isOpenUnitOnTop()||e.isOpenUnitOnBottom())))},directives:[tp,ee,Qf,Ef],encapsulation:2}),t})(),h_=(()=>{class t{constructor(t){this.host=t,this.rendered=!1}ngOnInit(){this.rendered=!0}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m))},t.\u0275dir=o.Ib({type:t,selectors:[["","fade-in",""]],hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("faded-in",e.rendered)}}),t})();function b_(t,e){if(1&t&&(o.Rb(0,"article"),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Nc(" ",t.L("meta.ui.open_troop.message_open_previous")," ")}}const m_=function(t){return{xpAvailableLack:t}};function p_(t,e){if(1&t&&(o.Rb(0,"div"),o.Rb(1,"div"),o.Lc(2),o.Qb(),o.Ob(3,"div",7),o.Qb()),2&t){const t=o.bc(3);o.Bb(2),o.Nc(" ",t.L("meta.ui.open_troop.message_convert_xp")," "),o.Bb(1),o.jc("innerHTML",t.L("meta.ui.open_troop.message_xp_available_not_enough",o.nc(2,m_,t.openingUnit.opening.xp.lack.cat())).markdown().br(),o.Ac)}}function g_(t,e){if(1&t&&(o.Rb(0,"div"),o.Lc(1),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.Nc(" ",t.L("meta.ui.open_troop.message_open")," ")}}function f_(t,e){if(1&t&&(o.Rb(0,"div",6),o.Jc(1,p_,4,4,"div",0),o.Jc(2,g_,2,1,"div",0),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("ngIf",t.openingUnit.opening.xp.lack),o.Bb(1),o.jc("ngIf",!t.openingUnit.opening.xp.lack)}}const v_=function(t){return{goldAvailableLack:t}};function y_(t,e){if(1&t&&(o.Rb(0,"div",9),o.Ob(1,"div",7),o.Rb(2,"div",10),o.Lc(3),o.Qb(),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.jc("innerHTML",t.L("meta.ui.open_troop.message_gold_available_not_enough",o.nc(2,v_,t.openingUnit.opening.gold.lack.cat())).markdown().br(),o.Ac),o.Bb(2),o.Nc(" ",t.L("meta.ui.open_troop.message_convert_gold")," ")}}function __(t,e){if(1&t&&(o.Rb(0,"div",9),o.Lc(1),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.Nc(" ",t.L("meta.ui.open_troop.message_open_by_gold")," ")}}function k_(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,y_,4,4,"div",8),o.Jc(2,__,2,1,"div",8),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("ngIf",t.openingUnit.opening.gold.lack),o.Bb(1),o.jc("ngIf",!t.openingUnit.opening.gold.lack)}}function w_(t,e){if(1&t&&(o.Rb(0,"div",11),o.Ob(1,"currency",12),o.Qb()),2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("meta.hint.unit.xp_cost")),o.Bb(1),o.jc("type","exp")("value",t.openingUnit.xpOpen.cat())("smallSize",!0)}}function S_(t,e){if(1&t&&(o.Rb(0,"div",11),o.Ob(1,"currency",12),o.Qb()),2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("meta.hint.play.unit.gold_cost")),o.Bb(1),o.jc("type","gold")("value",t.openingUnit.premiumGold.cat())("smallSize",!0)}}function I_(t,e){if(1&t&&(o.Rb(0,"div"),o.Rb(1,"div",3),o.Rb(2,"div",4),o.Lc(3),o.Qb(),o.Rb(4,"div",13),o.Ob(5,"currency",12),o.Qb(),o.Qb(),o.Rb(6,"div",3),o.Rb(7,"div",4),o.Lc(8),o.Qb(),o.Rb(9,"div",13),o.Ob(10,"currency",12),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.Bb(3),o.Mc(t.L("meta.ui.exchange.xp_will_used")),o.Bb(2),o.jc("type","exp")("value",t.howMuchExpoWillBeUsed().cat())("smallSize",!0),o.Bb(3),o.Mc(t.L("meta.ui.exchange.free_xp_will_used")),o.Bb(2),o.jc("type","free_xp")("value",t.howMuchFreeExpoWillBeUsed().cat())("smallSize",!0)}}function C_(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,b_,2,1,"article",0),o.Jc(2,f_,3,2,"div",2),o.Jc(3,k_,3,2,"div",0),o.Rb(4,"div",3),o.Rb(5,"div",4),o.Lc(6),o.Qb(),o.Jc(7,w_,2,4,"div",5),o.Jc(8,S_,2,4,"div",5),o.Qb(),o.Jc(9,I_,11,8,"div",0),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf",!t.openingUnit.open),o.Bb(1),o.jc("ngIf",!t.openingUnit.premiumGold&&t.openingUnit.opening.xp.lack&&t.canUseFreeXp(t.openingUnit)),o.Bb(1),o.jc("ngIf",t.openingUnit.premiumGold),o.Bb(3),o.Mc(t.L("meta.ui.open_troop.how_much_cost")),o.Bb(1),o.jc("ngIf",!t.openingUnit.premiumGold&&t.openingUnit.xpOpen),o.Bb(1),o.jc("ngIf",t.openingUnit.premiumGold),o.Bb(1),o.jc("ngIf",t.canbeOpened&&!t.openingUnit.opening.xp.lack&&!t.openingUnit.opening.gold.lack&&t.canUseFreeXp(t.openingUnit))}}function L_(t,e){if(1&t&&(o.Rb(0,"div"),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Nc(" ",t.L("meta.ui.open_troop.message_unit_opened")," ")}}function R_(t,e){if(1&t&&(o.Rb(0,"div",3),o.Ob(1,"div",4),o.Rb(2,"div",13),o.Ob(3,"currency",12),o.Qb(),o.Qb()),2&t){const t=o.bc(3);o.Bb(3),o.jc("type","free_xp")("value",t.uXP.cat())("smallSize",!0)}}function O_(t,e){if(1&t&&(o.Rb(0,"div"),o.Rb(1,"div",3),o.Rb(2,"div",4),o.Lc(3),o.Qb(),o.Rb(4,"div",13),o.Ob(5,"currency",12),o.Qb(),o.Qb(),o.Jc(6,R_,4,3,"div",14),o.Rb(7,"div",15),o.Rb(8,"div",4),o.Rb(9,"span",16),o.Lc(10),o.Qb(),o.Qb(),o.Rb(11,"div",13),o.Ob(12,"currency",12),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.Bb(3),o.Mc(t.L("meta.ui.tech.available")),o.Bb(2),o.jc("type","exp")("value",t.cache.getTreeUnitParentsExpo(t.receivedUnit.id,t.campaignId).cat())("smallSize",!0),o.Bb(1),o.jc("ngIf",t.canUseFreeXp(t.receivedUnit)),o.Bb(4),o.Mc(t.L("meta.ui.open_troop.xp_lack")),o.Bb(2),o.jc("type","exp")("value",t.expoLack.cat())("smallSize",!0)}}function T_(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,L_,2,1,"div",0),o.Jc(2,O_,13,9,"div",0),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf",0==t.receivedUnit.available&&1==t.receivedUnit.open),o.Bb(1),o.jc("ngIf",1==t.receivedUnit.available&&t.canUseFreeXp(t.receivedUnit))}}function x_(t,e){if(1&t&&(o.Rb(0,"div"),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Nc(" ",t.L("meta.ui.open_troop.message_open_previous"),"\n")}}const B_=function(t){return{expoLack:t}};function j_(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",17),o.Rb(1,"button",18),o.Yb("click",function(){o.zc(t);const e=o.bc();return e.openUnit(),e.triggerGlobalEvent("button.tech.open_unit",{unitId:e.openingUnit.id})}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(1),o.Fb("disabled",!t.canbeOpened),o.kc("tooltip-hint",t.canbeOpened?t.L("meta.ui.open_troop.open_button"):t.L("meta.ui.open_troop.message_parent_xp_not_enough",o.nc(6,B_,t.expoLack))),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.open_troop.open_button")),o.Bb(1),o.Nc(" ",t.L("meta.ui.open_troop.open_button")," ")}}JSON;let M_=(()=>{class t{constructor(t,e){this.cache=t,this.notificatorService=e,this.onOpen=new o.o,this.onClose=new o.o,this.openingUnit=null,this.currentUnit=null,this.unitsData={},this.openUnitName="",this.localizator=new al,this.informator=new dl,this.userSilver=0,this.userGold=0,this.userExpo=0,this.remaining={silver:0,gold:0,xp:0},this.canbeOpened=!0,this.expoLack=0,this.uXP=0,this.globalEvent=new uu,this.campaignId="",this.localizator.data.subscribe(t=>{this.L=t}),this.informator.data.subscribe(t=>{this.I=t})}getActualGold(){return this.cache.getUserGold()}getActualFreeXp(){return this.campaignId?this.cache.getCampaignFreeXp(this.campaignId):this.cache.getUserFreeXp()}getActualSilver(){return this.campaignId?this.cache.getCampaignSilver(this.campaignId):this.cache.getUserSilver()}ngOnInit(){this.receivedCampaign&&(this.campaignId=this.receivedCampaign),this.receivedUnit&&this.receivedUnit.unit&&this.updateUnitData(this.receivedUnit)}ngOnChanges(t){t&&t.receivedUnit&&t.receivedUnit.previousValue&&t.receivedUnit.currentValue&&t.receivedUnit.currentValue.id!=t.receivedUnit.previousValue.id&&this.updateUnitData(t.receivedUnit.currentValue),t&&t.receivedUnit&&t.receivedUnit.currentValue&&t.receivedUnit.previousValue&&t.receivedUnit.currentValue!=t.receivedUnit.previousValue&&(this.campaignId=this.receivedCampaign)}updateUnitData(t){this.receivedUnit=t,this.userSilver=this.getActualSilver(),this.userGold=this.getActualGold(),this.userExpo=this.getActualFreeXp(),this.openAvailableUnit(this.receivedUnit),this.remaining.xp=this.userExpo+this.getParentsExpo()-(this.receivedUnit.xpOpen||0),this.remaining.gold=this.userGold-(this.receivedUnit.premiumGold||0),this.cache.isUnitAvailableToOpen(this.receivedUnit,this.campaignId)?this.canbeOpened=1!=this.receivedUnit.open:(Object(Pc.a)("Warn",`unit ${this.receivedUnit.id} have not enough expo on parents, so cant be opened`),this.canbeOpened=!1)}openAvailableUnit(t){if(!t)return;this.openingUnit=this.currentUnit=t,this.openingUnit=Object.assign({},t);let e=this.cache.getUser();Object.assign(this.openingUnit,{open:!0,available:!1,animated:!1,opening:{xp:{},gold:{}}});let i=this.campaignId?this.cache.getCampaignFreeXp(this.campaignId):this.cache.getUserFreeXp();if(t.premiumGold)Object.assign(this.openingUnit.opening.gold,{free:e.gold,lack:this.openingUnit.premiumGold-e.gold}),this.openingUnit.opening.gold.lack<0&&(this.openingUnit.opening.gold.lack=0);else{const t=e.freeXp;let n=this.getParentsExpo()+i;Object.assign(this.openingUnit.opening.xp,{available:n,free:t,lack:this.cache.getParentsExpoLack(this.openingUnit,this.campaignId)}),this.openingUnit.opening.xp.lack<0&&(this.openingUnit.opening.xp.lack=0)}this.openUnitName=this.L("unit."+this.currentUnit.id+".name"),this.expoLack=this.cache.getParentsExpoLack(this.openingUnit,this.campaignId).cat();let n=this.cache.getTreeUnitParentsExpo(this.currentUnit.id,this.campaignId);this.uXP=Math.max(Math.min(i,(this.currentUnit.premiumGold?this.currentUnit.premiumGold:this.currentUnit.xpOpen)-n),0)}openUnit(){this.openingUnit&&this.campaignId&&this.cache.openUnit(this.openingUnit,this.campaignId).subscribe(t=>{this.updateUnitData(this.cache.getTreeUnit(this.openingUnit.id,this.campaignId)),this._playUnlockSound(this.openingUnit),this.triggerGlobalEvent("troops.unit_explore",{unitId:this.openingUnit.id,campaign:this.campaignId})})}_playUnlockSound(t){this.cache.alertSound("ui_unlock_"+t.subtype)}getExpoLack(t){return this.cache.getParentsExpoLack(t,this.campaignId)}canUseFreeXp(t){return this.cache.canUseFreeXp(t,this.campaignId)}convertXp(){this.cache.openExpoExchanger()}convertGold(){this.cache.openGoldExchanger()}getParentsExpo(){return this.openingUnit?this.cache.getTreeUnitParentsExpo(this.openingUnit.id,this.campaignId):0}howMuchExpoWillBeUsed(){return Math.min(this.getParentsExpo(),this.openingUnit.xpOpen)}howMuchFreeExpoWillBeUsed(){return this.openingUnit.xpOpen-this.howMuchExpoWillBeUsed()}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}onCloseEvent(){this.onClose.emit(this)}onOpenEvent(){this.onOpen.emit(this)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Uc))},t.\u0275cmp=o.Hb({type:t,selectors:[["open-unit"]],inputs:{receivedUnit:"receivedUnit",receivedCampaign:"receivedCampaign"},outputs:{onOpen:"onOpen",onClose:"onClose"},features:[o.Ab([nd,Uc]),o.zb],decls:4,vars:4,consts:[[4,"ngIf"],["class","button-cover",4,"ngIf"],["class","alert-message",4,"ngIf"],[1,"currency-info"],[1,"title","cell"],["class","unit-money cell",3,"tooltip-hint",4,"ngIf"],[1,"alert-message"],[3,"innerHTML"],["class","heading",4,"ngIf"],[1,"heading"],[1,"spaced-top"],[1,"unit-money","cell",3,"tooltip-hint"],[3,"type","value","smallSize"],[1,"unit-money","cell"],["class","currency-info",4,"ngIf"],[1,"currency-info","bordered-top"],[1,"color-primary"],[1,"button-cover"],[1,"button","red",3,"tooltip-hint","alertSound","click"]],template:function(t,e){1&t&&(o.Jc(0,C_,10,7,"div",0),o.Jc(1,T_,3,2,"div",0),o.Jc(2,x_,2,1,"div",0),o.Jc(3,j_,3,8,"div",1)),2&t&&(o.jc("ngIf",e.openingUnit&&1==e.receivedUnit.available&&0==e.receivedUnit.open),o.Bb(1),o.jc("ngIf",e.openingUnit&&!e.canbeOpened),o.Bb(1),o.jc("ngIf",e.currentUnit&&!e.currentUnit.open&&e.openingUnit&&0==e.receivedUnit.available&&0==e.receivedUnit.open),o.Bb(1),o.jc("ngIf",e.openingUnit))},encapsulation:2}),t})();const Q_=function(t){return[t]};function A_(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",3),o.Rb(1,"a",4),o.Yb("click",function(){o.zc(t);const e=o.bc();return e.triggerGlobalEvent("button.navigation.unit_preview",{unitId:e.unit.id})}),o.Lc(2),o.Qb(),o.Rb(3,"h3",5),o.Lc(4),o.Qb(),o.Rb(5,"div",6),o.Lc(6),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(1),o.kc("tooltip-hint",t.L("meta.ui.troops.unit_button_detail")),o.jc("routerLink",o.nc(11,Q_,"/unit/"+t.unit.id))("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.troops.unit_button_detail")),o.Bb(1),o.Nc(" ",t.L("meta.ui.troops.unit_button_detail")," "),o.Bb(1),o.Fb("unit-gold",t.unit.premium)("collectible-color",t.unit.collectible),o.Bb(1),o.Mc(t.L("unit."+(null==t.unit?null:t.unit.id)+".short")),o.Bb(2),o.Mc(t.L("unit."+(null==t.unit?null:t.unit.id)+".type"))}}function D_(t,e){if(1&t&&(o.Rb(0,"div",9),o.Ob(1,"img",10),o.Rb(2,"span",11),o.Lc(3),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("meta.ui.unit.unit_props.cp")),o.Bb(3),o.Mc(t.I("unit."+t.unit.id+".cp"))}}function E_(t,e){if(1&t&&(o.Rb(0,"div",9),o.Ob(1,"img",12),o.Rb(2,"span",11),o.Lc(3),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("meta.ui.unit.unit_props.battle_rank")),o.Bb(3),o.Mc(t.unit.battleRank)}}function N_(t,e){if(1&t&&(o.Rb(0,"div",7),o.Jc(1,D_,4,2,"div",8),o.Jc(2,E_,4,2,"div",8),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf",t.unit&&t.unit.id&&t.I("unit."+t.unit.id+".cp")>=0),o.Bb(1),o.jc("ngIf",t.unit&&t.unit.battleRank)}}JSON;let F_=(()=>{class t{constructor(){this.campaignId="",this.campaignCurrency="",this.unitData=null,this.globalEvent=new uu,(new al).data.subscribe(t=>this.L=t),(new dl).data.subscribe(t=>this.I=t)}ngOnInit(){}fallback(t){return t.match?[]:t}ngOnChanges(t){t&&t.unit&&t.unit.currentValue&&(this.unit=t.unit.currentValue),t&&t.campaignId&&t.campaignId.currentValue&&(this.campaignId=t.campaignId.currentValue),t&&t.campaignCurrency&&t.campaignCurrency.currentValue&&(this.campaignCurrency=t.campaignCurrency.currentValue),t&&t.unitData&&t.unitData.currentValue&&(this.unitData=t.unitData.currentValue)}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Hb({type:t,selectors:[["unit-details"]],inputs:{unit:"unit",campaignId:"campaignId",campaignCurrency:"campaignCurrency",unitData:"unitData"},features:[o.Ab([]),o.zb],decls:3,vars:10,consts:[["class","head",4,"ngIf"],["class","unit-counters",4,"ngIf"],[3,"unit","header","description","advantages","campaignId","campaignCurrency","fullDescription","chart"],[1,"head"],["href","","queryParamsHandling","merge",1,"button","small","spaced-bottom",3,"routerLink","tooltip-hint","alertSound","click"],[1,"color-white"],[1,"subheader2"],[1,"unit-counters"],["class","item",3,"tooltip-hint",4,"ngIf"],[1,"item",3,"tooltip-hint"],["src","assets/img/icons/svg/command_point.svg","draggable","false","image-load","",1,"counter-image"],[1,"value"],["src","assets/img/icons/svg/battle_rank.svg","draggable","false","image-load","",1,"counter-image"]],template:function(t,e){1&t&&(o.Jc(0,A_,7,13,"div",0),o.Jc(1,N_,3,2,"div",1),o.Ob(2,"unit-characteristics",2)),2&t&&(o.jc("ngIf",e.unitData.head),o.Bb(1),o.jc("ngIf",e.unitData.counters),o.Bb(1),o.jc("unit",e.unit)("header",!0)("description",e.unitData.description||!0)("advantages",e.unitData.advantages||!0)("campaignId",e.campaignId)("campaignCurrency",e.campaignCurrency)("fullDescription",e.unitData.fullDescription||!1)("chart",e.unitData.chart||!1))},directives:[ee,_f,Ks,tp,Zv,Qf],encapsulation:2}),t})();const P_=["scrollable"],U_=["canvas"],z_=["canvasHover"],J_=["tree"],q_=["openModal"],V_=["calc"];function $_(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",23),o.Rb(1,"button",24),o.Yb("click",function(){return o.zc(t),o.bc().openRulesModal()}),o.Rb(2,"span",2),o.Ob(3,"img",25),o.Ob(4,"img",26),o.Qb(),o.Rb(5,"span",27),o.Lc(6),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(1),o.jc("alertSound","ui_click_default"),o.Bb(5),o.Mc(t.L("meta.ui.mode.rules.button_text"))}}function G_(t,e){if(1&t&&o.Ob(0,"currency",33),2&t){const t=o.bc().$implicit;o.jc("value",t.value.cat())("type",t.key)("smallSize",!0)}}function H_(t,e){if(1&t&&(o.Rb(0,"div",31),o.Jc(1,G_,1,3,"currency",32),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2);o.Fb("not-loaded",!i.isLoaded)("disabled",!i.isLoaded),o.Bb(1),o.jc("ngIf","freeXpTotal"!=t.key&&"silverTotal"!=t.key)}}function Y_(t,e){if(1&t&&(o.Rb(0,"div",28),o.Rb(1,"div",29),o.Jc(2,H_,2,5,"div",30),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(2),o.jc("ngForOf",t.campaignMoney)}}function W_(t,e){1&t&&o.Ob(0,"span",37)}function K_(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div"),o.Rb(1,"unit",35),o.Yb("mouseenter",function(){o.zc(t);const i=e.$implicit;return o.bc(2).startAnimateOpening(i)})("mouseleave",function(){return o.zc(t),o.bc(2).stopAnimateOpening()})("click",function(){o.zc(t);const i=e.$implicit;return o.bc(2).setActiveUnit(i)}),o.Qb(),o.Jc(2,W_,1,0,"span",36),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Ic("top",i.itemHeight*t.position.y+2*i.gutter*i.pixelRatio*t.position.y+1+"px")("left",i.itemWidth*t.position.x+2*i.gutter*i.pixelRatio*t.position.x+1+"px"),o.Cb("data-position-y",i.itemHeight+","+t.position.y+","+2*i.gutter*i.pixelRatio+","+t.position.y)("data-position-x",i.itemWidth+","+t.position.x+","+2*i.gutter*i.pixelRatio+","+t.position.x),o.Bb(1),o.Fb("selected",i.activeUnit&&t.id==i.activeUnit.id),o.kc("tooltip-hint",i.L("meta.ui.unit.action.lbtn")),o.jc("data",t)("highlighted",i.animatedUnits[0]===t.id)("parentRoute","technology")("alertSound","ui_click_default")("campaignId",i.selectedCampaign),o.Bb(1),o.jc("ngIf",i.getCounter("ui.mark.tech.id."+t.id))}}function X_(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,K_,3,15,"div",34),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngForOf",t.units)}}function Z_(t,e){1&t&&o.Ob(0,"img",42)}function tk(t,e){if(1&t&&(o.Rb(0,"span"),o.Ob(1,"img",44),o.Lc(2),o.Ob(3,"span",45),o.Qb()),2&t){const t=o.bc(3);o.Bb(2),o.Mc(t.substrateUnitRequirement.gold.cat())}}function ek(t,e){if(1&t&&(o.Rb(0,"span"),o.Ob(1,"img",46),o.Lc(2),o.Ob(3,"span",45),o.Qb()),2&t){const t=o.bc(3);o.Bb(2),o.Mc(t.substrateUnitRequirement.silver.cat())}}function ik(t,e){if(1&t&&(o.Rb(0,"span"),o.Ob(1,"img",47),o.Lc(2),o.Qb()),2&t){const t=o.bc(3);o.Bb(2),o.Nc("",t.substrateUnitRequirement.expo.cat()," ")}}function nk(t,e){if(1&t&&(o.Rb(0,"div",43),o.Rb(1,"div",39),o.Lc(2),o.Qb(),o.Jc(3,tk,4,1,"span",18),o.Jc(4,ek,4,1,"span",18),o.Jc(5,ik,3,1,"span",18),o.Qb()),2&t){const t=o.bc(2);o.Bb(2),o.Mc(t.L("meta.ui.tech.requirements")),o.Bb(1),o.jc("ngIf",t.substrateUnitRequirement.gold),o.Bb(1),o.jc("ngIf",t.substrateUnitRequirement.silver),o.Bb(1),o.jc("ngIf",t.substrateUnitRequirement.expo)}}const sk=function(t){return{unit:t}};function ak(t,e){if(1&t&&(o.Rb(0,"section",38),o.Rb(1,"div",39),o.Lc(2),o.Qb(),o.Rb(3,"h1"),o.Lc(4),o.Jc(5,Z_,1,0,"img",40),o.Qb(),o.Jc(6,nk,6,4,"div",41),o.Qb()),2&t){const t=o.bc();o.Bb(2),o.Mc(t.L("meta.ui.tech.branch",o.nc(4,sk,t.L("unit."+t.substrateUnit.id+".name")))),o.Bb(2),o.Nc(" ",t.L("unit."+t.substrateUnit.id+".short")," "),o.Bb(1),o.jc("ngIf",t.substrateUnitRequirement.completed),o.Bb(1),o.jc("ngIf",!t.substrateUnitRequirement.completed&&!1)}}const rk=function(){return{key:27,zIndex:1}},ok=function(){return{head:!0,fullDescription:!1,counters:!0,chart:!1}};function ck(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",48),o.Rb(1,"div",49),o.Rb(2,"button",50),o.Yb("click",function(){return o.zc(t),o.bc().closeUnitDetail()}),o.Lc(3),o.Qb(),o.Qb(),o.Rb(4,"div",51),o.Rb(5,"scrollable",52,15),o.Ob(7,"open-unit",53),o.Ob(8,"unit-details",54),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(2),o.kc("tooltip-hint",t.L("meta.ui.store.close")),o.jc("alertSound","ui_click_default")("key-duplicator",o.mc(12,rk)),o.Bb(1),o.Nc(" \u2715 ",t.L("meta.ui.store.close")," "),o.Bb(2),o.jc("bbox",!0)("fade",!0),o.Bb(2),o.jc("receivedUnit",t.activeUnit)("receivedCampaign",t.campaignId),o.Bb(1),o.jc("unit",t.activeUnit)("campaignId",t.campaignId)("campaignCurrency",t.campaignCurrency)("unitData",o.mc(13,ok))}}const lk=function(t){return[t]},uk=function(){return{key:27,zIndex:0}};let dk=5,hk=(()=>{class t{constructor(t,e,i,n,s,a){this.cache=t,this.router=e,this.sanitizer=i,this.notificatorService=n,this.activatedRoute=s,this.chatService=a,this.treeVisible=!1,this.units=[],this.gutter=20,this.linesGap=10,this.lineWidth=1,this.unitsTemplates={},this.grid={size:new yl(1,1)},this.repeats={},this.rect={left:0,right:0,top:0,bottom:0,width:0,height:0},this.links={},this.gridLinks=[],this.calcValue=1,this.openingUnitIndex=-1,this.animatedUnits=[],this.pixelRatio=1,this.playerIsTeamLeader=!1,this.userInTeam=!1,this.substratePosition=new yl,this.substrateSize=new yl,this.substrateUnits=[],this.substrateUnit=null,this.substrateTimer=null,this.substrateUnitRequirement={gold:0,expo:0,silver:0,completed:!1},this.substrateUnitFinals=[],this.army="",this.globalEvent=new uu,this.campaigns=[],this.selectedCampaign="",this.campaignId="",this.campaignCurrency="",this.campaignMoney=[],this.campaignHasTasks=!1,this.cssVariables={nameHeight:0,gridGap:0},this.visibleUnits={fromIndex:0,toIndex:4*dk},this._lastFromIndex=0,this.unitSize=new yl,this.itemWidth=this.cache.unitSize.x,this.itemHeight=this.cache.unitSize.y,window.addEventListener("resize",t=>{this.updateRects(),this.drawArrows(this.ctx)}),window.addEventListener("keydown",t=>{},{once:!0}),(new al).data.subscribe(t=>this.L=t)}selectCampaign(t){this.selectedCampaign=t,this.getTree()}hardReload(){let t=this.router.url.split("/");t.shift(),t[t.length-1]=t[t.length-1].split("?")[0],this.ownerChangeSubscription&&this.ownerChangeSubscription.unsubscribe(),this.cache.redirect(["campaigns",this.campaignId,"detail","missions"]),setTimeout(()=>{console.log(t),this.cache.redirect(t)})}getUnitTemplate(t){return kl.createUnitByTemplate(t,{},this.sanitizer)}ngOnInit(){let t=getComputedStyle(document.documentElement);this.cssVariables.nameHeight=parseInt(t.getPropertyValue("--unit-name-height")),this.cssVariables.gridGap=.625*parseInt(t.getPropertyValue("--margin")),this.campaigns=this.cache.getCampaigns(),this.cache.getGlobalCampaign()&&(this.campaignId=this.cache.getGlobalCampaign().id,this.campaignCurrency=this.cache.getCampaign(this.campaignId).currency,this.selectedCampaign=this.campaignId,this.campaignMoney=this.getCampaignMoney(this.selectedCampaign),this.campaignHasTasks=!!(this.cache.getCampaign(this.campaignId)&&this.cache.getCampaign(this.campaignId).tasks&&this.cache.getCampaign(this.campaignId).tasks.length)),this.userInTeam=!(!this.cache.getUserTeamId()||!this.cache.getUserTeamId().length),this.playerIsTeamLeader=this.cache.isTeamOwner(),this.canvas=this.canvas.nativeElement,this.ctx=this.canvas.getContext("2d"),this.canvasHover=this.canvasHover.nativeElement,this.ctxHover=this.canvasHover.getContext("2d"),this.updateRects(),this.armySubscription=this.cache.army.subscribe(t=>{this.getTree()}),this.unitsSubscription=this.cache.unitsTree.pipe(We(t=>null!==t)).subscribe(t=>{if(console.log(t),t.patch)return t.tree.map(t=>{let e=this.units.findIndex((e,i)=>t.id===e.id);this.units.splice(e,1,this.getUnitById(t.id))}),this.updateRects(),void this.drawArrows(this.ctx)}),this.cache.setCounter("ui.mark.tech.menu",0),this.ownerChangeSubscription=this.cache.ownerChange.pipe(We(t=>null!==t)).subscribe(()=>{wu(()=>{console.warn("Owner change update [Tech tree | hard url reload]"),this.hardReload()},1e3,"tech_tree_owner_reload")}),this.teamDataSubscription=this.chatService.teamsData.pipe(We(t=>null!==t)).subscribe(t=>{this.userInTeam=!(!this.cache.getUserTeamId()||!this.cache.getUserTeamId().length),this.playerIsTeamLeader=this.cache.isTeamOwner()}),this.globalEvent.subscribe(t=>{"troops.unit_explore"===t.key&&this.updateData()}),this.scrollable.onScroll.subscribe(()=>{})}isUnitInViewport(t){return t>=this.scrollable.scroll.top-this.cache.unitSize.y&&t<this.scrollable.scroll.top+this.scrollable.host.getBoundingClientRect().height}_calcualteVisibleArea(){dk=Math.floor(this.scrollable.host.getBoundingClientRect().height/this.cache.unitSize.y)}_processViewport(){this._calcualteVisibleArea(),Math.clamp(this.scrollable.scroll.top/this.scrollable.scroll.maxTop,0,1);let t=4*Math.floor(this.scrollable.scroll.top/(this.unitSize.y+this.cssVariables.gridGap));t!==this._lastFromIndex&&(this._lastFromIndex=t,this.visibleUnits={fromIndex:t,toIndex:t+4*dk})}ngOnDestroy(){this.armySubscription&&this.armySubscription.unsubscribe(),this.unitsSubscription&&this.unitsSubscription.unsubscribe(),this.teamDataSubscription&&this.teamDataSubscription.unsubscribe(),this.stopAnimateOpening()}getTree(){this.army=this.cache.getCurrentArmy(),this.units=[],this.treeVisible=!1,this.scrollable&&this.scrollable.moveUp(),setTimeout(()=>{this.selectedCampaign?(this.units=this.cache.getTreeUnits(this.selectedCampaign),console.log("units for "+this.selectedCampaign,this.units)):(this.units=this.cache.getTreeUnits(),console.log("units",this.units)),this.grid.size=this.units.size,(()=>{setTimeout(()=>{this.treeVisible=!0,this.updateRects(),this.drawArrows(this.ctx),this.scrollable&&(this.scrollable.setRects(),this.scrollable.update())})})()},300)}calcChange(t){this.calcValue=t.value}updateRects(){this.tree&&this.tree.nativeElement&&(this.itemWidth=this.cache.unitSize.x,this.itemHeight=this.cache.unitSize.y,this.rect=this.tree.nativeElement.getBoundingClientRect(),this.gutter=2*Math.round((this.rect.width-8*this.itemWidth)/7/2),this.gutter/=2,this.canvas&&(this.canvas.width=this.itemWidth*this.grid.size.x+2*this.gutter*this.grid.size.x+this.itemWidth,this.canvas.height=this.itemHeight*this.grid.size.y+this.itemHeight+2*this.gutter*this.grid.size.y),this.canvasHover&&(this.canvasHover.width=this.itemWidth*this.grid.size.x+2*this.gutter*this.grid.size.x+this.itemWidth,this.canvasHover.height=this.itemHeight*this.grid.size.y+this.itemHeight+2*this.gutter*this.grid.size.y),this.scrollable.setRects(),this.scrollable.update())}setImageFallback(t,e){t.image=e}getUnitById(t){return this.cache.getTreeUnit(t,this.selectedCampaign)}getUnitByPosition(t){return this.cache.getTreeUnitByPosition(t)}drawLine(t,e,i,n="white",s="source-over"){e=e.floor(),i=i.floor();let a=new yl(Math.min(e.x,i.x),Math.min(e.y,i.y)),r=new yl(Math.max(e.x,i.x),Math.max(e.y,i.y)).clone().subtract(a).fill(this.lineWidth);t.fillStyle=n,t.beginPath(),r.y>r.x&&(r.y+=r.x),t.rect(a.x,a.y,r.x,r.y),t.fill()}drawPath(t,e,i="white",n="source-over"){for(let s=1;s<e.length;s++){let a;if(s===e.length-1){let t=e[s].subtract(e[s-1]);a=e[s-1].add(t.multiply(1-this.cache.arrowSize/t.getLength()))}this.drawLine(t,e[s-1],a||e[s],i,n)}}drawArrow(t,e,i="right",n="#fff"){let s=this.lineWidth+this.cache.arrowSize,a={right:Math.degreesToRadians(-180),bottom:Math.degreesToRadians(-90),left:Math.degreesToRadians(0),top:Math.degreesToRadians(90)};_u.drawArrow(t,e,s,a[i],n)}drawPoint(t,e,i="red"){t.beginPath(),t.fillStyle=i,t.arc(e.x,e.y,2,0,2*Math.PI),t.fill()}getUnitOriginPoint(t,e="left"){let i=new yl;switch(i.x=t.position.x*this.itemWidth+t.position.x*(2*this.gutter*this.pixelRatio),i.y=t.position.y*this.itemHeight+t.position.y*(2*this.gutter*this.pixelRatio)+this.itemHeight/2,e){case"right":i.x+=this.itemWidth;break;case"top":i.y-=this.itemHeight/2;break;case"bottom":i.y+=this.itemHeight/2}return"top"!==e&&"bottom"!==e||(i.x+=this.itemWidth/2),i}getUnitOrigin(t,e){let i="left";return t.position.x===e.position.x?i=t.position.y<e.position.y?"top":"bottom":t.position.x>e.position.x&&(i="right"),i}getPathBetweenUnits(t,e,i=0,n=0){let s=this.getUnitOrigin(t,e),a=[],r=this.getUnitOriginPoint(t,this.getUnitOrigin(e,t)),o=this.getUnitOriginPoint(e,this.getUnitOrigin(t,e)),c=(t.position.distanceTo(e.position),this.getUnitByPosition(t.position.clone().add(new yl(1,0)))),l=(c&&1===c.opensBy.length&&1===t.opens.length&&t.opens.indexOf(c.id),this.itemHeight/4);if("top"!==s&&"bottom"!==s&&(r.y+=i*l,o.y+=n*l),a.push(r),r.x!==o.x){let t=r.clone().add(new yl(this.gutter*this.pixelRatio-Math.abs(i),0)),e=new yl(t.x,o.y);a.push(t),a.push(e)}return a.push(o),a}sortUnitOpeningPoints(t,e){e?t.opens.filter(e=>{let i=this.getUnitById(e);return!!i&&i.position.x!==t.position.x}).length>1&&t.opens.map(e=>{let i=this.getUnitById(e);if(!i)return!1;t.opensQueue[e]=i.position.y-t.position.y}):t.opensBy.filter(e=>{let i=this.getUnitById(e);return!!i&&i.position.x!==t.position.x}).length>1&&t.opensBy.map(e=>{let i=this.getUnitById(e);if(!i)return!1;t.opensByQueue[e]=i.position.y-t.position.y})}drawArrows(t){let e=getComputedStyle(document.documentElement).getPropertyValue("--color-primary");t.clearRect(0,0,this.canvas.width,this.canvas.height),t.lineWidth=1,this.units.map(i=>{!i.opens||i.opens&&!i.opens.length||(this.sortUnitOpeningPoints(i,!0),i.opens.map((n,s)=>{let a=this.getUnitById(n);if(!a)return;if(this.selectedCampaign&&(!a.campaign||!a.campaign[this.selectedCampaign]))return;if(this.animatedUnits.length&&this.animatedUnits.indexOf(n)<0)return;let r,o,c=this.substrateUnits.find(t=>t.id===i.id),l=this.substrateUnits.find(t=>t.id===a.id);this.sortUnitOpeningPoints(a,!1),c||l?c&&!c.blured&&l?(o=i.premium?e:"#fff",r="source-over"):(o="rgba(0,0,0,0)",r="destination-over"):this.substrateUnits.length>1?(o="rgba(0,0,0,0)",r="destination-over"):(r=i.premium||a.open||i.open?"source-over":"destination-over",o=i.premium?e:a.open||i.open?"#fff":"#777");let u=this.getPathBetweenUnits(i,a,i.opensQueue[a.id],a.opensByQueue[i.id]);this.drawPath(t,u,o,r),this.drawArrow(t,u[u.length-1],this.getUnitOrigin(i,a),o)}))})}openUnit(t,e,i){e&&e.preventDefault&&e.preventDefault(),t.open||t.premium||t.collectible||!this.cache.isFreemiumUnitOpen(t)||(this.openingUnitIndex=i,console.log(this.selectedCampaign),this.cache.openUnitInTree(t.id,this.selectedCampaign))}logUnit(t){console.log(t)}onScrollStart(t){}startAnimateOpening(t){this.stopAnimateOpening(),this.substrateUnit=this.getUnitById(t.id),this.animatedUnits.push(t.id);let e=(t,i="")=>{let n=[],s=this.cache.getTreeAmount(t.id);if(t.open||t.premium||(this.substrateUnitRequirement.expo+=t.xpOpen),t.premium?s.total||(this.substrateUnitRequirement.gold+=t.premiumGold):t.open||s.total||(this.substrateUnitRequirement.silver+=t.silverCost),t.opensBy&&t.opensBy.length)for(let a=0;a<t.opensBy.length;a++){n.push(t.opensBy[a]);let i=this.getUnitById(t.opensBy[a]);i.opensBy&&(n=n.concat(e(i,t.id)))}return n},i=t=>{let e=[],n=t.opens;if(!n||!n.length)return e;for(let s=0;s<n.length;s++){e.push(n[s]);let t=this.getUnitById(n[s]);t.opens?e=e.concat(i(t)):this.substrateUnitFinals.push(this.getUnitById(t.id))}return e};this.animatedUnits=this.animatedUnits.concat(e(t)).concat(i(t)),this.substrateUnitRequirement.expo||this.substrateUnitRequirement.silver||(this.substrateUnitRequirement.completed=!0),this.animatedUnits.length<=1||(this.substrateTimer=setTimeout(()=>{let e=new yl(100,100),i=new yl;this.animatedUnits.map((t,n)=>{let s=this.units.find(e=>e.id===t);s&&(s.animated=!0,e=e.min(s.position),i=i.max(s.position))}),this.substrateUnits=this.units.filter(t=>t.position.x>=e.x&&t.position.y>=e.y&&t.position.x<=i.x&&t.position.y<=i.y),this.units.map(t=>{t.blured=this.animatedUnits.indexOf(t.id)<0}),this.substratePosition=e,this.substrateSize=i.subtract(e),this.substrateSize.x+=1,this.substrateSize.y+=1,this.substrateUnits.length&&this.drawArrows(this.ctxHover),this.triggerGlobalEvent("troops.hightligt_branch",{tutorial:!0,unitId:t.id,branch:this.animatedUnits})},2e3))}stopAnimateOpening(){this.substrateTimer&&clearTimeout(this.substrateTimer),this.animatedUnits.map(t=>{let e=this.units.find(e=>e.id===t);e&&(e.animated=!1)}),this.units.map(t=>t.blured=!1),this.animatedUnits=[],this.substrateUnits=[],this.substratePosition=new yl,this.substrateSize=new yl,this.substrateUnit=null,this.drawArrows(this.ctx),this.substrateUnitRequirement={gold:0,expo:0,silver:0,completed:!1},this.substrateUnitFinals=[]}getCounter(t){return this.cache.getCounter(t)}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}hasFlag(t){return this.cache.hasFlag(t)}getCampaignMoney(t){let e=this.cache.getCampaign(t),i=[];if(!e)return i;let n=null;if(e&&e.progress&&e.progress.money){n=e.progress.money;for(let t in n){let s={};"silver"==t&&e.currency?(s.key=e.currency,s.value=n[t],i.push(s)):"freeXp"==t?(s.key="free_xp",s.value=n[t],i.push(s)):(s.key=t,s.value=n[t],i.push(s))}}return i}setActiveUnit(t){t&&(this.activeUnit=t,this.cache.alertSound("ui_panel_appear_woosh"))}closeUnitDetail(){this.activeUnit=null}updateData(){this.campaignMoney=this.getCampaignMoney(this.selectedCampaign),this.activeUnit=null}openRulesModal(){this.triggerGlobalEvent("tech_tree_rules_modal.open")}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Ys),o.Nb(Er),o.Nb(Uc),o.Nb(xn),o.Nb(Pd))},t.\u0275cmp=o.Hb({type:t,selectors:[["tech-tree"]],viewQuery:function(t,e){if(1&t&&(o.Fc(P_,!0),o.Fc(U_,!0),o.Fc(z_,!0),o.Fc(J_,!0),o.Qc(q_,!0),o.Qc(V_,!0)),2&t){let t;o.vc(t=o.Zb())&&(e.scrollable=t.first),o.vc(t=o.Zb())&&(e.canvas=t.first),o.vc(t=o.Zb())&&(e.canvasHover=t.first),o.vc(t=o.Zb())&&(e.tree=t.first),o.vc(t=o.Zb())&&(e.openModal=t.first),o.vc(t=o.Zb())&&(e.calc=t.first)}},hostVars:4,hostBindings:function(t,e){2&t&&o.Fb("faded-edges",!0)("grid-default",!0)},features:[o.Ab([Pd])],decls:34,vars:61,consts:[["class","rules-helper",4,"ngIf"],["href","","queryParamsHandling","merge","g-back","",1,"button","white",3,"routerLink","tooltip-hint","alertSound","key-duplicator","click"],[1,"icon-group"],["src","assets/img/icons/svg/back-button-icon.svg","draggable","false",1,"icon","hover-hidden"],["src","assets/img/icons/svg/back-button-icon_hover.svg","draggable","false",1,"icon","hover-visible"],["g-campaign-tech-tab",""],["href","","queryParamsHandling","merge","routerLinkActive","active",1,"button","tab",3,"routerLink","tooltip-hint","alertSound","click"],["g-campaign-tech-full-money","",4,"ngIf"],["g-tech-simple-link",""],["href","","queryParamsHandling","merge",1,"button","small","spaced-middle",3,"routerLink","tooltip-hint","alertSound","click"],["g-campaign-tech-main",""],[1,"preloader"],[3,"campaignId"],["compare",""],[2,"height","95%",3,"fade"],["scrollable",""],[1,"tree"],["tree",""],[4,"ngIf"],["canvas",""],["canvasHover",""],["class","hightlight-substrate","fade-in","down",4,"ngIf"],["class","unit-details",4,"ngIf"],[1,"rules-helper"],[1,"button","white",3,"alertSound","click"],["src","assets/img/icons/svg/attention-light.svg","draggable","false",1,"icon","hover-hidden"],["src","assets/img/icons/svg/attention-red.svg","draggable","false",1,"icon","hover-visible"],[1,"text"],["g-campaign-tech-full-money",""],[1,"money","align-center","spaced-middle"],["class","money-item",3,"not-loaded","disabled",4,"ngFor","ngForOf"],[1,"money-item"],[3,"value","type","smallSize",4,"ngIf"],[3,"value","type","smallSize"],[3,"top","left",4,"ngFor","ngForOf"],[3,"data","highlighted","parentRoute","tooltip-hint","alertSound","campaignId","mouseenter","mouseleave","click"],["class","marker",4,"ngIf"],[1,"marker"],["fade-in","down",1,"hightlight-substrate"],[1,"info"],["src","assets/img/icons/svg/checked_primary.svg","alt","","class","icon larger margin-left",4,"ngIf"],["class","requirement","fade-in","down",4,"ngIf"],["src","assets/img/icons/svg/checked_primary.svg","alt","",1,"icon","larger","margin-left"],["fade-in","down",1,"requirement"],["src","assets/img/icons/svg/gold.svg",1,"icon","margin-right"],[1,"space"],["src","assets/img/icons/svg/silver.svg",1,"icon","margin-right"],["src","assets/img/icons/svg/exp.svg",1,"icon","margin-right"],[1,"unit-details"],[1,"align-right"],[1,"button","white",3,"tooltip-hint","alertSound","key-duplicator","click"],[2,"height","99%"],[3,"bbox","fade"],[1,"spaced-bottom-larger",3,"receivedUnit","receivedCampaign"],["fade-in","",3,"unit","campaignId","campaignCurrency","unitData"]],template:function(t,e){1&t&&(o.Jc(0,$_,7,2,"div",0),o.Rb(1,"a",1),o.Yb("click",function(){return e.triggerGlobalEvent("button.navigation.play.campaign")}),o.Rb(2,"span",2),o.Ob(3,"img",3),o.Ob(4,"img",4),o.Qb(),o.Lc(5),o.Qb(),o.Rb(6,"div",5),o.Rb(7,"a",6),o.Yb("click",function(){return e.triggerGlobalEvent("button.campaign.missions")}),o.Lc(8),o.Qb(),o.Rb(9,"a",6),o.Yb("click",function(){return e.triggerGlobalEvent("button.campaign.technology")}),o.Lc(10),o.Qb(),o.Rb(11,"a",6),o.Yb("click",function(){return e.triggerGlobalEvent("button.campaign.tasks")}),o.Lc(12),o.Qb(),o.Qb(),o.Jc(13,Y_,3,1,"div",7),o.Rb(14,"div",8),o.Rb(15,"a",9),o.Yb("click",function(){return e.triggerGlobalEvent("button.navigation.play.campaign")}),o.Lc(16),o.Qb(),o.Qb(),o.Rb(17,"div",10),o.Rb(18,"div",11),o.Ob(19,"span"),o.Lc(20),o.Qb(),o.Ob(21,"unit-compare-table",12,13),o.Rb(23,"scrollable",14,15),o.Rb(25,"div",16,17),o.Jc(27,X_,2,1,"div",18),o.Ob(28,"canvas",null,19),o.Ob(30,"canvas",null,20),o.Jc(32,ak,7,6,"section",21),o.Qb(),o.Qb(),o.Qb(),o.Jc(33,ck,9,14,"div",22)),2&t&&(o.jc("ngIf",!e.activeUnit),o.Bb(1),o.kc("tooltip-hint",e.L("meta.ui.play.back")),o.jc("routerLink",o.nc(50,lk,"/campaigns/"+e.campaignId+"/detail/technology/"))("alertSound","ui_back")("key-duplicator",o.mc(52,uk)),o.Cb("data-tooltip",e.L("meta.ui.play.back")),o.Bb(4),o.Nc(" ",e.L("meta.ui.play.back"),"\n"),o.Bb(2),o.kc("tooltip-hint",e.L("meta.ui.menu.missions")),o.jc("routerLink",o.nc(53,lk,"/campaigns/"+e.campaignId+"/detail/missions"))("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L("meta.ui.menu.missions")),o.Bb(1),o.Nc(" ",e.L("meta.ui.menu.missions")," "),o.Bb(1),o.kc("tooltip-hint",e.L("meta.ui.menu.tech")),o.jc("routerLink",o.nc(55,lk,"/campaigns/"+e.campaignId+"/technology/full"))("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L("meta.ui.menu.tech")),o.Bb(1),o.Nc(" ",e.L("meta.ui.menu.tech")," "),o.Bb(1),o.Fb("disabled",!e.campaignHasTasks||!e.playerIsTeamLeader&&e.userInTeam),o.kc("tooltip-hint",e.L("meta.ui.menu.tasks")),o.jc("routerLink",o.nc(57,lk,"/campaigns/"+e.campaignId+"/detail/tasks"))("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L("meta.ui.menu.tasks")),o.Bb(1),o.Nc(" ",e.L("meta.ui.menu.tasks")," "),o.Bb(1),o.jc("ngIf",e.campaignMoney&&e.campaignMoney.length),o.Bb(1),o.Fb("to-right",e.campaignMoney&&e.campaignMoney.length),o.Bb(1),o.kc("tooltip-hint",e.L("meta.ui.tech.show_simple_version")),o.jc("routerLink",o.nc(59,lk,"/campaigns/"+e.campaignId+"/detail/technology/"))("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L("meta.ui.tech.show_simple_version")),o.Bb(1),o.Nc(" ",e.L("meta.ui.tech.show_simple_version")," "),o.Bb(2),o.Fb("disabled",e.treeVisible),o.Bb(2),o.Nc("",e.L("meta.ui.tech.preloader")," "),o.Bb(1),o.jc("campaignId",e.campaignId),o.Bb(2),o.jc("fade",!0),o.Bb(2),o.Fb("active",e.treeVisible),o.Bb(2),o.jc("ngIf",e.treeVisible),o.Bb(1),o.Fb("active",e.treeVisible)("faded",e.substrateUnits.length>1),o.Bb(2),o.Fb("active",e.treeVisible)("faded",e.substrateUnits.length<=1),o.Bb(2),o.jc("ngIf",e.substrateUnits.length>0),o.Bb(1),o.jc("ngIf",e.activeUnit))},directives:[ee,Ks,tp,Zv,ty,Zs,Py,Rh,Zt,Ef,d_,h_,M_,F_],encapsulation:2}),t})();function bk(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",3),o.Rb(1,"button",4),o.Yb("click",function(){o.zc(t);const i=e.$implicit,n=o.bc();return i.value===n.selectedArmy?n.void():n.setArmy(i),i.disabled?n.void():n.triggerGlobalEvent("button.select_army."+i.value)}),o.Lc(2),o.Ob(3,"img",5),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc();o.Bb(1),o.Fb("active",t.value===i.selectedArmy)("disabled",t.disabled),o.jc("alertSound",t.disabled?null:"ui_click_default"),o.Cb("data-tooltip",i.L("meta.ui.menu.nation."+t.value)),o.Bb(1),o.Nc(" ",i.L("meta.ui.menu.nation."+t.value)," "),o.Bb(1),o.jc("src","assets/img/flags/campaign_"+t.value+".png",o.Cc)}}const mk=["jap","eng"];let pk=(()=>{class t{constructor(t,e,i){this.cache=t,this.router=e,this.activateRoute=i,this.selectedArmy="",this.commanders=null,this.units=null,this.disabled=!1,this.globalEvent=new uu,(new al).data.subscribe(t=>this.L=t),this.selectedArmy=this.cache.getCurrentArmy(),this.resetArmies(),this.updateArmies(),this.armySubscribtion=this.cache.army.subscribe(t=>{this.selectedArmy=t})}resetArmies(){let e=t.armiesToArray(t.createArmies());this.armies=e}updateArmies(){let t=this.units||this.commanders||[],e={};for(let i=0;i<t.length;i++){let n=t[i];e[n.army]||(e[n.army]=!0)}this.armies.map(t=>(t.disabled=!e[t.value],t))}ngOnInit(){}ngDoCheck(){}ngOnDestroy(){this.armySubscribtion&&this.armySubscribtion.unsubscribe()}ngOnChanges(t){wu(()=>{this.updateArmies()},100,"updateArmies")}setArmy(t){this.selectedArmy=t.value,this.cache.setArmy(t.value)}void(){}static createArmies(t){return t?new lu(t):new lu}static armiesToArray(t){return Object.keys(t).map(e=>t[e]).filter(t=>mk.indexOf(t.value)<0).sort((t,e)=>!t.disabled&&e.disabled?-1:t.disabled&&!e.disabled?1:0)}triggerGlobalEvent(t){this.globalEvent.trigger(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Ys),o.Nb(xn))},t.\u0275cmp=o.Hb({type:t,selectors:[["select-army"]],inputs:{commanders:"commanders",units:"units"},features:[o.zb],decls:3,vars:3,consts:[[3,"bbox","origin"],[1,"clear"],["fade-in","down",4,"ngFor","ngForOf"],["fade-in","down"],["type","button",1,"button","tab",3,"alertSound","click"],["alt","",3,"src"]],template:function(t,e){1&t&&(o.Rb(0,"scrollable",0),o.Rb(1,"ul",1),o.Jc(2,bk,4,8,"li",2),o.Qb(),o.Qb()),2&t&&(o.jc("bbox",!0)("origin","left"),o.Bb(2),o.jc("ngForOf",e.armies))},encapsulation:2}),t})();function gk(t,e){if(1&t&&o.Ob(0,"span",18),2&t){const t=o.bc(4);o.kc("tooltip-hint",t.L("meta.hint.play.commander.low_filling"))}}function fk(t,e){1&t&&o.Ob(0,"span",19)}const vk=function(t){return{locked:t}};function yk(t,e){if(1&t&&(o.Rb(0,"span",20),o.Lc(1),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(3);o.Bb(1),o.Nc(" ",e.L("meta.ui.campaign.conquest.battalion_disabled",o.nc(1,vk,e.lockedCommanders&&e.lockedCommanders[t.id]?e.lockedCommanders[t.id].locked:0))," ")}}function _k(t,e){if(1&t&&(o.Rb(0,"span",20),o.Lc(1),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(3);o.Bb(1),o.Nc(" ",e.L(e.campaignCommanders[t.id].nodeNext.length?"meta.ui.campaign.conquest.battalion_in_other_location":"meta.ui.campaign.conquest.battalion_in_reserve")," ")}}function kk(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",21),o.Rb(1,"button",22),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit;return o.bc(3).lockBattalion(e.id)}),o.Ob(2,"img",23),o.Qb(),o.Qb()}2&t&&(o.Bb(1),o.jc("alertSound","ui_click_default"))}function wk(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",8),o.Rb(1,"div",9),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(3).setActiveCommander(i)})("dblclick",function(){o.zc(t);const i=e.$implicit,n=o.bc(3);return"classic"==n.tag?n.void():n.goToEchelons(i)})("contextmenu",function(i){o.zc(t);const n=e.$implicit,s=o.bc(3);return"classic"==s.tag?s.void():s.goToEchelons(n,i)}),o.Rb(2,"figure",10),o.Ob(3,"img",11),o.Rb(4,"figcaption"),o.Lc(5),o.Qb(),o.Qb(),o.Jc(6,gk,1,1,"span",12),o.Jc(7,fk,1,0,"span",13),o.Rb(8,"div",14),o.Ob(9,"img",15),o.Jc(10,yk,2,3,"span",16),o.Jc(11,_k,2,1,"span",16),o.Qb(),o.Qb(),o.Jc(12,kk,3,1,"div",17),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(3);o.Bb(1),o.Fb("active",i.isCommanderActive(t))("disabled",t.containsForbiddenUnits||!t.available&&!t.const)("conquest-disabled",i.isConquestCampaign&&!i.userIsCampaignOwner&&i.lockedCommanders&&i.lockedCommanders&&i.lockedCommanders[t.id]&&i.lockedCommanders[t.id].locked>=1)("conquest-hidden",i.isConquestCampaign&&i.campaignCommanders&&i.campaignCommanders[t.id]&&i.campaignCommanders[t.id].nodeNext!=i.nodeId&&i.userIsCampaignOwner),o.kc("tooltip-hint",null==t.hint?null:t.hint.markdown().br()),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Fb("active",i.isCommanderActive(t)),o.Bb(1),o.jc("src",t.image?"assets/img/commanders/"+t.image+".png":"assets/img/commanders/"+t._id+".png",o.Cc),o.Bb(2),o.Nc(" ",i.L("commander."+t.id+".name").dropWords(58)," "),o.Bb(1),o.jc("ngIf",!i.isCommanderFilled(t)),o.Bb(1),o.jc("ngIf",i.hasCounter("ui.mark.troops.commander_"+t._id)),o.Bb(3),o.jc("ngIf",i.lockedCommanders),o.Bb(1),o.jc("ngIf",i.campaignCommanders&&i.campaignCommanders[t.id]&&i.campaignCommanders[t.id].nodeNext!=i.nodeId&&i.userIsCampaignOwner),o.Bb(1),o.jc("ngIf",i.hasFlag("debug")&&i.isConquestCampaign&&!i.userIsCampaignOwner)}}function Sk(t,e){if(1&t&&(o.Rb(0,"ul",6),o.Jc(1,wk,13,19,"li",7),o.cc(2,"sortList"),o.cc(3,"filterList"),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2);o.Fb("single-column",!i.missionId),o.Bb(1),o.jc("ngForOf",o.ec(2,3,o.fc(3,6,i._commandersFiltered,i.missionId?null:"type",t),i.commanderListSorter))}}const Ik=function(){return[""]},Ck=function(){return["art","inf","tnk"]};function Lk(t,e){if(1&t&&(o.Rb(0,"scrollable",2,3),o.Rb(2,"div",4),o.Jc(3,Sk,4,10,"ul",5),o.Qb(),o.Qb()),2&t){const t=o.bc();o.jc("fade",!0),o.Bb(3),o.jc("ngForOf",t.missionId?o.mc(2,Ik):o.mc(3,Ck))}}function Rk(t,e){if(1&t&&(o.Rb(0,"div",24),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.L("meta.ui.play.no_commanders_for_army"))}}JSON;let Ok=(()=>{class t{constructor(t,e,i,n,s){this.activatedRoute=t,this.cache=e,this.router=i,this.lobbyService=n,this.matchMaking=s,this.static=!1,this.ignoreClosed=!1,this.commanderId="",this.missionId="",this.tag="",this.onCommanderSelect=new o.o,this.campaignId="",this.nodeId="",this.army="",this.commanders=[],this._commandersFiltered=[],this.selectedCommander=null,this.commandersEmpty=!1,this.campaign=null,this.isConquestCampaign=!1,this.campaignCommanders=null,this.lockedCommanders={},this.userIsCampaignOwner=!0,this.globalEvent=new uu,this.counters={},(new al).data.subscribe(t=>this.L=t),this.api=this.cache.getAPIUrl()}ngOnInit(){this.matchMaking.insertGameSparks(nd.gameSparks),this.army=this.cache.getCurrentArmy(),this.activatedRoute.data.value.mode&&(this.tag=this.activatedRoute.data.value.mode),this.static||(this.missionId=this.activatedRoute.snapshot.params.missionId,this.campaignId=this.activatedRoute.snapshot.params.campaignId,this.campaign=this.cache.getCampaign(this.campaignId),this.nodeId=this.getNodeId(),this.isConquestCampaign=this.campaign&&this.campaign.phase&&this.campaign.phase.length,this.campaignCommanders=this.campaign&&this.campaign.progress?this.campaign.progress.commander:null,this.lockedCommanders=this.campaign&&this.campaign.progress&&this.campaign.progress.commanderJoined?this.campaign.progress.commanderJoined:null,this.userIsCampaignOwner=!this.campaign||!this.campaign.progress||this.campaign.progress.player==this.cache.getUserId()),this.globalEvent.subscribe(t=>{"conquest_campaign_change"==t.key&&(this.campaign=this.cache.getCampaign(this.campaignId),this.isConquestCampaign=this.campaign&&this.campaign.category&&"conquest"==this.campaign.category,this.campaignCommanders=this.campaign&&this.campaign.progress?this.campaign.progress.commander:null,this.lockedCommanders=this.campaign&&this.campaign.progress&&this.campaign.progress.commanderJoined?this.campaign.progress.commanderJoined:null,this.userIsCampaignOwner=!this.campaign||!this.campaign.progress||this.campaign.progress.player==this.cache.getUserId(),this.setMissionConquestCommander())}),this.commanderIdSubscribtion=this.cache.commanderId.subscribe(t=>{this.commanderId="",this.selectedCommander=null,setTimeout(()=>{this.commanderId=t,this.selectedCommander=this.cache.getCommander(this.commanderId)})}),this.counters=this.cache.getCounters(),this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>{this.counters[t.path]=t.value}),this.armySubscribtion=this.cache.army.subscribe(t=>{this.army=t,this._commandersFiltered=this.commanders.filter(t=>t.army===this.army),this.selectInitiallyAvailableCommander()}),this.commandersAddSubscription=this.cache.onCommanderAdded.pipe(We(t=>null!==t)).subscribe(t=>{console.log("onCommanderAdded trigger:",t),this.fetchCommanders()})}ngOnChanges(t){t.static&&(this.static=t.static.currentValue),this.static&&t.missionId&&t.missionId.currentValue&&(this.missionId=t.missionId.currentValue,this.campaignId=this.activatedRoute.snapshot.params.campaignId,this.nodeId=this.getNodeId(),this.campaign=this.cache.getCampaign(this.campaignId),this.isConquestCampaign=this.campaign&&this.campaign.phase&&this.campaign.phase.length,this.campaignCommanders=this.campaign&&this.campaign.progress?this.campaign.progress.commander:null,this.lockedCommanders=this.campaign&&this.campaign.progress&&this.campaign.progress.commanderJoined?this.campaign.progress.commanderJoined:null,this.userIsCampaignOwner=!this.campaign||!this.campaign.progress||this.campaign.progress.player==this.cache.getUserId(),this.fetchCommanders(),this.setMissionConquestCommander()),t.tag&&this.fetchCommanders()}getNodeId(){if(this.campaignId&&this.missionId){let t=this.cache.getCampaignTree(this.campaignId),e="";if(console.log(t),t)return e=t.find(t=>t.id==this.missionId),e&&e._id?e._id:""}return""}getParentPath(){return(location.href.match(/campaigns(.*?)\/troops/gim)?`campaigns/${this.campaignId}/troops/`:"")||`${this.activatedRoute.data.value.parent}${this.campaignId?"/"+this.campaignId+"/missions/":""}${this.missionId?"/"+this.missionId+"/":""}`}selectInitiallyAvailableCommander(){let t;this.missionId||(t=this.cache.getSelectedCommanderForArmy(this.army)),this._commandersFiltered.length&&(this._commandersFiltered.find(e=>e.id===(t||this.commanderId))?t&&t!==this.commanderId&&(this.commanderId=t,this.setActiveCommander(this._commandersFiltered.find(t=>t.id===this.commanderId),!0)):this.setActiveCommander(this._commandersFiltered[0],!0))}fetchCommanders(){let t=this.activatedRoute.snapshot.data.parent,e=(this.cache.getMission(this.missionId),this.cache.getCommanders(this.missionId&&t&&t.match(/(mission|campaigns|multiplayer)/gim)?{mission:this.missionId}:this.campaignId?{campaign:this.campaignId}:{tag:this.tag||""}));this.commandersSubscribtion&&this.commandersSubscribtion.unsubscribe(),console.log(e),e&&(this.commanders=[],this.commandersEmpty=!1,wu(()=>{this.commanders=[].concat(e),this._commandersFiltered=this.missionId?this.commanders.slice():this.commanders.filter(t=>t.army===this.army),this.commanders.filteredAvailableArmies=e.filteredAvailableArmies,this.commanders.options=e.options,0===this.commanders.length?this.commandersEmpty=!0:this.selectInitiallyAvailableCommander(),this.getCommandersTooltip(e),this.setMissionConquestCommander()},100,"commanders_select_commander"))}ngOnDestroy(){this.commanderIdSubscribtion&&this.commanderIdSubscribtion.unsubscribe(),this.commandersSubscribtion&&this.commandersSubscribtion.unsubscribe(),this.armySubscribtion&&this.armySubscribtion.unsubscribe(),this.commanderSubscribtion&&this.commanderSubscribtion.unsubscribe()}setMissionConquestCommander(){if(!this.isConquestCampaign)return;let t=this.commanders.find(t=>t.id==this.commanderId);t&&this.campaignCommanders[t.id]&&this.campaignCommanders[t.id].nodeNext!==this.nodeId&&(()=>{for(let t of this.commanders)if(this.campaignCommanders[t.id]&&this.campaignCommanders[t.id].nodeNext===this.nodeId){this.setActiveCommander(t,!0),this.commandersEmpty=!1;break}})(),t&&this.campaignCommanders[t.id].nodeNext===this.nodeId||this.setActiveCommander(null,!0)}setActiveCommander(t,e,i){this.ignoreClosed&&t&&!t.available&&!t.const||(i&&i.preventDefault(),t&&(t.conquestLocked=!!(this.isConquestCampaign&&!this.userIsCampaignOwner&&this.lockedCommanders&&this.lockedCommanders&&this.lockedCommanders[t.id]&&this.lockedCommanders[t.id].locked>=1)),this.triggerGlobalEvent("troops.select_commander",{template:t?t._id:"",id:t&&t.available?t.available.id:""}),this.cache.isReadyToFight()&&this.unsetReady(),this.cache.setCommander(t?t._id:"",!!e),this.onCommanderSelect.emit({commander:t}))}isCommanderFilled(t){return this.cache.isCommanderFilled(t)}isCommanderActive(t){return t&&t._id===this.commanderId}isCommanderAvailableToBuy(t){return this.cache.isCommanderAvailableToBuy(t)}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}void(){}hasCounter(t){return this.cache.hasCounter(t)}getCommandersTooltip(t){t.map(t=>{let e=this.L("commander."+t.id+".name"),i=t.freemiumOpen?t.containsForbiddenUnits?this.L("meta.ui.play.commander_forbidden_units").br():t.available||t.const?this.L("meta.ui.commander.type."+t.type)+", "+this.L("meta.ui.menu.nation."+t.army):this.L("meta.ui.play.commander_unlock_commander"):this.L("meta.hint.commander.premium_required").br();t.hint=`<h4>${e}</h4><div class="paragraph">${i}</div>`})}commanderListSorter(t,e){return t.id.match(/_1st/gim)?-1:0}hasLobby(){return this.lobbyService.hasLobby()}unsetReady(){this.cache.isReadyToFight()&&(this.cache.setReadyToFight(!1),this.cache.getUserTeamId()&&this.matchMaking.teamGameReady(this.cache.getUserTeamId(),!1).subscribe(()=>{}))}goToEchelons(t,e){e&&e.preventDefault(),t.containsForbiddenUnits||!t.available&&!t.const?this.cache.devMode&&console.log("disabled commander"):this.missionId&&this.campaignId?this.router.navigate(["campaigns/"+this.campaignId+"/missions/"+this.missionId+"/"+t.id],{queryParamsHandling:"merge"}):this.hasLobby()&&this.lobbyService.lobbyGetId()?this.router.navigate(["multiplayer/lobby/"+this.lobbyService.lobbyGetId()+"/"+t.id],{queryParamsHandling:"merge"}):this.router.navigate([this.activatedRoute.data.value.parent+"/"+t.id],{queryParamsHandling:"merge"})}lockBattalion(t){Il(`${this.api}&cmd=playerCampaignSetCommanderAsLocked&owner=${this.campaign.progress.player}&commanderTemplate=${t}&campaign=${this.campaign.id}&locked=1`).then(e=>{this.campaign=this.cache.getCampaign(this.campaignId),console.log(this.campaign),this.fetchCommanders(),this.lockedCommanders||(this.lockedCommanders={}),this.lockedCommanders[t]={},this.lockedCommanders[t].locked=1})}hasFlag(t){return this.cache.hasFlag(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(xn),o.Nb(nd),o.Nb(Ys),o.Nb(Bl),o.Nb(Yd))},t.\u0275cmp=o.Hb({type:t,selectors:[["commanders-list"]],hostVars:1,hostBindings:function(t,e){2&t&&o.Cb("has-mission",e.missionId)},inputs:{static:"static",ignoreClosed:"ignoreClosed",commanderId:"commanderId",missionId:"missionId",tag:"tag"},outputs:{onCommanderSelect:"onCommanderSelect"},features:[o.Ab([nd,Bl,Yd]),o.zb],decls:2,vars:2,consts:[[3,"fade",4,"ngIf"],["class","alert simple",4,"ngIf"],[3,"fade"],["scrollable",""],[1,"commanders-list-wrapper"],["class","clear commanders-list",3,"single-column",4,"ngFor","ngForOf"],[1,"clear","commanders-list"],["fade-in","down",4,"ngFor","ngForOf"],["fade-in","down"],["moderatedClick","",1,"commander",3,"alertSound","tooltip-hint","click","dblclick","contextmenu"],[1,"texture-border"],["image-load","","draggable","false",3,"src"],["class","marker","data-value","!",3,"tooltip-hint",4,"ngIf"],["class","marker",4,"ngIf"],[1,"disabled-alert"],["src","assets/img/icons/svg/attention-red.svg",1,"icon"],["class","info",4,"ngIf"],["class","debug-button",4,"ngIf"],["data-value","!",1,"marker",3,"tooltip-hint"],[1,"marker"],[1,"info"],[1,"debug-button"],["tooltip-hint","Lock battalion for 1 level Only for Debug",1,"button",3,"alertSound","click"],["src","assets/img/icons/svg/bug.svg","draggable","false",1,"icon"],[1,"alert","simple"]],template:function(t,e){1&t&&(o.Jc(0,Lk,4,4,"scrollable",0),o.Jc(1,Rk,2,1,"div",1)),2&t&&(o.jc("ngIf",e.commanders.length),o.Bb(1),o.jc("ngIf",e.commandersEmpty))},encapsulation:2}),t})();const Tk=function(t){return[t]};function xk(t,e){if(1&t&&(o.Rb(0,"a",11),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.jc("routerLink",o.nc(2,Tk,null==t.commander?null:t.commander.id)),o.Bb(1),o.Nc(" ",t.L(t.commander.containsForbiddenUnits||!t.commander.available||t.commander.const?"meta.ui.button.view_regiment":"meta.ui.button.edit_regiment")," ")}}function Bk(t,e){if(1&t&&(o.Rb(0,"div",9),o.Jc(1,xk,2,4,"a",10),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf",t.isEditableRegiment(t.commander))}}function jk(t,e){if(1&t&&(o.Rb(0,"div",12),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Nc("ID: ",t.commander.available.id,"")}}function Mk(t,e){if(1&t&&(o.Rb(0,"li"),o.Rb(1,"div",14),o.Ob(2,"img",15),o.Rb(3,"small",16),o.Lc(4),o.Qb(),o.Qb(),o.Lc(5),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2);o.Bb(2),o.jc("src","assets/img/subtypes/"+t.key+".svg",o.Cc),o.Bb(1),o.kc("tooltip-hint",i.L("meta.hint.play.echelon.subclass_level")+": "+t.value),o.Bb(1),o.Mc(i.levels[t.value-1]),o.Bb(1),o.Nc(" ",i.L("meta.hint.play.echelon.subclass."+t.key).firstCapital()," ")}}function Qk(t,e){if(1&t&&(o.Rb(0,"div"),o.Rb(1,"h4"),o.Lc(2),o.Qb(),o.Rb(3,"ul"),o.Jc(4,Mk,6,4,"li",13),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(2),o.Mc(t.L("meta.ui.troops.speciality.title")),o.Bb(2),o.jc("ngForOf",t.slotsMaximums)}}function Ak(t,e){if(1&t&&(o.Rb(0,"h4"),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Mc(t.L("meta.ui.troops.details.modifiers"))}}function Dk(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).$implicit,e=o.bc(3);o.Bb(1),o.Mc(e.L("meta.hint.play.echelon.subclass."+t.key))}}function Ek(t,e){if(1&t&&(o.Rb(0,"span",24),o.Rb(1,"div",25),o.Lc(2),o.Qb(),o.Qb()),2&t){const t=o.bc(2).$implicit,e=o.bc(3);o.Bb(2),o.Nc(" ",e.L("unit."+t.unit.id+".name")," ")}}function Nk(t,e){if(1&t&&(o.Rb(0,"span",22),o.Jc(1,Dk,2,1,"span",7),o.Jc(2,Ek,3,1,"span",23),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.jc("ngIf",!t.unit),o.Bb(1),o.jc("ngIf",t.unit)}}function Fk(t,e){if(1&t&&(o.Rb(0,"li"),o.Jc(1,Nk,3,2,"span",21),o.Qb()),2&t){const t=e.$implicit;o.Fb("positive",t.value<0)("negative",t.value>0)("hidden",!t.value&&!t.unit),o.Cb("data-postfix",(t.value>0?"+":"")+t.value+"%"),o.Bb(1),o.jc("ngIf",t.value||t.unit)}}function Pk(t,e){if(1&t&&(o.Rb(0,"div",18),o.Rb(1,"p",19),o.Lc(2),o.Qb(),o.Rb(3,"ul"),o.Jc(4,Fk,2,8,"li",20),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.Bb(2),o.Mc(t.L("meta.ui.troops.details.modifier.delivery_delay.name")),o.Bb(2),o.jc("ngForOf",t.modificators)}}function Uk(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(3);o.Bb(1),o.Mc(e.L("meta.hint.play.echelon.subclass."+t.key))}}function zk(t,e){if(1&t&&(o.Rb(0,"span",24),o.Rb(1,"div",25),o.Lc(2),o.Qb(),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(3);o.Bb(2),o.Nc(" ",e.L("unit."+t.unit.id+".name")," ")}}function Jk(t,e){if(1&t&&(o.Rb(0,"li"),o.Jc(1,Uk,2,1,"span",7),o.Jc(2,zk,3,1,"span",23),o.Qb()),2&t){const t=e.$implicit;o.Fb("positive",t.value<0)("negative",t.value>0),o.Cb("data-postfix",(t.value>0?"+":"")+t.value+"%"),o.Bb(1),o.jc("ngIf",!t.unit),o.Bb(1),o.jc("ngIf",t.unit)}}function qk(t,e){if(1&t&&(o.Rb(0,"div",18),o.Rb(1,"p",19),o.Lc(2),o.Qb(),o.Rb(3,"ul"),o.Jc(4,Jk,3,7,"li",26),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.Bb(2),o.Mc(t.L("meta.ui.troops.details.modifier.battle_rank.name")),o.Bb(2),o.jc("ngForOf",t.rankModificators)}}function Vk(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,Ak,2,1,"h4",7),o.Jc(2,Pk,5,2,"div",17),o.Jc(3,qk,5,2,"div",17),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf",t.modificators&&t.modificators.length||t.rankModificators&&t.rankModificators.length),o.Bb(1),o.jc("ngIf",t.modificators&&t.modificators.length),o.Bb(1),o.jc("ngIf",t.rankModificators&&t.rankModificators.length)}}JSON;const $k={inf_basic:100,inf_ai:80,inf_heavy:120,inf_spec:60,sup:60,apc:80,tnk_light:80,tnk_med:132,tnk_heavy:200,art_point:40,art_spec:60,art:120,spg:154,tnk_hunt:154},Gk=["classic"];let Hk=(()=>{class t{constructor(t){this.cache=t,this.editButton=!0,this.modificators=[],this.rankModificators=[],this.slotsMaximums=[],this.availableTypes=[],this.availableTypesAdditional=[],this.levels=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],(new al).data.subscribe(t=>this.L=t)}ngOnChanges(){if(this.cache.devMode&&console.log("Commander details: ",this.commander),this.modificators=[],this.rankModificators=[],this.slotsMaximums=[],this.availableTypes=[],this.availableTypesAdditional=[],this.commander){if(this.commander.extra)for(let t=0;t<this.commander.extra.length;t+=2){let e=this.commander.extra[t];if(e.match(/delivery_delay/gim)){let i=e.replace(/spawn\|delivery_delay\|/gim,""),n=this.cache.getTreeUnit(i)?kl.clone(this.cache.getTreeUnit(i),{open:!0,available:!1}):null,s=parseFloat(this.commander.extra[t+1]),a=this.calculateModificatorValue(parseFloat(this.commander.extra[t+1]),n?n.subtype:i,s);0!==a&&this.modificators.push({key:i,value:a||0,rawValue:s,unit:n})}if(e.match(/battle_rank/gim)){let i=parseFloat(this.commander.extra[t+1]);0!==i&&this.rankModificators.push({unit:e.match(/unit/gim)?kl.clone(this.cache.getTreeUnit(e.replace(/(battle_rank|unit|\|)/gim,"")),{open:!0,available:!1}):null,key:e.replace(/battle_rank\|subtype\|/gim,""),value:100*i-100,rawValue:parseFloat(this.commander.extra[t+1])})}}if(this.commander.slot){let t={};for(let e=0;e<this.commander.slot.length;e++){let i=this.commander.slot[e];for(let n=0;n<this.commander.slot[e].subtype.length;n++){let e=i.subtype[n];e.length&&(t.hasOwnProperty(e)||(t[e]=0),t[e]<i.level&&(t[e]=i.level),this.availableTypes.indexOf(e)<0&&this.availableTypes.push(e))}}for(let e in t)this.slotsMaximums.push({key:e,value:t[e]});this.slotsMaximums.sort((t,e)=>e.value-t.value)}}}calculateModificatorValue(t,e,i){let n=$k[e];return 5*Math.round((t-n)/n*100/5)}makeFirstLetterUppercase(t){return t.charAt(0).toUpperCase()+t.slice(1)}hasFlag(t){return this.cache.hasFlag(t)}isEditableRegiment(t){let e=new RegExp(`(${Gk.join(",")})`,"gim");return!t.tags||!t.tags.join().match(e)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd))},t.\u0275cmp=o.Hb({type:t,selectors:[["commander-details"]],inputs:{commander:"commander",leftScroll:"leftScroll",editButton:"editButton"},features:[o.Ab([nd]),o.zb],decls:19,vars:18,consts:[[2,"height","100%",3,"bbox","fade","origin"],["fade-in","up","class","spaced-bottom",4,"ngIf"],["fade-in","up",1,"color-white",3,"innerHTML"],["fade-in","up",1,"margin-bottom-small"],["class","spaced-bottom",4,"ngIf"],[1,"short-description"],[1,"commander-description","color-white",3,"innerHTML"],[4,"ngIf"],[3,"innerHTML"],["fade-in","up",1,"spaced-bottom"],["href","","queryParamsHandling","merge","class","button red",3,"routerLink",4,"ngIf"],["href","","queryParamsHandling","merge",1,"button","red",3,"routerLink"],[1,"spaced-bottom"],[4,"ngFor","ngForOf"],[1,"prefix","with-icon"],["alt","",1,"icon","larger","toned",3,"src"],[3,"tooltip-hint"],["class","info-group",4,"ngIf"],[1,"info-group"],[1,"collapsed-bottom"],[3,"positive","negative","hidden",4,"ngFor","ngForOf"],["class","inner",4,"ngIf"],[1,"inner"],["data-popover","",4,"ngIf"],["data-popover",""],[1,"popover"],[3,"positive","negative",4,"ngFor","ngForOf"]],template:function(t,e){1&t&&(o.Rb(0,"scrollable",0),o.Jc(1,Bk,2,1,"div",1),o.Ob(2,"h3",2),o.Rb(3,"div",3),o.Lc(4),o.Qb(),o.Jc(5,jk,2,1,"div",4),o.Rb(6,"article",5),o.Ob(7,"p",6),o.Jc(8,Qk,5,2,"div",7),o.Rb(9,"h4"),o.Lc(10),o.Qb(),o.Ob(11,"p",8),o.Rb(12,"h4"),o.Lc(13),o.Qb(),o.Ob(14,"p",8),o.Rb(15,"h4"),o.Lc(16),o.Qb(),o.Ob(17,"p",8),o.Jc(18,Vk,4,3,"div",7),o.Qb(),o.Qb()),2&t&&(o.jc("bbox",!0)("fade",!0)("origin",e.leftScroll?"left":"right"),o.Bb(1),o.jc("ngIf",e.editButton),o.Bb(1),o.jc("innerHTML",e.L("commander."+(null==e.commander?null:e.commander.id)+".name").br(),o.Ac),o.Bb(2),o.Pc(" ",e.L("meta.ui.menu.nation."+(null==e.commander?null:e.commander.army))," \xa0\xa0\xa0 ",e.L("meta.ui.commander.type."+(null==e.commander?null:e.commander.type))," \xa0\xa0\xa0 ",e.L("meta.ui.troops.speciality."+(null==e.commander?null:e.commander.speciality))," "),o.Bb(1),o.jc("ngIf",e.hasFlag("debug")&&e.commander&&e.commander.available),o.Bb(2),o.jc("innerHTML",e.L("commander."+(null==e.commander?null:e.commander.id)+".desc"),o.Ac),o.Bb(1),o.jc("ngIf",e.availableTypes&&e.availableTypes.length),o.Bb(2),o.Mc(e.L("meta.ui.troops.details.tactical")),o.Bb(1),o.jc("innerHTML",e.L("commander."+(null==e.commander?null:e.commander.id)+".tactical").br(),o.Ac),o.Bb(2),o.Mc(e.L("meta.ui.troops.details.advantage")),o.Bb(1),o.jc("innerHTML",e.L("commander."+(null==e.commander?null:e.commander.id)+".advantage").br(),o.Ac),o.Bb(2),o.Mc(e.L("meta.ui.troops.details.disadvantage")),o.Bb(1),o.jc("innerHTML",e.L("commander."+(null==e.commander?null:e.commander.id)+".disadvantage").br(),o.Ac),o.Bb(1),o.jc("ngIf",e.commander&&!e.commander.const))},directives:[Rh,ee,h_,Ks,Zt,tp],encapsulation:2}),t})();const Yk=["commandersList"];function Wk(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",29),o.Yb("click",function(){return o.zc(t),o.bc(2),o.wc(20).open()}),o.Rb(1,"span",2),o.Ob(2,"img",30),o.Ob(3,"img",31),o.Qb(),o.Rb(4,"span",32),o.Lc(5),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.jc("alertSound","ui_click_default"),o.Bb(5),o.Mc(t.L("meta.ui.mode.rules.button_text"))}}function Kk(t,e){if(1&t&&(o.Rb(0,"div",22),o.Ob(1,"h1",23),o.Rb(2,"scrollable",24,25),o.Rb(4,"article",26),o.Ob(5,"p",27),o.Qb(),o.Jc(6,Wk,6,2,"button",28),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("innerHTML",t.L("meta.ui.menu.multiplayer."+t.playMode).br().markdown(),o.Ac),o.Bb(1),o.Gc("height: 70%;"),o.jc("bbox",!0)("origin","left"),o.Bb(3),o.jc("innerHTML","pve"==t.playMode?t.L("meta.ui.mode."+t.localizationMode[t.playMode]+"_launch_pve").markdown():t.L("meta.ui.mode."+t.localizationMode[t.playMode]+"_launch").markdown(),o.Ac),o.Bb(1),o.jc("ngIf",!t.missionId)}}function Xk(t,e){if(1&t){const t=o.Sb();o.Rb(0,"difficulty-select",33),o.Yb("onChange",function(e){return o.zc(t),o.bc().setDifficulty(e)}),o.Qb()}if(2&t){const t=o.bc();o.Fb("disabled",!t.isOwner&&t.teamId),o.jc("difficulty",t.difficulty)}}function Zk(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",38),o.Rb(1,"div",39),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(2).setRequestedSize(i)}),o.Rb(2,"input",40),o.Yb("change",function(){o.zc(t);const i=e.$implicit;return o.bc(2).setRequestedSize(i)}),o.Qb(),o.Rb(3,"label",41),o.Lc(4),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Bb(1),o.Fb("disabled",i.teamId&&(t<i.playersCount||i.playersCount==i.maxRequestedSize)),o.kc("tooltip-hint",i.L("meta.hint.multiplayer.requested_size.helper")),o.Bb(1),o.jc("checked",i.selectedRequestedSize&&i.selectedRequestedSize[i.playMode]&&i.selectedRequestedSize[i.playMode].includes(t)),o.Bb(2),o.Oc("",t,"x",t,"")}}function tw(t,e){if(1&t&&(o.Rb(0,"div",34),o.Rb(1,"h5",35),o.Lc(2),o.Qb(),o.Rb(3,"div",36),o.Jc(4,Zk,5,6,"div",37),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.kc("tooltip-hint","duel"!=t.playMode&&"classic"!=t.playMode||!t.selectedRequestedSize||!t.selectedRequestedSize[t.playMode]||t.selectedRequestedSize[t.playMode].length?"":t.L("meta.hint.multiplayer.requested_size.play_blocked")),o.Bb(1),o.Mc(t.L("meta.ui.lobby.options.team_size.label")),o.Bb(2),o.jc("ngForOf",t.requestedSize[t.playMode])}}function ew(t,e){if(1&t&&(o.Rb(0,"div"),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Oc(" leaderNodeId: ",t.leaderNodeId?t.leaderNodeId:"no location"," userNodeId: ",t.userNodeId," ")}}const iw=function(t){return[t]};function nw(t,e){if(1&t){const t=o.Sb();o.Rb(0,"a",42),o.Yb("click",function(){return o.zc(t),o.bc().onPlay()}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc();o.Fb("disabled",!((t.isTraining||t.isAllTeamMembersReady()&&t.canPlay())&&t.isCommanderFilled(t.selectedCommander))),o.kc("tooltip-hint",t.L("meta.hint.play.play")),o.jc("routerLink",o.nc(6,iw,t.getMatchUrl()))("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.play.play_button")," ")}}function sw(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",43),o.Yb("click",function(){return o.zc(t),o.bc().toggleReadyToFight()}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc();o.Fb("disabled",!t.canPlay()||t.selectedCommander.conquestLocked||!t.isCommanderFilled(t.selectedCommander)||t.userNodeId!==t.leaderNodeId)("disabled-fully",t.readyToFightDisabled)("progress",t.readyToFight)("large",t.teamId&&!t.isOwner),o.kc("tooltip-hint",t.L(t.readyToFight?"meta.hint.play.not_ready":"meta.hint.play.ready")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L(t.readyToFight?"meta.ui.play.waiting_button":"meta.ui.play.ready_button")," ")}}function aw(t,e){if(1&t&&(o.Rb(0,"h3",44),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.L("meta.ui.play.battalions"))}}function rw(t,e){if(1&t&&o.Ob(0,"select-army",45),2&t){const t=o.bc();o.jc("commanders",null==t.commandersList?null:t.commandersList.commanders)}}function ow(t,e){if(1&t&&o.Ob(0,"commanders-list",46,47),2&t){const t=o.bc();o.jc("tag",t.playMode)}}function cw(t,e){if(1&t&&(o.Rb(0,"div",48),o.Rb(1,"h1",49),o.Rb(2,"span"),o.Lc(3),o.Qb(),o.Qb(),o.Rb(4,"scrollable",50),o.Ob(5,"article",51),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(3),o.Mc(t.L("meta.mission."+t.missionId+".name")),o.Bb(1),o.jc("fade",!0)("bbox",!0)("origin","left"),o.Bb(1),o.jc("innerHTML",t.L("meta.mission."+t.missionId+".desc").br(),o.Ac)}}function lw(t,e){if(1&t&&o.Ob(0,"rewards",57,58),2&t){const t=o.bc(2);o.jc("rewards",t.missionTask.reward)("appearance","full")("campaignId",t.campaignId)}}function uw(t,e){if(1&t&&(o.Rb(0,"div",52),o.Rb(1,"scrollable",53),o.Rb(2,"h3",54),o.Lc(3),o.Qb(),o.Ob(4,"commanders-list",55,47),o.Jc(6,lw,2,3,"rewards",56),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("fade",!0)("bbox",!0),o.Bb(2),o.Mc(t.L("meta.ui.play.battalions")),o.Bb(1),o.jc("missionId",t.missionId)("static",!0),o.Bb(2),o.jc("ngIf",t.missionTask&&t.missionTask.reward)}}function dw(t,e){if(1&t&&o.Ob(0,"commander-details",59),2&t){const t=o.bc();o.jc("commander",t.selectedCommander)}}const hw=function(){return["/multiplayer"]},bw=(JSON,"METAGAME_REQUESTED_SIZE_"),mw={duel:[1,2,3],classic:[1,2,3]};let pw=(()=>{class t{constructor(t,e,i,n,s,a,r,o,c,l){this.cache=t,this.router=e,this.activatedRoute=i,this.sanitizer=n,this.matchMaking=s,this.notificatorService=a,this.tasksService=r,this.lobbyService=o,this.chatService=c,this.redirectService=l,this.levels=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],this.missionNodeId="",this.campaignCurrency="",this.isTraining=!1,this.campaign=null,this.campaignId="",this.mission=null,this.missionId="",this.missionTask=null,this.selectedCommander=null,this.selectedCommanderTask="",this.showBarrack=!1,this.showDifficulty=!1,this.commandersCollapsed=!1,this.difficulty=2,this.difficulties=[0,1,2,3,4],this.difficultiesString=[],this.readyToFightDisabled=!1,this.readyToFight=!1,this.teamId="",this.isOwner=!1,this.team=null,this.userGold=0,this.userSilver=0,this.userExpo=0,this._disabledDefaultState={coop:!1,ai:!1,training:!1,difficulty:!1},this.openingCommanderProgress=!1,this.globalEvent=new uu,this.counters={},this.discount=null,this.discountTask=null,this.discountTaskProgress=null,this.commanderProgress=null,this.playMode="",this.localizationMode={pvp:"groundcontrol",pve:"groundcontrol",duel:"groundcontrol_duel",classic:"groundcontrol_manpower"},this.requestedSize=mw,this.selectedRequestedSize=null,this.playersCount=1,this.maxRequestedSize=0,this.minRequestedSize=1,this.userNodeId="",this.leaderNodeId="",(new al).data.subscribe(t=>this.L=t),(new dl).data.subscribe(t=>this.I=t),this.commandersCollapsed=this.cache.isCommandersCollapsed,this.disabled=this._disabledDefaultState,this.matchMaking.insertGameSparks(nd.gameSparks),this.difficultiesString=this.cache.getDifficultiesString(),this.counters=this.cache.getCounters(),this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>{this.counters[t.path]=t.value}),this.playerLevel=this.cache.getUserLevel(),this.activatedRouteSubscription=this.activatedRoute.paramMap.subscribe(t=>{if(this.missionId=t.params.missionId,this.campaignId=t.params.campaignId,this.missionNodeId=this.getNodeId(),this.userNodeId=this.missionNodeId,this.campaign=this.cache.getCampaign(this.campaignId),this.mission=this.cache.getMission(this.missionId),this.missionTask=this.mission&&this.mission.task?this.mission.task:null,this.campaign&&this.campaign.category&&"conquest"===this.campaign.category){let t=this.missionId?["/campaigns/"+this.campaignId+"/detail/missions"]:["/multiplayer"];this.campaign.progress||this.cache.redirect(t);let e=this.campaign.progress.node[this.userNodeId];e&&e.open||this.cache.redirect(t)}}),this.campaignId&&this.cache.getCampaign(this.campaignId)&&(this.campaignCurrency=this.cache.getCampaign(this.campaignId).currency),console.log(this.L("meta.rules.meta.ui.mode."+this.localizationMode.pvp+".rules"))}ngOnInit(){if(this.isTraining=this.activatedRoute.data.value.training||!1,this.parentRoute=this.activatedRoute.data.value.parent,this.showDifficulty=this.activatedRoute.data.value.showDifficulty,this.lobbyService.hasLobby()&&"troops"!==this.parentRoute)return Object(Pc.a)("Redirecting from PVP/PVR to lobby ..."+this.lobbyService.lobbyGetId()),void this.cache.redirect(["play","lobby",this.lobbyService.lobbyGetId()]);if(this.playMode=this.parentRoute.split("/")[1],this.cache.userGold.subscribe(t=>this.userGold=t),this.cache.userSilver.subscribe(t=>this.userSilver=t),this.cache.userFreeXp.subscribe(t=>this.userExpo=t),this.setMode("ai"),this.missionId){if(this.commandersCollapsed=!1,this.missionId.match(/polygon/gim))Object(Pc.a)("fallback",`mission "${this.missionId}" is a polygon. Changing to medium`),this.cache.setDifficulty(2);else if(!hu.hasTag("difficulty")){let t=this.cache.getDifficulty();Object(Pc.a)("fallback",`mission "${this.missionId}" has no difficulty tag. Changing to "${this.difficultiesString[t]}"`),this.cache.setDifficulty(t)}this.updateDifficultyBlock()}else"multiplayer/pvp"===this.parentRoute?this.cache.setDifficulty(this.difficulties.last()):this.cache.getUserTeamId()||this.cache.setDifficulty(2);this.router.events.subscribe(t=>{t instanceof Li&&(this.commandersCollapsed=!1)}),this.globalEvent.subject.pipe(We(t=>null!==t)).subscribe(t=>{t&&t.key&&t.key.match(/slot/gim)&&setTimeout(()=>{this.commanderProgress=null,this.commanderProgress=this.cache.getCommanderProgress(this.commanderId)},100)}),this.readyToFightSubscription=this.cache.readyForTeamFight.subscribe(t=>{this.readyToFight=t}),this.commanderIdSubscribtion=this.cache.commanderId.subscribe(t=>{this.commanderId=t,this.selectedCommander=null,this.discountTask=null,this.discountTaskProgress=null,this.discount=null,this.commanderProgress=null,wu(()=>{this.selectedCommander=this.cache.getCommander(this.commanderId),this.selectedCommander&&this.selectedCommander._id&&(this.selectedCommander.conquestLocked=this.checkIfConquestLocked(this.commanderId),this.selectedCommanderTask=this.L("meta.task."+this.I(this.selectedCommander.id)+".short"),this.selectedCommander.conquestNotInNode=this.checkIfInOtherNodeOrReserve(this.commanderId)),this.selectedCommander&&(this.commanderProgress=this.cache.getCommanderProgress(this.commanderId),this.discountTask=this.tasksService.getTaskForCommanderDiscount(this.commanderId),this.discountTaskProgress=this.tasksService.getTaskProgress(this.discountTask?this.discountTask.id:null),this.discount=this.tasksService.getTaskSequencePrice(this.discountTask?this.discountTask.id:null,this.selectedCommander))},150,"commanders_window_select_commander")}),this.showBarrackSubsciption=this.cache.showBarrack.subscribe(t=>{setTimeout(()=>{this.showBarrack=t})}),"troops"===this.parentRoute&&(this.commandersCollapsed=!1),this.playDifficultySubscription=this.cache.playDifficulty.subscribe(t=>{this.difficulty=t,this.updateDifficultyBlock()}),this.teamDataSubscription=this.chatService.teamsData.pipe(We(t=>null!==t)).subscribe(t=>{this.teamId=this.cache.getUserTeamId(),this.team=this.cache.getUserTeam(),this.isOwner=this.cache.isTeamOwner(),this.playersCount=this.setPlayersCount(),this.leaderNodeId=this.isOwner?this.userNodeId:this.getLeaderNodeId(t),this.playMode!=Vl.Classic&&this.playMode!=Vl.Duel||(this.selectedRequestedSize=this.setInitialRequestedSize())}),"multiplayer/pvp"===this.parentRoute?this.cache.setCounter("ui.mark.play.pvp.menu",0):"multiplayer/pve"===this.parentRoute?this.cache.setCounter("ui.mark.play.pve.menu",0):"troops"===this.parentRoute&&this.cache.setCounter("ui.mark.troops.menu",0),this.cache.isTraining||(this.allow("play.pve.single")?this.allow("play.pve.coop")||(this.setMode("ai"),Object(Pc.a)("[>] Coop mode is not allowed, setting SINGLE")):(this.setMode("coop"),Object(Pc.a)("[>] Single mode is not allowed, setting COOP")))}ngAfterContentInit(){!this.teamId&&this.cache.getUserTeamId()&&(this.teamId=this.cache.getUserTeamId(),this.team=this.cache.getUserTeam(),this.playersCount=this.setPlayersCount(),this.isOwner=this.cache.isTeamOwner(),this.leaderNodeId=this.isOwner?this.userNodeId:this.getLeaderNodeId(this.team)),this.teamId||this.cache.getUserTeamId()||(this.leaderNodeId=this.userNodeId),this.playMode!=Vl.Classic&&this.playMode!=Vl.Duel||(this.selectedRequestedSize=this.setInitialRequestedSize())}ngOnDestroy(){this.readyToFight&&this.cache.setReadyToFight(!1),this.commanderIdSubscribtion&&this.commanderIdSubscribtion.unsubscribe(),this.purchaseUnitSubscription&&this.purchaseUnitSubscription.unsubscribe(),this.purchaseUnitToSlotSubscription&&this.purchaseUnitToSlotSubscription.unsubscribe(),this.showBarrackSubsciption&&this.showBarrackSubsciption.unsubscribe(),this.playModeSubscription&&this.playModeSubscription.unsubscribe(),this.playDifficultySubscription&&this.playDifficultySubscription.unsubscribe(),this.readyToFightSubscription&&this.readyToFightSubscription.unsubscribe(),this.teamIdSubscription&&this.teamIdSubscription.unsubscribe(),this.isOwnerSubscription&&this.isOwnerSubscription.unsubscribe(),this.teamDataSubscription&&this.teamDataSubscription.unsubscribe(),this.commandersSubscribtion&&this.commandersSubscribtion.unsubscribe(),this.cache.getSelectedCommanderForArmy(this.cache.getCurrentArmy()),this.activatedRouteSubscription&&this.activatedRouteSubscription.unsubscribe(),this.isOwner&&(this.redirectService.removeCampaignNode(),this.redirectService.removeMultiplayer())}isCommanderAvailableToBuy(t){return this.cache.isCommanderAvailableToBuy(t)}isCommanderFilled(t){return this.cache.isCommanderFilled(t)}getRouterLink(t){return this.router.parseUrl(this.router.url).root.children.primary.segments.map(t=>t.path),`/${(location.href.match(/campaigns(.*?)\/troops/gim)?`multiplayer/campaigns/${this.campaignId}/troops/`:"")||`${this.activatedRoute.data.value.parent}${this.campaignId?"/"+this.campaignId+"/missions/":""}${this.missionId?"/"+this.missionId:""}`}/${this.commanderId}${"/"+t}`}isTabActive(t){return"main"===t?!this.isTabActive("info")&&!this.isTabActive("echelons"):!!this.router.url.match(new RegExp("/(.*?)/"+t,"gim"))}purchaseUnits(t){t?this.cache.purchaseUnitsToBarrack(t.id):(this.cache.dismissPurchaseUnitsToBarrack(),this.cache.dismissPurchaseUnitsToSlot())}buyUnit(){if(this.purchasingUnit.premium){let t=this.purchasingUnit.pay||1;this.cache.openConfirmModal({key:"meta.hint.store.purchase_accept_message",confirm:"meta.ui.button_accept",decline:"meta.ui.button_decline",title:"meta.ui.store.confirmation"},()=>{this.processUnitPurchase()},{item:(t>1?`x${t} `:"")+this.L("unit."+this.purchasingUnit.id+".short"),cost:(this.purchaseUnitPrice.price*t).cat()})}else this.processUnitPurchase(),this.campaignId&&this.computeCampaignCurrency(this.purchasingUnit.silverCost*this.purchasingUnit.pay)}processUnitPurchase(){this.cache.startLoadingProgress("purchaseUnit"),this.cache.buyUnit(this.purchasingUnit,this.purchasingSlot,this.campaignId).subscribe(t=>{setTimeout(()=>{this.cache.stopLoadingProgress("purchaseUnit")},500)},t=>{this.cache.stopLoadingProgress("purchaseUnit")})}isSlot(t){return!!t&&"amountUnit"in t}isUnit(t){return!!t&&"image"in t}processPurchaseModal(t,e){this.purchasingSlot=e,t?(this.purchasingUnit=kl.clone(t,{pay:1,mode:gl.Exchanger}),this.purchaseUnitPrice=this.cache.getStoreItemPrice(this.purchasingUnit.id)):this.purchasingUnit&&setTimeout(()=>{this.purchasingUnit=null,this.purchasingSlot=null},500)}goToCommanders(){const t=this.router.parseUrl(this.router.url).root.children.primary.segments.map(t=>t.path);let e="",i=!0;t.map(t=>{"echelons"!==t&&"info"!==t?e+="/"+t:i=!1}),i?(this.commandersCollapsed=!this.commandersCollapsed,this.cache.isCommandersCollapsed=!0):this.router.navigate([e],{queryParamsHandling:"merge"})}openCommander(t){this.cache.openConfirmModal({key:this.selectedCommander.gold_cost?"meta.hint.store.purchase_accept_message":"meta.hint.store.purchase_accept_message_silver",confirm:"meta.ui.button_accept",decline:"meta.ui.button_decline",title:"meta.ui.store.confirmation"},()=>{this.openingCommanderProgress=!0,this.cache.startLoadingProgress("commanderUnlock"),this.cache.openCommander(t).subscribe(e=>{this.cache.stopLoadingProgress("commanderUnlock"),this.openingCommanderProgress=!1,this.triggerGlobalEvent("troops.commander_purchase",{template:t}),function(t){let e=t.parseUrl(t.url);t.navigateByUrl("/play/pvp",{skipLocationChange:!0}).then(()=>{console.log("redirect",e),t.navigateByUrl(e)})}(this.router)})},{item:this.L("commander."+t+".name").unbr(),cost:this.getCommanderCost(this.selectedCommander,this.discount).cat()})}getDifficultyLabel(t){return this.L("meta.ui.play.difficulty_level."+(void 0!==t?t:this.difficulty))}getVersusPlayMode(){return this.L("meta.ui.play."+{"multiplayer/pvp":"versus_players","multiplayer/pve":"versus_ai","multiplayer/missions":"missions.title","multiplayer/campaigns":"campaign.title"}[this.parentRoute])}setMode(t){this.cache.setMode(t)}setDifficulty(t){this.unsetReady(),this.cache.setDifficulty(t)}updateDifficultyBlock(){this.disabled={coop:this.isCoopDisabled(),ai:this.isAiDisabled(),training:this.isTrainingDisabled(),difficulty:this.isDifficultyDisabled()}}isCoopDisabled(){return!!this.mission&&!hu.hasModificator(this.mission,"online")}isAiDisabled(){return this.mission?!hu.hasModificator(this.mission,"solo"):"multiplayer/pvp"===this.parentRoute}isTrainingDisabled(){return"multiplayer/pvp"===this.parentRoute||!!this.missionId}isDifficultyDisabled(){return!!this.mission&&!hu.hasModificator(this.mission,"difficulty")}canPlay(){return this.selectedCommander&&(this.selectedCommander.available||this.selectedCommander.const)&&!this.selectedCommander.conquestNotInNode}getMatchUrl(){return`/match/\n\t\t\t${this.campaignId||"null"}/\n\t\t\t${this.missionId||"null"}/\n\t\t\t${this.missionNodeId||"null"}/\n\t\t\t${this.playMode?this.playMode:"mission"}/\n\t\t\tnull/\n\t\t\t${this.difficulty}/\n\t\t\t${this.missionId&&this.selectedCommander?this.selectedCommander.id:this.cache.getActiveCommanderId()}/\n\t\t\t${"duel"==this.playMode||"classic"==this.playMode?this.selectedRequestedSize[this.playMode]:null}\n\t\t`.replace(/(\t|\s| |\r|\n)/gim,"")}onPlay(){(this.isTraining||this.isAllTeamMembersReady()||this.canPlay())&&(this.cache.setFutureRedirect(this.campaignId?"/campaigns/"+this.campaignId+"/detail/missions":this.router.url),this.triggerGlobalEvent("button.play"))}getCommanderNameWidth(){if(!this.selectedCommander)return this.sanitizer.bypassSecurityTrustStyle("width: 100%;");let t=this.L("commander."+this.selectedCommander.id+".name").length;return this.sanitizer.bypassSecurityTrustStyle(`width: ${t/1.83}em;`)}getCampaignNameWidth(){if(!this.campaignId)return this.sanitizer.bypassSecurityTrustStyle("width: 100%;");let t=this.L("meta.campaign."+this.campaignId+".name").length;return this.sanitizer.bypassSecurityTrustStyle(`width: ${t/1.83}em;`)}unsetReady(){this.cache.isReadyToFight()&&(this.cache.setReadyToFight(!1),this.cache.getUserTeamId()&&this.matchMaking.teamGameReady(this.cache.getUserTeamId(),!1).subscribe(()=>{}))}toggleReadyToFight(){if(this.readyToFightDisabled)return;if(!this.cache.getUserTeam())return;this.readyToFightDisabled=!0;let t=!this.cache.isReadyToFight();this.isOwner&&t?this.setGameOptionsAsLeader().subscribe(()=>{this.cache.setReadyToFight(!0),this.readyToFightDisabled=!1,this.redirectService.setLocation(this.missionId?{campaign:this.campaignId,node:this.missionNodeId}:{multiplayer:this.playMode})},t=>{this.readyToFightDisabled=!1,this.notificatorService.push({response:t.error,parameters:""})}):!this.isOwner&&t?this.matchMaking.teamGameSetCommander({commander:{template:this.selectedCommander.id,id:this.selectedCommander&&this.selectedCommander.available?this.selectedCommander.available.id:""},team:this.teamId,option:{map:this.missionId||""}}).subscribe(()=>{this.cache.setReadyToFight(!0),this.readyToFightDisabled=!1},t=>{this.readyToFightDisabled=!1,this.notificatorService.push({response:t.error,parameters:""})}):this.matchMaking.teamGameReady(this.teamId,!1).subscribe(()=>{this.cache.setReadyToFight(!1),this.readyToFightDisabled=!1},t=>{this.notificatorService.push({response:t.error,parameters:""}),this.readyToFightDisabled=!1})}setGameOptionsAsLeader(){let t=this.selectedCommander,e=null;this.campaign&&this.campaign.modId&&(e={mapPath:this.mission.mission.map},Object(Pc.a)(`Set team options: MOD [${this.campaign.modId}], map [${this.mission.mission.map}]`));let i="multiplayer/pvp"===this.parentRoute?Vl.Pvp:"multiplayer/pve"===this.parentRoute?Vl.Pve:"multiplayer/duel"===this.parentRoute?Vl.Duel:"multiplayer/classic"===this.parentRoute?Vl.Classic:hu.hasTag(this.mission,"tutorial")?Vl.Tutorial:Vl.Coop,n={mode:i,commander:{id:t.available?t.available.id:"",template:t.id},team:this.teamId,option:{solo:i==Vl.Coop,difficulty:this.difficultiesString[this.difficulty],map:this.missionId||"",mod:e}};return this.campaignId&&this.missionNodeId&&(n.option.campaign={template:this.campaignId,node:this.missionNodeId}),this.matchMaking.teamGameSetOptions(n)}isAllTeamMembersReady(){if(!this.teamId)return!0;if(!this.team)return!1;for(let t in this.team.members){let e=this.team.members[t];if(("leader"===e.state||"member"===e.state)&&!e.ready)return!1}return!0}difficultySelectionDisabled(){if(this.missionId){let t=this.cache.getMission(this.missionId);if(!hu.hasModificator(t,"difficulty"))return!0}else if("multiplayer/pvp"===this.parentRoute||"multiplayer/duel"===this.parentRoute)return!0;return!!(this.readyToFight||this.teamId&&!this.isOwner)}gameModeSelectionDisabled(){return!(!this.disabled.coop&&this.allow("play.pve.coop")&&"multiplayer/pvp"!==this.parentRoute&&"multiplayer/missions"!==this.parentRoute&&"multiplayer/duel"!==this.parentRoute&&!(this.readyToFight||this.teamId&&!this.isOwner))}isEnoughCurrencyToBuyUnit(t){return t.premiumGold?this.getGoldLack(t)>0:this.getSilverLack(t)>0}getSilverLack(t){return Math.max(t.silverCost*t.pay-this.getSilver(),0)}getGoldLack(t){return Math.max(t.premiumGold*t.pay-this.getGold(),0)}allow(t){return this.cache.allow(t)}hasCounter(t){return this.cache.hasCounter(t)}void(){}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}getCommanderCost(t,e){return e&&e.percent?e.newPrice:t.gold_cost?t.gold_cost:t.silver_cost}isLoadingProgressRunning(t){return this.cache.isLoadingProgressRunning(t)}isFreemimCommanderOpen(t){return this.cache.isPremium()||t.freemium}getMaximumPurchaseAmount(){return this.cache.purchaseUnitAmount||10}getNodeId(){let t="";if(this.campaignId&&this.missionId){let e=this.cache.getCampaignTree(this.campaignId),i=null;e&&(i=e.find(t=>t.id==this.missionId)),i&&(t=i._id)}return t}getSilver(){return this.campaignId?this.cache.getCampaignSilver(this.campaignId):this.userSilver}getXp(){return this.campaignId?this.cache.getCampaignFreeXp(this.campaignId):this.userExpo}getGold(){return this.userGold}computeCampaignCurrency(t){if(!t||!this.campaignId)return;let e=this.cache.getCampaignSilver(this.campaignId),i=this.cache.getCampaignFreeXp(this.campaignId);this.cache.setCampaignCurrency(this.campaignId,i,e-t)}checkIfConquestLocked(t){let e=!1,i=!!(this.campaign&&this.campaign.phase&&this.campaign.phase.length),n=this.campaign&&this.campaign.progress&&this.campaign.progress.commanderJoined?this.campaign.progress.commanderJoined:null,s=!this.campaign||!this.campaign.progress||this.campaign.progress.player==this.cache.getUserId();return e=!!(i&&!s&&n&&n&&n[t]&&n[t].locked>=1),e}checkIfInOtherNodeOrReserve(t){if(this.campaign&&this.campaign.category&&"conquest"==this.campaign.category)return!(this.campaign&&this.campaign.progress&&this.campaign.progress.player!=this.cache.getUserId()||!(this.campaign&&this.campaign.progress&&this.campaign.progress.commander&&this.campaign.progress.commander[t]&&this.campaign.progress.commander[t].nodeNext!==this.missionNodeId))}setInitialRequestedSize(){let t={};t[this.playMode]=[];let e=Math.min(...this.requestedSize[this.playMode]),i=Math.max(...this.requestedSize[this.playMode]);if(this.maxRequestedSize=i,this.minRequestedSize=e,this.playersCount>e)for(let n of this.requestedSize[this.playMode])n>=this.playersCount&&t[this.playMode].push(n);else if(this.getSavedRequestedSize()&&this.getSavedRequestedSize()[this.playMode])t=this.getSavedRequestedSize();else for(let n of this.requestedSize[this.playMode])t[this.playMode].push(n);return t}setRequestedSize(t){if(!t)return;let e=this.selectedRequestedSize[this.playMode].indexOf(t);e>=0?this.selectedRequestedSize[this.playMode].splice(e,1):this.selectedRequestedSize[this.playMode].push(t),this.saveRequestedSize()}saveRequestedSize(){let t=this.getSavedRequestedSize();t?localStorage.setItem(bw+this.cache.getUserId(),JSON.stringify(Object.assign(t,this.selectedRequestedSize))):localStorage.setItem(bw+this.cache.getUserId(),JSON.stringify(this.selectedRequestedSize))}getSavedRequestedSize(){return JSON.parse(localStorage.getItem(bw+this.cache.getUserId()))}setPlayersCount(){let t=[];if(this.team&&this.team.members)for(let e in this.team.members)this.team.members[e].state!=qd.Leader&&this.team.members[e].state!=qd.Member||t.push(e);return t.length?t.length:1}getLeaderNodeId(t){let e="";if(!t)return"";let i=t.info;return e=this.isOwner?this.userNodeId:i&&i.location&&i.location.node?i.location.node:"",e}isBackButtonDisabled(){if(!this.cache.getUserTeam()||this.isOwner)return!1;let t=this.redirectService.location;return!(!t||!t.multiplayer&&!t.node)}hasFlag(t){return this.cache.hasFlag(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Ys),o.Nb(xn),o.Nb(Er),o.Nb(Yd),o.Nb(Uc),o.Nb(Tl),o.Nb(Bl),o.Nb(Pd),o.Nb(Md))},t.\u0275cmp=o.Hb({type:t,selectors:[["commanders-window"]],viewQuery:function(t,e){if(1&t&&o.Qc(Yk,!0),2&t){let t;o.vc(t=o.Zb())&&(e.commandersList=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("faded","troops"===e.parentRoute)},features:[o.Ab([nd,Yd,Uc,Tl,Bl,Pd,Md])],decls:23,vars:27,consts:[["multiplayer-commanders-list","",1,"grid-default"],["href","","queryParamsHandling","merge","g-back","",1,"button","white",3,"routerLink","alertSound","tooltip-hint","key-duplicator","click"],[1,"icon-group"],["src","assets/img/icons/svg/back-button-icon.svg","draggable","false",1,"icon","hover-hidden"],["src","assets/img/icons/svg/back-button-icon_hover.svg","draggable","false",1,"icon","hover-visible"],["g-aside","",4,"ngIf"],[3,"difficulty","disabled","onChange",4,"ngIf"],["g-requested-size","",4,"ngIf"],["g-play-buttons","",3,"tooltip-hint"],[4,"ngIf"],["href","","queryParamsHandling","merge","class","button large margin-right","g-play","",3,"routerLink","disabled","tooltip-hint","alertSound","click",4,"ngIf"],["type","button","class","button middle","style","width: calc(var(--font-size) * 10)",3,"tooltip-hint","disabled","disabled-fully","progress","alertSound","large","click",4,"ngIf"],["g-title-center","","fade-in","down","class","color-white",4,"ngIf"],[3,"commanders",4,"ngIf"],["style","width: calc(var(--commander-width) * 3 + var(--unit-list-gutter) * 8)","fade-in","down",3,"tag",4,"ngIf"],["g-mission-description","",4,"ngIf"],["g-mission-commanders","",4,"ngIf"],[3,"commander",4,"ngIf"],[3,"id"],["rulesModal",""],[1,"body"],["fade-in","down",1,"rules-article",3,"innerHTML"],["g-aside",""],["fade-in","down",1,"spaced-bottom","to-top",3,"innerHTML"],[3,"bbox","origin"],["scrollable",""],[1,"rules-article"],["fade-in","down",1,"description",3,"innerHTML"],["class","button white",3,"alertSound","click",4,"ngIf"],[1,"button","white",3,"alertSound","click"],["src","assets/img/icons/svg/attention-light.svg","draggable","false",1,"icon","hover-hidden"],["src","assets/img/icons/svg/attention-red.svg","draggable","false",1,"icon","hover-visible"],[1,"text"],[3,"difficulty","onChange"],["g-requested-size",""],[1,"spaced-bottom",3,"tooltip-hint"],[1,"requested-size"],["class","cell",4,"ngFor","ngForOf"],[1,"cell"],[1,"input-cover","checkbox","checkbox-cover",3,"tooltip-hint","click"],["type","checkbox",3,"checked","change"],["for",""],["href","","queryParamsHandling","merge","g-play","",1,"button","large","margin-right",3,"routerLink","tooltip-hint","alertSound","click"],["type","button",1,"button","middle",2,"width","calc(var(--font-size) * 10)",3,"tooltip-hint","alertSound","click"],["g-title-center","","fade-in","down",1,"color-white"],[3,"commanders"],["fade-in","down",2,"width","calc(var(--commander-width) * 3 + var(--unit-list-gutter) * 8)",3,"tag"],["commandersList",""],["g-mission-description",""],["fade-in","up",1,"spaced-bottom"],[2,"height","64%",3,"fade","bbox","origin"],[1,"mission-description",3,"innerHTML"],["g-mission-commanders",""],[3,"fade","bbox"],[1,"spaced-bottom","rewards-title"],[3,"missionId","static"],["class","spaced-top-large",3,"rewards","appearance","campaignId",4,"ngIf"],[1,"spaced-top-large",3,"rewards","appearance","campaignId"],["rewardsComponent",""],[3,"commander"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Rb(1,"a",1),o.Yb("click",function(){return e.triggerGlobalEvent("button.navigation.back")}),o.Rb(2,"span",2),o.Ob(3,"img",3),o.Ob(4,"img",4),o.Qb(),o.Lc(5),o.Qb(),o.Jc(6,Kk,7,7,"div",5),o.Jc(7,Xk,1,3,"difficulty-select",6),o.Jc(8,tw,5,3,"div",7),o.Rb(9,"div",8),o.Jc(10,ew,2,2,"div",9),o.Jc(11,nw,2,8,"a",10),o.Jc(12,sw,2,11,"button",11),o.Qb(),o.Jc(13,aw,2,1,"h3",12),o.Jc(14,rw,1,1,"select-army",13),o.Jc(15,ow,2,1,"commanders-list",14),o.Jc(16,cw,6,5,"div",15),o.Jc(17,uw,7,6,"div",16),o.Jc(18,dw,1,1,"commander-details",17),o.Qb(),o.Rb(19,"modal",18,19),o.Rb(21,"div",20),o.Ob(22,"article",21),o.Qb(),o.Qb()),2&t&&(o.Bb(1),o.Fb("disabled",e.isBackButtonDisabled()),o.kc("tooltip-hint",e.L(e.campaign&&e.campaign.id?"meta.campaign."+e.campaign.id+".name":"meta.ui.play.back")),o.jc("routerLink",e.missionId?o.nc(24,iw,"/campaigns/"+e.campaignId+"/detail/missions"):o.mc(26,hw))("alertSound","ui_back")("key-duplicator",27),o.Bb(4),o.Nc(" ",e.L("meta.ui.play.back")," "),o.Bb(1),o.jc("ngIf",!e.missionId),o.Bb(1),o.jc("ngIf","tutorial_rus"!==e.campaignId&&"pvp"!==e.playMode&&"duel"!==e.playMode&&"classic"!==e.playMode),o.Bb(1),o.jc("ngIf",e.playMode&&("duel"==e.playMode||"classic"==e.playMode)),o.Bb(1),o.Fb("disabled-buttons",("duel"==e.playMode||"classic"==e.playMode)&&e.selectedRequestedSize&&e.selectedRequestedSize[e.playMode]&&!e.selectedRequestedSize[e.playMode].length),o.kc("tooltip-hint","duel"!=e.playMode&&"classic"!=e.playMode||!e.selectedRequestedSize||!e.selectedRequestedSize[e.playMode]||e.selectedRequestedSize[e.playMode].length?"":e.L("meta.hint.multiplayer.requested_size.play_blocked")),o.Bb(1),o.jc("ngIf",e.hasFlag("debug")&&e.userNodeId!==e.leaderNodeId&&e.teamId),o.Bb(1),o.jc("ngIf",e.isTraining||!e.teamId||e.teamId&&e.isOwner),o.Bb(1),o.jc("ngIf",e.teamId&&!e.isTraining),o.Bb(1),o.jc("ngIf",!e.missionId),o.Bb(1),o.jc("ngIf",!e.missionId),o.Bb(1),o.jc("ngIf",!e.missionId),o.Bb(1),o.jc("ngIf",e.missionId),o.Bb(1),o.jc("ngIf",e.missionId),o.Bb(1),o.jc("ngIf",e.selectedCommander),o.Bb(1),o.jc("id","rules."+e.playMode),o.Bb(3),o.jc("innerHTML",e.L("meta.ui.mode."+e.localizationMode[e.playMode]+".rules").markdown(),o.Ac))},directives:[Ks,Zv,tp,ty,ee,Qh,h_,Rh,pv,Zt,pk,Ok,ug,Hk],encapsulation:2}),t})(),gw=(()=>{class t{constructor(e,i){this.host=e,this.cdr=i,this.disabled=!1,this.id=Math.floor(999999999*Math.random()),this.attaching=!1,this.key="",this.externalData={},this.onDrop=new o.o,this.onAttach=new o.o,this.onDetach=new o.o,t.instances.push(this)}ngOnInit(){}disable(){this.disabled=!0}enable(){this.disabled=!1}ngOnDestroy(){for(let e=0;e<t.instances.length;e++)if(t.instances[e]===this)return void t.instances.splice(e,1)}drop(){this.onDrop.emit(this)}static enableAll(e){for(let i=0;i<t.instances.length;i++)t.instances[i].key!==e&&e||(t.instances[i].enable(),t.instances[i].detach())}static disableAll(e){for(let i=0;i<t.instances.length;i++)t.instances[i].key!==e&&e||t.instances[i].disable()}attach(){t.activeDroppable=this,this.attaching=!0,this.cdr.detectChanges(),this.onAttach.emit(this)}detach(){t.activeDroppable=null,this.attaching=!1,this.cdr.detectChanges(),this.onDetach.emit(this)}static traverseByKey(e,i){t.instances.filter(t=>t.key===e).map((t,e)=>{i(t,e)})}}return t.instances=[],t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m),o.Nb(o.h))},t.\u0275dir=o.Ib({type:t,selectors:[["","ngDroppable",""]],hostVars:4,hostBindings:function(t,e){2&t&&o.Fb("drop-disabled",e.disabled)("drop-attaching",e.attaching)},inputs:{key:["ngDroppable","key"],externalData:"externalData"},outputs:{onDrop:"onDrop",onAttach:"onAttach",onDetach:"onDetach"}}),t})(),fw=(()=>{class t{constructor(e){this.host=e,this.key="",this.id="",this.useBounds="",this.initializedDisabled="",this.externalData={},this.onDragStart=new o.o,this.onDrag=new o.o,this.onDragEnd=new o.o,this.onDropEnd=new o.o,this.start=new yl,this.translation=new yl,this.active=!1,this.enabled=!0,t.instances.push(this)}ngOnInit(){this.initializedDisabled&&(this.enabled=!1)}ngOnDestroy(){for(let e=0;e<t.instances.length;e++)if(t.instances[e]===this)return void t.instances.splice(e,1)}dragStart(e){if(!e||1!==e.which)return;if(e.preventDefault(),!this.enabled)return;t.draggableTarget||(t.draggableTarget=document.querySelector("#dragTarget")),t.activeDraggable=this,this.start.x=e.pageX,this.start.y=e.pageY,t.draggableTarget.innerHTML=this.host.nativeElement.outerHTML.replace(/image\-load/gim,"");let i=this.host.nativeElement.getBoundingClientRect();t.draggableTarget.style.left=i.left+"px",t.draggableTarget.style.top=i.top+"px",t.draggableTarget.style.width=i.width+"px",t.draggableTarget.style.height=i.height+"px"}drag(e){let i=new yl(e.pageX,e.pageY);if(!(this.start.distanceTo(i)/window.devicePixelRatio<10)){if(!this.active)return this.active=!0,this.onDragStart.emit(this),void t.draggable.next(this);t.draggableTarget.classList.add("active"),this.translation=i.subtract(this.start),t.draggableTarget.style.transform=`translate(${this.translation.x}px, ${this.translation.y}px)`,this.onDrag.emit(this)}}dragEnd(e){this.active=!1,t.draggableTarget.classList.remove("active"),gw.activeDroppable&&!gw.activeDroppable.disabled&&(gw.activeDroppable.drop(),this.onDropEnd.emit(this)),this.onDragEnd.emit(this),t.draggable.next(null)}enable(){this.enabled=!0}disable(){this.enabled=!1}handleDragStart(t){gw.traverseByKey(this.key,(t,e)=>{t.host.nativeElement.classList.add("drag-started")})}handleDrag(e){let i=e.start.clone().add(e.translation),n=t.draggableTarget.getBoundingClientRect(),s=(new yl(n.left+n.width/2,n.top+n.height/2),null),a=1e6;gw.activeDroppable&&gw.activeDroppable.detach(),gw.traverseByKey(this.key,(t,e)=>{if(t.disabled)return;if(t.host.nativeElement.classList.contains("faded"))return;let n=t.host.nativeElement.getBoundingClientRect();if(this.useBounds)i.x>n.left&&i.x<n.left+n.width&&i.y>n.top&&i.y<n.top+n.height&&(s=t);else{let e=new yl(n.left+n.width/2,n.top+n.height/2);e.distanceTo(i)<a&&e.distanceTo(i)<n.width&&(a=e.distanceTo(i),s=t)}}),s&&s.attach()}handleDragEnd(t){gw.enableAll(),gw.traverseByKey(this.key,(t,e)=>{t.host.nativeElement.classList.remove("drag-started")})}static traverseByKey(e,i){t.instances.filter(t=>t.key===e).map((t,e)=>{i(t,e)})}static enableByKey(e){t.traverseByKey(e,t=>{t.enable()})}static disableByKey(e){t.traverseByKey(e,t=>{t.disable()})}}return t.instances=[],t.draggable=new ke(null),t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m))},t.\u0275dir=o.Ib({type:t,selectors:[["","ngDraggable",""]],hostVars:2,hostBindings:function(t,e){1&t&&o.Yb("mousedown",function(t){return e.dragStart(t)})("onDragStart",function(t){return e.handleDragStart(t)})("onDrag",function(t){return e.handleDrag(t)})("onDragEnd",function(t){return e.handleDragEnd(t)}),2&t&&o.Fb("drag-active",e.active)},inputs:{key:["ngDraggable","key"],id:"id",useBounds:"useBounds",initializedDisabled:"initializedDisabled",externalData:"externalData",enabled:"enabled"},outputs:{onDragStart:"onDragStart",onDrag:"onDrag",onDragEnd:"onDragEnd",onDropEnd:"onDropEnd"}}),t})();function vw(t,e){if(1&t&&(o.Rb(0,"span"),o.Ob(1,"img",6),o.Rb(2,"span",7),o.Lc(3),o.Qb(),o.Lc(4," / "),o.Rb(5,"span",7),o.Lc(6),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(2),o.Fb("error",!t.echelon.isComplete()),o.kc("tooltip-hint",t.echelon.isComplete()?t.L("meta.hint.play.echelon.battle_rank_current"):t.L("meta.hint.play.echelon.low_filling")),o.Bb(1),o.Nc(" ",t.echelon.getTotalBattleRank()," "),o.Bb(2),o.kc("tooltip-hint",t.L("meta.hint.play.echelon.battle_rank_total")),o.Bb(1),o.Nc(" ",t.echelon.limit," ")}}function yw(t,e){if(1&t&&(o.Rb(0,"div",18),o.Ob(1,"span"),o.Qb()),2&t){const t=o.bc(2).$implicit,e=o.bc();o.Bb(1),o.Ic("width",e.cache.getLoadingProgress(t.id+"_slot_reset")+"%")}}function _w(t,e){if(1&t&&(o.Rb(0,"div",18),o.Ob(1,"span"),o.Qb()),2&t){const t=o.bc(2).$implicit,e=o.bc();o.Bb(1),o.Ic("width",e.cache.getLoadingProgress(t.id+"_slot_setting")+"%")}}function kw(t,e){if(1&t&&(o.Rb(0,"div",16),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).$implicit;o.Bb(1),o.Mc(t.amount*t.unit.amount.multiplier)}}function ww(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",25),o.Yb("click",function(){o.zc(t);const e=o.bc(3).$implicit;return o.bc().increaseAmount(e)}),o.Ob(1,"img",26),o.Qb()}if(2&t){const t=o.bc(3).$implicit,e=o.bc();o.kc("tooltip-hint",e.L("meta.hint.play.echelon.add")+e.getAmountLimitLeft(t)),o.jc("alertSound","ui_plus")}}function Sw(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",27),o.Yb("click",function(){o.zc(t);const e=o.bc(3).$implicit;return o.bc().decreaseAmount(e)}),o.Ob(1,"img",28),o.Qb()}if(2&t){const t=o.bc(4);o.kc("tooltip-hint",t.L("meta.hint.play.echelon.remove")),o.jc("alertSound","ui_minus")}}function Iw(t,e){if(1&t&&(o.Rb(0,"div",19),o.Jc(1,ww,2,2,"button",20),o.Jc(2,Sw,2,2,"button",21),o.Rb(3,"span",22),o.Lc(4),o.Qb(),o.Rb(5,"span",23),o.Ob(6,"img",24),o.Lc(7),o.Qb(),o.Qb()),2&t){const t=o.bc(2).$implicit,e=o.bc();o.Bb(1),o.jc("ngIf",e.editable&&e.isFreemiumUnitOpen(t.unit)),o.Bb(1),o.jc("ngIf",e.editable&&e.isFreemiumUnitOpen(t.unit)),o.Bb(2),o.Oc("",t.amount*t.unit.amount.multiplier," / ",t.unit.amount.limit*t.unit.amount.multiplier,""),o.Bb(3),o.Nc(" ",t.getTotalBattleRank(),"")}}function Cw(t,e){1&t&&o.Ob(0,"span",29)}document.addEventListener("mousemove",function(t){fw.activeDraggable&&fw.activeDraggable.drag(t)}),document.addEventListener("mouseup",function(t){fw.activeDraggable&&(fw.activeDraggable.active&&fw.activeDraggable.dragEnd(t),fw.activeDraggable.translation=new yl,fw.activeDraggable=null,fw.draggableTarget.innerHTML="",fw.draggableTarget.style.transform="translate(0, 0)",fw.draggableTarget.style.left="-1000px",fw.draggableTarget.style.top="-1000px",fw.draggableTarget.style.width="0px",fw.draggableTarget.style.height="0px")});const Lw=function(t){return{slot:t}};function Rw(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",10),o.Yb("onDrop",function(e){return o.zc(t),o.bc(2).onDrop(e)})("click",function(e){o.zc(t);const i=o.bc().$implicit,n=o.bc();return n.setSlot(i,!1,e),n.setSelectedUnit(i)})("contextmenu",function(e){o.zc(t);const i=o.bc().$implicit,n=o.bc();return n.resetSlot(i,e),n.setSlot(i,!1,e)}),o.Jc(1,yw,2,2,"div",11),o.Jc(2,_w,2,2,"div",11),o.Ob(3,"unit",12,13),o.Jc(5,kw,2,1,"div",14),o.Jc(6,Iw,8,5,"div",15),o.Rb(7,"span",16),o.Lc(8),o.Qb(),o.Jc(9,Cw,1,0,"span",17),o.Qb()}if(2&t){const t=o.bc().$implicit,e=o.bc();o.Fb("faded",t.faded)("active",t.id===e.slotId),o.jc("externalData",o.nc(23,Lw,t))("alertSound","ui_click_default"),o.Cb("data-wrap",t.id)("slot-id",t.id),o.Bb(1),o.jc("ngIf",e.cache.isLoadingProgressRunning(t.id+"_slot_reset")),o.Bb(1),o.jc("ngIf",e.cache.isLoadingProgressRunning(t.id+"_slot_setting")),o.Bb(1),o.Fb("progress",e.cache.isLoadingProgressRunning(t.id+"_slot_reset")),o.jc("data",t.unit)("state",!t.unit.open||t.unit.disabled?"grayscaled":"")("animated",t.id===e.slotId&&"troops"===e.parentRoute)("enabled",t.unit.open&&t.parent.commander.available)("externalData",o.nc(25,Lw,t))("useBounds",!0)("alertSound","ui_click_default"),o.Bb(2),o.jc("ngIf",t.amount),o.Bb(1),o.jc("ngIf",e.editable),o.Bb(2),o.Mc(t.amount*t.unit.amount.multiplier),o.Bb(1),o.jc("ngIf",e.hasCounter("ui.mark.troops.slot_"+t.id))}}function Ow(t,e){if(1&t&&(o.Rb(0,"div",18),o.Ob(1,"span"),o.Qb()),2&t){const t=o.bc(2).$implicit,e=o.bc();o.Bb(1),o.Ic("width",e.cache.getLoadingProgress(t.id+"_slot_creating")+"%")}}function Tw(t,e){if(1&t&&(o.Rb(0,"li",36),o.Ob(1,"img",37),o.Qb()),2&t){const t=e.$implicit,i=o.bc(3);o.kc("tooltip-hint",i.L("meta.hint.play.echelon.subclass."+t)),o.Bb(1),o.jc("src","assets/img/subtypes/"+t+".svg",o.Cc)}}function xw(t,e){1&t&&o.Ob(0,"span",29)}function Bw(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",30),o.Yb("onDrop",function(e){return o.zc(t),o.bc(2).onDrop(e)}),o.Rb(1,"div",31),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit,i=o.bc();return i.setSlot(e),i.setSelectedUnit(e)}),o.Jc(2,Ow,2,2,"div",11),o.Rb(3,"div",32),o.Rb(4,"ul",33),o.Jc(5,Tw,2,2,"li",34),o.Qb(),o.Qb(),o.Rb(6,"div",35),o.Lc(7),o.Qb(),o.Rb(8,"span"),o.Lc(9),o.Qb(),o.Qb(),o.Jc(10,xw,1,0,"span",17),o.Qb()}if(2&t){const t=o.bc(),e=t.$implicit,i=t.index,n=o.bc();o.Fb("faded",e.faded),o.jc("externalData",o.nc(14,Lw,e)),o.Cb("slot-id",e.id),o.Bb(1),o.Fb("active",e.id===n.slotId&&n.editable),o.jc("alertSound","ui_click_default"),o.Bb(1),o.jc("ngIf",n.cache.isLoadingProgressRunning(e.id+"_slot_creating")),o.Bb(3),o.jc("ngForOf",e.subtype),o.Bb(1),o.kc("tooltip-hint",n.L("meta.hint.play.slot.level")),o.Bb(1),o.Nc(" ",e.levelRoman," "),o.Bb(2),o.Oc("",n.L("meta.ui.play.squad")," ",i+1,""),o.Bb(1),o.jc("ngIf",n.hasCounter("ui.mark.troops.slot_"+e.id))}}function jw(t,e){if(1&t&&(o.Rb(0,"li"),o.Jc(1,Rw,10,27,"div",8),o.Jc(2,Bw,11,16,"div",9),o.Qb()),2&t){const t=e.$implicit,i=o.bc();o.Bb(1),o.jc("ngIf",t.unit&&!t.goingToBeEmpty&&(i.echelon.commander.available||i.echelon.commander.const)||!i.echelon.commander.available&&t.id!==i.slotId),o.Bb(1),o.jc("ngIf",!t.unit||t.goingToBeEmpty||i.echelon.commander&&!i.echelon.commander.available&&t.id===i.slotId&&!i.echelon.commander.const)}}JSON;let Mw=(()=>{class t{constructor(t,e,i,n,s,a){this.cache=t,this.router=e,this.notificatorService=i,this.activatedRoute=n,this.helpService=s,this.cdr=a,this.editable=!1,this.campaignId="",this.onSelectUnit=new o.o,this.selectedUnitId="",this.units=[],this.slotId="",this.showBattleRankOverload=!1,this.limit=400,this.globalEvent=new uu,this.counters={},this.parentRoute="",new al,al.instance.data.subscribe(t=>this.L=t),this.editable=this.activatedRoute.data.value.showBarrack}ngOnInit(){this.parentRoute=this.activatedRoute.data.value.parent,this.commanderId=this.activatedRoute.snapshot.params.commanderId,!this.echelon.commander.const&&this.echelon.commander.available||(this.editable=!1);let t=this.cache.getActiveSlot();t&&t.unit&&this.cache.alertUnit(t.unit.id,t.amount),this.slotIdSubscription=this.cache.slotId.subscribe(t=>{this.slotId=t}),this.slotSubscription=this.cache.slotPatch.pipe(We(t=>null!==t)).subscribe(t=>{if(console.log(JSON.parse(JSON.stringify(t.unit))),t&&t.echelon===this.echelon.index+1){let e=this.echelon.slots.findIndex(e=>e.id===t.id);t.parent=this.echelon,t.update(!0),this.echelon.slots.splice(e,1,t)}t&&t.unit&&this.cache.alertUnit(t.unit.id,t.amount)}),this.draggableStartSubscription=fw.draggable.subscribe(t=>{let e;t&&t.externalData.unit&&(e=t.externalData.unit),this.echelon.checkIfSuits(e),this.cdr.detectChanges()}),this.counters=this.cache.getCounters(),this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>{this.counters[t.path]=t.value}),this.echelon.commander.slot.find(t=>t.id===this.slotId)||0!==this.echelon.index||(this.setSlot(this.echelon.slots[0]),console.warn("Selected first slot as fallback"))}ngOnDestroy(){this.slotIdSubscription.unsubscribe(),this.slotSubscription&&this.slotSubscription.unsubscribe(),this.selectedUnitId="",this.onSelectUnit.emit(this.selectedUnitId),this.triggerGlobalEvent("troops.select_unit",{unitId:this.selectedUnitId,place:"echelon"}),this.cache.setSlotId("")}setSlot(t,e=!1,i){i&&i.target.closest(".calculator-panel button")||(e||t.id!==this.slotId)&&(t.unit&&this.cache.alertUnit(t.unit.id,t.amount),this.cache.setSlotId(t.id))}setSelectedUnit(t){this.selectedUnitId=t&&t.unit?t.unit.id:"",this.onSelectUnit.emit(this.selectedUnitId),this.triggerGlobalEvent("troops.select_unit",{unitId:this.selectedUnitId,place:"echelon"})}resetSlot(t,e){this.editable&&this.echelon.commander.available&&(e?(e.preventDefault(),this.setSlot(t),this.cache.startLoadingProgress(t.id+"_slot_reset"),this.cache.slotReset(t).subscribe(i=>{this.cache.stopLoadingProgress(t.id+"_slot_reset"),t.goingToBeEmpty=!0,this.animateUnitDrop(e,t.unit).subscribe(e=>{e?e.done&&t.reset():t.reset()})})):this.cache.slotReset(t).subscribe(e=>{t.reset()}))}getAmountLimitLeft(t){return t.amount<t.unit.amount.limit?`\n\t\t\t(${t.unit.amount.limit-t.amount} ${this.L("meta.ui.open_troop.amount_left")})`:""}increaseAmount(t){this.cache.devMode&&console.log(t.unit.id+": remaining: "+t.parent.getRawRemainingBattleRank()+", unit:"+t.unit.modifyRank),t.canBeIncreased()&&t.parent.getRawRemainingBattleRank()>=t.unit.modifyRank?(t.increase(),this.cache.alertSound("ui_plus")):t.unit.open&&t.amount<t.unit.amount.limit&&t.parent.getRawRemainingBattleRank()>=t.unit.modifyRank&&(t.unit.collectible?Object(Pc.a)("Warn:","no ("+t.unit.id+") units in barrack. Purchase skipped since it's collectible unit"):(Object(Pc.a)("Warn:","no ("+t.unit.id+") units in barrack. Purchase modal opening..."),t.purchase()))}decreaseAmount(t){t.canBeDecreased()&&(t.decrease(),this.cache.alertSound("ui_minus"),t.amount<=0&&this.cache.slotReset(t).subscribe(e=>{t.reset()}))}onDrop(t){let e=t.externalData.slot,i=fw.activeDraggable.externalData.unit;e&&i&&(e.unit&&e.unit.id===i.id?e.canBeIncreased()&&e.parent.getRawRemainingBattleRank()>=e.unit.modifyRank?(e.increase(),this.cache.alertSound("ui_barrack_out")):(Object(Pc.a)("Warn:",`slot ${i.id} reached it's amount`),this.notificatorService.push({textError:"meta.ui.error.echelon_amount_overflow",textErrorParameters:{max:" "+e.unit.amount.limit,unit:this.L("unit."+e.unit.id+".short")}})):e.unit&&i.modifyRank>e.parent.getRemainingBattleRank(e.id)?(Object(Pc.a)("Warn:","overflow with unit",i.modifyRank,e.parent.getRemainingBattleRank(e.id)),this.notificatorService.push({textError:"meta.ui.error.echelon_overflow",textErrorParameters:{echelon:'"'+this.L("meta.ui.play.echelon_"+(e.parent.index+1))+'"'}})):!e.unit&&i.modifyRank>e.parent.getRemainingBattleRank()?(Object(Pc.a)("Warn:","overflow without unit",i.modifyRank,e.parent.getRemainingBattleRank(e.id)),this.notificatorService.push({textError:"meta.ui.error.echelon_overflow",textErrorParameters:{echelon:'"'+this.L("meta.ui.play.echelon_"+(e.parent.index+1))+'"'}})):this.createOrSetSlot(e,i))}createOrSetSlot(t,e){if(e.barrack.available<=0&&(t.unit&&t.unit.id!==e.id||!t.unit)&&!this.cache.isUnitUnlimited(e,t.parent.commander)){t.provisionalBuy=e,this.cache.purchaseUnitsToBarrack(e.id),Object(Pc.a)("Warn:","no ("+e.id+") units in barrack. Purchase modal opening...");let i=this.cache.unitsTree.pipe(We(t=>null!==t)).subscribe(n=>{if(n.patch){let n=this.cache.getBarrackUnit(e.id,t);t.unit?n.barrack.available>0&&this.cache.slotSet(t,n,this.campaignId):this.slotCreate(t,n),i&&i.unsubscribe()}})}else t.unit?this.slotSet(t,e):this.slotCreate(t,e)}slotCreate(t,e){Object(Pc.a)("-> slotCreate() ",t.id,e.id),this.cache.startLoadingProgress(t.id+"_slot_creating"),this.cache.slotCreate(t,e,t.parent.campaignId).subscribe(i=>{Object(Pc.a)("<- slotCreate() ","success"),this.cache.stopLoadingProgress(t.id+"_slot_creating"),this.cache.alertSound("ui_barrack_out"),this.triggerGlobalEvent("troops.slot_create",{tutorial:!0,slotId:t.id,unitId:e.id})},e=>{Object(Pc.a)("<[x] Error: slotCreate() ",e),this.cache.stopLoadingProgress(t.id+"_slot_creating"),this.notificatorService.push({textError:e,textErrorParameters:{echelon:'"'+this.L("meta.ui.play.echelon_"+(t.parent.index+1))+'"'}})})}slotSet(t,e){Object(Pc.a)("-> slotSet() ",t.id,e.id),this.cache.startLoadingProgress(t.id+"_slot_setting"),this.cache.slotSet(t,e,this.campaignId).subscribe(e=>{Object(Pc.a)("<- slotSet() ","success"),this.cache.stopLoadingProgress(t.id+"_slot_setting"),this.cache.alertSound("ui_barrack_out")},e=>{Object(Pc.a)("<[x] Error: slotSet() ",e),this.cache.stopLoadingProgress(t.id+"_slot_setting"),this.notificatorService.push({textError:e,textErrorParameters:{echelon:'"'+this.L("meta.ui.play.echelon_"+(t.parent.index+1))+'"'}})})}animateUnitDrop(t,e){let i=t.target.closest("unit"),n=e?document.querySelector(`[slot-unit-id="${e.id}"]`):null;return e&&i&&n?new ud(e,200).animate(i,n):new ke(null)}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}hasCounter(t){return this.cache.hasCounter(t)}isFreemiumUnitOpen(t){return this.cache.isFreemiumUnitOpen(t)}openHelpWindow(t,e){this.helpService.openWindow(t,e)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Ys),o.Nb(Uc),o.Nb(xn),o.Nb(Kd),o.Nb(o.h))},t.\u0275cmp=o.Hb({type:t,selectors:[["echelon"]],inputs:{echelon:"echelon",editable:"editable",campaignId:"campaignId"},outputs:{onSelectUnit:"onSelectUnit"},features:[o.Ab([nd,Uc,Kd])],decls:7,vars:6,consts:[[1,"echelon-title"],[1,"title-cover",3,"tooltip-hint"],[1,"empty"],[4,"ngIf"],[1,"echelon-list"],[4,"ngFor","ngForOf"],["src","assets/img/icons/svg/br.svg",1,"icon"],[1,"counter",3,"tooltip-hint"],["class","wrapper","ngDroppable","fromBarrackToSlot",3,"externalData","faded","active","alertSound","onDrop","click","contextmenu",4,"ngIf"],["class","wrapper","ngDroppable","fromBarrackToSlot",3,"externalData","faded","onDrop",4,"ngIf"],["ngDroppable","fromBarrackToSlot",1,"wrapper",3,"externalData","alertSound","onDrop","click","contextmenu"],["class","progress-bar simple",4,"ngIf"],["ngDraggable","fromSlotToBarrack",3,"data","state","animated","enabled","externalData","useBounds","alertSound"],["unitComponent",""],["class","counter",4,"ngIf"],["class","calculator-panel",4,"ngIf"],[1,"counter"],["class","marker",4,"ngIf"],[1,"progress-bar","simple"],[1,"calculator-panel"],["plus","",3,"tooltip-hint","alertSound","click",4,"ngIf"],["minus","",3,"tooltip-hint","alertSound","click",4,"ngIf"],["counter",""],["br",""],["src","assets/img/icons/svg/br.svg","alt","",1,"icon"],["plus","",3,"tooltip-hint","alertSound","click"],["src","assets/img/icons/svg/round_plus.svg","alt","",1,"icon"],["minus","",3,"tooltip-hint","alertSound","click"],["src","assets/img/icons/svg/round_minus.svg","alt","",1,"icon"],[1,"marker"],["ngDroppable","fromBarrackToSlot",1,"wrapper",3,"externalData","onDrop"],[1,"unit-button",3,"alertSound","click"],[1,"centered"],[1,"clear","available-subtypes"],[3,"tooltip-hint",4,"ngFor","ngForOf"],[1,"slot-level","clicked",3,"tooltip-hint"],[3,"tooltip-hint"],["draggable","false",1,"icon","larger",3,"src"]],template:function(t,e){1&t&&(o.Rb(0,"h3",0),o.Rb(1,"span",1),o.Lc(2),o.Qb(),o.Ob(3,"span",2),o.Jc(4,vw,7,6,"span",3),o.Qb(),o.Rb(5,"ul",4),o.Jc(6,jw,3,2,"li",5),o.Qb()),2&t&&(o.Bb(1),o.kc("tooltip-hint",e.L("meta.hint.play.echelon.title")),o.Bb(1),o.Nc(" ",e.L("meta.ui.play.echelon_"+(e.echelon.index+1))," "),o.Bb(2),o.jc("ngIf",e.echelon.limit),o.Bb(1),o.Fb("tutorial-echelon-animated",e.counters["ui.tutorial.mark.tutorial.slot_echelon"]&&0==e.echelon.index),o.Bb(1),o.jc("ngForOf",e.echelon.slots))},directives:[tp,ee,Zt,gw,Zv,d_,fw],encapsulation:2}),t})();function Qw(t,e){if(1&t&&o.Ob(0,"echelon",4),2&t){const t=e.$implicit,i=o.bc(2);o.jc("echelon",t)("campaignId",i.campaignId)}}function Aw(t,e){if(1&t&&(o.Rb(0,"scrollable",1,2),o.Jc(2,Qw,1,2,"echelon",3),o.Qb()),2&t){const t=o.bc();o.jc("bbox",!0)("origin","left")("fade",!0),o.Bb(2),o.jc("ngForOf",t.echelons)}}JSON;let Dw=(()=>{class t{constructor(t,e,i){this.activatedRoute=t,this.cache=e,this.router=i,this.commanderId="",this.missionId="",this.campaignId="",this.slotId="",this.selectedCommander=null,this.echelons=[],this.unitMode=gl.Echelon,this.loaded=!1,new al,al.instance.data.subscribe(t=>this.L=t)}ngOnInit(){this.missionId=this.activatedRoute.snapshot.params.missionId,this.campaignId=this.activatedRoute.snapshot.params.campaignId,this.commanderId=this.activatedRoute.snapshot.params.commanderId,this.selectedCommander=this.cache.getCommander(this.commanderId),this.echelons=this.cache.getCommanderEchelons(this.commanderId,{mode:this.isCalculatorPanelEnabled()?gl.Calculator:gl.Echelon},this.campaignId),this.cache.devMode&&console.log("Echelons: ",this.echelons),setTimeout(()=>{this.loaded=!0}),this.getParentPath().match(/troops/gim)&&this.selectedCommander&&this.cache.setBarrackState(!0),this.slotIdSubscription=this.cache.slotId.subscribe(t=>{this.slotId=t,this.slotId||(this.slotId="a1"),this.setSlotFromId()})}isCalculatorPanelEnabled(){return!!this.getParentPath().match(/\/troops/gim)}getParentPath(){return(location.href.match(/campaigns(.*?)\/troops/gim)?`play/campaigns/${this.campaignId}/troops/`:"")||`${this.activatedRoute.data.value.parent}${this.campaignId?"/"+this.campaignId+"/missions/":""}${this.missionId?"/"+this.missionId+"/":""}`}setSlotFromId(){for(let t=0;t<this.echelons.length;t++){let e=this.echelons[t].getSlot(this.slotId);if(e){this.cache.setSlot(e);break}}}ngOnDestroy(){this.cache.setBarrackState(!1),this.commanderIdSubscription&&this.commanderIdSubscription.unsubscribe(),this.slotIdSubscription&&this.slotIdSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(xn),o.Nb(nd),o.Nb(Ys))},t.\u0275cmp=o.Hb({type:t,selectors:[["echelons"]],features:[o.Ab([nd])],decls:1,vars:1,consts:[["units-scroll","","fade-in","",3,"bbox","origin","fade",4,"ngIf"],["units-scroll","","fade-in","",3,"bbox","origin","fade"],["scrollable",""],[3,"echelon","campaignId",4,"ngFor","ngForOf"],[3,"echelon","campaignId"]],template:function(t,e){1&t&&o.Jc(0,Aw,3,4,"scrollable",0),2&t&&o.jc("ngIf",e.loaded)},directives:[ee,Rh,h_,Zt,Mw],encapsulation:2}),t})();function Ew(t,e){if(1&t&&o.Ob(0,"commander-details",3),2&t){const t=o.bc();o.jc("commander",t.selectedCommander)}}JSON;let Nw=(()=>{class t{constructor(t,e,i){this.activatedRoute=t,this.cache=e,this.router=i,this.commanderId="",this.missionId="",this.campaignId="",this.selectedCommander=null,new al,al.instance.data.subscribe(t=>this.L=t)}ngOnInit(){this.missionId=this.activatedRoute.snapshot.params.missionId,this.campaignId=this.activatedRoute.snapshot.params.campaignId,this.commanderIdSubscription=this.cache.commanderId.subscribe(t=>{this.commanderId=t,this.selectedCommander=null,this.cache.redirect([this.getParentPath(),t,"info"]),setTimeout(()=>{this.selectedCommander=this.cache.getCommander(this.commanderId)})})}getParentPath(){return(location.href.match(/campaigns(.*?)\/troops/gim)?`play/campaigns/${this.campaignId}/troops/`:"")||`${this.activatedRoute.data.value.parent}${this.campaignId?"/"+this.campaignId+"/missions/":""}${this.missionId?"/"+this.missionId+"/":""}`}ngOnDestroy(){this.commanderIdSubscription&&this.commanderIdSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(xn),o.Nb(nd),o.Nb(Ys))},t.\u0275cmp=o.Hb({type:t,selectors:[["commanders-info-page"]],features:[o.Ab([nd])],decls:3,vars:4,consts:[[3,"bbox","origin","fade"],["scrollable",""],[3,"commander",4,"ngIf"],[3,"commander"]],template:function(t,e){1&t&&(o.Rb(0,"scrollable",0,1),o.Jc(2,Ew,1,1,"commander-details",2),o.Qb()),2&t&&(o.jc("bbox",!0)("origin","left")("fade",!0),o.Bb(2),o.jc("ngIf",e.selectedCommander))},directives:[Rh,ee,Hk],encapsulation:2}),t})();function Fw(t,e){if(1&t&&o.Ob(0,"img",16),2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("meta.hint.play.echelon.subclass-header")+" "+t.L("meta.hint.play.echelon.subclass."+t.unit.subtype)),o.jc("src","assets/img/subtypes/"+t.unit.subtype+".svg",o.Cc)}}function Pw(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",6),o.Rb(1,"div",7),o.Rb(2,"div",8),o.Jc(3,Fw,1,2,"img",9),o.Qb(),o.Rb(4,"div",10),o.Rb(5,"div",11),o.Lc(6),o.Qb(),o.Rb(7,"div",12),o.Lc(8),o.Qb(),o.Qb(),o.Qb(),o.Rb(9,"div",13),o.Ob(10,"div",8),o.Rb(11,"div",14),o.Rb(12,"button",15),o.Yb("click",function(){return o.zc(t),o.bc().showFullSize()}),o.Lc(13),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(3),o.jc("ngIf",null==t.unit?null:t.unit.subtype),o.Bb(2),o.Fb("premium",t.unit.premium),o.Bb(1),o.Mc(t.L("unit."+(null==t.unit?null:t.unit.id)+".short")),o.Bb(1),o.Fb("premium",t.unit.premium),o.Bb(1),o.Mc(t.L("unit."+(null==t.unit?null:t.unit.id)+".type")),o.Bb(5),o.Nc(" ",t.L("meta.ui.unit.show_full_size")," ")}}JSON;const Uw=function(){return{head:!1,fullDescription:!0,counters:!1,chart:!0}};let zw=(()=>{class t{constructor(t,e,i){this.cache=t,this.activatedRoute=e,this.location=i,this.globalEvent=new uu,this.unitId="",this.campaignId="",this.unit=null,(new al).data.subscribe(t=>this.L=t)}ngOnInit(){this.unitId=this.activatedRoute.snapshot.params.unitId,this.campaignId=this.activatedRoute.snapshot.params.campaignId,console.log(this.unitId,this.campaignId),this.unit=this.cache.getTreeUnit(this.unitId,this.campaignId)||this.cache.getTreeUnit(this.unitId),console.log(this.unit),document.body.classList.add("full-size"),this.cache.alert("scene_visible:1"),this.cache.alertUnit(this.unitId,1,!0)}ngOnDestroy(){document.body.classList.remove("full-size"),this.cache.alert("scene_visible:0")}back(t){t.preventDefault(),this.location.back()}showFullSize(){this.cache.redirect(["unit",this.unitId,"full-size"])}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(xn),o.Nb(qt))},t.\u0275cmp=o.Hb({type:t,selectors:[["unit-preview"]],hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("grid-default",!0)},features:[o.Ab([nd])],decls:7,vars:11,consts:[["u-heading",""],["class","verticaly-middle",4,"ngIf"],["u-details",""],["href","javascript:void(0)","queryParamsHandling","merge",1,"button","white",3,"tooltip-hint","alertSound","click"],[2,"height","100%",3,"bbox","fade"],[3,"unit","campaignId","unitData"],[1,"verticaly-middle"],[1,"row","align-middle"],[1,"col-3"],["class","adaptive","data-tooltip-hide","","draggable","false",3,"src","tooltip-hint",4,"ngIf"],[1,"col-9"],[1,"unit-large-title"],[1,"subheader2"],[1,"row","margin-top-small"],[1,"col-6"],["type","button",1,"button","small",3,"click"],["data-tooltip-hide","","draggable","false",1,"adaptive",3,"src","tooltip-hint"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Jc(1,Pw,14,8,"div",1),o.Qb(),o.Rb(2,"div",2),o.Rb(3,"a",3),o.Yb("click",function(t){return e.back(t)}),o.Lc(4),o.Qb(),o.Rb(5,"scrollable",4),o.Ob(6,"unit-details",5),o.Qb(),o.Qb()),2&t&&(o.Bb(1),o.jc("ngIf",e.unit),o.Bb(2),o.kc("tooltip-hint",e.L("meta.ui.play.back")),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L("meta.ui.play.back")),o.Bb(1),o.Nc(" \u2190 ",e.L("meta.ui.play.back")," "),o.Bb(1),o.jc("bbox",!0)("fade",!0),o.Bb(1),o.jc("unit",e.unit)("campaignId",e.campaignId)("unitData",o.mc(10,Uw)))},directives:[ee,tp,Zv,Rh,F_],encapsulation:2}),t})(),Jw=(()=>{class t{constructor(t,e,i){this.cache=t,this.activatedRoute=e,this.location=i,this.globalEvent=new uu,this.unitId="",this.campaignId="",this.unit=null,(new al).data.subscribe(t=>this.L=t)}ngOnInit(){this.unitId=this.activatedRoute.snapshot.params.unitId,this.campaignId=this.activatedRoute.snapshot.params.campaignId,console.log(this.unitId,this.campaignId),this.unit=this.cache.getTreeUnit(this.unitId,this.campaignId)||this.cache.getTreeUnit(this.unitId),console.log(this.unit),document.body.classList.add("full-size"),this.cache.alert("scene_visible:1"),this.cache.alertUnit(this.unitId,1,!0)}ngOnDestroy(){document.body.classList.remove("full-size"),this.cache.alert("scene_visible:0")}back(t){t.preventDefault(),this.location.back()}showFullSize(){this.cache.redirect(["unit",this.unitId,"full-size"])}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(xn),o.Nb(qt))},t.\u0275cmp=o.Hb({type:t,selectors:[["unit-preview-full-size"]],hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("grid-default",!0)},features:[o.Ab([nd])],decls:6,vars:4,consts:[["g-fake-back-background",""],["href","javascript:void(0)","queryParamsHandling","merge","g-back","",1,"button","white",3,"tooltip-hint","alertSound","click"],[1,"icon-group"],["src","assets/img/icons/svg/back-button-icon.svg","draggable","false",1,"icon","hover-hidden"],["src","assets/img/icons/svg/back-button-icon_hover.svg","draggable","false",1,"icon","hover-visible"]],template:function(t,e){1&t&&(o.Rb(0,"span",0),o.Rb(1,"a",1),o.Yb("click",function(t){return e.back(t)}),o.Rb(2,"span",2),o.Ob(3,"img",3),o.Ob(4,"img",4),o.Qb(),o.Lc(5),o.Qb(),o.Qb()),2&t&&(o.Bb(1),o.kc("tooltip-hint",e.L("meta.ui.play.back")),o.jc("alertSound","ui_back"),o.Cb("data-tooltip",e.L("meta.ui.play.back")),o.Bb(4),o.Nc(" ",e.L("meta.ui.play.back")," "))},directives:[tp,Zv],encapsulation:2}),t})();function qw(t,e){if(1&t){const t=o.Sb();o.Rb(0,"unit",7),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit;return o.bc().toggleActiveUnit(e)}),o.Qb()}if(2&t){const t=o.bc().$implicit;o.jc("data",t)("alertSound","ui_click_default")}}function Vw(t,e){1&t&&o.Ob(0,"div",8)}function $w(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",9),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit;return o.bc().addToCompare(e.id)}),o.Ob(1,"img",10),o.Qb()}if(2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("meta.hint.unit_compare.add")),o.jc("alertSound","ui_click_default")}}function Gw(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",11),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit;return o.bc().removeFromCompare(e.id)}),o.Ob(1,"img",12),o.Ob(2,"img",13),o.Qb()}if(2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("meta.hint.unit_compare.remove")),o.jc("alertSound","ui_click_default")}}function Hw(t,e){if(1&t&&(o.Rb(0,"div",2),o.Jc(1,qw,1,2,"unit",3),o.Jc(2,Vw,1,0,"div",4),o.Jc(3,$w,2,2,"button",5),o.Jc(4,Gw,3,2,"button",6),o.Qb()),2&t){const t=e.$implicit,i=e.index,n=o.bc();o.Fb("active",n.activeUnit&&n.activeUnit===t),o.Bb(1),o.jc("ngIf",i>=n.visibleUnits.fromIndex&&i<n.visibleUnits.toIndex),o.Bb(1),o.jc("ngIf",i<n.visibleUnits.fromIndex),o.Bb(1),o.jc("ngIf",i>=n.visibleUnits.fromIndex&&i<n.visibleUnits.toIndex&&!n.unitCompare.contain(t.id)),o.Bb(1),o.jc("ngIf",i>=n.visibleUnits.fromIndex&&i<n.visibleUnits.toIndex&&n.unitCompare.contain(t.id))}}let Yw=5,Ww=(()=>{class t{constructor(t){this.cache=t,this.globalEvent=new uu,this.units=[],this.onToggleActiveUnit=new o.o,this.unitSize=new yl,this.visibleUnits={fromIndex:0,toIndex:4*Yw},this.gridSizeY=Yw,this._lastFromIndex=0,this._lastRowsVisible=Yw,this.activeLevel=1,this.cssVariables={nameHeight:0,gridGap:0},this.compareIds=[],(new al).data.subscribe(t=>this.L=t),this.globalEvent.subscribe(t=>{"button.clear_unit_compare_table"==t.key&&(this.compareIds=[])}),this.cache.onResize.subscribe(()=>{this._processViewport()})}ngOnChanges(t){this.gridSizeY=Math.ceil(this.units.length/4),t.units&&setTimeout(()=>{this.scrollable.setRects(),this.scrollable.update(),this.scrollable.moveUp(),this._processViewport()}),t.scrollable&&this._processViewport()}ngOnInit(){this.unitSize=this.cache.unitSize;let t=getComputedStyle(document.documentElement);this.cssVariables.nameHeight=parseInt(t.getPropertyValue("--unit-name-height")),this.cssVariables.gridGap=.625*parseInt(t.getPropertyValue("--margin")),this.scrollable.onScroll.subscribe(()=>{this._processViewport()})}_calcualteVisibleArea(){Yw=Math.floor(this.scrollable.host.getBoundingClientRect().height/this.cache.unitSize.y)}toggleActiveUnit(t){this.onToggleActiveUnit.next(t),this.activeUnit=this.activeUnit!==t?t:null}update(){this._processViewport()}_processViewport(){this._calcualteVisibleArea(),Math.clamp(this.scrollable.scroll.top/this.scrollable.scroll.maxTop,0,1);let t=4*Math.floor(this.scrollable.scroll.top/(this.unitSize.y+this.cssVariables.gridGap));t!==this._lastFromIndex||Yw!==this._lastRowsVisible?(this._lastFromIndex=t,this._lastRowsVisible=Yw,this.visibleUnits={fromIndex:t,toIndex:t+4*Yw},this.activeLevel=this.units[t]?this.units[t].level:1):this.activeLevel=this.units[t]?this.units[t].level:1}addToCompare(t){t&&!this.compareIds.includes(t)&&this.unitCompare.add(t),this.compareIds=this.unitCompare.getCompareIds()}removeFromCompare(t){this.unitCompare.remove(t)}removeFromIdsArray(t){let e=this.compareIds.indexOf(t);this.compareIds.splice(e,1)}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd))},t.\u0275cmp=o.Hb({type:t,selectors:[["unit-virtual-scroll"]],inputs:{scrollable:"scrollable",unitCompare:"unitCompare",units:"units"},outputs:{onToggleActiveUnit:"onToggleActiveUnit"},features:[o.Ab([nd]),o.zb],decls:2,vars:3,consts:[[1,"units-virtual-grid"],["class","unit-wrap",3,"active",4,"ngFor","ngForOf"],[1,"unit-wrap"],[3,"data","alertSound","click",4,"ngIf"],["class","fake",4,"ngIf"],["class","button icon-button",3,"tooltip-hint","alertSound","click",4,"ngIf"],["class","button icon-button visible",3,"tooltip-hint","alertSound","click",4,"ngIf"],[3,"data","alertSound","click"],[1,"fake"],[1,"button","icon-button",3,"tooltip-hint","alertSound","click"],["src","assets/img/icons/svg/compare_add.svg","draggable","false"],[1,"button","icon-button","visible",3,"tooltip-hint","alertSound","click"],["src","assets/img/icons/svg/compare_add_red.svg","draggable","false",1,"default"],["src","assets/img/icons/svg/compare_remove_red.svg","draggable","false",1,"hover"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Jc(1,Hw,5,6,"div",1),o.Qb()),2&t&&(o.Ic("grid-template-rows","repeat("+e.gridSizeY+", calc(var(--unit-height) + var(--unit-name-height)))"),o.Bb(1),o.jc("ngForOf",e.units))},encapsulation:2}),t})();const Kw=["unitVirtualScroll"];function Xw(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",11),o.Rb(1,"div",12),o.Rb(2,"select-menu",13),o.Yb("onChange",function(e){return o.zc(t),o.bc().onFilterChange(e)}),o.Qb(),o.Qb(),o.Rb(3,"div",12),o.Rb(4,"select-menu",13),o.Yb("onChange",function(e){return o.zc(t),o.bc().onFilterChange(e)}),o.Qb(),o.Qb(),o.Rb(5,"div",12),o.Rb(6,"select-menu",13),o.Yb("onChange",function(e){return o.zc(t),o.bc().onFilterChange(e)}),o.Qb(),o.Qb(),o.Rb(7,"div",12),o.Rb(8,"select-menu",13),o.Yb("onChange",function(e){return o.zc(t),o.bc().onFilterChange(e)}),o.Qb(),o.Qb(),o.Rb(9,"div",14),o.Rb(10,"div",15),o.Lc(11),o.Qb(),o.Rb(12,"input",16,17),o.Yb("input",function(e){return o.zc(t),o.bc().onFilterChange({selectedOptions:e.target.value,type:"name"})}),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(2),o.jc("data",t.selectMenuNation)("type","checkbox")("filterType","nation"),o.Bb(2),o.jc("data",t.selectMenuSubtype)("type","checkbox")("filterType","subtype"),o.Bb(2),o.jc("data",t.selectMenuLevel)("type","checkbox")("filterType","level"),o.Bb(2),o.jc("data",t.selectMenuSorting)("type","radio")("filterType","sorting"),o.Bb(3),o.Mc(t.L("meta.ui.lobby.custom.name")),o.Bb(1),o.Fb("filled",t.filterRequest),o.kc("placeholder",t.L("meta.ui.lobby.type_input"))}}function Zw(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Nc("(",null==t.compare?null:t.compare.ids.length,")")}}function tS(t,e){if(1&t&&(o.Rb(0,"li"),o.Rb(1,"h3",20),o.Lc(2),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2);o.Fb("active",(null==i.unitVirtualScroll?null:i.unitVirtualScroll.activeLevel)===t),o.Bb(2),o.Oc("",i.L("meta.ui.profile.preferences.level")," ",t,"")}}const eS=function(){return[1,2,3,4,5,6]};function iS(t,e){if(1&t&&(o.Rb(0,"ul",18),o.Jc(1,tS,3,4,"li",19),o.Qb()),2&t){const t=o.bc();o.Fb("desc","desc"===t.sortingLevel)("asc","asc"===t.sortingLevel),o.Bb(1),o.jc("ngForOf",o.mc(5,eS))}}function nS(t,e){if(1&t){const t=o.Sb();o.Rb(0,"unit-virtual-scroll",24,25),o.Yb("onToggleActiveUnit",function(e){return o.zc(t),o.bc(2).toggleActiveUnit(e)}),o.Qb()}if(2&t){o.bc();const t=o.wc(1),e=o.bc();o.jc("units",e.filteredUnits)("scrollable",t)("unitCompare",e.compare)}}function sS(t,e){if(1&t&&(o.Rb(0,"scrollable",21,22),o.Jc(2,nS,2,3,"unit-virtual-scroll",23),o.Qb()),2&t){const t=o.bc();o.jc("bbox",!0)("fade",!0),o.Bb(2),o.jc("ngIf",t.filteredUnits&&t.filteredUnits.length)}}function aS(t,e){if(1&t&&(o.Rb(0,"div",26),o.Ob(1,"empty",27),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("icon","search-large")("subtitle",t.L("meta.ui.units_list.no_units_title"))("desc",t.L("meta.ui.units_list.no_units_suggestion"))}}function rS(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",33),o.Yb("click",function(){o.zc(t);const e=o.bc(2);return e.addToCompare(e.activeUnit.id)}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("meta.hint.unit_compare.add")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.unit.compare_add")," ")}}function oS(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",33),o.Yb("click",function(){o.zc(t);const e=o.bc(2);return e.removeFromCompare(e.activeUnit.id)}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("meta.hint.unit_compare.remove")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.unit.compare_remove")," ")}}const cS=function(){return{head:!0,fullDescription:!1,counters:!0,chart:!1}};function lS(t,e){if(1&t&&(o.Rb(0,"div",28),o.Rb(1,"scrollable",29),o.Ob(2,"unit-details",30),o.Rb(3,"div",31),o.Jc(4,rS,2,3,"button",32),o.Jc(5,oS,2,3,"button",32),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Fb("animated",t.activeUnitAnimated),o.Bb(1),o.jc("bbox",!0)("fade",!0),o.Bb(1),o.jc("unit",t.activeUnit)("unitData",o.mc(8,cS)),o.Bb(2),o.jc("ngIf",!t.compareIds.includes(t.activeUnit.id)),o.Bb(1),o.jc("ngIf",t.compareIds.includes(t.activeUnit.id))}}let uS=(()=>{class t{constructor(t,e){this.cache=t,this.router=e,this.globalEvent=new uu,this.filter={nation:tu.All,type:iu.All,subtype:nu.All,level:-1,inProgress:this.isFeaturesAvailable()},this.filterVariants={nation:fd(tu),type:fd(iu),subtype:fd(nu),level:[-1,1,2,3,4,5,6]},this.filtersKeys={nation:vd(tu),type:vd(iu),subtype:vd(nu),level:[-1,1,2,3,4,5,6]},this.units=[],this.isLoaded=!1,this.existedLevels=[],this.activeUnitAnimated=!1,this.sortingLevel=dS.Asc,this.sortingLevelKeys=[dS.Asc,dS.Desc],this.compareIds=[],this.compare=null,this.filterResultEmpty=!1,this.filterRequest="",this.filteredUnits=[],this.selectMenuNation={root:"assets/img/flags/",ext:"png",label:"meta.ui.profile.preferences.army",showMode:Wh.Label,options:this.filtersKeys.nation.map(t=>({key:t,icon:"campaign_"+t,selected:this.filter.nation==t,flag:"all"!=t,label:"meta.ui.menu.nation."+t,type:"nation"}))},this.selectMenuSubtype={root:"assets/img/subtypes",ext:"svg",label:"meta.ui.troops.speciality.title",showMode:Wh.Icon,options:this.filtersKeys.subtype.map(t=>({key:t,icon:t,selected:this.filter.subtype==t,flag:!1,label:"meta.hint.play.echelon.subclass."+t,type:"subtype"}))},this.selectMenuLevel={root:"assets/img/icons/svg/level",ext:"svg",label:"meta.ui.profile.preferences.level",showMode:Wh.Icon,options:this.filtersKeys.level.map(t=>({key:t<0?"all":t,icon:t,selected:this.filter.level==t,flag:!1,label:t<0?"level.all":"meta.ui.unit.unit_props.level_"+t,type:"level"}))},this.selectMenuSorting={root:"assets/img/icons/svg",ext:"svg",label:"meta.ui.profile.preferences.sorting.label",showMode:Wh.Icon,options:this.sortingLevelKeys.map((t,e)=>({key:t,icon:t,selected:!(e>0),flag:!1,label:"meta.ui.profile.preferences.sorting.level_"+t,type:"sorting"}))},this.initialFilter={nation:["all"],subtype:["all"],level:["all"],inProgress:this.isFeaturesAvailable(),name:""},(new al).data.subscribe(t=>this.L=t)}ngOnInit(){this.units=this.cache.getUnits(this.filter),this.filteredUnits=this.units,this.sortByLevel(dS.Asc),this.isLoaded=!0,this.compare=Qh.unitsCompareModal,console.log(this.compare),this.globalEvent.subscribe(t=>{"button.clear_unit_compare_table"==t.key&&(this.compareIds=[])}),this.compareIds=this.compare.getCompareIds()}setFilter(t,e){this.filter[t]=this.filterVariants[t][e],this.fetchProfileData(),this.activeUnitAnimated=!1,setTimeout(()=>{this.setActiveUnit(null)},500)}fetchProfileData(){this.isLoaded=!1,this.units=this.cache.getUnits(this.filter),this.sortByLevel(dS.Asc),this.cache.devMode&&console.log(this.units),this.isLoaded=!0}sortByLevel(t){this.sortingLevel=t,t==dS.Asc?this.filteredUnits.sort((t,e)=>t.level-e.level):t==dS.Desc&&this.filteredUnits.sort((t,e)=>e.level-t.level),this.unitVirtualScroll&&this.unitVirtualScroll.update()}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}setActiveUnit(t){this.activeUnit=t}toggleActiveUnit(t){this.activeUnitAnimated=!1,this.activeUnit&&this.activeUnit.id==t.id?setTimeout(()=>{this.setActiveUnit(null)},550):(setTimeout(()=>{this.setActiveUnit(t)},50),setTimeout(()=>{this.activeUnitAnimated=!0},250))}setExistedLevels(){if(!this.filteredUnits||!this.filteredUnits.length)return;let t=[],e=[];for(let i of this.filteredUnits)i.level&&t.push(i.level);return e=t.filter((e,i)=>t.indexOf(e)===i),e}addToCompare(t){t&&!this.compareIds.includes(t)&&this.compare.add(t),this.compareIds=this.compare.getCompareIds()}removeFromCompare(t){this.compare.remove(t)}removeFromIdsArray(t){let e=this.compareIds.indexOf(t);this.compareIds.splice(e,1)}isFeaturesAvailable(){return this.cache.hasFlag("features_in_progress")}onFilterChange(t){if(!t)return;if("sorting"==t.type)return void this.sortByLevel(t.selectedOptions[0].key);let e=t.selectedOptions,i=t.type;switch(i){case"nation":case"subtype":case"level":if(this.initialFilter[i]=[],e.find(t=>t.key&&"all"==t.key))this.initialFilter[i].push("all");else for(let t of e)this.initialFilter[i].push(t.key);break;case"name":this.initialFilter[i]=e}this.filteredUnits=this.units.slice().filter(t=>!!this.initialFilter.nation.find(t=>"all"===t)||this.initialFilter.nation.find(e=>e===t.army)).filter(t=>!!this.initialFilter.subtype.find(t=>"all"===t)||this.initialFilter.subtype.find(e=>e===t.subtype)).filter(t=>!!this.initialFilter.level.find(t=>"all"===t)||this.initialFilter.level.find(e=>e===t.level)).filter(t=>this.L("unit."+t.id+".short").trim().match(new RegExp(this.initialFilter.name,"gim"))),this.existedLevels=this.setExistedLevels()?this.sortingLevel==dS.Asc?this.setExistedLevels().sort((t,e)=>t-e):this.setExistedLevels().sort((t,e)=>e-t):[]}clearFilter(){this.initialFilter={nation:["all"],subtype:["all"],level:[-1],inProgress:this.isFeaturesAvailable(),name:""}}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Ys))},t.\u0275cmp=o.Hb({type:t,selectors:[["unit-list"]],viewQuery:function(t,e){if(1&t&&o.Qc(Kw,!0),2&t){let t;o.vc(t=o.Zb())&&(e.unitVirtualScroll=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("grid-learn-list",!0)},features:[o.Ab([])],decls:12,vars:10,consts:[["class","filter-cover large-filters","g-learn-filters","",4,"ngIf"],["g-learn-compare",""],[1,"button","red",3,"alertSound","click"],[4,"ngIf"],["g-learn-units",""],[1,"unit-list-cover"],["class","clear unit-levels-title",3,"desc","asc",4,"ngIf"],["style","height: calc(100% - var(--h3-font-size)*2)",3,"bbox","fade",4,"ngIf"],["class","align-center",4,"ngIf"],["g-learn-unit-detail",""],["class","unit-details",3,"animated",4,"ngIf"],["g-learn-filters","",1,"filter-cover","large-filters"],[1,"filter-cell"],[3,"data","type","filterType","onChange"],[1,"filter-cell","labeled-group"],[1,"input-label"],["type","text","maxlength","250","id","filterInput",1,"input","small-height",3,"placeholder","input"],["input",""],[1,"clear","unit-levels-title"],[3,"active",4,"ngFor","ngForOf"],[1,"spaced-bottom"],[2,"height","calc(100% - var(--h3-font-size)*2)",3,"bbox","fade"],["listScrollable",""],[3,"units","scrollable","unitCompare","onToggleActiveUnit",4,"ngIf"],[3,"units","scrollable","unitCompare","onToggleActiveUnit"],["unitVirtualScroll",""],[1,"align-center"],[3,"icon","subtitle","desc"],[1,"unit-details"],[2,"height","100%",3,"bbox","fade"],["fade-in","",3,"unit","unitData"],[1,"spaced-top-larger"],["class","button large",3,"tooltip-hint","alertSound","click",4,"ngIf"],[1,"button","large",3,"tooltip-hint","alertSound","click"]],template:function(t,e){1&t&&(o.Jc(0,Xw,14,16,"div",0),o.Rb(1,"div",1),o.Rb(2,"button",2),o.Yb("click",function(){return e.triggerGlobalEvent("button.show_unit_compate_table")}),o.Lc(3),o.Jc(4,Zw,2,1,"span",3),o.Qb(),o.Qb(),o.Rb(5,"div",4),o.Rb(6,"div",5),o.Jc(7,iS,2,6,"ul",6),o.Jc(8,sS,3,3,"scrollable",7),o.Jc(9,aS,2,3,"div",8),o.Qb(),o.Qb(),o.Rb(10,"div",9),o.Jc(11,lS,6,9,"div",10),o.Qb()),2&t&&(o.jc("ngIf",e.isLoaded),o.Bb(2),o.Fb("disabled",!(null!=e.compare&&e.compare.ids&&null!=e.compare&&e.compare.ids.length)),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.unit.unit_compare"),""),o.Bb(1),o.jc("ngIf",(null==e.compare?null:e.compare.ids)&&(null==e.compare?null:e.compare.ids.length)),o.Bb(3),o.jc("ngIf",e.filteredUnits&&e.filteredUnits.length),o.Bb(1),o.jc("ngIf",e.filteredUnits&&e.filteredUnits.length),o.Bb(1),o.jc("ngIf",!e.filteredUnits||!e.filteredUnits.length),o.Bb(2),o.jc("ngIf",e.activeUnit))},directives:[ee,Zv,$v,Zt,Rh,Ww,rp,F_,h_,tp],encapsulation:2}),t})();var dS=function(t){return t.Asc="asc",t.Desc="desc",t}({});function hS(t,e){if(1&t&&o.Ob(0,"img",14),2&t){const t=o.bc();o.jc("src","assets/img/campaigns/"+t.campaign.id+"_preview.jpg",o.Cc)}}function bS(t,e){if(1&t&&o.Ob(0,"img",14),2&t){const t=o.bc();o.jc("src",t.campaign.image_preview,o.Cc)}}function mS(t,e){if(1&t&&(o.Rb(0,"div",15),o.Ob(1,"img",16),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("src","assets/img/flags/campaign_"+t.campaignArmy+".png",o.Cc)}}function pS(t,e){if(1&t&&(o.Rb(0,"span",17),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.L("meta.ui.menu.nation."+t.campaignArmy))}}function gS(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Oc(" ",t.L(t.campaign.nodes.length>1?"meta.ui.campaign.missions_count":"meta.ui.campaign.mission_count")," ",t.campaign.nodes.length," ")}}function fS(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Nc("mod: ",t.campaign.modId,"")}}function vS(t,e){if(1&t&&(o.Rb(0,"div",18),o.Rb(1,"div",19),o.Lc(2),o.Qb(),o.Rb(3,"div",20),o.Ob(4,"span"),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(2),o.Oc(" ",t.L("meta.ui.campaign.finished"),": ",t.progressPercent,"% "),o.Bb(2),o.Cb("style","width:"+t.progressPercent+"%",o.Bc)}}function yS(t,e){if(1&t&&(o.Rb(0,"div",24),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Mc(t.L("meta.mission."+t.lastMissionId+".name"))}}function _S(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",21),o.Rb(1,"button",22),o.Yb("click",function(e){return o.zc(t),o.bc().continuePlay(e)}),o.Lc(2),o.Qb(),o.Jc(3,yS,2,1,"div",23),o.Qb()}if(2&t){const t=o.bc();o.Bb(1),o.Fb("disabled-events",!t.progressPercent),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("conquest"==t.campaign.category&&t.campaign.progress||t.campaign.progress&&t.progressPercent?"meta.ui.campaign.continue_play":"meta.ui.campaign.button_start")," "),o.Bb(1),o.jc("ngIf",t.lastMissionId&&t.progressPercent)}}function kS(t,e){1&t&&o.Ob(0,"span",25)}JSON;let wS=(()=>{class t{constructor(t,e){this.host=t,this.cache=e,this.noHover=!1,this.oninit=new o.o,this.onSelect=new o.o,this.campaignProgress=null,this.progressPercent=0,this.math=Math,this.maskIndex=0,this.lastMissionId="",this.lastNodeId="",(new al).data.subscribe(t=>{this.L=t})}ngOnInit(){this.oninit.emit(this.host),this.campaign&&this.campaign.progress&&(this.campaignProgress=this.campaign.progress),this.campaignProgress&&this.campaignProgress.node&&this.campaign.nodes&&this.campaign.nodes.length&&(this.progressPercent=this.getProgressPercent(this.campaignProgress.node,this.campaign.nodes.length));let t=this.cache.getCurrentArmy();hu.hasTag(t,this.campaign)||(this.campaignArmy=hu.getArmy(this.campaign)),this.maskIndex=this.setMaskIndex(),this.lastMissionId=this.setLastMission()?this.setLastMission().missionId:"",this.lastNodeId=this.setLastMission()?this.setLastMission().nodeId:""}select(){this.onSelect.emit(this)}getCounter(t){return this.cache.getCounter(t)}getProgressPercent(t,e){let i=0,n=[];for(let s in t)t[s].completed&&n.push(s);return n.length&&(i=Math.round(n.length/e*100)),i}setMaskIndex(){let t=0;return t=4*Math.ceil(this.campaignIndex/4)-this.campaignIndex,t}setLastMission(){if(!this.campaign||!this.campaign.progress)return;let t="",e="";for(let i in this.campaign.progress.node)if(this.campaign.progress.node[i].open&&1==this.campaign.progress.node[i].open&&!this.campaign.progress.node[i].completed){t=this.campaign.progress.node[i].map,e=i;break}return{missionId:t,nodeId:e}}continuePlay(t){this.campaign&&(t&&t.preventDefault(),this.campaign.progress&&(this.setActiveMission(this.lastNodeId),this.cache.devMode&&console.log("Selected mission: ",this.lastMissionId),this.cache.redirect(["campaigns",this.campaign.id,"missions",this.lastMissionId])))}setActiveMission(t){t&&this.savedNodeId()}savedNodeId(){localStorage.setItem("METAGAME_SELECTED_NODE_"+this.cache.getUserId(),JSON.stringify(this.lastNodeId))}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m),o.Nb(nd))},t.\u0275cmp=o.Hb({type:t,selectors:[["campaign"]],inputs:{campaign:"campaign",campaignIndex:"campaignIndex",noHover:"noHover"},outputs:{oninit:"oninit",onSelect:"onSelect"},features:[o.Ab([nd])],decls:17,vars:13,consts:[[1,"campaign-image","image-cover"],["image-load","","class","vertical",3,"src",4,"ngIf"],["class","flag-cover",4,"ngIf"],[1,"overflow-wrapper"],[1,"title-wrapper"],[1,"campaign-title"],[1,"tags"],["class","army",4,"ngIf"],[4,"ngIf"],[1,"description-wrapper"],[1,"description",3,"innerHTML"],["class","progress",4,"ngIf"],["class","continue",4,"ngIf"],["class","marker",4,"ngIf"],["image-load","",1,"vertical",3,"src"],[1,"flag-cover"],["draggable","false",1,"flag",3,"src"],[1,"army"],[1,"progress"],[1,"progress-title"],[1,"progress-bar"],[1,"continue"],[1,"button","red",3,"alertSound","click"],["class","last-mission-title",4,"ngIf"],[1,"last-mission-title"],[1,"marker"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Jc(1,hS,1,1,"img",1),o.Jc(2,bS,1,1,"img",1),o.Qb(),o.Jc(3,mS,2,1,"div",2),o.Rb(4,"div",3),o.Rb(5,"div",4),o.Rb(6,"h2",5),o.Lc(7),o.Qb(),o.Rb(8,"div",6),o.Jc(9,pS,2,1,"span",7),o.Jc(10,gS,2,2,"span",8),o.Jc(11,fS,2,1,"span",8),o.Qb(),o.Qb(),o.Rb(12,"div",9),o.Ob(13,"div",10),o.Jc(14,vS,5,3,"div",11),o.Jc(15,_S,4,5,"div",12),o.Qb(),o.Qb(),o.Jc(16,kS,1,0,"span",13)),2&t&&(o.Db(e.maskIndex?"mask-type-"+e.maskIndex:"mask-type-0"),o.Bb(1),o.jc("ngIf",!e.campaign.image_preview),o.Bb(1),o.jc("ngIf",e.campaign.image_preview),o.Bb(1),o.jc("ngIf",e.campaignArmy),o.Bb(4),o.Mc(e.L("meta.campaign."+e.campaign.id+".name")),o.Bb(2),o.jc("ngIf",e.campaignArmy),o.Bb(1),o.jc("ngIf",e.campaign&&e.campaign.nodes&&e.campaign.nodes.length&&"conquest"!==e.campaign.category),o.Bb(1),o.jc("ngIf",e.campaign.modId),o.Bb(2),o.jc("innerHTML","conquest"!==e.campaign.category?e.L("meta.campaign."+e.campaign.id+".desc").dropWords(150).br():e.L("meta.campaign."+e.campaign.id+".desc").dropWords(220).br(),o.Ac),o.Bb(1),o.jc("ngIf",!e.noHover&&e.progressPercent&&e.campaign.progress),o.Bb(1),o.jc("ngIf",!e.noHover&&100!==e.progressPercent),o.Bb(1),o.jc("ngIf",e.getCounter("ui.mark.play.campaign."+e.campaign.id)))},encapsulation:2}),t})(),SS=(()=>{class t{transform(t,e){if(Array.isArray(t))return e?t=t.filter(t=>t.category===e):t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Mb({name:"campaignCategory",type:t,pure:!0}),t})();const IS=["slider"],CS=["scrollable"],LS=function(){return{hover:"ui_hover_side_panel",click:"ui_click_default"}};function RS(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",10),o.Rb(1,"button",11),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(2).setActiveCategory(i)}),o.Ob(2,"span",12),o.Rb(3,"span",13),o.Lc(4),o.Qb(),o.Rb(5,"span",14),o.Lc(6),o.Qb(),o.Ob(7,"img",15),o.Ob(8,"img",16),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Bb(1),o.Fb("active",i.activeCategory==t)("disabled",!i.allow("campaign."+t)&&"test"!=t&&i.hasFlag("debug")),o.jc("alertSound",o.mc(10,LS)),o.Bb(3),o.Mc(i.L("meta.ui.campaign.category.title_"+t)),o.Bb(1),o.kc("tooltip-hint",i.L("meta.ui.campaign.category.description_"+t)),o.Bb(1),o.Mc(i.L("meta.ui.campaign.category.description_"+t)),o.Bb(1),o.jc("src","assets/img/icons/buttons/campaigns_"+t+".svg",o.Cc),o.Bb(1),o.jc("src","assets/img/icons/buttons/campaigns_"+t+"_hover.svg",o.Cc)}}function OS(t,e){if(1&t&&(o.Rb(0,"ul",8),o.Jc(1,RS,9,11,"li",9),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngForOf",t.categories)}}const TS=function(){return{hover:"ui_hover_default",click:"ui_click_default"}};function xS(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",20),o.Rb(1,"campaign",21),o.Yb("click",function(){o.zc(t);const i=e.$implicit,n=o.bc(2);return n.selectCampaign(i),n.triggerGlobalEvent("play.select_campaign",{campaignId:i.id})})("contextmenu",function(i){o.zc(t);const n=e.$implicit,s=o.bc(2);return s.selectCampaign(n,i),s.triggerGlobalEvent("play.select_campaign",{campaignId:n.id})}),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=e.index,n=o.bc(2);o.Bb(1),o.Fb("active",n.counters["ui.tutorial.mark.play.campaign."+t.id]||t.id==n.savedCampaignId)("disabled",n.isCampaignDisabledByTeam(t.id)||n.buttonsLocked||!n.allow("campaign.menu")||n.userInTeam&&!n.playerIsTeamLeader&&!t.progress&&n.leaderSelectedCampaignId!==t.id)("selected",n.activeCampaign&&n.activeCampaign.id==t.id)("demo-mode-active",n.demoModeEnabled)("demo-mode",n.isCampaignDisabledByDemo(t.id)),o.jc("campaign",t)("campaignIndex",i)("alertSound",o.mc(14,TS)),o.Cb("campaign-id",t.id)}}function BS(t,e){if(1&t&&(o.Rb(0,"scrollable",17),o.Rb(1,"div",18),o.Jc(2,xS,2,15,"div",19),o.cc(3,"campaignCategory"),o.Qb(),o.Qb()),2&t){const t=o.bc();o.jc("bbox",!0),o.Bb(2),o.jc("ngForOf",o.ec(3,2,t.campaigns,"all"===t.activeCategory?"":t.activeCategory))}}function jS(t,e){if(1&t&&(o.Rb(0,"div",22),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Nc(" ",t.L("meta.ui.play.campaigns.not_available")," ")}}const MS="METAGAME_SELECTED_CAMPAIGN_";let QS=(()=>{class t{constructor(t,e,i,n,s,a){this.cache=t,this.router=e,this.notificatorService=i,this.helpService=n,this.chatService=s,this.redirectService=a,this.campaigns=[],this.modCampaigns=[],this.activeCampaign=null,this.selectedCampaign=null,this.fakes=[],this.userId="",this.globalEvent=new uu,this.counters={},this.savedCampaignId="",this.demoModeEnabled=!1,this.categories=[],this.activeCategory="",this.buttonsLocked=!1,this.playerIsTeamLeader=!1,this.userInTeam=!1,this.leaderSelectedCampaignId="",(new al).data.subscribe(t=>this.L=t),this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>{this.counters[t.path]=t.value}),this.notificatorService.notifications.subscribe(t=>{t&&t.response&&setTimeout(()=>{this.buttonsLocked=!1},250)})}ngOnInit(){this.campaigns=this.campaignGetSorted(),this.campaigns=this.campaigns.filter(t=>"tutorial_rus"!==t.id),this.modCampaigns=this.cache.getCampaignsMod(),this.userId=this.cache.getUserId(),this.userInTeam=!(!this.cache.getUserTeamId()||!this.cache.getUserTeamId().length),this.playerIsTeamLeader=this.cache.isTeamOwner(),this.cache.devMode&&console.log(this.campaigns),this.activeCampaign=this.getSavedCampaignId()?this.cache.getCampaign(this.getSavedCampaignId()):null,this.categories=this.setCampaignCategories(),this.activeCampaign&&this.activeCampaign.category&&"tutorial"!==this.activeCampaign.category?this.setActiveCategory(this.activeCampaign.category):this.categories&&this.categories.length&&this.setActiveCategory(this.categories[0]),this.ownerChangeSubscription=this.cache.ownerChange.pipe(We(t=>null!==t)).subscribe(t=>{this.leaderSelectedCampaignId=t&&t.campaignId?t.campaignId:"",this.campaigns=this.campaignGetSorted()}),this.teamDataSubscription=this.chatService.teamsData.pipe(We(t=>null!==t)).subscribe(t=>{this.userInTeam=!(!this.cache.getUserTeamId()||!this.cache.getUserTeamId().length),this.playerIsTeamLeader=this.cache.isTeamOwner()}),this.onCampaignStart=this.cache.onCampaignStart.pipe(We(t=>null!==t)).subscribe(()=>{this.campaigns=this.campaignGetSorted()});let t=this.redirectService.location;if(!this.playerIsTeamLeader&&t&&t.campaign)if(t.node)this.redirectService.redirectToCurrentLocation();else{let e=this.cache.getCampaign(t.campaign);this.selectCampaign(e)}}ngOnDestroy(){this.teamDataSubscription&&this.teamDataSubscription.unsubscribe()}setActiveCampaign(t){if(!t||this.activeCampaign&&this.activeCampaign.id===t.id)return!1;this.cache.devMode&&console.log("Active campaign: ",t),this.activeCampaign=t}selectCampaign(t,e){if(e&&e.preventDefault(),this.buttonsLocked=!0,!t||this.selectedCampaign===t)return!1;this.cache.devMode&&console.log("Selected campaign: ",t),t.modId||t.progress?(this.selectedCampaign=t,this.saveCampaignId(t.id),this.router.navigate(["campaigns/"+t.id+"/detail/missions"],{queryParamsHandling:"merge"}),this.buttonsLocked=!1):t.progress&&null!=!t.progress||this.campaignStart(t,t.id)}campaignStart(t,e){e&&(this.buttonsLocked=!0,this.cache.campaignStart(e,!1).subscribe(i=>{this.selectedCampaign=t,this.saveCampaignId(e),setTimeout(()=>{this.buttonsLocked=!1,this.router.navigate(["campaigns/"+e+"/detail/missions"],{queryParamsHandling:"merge"})},50)},t=>{this.buttonsLocked=!1}))}appendFakes(){if(!this.campaigns.length)return;this.fakes=[];let t=3-this.campaigns.length%3;if(3!==t&&0!==t)for(let e=0;e<t;e++)this.fakes.push(t)}isFeaturesAvailable(){return this.cache.hasFlag("features_in_progress")}hasFlag(t){return this.cache.hasFlag(t)}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}isCampaignDisabledByTeam(t){return!!this.cache.isTeamOwner()&&t.match(/tutorial/gim)}getSavedCampaignId(){return JSON.parse(localStorage.getItem(MS+this.userId))}saveCampaignId(t){localStorage.setItem(MS+this.userId,JSON.stringify(t))}isCampaignDisabledByDemo(t){let e=!1;if(!t)return;let i=this.campaigns.find(e=>e.id===t);return i&&i.tags&&i.tags.length&&(e=!!i.tags.find(t=>"check_demo"===t)),e}openHelpWindow(t,e){this.helpService.openWindow(t,e)}loadGame(t){t||(t=""),this.cache.alert("load_game:"+t)}setCampaignCategories(){let t=[];for(let e of this.campaigns)e&&e.category&&t.push(e.category);return[...new Set(t)]}setActiveCategory(t){this.activeCategory=t}allow(t){return this.cache.allow(t)}campaignGetSorted(){return this.cache.getCampaigns().sort((t,e)=>t.order-e.order).sort((t,e)=>t.modId?1:e.modId?-1:0)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Ys),o.Nb(Uc),o.Nb(Kd),o.Nb(Pd),o.Nb(Md))},t.\u0275cmp=o.Hb({type:t,selectors:[["campaigns-window"]],viewQuery:function(t,e){if(1&t&&(o.Qc(IS,!0),o.Qc(CS,!0)),2&t){let t;o.vc(t=o.Zb())&&(e.slider=t.first),o.vc(t=o.Zb())&&(e.scrollable=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("grid-default",!0)},features:[o.Ab([nd,Uc,Kd,Pd])],decls:11,vars:11,consts:[["heading",""],["type","button",1,"button","small",3,"tooltip-hint","alertSound","click"],["modes",""],["class","large-tabs-list clear",4,"ngIf"],["campaigns",""],[3,"bbox",4,"ngIf"],["class","alert centered","fade-in","down",4,"ngIf"],["message",""],[1,"large-tabs-list","clear"],["fade-in","down","class","list-item",4,"ngFor","ngForOf"],["fade-in","down",1,"list-item"],["type","button",1,"large-tab-button","texture-border",3,"alertSound","click"],[1,"tab-shadow"],[1,"tab-title","text-overflow"],[1,"tab-description","text-overflow",3,"tooltip-hint"],["draggable","false",1,"tab-icon","default",3,"src"],["draggable","false",1,"tab-icon","hover",3,"src"],[3,"bbox"],[1,"grid-three-part","campaign-grid"],["fade-in","down","class","",4,"ngFor","ngForOf"],["fade-in","down",1,""],[1,"tile","texture-border",3,"campaign","campaignIndex","alertSound","click","contextmenu"],["fade-in","down",1,"alert","centered"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Rb(1,"button",1),o.Yb("click",function(){return e.loadGame("")}),o.Lc(2),o.Qb(),o.Rb(3,"button",1),o.Yb("click",function(){return e.triggerGlobalEvent("statistics_list.open")}),o.Lc(4),o.Qb(),o.Qb(),o.Rb(5,"div",2),o.Jc(6,OS,2,1,"ul",3),o.Qb(),o.Rb(7,"div",4),o.Jc(8,BS,4,5,"scrollable",5),o.Jc(9,jS,2,1,"div",6),o.Qb(),o.Ob(10,"message-of-the-day",7)),2&t&&(o.Bb(1),o.kc("tooltip-hint",e.L("meta.ui.play.load_save_button")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.play.load_save_button")," "),o.Bb(1),o.Fb("disabled",!e.allow("profile.menu")),o.kc("tooltip-hint",e.L("meta.ui.profile.menu.sessions")),o.jc("alertSound","ui_back"),o.Bb(1),o.Nc(" ",e.L("meta.ui.profile.menu.sessions")," "),o.Bb(2),o.jc("ngIf",e.categories&&e.categories.length),o.Bb(2),o.jc("ngIf",e.campaigns.length),o.Bb(1),o.jc("ngIf",!e.campaigns.length))},directives:[tp,Zv,ee,Xv,Zt,h_,Rh,wS],pipes:[SS],encapsulation:2}),t})();const AS=["restartModal"];function DS(t,e){if(1&t&&(o.Rb(0,"h1",22),o.Ob(1,"span",23),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("innerHTML",t.L("meta.campaign."+t.campaignId+".name").markdown(),o.Ac)}}const ES=function(){return["/tutorial/main"]},NS=function(){return["/campaigns/"]},FS=function(t){return[t]};let PS=(()=>{class t{constructor(t,e,i,n,s,a,r){this.cache=t,this.router=e,this.activatedRoute=i,this.notificatorService=n,this.location=s,this.chatService=a,this.redirectService=r,this.tutorialCampaignId="tutorial_rus",this.campaign=null,this.campaignId=null,this.campaignProgress=null,this.globalEvent=new uu,this.counters={},this.hasTechTree=!1,this.hasTasks=!1,this.units=[],this.unitsIsLoaded=!1,this.buttonsLocked=!1,this.isConquestCampaign=!1,this.playerIsTeamLeader=!1,this.userInTeam=!1,(new al).data.subscribe(t=>this.L=t),this.counters=this.cache.getCounters(),this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>{this.counters[t.path]=t.value})}ngOnInit(){this.campaign=this.cache.getGlobalCampaign(),this.campaignId=this.campaign?this.cache.getGlobalCampaign().id:"",this.userInTeam=!(!this.cache.getUserTeamId()||!this.cache.getUserTeamId().length),this.playerIsTeamLeader=this.cache.isTeamOwner();let t=localStorage.getItem("METAGAME_LAST_TEAMCHANGE_OPTIONS");t&&(t=JSON.parse(t)),this.initializeCampaign(),this.campaignChangeSubscription=this.cache.campaignChange.pipe(We(t=>null!==t)).subscribe(()=>{this.campaign=this.cache.getGlobalCampaign()}),this.ownerChangeSubscription=this.cache.ownerChange.pipe(We(t=>null!==t)).subscribe(()=>{console.warn("Owner change update [Campaign detail]"),this.campaign=this.cache.getGlobalCampaign(),this.initializeCampaign()}),this.teamDataSubscription=this.chatService.teamsData.pipe(We(t=>null!==t)).subscribe(t=>{this.userInTeam=!(!this.cache.getUserTeamId()||!this.cache.getUserTeamId().length),this.playerIsTeamLeader=this.cache.isTeamOwner()})}ngOnDestroy(){this.teamDataSubscription&&this.teamDataSubscription.unsubscribe()}initializeCampaign(){this.isConquestCampaign=this.campaign&&this.campaign.phase&&this.campaign.phase.length,this.isConquestCampaign&&this.globalEvent.trigger("navigation.to_top"),this.cache.devMode&&console.log(this.campaign),this.campaign&&this.campaign.progress?this.campaignProgress=this.campaign.progress:this.campaign&&!this.campaign.progress&&(console.warn("no campaign progress redirecting to campaigns page"),this.cache.redirect(["campaigns"])),this.hasTasks=!!(this.campaign&&this.campaign.tasks&&this.campaign.tasks.length),this.campaign&&!this.campaign.modId&&(this.units=this.cache.getTreeUnits(this.campaignId),this.hasTechTree=!(!this.units||!this.units.length),setTimeout(()=>{this.unitsIsLoaded=!0},200)),this.campaign&&this.campaign.hash&&setTimeout(()=>{this.restartModal.open()},200)}campaignStart(){this.campaignId&&(this.buttonsLocked=!0,this.cache.campaignStart(this.campaignId,!0).subscribe(t=>{console.log(t),this.restartModal.close(),this.globalEvent.trigger("campaign.restart",{campaignId:this.campaignId}),this.buttonsLocked=!1},t=>{this.notificatorService.push({response:t,parameters:""}),this.buttonsLocked=!1}))}getTime(t){return new Date(t).parseDate("DD.MM.YYYY")}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}isBackButtonDisabled(){return this.cache.getUserTeam()&&!this.playerIsTeamLeader&&!!this.redirectService.location}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Ys),o.Nb(xn),o.Nb(Uc),o.Nb(qt),o.Nb(Pd),o.Nb(Md))},t.\u0275cmp=o.Hb({type:t,selectors:[["campaign-detail"]],viewQuery:function(t,e){if(1&t&&o.Qc(AS,!0),2&t){let t;o.vc(t=o.Zb())&&(e.restartModal=t.first)}},hostVars:4,hostBindings:function(t,e){2&t&&o.Fb("grid-default",!0)("with-map",e.isConquestCampaign)},features:[o.Ab([nd,Uc,Pd])],decls:41,vars:53,consts:[["href","","queryParamsHandling","merge","g-back","",1,"button","white",3,"routerLink","tooltip-hint","alertSound","key-duplicator","click"],[1,"icon-group"],["src","assets/img/icons/svg/back-button-icon.svg","draggable","false",1,"icon","hover-hidden"],["src","assets/img/icons/svg/back-button-icon_hover.svg","draggable","false",1,"icon","hover-visible"],["g-campaign-info",""],["fade-in","up",4,"ngIf"],["href","","queryParamsHandling","merge","routerLinkActive","active",1,"button","tab",3,"routerLink","tooltip-hint","alertSound","click"],["type","button",1,"button","tab",3,"tooltip-hint","alertSound","click"],["g-routing",""],[1,"smaller","restart-modal",3,"header","id"],["restartModal",""],[1,"body"],[1,"caption"],[1,"grid-half-part"],[1,"action-block"],[1,"top"],[1,"round-icon"],["src","assets/img/icons/svg/restart-icon.svg","image-load",""],[1,"color-primary","caption"],["type","button",1,"button","red",3,"alertSound","click"],["src","assets/img/icons/svg/play-icon.svg","image-load",""],["type","button",1,"button",3,"alertSound","click"],["fade-in","up"],[3,"innerHTML"]],template:function(t,e){if(1&t){const t=o.Sb();o.Rb(0,"a",0),o.Yb("click",function(){return e.triggerGlobalEvent("button.navigation.back"),e.triggerGlobalEvent("navigation.to_bottom")}),o.Rb(1,"span",1),o.Ob(2,"img",2),o.Ob(3,"img",3),o.Qb(),o.Lc(4),o.Qb(),o.Rb(5,"div",4),o.Jc(6,DS,2,1,"h1",5),o.Rb(7,"a",6),o.Yb("click",function(){return e.triggerGlobalEvent("button.campaign.missions")}),o.Lc(8),o.Qb(),o.Rb(9,"a",6),o.Yb("click",function(){return e.triggerGlobalEvent("button.campaign.technology")}),o.Lc(10),o.Qb(),o.Rb(11,"a",6),o.Yb("click",function(){return e.triggerGlobalEvent("button.campaign.tasks")}),o.Lc(12),o.Qb(),o.Rb(13,"button",7),o.Yb("click",function(){return e.triggerGlobalEvent("statistics_list.open",{campaignId:e.campaignId})}),o.Lc(14),o.Qb(),o.Qb(),o.Rb(15,"div",8),o.Ob(16,"router-outlet"),o.Qb(),o.Rb(17,"modal",9,10),o.Rb(19,"div",11),o.Rb(20,"div",12),o.Lc(21),o.Qb(),o.Rb(22,"div",13),o.Rb(23,"div",14),o.Rb(24,"div",15),o.Rb(25,"div",16),o.Ob(26,"img",17),o.Qb(),o.Rb(27,"div",12),o.Lc(28),o.Qb(),o.Qb(),o.Rb(29,"div",18),o.Lc(30),o.Qb(),o.Rb(31,"button",19),o.Yb("click",function(){return e.campaignStart()}),o.Lc(32),o.Qb(),o.Qb(),o.Rb(33,"div",14),o.Rb(34,"div",15),o.Rb(35,"div",16),o.Ob(36,"img",20),o.Qb(),o.Rb(37,"div",12),o.Lc(38),o.Qb(),o.Qb(),o.Rb(39,"button",21),o.Yb("click",function(){return o.zc(t),o.wc(18).close()}),o.Lc(40),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb()}2&t&&(o.Fb("disabled",e.isBackButtonDisabled()),o.kc("tooltip-hint",e.L("meta.ui.play.back")),o.jc("routerLink",e.campaignId==e.tutorialCampaignId?o.mc(45,ES):o.mc(46,NS))("alertSound","ui_back")("key-duplicator",27),o.Bb(4),o.Nc(" ",e.L("meta.ui.play.back"),"\n"),o.Bb(2),o.jc("ngIf",!e.isConquestCampaign),o.Bb(1),o.kc("tooltip-hint",e.L(e.isConquestCampaign?"meta.ui.menu.map":"meta.ui.menu.missions")),o.jc("routerLink",o.nc(47,FS,"/campaigns/"+e.campaignId+"/detail/missions"))("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L(e.isConquestCampaign?"meta.ui.menu.map":"meta.ui.menu.missions")),o.Bb(1),o.Nc(" ",e.L(e.isConquestCampaign?"meta.ui.menu.map":"meta.ui.menu.missions")," "),o.Bb(1),o.Fb("disabled",!e.hasTechTree),o.kc("tooltip-hint",e.L("meta.ui.menu.tech")),o.jc("routerLink",o.nc(49,FS,"/campaigns/"+e.campaignId+"/detail/technology"))("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L("meta.ui.menu.tech")),o.Bb(1),o.Nc(" ",e.L("meta.ui.menu.tech")," "),o.Bb(1),o.Fb("disabled",!e.hasTasks||!e.playerIsTeamLeader&&e.userInTeam),o.kc("tooltip-hint",e.L("meta.ui.menu.tasks")),o.jc("routerLink",o.nc(51,FS,"/campaigns/"+e.campaignId+"/detail/tasks"))("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L("meta.ui.menu.tasks")),o.Bb(1),o.Nc(" ",e.L("meta.ui.menu.tasks")," "),o.Bb(1),o.kc("tooltip-hint",e.L("meta.ui.profile.menu.sessions")),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L("meta.ui.profile.menu.sessions")),o.Bb(1),o.Nc(" ",e.L("meta.ui.profile.menu.sessions")," "),o.Bb(3),o.jc("header",e.L("meta.ui.campaign.restart_header"))("id","campaign_restart_modal"),o.Bb(4),o.Mc(e.L("meta.ui.campaign.restart_caption")),o.Bb(7),o.Mc(e.L("meta.ui.campaign.restart_text_accept")),o.Bb(2),o.Nc(" ",e.L("meta.ui.campaign.restart_text_accept_nb")," "),o.Bb(1),o.Fb("disabled",e.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.campaign.restart_button_accept")," "),o.Bb(6),o.Mc(e.L("meta.ui.campaign.restart_text_decline")),o.Bb(1),o.Fb("disabled",e.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.campaign.restart_button_decline")," "))},directives:[Ks,tp,Zv,ty,ee,Zs,ta,Qh,Qf,h_],encapsulation:2}),t})();function US(t,e){1&t&&o.Ob(0,"router-outlet")}function zS(t,e){if(1&t&&(o.Rb(0,"div",2),o.Rb(1,"div",3),o.Ob(2,"span"),o.Lc(3),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(3),o.Nc("",t.L("meta.ui.campaign.preloader")," ")}}let JS=(()=>{class t{constructor(t,e,i,n){this.cache=t,this.redirectService=e,this.router=i,this.activatedRoute=n,this.campaignId="",this.globalEvent=new uu,this.isDataLoaded=!1,this.campaign=null,(new al).data.subscribe(t=>this.L=t)}hardReload(){this.cache.invalidateAllCampaignUnits();let t=this.router.url.split("/");t.shift(),t[t.length-1]=t[t.length-1].split("?")[0],this._ownerChangeSusbscription&&this._ownerChangeSusbscription.unsubscribe(),this._campaignStartSubscription&&this._campaignStartSubscription.unsubscribe(),JSON.parse(JSON.stringify(this.router.url)).match(/campaigns/gim)&&(this.cache.redirect(["/campaigns"]),setTimeout(()=>{this.cache.getCampaign(this.campaignId).progress&&this.cache.redirect(["campaigns",this.campaignId,"detail","missions"])}))}ngOnInit(){this.campaignId=this.activatedRoute.snapshot.params.campaignId,this.cache.setGlobalCampaign(this.campaignId),this.campaign=this.cache.getCampaign(this.campaignId);let t=this.cache.getTeamLeader();this.cache.isTeamOwner()&&this.redirectService.setLocation({campaign:this.campaignId}),this.cache.isTeamOwner()||(this._campaignStartSubscription=this.cache.onCampaignStart.pipe(We(t=>null!==t)).subscribe(()=>{console.warn("Reloading campaign due to [onCampaignStart]"),this.hardReload()})),"tutorial_rus"!=this.campaignId&&this.campaign&&!this.campaign.modId?t&&t!==this.cache.getUserId()?(this.cache.invalidateCampaignUnits(this.campaignId),Gc.Fetch(pl.CampaignJoin.patch({owner:t,campaign:this.campaignId})).subscribe(e=>{console.log("campaignJoin:",e);let i=e.scriptData&&e.scriptData.commander?e.scriptData.commander:null;i&&i.length>0&&this.cache.injectCommanders(i,!0),this.cache.getCampaignUnits(this.campaignId,t).then(t=>{this.isDataLoaded=!0}),this.cache.setCampaignCurrency(e.scriptData.campaign.template,e.scriptData.campaign.money.freeXp,e.scriptData.campaign.money.silver)},t=>{console.error(t),this.hardReload()})):this.cache.getCampaignUnits(this.campaignId).then(t=>{this.isDataLoaded=!0}):this.isDataLoaded=!0,this._ownerChangeSusbscription=this.cache.ownerChange.pipe(We(t=>null!==t)).subscribe(t=>{this.cache.isTeamOwner()||this.hardReload()})}ngOnDestroy(){this.cache.isTeamOwner()&&this.redirectService.setLocation(null),this._ownerChangeSusbscription&&this._ownerChangeSusbscription.unsubscribe(),this._campaignStartSubscription&&this._campaignStartSubscription.unsubscribe()}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Md),o.Nb(Ys),o.Nb(xn))},t.\u0275cmp=o.Hb({type:t,selectors:[["campaign-main"]],features:[o.Ab([nd,Md])],decls:2,vars:2,consts:[[4,"ngIf"],["class","campaign-preloader",4,"ngIf"],[1,"campaign-preloader"],[1,"preloader"]],template:function(t,e){1&t&&(o.Jc(0,US,1,0,"router-outlet",0),o.Jc(1,zS,4,1,"div",1)),2&t&&(o.jc("ngIf",e.isDataLoaded),o.Bb(1),o.jc("ngIf",!e.isDataLoaded))},directives:[ee,ta],encapsulation:2}),t})();const qS=["map"];function VS(t){return t.getBoundingClientRect()}let $S=(()=>{class t{constructor(t,e){this.el=t,this.renderer=e,this.area=GS.Inner,this.scrollToNode=null,this.onDragStart=new o.o,this.onDragEnd=new o.o,this.onDragMove=new o.o,this.onScrollStart=new o.o,this.onScrollEnd=new o.o,this.onScrollMove=new o.o,this.active=!1,this.onMove=!1,this.dragging=!1,this.start=new yl,this.translation=new yl,this.finish=new yl,this.windowMax=new yl,this.scrollPosition=new yl,this.scrollStep=250,this.scrollStart=!1,this.scrollingAnimationFrameIndex=0,this.scrolledNode=null,this.dragWindow=this.el.nativeElement}ngOnInit(){this.windowMax.x=window.innerWidth,this.windowMax.y=window.innerHeight}ngOnDestroy(){this.endMove(event)}onResize(t){this.windowMax.x=window.innerWidth,this.windowMax.y=window.innerHeight,this.boxSize=VS(this.dragWindow),this.updatePosition()}startMove(e){e&&e.which&&3==e.which||e.target.closest("[ngDraggable]")||(t.activeWindowDrag=this,this.active||!e.target.closest("[drag-anchor]")||e.target.closest(".dropdown-menu")||(this.active=!0,this.dragging=!1,this.start.x=e.pageX,this.start.y=e.pageY,this.dragWindow.classList.add("active-drag"),this.boxSize=VS(this.dragWindow),this.onDragStart.emit(this)))}moveWindow(t,e){if(!this.active)return;this.onMove=!0;let i=new yl(t.pageX,t.pageY);this.start.distanceTo(i)/window.devicePixelRatio>1&&!this.dragging&&(this.dragging=!0),this.translation=i.subtract(this.start),this.onMove&&(this.translation=this.translation.add(this.finish)),this.updatePosition(),this.onDragMove.emit(this)}updatePosition(){if(this.area==GS.Outer){let t=0,e=this.windowMax.x-this.boxSize.width,i=0,n=this.windowMax.y-this.boxSize.height;this.translation.x=this.translation.x<=e?e:this.translation.x>=t?t:this.translation.x,this.translation.y=this.translation.y<=i?this.translation.y<=n?n:this.translation.y:i}else{let t=-this.boxSize.left+this.finish.x,e=this.windowMax.x-(this.boxSize.left+this.boxSize.width)+this.finish.x,i=-this.boxSize.top+this.finish.y,n=this.windowMax.y-(this.boxSize.top+this.boxSize.height)+this.finish.y;this.translation.x=this.translation.x<=t?t:this.translation.x>=e?e:this.translation.x,this.translation.y=this.translation.y<=i?i:this.translation.y>=n?n:this.translation.y}this.dragWindow.style.transform=`translate3d(${Math.floor(this.translation.x)}px, ${Math.floor(this.translation.y)}px, 0px)`,this.copyCoordinatesElement&&(this.copyCoordinatesElement.style.transform=this.dragWindow.style.transform)}endMove(t){this.active&&(this.active=!1,this.dragging=!1,this.finish=this.translation,this.dragWindow.classList.remove("active-drag"),this.onDragEnd.emit(this))}resizeWindow(t){this.resize&&(this.resizeBtn=this.renderer.createElement("div"),this.renderer.appendChild(this.dragWindow,this.resizeBtn),this.renderer.addClass(this.resizeBtn,"modal-resize"))}getCurrentTranslation(){return this.translation}unsetMove(t){this.translation.x=0,this.translation.y=0,this.endMove(t),this.dragWindow.style.transform=`translate(${Math.floor(this.translation.x)}px, ${Math.floor(this.translation.y)}px)`}onMousewheel(t){this.area!=GS.Inner&&(t.preventDefault(),this.scrollStart?this.scrollMoveUpdate(t):this.scrollMoveStart(),wu(()=>{this.scrollMoveEnd()},500,"map_scroll"))}scrollMoveStart(){this.scrollStart=!0,this.boxSize=VS(this.dragWindow),this.onScrollStart.emit(this),this.scrollPosition=this.finish}scrollMoveUpdate(t){let e=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail));1==t.shiftKey||1==t.ctrlKey?e>0?this.scrollPosition.x+=this.scrollStep:this.scrollPosition.x-=this.scrollStep:e>0?this.scrollPosition.y+=this.scrollStep:this.scrollPosition.y-=this.scrollStep,this.translation=this.scrollPosition,this.updatePosition(),this.onScrollMove.emit(this)}scrollMoveEnd(){this.scrollStart=!1,this.finish=this.translation,this.onScrollEnd.emit(this)}getX(t,e,i){if(!t||!e||!i)return;let n=VS(this.dragWindow),s=n.height/e.y,a=[];for(let o of i)o&&o.position&&a.push(o.position.x);let r=Math.min.apply(null,[...new Set(a)]);return s+(t.position.x-r)/e.x*(n.width-s)}getY(t,e,i){if(!t||!e||!i)return;let n=VS(this.dragWindow),s=n.height/e.y,a=[];for(let o of i)o&&o.position&&a.push(o.position.y);let r=Math.min.apply(null,[...new Set(a)]);return s+(t.position.y-r)/e.y*(n.height-s)}scrollToCalculatedVector(t,e){if(!t)return;let i=this.translation.clone(),n=0;if(this.scrollMoveStart(),e){this.scrollingAnimationFrameIndex&&cancelAnimationFrame(this.scrollingAnimationFrameIndex);let e=()=>{cancelAnimationFrame(this.scrollingAnimationFrameIndex),this.translation=t,this.updatePosition(),n=0,this.scrollMoveEnd()},s=()=>{if(n>=1)return void e();this.scrollingAnimationFrameIndex=requestAnimationFrame(s);let a=i.lerp(t,ld.easeInOutCubic(n));this.translation=a,this.updatePosition(),n+=.01};s()}else setTimeout(()=>{this.translation=t,this.updatePosition(),this.scrollMoveEnd()})}getScrollTargetVector(t){if(!t||!t.nodes||!t.nodes.length)return;let e=new yl(window.innerWidth-window.innerWidth/3.5,window.innerHeight/3.2),i=new yl,n=new yl;return this.scrolledNode=t.node?t.node:t.nodes[0],t.node?(n.x=this.getX(t.node,t.nodes.size,t.nodes),n.y=this.getY(t.node,t.nodes.size,t.nodes)):(n.x=this.getX(t.nodes[0],t.nodes.size,t.nodes),n.y=this.getY(t.nodes[0],t.nodes.size,t.nodes)),i.x=e.x-n.x,i.y=e.y-n.y,i}scrollToMiddle(t,e){let i=this.getScrollTargetVector(t);this.scrollToCalculatedVector(i,e)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m),o.Nb(o.H))},t.\u0275dir=o.Ib({type:t,selectors:[["","draggableWindow",""]],viewQuery:function(t,e){if(1&t&&o.Qc(qS,!0),2&t){let t;o.vc(t=o.Zb())&&(e.map=t.first)}},hostVars:2,hostBindings:function(t,e){1&t&&o.Yb("mousedown",function(t){return e.startMove(t)})("mousemove",function(t){return e.moveWindow(t,e.active)})("mouseup",function(t){return e.endMove(t)})("mousewheel",function(t){return e.onMousewheel(t)})("resize",function(t){return e.onResize(t)},!1,o.yc),2&t&&o.Fb("dragging",e.dragging)},inputs:{anchor:["draggableWindow","anchor"],resize:"resize",area:"area",scrollToNode:"scrollToNode",copyCoordinatesElement:"copyCoordinatesElement"},outputs:{onDragStart:"onDragStart",onDragEnd:"onDragEnd",onDragMove:"onDragMove",onScrollStart:"onScrollStart",onScrollEnd:"onScrollEnd",onScrollMove:"onScrollMove"},exportAs:["draggableWindowDirective"]}),t})();document.addEventListener("mousemove",function(t){$S.activeWindowDrag&&$S.activeWindowDrag.active&&$S.activeWindowDrag.moveWindow(t,$S.activeWindowDrag.active)}),document.addEventListener("mouseup",function(t){$S.activeWindowDrag&&$S.activeWindowDrag.active&&$S.activeWindowDrag.endMove(t)});var GS=function(t){return t.Inner="inner",t.Outer="outer",t}({});let HS=(()=>{class t{constructor(t,e){this.host=t,this.cache=e,this.moderatedClick=new o.o,this.moderatedDbclick=new o.o,this._timeout=null,this.Host=this.host.nativeElement}onClick(t){if(this._timeout)return clearTimeout(this._timeout),this._timeout=null,void this.moderatedDbclick.emit(t);this._timeout=setTimeout(()=>{clearTimeout(this._timeout),this._timeout=null,this.moderatedClick.emit(t)},250)}ngOnInit(){}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m),o.Nb(nd))},t.\u0275dir=o.Ib({type:t,selectors:[["","moderatedClick",""]],hostBindings:function(t,e){1&t&&o.Yb("click",function(t){return e.onClick(t)})("contextmenu",function(t){return e.onClick(t)})},outputs:{moderatedClick:"moderatedClick",moderatedDbclick:"moderatedDbclick"}}),t})(),YS=(()=>{class t{constructor(t){this.hostRef=t,this.host=this.hostRef.nativeElement,window.addEventListener("resize",t=>{this.updateOnWindowResizeEvent()})}ngAfterViewInit(){this.checkFontSize()}updateOnWindowResizeEvent(){this.host.removeAttribute("style"),setTimeout(()=>{this.checkFontSize()},1)}checkFontSize(){if(this.host.getBoundingClientRect().width>this.host.parentElement.getBoundingClientRect().width){let t=parseInt(getComputedStyle(this.host).fontSize.match(/\d+/)[0]);this.currentFontSize=t-1,this.host.setAttribute("style","font-size:"+this.currentFontSize+"px"),setTimeout(()=>{this.checkFontSize()},1)}}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m))},t.\u0275dir=o.Ib({type:t,selectors:[["","flexible-font-size",""]]}),t})();function WS(t,e){if(1&t&&o.Ob(0,"img",11),2&t){const t=o.bc(2);o.jc("src","assets/img/mission/"+t.missionInfo.id+"_preview.jpg",o.Cc)}}function KS(t,e){if(1&t&&o.Ob(0,"img",11),2&t){const t=o.bc(2);o.jc("src",t.missionInfo.image_preview,o.Cc)}}function XS(t,e){1&t&&o.Ob(0,"img",15)}function ZS(t,e){1&t&&o.Ob(0,"img",16)}function tI(t,e){if(1&t&&(o.Rb(0,"div",12),o.Jc(1,XS,1,0,"img",13),o.Jc(2,ZS,1,0,"img",14),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("ngIf",t.missionCompleted),o.Bb(1),o.jc("ngIf",!t.node.open)}}function eI(t,e){1&t&&o.Ob(0,"span",17)}const iI=function(t){return{title:t}};function nI(t,e){if(1&t&&(o.Rb(0,"div",1),o.Rb(1,"div",2),o.Jc(2,WS,1,1,"img",3),o.Jc(3,KS,1,1,"img",3),o.Qb(),o.Rb(4,"div",4),o.Rb(5,"div",5),o.Jc(6,tI,3,2,"div",6),o.Rb(7,"h4",7),o.Rb(8,"span",8),o.Lc(9),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Ob(10,"span",9),o.Jc(11,eI,1,0,"span",10),o.Qb()),2&t){const t=o.bc();o.Fb("disabled",!t.node.open)("active",t.savedNodeId&&t.savedNodeId==t.node._id)("completed",t.missionCompleted),o.kc("tooltip-hint",t.missionCompleted?t.L("meta.hint.mission.mission_completed",o.nc(12,iI,t.L("meta.mission."+t.missionInfo.id+".name"))):t.node.open?t.L("meta.hint.mission.mission_open",o.nc(14,iI,t.L("meta.mission."+t.missionInfo.id+".name"))):t.L("meta.hint.mission.mission_disabled",o.nc(16,iI,t.L("meta.mission."+t.missionInfo.id+".name")))),o.Bb(2),o.jc("ngIf",!t.missionInfo.image_preview),o.Bb(1),o.jc("ngIf",t.missionInfo.image_preview),o.Bb(3),o.jc("ngIf",t.missionCompleted||!t.node.open),o.Bb(3),o.Mc(t.L("meta.mission."+t.missionInfo.id+".name")),o.Bb(2),o.jc("ngIf",t.getCounter("ui.mark.play.mission."+t.missionInfo.id))}}JSON;let sI=(()=>{class t{constructor(t,e,i){this.host=t,this.cache=e,this.tasksService=i,this.oninit=new o.o,this.missionCompleted=!1,this.missionInfo=null,this.savedNodeId="",(new al).data.subscribe(t=>this.L=t)}ngOnInit(){this.oninit.emit(this.host),this.node&&(this.missionInfo=this.cache.getMission(this.node.id),this.missionCompleted=this.node.completed),this.savedNodeId=this.getSavedNodeId()}getCounter(t){return this.cache.getCounter(t)}getSavedNodeId(){return localStorage.getItem("METAGAME_SELECTED_NODE_"+this.cache.getUserId())}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m),o.Nb(nd),o.Nb(Tl))},t.\u0275cmp=o.Hb({type:t,selectors:[["mission"]],hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("small-rewards",e.smallRewardList)},inputs:{node:"node"},outputs:{oninit:"oninit"},features:[o.Ab([nd,Tl])],decls:1,vars:1,consts:[["class","mission-cover texture-border",3,"disabled","active","completed","tooltip-hint",4,"ngIf"],[1,"mission-cover","texture-border",3,"tooltip-hint"],[1,"image-cover","mission-image"],["image-load","","draggable","false",3,"src",4,"ngIf"],[1,"inner"],[1,"title-cover"],["class","completed-marker",4,"ngIf"],[1,"title"],["flexible-font-size",""],[1,"animator"],["class","marker",4,"ngIf"],["image-load","","draggable","false",3,"src"],[1,"completed-marker"],["class","icon","src","assets/img/icons/svg/checked.svg","alt","icon","draggable","false",4,"ngIf"],["class","icon","src","assets/img/icons/svg/icon_lock.svg","alt","icon","draggable","false",4,"ngIf"],["src","assets/img/icons/svg/checked.svg","alt","icon","draggable","false",1,"icon"],["src","assets/img/icons/svg/icon_lock.svg","alt","icon","draggable","false",1,"icon"],[1,"marker"]],template:function(t,e){1&t&&o.Jc(0,nI,12,18,"div",0),2&t&&o.jc("ngIf",e.missionInfo)},encapsulation:2}),t})();const aI=["scrollable"],rI=["canvas"],oI=["canvasHover"],cI=["tree"];function lI(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",12),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit,i=o.bc(2);return i.completeMission(i.activeCampaignId,e._id)}),o.Ob(1,"img",13),o.Qb()}2&t&&o.jc("alertSound","ui_click_default")}const uI=function(){return{hover:"ui_hover_default",click:"ui_click_default"}};function dI(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div"),o.Jc(1,lI,2,1,"button",10),o.Rb(2,"mission",11),o.Yb("click",function(i){o.zc(t);const n=e.$implicit;return o.bc(2).selectMission(n,i)})("contextmenu",function(i){o.zc(t);const n=e.$implicit;return o.bc(2).selectMission(n,i)}),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Ic("top",i.itemHeight*t.position.y-1+2*i.gutter*t.position.y+1-i.itemHeight+"px")("left",2*i.gutter*(t.position.x-i.coordXMin)+i.itemWidth*(t.position.x-i.coordXMin)+2*i.gutter+"px"),o.Bb(1),o.jc("ngIf",i.hasFlag("debug")&&!t.completed&&t.open),o.Bb(1),o.Fb("disabled",i.isMissionDisabledByTeam(t.id)||!t.open)("disabled",!i.allowMissions()||!t.open||0==t.open),o.jc("node",t)("alertSound",o.mc(11,uI))}}function hI(t,e){if(1&t&&(o.Rb(0,"div",8),o.Jc(1,dI,3,12,"div",9),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngForOf",t.missionsNode)}}let bI=(()=>{class t{constructor(t,e,i){this.cache=t,this.sanitizer=e,this.notificatorService=i,this.activeCampaignId="",this.selectedNodeId="",this.onMissionSelect=new o.o,this.activeNode=null,this.directArrows=!0,this.math=Math,this.missionsNode=[],this.treeVisible=!1,this.grid={size:new yl(1,1)},this.rect={left:0,right:0,top:0,bottom:0,width:0,height:0},this.gutter=20,this.linesGap=10,this.lineWidth=1,this.coordXMin=0,this.substrateMissions=[],this._missionsTreePositions=[],this._colors={active:"#D6E1F0",disabled:"#D6E1F0",completed:"#D6E1F0"},this.missionSize=new yl(300,300),this.counters={},this.tutorialHighlitedId="",this.globalEvent=new uu,this.pixelRatio=1,this.campaign=null,this.parseNumberMethod=function(t){return Number(t.replace(/px$/,""))},(new al).data.subscribe(t=>this.L=t),this.calculateMissionSize(),window.addEventListener("resize",t=>{this.calculateMissionSize(),this.updateRects(),this.drawArrows(this.ctx)}),this.counters=this.cache.getCounters(),this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>{this.counters[t.path]=t.value})}ngOnInit(){this.campaign=this.cache.getCampaign(this.activeCampaignId),this.canvas=this.canvas.nativeElement,this.ctx=this.canvas.getContext("2d"),this.getMissionsTree(),this.updateRects(),this.api=this.cache.getAPIUrl(),this.missonChangeSubscription=this.cache.campaignChange.pipe(We(t=>null!==t)).subscribe(t=>{this.getMissionsTree(),this.updateRects()})}ngOnDestroy(){this.missonChangeSubscription&&this.missonChangeSubscription.unsubscribe()}getMission(t){return this.cache.getMission(t)}getMissionsTree(){this.activeCampaignId&&(this.missionsNode=[],this.treeVisible=!1,setTimeout(()=>{this.missionsNode=this.cache.getCampaignTree(this.activeCampaignId),this.grid.size=this.missionsNode.size,this.getBoxSize(),this.cache.devMode&&console.log(this.missionsNode),setTimeout(()=>{if(this.treeVisible=!0,this.updateRects(),this.drawArrows(this.ctx),this.tutorialHighlitedId=this.setTutorialHighlightNode(),this.isSlave()){let t=this.cache.getUserTeam();if(t&&t.game&&t.game.option&&t.game.option.map){let e=this.missionsNode.find(e=>e.id===t.game.option.map);e&&this.setActiveMission(e)}}})},250))}setActiveMission(t){t&&(this.onMissionSelect.emit({nodeId:t._id,missionId:t.id}),this.activeNode=t,this.selectedNodeId=t._id,this.savedNodeId())}savedNodeId(){localStorage.setItem("METAGAME_SELECTED_NODE_"+this.cache.getUserId(),JSON.stringify(this.selectedNodeId))}getmissionsNode(){return this.missionsNode}isMissionDisabledByTeam(t){let e=this.cache.getUserTeam();return!!e&&!!this.isSlave()&&e.game&&e.game.option&&e.game.option.map!==t}updateRects(){if(this.tree&&this.tree.nativeElement){if(this.pixelRatio=window.devicePixelRatio,this.itemWidth=this.cache.missionSize.x,this.itemHeight=this.cache.missionSize.y,this.rect=this.tree.nativeElement.getBoundingClientRect(),this.canvas){let t=this.canvas.parentElement.getBoundingClientRect();this.canvas.width=t.width,this.canvas.height=t.height}this.scrollable&&(this.scrollable.setRects(),this.scrollable.update())}}drawArrows(t){getComputedStyle(document.documentElement).getPropertyValue("--color-primary"),t.clearRect(0,0,this.canvas.width,this.canvas.height),t.lineWidth=this.lineWidth,this.missionsNode.map(e=>{!e.opens||e.opens&&!e.opens.length||(this.sortMissionOpeningPoints(e,!0),e.opens.map(i=>{let n=this.getMissionById(i);if(!n)return;this.sortMissionOpeningPoints(n,!1);let s="source-over",a=e.completed?this._colors.completed:e.open?this._colors.active:this._colors.disabled,r=.5===Math.abs(e.position.y-n.position.y),o=this.getPathBetweenMissions(e,n,e.opens[n._id],n.opensBy[e._id],r);if(!this.directArrows||r){let i=o[o.length-1].subtract(o[0]);this.drawDiagonal(t,o[0],o[o.length-1],a,s),this.drawArrow(t,o[o.length-1],this.getMissionPosition(e,n),this.getHorizontalDiff(e,n),a,i.getAngle())}else this.drawPath(t,o,a,s),this.drawSimpleArrow(t,o[o.length-1],this.getMissionVerticalOrigin(e,n),a)}))})}drawPath(t,e,i="white",n="source-over"){for(let s=1;s<e.length;s++)this.drawLine(t,e[s-1],e[s],i,n)}drawLine(t,e,i,n="white",s="source-over"){e=e.floor(),i=i.floor();let a=new yl(Math.min(e.x,i.x),Math.min(e.y,i.y)),r=new yl(Math.max(e.x,i.x),Math.max(e.y,i.y)).clone().subtract(a).fill(this.lineWidth);t.fillStyle=n,t.globalCompositeOperation=s,t.beginPath(),r.y>r.x&&(r.y+=r.x),t.rect(a.x,a.y,r.x,r.y),t.fill()}drawArrow(t,e,i,n,s="#fff",a){let r=this.lineWidth+this.cache.arrowSize;Math.degreesToRadians(60),Math.degreesToRadians(60),Math.degreesToRadians(120),Math.degreesToRadians(120),Math.degreesToRadians(90),Math.degreesToRadians(90),Math.abs(n),_u.drawArrow(t,e,r,a,s)}drawSimpleArrow(t,e,i="right",n="white"){let s=this.cache.arrowSize,a=this.lineWidth+s,r=s/2;t.beginPath(),t.fillStyle=n;let o,c,l=e.clone().floor().add(new yl(.5,.5));switch(i){case"left":o=new yl(l.x-a,l.y-a+r),c=new yl(l.x-a,l.y+a-r);break;case"right":o=new yl(l.x+a,l.y+a-r),c=new yl(l.x+a,l.y-a+r);break;case"bottom":o=new yl(l.x-a+r,l.y+a),c=new yl(l.x+a-r,l.y+a);break;case"top":o=new yl(l.x-a+r,l.y-a),c=new yl(l.x+a-r,l.y-a)}t.moveTo(l.x,l.y),t.lineTo(o.x,o.y),t.lineTo(c.x,c.y),t.lineTo(l.x,l.y),t.fill()}drawDiagonal(t,e,i,n="white",s="source-over"){t.strokeStyle=n,t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(i.x,i.y),t.stroke()}getMissionById(t){return this.missionsNode.find(e=>e._id==t)}sortMissionOpeningPoints(t,e){e?t.opens.filter(e=>{let i=this.getMissionById(e);return!!i&&i.position.x!==t.position.x}).length>1&&t.opens.map(e=>{let i=this.getMissionById(e);if(!i)return!1;t.opens[e]=i.position.y-t.position.y}):t.opensBy.filter(e=>{let i=this.getMissionById(e);return!!i&&i.position.x!==t.position.x}).length>1&&t.opensBy.map(e=>{let i=this.getMissionById(e);if(!i)return!1;t.opensBy[e]=i.position.y-t.position.y})}getPathBetweenMissions(t,e,i=0,n=0,s=!1){let a=[],r=this.getMissionOriginPoint(t,this.getMissionPosition(e,t,s),s),o=this.getMissionOriginPoint(e,this.getMissionPosition(t,e,s),s);if(s&&(r.y+=this.gutter*(1/this.pixelRatio)),a.push(r),t.position.x!==e.position.x&&!s){let t=null,e=null;t=r.clone().add(new yl(0,this.gutter+Math.abs(2*i))),a.push(t),e=o.clone().subtract(new yl(0,this.gutter-Math.abs(2*i))),a.push(e)}return s&&(o.y-=this.gutter*(1/this.pixelRatio)),a.push(o),a}getMissionPosition(t,e,i=!1){let n={};return n.y=i?"center":t.position.y<e.position.y?"top":t.position.y>e.position.y?"bottom":"center",n.x=t.position.x<e.position.x?"left":t.position.x>e.position.x?"right":"center",n}getMissionOriginPoint(t,e,i=!1){let n=new yl,s=this.gutter*(1/this.pixelRatio),a=t.position.x-this.coordXMin,r=t.position.y;return n.x=2*this.gutter*a+this.itemWidth*a+2*this.gutter+this.itemWidth/2,n.y=2*this.gutter*r+this.itemHeight*r+this.itemHeight/2-this.itemHeight,"bottom"==e.y?(n.y+=this.itemHeight/2,t.opens&&t.opens.length>1&&("left"==e.x?n.x-=s*this.pixelRatio:"right"==e.x&&(n.x+=s*this.pixelRatio))):"top"==e.y?(n.y-=this.itemHeight/2,t.opensBy&&t.opensBy.length>1&&("left"==e.x?n.x-=s*this.pixelRatio:"right"==e.x&&(n.x+=s*this.pixelRatio))):"left"==e.x?n.x-=this.itemHeight/2:"right"==e.x&&(n.x+=this.itemHeight/2),n}getX(t){return this.gutter+this.itemWidth*(t.position.x-this.coordXMin)}getY(t){return this.gutter+this.itemHeight*t.position.y-this.itemHeight}getMissionVerticalOrigin(t,e){let i="top";return i=t.position.y<e.position.y?"top":"bottom",i}getHorizontalDiff(t,e){let i=0;return i=t.position.x-e.position.x,i*this.pixelRatio}changeArrowsView(){this.directArrows=!this.directArrows,this.updateRects(),this.drawArrows(this.ctx)}completeMission(t,e){let i=new Nc;if(t&&e)return Il(`${this.api}&cmd=playerCampaignMarkNodeAsComplete&campaign=${t}&node=${e}`).then(e=>{this.cache.fetchCampaign(t),i.next(e)}),i}setMoney(t,e,i){t&&Il(`${this.api}&cmd=playerCampaignCurrencySet&campaign=${t}&freeXp=${e}&silver=${i}`).then(n=>{console.log(">>> money response:",n),this.cache.setCampaignCurrency(t,e,i)})}randomizeUnitTree(t,e){if(!t||!e||!e.length)return;let i=`${this.api}&cmd=playerCampaignRandomizeUnitTree&campaign=${t}`;e.map(t=>{let e="";if(t)for(let n in t)e=`&${n}=${t[n]}`,i+=e}),Il(i).then(()=>{this.cache.fetchCampaign(t)})}hasFlag(t){return this.cache.hasFlag(t)}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}setTutorialHighlightNode(){let t=[];return t=this.missionsNode.filter(t=>!t.completed),t=t.slice().sort((t,e)=>t.level-e.level),t.length&&t[0]?t[0].id:null}selectMission(t,e){e&&e.preventDefault(),t&&t.open&&(this.setActiveMission(t),this.cache.devMode&&console.log("Selected mission: ",t.id),this.activeCampaignId&&this.cache.redirect(["campaigns",this.activeCampaignId,"missions",t.id]))}isSlave(){return this.cache.getUserTeam()&&!this.cache.isTeamOwner()}getVerticalyAlignedStyle(){let t=this.tree.nativeElement.getBoundingClientRect();return this.missionsNode&&this.missionsNode.size&&this.missionsNode.size.y<=5?`top: 50%; margin-top: ${-t.height/2-this.itemHeight+this.gutter}px;`:null}calculateMissionSize(){this.missionSize=new yl(parseInt(this.getComputedStyle().width),parseInt(this.getComputedStyle().height))}getComputedStyle(){let t=getComputedStyle(document.documentElement);return{width:t.getPropertyValue("--mission-side"),height:t.getPropertyValue("--mission-side")}}getBoxSize(){let t=this.parseNumberMethod(this.getComputedStyle().width),e=(this.parseNumberMethod(this.getComputedStyle().height),[]),i=[],n=[],s=[];for(let l of this.missionsNode)l&&l.position&&e.push(l.position);if(e.length)for(let l of e)s.push(l.x),i.push(Math.floor(l.x)),n.push(Math.floor(l.y));let a=[...new Set(i)].sort(),r=[...new Set(n)].sort(),o=a.length,c=r.length;if(this.coordXMin=Math.min.apply(null,[...new Set(s)]),this.grid&&this.grid.size){let e=0,i=0;return e=t*o+2*this.gutter*o+2*this.gutter,i=t*c+2*this.gutter*c+2*this.gutter,`width: ${e}px; height: ${i}px;`}}uniqueArray(t){t.filter(function(t,e,i){return i.indexOf(t)==e})}allow(t){return this.cache.allow(t)}allowMissions(){return!!this.campaign&&this.cache.allow("tutorial"===this.campaign.category?"tutorial":"campaign."+this.campaign.category)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Er),o.Nb(Uc))},t.\u0275cmp=o.Hb({type:t,selectors:[["mission-tree"]],viewQuery:function(t,e){if(1&t&&(o.Fc(aI,!0),o.Fc(rI,!0),o.Fc(oI,!0),o.Fc(cI,!0)),2&t){let t;o.vc(t=o.Zb())&&(e.scrollable=t.first),o.vc(t=o.Zb())&&(e.canvas=t.first),o.vc(t=o.Zb())&&(e.canvasHover=t.first),o.vc(t=o.Zb())&&(e.tree=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("faded",!0)},inputs:{activeCampaignId:"activeCampaignId",selectedNodeId:"selectedNodeId"},outputs:{onMissionSelect:"onMissionSelect"},features:[o.Ab([])],decls:11,vars:11,consts:[[1,"preloader"],[2,"height","100%",3,"fade"],["scrollable",""],[1,"tree-grid"],[1,"tree"],["tree",""],["class","tree-inner",4,"ngIf"],["canvas",""],[1,"tree-inner"],[3,"top","left",4,"ngFor","ngForOf"],["class","button complete-button","tooltip-hint","Complete Mission Only for Debug",3,"alertSound","click",4,"ngIf"],[3,"node","alertSound","click","contextmenu"],["tooltip-hint","Complete Mission Only for Debug",1,"button","complete-button",3,"alertSound","click"],["src","assets/img/icons/svg/bug.svg","draggable","false",1,"icon"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Ob(1,"span"),o.Lc(2),o.Qb(),o.Rb(3,"scrollable",1,2),o.Rb(5,"div",3),o.Rb(6,"div",4,5),o.Jc(8,hI,2,1,"div",6),o.Ob(9,"canvas",null,7),o.Qb(),o.Qb(),o.Qb()),2&t&&(o.Fb("disabled",e.treeVisible),o.Bb(2),o.Nc("",e.L("meta.ui.tech.preloader"),"\n"),o.Bb(1),o.jc("fade",!0),o.Bb(3),o.Fb("active",e.treeVisible),o.Cb("style",e.getBoxSize(),o.Bc),o.Bb(2),o.jc("ngIf",e.treeVisible),o.Bb(1),o.Fb("active",e.treeVisible),o.Cb("style",e.getBoxSize(),o.Bc))},directives:[Rh,ee,Zt,sI,Zv,tp],encapsulation:2}),t})();const mI=["scrollable"],pI=["arrowCanvas"],gI=["canvasHover"],fI=["canvasDebug"],vI=["tree"];function yI(t,e){if(1&t&&o.Ob(0,"img",23),2&t){const t=o.bc().$implicit;o.jc("src","assets/img/commanders_conquest/"+t.template.conquest_icon+".svg",o.Cc)}}function _I(t,e){if(1&t&&(o.Rb(0,"div",24),o.Lc(1),o.Qb()),2&t){const t=o.bc(4);o.Bb(1),o.Mc(t.L("meta.ui.campaign.conquest_defence_locked"))}}function kI(t,e){if(1&t&&(o.Rb(0,"div",25),o.Lc(1),o.Qb()),2&t){const t=o.bc(4);o.Bb(1),o.Nc("",t.L("meta.ui.troops.speciality.title"),":")}}function wI(t,e){if(1&t&&(o.Rb(0,"div",26),o.Lc(1),o.Ob(2,"br"),o.Lc(3),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(3);o.Bb(1),o.Nc(" ",e.L("meta.ui.menu.nation."+(null==t?null:t.template.army)),""),o.Bb(2),o.Oc(" ",e.L("meta.ui.commander.type."+(null==t?null:t.template.type)),", ",e.L("meta.ui.troops.speciality."+t.template.speciality)," ")}}const SI=function(t,e,i){return{campaign:t,commander:e,nodeFrom:i}};function II(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",11),o.Rb(1,"div",12),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(3).toggleActiveCommander(i.template)})("onDragStart",function(){o.zc(t);const i=e.$implicit;return o.bc(3).onDragStart(i)})("onDragEnd",function(){o.zc(t);const i=e.$implicit;return o.bc(3).onDragEnd(i)}),o.Rb(2,"span",13),o.Jc(3,yI,1,1,"img",14),o.Qb(),o.Qb(),o.Rb(4,"div",15),o.Rb(5,"figure",16),o.Ob(6,"img",17),o.Qb(),o.Rb(7,"div",18),o.Ob(8,"div",19),o.Jc(9,_I,2,1,"div",20),o.Jc(10,kI,2,1,"div",21),o.Jc(11,wI,4,3,"div",22),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(3);o.Bb(1),o.Fb("disabled",!i.playerIsTeamLeader&&i.userInTeam||"defence"==i.campaign.progress.phase)("reserved-to",""==i.campaign.progress.commander[t.template.id].node)("reserved-from",""==i.campaign.progress.commander[t.template.id].nodeNext),o.jc("useBounds",!0)("externalData",o.pc(19,SI,i.activeCampaignId,t.template,t.node))("alertSound","ui_click_default"),o.Bb(1),o.Fb("active",i.activeCommander&&i.activeCommander.id==t.template.id),o.Bb(1),o.jc("ngIf",t.template.conquest_icon),o.Bb(3),o.jc("src",t.template.image?"assets/img/commanders/"+t.template.image+".png":"assets/img/commanders/"+t.template._id+".png",o.Cc),o.Bb(1),o.Fb("alert-caption",i.campaign.progress&&"defence"==i.campaign.progress.phase),o.Bb(1),o.jc("innerHTML",i.L("commander."+(null==t?null:t.template.id)+".name").br(),o.Ac),o.Bb(1),o.jc("ngIf",i.campaign.progress&&"defence"==i.campaign.progress.phase),o.Bb(1),o.jc("ngIf",t.template.availableTypes&&t.template.availableTypes.length),o.Bb(1),o.jc("ngIf",i.campaign.progress&&"attack"==i.campaign.progress.phase)}}function CI(t,e){if(1&t&&(o.Rb(0,"div",8),o.Rb(1,"ul",9),o.Jc(2,II,12,23,"li",10),o.Qb(),o.Qb()),2&t){const t=o.bc().commanders;o.jc("ngClass","commanders"+t.length),o.Bb(2),o.jc("ngForOf",t)}}function LI(t,e){if(1&t&&o.Jc(0,CI,3,2,"div",7),2&t){const t=e.commanders;o.jc("ngIf",t&&t.length)}}function RI(t,e){if(1&t&&(o.Rb(0,"div",41),o.Ob(1,"img",42),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.jc("src","assets/img/conquest/"+t.owner+"_"+t.icon+".svg",o.Cc)}}function OI(t,e){if(1&t&&(o.Rb(0,"span",43),o.Lc(1),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(2);o.Bb(1),o.Nc(" ",e.L("level."+t.level)," ")}}function TI(t,e){if(1&t&&(o.Rb(0,"div",44),o.Ob(1,"img",45),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(2);o.Fb("with-battalions",t.campaignCommanders&&t.campaignCommanders.length),o.jc("ngClass",e.campaign.progress.phase),o.Bb(1),o.jc("src","assets/img/conquest/attack_"+t.owner+".svg",o.Cc)}}function xI(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",49),o.Yb("click",function(){o.zc(t);const e=o.bc(2).$implicit,i=o.bc(2);return i.completeMission(i.activeCampaignId,e._id)}),o.Lc(1," \u2714\ufe0f "),o.Qb()}if(2&t){const t=o.bc(4);o.Fb("disabled",!t.playerIsTeamLeader&&t.userInTeam),o.jc("alertSound","ui_click_default")}}function BI(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",50),o.Yb("click",function(){o.zc(t);const e=o.bc(2).$implicit,i=o.bc(2);return i.completeMission(i.activeCampaignId,e._id,0)}),o.Lc(1," \u274c "),o.Qb()}if(2&t){const t=o.bc(4);o.Fb("disabled",!t.playerIsTeamLeader&&t.userInTeam),o.jc("alertSound","ui_click_default")}}function jI(t,e){if(1&t&&(o.Rb(0,"div",46),o.Rb(1,"div"),o.Rb(2,"small"),o.Lc(3),o.Ob(4,"br"),o.Lc(5),o.Ob(6,"br"),o.Lc(7),o.Qb(),o.Qb(),o.Jc(8,xI,2,3,"button",47),o.Jc(9,BI,2,3,"button",48),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(2);o.Bb(3),o.Nc(" ",t._id,""),o.Bb(2),o.Nc(" ",t.owner,""),o.Bb(2),o.Nc(" ",t.open?"open":"closed"," "),o.Bb(1),o.jc("ngIf",e.hasFlag("debug")&&!t.completed&&t.open),o.Bb(1),o.jc("ngIf",e.hasFlag("debug")&&!t.completed&&t.open)}}function MI(t,e){if(1&t&&o.Ob(0,"img",23),2&t){const t=o.bc(2).$implicit;o.jc("src","assets/img/commanders_conquest/"+t.template.conquest_icon+".svg",o.Cc)}}function QI(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",12),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit;return o.bc(4).toggleActiveCommander(e.template)})("onDragStart",function(){o.zc(t);const e=o.bc().$implicit;return o.bc(4).onDragStart(e)})("onDragEnd",function(){o.zc(t);const e=o.bc().$implicit;return o.bc(4).onDragEnd(e)}),o.Rb(1,"span",13),o.Jc(2,MI,1,1,"img",14),o.Qb(),o.Qb()}if(2&t){const t=o.bc().$implicit,e=o.bc(2).$implicit,i=o.bc(2);o.Fb("disabled",!i.playerIsTeamLeader&&i.userInTeam||"attack"!==i.campaign.progress.phase)("reserved-to",""==i.campaign.progress.commander[t.template.id].node)("reserved-from",""==i.campaign.progress.commander[t.template.id].nodeNext),o.jc("useBounds",!0)("externalData",o.pc(12,SI,i.activeCampaignId,t.template,e._id))("alertSound","ui_click_default"),o.Bb(1),o.Fb("active",i.activeCommander&&i.activeCommander.id==t.template.id),o.Bb(1),o.jc("ngIf",t.template.conquest_icon)}}function AI(t,e){if(1&t&&(o.Rb(0,"div",54),o.Lc(1),o.Qb()),2&t){const t=o.bc(5);o.Bb(1),o.Mc(t.L("meta.ui.campaign.conquest_defence_locked"))}}function DI(t,e){if(1&t&&(o.Rb(0,"div",25),o.Lc(1),o.Qb()),2&t){const t=o.bc(5);o.Bb(1),o.Nc("",t.L("meta.ui.troops.speciality.title"),":")}}function EI(t,e){if(1&t&&(o.Rb(0,"div",26),o.Lc(1),o.Ob(2,"br"),o.Lc(3),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(4);o.Bb(1),o.Nc(" ",e.L("meta.ui.menu.nation."+(null==t.template?null:t.template.army)),""),o.Bb(2),o.Oc(" ",e.L("meta.ui.commander.type."+(null==t.template?null:t.template.type)),", ",e.L("meta.ui.troops.speciality."+(null==t.template?null:t.template.speciality))," ")}}function NI(t,e){if(1&t&&(o.Rb(0,"li",11),o.Jc(1,QI,3,16,"div",52),o.Rb(2,"div",15),o.Rb(3,"figure",16),o.Ob(4,"img",17),o.Qb(),o.Rb(5,"div",18),o.Ob(6,"div",19),o.Jc(7,AI,2,1,"div",53),o.Jc(8,DI,2,1,"div",21),o.Jc(9,EI,4,3,"div",22),o.Qb(),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=o.bc(4);o.Bb(1),o.jc("ngIf",t),o.Bb(3),o.jc("src",t.template.image?"assets/img/commanders/"+t.template.image+".png":"assets/img/commanders/"+t.template._id+".png",o.Cc),o.Bb(2),o.jc("innerHTML",i.L("commander."+(null==t?null:t.template.id)+".name").br(),o.Ac),o.Bb(1),o.jc("ngIf",i.campaign.progress&&"defence"==i.campaign.progress.phase),o.Bb(1),o.jc("ngIf",t.template.availableTypes&&t.template.availableTypes.length),o.Bb(1),o.jc("ngIf",i.campaign.progress&&"attack"==i.campaign.progress.phase)}}function FI(t,e){if(1&t&&(o.Rb(0,"div",51),o.Rb(1,"ul",9),o.Jc(2,NI,10,6,"li",10),o.Qb(),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(2);o.Bb(1),o.Fb("centered",t.campaignCommanders.length>2),o.Bb(1),o.jc("ngForOf",e.commanders.nodes[t._id])}}const PI=function(){return{hover:"ui_hover_default",click:"ui_click_default"}};function UI(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",30),o.Yb("onDrop",function(i){o.zc(t);const n=e.$implicit;return o.bc(2).onDrop(i,n)})("onDetach",function(i){o.zc(t);const n=e.$implicit;return o.bc(2).onDetach(i,n)}),o.Rb(1,"div",31),o.Yb("click",function(i){o.zc(t);const n=e.$implicit,s=o.bc(2);return s.setActiveMission(n,{x:s.getY(n),y:s.getX(n)},i),s.selectMission(n,i)})("contextmenu",function(i){o.zc(t);const n=e.$implicit,s=o.bc(2);return s.setActiveMission(n,{x:s.getY(n),y:s.getX(n)},i),s.selectMission(n,i)}),o.Jc(2,RI,2,1,"div",32),o.Rb(3,"div",33),o.Rb(4,"h3",34),o.Rb(5,"span",35),o.Lc(6),o.Qb(),o.Rb(7,"span",36),o.Lc(8),o.Qb(),o.Jc(9,OI,2,1,"span",37),o.Qb(),o.Jc(10,TI,2,4,"div",38),o.Qb(),o.Qb(),o.Jc(11,jI,10,5,"div",39),o.Jc(12,FI,3,3,"div",40),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Ic("top",i.getY(t)+"px")("left",i.getX(t)+"px"),o.Fb("disabled",i.isMissionDisabledByTeam(t.id))("selected",i.selectedNodeId&&t._id==i.selectedNodeId)("open",t.open)("closed",!t.open)("with-drag",i.isAllowedForDrop(t._id))("without-drag",!i.isAllowedForDrop(t._id))("reserve-disabled",i.dragFromReserve&&"player"!==t.owner),o.kc("tooltip-hint",i.L("meta.mission."+t.id+".desc")),o.jc("ngClass",t.owner),o.Cb("node",t._id),o.Bb(1),o.jc("alertSound",o.mc(29,PI)),o.Bb(1),o.jc("ngIf",t.icon),o.Bb(4),o.Nc(" ",i.L(t&&t.id?"meta.mission."+t.id+".name":"meta.ui.stats.mode.mission")," "),o.Bb(2),o.Nc(" ",i.L(t&&t.id?"meta.mission."+t.id+".name":"meta.ui.stats.mode.mission")," "),o.Bb(1),o.jc("ngIf",t.level),o.Bb(1),o.jc("ngIf",t.open&&i.campaign.progress&&i.campaign.progress.phase),o.Bb(1),o.jc("ngIf",i.hasFlag("debug")),o.Bb(1),o.jc("ngIf",i.commanders.nodes[t._id])}}const zI=function(t){return{commanders:t}};function JI(t,e){if(1&t&&(o.Rb(0,"div",55),o.Pb(1,56),o.Qb()),2&t){const t=e.$implicit;o.bc(2);const i=o.wc(1);o.Cb("node_path",t.key),o.Bb(1),o.jc("ngTemplateOutlet",i)("ngTemplateOutletContext",o.nc(3,zI,t.value))}}function qI(t,e){if(1&t&&(o.Rb(0,"div",27),o.Jc(1,UI,13,30,"div",28),o.Rb(2,"div"),o.Jc(3,JI,2,5,"div",29),o.cc(4,"keyvalue"),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngForOf",t.missionsNode),o.Bb(2),o.jc("ngForOf",o.dc(4,2,t.commanders.moving))}}const VI=.1,$I=.1,GI=(new yl(-.3,.1),new yl(.1,-.5),new yl(-1,0),new yl(1,0),"METAGAME_SELECTED_NODE_"),HI={moving:{},reserve:[],fromReserveToNodes:{},fromNodesToReserve:{},still:{},nodes:{}};let YI=(()=>{class t{constructor(t,e,i,n,s){this.cache=t,this.sanitizer=e,this.notificatorService=i,this.chatService=n,this.host=s,this.activeCampaignId="",this.selectedNodeId="",this.scrollMoveEnd=!1,this.onMissionSelect=new o.o,this.onTreeLoad=new o.o,this.onCommanderSelect=new o.o,this.activeNode=null,this.directArrows=!0,this.math=Math,this.missionsNode=[],this.treeVisible=!0,this.grid={size:new yl(1,1)},this.rect={left:0,right:0,top:0,bottom:0,width:0,height:0},this.gutter=0,this.linesGap=10,this.lineWidth=1,this.coordXMin=0,this.coordYMin=0,this.substrateMissions=[],this._missionsTreePositions=[],this._colors={active:"#D6E1F0",disabled:"#D6E1F0",completed:"#D6E1F0"},this.counters={},this.tutorialHighlitedId="",this.globalEvent=new uu,this.pixelRatio=1,this.detachActive=!1,this.activeCommander=null,this.playerIsTeamLeader=!1,this.userInTeam=!1,this.savedMoves=[],this.arrowFrame={timeout:0,startTime:0,lastTime:0,elapsedTime:0,animationDuration:1e3,delta:0,progress:0},this.lastArrows=[],this.lastCampaignUpdate=null,this.dragFromReserve=!1,this.commanders=JSON.parse(JSON.stringify(HI)),this.allowDrop={},this.maxCommandersInNode=5,this.parseNumberMethod=function(t){return Number(t.toString().replace(/px$/,""))},(new al).data.subscribe(t=>this.L=t),this.unitSize=this.cache.unitSize,window.addEventListener("resize",t=>{wu(()=>{this.updateRects(),this.DrawTree()},10,"mission_tree_rects_delay")}),this.counters=this.cache.getCounters(),this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>{this.counters[t.path]=t.value})}ngOnInit(){this.campaign=this.cache.getCampaign(this.activeCampaignId),this.playerIsTeamLeader=this.cache.isTeamOwner(),this.userInTeam=!(!this.cache.getUserTeamId()||!this.cache.getUserTeamId().length),this.arrowCanvas=this.arrowCanvas.nativeElement,this.canvasDebug=this.canvasDebug.nativeElement,this.ctx=this.canvas.getContext("2d"),this.arrowCtx=this.arrowCanvas.getContext("2d"),this.debugCtx=this.canvasDebug.getContext("2d"),this.updateRects(),this.getMissionsTree(),this._startPseudoRandom(),this.api=this.cache.getAPIUrl(),this.campaignChangeSubscription=this.cache.campaignChange.pipe(We(t=>null!==t)).subscribe(t=>{this.missionsNode.length&&this._updateOwnerMoves()}),this.campaignStartSubscription=this.cache.onCampaignStart.pipe(We(t=>null!==t)).subscribe(t=>{this.lastCampaignUpdate=t,this._startPseudoRandom(),this.getMissionsTree(!0)}),this.teamDataSubscription=this.chatService.teamsData.pipe(We(t=>null!==t)).subscribe(t=>{this.playerIsTeamLeader=this.cache.isTeamOwner(),this.userInTeam=!(!this.cache.getUserTeamId()||!this.cache.getUserTeamId().length)}),this.globalEvent.subscribe(t=>{t&&t.key&&("campaign.map.scroll_end"===t.key&&(this.selectedNodeId=t.data&&t.data.scrolledNodeId&&!this.selectedNodeId.length?t.data.scrolledNodeId:"n00"),"drag_from_reserve_start"===t.key&&(this.dragFromReserve=!0),"drag_from_reserve_end"===t.key&&(this.dragFromReserve=!1))})}ngOnChanges(t){t.scrollMoveEnd&&(this.scrollMoveEnd=t.scrollMoveEnd.currentValue),t.commanderViewActive&&!1===t.commanderViewActive.currentValue&&(this.activeCommander=null)}ngOnDestroy(){this.campaignChangeSubscription&&this.campaignChangeSubscription.unsubscribe(),this.campaignStartSubscription&&this.campaignStartSubscription.unsubscribe(),this.teamDataSubscription&&this.teamDataSubscription.unsubscribe(),this.ownerChangeSusbscription&&this.ownerChangeSusbscription.unsubscribe()}showAttackArrow(){let t=this.arrowCtx,e=this.arrowCanvas.width,i=this.arrowCanvas.height,n=[];const s=1.3,a=this.cache.unitSize.x/s;let r=()=>{if(n[0]){[].slice.call(document.querySelectorAll("[attacking-commanders]")).forEach(t=>{t.classList.remove("active")});for(let t=0;t<n.length;t++){let e=n[t],i=document.querySelector(`[attacking-commanders][node_path=${e.nodeA._id}_${e.nodeB._id}]`),a=(this.getNodePosition(e.nodeA),(t,e,i)=>{let n=this.unitSize.y*s/t.distanceTo(e),a=yl.lerp(t,e,n),r=yl.lerp(t,e,1);i&&(a=yl.lerp(i,e,0),r=yl.lerp(i,e,.8));let o=_u.drawCampaignMapArrow(null,a,r,"#000"),c=yl.lerp(a,r,.5);return yl.lerp(c,o.cross,.4)});if(e.positionC){if(i){let t=a(e.positionA,e.positionB,e.positionC);i.style.top=t.y+"px",i.style.left=t.x+"px"}}else if(i){let t=a(e.positionA,e.positionB);i.style.top=t.y+"px",i.style.left=t.x+"px"}}}};if(this.campaign&&this.campaign.progress&&this.campaign.progress.phase)switch(this.campaign.progress.phase){case"attack":t.clearRect(0,0,e,i);for(let t in this.commanders.moving){let e=this.commanders.moving[t],i=t.split("_")[0],r=t.split("_")[1],o=this.getNodeById(i),c=this.getNodeById(r);if(i&&r&&i!==r)for(let l=0;l<e.length;l++){let u=this.getNodePosition(o),d=this.getNodePosition(c),h=this.unitSize.y*s/u.distanceTo(d);d=u.lerp(d,1-h);let b=null;if(this.commanders.moving[`${r}_${i}`]){let t=u.clone(),e=t.lerp(d,.5);b=t.crossVector(e,u.distanceTo(d)/10).subtract(t).setLength(a).add(t)}n.push({path:t,commanderId:e[l].template.id,nodeA:o,nodeB:c,positionA:u,positionB:d,positionC:b})}}setTimeout(()=>{r()},100);break;case"defence":if(!this.campaign.progress.activeNode){console.warn("Empty activeNode");break}let o,c=this.getNodeById(this.campaign.progress.activeNode),l=this.getNodeById(this.campaign.progress.activeNode).opens,u=this.getNodeById(this.campaign.progress.activeNode).opensBy;for(let t=0;t<l.length;t++)"enemy"===this.getNodeById(l[t]).owner&&(o=this.getNodeById(l[t]));if(!o)for(let t=0;t<u.length;t++)"enemy"===this.getNodeById(u[t]).owner&&(o=this.getNodeById(u[t]));let d=this.getNodePosition(o),h=this.getNodePosition(c),b=this.unitSize.y*s/d.distanceTo(h);n.push({nodeA:o,nodeB:c,positionA:d,positionB:d.lerp(h,1-b)})}if(!n.length)return;let o=()=>{cancelAnimationFrame(this.arrowFrame.timeout),this.arrowFrame={timeout:0,startTime:0,lastTime:0,elapsedTime:0,animationDuration:1e3,delta:0,progress:0}},c=t=>"player"===t.nodeA.owner&&"player"===t.nodeB.owner;this.arrowFrame.timeout&&o();let l=()=>{t.clearRect(0,0,e,i),this.arrowFrame.timeout=requestAnimationFrame(l);let a=Date.now();this.arrowFrame.delta=a-this.arrowFrame.lastTime,this.arrowFrame.lastTime=a,this.arrowFrame.elapsedTime+=this.arrowFrame.delta,this.arrowFrame.progerss=this.arrowFrame.elapsedTime/this.arrowFrame.animationDuration,this.arrowFrame.progerss>=1&&(this.arrowFrame.progerss=1);for(let e=0;e<n.length;e++){let i,a=n[e],r=this.unitSize.y*s/a.positionA.distanceTo(a.positionB);i=yl.lerp(a.positionC?a.positionC:a.positionA,a.positionB,r);let o=yl.lerp(a.positionA,a.positionB,1);_u.drawCampaignMapArrow(t,i,yl.lerp(i,o,ld.easeInQuart(this.arrowFrame.progerss)),"attack"===this.campaign.progress.phase?"#356799":"#ff0000",!c(a),c(a)?{strokePattern:[25*this.pixelRatio,10*this.pixelRatio],lineWidth:7*this.pixelRatio,filled:!0,fgOpacity:[.7,1],sgOpacity:[.7,1],style:ku.Simple}:{lineWidth:.001,filled:!0,fgOpacity:[.5,1]})}1==this.arrowFrame.progerss&&o()};this.arrowFrame.startTime=Date.now(),this.arrowFrame.lastTime=Date.now(),l(),this.lastArrows=n}_startPseudoRandom(){let t=this.campaign&&this.campaign.progress?parseInt(parseInt(this.campaign.progress.id.substr(-4),16).toString().substr(0,4)):0;this.prnd=Math.pseudoRandom(t)}_updateOwnerMoves(){console.warn("Owner change update [Mission tree dynamic]"),this.campaign=this.cache.getCampaign(this.activeCampaignId),this.playerIsTeamLeader=this.cache.isTeamOwner(),this.userInTeam=!(!this.cache.getUserTeamId()||!this.cache.getUserTeamId().length);let t=this.cache.getCampaignTree(this.activeCampaignId),e=["open","completed","owner","map","map_attack","map_deffence"];for(let i=0;i<t.length;i++)e.map(e=>this.missionsNode[i][e]=t[i][e]);this.setCommandersToNodes(),this._selectActiveNode(),this.showAttackArrow(),this.DrawTree()}_selectActiveNode(){if(this.isSlave()){let t=this.cache.getUserTeam();if(t&&t.game&&t.game.option&&t.game.option.map){let e=this.missionsNode.find(e=>e.id===t.game.option.map);e&&this.setActiveMission(e)}}}getMission(t){return this.cache.getMission(t)}getMissionsTree(t=!1){this.activeCampaignId&&(this.missionsNode=[],this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),setTimeout(()=>{this.missionsNode=this.cache.getCampaignTree(this.activeCampaignId);for(let t=0;t<this.missionsNode.length;t++)"n00"!==this.missionsNode[t]._id&&(this.missionsNode[t].rawPosition=this.missionsNode[t].position.clone(),this.missionsNode[t].position.x+=Math.clamp((-.5+this.prnd.next())/2,-.5,.5),this.missionsNode[t].position.y+=Math.clamp((-.5+this.prnd.next())/1.5,-.5,.5),this.missionsNode[t].position.x=Math.clamp(this.missionsNode[t].position.x,0,3.6),this.missionsNode[t].position.y=Math.clamp(this.missionsNode[t].position.y,0,9.1),this.missionsNode[t].campaignCommanders=[],this.missionsNode[t].attackingCommanders=[]);if(this.campaign&&this.campaign.progress&&this.campaign.progress.commander&&this.setCommandersToNodes(),this.grid.size=this.missionsNode.size,this.updateRects(),this.cache.devMode&&console.log(this.missionsNode),this.draggableWrap){let t=!1;this.draggableWrap.scrollToMiddle({node:this.getNodeById(this.getSavedNodeId()),nodes:this.missionsNode},t)}this.onTreeLoad.emit({missionsNode:this.missionsNode}),setTimeout(()=>{setTimeout(()=>{this.treeVisible=!0,this.showAttackArrow(),this.DrawTree()}),this._selectActiveNode()})}))}DrawTree(){this.ctx.clearRect(0,0,this.rect.width,this.rect.height);let t=(t,e)=>!!this.lastArrows.find(i=>i.path===t._id+"_"+e._id||i.path===e._id+"_"+t._id);for(let e=0;e<this.missionsNode.length;e++){let i=this.missionsNode[e];if(i.opens)for(let e=0;e<i.opens.length;e++){let n=this.getNodeById(i.opens[e]),s=this.getNodePosition(i),a=this.getNodePosition(n);_u.drawPoint(this.ctx,s),_u.drawPoint(this.ctx,a),yl.lerp(s,a,.2),yl.lerp(s,a,.8),t(i,n)||_u.drawLine(this.ctx,s,a,{strokePattern:[5*this.pixelRatio,5*this.pixelRatio],color:"#ffffff",opacity:.2,lineWidth:1*this.pixelRatio,forceUseLine:!0})}}}drawCurve(t,e,i){let n,s,a,r,o=t.x>e.x?"left":"right",c=new yl(0,-1).multiply(VI),l=new yl(1,0).multiply(VI),u=new yl(0,1).multiply(VI),d=new yl(-1,0).multiply(VI),h=t.distanceTo(e),b=t.lerp(e,.5),m=Math.random(),p=[t];if("left"===o?(n=b.add((m>.5?c:l).multiply(h)).add(new yl(this.prnd.next(),this.prnd.next()).multiply($I).multiply(h)),s=b.add((m>.5?u:d).multiply(h)).add(new yl(this.prnd.next(),this.prnd.next()).multiply($I).multiply(h))):(n=b.add((m>.5?c:d).multiply(h)).add(new yl(this.prnd.next(),this.prnd.next()).multiply($I).multiply(h)),s=b.add((m>.5?u:l).multiply(h)).add(new yl(this.prnd.next(),this.prnd.next()).multiply($I).multiply(h))),h>window.innerHeight/3){let i=b.distanceTo(t),n=b.lerp(t,.5),s=b.lerp(e,.5);"left"===o?(a=n.add((m>.5?c:l).multiply(i)).add(new yl(this.prnd.next(),this.prnd.next()).multiply(.01).multiply(i)),r=s.add((m>.5?u:d).multiply(i)).add(new yl(this.prnd.next(),this.prnd.next()).multiply(.01).multiply(i))):(a=n.add((m>.5?c:d).multiply(i)).add(new yl(this.prnd.next(),this.prnd.next()).multiply(.01).multiply(i)),r=s.add((m>.5?u:l).multiply(i)).add(new yl(this.prnd.next(),this.prnd.next()).multiply(.01).multiply(i)))}p.push(e),p=_u.randomizePath(p,2,h/5),p=_u.randomizePath(p,7,h/50),this.ctx.lineWidth=16,this.ctx.strokeStyle="#5e6e7f",_u.drawBezierArrayBounded(this.ctx,p,20,20),this.ctx.lineWidth=12,this.ctx.strokeStyle="#3c4651",_u.drawBezierArrayBounded(this.ctx,p,20,20),this.ctx.lineWidth=1}setActiveMission(t,e){t&&(this.selectedNodeId=t._id,e&&e.target&&e.target.closest("button")||(this.onMissionSelect.emit({nodeId:t._id,missionId:t.id,node:t,dynamicTree:!0}),this.activeNode=t,this.saveNodeId()))}saveNodeId(){localStorage.setItem(GI+this.cache.getUserId(),this.selectedNodeId)}getSavedNodeId(){return localStorage.getItem(GI+this.cache.getUserId())}getmissionsNode(){return this.missionsNode}isMissionDisabledByTeam(t){let e=this.cache.getUserTeam();return!!e&&!!this.isSlave()&&e.game&&e.game.option&&e.game.option.map!==t}getNodeById(t){return this.missionsNode.find(e=>e._id==t)}completeMission(t,e,i=1){let n=new Nc;if(t&&e)return Il(`${this.api}&cmd=playerCampaignMarkNodeAsComplete&campaign=${t}&node=${e}&winner=${i}`).then(e=>{this.cache.fetchCampaign(t),n.next(e)}),n}setMoney(t,e,i){t&&Il(`${this.api}&cmd=playerCampaignCurrencySet&campaign=${t}&freeXp=${e}&silver=${i}${this.cache.getTeamLeader()?"&owner="+this.cache.getTeamLeader():""}`).then(n=>{console.log(">>> money response:",n),this.cache.setCampaignCurrency(t,e,i)})}randomizeUnitTree(t,e){if(!t||!e||!e.length)return;let i=`${this.api}&cmd=playerCampaignRandomizeUnitTree&campaign=${t}`;e.map(t=>{let e="";if(t)for(let n in t)e=`&${n}=${t[n]}`,i+=e}),Il(i).then(()=>{this.cache.fetchCampaign(t)})}hasFlag(t){return this.cache.hasFlag(t)}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}selectMission(t,e){if(e&&e.preventDefault(),t&&t.open&&(this.selectedNodeId=t._id,this.cache.devMode&&console.log("Selected mission: ",t.id),this.activeCampaignId)){let e=this.campaign.progress.phase.match(/attack|defence/)?"map_"+this.campaign.progress.phase:"",i=t[e]||t.map||t.id;console.log(t,e,i),this.cache.redirect(["campaigns",this.activeCampaignId,"missions",i])}}isSlave(){return this.cache.getUserTeam()&&!this.cache.isTeamOwner()}updateRects(){this.pixelRatio=window.devicePixelRatio,this.itemWidth=this.rect.width/this.grid.size.x,this.itemHeight=this.rect.height/this.grid.size.y,this.gutter=.5*this.itemHeight,this.rect=this.host.nativeElement.getBoundingClientRect(),this.canvas&&(this.canvas.width=this.rect.width,this.canvas.height=this.rect.height),this.arrowCanvas&&(this.arrowCanvas.width=this.rect.width,this.arrowCanvas.height=this.rect.height),this.canvasDebug&&(this.canvasDebug.width=this.rect.width,this.canvasDebug.height=this.rect.height),this.scrollable&&(this.scrollable.setRects(),this.scrollable.update())}getBoxSize(){this.parseNumberMethod(this.getComputedStyle().width),this.parseNumberMethod(this.getComputedStyle().height);let t=[],e=[],i=[],n=[],s=[];for(let h of this.missionsNode)h&&h.position&&t.push(h.position);if(t.length)for(let h of t)n.push(h.x),s.push(h.y),e.push(Math.floor(h.x)),i.push(Math.floor(h.y));let a=[...new Set(e)].sort(),r=[...new Set(i)].sort(),o=a.length,c=r.length;n.length&&(this.coordXMin=Math.min.apply(null,[...new Set(n)])),s.length&&(this.coordYMin=Math.min.apply(null,[...new Set(s)]));let l=0,u=0;l=this.itemWidth*(o-1)+2*this.gutter,u=this.itemHeight*(c-1)+2*this.gutter;let d=this.host.nativeElement.getBoundingClientRect();return`width: ${d.width}px; height: ${d.height}px;`}getComputedStyle(){let t=getComputedStyle(document.documentElement);return{width:parseInt(t.getPropertyValue("--unit-width")),height:parseInt(t.getPropertyValue("--unit-height"))}}uniqueArray(t){t.filter(function(t,e,i){return i.indexOf(t)==e})}getX(t){return 3*this.gutter+(t.position.x-this.coordXMin)/this.grid.size.x*(this.rect.width-3*this.gutter)}getY(t){return 1.5*this.gutter+(t.position.y-this.coordYMin)/this.grid.size.y*(this.rect.height-this.gutter/3)}getNodePosition(t){return new yl(this.getX(t),this.getY(t))}onDragStart(t){let e=this.getNodeById(t.node);e.opens.map(t=>this.allowDrop[t]=!0),e.opensBy&&e.opensBy.map(t=>this.allowDrop[t]=!0),this.allowDrop[t.node]=!0}onDragEnd(t){this.allowDrop={}}onDrop(t,e){let i=fw.activeDraggable,n=this.getNodeById(e._id);if(console.log(n,i.externalData),e&&i&&n&&(!i||!i.externalData||""!=i.externalData.nodeId||i.externalData.nodeFrom||"player"==n.owner)){if(i&&i.externalData&&i.externalData.nodeFrom)if(this.getNodeById(i.externalData.nodeFrom),n._id==i.externalData.nodeFrom)console.warn("drop on same node");else if(!this.allowDrop[n._id])return void console.warn("drop on node further than one step");if(e.open||"player"===e.owner){let t=i&&i.externalData&&i.externalData.commander?i.externalData.commander:null;if(!t)return;if(n.campaignCommanders&&n.campaignCommanders.length>this.maxCommandersInNode-1)return;this.missionsNode.filter(t=>t.campaignCommanders&&t.campaignCommanders.length).filter(t=>1==t.open).filter(t=>t._id!==t.id),this.savedMoves.push({id:t.id,node:e._id}),this.setMovesRequest(this.savedMoves),this.detachActive=!1}}}setMovesRequest(t){this.cache.setCampaignMoves(this.activeCampaignId,t).subscribe(e=>{let i=e.scriptData.campaign.changes;for(let n of t)this.globalEvent.trigger("on_commander_drag",{node:i.commander[n.id].node,nodeNext:n.node,commanderId:n.id});this.cache.updateCampaignMoves(e.scriptData.campaign.id,i.commander?i:{commander:i}),this.savedMoves=[]},t=>{this.notificatorService.push({response:t,parameters:""}),this.savedMoves=[]})}onDetach(t,e){this.detachActive=!0}createCommandersObject(){let t=JSON.parse(JSON.stringify(HI));for(let e in this.campaign.progress.commander){let i=this.cache.getCommander(e),n=this.campaign.progress.commander[e];n.commanderId=e,n.template=i,n.node&&n.nodeNext&&n.node===n.nodeNext?(t.still[n.node]||(t.still[n.node]=[]),t.still[n.node].push(n)):n.node||n.nodeNext?n.node&&!n.nodeNext?(t.fromNodesToReserve[n.node]||(t.fromNodesToReserve[n.node]=[]),t.fromNodesToReserve[n.node].push(n)):!n.node&&n.nodeNext?(t.fromReserveToNodes[n.nodeNext]||(t.fromReserveToNodes[n.nodeNext]=[]),t.fromReserveToNodes[n.nodeNext].push(n)):n.node&&n.nodeNext&&n.node!==n.nodeNext&&(t.moving[`${n.node}_${n.nodeNext}`]||(t.moving[`${n.node}_${n.nodeNext}`]=[]),t.moving[`${n.node}_${n.nodeNext}`].push(n)):t.reserve.push(n)}for(let e in t.still)t.nodes[e]=(t.nodes[e]||[]).concat(t.still[e]);for(let e in t.fromNodesToReserve)t.nodes[e]=(t.nodes[e]||[]).concat(t.fromNodesToReserve[e]);for(let e in t.fromReserveToNodes)t.nodes[e]=(t.nodes[e]||[]).concat(t.fromReserveToNodes[e]);for(let e in t.fromNodesToReserve)t.reserve=t.reserve.concat(t.fromNodesToReserve[e]);for(let e in t.fromReserveToNodes)t.reserve=t.reserve.concat(t.fromReserveToNodes[e]);this.commanders=t}setCommandersToNodes(){if(this.createCommandersObject(),this.campaign.progress.commander){this.missionsNode.map(t=>t.campaignCommanders=[]),this.missionsNode.map(t=>t.attackingCommanders=[]);for(let t in this.campaign.progress.commander){let e=this.campaign.progress.commander[t].nodeNext,i=this.campaign.progress.commander[t].node;e!=i&&""!==e||this.putCommanderToNode(t,i,!1),e!==i&&""!==e&&""!=i&&this.putCommanderToNode(t,i,!0),e!==i&&""===i&&this.putCommanderToNode(t,e,!1)}}}putCommanderToNode(t,e,i){let n=this.getCommander(t),s=this.missionsNode.find(t=>t._id==e);s&&(i?s.attackingCommanders.indexOf(n)<0&&s.attackingCommanders.push(this.getCommander(t)):s.campaignCommanders.indexOf(n)<0&&s.campaignCommanders.push(this.getCommander(t)))}getCommander(t){return this.cache.getCommander(t)}setActiveCommander(t){this.activeCommander=t&&t.id?t:null,this.onCommanderSelect.emit({commander:t})}toggleActiveCommander(t){t&&this.setActiveCommander(this.activeCommander&&this.activeCommander.id&&this.activeCommander.id==t.id?null:t)}isAllowedForDrop(t){let e=this.getNodeById(t);return this.dragFromReserve?"player"===e.owner&&e.campaignCommanders.length<this.maxCommandersInNode:("player"===e.owner||e.open)&&this.allowDrop[e._id]&&e.campaignCommanders.length<this.maxCommandersInNode}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Er),o.Nb(Uc),o.Nb(Pd),o.Nb(o.m))},t.\u0275cmp=o.Hb({type:t,selectors:[["mission-tree-dynamic"]],viewQuery:function(t,e){if(1&t&&(o.Fc(mI,!0),o.Fc(pI,!0),o.Fc(gI,!0),o.Fc(fI,!0),o.Fc(vI,!0)),2&t){let t;o.vc(t=o.Zb())&&(e.scrollable=t.first),o.vc(t=o.Zb())&&(e.arrowCanvas=t.first),o.vc(t=o.Zb())&&(e.canvasHover=t.first),o.vc(t=o.Zb())&&(e.canvasDebug=t.first),o.vc(t=o.Zb())&&(e.tree=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("tree-visible",e.treeVisible)},inputs:{activeCampaignId:"activeCampaignId",selectedNodeId:"selectedNodeId",scrollMoveEnd:"scrollMoveEnd",draggableWrap:"draggableWrap",commanderViewActive:"commanderViewActive",canvas:"canvas"},outputs:{onMissionSelect:"onMissionSelect",onTreeLoad:"onTreeLoad",onCommanderSelect:"onCommanderSelect"},features:[o.Ab([Pd]),o.zb],decls:9,vars:10,consts:[["attackingCommanders",""],[1,"tree"],["tree",""],["class","tree-inner",4,"ngIf"],["id","arrowCanvas",2,"z-index","5"],["arrowCanvas",""],["canvasDebug",""],["class","attacking-commanders-cover",3,"ngClass",4,"ngIf"],[1,"attacking-commanders-cover",3,"ngClass"],[1,"clear","commander-list-small"],["fade-in","down","class","list-item collapsed",4,"ngFor","ngForOf"],["fade-in","down",1,"list-item","collapsed"],["ngDraggable","commandersDraggable",1,"commander-small",3,"useBounds","externalData","alertSound","click","onDragStart","onDragEnd"],[1,"texture-border"],["image-load","","class","commander-icon",3,"src",4,"ngIf"],[1,"commander-details"],[1,"image-cover"],["image-load","","draggable","false",3,"src"],[1,"caption"],[1,"title",3,"innerHTML"],["class","margin-bottom-small",4,"ngIf"],["class","subtitle",4,"ngIf"],["fade-in","up","class","description",4,"ngIf"],["image-load","",1,"commander-icon",3,"src"],[1,"margin-bottom-small"],[1,"subtitle"],["fade-in","up",1,"description"],[1,"tree-inner"],["c","","ngDroppable","commandersDraggable","class","node-main-wrap",3,"top","left","disabled","tooltip-hint","ngClass","selected","open","closed","with-drag","without-drag","reserve-disabled","onDrop","onDetach",4,"ngFor","ngForOf"],["attacking-commanders","",4,"ngFor","ngForOf"],["c","","ngDroppable","commandersDraggable",1,"node-main-wrap",3,"tooltip-hint","ngClass","onDrop","onDetach"],[1,"mission-cover",3,"alertSound","click","contextmenu"],["class","mission-icon",4,"ngIf"],[1,"title-cover","relative"],[1,"mission-title"],[1,"text"],[1,"hidden-text"],["class","level",4,"ngIf"],["class","attack-icon",3,"ngClass","with-battalions",4,"ngIf"],["class","debug",4,"ngIf"],["class","commanders",4,"ngIf"],[1,"mission-icon"],[3,"src"],[1,"level"],[1,"attack-icon",3,"ngClass"],[1,"icon-image",3,"src"],[1,"debug"],["class","button","tooltip-hint","Mark win",3,"alertSound","disabled","click",4,"ngIf"],["class","button","tooltip-hint","Mark lose",3,"alertSound","disabled","click",4,"ngIf"],["tooltip-hint","Mark win",1,"button",3,"alertSound","click"],["tooltip-hint","Mark lose",1,"button",3,"alertSound","click"],[1,"commanders"],["class","commander-small","ngDraggable","commandersDraggable",3,"useBounds","externalData","disabled","alertSound","reserved-to","reserved-from","click","onDragStart","onDragEnd",4,"ngIf"],["class","margin-bottom-small alert-caption",4,"ngIf"],[1,"margin-bottom-small","alert-caption"],["attacking-commanders",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,e){1&t&&(o.Jc(0,LI,1,1,"ng-template",null,0,o.Kc),o.Rb(2,"div",1,2),o.Jc(4,qI,5,4,"div",3),o.Ob(5,"canvas",4,5),o.Ob(7,"canvas",null,6),o.Qb()),2&t&&(o.Bb(2),o.Fb("active",e.treeVisible),o.Cb("style","background: rgba(0,0,0,0);"+e.getBoxSize(),o.Bc),o.Bb(2),o.jc("ngIf",e.treeVisible),o.Bb(1),o.Fb("active",e.treeVisible),o.Cb("style",e.getBoxSize(),o.Bc),o.Bb(2),o.Fb("active",e.treeVisible),o.Cb("style",e.getBoxSize()+";z-index: 10;",o.Bc))},encapsulation:2}),t})();const WI=["slider"],KI=["scrollable"],XI=["missionTree"],ZI=["missionTreeDynamic"],tC=["draggableWindow"],eC=["rulesModal"];function iC(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",11),o.Rb(1,"button",12),o.Yb("click",function(){return o.zc(t),o.bc(2).goToMain()}),o.Ob(2,"img",13),o.Qb(),o.Rb(3,"button",14),o.Yb("click",function(){return o.zc(t),o.bc(2).goToDebag()}),o.Ob(4,"img",15),o.Qb(),o.Qb()}2&t&&(o.Bb(1),o.jc("alertSound","ui_click_default"),o.Bb(2),o.jc("alertSound","ui_click_default"))}function nC(t,e){if(1&t&&(o.Rb(0,"div",23),o.Rb(1,"div",24),o.Rb(2,"div",25),o.Ob(3,"img",26),o.Qb(),o.Qb(),o.Rb(4,"div",27),o.Rb(5,"h2",28),o.Lc(6),o.Qb(),o.Ob(7,"article",29),o.Qb(),o.Qb()),2&t){const t=o.bc(4);o.kc("tooltip-hint",t.L("meta.hint.campaign.conquest.phase."+t.campaign.progress.phase+".hint").br()),o.Bb(3),o.jc("src","assets/img/conquest/"+t.campaign.progress.phase+".png",o.Cc),o.Bb(3),o.Nc(" ",t.L("meta.ui.campaign.conquest.phase."+t.campaign.progress.phase+".title")," "),o.Bb(1),o.jc("innerHTML",t.L("meta.ui.campaign.conquest.phase."+t.campaign.progress.phase+".desc").br(),o.Ac)}}function sC(t,e){if(1&t&&(o.Rb(0,"div",30),o.Rb(1,"div",31),o.Rb(2,"h3",32),o.Lc(3),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc(4);o.jc("ngClass",t.campaign.progress.phase),o.Bb(3),o.Nc(" ",t.L("win"===t.campaign.progress.phase?"meta.ui.stats.victory":"lose"===t.campaign.progress.phase?"meta.ui.stats.defeat":"meta.ui.stats.draw")," ")}}function aC(t,e){if(1&t&&(o.Rb(0,"div",20),o.Jc(1,nC,8,4,"div",21),o.Jc(2,sC,4,2,"div",22),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.jc("ngIf",t.campaign.progress&&t.campaign.progress.phase&&("attack"==t.campaign.progress.phase||"defence"==t.campaign.progress.phase)),o.Bb(1),o.jc("ngIf",t.campaign.progress&&t.campaign.progress.phase&&("win"==t.campaign.progress.phase||"lose"==t.campaign.progress.phase))}}function rC(t,e){if(1&t&&(o.Rb(0,"scrollable",33,34),o.Ob(2,"article",35),o.Qb()),2&t){const t=o.bc(3);o.jc("height","100%")("bbox",!0)("origin","left"),o.Bb(2),o.jc("innerHTML",t.L("meta.campaign."+t.campaignId+".desc").br(),o.Ac)}}function oC(t,e){if(1&t&&(o.Rb(0,"div",46),o.Lc(1),o.Qb()),2&t){const t=o.bc(5);o.Bb(1),o.Nc(" ",t.L("meta.ui.campaign.conquest_reserve_caption")," ")}}function cC(t,e){if(1&t&&(o.Rb(0,"div",47),o.Lc(1),o.Qb()),2&t){const t=o.bc(5);o.Bb(1),o.Nc(" ",t.L("meta.ui.campaign.conquest_defence_locked")," ")}}function lC(t,e){if(1&t&&o.Ob(0,"img",61),2&t){const t=o.bc(2).$implicit;o.jc("src","assets/img/commanders_conquest/"+t.template.conquest_icon+".svg",o.Cc)}}const uC=function(t,e){return{campaign:t,commander:e,nodeId:""}};function dC(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",58),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit;return o.bc(6).setCommandersView(e.template)})("onDragStart",function(e){return o.zc(t),o.bc(7).onDragStart(e)})("onDragEnd",function(e){return o.zc(t),o.bc(7).onDragEnd(e)}),o.Rb(1,"span",59),o.Jc(2,lC,1,1,"img",60),o.Qb(),o.Qb()}if(2&t){const t=o.bc().$implicit,e=o.bc(6);o.Fb("disabled",!e.playerIsTeamLeader&&e.userInTeam||"attack"!==e.campaign.progress.phase)("reserved-to",""==t.nodeNext&&""!==t.node)("reserved-from",""==t.node&&""!==t.nodeNext),o.jc("externalData",o.oc(11,uC,e.campaignId,t.template))("alertSound","ui_click_default"),o.Bb(1),o.Fb("active",e.isSelectedCommander(t.template.id)),o.Bb(1),o.jc("ngIf",t.template.conquest_icon)}}function hC(t,e){if(1&t&&(o.Rb(0,"div",62),o.Lc(1),o.Qb()),2&t){const t=o.bc(7);o.Bb(1),o.Nc("",t.L("meta.ui.troops.speciality.title"),":")}}function bC(t,e){if(1&t&&(o.Rb(0,"li",50),o.Jc(1,dC,3,14,"div",51),o.Rb(2,"div",52),o.Rb(3,"figure",53),o.Ob(4,"img",54),o.Qb(),o.Rb(5,"div",46),o.Ob(6,"div",55),o.Jc(7,hC,2,1,"div",56),o.Rb(8,"div",57),o.Lc(9),o.Ob(10,"br"),o.Lc(11),o.Qb(),o.Qb(),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=o.bc(6);o.Bb(1),o.jc("ngIf",t),o.Bb(3),o.jc("src",t.template.image?"assets/img/commanders/"+t.template.image+".png":"assets/img/commanders/"+t.template._id+".png",o.Cc),o.Bb(2),o.jc("innerHTML",i.L("commander."+t.template.id+".name").br(),o.Ac),o.Bb(1),o.jc("ngIf",t.template.availableTypes&&t.template.availableTypes.length),o.Bb(2),o.Nc(" ",i.L("meta.ui.menu.nation."+(null==t.template?null:t.template.army)),""),o.Bb(2),o.Oc(" ",i.L("meta.ui.commander.type."+(null==t.template?null:t.template.type)),", ",i.L("meta.ui.troops.speciality."+t.template.speciality)," ")}}function mC(t,e){if(1&t&&(o.Rb(0,"div"),o.Rb(1,"ul",48),o.Jc(2,bC,12,7,"li",49),o.Qb(),o.Qb()),2&t){const t=o.bc(5);o.Bb(2),o.jc("ngForOf",t.missionTreeDynamic.commanders.reserve)}}function pC(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",38),o.Yb("onDrop",function(e){return o.zc(t),o.bc(4).onDrop(e)}),o.Rb(1,"div",39),o.Rb(2,"div",40),o.Rb(3,"div",25),o.Ob(4,"img",26),o.Qb(),o.Qb(),o.Rb(5,"div",27),o.Rb(6,"div",41),o.Rb(7,"h2",42),o.Lc(8),o.Qb(),o.Jc(9,oC,2,1,"div",43),o.Jc(10,cC,2,1,"div",44),o.Jc(11,mC,3,1,"div",45),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc(4);o.kc("tooltip-hint",t.L("meta.ui.campaign.conquest_reserve_help")),o.Bb(4),o.jc("src","assets/img/conquest/reserve.svg",o.Cc),o.Bb(4),o.Mc(t.L("meta.ui.campaign.conquest_reserve")),o.Bb(1),o.jc("ngIf",!t.missionTreeDynamic.commanders.reserve.length&&"attack"==t.campaign.progress.phase),o.Bb(1),o.jc("ngIf","defence"==t.campaign.progress.phase),o.Bb(1),o.jc("ngIf",t.missionTreeDynamic.commanders.reserve&&t.missionTreeDynamic.commanders.reserve.length)}}function gC(t,e){if(1&t&&(o.Rb(0,"div",36),o.Jc(1,pC,12,6,"div",37),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.jc("ngIf",t.campaign.progress&&"win"!==t.campaign.progress.phase&&"lose"!==t.campaign.progress.phase)}}function fC(t,e){if(1&t&&(o.Rb(0,"div",16),o.Jc(1,aC,3,2,"div",17),o.Jc(2,rC,3,4,"scrollable",18),o.Jc(3,gC,2,1,"div",19),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("ngIf",t.isConquestCampaign),o.Bb(1),o.jc("ngIf",!t.isConquestCampaign),o.Bb(1),o.jc("ngIf",t.isConquestCampaign&&t.missionTreeDynamic&&!t.activeCommander)}}function vC(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div"),o.Rb(1,"h4"),o.Lc(2,"Set Currency"),o.Qb(),o.Rb(3,"div",66),o.Rb(4,"div"),o.Rb(5,"div",67),o.Lc(6,"freeXp"),o.Qb(),o.Rb(7,"input",68),o.Yb("ngModelChange",function(e){return o.zc(t),o.bc(3).freeXp=e}),o.Qb(),o.Qb(),o.Rb(8,"div"),o.Rb(9,"div",67),o.Lc(10,"silver"),o.Qb(),o.Rb(11,"input",68),o.Yb("ngModelChange",function(e){return o.zc(t),o.bc(3).silver=e}),o.Qb(),o.Qb(),o.Qb(),o.Rb(12,"div",65),o.Rb(13,"button",69),o.Yb("click",function(){return o.zc(t),o.bc(3).setMoney()}),o.Lc(14," Set currency "),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc(3);o.Bb(7),o.jc("ngModel",t.freeXp),o.Bb(4),o.jc("ngModel",t.silver),o.Bb(2),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip","Set currency")}}function yC(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",65),o.Rb(1,"button",69),o.Yb("click",function(){o.zc(t);const e=o.bc(3);return e.completeMission(e.campaignId,e.activeNode._id)}),o.Lc(2," Complete mission "),o.Qb(),o.Qb()}2&t&&(o.Bb(1),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip","Complete mission"))}function _C(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",63),o.Rb(1,"scrollable",64),o.Jc(2,vC,15,4,"div",45),o.Rb(3,"div",65),o.Rb(4,"h4"),o.Lc(5,"Randomize Unit Tree"),o.Qb(),o.Rb(6,"div",66),o.Rb(7,"div"),o.Rb(8,"div",67),o.Lc(9,"xpLevel"),o.Qb(),o.Rb(10,"input",68),o.Yb("ngModelChange",function(e){return o.zc(t),o.bc(2).xpLevel=e}),o.Qb(),o.Qb(),o.Rb(11,"div"),o.Rb(12,"div",67),o.Lc(13,"openLevel"),o.Qb(),o.Rb(14,"input",68),o.Yb("ngModelChange",function(e){return o.zc(t),o.bc(2).openLevel=e}),o.Qb(),o.Qb(),o.Rb(15,"div"),o.Rb(16,"div",67),o.Lc(17,"amountLevel"),o.Qb(),o.Rb(18,"input",68),o.Yb("ngModelChange",function(e){return o.zc(t),o.bc(2).amountLevel=e}),o.Qb(),o.Qb(),o.Qb(),o.Rb(19,"div",65),o.Rb(20,"button",69),o.Yb("click",function(){return o.zc(t),o.bc(2).randomizeUnitTree()}),o.Lc(21," Randomize "),o.Qb(),o.Qb(),o.Qb(),o.Jc(22,yC,3,2,"div",70),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.Bb(1),o.jc("bbox",!0)("fade",!0)("origin","left"),o.Bb(1),o.jc("ngIf",t.campaign&&t.campaign.currency),o.Bb(8),o.jc("ngModel",t.xpLevel),o.Bb(4),o.jc("ngModel",t.openLevel),o.Bb(4),o.jc("ngModel",t.amountLevel),o.Bb(2),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip","Randomize"),o.Bb(2),o.jc("ngIf",t.hasFlag("debug")&&t.activeNode&&t.activeNode.open&&!t.activeNode.completed)}}function kC(t,e){if(1&t&&(o.Rb(0,"div",7),o.Jc(1,iC,5,2,"div",8),o.Jc(2,fC,4,3,"div",9),o.Jc(3,_C,23,10,"div",10),o.Qb()),2&t){const t=o.bc();o.Fb("with-map",t.isConquestCampaign)("campaign-debug","debug"===t.tab&&t.hasFlag("debug")),o.Bb(1),o.jc("ngIf",t.hasFlag("debug")||t.hasFlag("autotest")),o.Bb(1),o.jc("ngIf","main"===t.tab),o.Bb(1),o.jc("ngIf","debug"===t.tab&&t.hasFlag("debug"))}}function wC(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",75),o.Yb("click",function(e){return o.zc(t),o.bc(2).continuePlay(e)}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(2);o.Fb("disabled",!t.playerIsTeamLeader&&t.userInTeam||t.campaignCompleted),o.kc("tooltip-hint",t.firstMissionToPlay?t.L("meta.mission."+t.firstMissionToPlay+".name"):""),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L(t.campaign.progress?"meta.ui.campaign.continue_play":"meta.ui.campaign.button_start")," ")}}function SC(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",75),o.Yb("click",function(){return o.zc(t),o.bc(2).campaignNextTurn()}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(2);o.Fb("disabled",!t.playerIsTeamLeader&&t.userInTeam),o.kc("tooltip-hint",t.L("meta.hint.play.play")),o.jc("alertSound","ui_game_start"),o.Bb(1),o.Nc(" ",t.canPlayMission()?t.L("meta.ui.campaign.conquest.start_battle"):t.L("meta.ui.campaign.conquest.next_turn")," ")}}function IC(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",76),o.Yb("click",function(){return o.zc(t),o.bc(2).restartCampaign()}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(2);o.Fb("disabled",t.buttonsLocked||!t.controlButtonsEnabled()||!t.playerIsTeamLeader&&t.userInTeam),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.play.restart_button")," ")}}function CC(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",77),o.Yb("click",function(){o.zc(t);const e=o.bc(2);return e.loadSavedGame(e.campaignId)}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(2);o.Fb("disabled",t.buttonsLocked||!t.controlButtonsEnabled()||!t.playerIsTeamLeader&&t.userInTeam),o.kc("tooltip-hint",t.L("meta.hint.play.load_save_button")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.play.load_save_button")," ")}}function LC(t,e){if(1&t&&(o.Rb(0,"div",71),o.Jc(1,wC,2,5,"button",72),o.Jc(2,SC,2,5,"button",72),o.Jc(3,IC,2,4,"button",73),o.Jc(4,CC,2,5,"button",74),o.Qb()),2&t){const t=o.bc();o.Fb("with-map",t.isConquestCampaign),o.Bb(1),o.jc("ngIf",!t.isConquestCampaign),o.Bb(1),o.jc("ngIf",t.isConquestCampaign&&t.campaign&&t.campaign.progress&&t.campaign.progress.phase&&("attack"==t.campaign.progress.phase||"defence"==t.campaign.progress.phase)),o.Bb(1),o.jc("ngIf",t.campaign.progress),o.Bb(1),o.jc("ngIf",t.campaign.progress)}}const RC=function(){return{key:27,zIndex:1}};function OC(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",85),o.Yb("click",function(){return o.zc(t),o.bc(2).unsetActiveCommander()}),o.Rb(1,"span",86),o.Lc(2,"\u2715"),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("meta.ui.store.close")),o.jc("key-duplicator",o.mc(3,RC))("alertSound","ui_click_default")}}function TC(t,e){if(1&t&&(o.Rb(0,"div",78),o.Rb(1,"div",79),o.Rb(2,"div",80),o.Rb(3,"figure",81),o.Ob(4,"img",54),o.Qb(),o.Qb(),o.Ob(5,"commander-details",82),o.Qb(),o.Rb(6,"div",83),o.Jc(7,OC,3,4,"button",84),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(4),o.jc("src",t.activeCommander.image?"assets/img/commanders/"+t.activeCommander.image+".png":"assets/img/commanders/"+t.activeCommander._id+".png",o.Cc),o.Bb(1),o.jc("commander",t.activeCommander)("leftScroll",!0)("editButton",!1),o.Bb(2),o.jc("ngIf",!t.nonClosing)}}function xC(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",87),o.Rb(1,"mission-tree",88,89),o.Yb("onMissionSelect",function(e){return o.zc(t),o.bc().setActiveMission(e)}),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(1),o.jc("activeCampaignId",t.campaignId)}}function BC(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",90),o.Rb(1,"mission-tree-dynamic",91,92),o.Yb("onMissionSelect",function(e){return o.zc(t),o.bc().setActiveMission(e)})("onCommanderSelect",function(e){return o.zc(t),o.bc().onCommanderSelect(e)}),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(1),o.jc("activeCampaignId",t.campaignId)}}function jC(t,e){if(1&t&&(o.Rb(0,"div",117),o.Rb(1,"div",118),o.Ob(2,"span"),o.Lc(3),o.Qb(),o.Qb()),2&t){const t=o.bc(3);o.Bb(3),o.Nc("",t.L("meta.ui.tech.preloader")," ")}}function MC(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",103),o.Rb(1,"div",104,105),o.Yb("onScrollEnd",function(e){return o.zc(t),o.bc(2).onMapScrollEnd(e)}),o.Jc(3,jC,4,1,"div",106),o.Rb(4,"div",107),o.Rb(5,"div",108),o.Ob(6,"img",109),o.Ob(7,"img",110),o.Ob(8,"img",111),o.Ob(9,"img",112),o.Ob(10,"canvas",113,114),o.Qb(),o.Ob(12,"div",115),o.Rb(13,"mission-tree-dynamic",116,92),o.Yb("onMissionSelect",function(e){return o.zc(t),o.bc(2).setActiveMission(e)})("onCommanderSelect",function(e){return o.zc(t),o.bc(2).onCommanderSelect(e)})("onTreeLoad",function(e){return o.zc(t),o.bc(2).setNodesTree(e)}),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.wc(11),e=o.wc(14);o.bc();const i=o.wc(3),n=o.bc();o.Fb("finished",n.campaign.progress&&n.campaign.progress.phase&&("win"===n.campaign.progress.phase||"lose"===n.campaign.progress.phase)),o.Bb(1),o.jc("area","outer")("copyCoordinatesElement",i),o.Bb(2),o.jc("ngIf",!n.scrollMoveEnd),o.Bb(7),o.Fb("active",null==e?null:e.treeVisible),o.Cb("style",null==e?null:e.getBoxSize(),o.Bc),o.Bb(3),o.jc("activeCampaignId",n.campaignId)("scrollMoveEnd",n.scrollMoveEnd)("draggableWrap",n.draggableWindowDirective)("commanderViewActive",n.commanderViewActive)("canvas",t)}}function QC(t,e){if(1&t&&(o.Rb(0,"div",93),o.Rb(1,"div",94),o.Rb(2,"div",95,96),o.Ob(4,"img",97),o.Rb(5,"div",98),o.Rb(6,"h1",99),o.Ob(7,"span",35),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Ob(8,"img",100),o.Rb(9,"div",101),o.Jc(10,MC,15,13,"div",102),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(5),o.Ic("left",t.titleCenteredPosition.x+"px")("top",t.titleCenteredPosition.y+"px"),o.Bb(2),o.jc("innerHTML",t.L("meta.campaign."+t.campaignId+".name").markdown(),o.Ac),o.Bb(3),o.jc("ngIf",t.isConquestCampaign)}}function AC(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",121),o.Yb("click",function(){return o.zc(t),o.bc(2).openRulesModal()}),o.Rb(1,"span",122),o.Ob(2,"img",123),o.Ob(3,"img",124),o.Qb(),o.Rb(4,"span",86),o.Lc(5),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.jc("alertSound","ui_click_default"),o.Bb(5),o.Mc(t.L("meta.ui.mode.rules.button_text"))}}function DC(t,e){if(1&t&&(o.Rb(0,"div",119),o.Jc(1,AC,6,2,"button",120),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf",!t.missionId)}}let EC=(()=>{class t{constructor(t,e,i,n,s){this.cache=t,this.router=e,this.notificatorService=i,this.helpService=n,this.chatService=s,this.userId="",this.globalEvent=new uu,this.counters={},this.campaign=null,this.campaignId="",this.isConquestCampaign=!1,this.tab="main",this.silver=0,this.freeXp=0,this.xpLevel=2,this.openLevel=2,this.amountLevel=2,this.buttonsLocked=!1,this.lastSelectedNodeEvent=null,this.activeCommander=null,this.commanderViewActive=!1,this.mapImageLoaded=!1,this.missionsNode=[],this.selectedNode=null,this.playerIsTeamLeader=!1,this.userInTeam=!1,this.activeMission="",this.firstMissionToPlay="",this.scrollMoveEnd=!1,this.campaignCompleted=!1,this.titleCenteredPosition=new yl,(new al).data.subscribe(t=>this.L=t),this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>{this.counters[t.path]=t.value}),this.cache.confirm.subscribe(t=>{t||(this.buttonsLocked=!1)})}ngOnInit(){this.api=this.cache.getAPIUrl(),this.campaign=this.cache.getGlobalCampaign(),this.playerIsTeamLeader=this.cache.isTeamOwner(),this.userInTeam=!(!this.cache.getUserTeamId()||!this.cache.getUserTeamId().length),this.campaignId=this.campaign?this.cache.getGlobalCampaign().id:"",this.firstMissionToPlay=this.getFirstMissionToPlay(),this.isConquestCampaign=this.campaign&&this.campaign.phase&&this.campaign.phase.length,this.campaign.progress&&this.campaign.progress.money&&(this.silver=this.campaign.progress.money.silver,this.freeXp=this.campaign.progress.money.freeXp),this.cache.campaignChange.pipe(We(t=>null!==t)).subscribe(t=>{t.template===this.campaign.id&&(this.campaign.progress=t),this.firstMissionToPlay=this.getFirstMissionToPlay()}),this.teamDataSubscription=this.chatService.teamsData.pipe(We(t=>null!==t)).subscribe(t=>{this.userInTeam=!(!this.cache.getUserTeamId()||!this.cache.getUserTeamId().length),this.playerIsTeamLeader=this.cache.isTeamOwner()})}ngOnDestroy(){this.teamDataSubscription&&this.teamDataSubscription.unsubscribe()}ngAfterViewChecked(){if(this.missionTreeDynamic){this.scrollMoveEnd=!0;let t=this.missionTreeDynamic.getNodeById("n00");if(t){let e=new yl(this.missionTreeDynamic.getX(t),this.missionTreeDynamic.getY(t));this.titleCenteredPosition.x!==e.x&&(this.titleCenteredPosition=e)}}}onMapImageLoad(t){this.mapImageLoaded=!0}setActiveMission(t){t&&t.missionId&&(t.dynamicTree&&!t.node.open||(this.activeMission=t.missionId))}campaignStart(){this.campaignId&&(this.buttonsLocked=!0,this.cache.campaignStart(this.campaignId,!0).subscribe(t=>{this.cache.updateCounters(),this.globalEvent.trigger("campaign.restart",{campaignId:this.campaignId})},t=>{this.notificatorService.push({response:t,parameters:""}),this.buttonsLocked=!1}))}getTime(t){return new Date(t).parseDate("DD.MM.YYYY")}restartCampaign(){this.buttonsLocked=!0,this.cache.openConfirmModal({key:"meta.ui.campaign.restart_message",confirm:"meta.ui.campaign.restart_confirm",decline:"meta.ui.campaign.restart_decline",title:"meta.ui.campaign.restart_title"},()=>{this.campaignStart()})}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}loadSavedGame(t){t&&(this.buttonsLocked=!0,this.cache.alert("load_game:"+t),setTimeout(()=>{this.buttonsLocked=!1},250))}hasFlag(t){return this.cache.hasFlag(t)}goToMain(){this.tab="main"}goToDebag(){this.tab="debug"}completeMission(t,e){this.missionTree.completeMission(t,e).subscribe(t=>{console.log(this.cache.getCampaignTree(this.campaignId))})}setMoney(){this.isConquestCampaign?this.missionTreeDynamic.setMoney(this.campaignId,this.freeXp,this.silver):this.missionTree.setMoney(this.campaignId,this.freeXp,this.silver)}randomizeUnitTree(){let t=[];this.xpLevel>0&&t.push({xpLevel:this.xpLevel}),this.openLevel>0&&t.push({openLevel:this.openLevel}),this.amountLevel>0&&t.push({amountLevel:this.amountLevel}),this.isConquestCampaign?this.missionTreeDynamic.randomizeUnitTree(this.campaignId,t):this.missionTree.randomizeUnitTree(this.campaignId,t)}allow(t){return this.cache.allow(t)}lockedByClosedNode(){return this.lastSelectedNodeEvent&&this.lastSelectedNodeEvent.dynamic&&!this.lastSelectedNodeEvent.node.open}setCommandersView(t,e){!this.activeCommander||t&&this.activeCommander._id!==t._id?this.setActiveCommander(t):this.unsetActiveCommander()}onCommanderSelect(t){this.setCommandersView(t.commander,!1)}setActiveCommander(t){this.activeCommander=t&&t.id?t:null,this.commanderViewActive=!0}unsetActiveCommander(){this.setActiveCommander(null),this.commanderViewActive=!1}onDrop(t){let e=fw.activeDraggable;if(!e||!e.externalData)return;let i=e.externalData.commander;this.cache.setCampaignMoves(this.campaignId,[{id:i.id,node:""}]).subscribe(t=>{let e=t.scriptData.campaign.changes;this.globalEvent.trigger("on_commander_drag",{commanderId:i.id,nodeNext:"",node:e.commander[i.id].node}),this.cache.updateCampaignMoves(t.scriptData.campaign.id,e.commander?e:{commander:e})},t=>{console.error(t),this.notificatorService.push({response:t,parameters:""})})}setSelectedNode(){let t=this.getSavedNodeId();this.missionsNode&&this.missionsNode.length&&t&&(this.selectedNode=this.missionsNode.find(e=>e._id==t))}setNodesTree(t){this.missionsNode=t.missionsNode,this.setSelectedNode()}getSavedNodeId(){return localStorage.getItem("METAGAME_SELECTED_NODE_"+this.cache.getUserId())}onMapScrollEnd(t){t&&(this.scrollMoveEnd=!0,this.globalEvent.trigger("campaign.map.scroll_end",{campaignId:this.campaignId,scrolledNodeId:t.scrolledNode?t.scrolledNode._id:""}))}isSelectedCommander(t){return!(!this.activeCommander||this.activeCommander._id!=t)}setCommanderAvailableTypes(t){if(t.slot){t.availableTypes=[];let e={};for(let i=0;i<t.slot.length;i++){let n=t.slot[i];for(let s=0;s<t.slot[i].subtype.length;s++){let i=n.subtype[s];i.length&&(e.hasOwnProperty(i)||(e[i]=0),e[i]<n.level&&(e[i]=n.level),t.availableTypes.indexOf(i)<0&&t.availableTypes.push(i))}}}return t}goToMission(t){this.router.navigate(["campaigns/"+this.campaignId+"/missions/"+t],{queryParamsHandling:"merge"})}canPlayMission(){if("attack"==this.campaign.progress.phase)for(let t in this.campaign.progress.commander){let e=this.campaign.progress.commander[t].nodeNext,i=this.missionsNode.find(t=>t._id==e);if(i&&i.owner&&"enemy"==i.owner)return!0}else if("defence"==this.campaign.progress.phase)return this.missionsNode.filter(t=>1==t.open).filter(t=>t.campaignCommanders&&t.campaignCommanders.length).length}campaignNextTurn(){if(this.canPlayMission()){let t="";if("attack"==this.campaign.progress.phase)t=this.getAttackedMission(),this.goToMission(t);else if("defence"==this.campaign.progress.phase){let e=this.missionsNode.filter(t=>1==t.open).filter(t=>t.campaignCommanders&&t.campaignCommanders.length)[0];t=e?e.id:"",this.goToMission(t)}}else this.cache.campaignNextTurn(this.campaignId).subscribe(t=>{this.cache.updateCampaignMoves(this.campaign.progress.id,t.scriptData.campaign.changes),console.log(t)})}getAttackedMission(){let t=null;if(this.campaign.phase&&"attack"==this.campaign.phase)for(let e in this.campaign.progress.commander){let i=this.campaign.progress.commander[e].nodeNext;if(i){let e=this.missionsNode.find(t=>t._id==i);if(e.open&&"enemy"==e.owner)return t=e.id,t}}return t}onDragStart(t){this.triggerGlobalEvent("drag_from_reserve_start")}onDragEnd(t){this.triggerGlobalEvent("drag_from_reserve_end")}openRulesModal(){this.triggerGlobalEvent("conquest_rules_modal.open")}continuePlay(t){this.campaignId&&this.firstMissionToPlay&&(t&&t.preventDefault(),this.campaign.progress&&(this.cache.devMode&&console.log("Selected mission: ",this.firstMissionToPlay),this.cache.redirect(["campaigns",this.campaignId,"missions",this.firstMissionToPlay])))}getFirstMissionToPlay(){if(!this.campaignId||!this.cache.getCampaignTree(this.campaignId))return;let t="",e=this.cache.getCampaignTree(this.campaignId).sort((t,e)=>t.level-e.level).sort((t,e)=>t.position.x-e.position.x).sort((t,e)=>t.position.y-e.position.y).filter(t=>!0===t.open).filter(t=>!t.completed||0==t.completed),i=e.length?e[0]:null;return i?(t=i.map,t):(this.cache.devMode&&console.log("No opened node, campaign completed"),void(this.campaignCompleted=!0))}hostClickHandler(t){t.target.closest(".commanders-tab")||t.target.closest(".commander-list-small")||this.unsetActiveCommander()}controlButtonsEnabled(){return!!this.campaign&&this.cache.allow("tutorial"===this.campaign.category?"tutorial":"campaign."+this.campaign.category)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Ys),o.Nb(Uc),o.Nb(Kd),o.Nb(Pd))},t.\u0275cmp=o.Hb({type:t,selectors:[["campaign-missions"]],viewQuery:function(t,e){if(1&t&&(o.Qc(WI,!0),o.Qc(KI,!0),o.Qc(XI,!0),o.Qc(ZI,!0),o.Qc(tC,!0),o.Qc(eC,!0)),2&t){let t;o.vc(t=o.Zb())&&(e.slider=t.first),o.vc(t=o.Zb())&&(e.scrollable=t.first),o.vc(t=o.Zb())&&(e.missionTree=t.first),o.vc(t=o.Zb())&&(e.missionTreeDynamic=t.first),o.vc(t=o.Zb())&&(e.draggableWindowDirective=t.first),o.vc(t=o.Zb())&&(e.rulesModal=t.first)}},hostVars:4,hostBindings:function(t,e){1&t&&o.Yb("click",function(t){return e.hostClickHandler(t)}),2&t&&o.Fb("grid-default",!0)("with-map",e.isConquestCampaign)},features:[o.Ab([nd,Uc,Kd,Pd])],decls:7,vars:7,consts:[["g-campaign-description","",3,"with-map","campaign-debug",4,"ngIf"],["g-campaign-play-btn","",3,"with-map",4,"ngIf"],["g-campaign-battalion-info","","class","commanders-tab",4,"ngIf"],["g-campaign-tree","",4,"ngIf"],["g-campaign-tree","","class","large",4,"ngIf"],["class","map-wrap",4,"ngIf"],["class","rules-helper",4,"ngIf"],["g-campaign-description",""],["class","debug-buttons",4,"ngIf"],["class","campaign-article",4,"ngIf"],["style","width: 95%; margin: 0 auto; height: 80%; pointer-events: all;",4,"ngIf"],[1,"debug-buttons"],["fade-in","up","tooltip-hint","main",1,"button","spaced-bottom",3,"alertSound","click"],["src","assets/img/icons/svg/arrow_left_white.svg","alt","icon",1,"icon"],["fade-in","up","tooltip-hint","debug",1,"button",3,"alertSound","click"],["src","assets/img/icons/svg/bug.svg","alt","icon",1,"icon"],[1,"campaign-article"],["class","conquest-details",4,"ngIf"],[3,"height","bbox","origin",4,"ngIf"],["class","conquest-reserve",4,"ngIf"],[1,"conquest-details"],["class","row align-middle",3,"tooltip-hint",4,"ngIf"],["class","campaign-result verticaly-middle",3,"ngClass",4,"ngIf"],[1,"row","align-middle",3,"tooltip-hint"],[1,"col-2",2,"padding-right","0","height","100%"],[1,"image-contain",2,"padding","0","height","100%"],[3,"src"],[1,"col-10"],[1,"smaller"],[2,"padding","0",3,"innerHTML"],[1,"campaign-result","verticaly-middle",3,"ngClass"],[1,"inner"],[1,"result-title"],[3,"height","bbox","origin"],["scrollable",""],[3,"innerHTML"],[1,"conquest-reserve"],["class","reserve-place","ngDroppable","commandersDraggable",3,"tooltip-hint","onDrop",4,"ngIf"],["ngDroppable","commandersDraggable",1,"reserve-place",3,"tooltip-hint","onDrop"],[1,"row"],[1,"col-2",2,"padding-right","0"],[1,"battalions-place"],[1,"smaller","reserve-title"],["class","caption",4,"ngIf"],["class","caption spaced-bottom alert-caption",4,"ngIf"],[4,"ngIf"],[1,"caption"],[1,"caption","spaced-bottom","alert-caption"],[1,"clear","commander-list-small","align-left"],["fade-in","down","class","list-item collapsed",4,"ngFor","ngForOf"],["fade-in","down",1,"list-item","collapsed"],["class","commander-small","ngDraggable","commandersDraggable",3,"externalData","alertSound","disabled","reserved-to","reserved-from","click","onDragStart","onDragEnd",4,"ngIf"],[1,"commander-details"],[1,"image-cover"],["image-load","","draggable","false",3,"src"],[1,"title",3,"innerHTML"],["class","subtitle",4,"ngIf"],["fade-in","up",1,"description"],["ngDraggable","commandersDraggable",1,"commander-small",3,"externalData","alertSound","click","onDragStart","onDragEnd"],[1,"texture-border"],["image-load","","class","commander-icon",3,"src",4,"ngIf"],["image-load","",1,"commander-icon",3,"src"],[1,"subtitle"],[2,"width","95%","margin","0 auto","height","80%","pointer-events","all"],[3,"bbox","fade","origin"],[1,"spaced-top"],[1,"grid-half-part"],[1,"subheader-caption"],["type","text",1,"input","small",3,"ngModel","ngModelChange"],["type","button","fade-in","up",1,"button",3,"alertSound","click"],["class","spaced-top",4,"ngIf"],["g-campaign-play-btn",""],["type","button","class","button large",3,"disabled","tooltip-hint","alertSound","click",4,"ngIf"],["type","button","class","button margin-right middle",3,"alertSound","disabled","click",4,"ngIf"],["type","button","class","button middle",3,"alertSound","tooltip-hint","disabled","click",4,"ngIf"],["type","button",1,"button","large",3,"tooltip-hint","alertSound","click"],["type","button",1,"button","margin-right","middle",3,"alertSound","click"],["type","button",1,"button","middle",3,"alertSound","tooltip-hint","click"],["g-campaign-battalion-info","",1,"commanders-tab"],[1,"commander-main"],[1,"commander"],[1,"texture-border","active"],[3,"commander","leftScroll","editButton"],[1,"clear","close-preview"],["class","button white close-large",3,"key-duplicator","tooltip-hint","alertSound","click",4,"ngIf"],[1,"button","white","close-large",3,"key-duplicator","tooltip-hint","alertSound","click"],[1,"text"],["g-campaign-tree",""],[3,"activeCampaignId","onMissionSelect"],["missionTree",""],["g-campaign-tree","",1,"large"],["[]","",3,"activeCampaignId","onMissionSelect","onCommanderSelect"],["missionTreeDynamic",""],[1,"map-wrap"],[1,"backgrounds"],[1,"main-layer"],["dragCoordinatesReceiver",""],["src","assets/img/conquest/map/forest3.svg",1,"forest"],[1,"main-map-title"],["fade-in","up"],["src","assets/img/conquest/map/frame.svg",1,"scale-image"],[1,"smooth-faded-outer"],["class","conquest-map",3,"finished",4,"ngIf"],[1,"conquest-map"],["draggableWindow","",1,"map-cover",3,"area","copyCoordinatesElement","onScrollEnd"],["draggableWindow","draggableWindowDirective"],["class","campaign-preloader",4,"ngIf"],["drag-anchor","",1,"map-image"],[1,"layer-components"],["src","assets/img/conquest/map/bridge.svg",1,"bridge"],["src","assets/img/conquest/map/road.svg",1,"road"],["src","assets/img/conquest/map/water.svg",1,"water"],["src","assets/img/conquest/map/town.svg",1,"town"],["id","canvasLine"],["canvas",""],[1,"grid-overlay"],[3,"activeCampaignId","scrollMoveEnd","draggableWrap","commanderViewActive","canvas","onMissionSelect","onCommanderSelect","onTreeLoad"],[1,"campaign-preloader"],[1,"preloader"],[1,"rules-helper"],["class","button white",3,"alertSound","click",4,"ngIf"],[1,"button","white",3,"alertSound","click"],[1,"icon-group"],["src","assets/img/icons/svg/attention-light.svg","draggable","false",1,"icon","hover-hidden"],["src","assets/img/icons/svg/attention-red.svg","draggable","false",1,"icon","hover-visible"]],template:function(t,e){1&t&&(o.Jc(0,kC,4,7,"div",0),o.Jc(1,LC,5,6,"div",1),o.Jc(2,TC,8,5,"div",2),o.Jc(3,xC,3,1,"div",3),o.Jc(4,BC,3,1,"div",4),o.Jc(5,QC,11,6,"div",5),o.Jc(6,DC,2,1,"div",6)),2&t&&(o.jc("ngIf",!e.isConquestCampaign||!e.activeCommander),o.Bb(1),o.jc("ngIf",!e.isConquestCampaign||!e.activeCommander),o.Bb(1),o.jc("ngIf",e.isConquestCampaign&&e.activeCommander),o.Bb(1),o.jc("ngIf",e.campaign&&"conquest"!==e.campaign.category&&!e.isConquestCampaign),o.Bb(1),o.jc("ngIf",e.campaign&&"conquest"===e.campaign.category&&!e.isConquestCampaign),o.Bb(1),o.jc("ngIf",e.isConquestCampaign),o.Bb(1),o.jc("ngIf",e.isConquestCampaign))},directives:[ee,h_,tp,Zv,Kt,Rh,gw,Zt,Qf,fw,Wr,yo,hc,Hk,ty,bI,YI,$S],encapsulation:2}),t})();const NC=function(t){return{amount:t}};function FC(t,e){if(1&t&&(o.Rb(0,"span",16),o.Lc(1),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(3);o.Fb("disabled",e.getCount(t,!0)<=0),o.kc("tooltip-hint",e.L("meta.ui.troops.unit_available_amount",o.nc(4,NC,e.getCount(t)))),o.Bb(1),o.Mc(e.getCount(t,!0))}}const PC=function(t){return{unit:t}};function UC(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"div",13),o.Rb(2,"unit",14),o.Yb("click",function(){o.zc(t);const i=e.$implicit,n=o.bc(3);return n.setActiveUnit(i),n.setSelectedUnit(i)})("contextmenu",function(i){o.zc(t);const n=e.$implicit;return o.bc(3).delegateSlotCreation(n,i)})("dblclick",function(i){o.zc(t);const n=e.$implicit;return o.bc(3).delegateSlotCreation(n,i)}),o.Qb(),o.Jc(3,FC,2,6,"span",15),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(3);o.Bb(1),o.Fb("active",!!i.selectedUnitId&&t.id===i.selectedUnitId)("disabled",t.collectible&&!i.getCount(t,!0)),o.Cb("slot-unit-id",t.id),o.Bb(1),o.Fb("progress",i.cache.isLoadingProgressRunning(i.slot.id+"_slot_creating")||i.cache.isLoadingProgressRunning(i.slot.id+"_slot_setting")||i.cache.isLoadingProgressRunning(i.slot.id+"_slot_setting_"+t.id)),o.jc("data",t)("enabled",i.getCount(t)>0&&i.slot.parent.commander.available||i.isUnitUnlimited(t))("externalData",o.nc(15,PC,t))("useBounds",!0)("error",i.isEnoughBrInSlot(t)?"":"battleRank")("alertSound","ui_click_default")("campaignId",i.campaignId),o.Bb(1),o.jc("ngIf",!i.isUnitUnlimited(t))}}function zC(t,e){if(1&t&&(o.Rb(0,"div",17),o.Rb(1,"span"),o.Lc(2),o.Qb(),o.Qb()),2&t){const t=o.bc(3);o.Bb(2),o.Mc(t.L("meta.ui.unit.premium_required"))}}function JC(t,e){if(1&t&&(o.Rb(0,"div",20),o.Rb(1,"span",16),o.Lc(2),o.Qb(),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(4);o.Fb("error",e.getCount(t)<=0)("overlay",e.hasCounter("ui.mark.troops.unit_increase_"+t.id)),o.Bb(1),o.kc("tooltip-hint",e.getCount(t)),o.Bb(1),o.Mc(e.getCount(t,!0))}}function qC(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"div",13),o.Rb(2,"unit",18),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(4).setActiveUnit(i)}),o.Qb(),o.Jc(3,JC,3,6,"div",19),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(4);o.Bb(1),o.Cb("slot-unit-id",t.id),o.Bb(1),o.jc("data",t)("highlighted",i.isHighlighted(i.slot,t))("campaignId",i.campaignId)("alertSound","ui_click_default"),o.Bb(1),o.jc("ngIf",i.getCount(t)>0||t.open)}}function VC(t,e){if(1&t&&(o.Rb(0,"ul",8),o.Jc(1,qC,4,6,"li",9),o.cc(2,"closedUnits"),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.jc("ngForOf",o.fc(2,1,t.units,t.changeId,t.freemiumPipeFilter))}}function $C(t,e){if(1&t&&(o.Rb(0,"div",21),o.Rb(1,"span"),o.Lc(2),o.Qb(),o.Qb()),2&t){const t=o.bc(3);o.Bb(2),o.Mc(t.L("meta.ui.unit.closed_units"))}}function GC(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"div",13),o.Rb(2,"unit",18),o.Yb("click",function(){o.zc(t);const i=e.$implicit,n=o.bc(4);return n.setActiveUnit(i),n.setSelectedUnit(i)}),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(4);o.Bb(1),o.Cb("slot-unit-id",t.id),o.Bb(1),o.jc("data",t)("highlighted",i.isHighlighted(i.slot,t))("campaignId",i.campaignId)("alertSound","ui_click_default")}}function HC(t,e){if(1&t&&(o.Rb(0,"ul",8),o.Jc(1,GC,3,5,"li",9),o.cc(2,"closedUnits"),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.jc("ngForOf",o.dc(2,1,t.units))}}function YC(t,e){if(1&t&&(o.Rb(0,"scrollable",5,6),o.Rb(2,"h3",7),o.Lc(3),o.Qb(),o.Rb(4,"ul",8),o.Jc(5,UC,4,17,"li",9),o.cc(6,"openedUnits"),o.Qb(),o.Jc(7,zC,3,1,"div",10),o.cc(8,"closedUnits"),o.Jc(9,VC,3,5,"ul",11),o.cc(10,"closedUnits"),o.Jc(11,$C,3,1,"div",12),o.cc(12,"closedUnits"),o.Jc(13,HC,3,3,"ul",11),o.cc(14,"closedUnits"),o.Qb()),2&t){const t=o.bc(2);o.Fb("collapsed",!t.slot.parent.commander.available),o.jc("bbox",!0)("fade",!0),o.Bb(3),o.Mc(t.L("meta.ui.play.barrack")),o.Bb(2),o.jc("ngForOf",o.fc(6,10,t.units,t.changeId,t.freemiumPipeFilterOpened)),o.Bb(2),o.jc("ngIf",o.fc(8,14,t.units,t.changeId,t.freemiumPipeFilter).length),o.Bb(2),o.jc("ngIf",o.fc(10,18,t.units,t.changeId,t.freemiumPipeFilter).length),o.Bb(2),o.jc("ngIf",o.ec(12,22,t.units,t.changeId).length),o.Bb(2),o.jc("ngIf",o.dc(14,25,t.units).length)}}function WC(t,e){if(1&t&&(o.Rb(0,"div",22),o.Ob(1,"img",23),o.Rb(2,"div",24),o.Lc(3),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.Bb(3),o.Nc(" ",t.L("meta.ui.play.no_units_for_slot").br()," ")}}function KC(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",2),o.Yb("onDrop",function(e){return o.zc(t),o.bc().onDrop(e)}),o.Jc(1,YC,15,27,"scrollable",3),o.Jc(2,WC,4,1,"div",4),o.Qb()}if(2&t){const t=o.bc();o.Cb("data-caption",t.L("meta.ui.unit.drag_here")),o.Bb(1),o.jc("ngIf",t.loaded&&t.units.length),o.Bb(1),o.jc("ngIf",t.loaded&&!t.units.length)}}const XC=function(){return{head:!0,fullDescription:!1,counters:!0,chart:!1}};function ZC(t,e){if(1&t&&(o.Rb(0,"scrollable",28,6),o.Ob(2,"unit-details",29),o.Qb()),2&t){const t=o.bc(2);o.Fb("collapsed",!t.slot.parent.commander.available),o.jc("bbox",!0)("fade",!0),o.Bb(2),o.jc("unit",t.selectedUnit)("campaignId",t.campaignId)("campaignCurrency",t.campaignCurrency)("unitData",o.mc(8,XC))}}function tL(t,e){if(1&t&&(o.Rb(0,"div",30),o.Ob(1,"span",31),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("innerHTML",t.L("meta.ui.troops.details.empty_message").br(),o.Ac)}}function eL(t,e){if(1&t&&(o.Rb(0,"div",25),o.Jc(1,ZC,3,9,"scrollable",26),o.Jc(2,tL,2,1,"div",27),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf",t.selectedUnit),o.Bb(1),o.jc("ngIf",!t.selectedUnit)}}JSON;let iL=(()=>{class t{constructor(t,e){this.cache=t,this.notificatorService=e,this.slot=null,this.units=[],this.loaded=!1,this.details=!1,this.changeId=1e3*Math.random(),this.globalEvent=new uu,this.counters={},this.campaignId="",this.campaignCurrency="",this.onUnitSelect=new o.o,this.selectedUnitId="",this.freemiumPipeFilter=(t=>!this.cache.isFreemiumUnitOpen(t)&&t.open&&!t.premium&&!t.collectible).bind(this),this.freemiumPipeFilterOpened=(t=>this.cache.isFreemiumUnitOpen(t)&&(t.open||t.barrack.available>0)).bind(this),new al,al.instance.data.subscribe(t=>this.L=t)}ngOnInit(){this.slotSubscription=this.cache.slot.pipe(We(t=>null!==t)).subscribe(t=>{this.slot=t,this.loaded=!1,this.selectedUnit=null,console.log("slotSubscription",t),setTimeout(()=>{this.slot&&(this.units=this.cache.getBarrack(null,null,this.campaignId),this.slot.parent.commander.available||this.units.map(t=>t.disabled=!0),this.loaded=!0,console.log(this.units.find(e=>t.unit&&e.id===t.unit.id)),this.setActiveUnitPreview(this.units.find(e=>t.unit&&e.id===t.unit.id)),console.log("barrack untis:",this.units),this.units.map(t=>{t.storePrice=this.cache.getStoreItemPrice(t.id)}))})}),this.unitsTreeSubscription=this.cache.unitsTree.pipe(We(t=>null!==t)).subscribe(t=>{let e=!1,i=t.tree;for(let n=0;n<i.length;n++)if(!i[n].open){e=!0;break}t.patch&&(e?this.units=this.cache.getBarrack(null,null,this.campaignId):this.cache.getBarrack(i.map(t=>t.id),null,this.campaignId).map(t=>{let e=this.units.findIndex((e,i)=>t.id===e.id);this.units.splice(e,1,t),this.triggerGlobalEvent("update.select_unit",{unit:t})})),this.changeId=1e3*Math.random()}),this.slotPatchSubscription=this.cache.slotPatch.pipe(We(t=>null!==t)).subscribe(t=>{t&&(this.slot=t)}),this.counters=this.cache.getCounters(),this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>{this.counters[t.path]=t.value}),this.campaignId&&this.cache.getCampaign(this.campaignId)&&(this.campaignCurrency=this.cache.getCampaign(this.campaignId).currency)}ngOnDestroy(){this.slotSubscription&&this.slotSubscription.unsubscribe(),this.slotPatchSubscription&&this.slotPatchSubscription.unsubscribe(),this.draggableStartSubscription&&this.draggableStartSubscription.unsubscribe(),this.unitsTreeSubscription&&this.unitsTreeSubscription.unsubscribe(),this.selectedUnitId="",this.onUnitSelect.emit(this.selectedUnitId),this.triggerGlobalEvent("troops.select_unit",{unitId:this.selectedUnitId,place:"barrack"})}purchaseUnits(t){t.collectible||(Object(Pc.a)("Warn:","no ("+t.id+") units in barrack. Purchase modal opening..."),this.cache.purchaseUnitsToBarrack(t.id))}setActiveUnitPreview(t){t&&(this.selectedUnitId=t.id,this.selectedUnit=kl.clone(t,{mode:gl.Exchanger,available:!1,open:!0,disabled:!1}))}setActiveUnit(t){this.selectedUnit=null,t&&(this.cache.alertUnit(t.id),setTimeout(()=>{this.setActiveUnitPreview(t)}))}setSelectedUnit(t){t&&(this.selectedUnitId=t.id,this.onUnitSelect.emit(this.selectedUnitId),this.triggerGlobalEvent("troops.select_unit",{unitId:this.selectedUnitId,place:"barrack"}))}isHighlighted(t,e){return this.selectedUnit?e.id===this.selectedUnit.id:!!t&&t.unit&&t.unit.id===e.id}goToBarrack(){this.details=!1}goToDetails(){}getCount(t,e=!1){if(!t)return 0;let i=t.barrack.available*t.amount.multiplier;return this.cache.isUnitUnlimited(t,this.slot.parent.commander)&&(i=999999999999),e?Math.min(Math.max(i,0),99):Math.max(i,0)}isEnoughBrInSlot(t,e=!1){return this.slot.unit&&this.slot.unit.id!==t.id&&(e=!0),this.slot.parent.getRemainingBattleRank(e?this.slot.id:"")>=t.modifyRank}createOrSetSlot(t,e){if(!this.slot.parent.commander.available)return;let i=!(!e||!e.ctrlKey)||pd.getKey("Control")||pd.getKey("17");if(!t.open&&this.getCount(t)<=0)return e&&e.preventDefault(),this.notificatorService.push({textError:this.L("meta.ui.open_troop.open_unit_in_tree_message")}),void Object(Pc.a)("Warn:","unit ("+t.id+") is not open in tree, but truying to put in slot");if(this.getCount(t)<=0&&!this.cache.isUnitUnlimited(t,this.slot.parent.commander))return this.purchaseUnits(t),void(e&&e.preventDefault());if(e){if(e.preventDefault(),!this.isEnoughBrInSlot(t,!0))return Object(Pc.a)("Warn:",`no available space in slot for ${t.id} unit`),void this.notificatorService.push({textError:"meta.ui.error.echelon_overflow",textErrorParameters:{echelon:'"'+this.L("meta.ui.play.echelon_"+(this.slot.parent.index+1))+'"'}});if(this.slot.isLimitReached()&&this.slot.unit&&t.id===this.slot.unit.id)return this.notificatorService.push({textError:"meta.ui.error.echelon_amount_overflow",textErrorParameters:{max:" "+this.slot.unit.amount.limit,unit:this.L("unit."+this.slot.unit.id+".short")}}),void Object(Pc.a)("Warn:",`slot ${t.id} reached it's amount`);if(this.slot.unit)this.increaseOrReplase(t,e);else{let n=this.slot;this.cache.startLoadingProgress(n.id+"_slot_creating"),this.slotCreate(t).subscribe(()=>{this.animateUnitDrop(e,t).subscribe(t=>{t?t.done&&(this.cache.stopLoadingProgress(n.id+"_slot_creating"),i&&n.increaseMaximum()):this.cache.stopLoadingProgress(n.id+"_slot_creating")})},t=>{this.cache.stopLoadingProgress(n.id+"_slot_creating"),this.notificatorService.push({textError:t,textErrorParameters:{echelon:'"'+this.L("meta.ui.play.echelon_"+(n.parent.index+1))+'"'}})})}}else this.increaseOrReplase(t,e)}increaseOrReplase(t,e){let i=e?e.ctrlKey:pd.getKey("Control")||pd.getKey("17");this.slot.unit.id===t.id?(this.cache.startLoadingProgress(this.slot.id+"_slot_setting_"+t.id),this.slot.canBeIncreased()&&this.slot.parent.getRawRemainingBattleRank()>=this.slot.unit.modifyRank?this.animateUnitDrop(e,t).subscribe(e=>{e.done&&(this.cache.stopLoadingProgress(this.slot.id+"_slot_setting_"+t.id),this.cache.alertSound("ui_barrack_out"),i?this.slot.increaseMaximum():this.slot.increase())}):(Object(Pc.a)("Warn:",`no available space in slot for ${t.id} unit`),this.cache.stopLoadingProgress(this.slot.id+"_slot_setting_"+t.id),this.notificatorService.push({textError:"meta.ui.error.echelon_overflow",textErrorParameters:{echelon:'"'+this.L("meta.ui.play.echelon_"+(this.slot.parent.index+1))+'"'}}))):(this.cache.startLoadingProgress(this.slot.id+"_slot_setting"),this.cache.slotSet(this.slot,t,this.campaignId).subscribe(()=>{this.cache.stopLoadingProgress(this.slot.id+"_slot_setting"),this.animateUnitDrop(e,t).subscribe(e=>{e.done&&(this.cache.alertSound("ui_barrack_out"),this.setActiveUnit(t))})},t=>{this.cache.stopLoadingProgress(this.slot.id+"_slot_setting"),this.notificatorService.push({textError:t,textErrorParameters:{echelon:'"'+this.L("meta.ui.play.echelon_"+(this.slot.parent.index+1))+'"'}})}))}slotCreate(t,e){return this.cache.slotCreate(this.slot,t,this.campaignId)}onDrop(t){let e=fw.activeDraggable;if(e&&e.externalData.slot){let t=e.externalData.slot;this.cache.startLoadingProgress(t.id+"_slot_reset"),this.cache.slotReset(t).subscribe(()=>{this.cache.stopLoadingProgress(t.id+"_slot_reset"),this.cache.alertSound("ui_barrack_in"),t.reset()},t=>{this.cache.stopLoadingProgress(this.slot.id+"_slot_reset")})}}animateUnitDrop(t,e){let i=t.target.closest("unit"),n=document.querySelector(`[slot-id="${this.slot.id}"]`);return i&&n?new ud(e,200).animate(i,n):new ke(null)}hasCounter(t){return this.cache.hasCounter(t)}delegateSlotCreation(t,e){e&&e.preventDefault(),wu(()=>{this.createOrSetSlot(t,e)},300,"delegateSlotCreation")}void(){}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}isUnitUnlimited(t){return this.cache.isUnitUnlimited(t,this.slot.parent.commander)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Uc))},t.\u0275cmp=o.Hb({type:t,selectors:[["barrack"]],inputs:{campaignId:"campaignId"},outputs:{onUnitSelect:"onUnitSelect"},features:[o.Ab([nd])],decls:2,vars:2,consts:[["style","height:100%;","ngDroppable","fromSlotToBarrack",3,"onDrop",4,"ngIf"],["style","height:100%;","class","spaced-top",4,"ngIf"],["ngDroppable","fromSlotToBarrack",2,"height","100%",3,"onDrop"],["fade-in","",3,"bbox","fade","collapsed",4,"ngIf"],["class","alert",4,"ngIf"],["fade-in","",3,"bbox","fade"],["scrollable",""],[1,"echelon-title"],[1,"echelon-list","spaced"],[4,"ngFor","ngForOf"],["class","subheader2 lined primary",4,"ngIf"],["class","echelon-list spaced",4,"ngIf"],["class","subheader2 lined",4,"ngIf"],[1,"wrapper"],["ngDraggable","fromBarrackToSlot",3,"data","enabled","externalData","useBounds","error","alertSound","campaignId","click","contextmenu","dblclick"],["class","counter",3,"tooltip-hint","disabled",4,"ngIf"],[1,"counter",3,"tooltip-hint"],[1,"subheader2","lined","primary"],[3,"data","highlighted","campaignId","alertSound","click"],["class","calculator-panel",3,"error","overlay",4,"ngIf"],[1,"calculator-panel"],[1,"subheader2","lined"],[1,"alert"],["src","assets/img/icons/svg/win.svg","draggable","false",1,"icon","larger"],[1,"text"],[1,"spaced-top",2,"height","100%"],[3,"bbox","fade","collapsed",4,"ngIf"],["class","alert","fade-in","",4,"ngIf"],[3,"bbox","fade"],["fade-in","",3,"unit","campaignId","campaignCurrency","unitData"],["fade-in","",1,"alert"],[3,"innerHTML"]],template:function(t,e){1&t&&(o.Jc(0,KC,3,3,"div",0),o.Jc(1,eL,3,2,"div",1)),2&t&&(o.jc("ngIf",!e.details),o.Bb(1),o.jc("ngIf",e.details))},encapsulation:2}),t})();const nL=new Bc(Oc);function sL(t){return!Object(we.a)(t)&&t-parseFloat(t)+1>=0}function aL(t){const{index:e,period:i,subscriber:n}=t;if(n.next(e),!n.closed){if(-1===i)return n.complete();t.index=e+1,this.schedule(t,i)}}const rL=["canvasImage"];function oL(t,e){1&t&&o.Ob(0,"img",7),2&t&&o.jc("src","assets/img/liga/"+e.$implicit+".svg",o.Cc)}function cL(t,e){if(1&t&&(o.Rb(0,"span"),o.Jc(1,oL,1,1,"img",6),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngForOf",t.league[t.player.league].images)}}function lL(t,e){if(1&t&&o.Ob(0,"img",8),2&t){const t=o.bc();o.Fb("top",!t.player.commander&&!t.player.league||!t.player.commander&&"recruit"==t.player.league),o.jc("src",t.player&&t.player.league&&t.league[t.player.league]&&t.league[t.player.league].golden?"assets/img/liga/gold.svg":"assets/img/liga/silver.svg",o.Cc)}}function uL(t,e){if(1&t&&o.Ob(0,"img",10),2&t){const t=o.bc(2);o.Fb("bottom",!t.player.commander&&!t.player.league||!t.player.commander&&"recruit"==t.player.league)("suitable",t.avatar&&t.avatar.portrait&&t.avatar.portrait.length&&!t.player.commander),o.jc("src",t.player.commander?"assets/img/liga/"+t.player.commander+".svg":t.avatar&&t.avatar.portrait?"assets/img/portraits/"+t.avatar.portrait+".png":"assets/img/liga/user.svg",o.Cc)}}function dL(t,e){if(1&t&&(o.Rb(0,"span"),o.Jc(1,uL,1,5,"img",9),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf",!t.player.default&&!t.leagueOnly)}}function hL(t,e){if(1&t&&(o.Rb(0,"span",11),o.Ob(1,"img",12),o.Ob(2,"img",13),o.Ob(3,"img",14),o.Qb()),2&t){const t=o.bc();o.Fb("top",t.league[t.player.league].defaultBottom)}}function bL(t,e){if(1&t&&(o.Rb(0,"span"),o.Ob(1,"img",15),o.Ob(2,"img",16),o.Ob(3,"img",17),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("src","assets/img/portraits/deluxe_oreol_"+t.avatar.wreath+".svg",o.Cc),o.Bb(1),o.jc("src","assets/img/portraits/deluxe_wreath_"+t.avatar.wreath+".svg",o.Cc),o.Bb(1),o.jc("src","assets/img/portraits/deluxe_tape_"+t.avatar.wreath+".svg",o.Cc)}}function mL(t,e){if(1&t&&(o.Rb(0,"div",18),o.Ob(1,"img",19),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("src","offline"==t.player.onlineStatus?"assets/img/icons/svg/status_hidden.svg":"assets/img/icons/svg/status_"+t.player.onlineStatus+".svg",o.Cc)}}let pL=()=>parseFloat((window.innerWidth/1920).toFixed(1))*window.devicePixelRatio,gL=(()=>{class t{constructor(t){this.host=t,this.animated=!1,this.player={displayName:""},this.leagueOnly=!1,this.avatar={},this.isCustom=!1,this.localizator=new al,this.height=null,this.width=null,this.league={top1:{images:["stripe2","stripe2a","star3"],animation:!0,bgColors:["rgba(255,189,75,0)","rgba(255,189,75,1)","rgba(255,189,75,0)"],fgColors:["rgba(255,255,255,0)","rgba(255,255,255,.5)","rgba(255,255,255,0)"],golden:!0,defaultBottom:!1},top2:{images:["stripe2","stripe2a","star3"],animation:!0,bgColors:["rgba(255,255,255,0)","rgba(255,255,255,.5)","rgba(255,255,255,0)"],fgColors:["rgba(249,249,249,0)","rgba(249,249,249,.5)","rgba(249,249,249,0)"],golden:!0,defaultBottom:!1},top3:{images:["stripe2","stripe2a","star3"],animation:!1,golden:!0,defaultBottom:!1},legend:{images:["stripe2","star3"],animation:!1,golden:!0,defaultBottom:!1},elite:{images:["stripe2","star2"],animation:!1,golden:!0,defaultBottom:!1},veteran:{images:["stripe1","star1"],animation:!1,golden:!0,defaultBottom:!0},regular:{images:["stripe1"],animation:!1,golden:!1,defaultBottom:!0},recruit:{animation:!1,golden:!1,defaultBottom:!0}},this.config={pixelRatio:pL(),color:"#d59f49",lineWidth:1,segments:64,segmentsPadding:1.8,innerRadiusCoef:0,outerRadiusCoef:1,gradientSpeed:4,shadowSize:5,shadowColor:"rgba(0,0,0,0.7)",gradientMidpoint:.65,gradientWidth:.35,responsive:{512:{segments:64,shadowSize:10,fontIndex:10,segmentsPadding:1.8},256:{segments:64,shadowSize:6,fontIndex:5,segmentsPadding:1.8},128:{segments:64,shadowSize:3,fontIndex:3,segmentsPadding:1.8},64:{segments:32,shadowSize:1,fontIndex:1,segmentsPadding:3.6}}},this.fontSize="",this.radialOffset=0,this.xn=0,this.pixelRatio=1,this.did=0,this.localizator.data.subscribe(t=>this.L=t)}static globalRender(e=!1){e&&t.isGlobalAnimationRunning||(t.instances.filter(t=>t.animated).length?(t.isGlobalAnimationRunning=!0,t.instances.map(t=>{t.animated&&t.render()}),requestAnimationFrame(t.globalRender.bind(t,!1))):t.isGlobalAnimationRunning=!1)}ngOnInit(){this.did=t.did,t.did++,t.instances.push(this),this.canvas=this.canvasImage.nativeElement,this.ctx=this.canvas.getContext("2d"),this.setSize(),this.maskBoxSize=_u.getBoxInCircle(this.width),this.animated?t.globalRender(!0):this.render(),this.createPlayerTooltip(this.player),this.player&&this.player.avatar&&this.bindAvatar(this.player.avatar)}ngAfterContentChecked(){if(this.canvas){let t=this.canvas.getBoundingClientRect();Math.floor(t.width*window.devicePixelRatio)!==Math.floor(this.width)&&(this.setSize(),this.render())}}ngOnDestroy(){let e=t.instances.findIndex(t=>t.did===this.did);t.instances.splice(e,1),t.isGlobalAnimationRunning=!1}ngOnChanges(t){this.render(),t.player&&t.player.currentValue&&t.player.previousValue&&this.bindAvatar(t.player.currentValue.avatar)}onResize(t){this.setSize(),this.render()}setSize(){let t=this.canvas.getBoundingClientRect();this.config.pixelRatio=pL(),this.config.lineWidth=this.config.lineWidth*this.config.pixelRatio,this.width=t.width*window.devicePixelRatio,this.height=t.height*window.devicePixelRatio,this.canvas.width=this.width,this.canvas.height=this.height,this.config.segments=this.countSegments(),this.config.segmentsPadding=this.countSegmentsPadding(),this.config.gradientSpeed=this.countgradientSpeed(),this.config.shadowSize=this.setShadowSize(),this.fontSize=this.setFontSize()}getResponsiveClosestSize(){let t=this.width;var e=[];return Object.keys(this.config.responsive).forEach(function(t){e.push(parseInt(t))}),e.reduce(function(e,i){return t>e&&t<=i?i:e})}countSegments(){let t=this.getResponsiveClosestSize();return this.config.responsive[t].segments}countSegmentsPadding(){let t=this.getResponsiveClosestSize();return this.config.responsive[t].segmentsPadding}countgradientSpeed(){return(this.width*this.config.outerRadiusCoef-this.width*this.config.innerRadiusCoef)/1e3*this.config.gradientSpeed}setShadowSize(){let t=this.getResponsiveClosestSize();return this.config.responsive[t].shadowSize*this.config.pixelRatio}setFontSize(){this.getResponsiveClosestSize();let t=window.innerWidth/1920;return Math.floor(this.width/4)*t/this.config.pixelRatio+"px"}render(){if(!this.player||!this.player.league||!this.ctx)return;let t=this.league[this.player.league];if(!t)return;if(this.ctx.clearRect(0,0,this.width,this.height),!t.animation)return;this.ctx.globalCompositeOperation="source-over";let e=this.width/2,i=this.height/2,n=new yl(e,i),s=this.width/2*this.config.innerRadiusCoef,a=this.width/2*this.config.outerRadiusCoef,r=360/this.config.segments,o=()=>{for(let t=0;t<this.config.segments;t++){let n=r*t+this.config.segmentsPadding/2,o=r*(t+1)-this.config.segmentsPadding/2;_u.drawDonutSegment(this.ctx,new yl(e,i),s,a,n,o)}};this.ctx.fillStyle=_u.createRadialGradient(this.ctx,t.bgColors,null,null,null,this.config.gradientWidth,this.config.gradientMidpoint),o(),this.ctx.fillStyle=this.makeRadialGradient(e,i,a),o(),this.ctx.globalCompositeOperation="destination-in",_u.drawStarMask(this.ctx,n,this.maskBoxSize),this.ctx.globalCompositeOperation="source-over",(new yl).scaleAroundPivot(n,1),new yl(this.width,this.height).scaleAroundPivot(new yl,1)}makeRadialGradient(t,e,i){let n=this.league[this.player.league],s=this.width/2*this.config.outerRadiusCoef-this.width/2*this.config.innerRadiusCoef;this.radialOffset+=this.config.gradientSpeed,this.radialOffset>2*i&&(this.radialOffset=0);let a=Math.max(0,this.radialOffset-s);return this.radialOffset<=0?_u.createRadialGradient(this.ctx,new Array(3).fill("transparent"),null,null,null,this.config.gradientWidth,this.config.gradientMidpoint):_u.createRadialGradient(this.ctx,n.fgColors,null,a,this.radialOffset,.1,this.config.gradientMidpoint)}createPlayerTooltip(t){if(!t)return;let e=t.rank?t.rank.new-t.rank.old:"";e=e>0?"+"+e.cat():""+e.cat();let i=t.rank&&e?this.L("meta.hint.profile.rank")+": "+t.rank.new.cat()+" ("+e+")":"",n=t.displayName&&t.displayName.length?t.displayName:"",s=(t.commander&&this.L("meta.ui.tech.filter."+t.commander),t.default?"":t.league?this.L("meta.ui.league."+t.league+".name"):""),a=t.default?this.L("meta.ui.league."+t.league+".league_rules"):"",r=`<b style="color:white">${n.nickname().name}</b><div>${i}</div><div>${s}</div><div>${a}</div>`;t.bot||(t.tooltip=r)}bindAvatar(t){t&&(t.wreath&&(this.avatar.wreath=t.wreath),t.portrait&&(this.avatar.portrait=t.portrait),this.isCustom=this.avatar.wreath&&"league"!=this.avatar.wreath)}}return t.did=0,t.instances=[],t.isGlobalAnimationRunning=!1,t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m))},t.\u0275cmp=o.Hb({type:t,selectors:[["user-image"]],viewQuery:function(t,e){if(1&t&&o.Fc(rL,!0),2&t){let t;o.vc(t=o.Zb())&&(e.canvasImage=t.first)}},hostVars:2,hostBindings:function(t,e){1&t&&o.Yb("resize",function(t){return e.onResize(t)},!1,o.yc),2&t&&o.Ic("font-size",e.fontSize)},inputs:{animated:"animated",player:"player",leagueOnly:"leagueOnly"},features:[o.zb],decls:8,vars:8,consts:[[1,"canvas"],["canvasImage",""],[4,"ngIf"],["alt","golden","image-load","false","class","league-wreath",3,"src","top",4,"ngIf"],["class","default-icons",3,"top",4,"ngIf"],["class","status-icon",4,"ngIf"],["alt","icons","image-load","",3,"src",4,"ngFor","ngForOf"],["alt","icons","image-load","",3,"src"],["alt","golden","image-load","false",1,"league-wreath",3,"src"],["alt","user","image-load","","class","user-icon",3,"src","bottom","suitable",4,"ngIf"],["alt","user","image-load","",1,"user-icon",3,"src"],[1,"default-icons"],["src","assets/img/liga/shield.svg",1,"shield"],["src","assets/img/liga/sword_l.svg",1,"sword-left"],["src","assets/img/liga/sword_r.svg",1,"sword-right"],["image-load","",1,"oreol",3,"src"],["image-load","",1,"wreat",3,"src"],["image-load","",1,"tape",3,"src"],[1,"status-icon"],["draggable","false",3,"src"]],template:function(t,e){1&t&&(o.Ob(0,"canvas",0,1),o.Jc(2,cL,2,1,"span",2),o.Jc(3,lL,1,3,"img",3),o.Jc(4,dL,2,1,"span",2),o.Jc(5,hL,4,2,"span",4),o.Jc(6,bL,4,3,"span",2),o.Jc(7,mL,2,1,"div",5)),2&t&&(o.Fb("hidden",e.isCustom),o.Bb(2),o.jc("ngIf",e.player&&e.player.league&&e.league[e.player.league]&&e.league[e.player.league].images&&e.league[e.player.league].images.length>0&&!e.isCustom),o.Bb(1),o.jc("ngIf",e.player&&(e.leagueOnly||!e.isCustom)),o.Bb(1),o.jc("ngIf",e.player),o.Bb(1),o.jc("ngIf",e.player&&e.player.default),o.Bb(1),o.jc("ngIf",e.isCustom),o.Bb(1),o.jc("ngIf",e.player&&null!=e.player.onlineStatus))},directives:[ee,Zt,Qf],encapsulation:2}),t})();function fL(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",5),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(2).goTo(i)}),o.Lc(1),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Fb("active",t===i.currentIndex),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Mc(t)}}function vL(t,e){if(1&t&&(o.Rb(0,"div",2),o.Rb(1,"nav"),o.Rb(2,"ul",3),o.Jc(3,fL,2,4,"li",4),o.Qb(),o.Ob(4,"span"),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(3),o.jc("ngForOf",t.length.toArray()),o.Bb(1),o.Eb("dot p",t.currentIndex,"")}}const yL=["*"];let _L=(()=>{class t{constructor(t,e){this.host=t,this.sanitizer=e,this.items=1,this.controls=!1,this.fadingSides=!1,this.length=1,this.mode="slide",this.currentIndex=0,this.padding=0,this.slideTimeout=1e3,this.onSliderTranslate=new o.o,this.onSliderInit=new o.o,this.noTransition=!1,this.initialized=!1,this.slides=[],this.fakes=[],this.slidesRects=[],this.offset=0,this.direction=0,this.intervalTimer=null}ngOnInit(){setTimeout(()=>{this.setRects(),this.noTransition=!1,this.initialized=!0,this.onSliderInit.emit(this),"fade"===this.mode&&this.processFadingSlide()},100)}setRects(){let t=[];for(let n=0;n<this.slides.length;n++){var e=this.slides[n].nativeElement.parentNode,i=e.getBoundingClientRect();t.push({element:e,bbox:i})}this.slidesRects=t}prev(){this.currentIndex>0&&(this.currentIndex--,this.direction=-1,this.onSliderTranslate.emit(this))}next(){this.currentIndex<this.length-1?(this.currentIndex++,this.direction=1,this.onSliderTranslate.emit(this)):"fade"===this.mode&&(this.currentIndex=0)}goTo(t,e){t>=0&&t<=this.length-1?(e&&(this.noTransition=!0,setTimeout(()=>{this.noTransition=!1})),this.direction=this.currentIndex>t||this.currentIndex<t?-1:0,this.currentIndex=t,"fade"===this.mode&&this.processFadingSlide(),this.onSliderTranslate.emit(this)):console.warn("Slider :: new index is not in range.")}processFadingSlide(){let t=()=>[].slice.call(this.host.nativeElement.querySelectorAll(".slider-item"));t().map(t=>t.classList.remove("active")),t()[this.currentIndex].classList.add("active"),this.intervalTimer&&clearTimeout(this.intervalTimer),this.intervalTimer=setTimeout(()=>{this.next(),this.processFadingSlide()},this.slideTimeout)}getTransform(){if("slide"==this.mode||"short"==this.mode)return"translate3d(-"+this.currentIndex*("short"==this.mode?50:100)+"%,0,0)";if("auto"==this.mode){let t=0,e=(Math.min(this.currentIndex+Math.max(0,this.direction),this.length+1),this.host.nativeElement.getBoundingClientRect(),this.isInViewport(this.currentIndex,!0));return this.slides.map((e,i)=>{var n=e.nativeElement.closest(".slider-item").getBoundingClientRect();this.isInViewport(i),i<this.currentIndex&&(t+=n.width)}),e||(this.offset=t),`translate3d(-${this.offset}px,0,0)`}return""}isInViewport(t,e=!1){if(!this.host||!this.slides[t])return!1;let i=this.host.nativeElement.getBoundingClientRect(),n=this.slides[t].nativeElement.parentNode.getBoundingClientRect();return n.left>=i.left&&n.right-50<=i.right}addNode(t,e=!1){e||this.slides.push(t)}getMask(){let t=this.host.nativeElement.getBoundingClientRect();return this.padding&&this.fadingSides&&this.sanitizer?this.sanitizer.bypassSecurityTrustStyle(`linear-gradient(\n\t\t\t\tto right,\n\t\t\t\ttransparent 0,\n\t\t\t\tblack ${1.5*this.padding}px,\n\t\t\t\tblack ${t.width-1.5*this.padding}px,\n\t\t\t\ttransparent 100%\n\t\t\t)`):"none"}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m),o.Nb(Er))},t.\u0275cmp=o.Hb({type:t,selectors:[["slider"]],hostVars:4,hostBindings:function(t,e){2&t&&(o.Ic("-webkit-mask-image",e.getMask()),o.Fb("initialized",e.initialized))},inputs:{items:"items",controls:"controls",fadingSides:"fadingSides",length:"length",mode:"mode",currentIndex:"currentIndex",padding:"padding",slideTimeout:"slideTimeout"},outputs:{onSliderTranslate:"onSliderTranslate",onSliderInit:"onSliderInit"},ngContentSelectors:yL,decls:3,vars:15,consts:[[1,"stage"],["class","slider-controls",4,"ngIf"],[1,"slider-controls"],[1,"clear"],[3,"active","alertSound","click",4,"ngFor","ngForOf"],[3,"alertSound","click"]],template:function(t,e){1&t&&(o.ic(),o.Rb(0,"div",0),o.hc(1),o.Qb(),o.Jc(2,vL,5,4,"div",1)),2&t&&(o.Ic("transform",e.getTransform()),o.Fb("sliding-mode","slide"==e.mode)("fading-mode","fade"==e.mode)("short-mode","short"==e.mode)("auto-mode","auto"==e.mode)("no-transition",e.noTransition)("loaded",!e.noTransition),o.Bb(2),o.jc("ngIf",e.controls))},encapsulation:2}),t})(),kL=(()=>{class t{transform(t,e){let i,n;return(t=Math.floor(t))?t%60?(i=Math.floor(t/60),n=t%60,n<10&&(n="0"+n),`${i}:${n}`):(i=Math.floor(t/60),n="00",`${i}:${n}`):"0:00"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Mb({name:"timer",type:t,pure:!0}),t})();const wL=["confirmation"],SL=function(t,e){return{portrait:t,wreath:e}},IL=function(t,e,i,n,s,a){return{displayName:t,premium:e,self:i,commander:n,league:s,avatar:a}};function CL(t,e){if(1&t&&(o.Rb(0,"li",26),o.Ob(1,"user-image",6),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2);o.Fb("lined",t.id===i.userId),o.kc("tooltip-hint",t.displayName),o.Bb(1),o.jc("player",o.sc(7,IL,t.displayName,t.premium,t.id===i.userId,t.type,t.league,o.oc(4,SL,t.portrait,t.wreath)))}}function LL(t,e){if(1&t&&(o.Rb(0,"div",24),o.Rb(1,"ul"),o.Jc(2,CL,2,14,"li",25),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(2),o.jc("ngForOf",t.participants)}}function RL(t,e){if(1&t&&(o.Rb(0,"li"),o.Ob(1,"user-image",6),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2);o.Fb("lined",t.id===i.userId),o.Bb(1),o.jc("player",o.sc(9,IL,t.displayName,t.premium,t.id===i.userId,t.type,t.league,t.id===i.userId?o.oc(3,SL,i.userAvatar.portrait,i.userAvatar.wreath):o.oc(6,SL,t.portrait,t.wreath)))}}function OL(t,e){if(1&t&&(o.Rb(0,"div",31),o.Ob(1,"img",32),o.Qb()),2&t){const t=o.bc(2);o.Fb("above",!t.teams[0].length&&t.teams[1].length||!t.teams[1].length&&t.teams[0].length)}}function TL(t,e){if(1&t&&(o.Rb(0,"li"),o.Ob(1,"user-image",6),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2);o.Fb("lined",t.id===i.userId),o.Bb(1),o.jc("player",o.sc(6,IL,t.displayName,t.premium,t.id===i.userId,t.type,t.league,o.oc(3,SL,t.portrait,t.wreath)))}}function xL(t,e){if(1&t&&(o.Rb(0,"div",24),o.Rb(1,"ul",27),o.Jc(2,RL,2,16,"li",28),o.Qb(),o.Jc(3,OL,2,2,"div",29),o.Rb(4,"ul",30),o.Jc(5,TL,2,13,"li",28),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(2),o.jc("ngForOf",t.teams[0]),o.Bb(1),o.jc("ngIf",t.teams[0].length&&t.teams[1].length),o.Bb(2),o.jc("ngForOf",t.teams[1])}}function BL(t,e){if(1&t&&(o.Rb(0,"h2",33),o.Ob(1,"span",34),o.cc(2,"timer"),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("innerHTML",o.dc(2,1,t.timer).monospace(),o.Ac)}}function jL(t,e){if(1&t&&(o.Rb(0,"h2",33),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.getTimeConnecting())}}function ML(t,e){if(1&t&&(o.Rb(0,"h3",35),o.Lc(1),o.Ob(2,"br"),o.Rb(3,"small"),o.Lc(4),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Nc(" ",t.getEstimatedTime(),":00 "),o.Bb(3),o.Mc(t.L("meta.ui.match.estimated"))}}function QL(t,e){if(1&t&&o.Ob(0,"img",47),2&t){const t=o.bc().$implicit;o.jc("src","assets/img/tips/bg/"+t.bg+".jpg",o.Cc)}}function AL(t,e){if(1&t&&(o.Rb(0,"span",48),o.Lc(1),o.Ob(2,"br"),o.Lc(3),o.cc(4,"json"),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(2);o.Bb(1),o.Nc("[",t.id,"] "),o.Bb(2),o.Nc(" ",o.dc(4,2,e.hints.tagsArray),"")}}function DL(t,e){if(1&t&&(o.Rb(0,"div",49),o.Rb(1,"div",50),o.Ob(2,"img",47),o.Qb(),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(2),o.jc("src","assets/img/tips/icon/"+t.icon+".png",o.Cc)}}const EL=function(){return{link:!1}};function NL(t,e){if(1&t&&(o.Rb(0,"div",38),o.Rb(1,"div",39),o.Ob(2,"article",40),o.Qb(),o.Rb(3,"div",41),o.Jc(4,QL,1,1,"img",42),o.Jc(5,AL,5,4,"span",43),o.Rb(6,"div",44),o.Ob(7,"img",45),o.Qb(),o.Qb(),o.Jc(8,DL,3,1,"div",46),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2);o.Bb(2),o.jc("innerHTML",null==t.text?null:t.text.replaceDeprecatedMarkup().parseButtons().markdown(o.mc(5,EL)),o.Ac),o.Bb(2),o.jc("ngIf",t.bg),o.Bb(1),o.jc("ngIf",i.hasFlag("debug")),o.Bb(2),o.jc("src","assets/img/fake_1x1.png",o.Cc),o.Bb(1),o.jc("ngIf",t.icon)}}function FL(t,e){if(1&t&&(o.Rb(0,"slider",36),o.Jc(1,NL,9,6,"div",37),o.Qb()),2&t){const t=o.bc();o.jc("controls",!0)("length",t.hints.length)("mode","fade")("slideTimeout",1e4),o.Bb(1),o.jc("ngForOf",t.hints)}}function PL(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",51),o.Rb(1,"input",52),o.Yb("keydown",function(e){return o.zc(t),o.bc().addMatchmakingTip(e)}),o.Qb(),o.Qb()}}function UL(t,e){if(1&t&&(o.Rb(0,"div",53),o.Ob(1,"span"),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Ic("width",t.getServerLoadingProgress()+"%")}}function zL(t,e){if(1&t&&(o.Rb(0,"div",54),o.Ob(1,"span",34),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("innerHTML",t.error&&t.error.dcode?t.L("meta.ui.error."+t.error.dcode,t.error.value).br():"",o.Ac)}}function JL(t,e){if(1&t&&(o.Rb(0,"div",15),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.status)}}function qL(t,e){if(1&t&&(o.Rb(0,"div",15),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Nc("",t.getServerLoadingProgress(),"%")}}function VL(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",21),o.Yb("click",function(){return o.zc(t),o.bc().connect()}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc();o.jc("alertSound",t.canConnect()?"ui_click_default":null),o.Cb("data-tooltip",t.L("meta.ui.match.connect")),o.Bb(1),o.Nc(" ",t.L("meta.ui.match.connect")," ")}}const $L=function(t,e,i){return{displayName:t,league:e,avatar:i}},GL=function(){return{key:"meta.ui.match.cancel_alert.desc",confirm:"meta.ui.match.cancel_alert.button_accept",decline:"meta.ui.match.cancel_alert.button_decline",title:"meta.ui.match.cancel_alert.title",icon:"warning"}},HL=function(){return{}},YL=function(t,e){return{options:t,data:e}},WL=JSON.stringify,KL={many:10,normal:5,few:2,one:1,none:0};let XL=(()=>{class t{constructor(t,e,i,n,s,a,r,c,l,u){this.matchService=t,this.matchMakingService=e,this.authenticationService=i,this.cache=n,this.notificatorService=s,this.activatedRoute=a,this.router=r,this.location=c,this.lobbyService=l,this.profileService=u,this.onCancel=new o.o,this.error=null,this.timer=0,this.teams=[],this.participants=[],this.gameMode="",this.playMode="",this.playDifficulty=0,this.difficulties=["novice","easy","normal","hard","nightmare"],this.levels=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],this.LevelAmountOverflowThreshold=2,this.matchId=null,this.userId="",this.userStatus=null,this.user={},this.levelInfo=[],this.levelsAmountKeys=KL,this.missionsNode=null,this.campaignTemplate="",this.nodeId="",this.globalEvent=new uu,this.userAvatar={},(new al).data.subscribe(t=>this.L=t)}ngOnInit(){this.informator=new dl,this.cache.isMatching=!0,Object(Pc.a)("isMatching true"),this.cache.alertBackgroundMusicForState(cd.Matchmaking),this.triggerGlobalEvent("isMatching_true"),this.cache.matchmakingEvent.next(od.Start),this.cache.matchmakingEvent.next(null),this.userId=this.cache.getUserId(),this.user=this.cache.getUser(),this.userAvatar=this.profileService.getUserAvatar(),this.lobbyService.lobbyClose(!0),this.triggerGlobalEvent("hq_messages.close"),this.globalEvent.subscribe(t=>{t&&t&&"modal.close"==t.key&&t.data&&t.data.id&&"confirmation_component"==t.data.id&&this.resetCancelModal()}),this.teams=[[],[]],this.title=this.cache.getUserTeamId()?this.L("meta.ui.match.status.gathering_team_match"):this.L("meta.ui.match.status.gathering_match"),this.cache.metagameMatching=!0,this.matchId=this.activatedRoute.snapshot.params.matchId||null,this.timerSubscription=function(t=0,e,i){let n=-1;return sL(e)?n=Number(e)<1?1:Number(e):Object(pe.a)(e)&&(i=e),Object(pe.a)(i)||(i=nL),new Re.a(e=>{const s=sL(t)?t:+t-i.now();return i.schedule(aL,s,{index:0,period:n,subscriber:e})})}(0,1e3).subscribe(t=>{this.timer=this.matchMakingService.TimeSinceRequest(),this.title=this.getStatus()}),this.matchService.insertGameSparks(this.authenticationService.getGameSparks()),this.matchMakingService.insertGameSparks(this.authenticationService.getGameSparks()),this.messageSubscription=this.authenticationService.onMessage.subscribe(t=>{if(Object(Pc.a)("Matchmaking message: ",t.extCode||"no ID"),t.extCode)switch(t.extCode){case Wl.TeamMatchCanceled:this.cancel(!0);break;case Wl.OnMatchOpened:this.matchService.OnMatchOpened(t.data.match),this.createTeams(t);break;case Wl.OnMatchUpdate:this.matchService.OnMatchUpdated(t.data),this.createTeams(t);break;case Wl.OnMatchClosed:this.matchService.OnMatchClosed(t.data.match,t.data.reason),this.title=this.L("meta.ui.match.status.match_closed"),Object(Pc.a)(`[c] match ${t.data.match} closed, reason: ${t.data.reason}`),this.status=this.L("meta.ui.match.reason."+t.data.reason),this.timerSubscription.unsubscribe(),this.timer=0;break;case Wl.OnServerClosed:this.matchService.OnServerClosed(t.data.server,t.data.reason),this.title=this.L("meta.ui.match.status.server_closed"),Object(Pc.a)(`[c] server ${t.data.server} closed, reason: ${t.data.reason}`),this.status=this.L("meta.ui.match.reason."+t.data.reason),this.timerSubscription.unsubscribe(),this.timer=0;break;case Wl.OnMatchRequest:this.title=Kl.Request,this.cache.alertWithParts("backendNotify",WL(t),Wl.OnMatchRequest),this.matchService.OnSoloMatchStarting(!0),this.matchMakingService.OnSoloMatchStarting();break;case Wl.OnMatchBucketChanged:this.matchMakingService.OnMatchUpdated(t.data.displayEntries),this.createTeams(t)}if(t.summary)switch(t.summary){case Wl.MatchNotFoundMessage:this.matchMakingService.OnMatchNotFound(),this.status=this.L("meta.ui.match.log.timeout");break;case Wl.MatchFoundMessage:t.scriptData&&t.scriptData.error?(this.error={code:t.scriptData.error.code,text:t.scriptData.error.text},this.matchMakingService.OnError(this.L("meta.ui.match.on_error"))):(this.matchMakingService.OnMatchFound(),this.cache.alertBackgroundMusicForState(cd.MatchFound));break;case Wl.MatchUpdatedMessage:this.matchMakingService.OnMatchUpdated(t.participants),this.createTeams(t);break;case Wl.OnMatchBucketChanged:this.matchMakingService.OnMatchUpdated(t.data.displayEntries),this.createTeams(t.data)}}),this.matchLogSubscription=this.matchService.log.subscribe(t=>{if(this.log=this.L(t[0]),t[1]&&t[1].text){let e=JSON.parse(t[1].text);this.error=this.getErrorFromResponse(e),this.error.value&&this.error.value.match&&this.error.value.player===this.cache.getUserId()&&(this.matchId=this.error.value.match,this.resumeBrokenMatch())}}),this.matchMakingLogSubscription=this.matchMakingService.log.subscribe(t=>{if(this.log=this.L(t[0]),t[1]&&t[1].text){let e=JSON.parse(t[1].text);this.error=this.getErrorFromResponse(e),this.error.value&&this.error.value.match&&this.error.value.player===this.cache.getUserId()&&(this.matchId=this.error.value.match,this.resumeBrokenMatch())}});let t=JSON.parse(JSON.stringify(this.activatedRoute.params.value));console.log(t);for(let r in t)t[r]="difficulty"===r?parseInt(t[r]):"null"===(e=t[r])?null:e;var e;let i=this.activatedRoute.data;if(i&&i.value.teamMatch){this.matchMakingService.OnTeamRequest();let t=this.cache.getCommander(this.cache.getActiveCommanderId());return this.cache.getUserTeam()?this.createTeams(this.createParticipantsFromTeam(this.cache.getUserTeam())):this.createTeams({members:[{displayName:this.cache.getUserName(),externalIds:{},id:this.cache.getUserId(),online:!0,league:this.cache.getUserLeague(),participantData:{commander:t}}]}),void this.generateMatchMakingHints()}if(this.matchId)return this.generateMatchMakingHints(),void this.matchService.matchGet(this.matchId,!0);this.campaignTemplate=t.campaign,this.campaignTemplate&&(this.nodeId=t.nodeId);let n=this.cache.getCampaign(this.campaignTemplate),s=this.cache.getMission(t.mission);console.log(t);let a={missionId:t.mission,gameMode:t.gameMode,playMode:t.mission&&t.mission.match(/tutorial|polygon/gim)?"tutorial":t.playMode,difficulty:t.difficulty,commanderId:t.commanderId,nodeId:t.node,campaignId:t.campaign,requestedSize:t.requestedSize?t.requestedSize.split(",").map(Number):null};console.log(a),this.generateMatchMakingHints(a),n&&n.modId&&(a.mod={mapPath:s.mission.map},Object(Pc.a)(`Running MOD [${n.modId}], map [${s.mission.map}]`)),this.campaignTemplate&&this.nodeId&&(a.campaignTemplate=this.campaignTemplate,a.nodeId=this.nodeId),this.launch(a)}generateMatchMakingHints(t){let e;t||(t={gameMode:"pvp"}),e="mission"===t.gameMode?this.cache.getMission(t.missionId).mode:[t.gameMode];let i=this.informator.getMatchmakingHints(e,5);i.tagsArray=e,this.hints=i,console.log(`<< fetching matchmaking hints for ${t.gameMode} [${e}]`),i.map(t=>(t.text=this.L("meta.hint.loading."+t.id),t));let n=i.slice().map(t=>t.text);console.log("matchmaking hints unprocessed: ",n),this.cache.requestMatchmakingHints(n),this.cache.onAndreyTextMessageReceived.pipe(We(t=>null!==t)).subscribe(t=>{for(let e=0;e<i.length;e++)i[e].text=t[e];this.hints=i,console.log("matchmaking hints processed by Andrey: ",this.hints)})}addMatchmakingTip(t){if(13===t.keyCode){let e=this.informator.getMatchmakingHints([this.launchOptions.gameMode],1,[t.target.value]);if(e.map(t=>t.text=this.L("meta.hint.loading."+t.id)),console.log(t.target.value,e),e.length){let i=this.hints.slice();i.push(e[0]),this.hints=i,console.log(t.target.value+" added")}t.target.value=""}}getSavedCampaignId(){return JSON.parse(localStorage.getItem("METAGAME_SELECTED_CAMPAIGN_"+this.userId))}getSavedNodeId(){return localStorage.getItem("METAGAME_SELECTED_NODE_"+this.userId)}getNodeId(t,e){if(!t||!e)return;let i=null,n="";return i=t.find(t=>t.id==e),i&&(n=i._id),n}getErrorFromResponse(t){let e="";for(let i in t)!e&&i&&(e=i);return t[e]}resumeBrokenMatch(){Object(Pc.a)("response [resuming broken match]",this.matchId);let t=this.router.createUrlTree(["match","resume",this.matchId],{queryParamsHandling:"merge"});this.router.navigateByUrl(t)}ngOnDestroy(){this.cache.isMatching=!1,Object(Pc.a)("isMatching false"),this.cache.alertBackgroundMusicForState(cd.Meta),this.cache.matchmakingEvent.next(od.Cancel),this.cache.matchmakingEvent.next(null),this.cache.metagameMatching=!1,this.messageSubscription.unsubscribe(),this.matchLogSubscription.unsubscribe(),this.matchMakingLogSubscription.unsubscribe(),this.timerSubscription.unsubscribe(),this.cache.alertCommander(this.cache.getActiveCommanderId(),!0)}tryCancel(){this.matchService.Cancel(this.matchId).subscribe(t=>{this.cancel(!0),this.matchService.Cancel(),this.matchMakingService.Cancel(),this.cache.checkFutureRedirect(!0)},t=>{t.match_cancel_anyway?this.confirmation.modal.open():(this.cancel(),this.cache.checkFutureRedirect(!0))})}cancel(t){this.cache.isMatching=!1,Object(Pc.a)("isMatching false"),t||(this.matchService.CancelAnyway(),this.matchMakingService.Cancel()),this.onCancel.emit(null),this.error=null,setTimeout(()=>{this.cache.checkFutureRedirect()})}resetCancelModal(){this.error=null,this.matchService.OnMatchContinue(),console.warn("Matchmaking: service continuing")}getState(t){switch(t){case Yl.waiting:return Gl.WAITING;case Yl.loading:return Gl.LOADING;case Yl.ready:return Gl.READY;case Yl.running:return Gl.RUNNING;case Yl.ended:return Gl.ENDED;case Yl.closed:return Gl.NONE;case Yl.gamelifting:case Yl.requested:return Gl.REQUESTED;case Yl.local_requested:return Gl.LOCAL_REQUESTED}}connect(){this.matchService.Connect()}canConnect(){return this.matchService.CanConnect()}getStatus(){if(this.error)return this.L("meta.ui.match.status.error");if(this.matchService.state===Gl.NONE){if(this.matchMakingService.state===Hl.REQUEST_ISSUED)return this.L("meta.ui.match.status.waiting_answer");if(this.matchMakingService.state===Hl.REQUEST_RUNNING)return this.L("meta.ui.match.status.gathering_match");if(this.matchMakingService.state===Hl.IDLE)return this.L("meta.ui.match.status.waiting_free_server")}else switch(this.matchService.state){case Gl.OPENING:case Gl.CANCELLING:return this.L("meta.ui.match.status.waiting_answer");case Gl.WAITING:return this.L("meta.ui.match.status.waiting_free_server");case Gl.LOADING:return this.L("meta.ui.match.status.server_loading");case Gl.READY:return this.L("meta.ui.match.status.waiting_players");case Gl.RUNNING:return this.L("meta.ui.match.status.server_running");case Gl.ENDED:return this.L("meta.ui.match.status.server_ended");case Gl.REQUESTED:return this.L("meta.ui.match.status.server_requested");case Gl.LOCAL_REQUESTED:return this.L("meta.ui.match.status.local_server_requested")}}createTeams(t){let e;this.teams=[[],[]],this.participants=[];let i=t=>({id:t.id,displayName:t.displayName,league:t.league});return t.data&&t.data&&t.data.entryStats&&this.generateLevelsInfo(t.data.entryStats),t.members?(this.participants=this.getMatchPlayers(t.members||[]),Object(Pc.a)("mm participants (player & team)",this.participants.map(i).length),void(this.cache.devMode&&console.log("participants",this.participants))):t.participants?(this.participants=this.getMatchPlayers(t.participants||[]),Object(Pc.a)("mm participants",this.participants.map(i).length),void(this.cache.devMode&&console.log("participants",this.participants))):t&&t.data?t.data.displayEntries?(this.participants=this.getMatchPlayers(t.data.displayEntries||[]),Object(Pc.a)("mm display entries (new mm)",this.participants.map(i).length),void(this.cache.devMode&&console.log("participants",this.participants))):void(this.participants.length&&t.data.request&&(e=t.data.request.players||t.participants,this.teams=this.getMatchPlayers(t.data.request.players||[],!0))):void 0}getMatchPlayers(t,e){let i=e?[[],[]]:[];return t.forEach(t=>{const n=t.commander||(t.participantData?t.participantData.commander:t.commanderType?{type:t.commanderType}:null);n||Object(Pc.a)("[ERROR] broken commander in participants",t);const s={type:n?n.type:"tnk",premium:!!n&&(n.premium||!0),displayName:t.displayName||"no name",id:t.id||"00000000000000",league:t.league};e?"a"===n.team?i[0].push(s):i[1].push(s):i.push(s)}),i}launch(t){this.launchOptions=t,this.error=null;const e="training"===t.playMode,i=this.cache.getCommander(t.commanderId);let n=i.available?i.available.id:"",s=i.id||"";const a=this.cache.getUserTeamId(),r=this.cache.isTeamOwner();switch(console.log(t),t.gameMode){case"pve":if(e){Object(Pc.a)("Starting match pve/training...");const e=this.cache.getTrainingMissions();this.matchMakingService.Request({mode:Vl.Tutorial,commander:{id:n,template:s},team:a,option:{solo:!1,difficulty:this.difficulties[t.difficulty],map:e.length?e[0]._id:"",mod:t.mod||null}}).subscribe(this.setUserStatus.bind(this))}else Object(Pc.a)("Starting match pve..."),this.matchMakingService.Request({mode:Vl.Pve,commander:{id:n,template:s},team:a,option:{solo:!1,difficulty:this.difficulties[t.difficulty],mod:t.mod||null}}).subscribe(this.setUserStatus.bind(this));break;case"pvp":Object(Pc.a)("Starting match pvp..."),this.matchMakingService.Request({mode:Vl.Pvp,commander:{id:n,template:s},team:a,option:{solo:!1,mod:t.mod||null}}).subscribe(this.setUserStatus.bind(this)),this.cache.getUserTeam()?this.createTeams(this.createParticipantsFromTeam(this.cache.getUserTeam())):this.createTeams({members:[{displayName:this.cache.getUserName(),externalIds:{},id:this.cache.getUserId(),online:!0,league:this.cache.getUserLeague(),participantData:{commander:i}}]});break;case"duel":Object(Pc.a)("Starting match duel..."),this.matchMakingService.Request({mode:Vl.Duel,commander:{id:n,template:s},team:a,option:{solo:!1,mod:t.mod||null,requestedSize:t.requestedSize}}).subscribe(this.setUserStatus.bind(this)),this.cache.getUserTeam()?this.createTeams(this.createParticipantsFromTeam(this.cache.getUserTeam())):this.createTeams({members:[{displayName:this.cache.getUserName(),externalIds:{},id:this.cache.getUserId(),online:!0,league:this.cache.getUserLeague(),participantData:{commander:i}}]});break;case"classic":Object(Pc.a)("Starting match classic..."),this.matchMakingService.Request({mode:Vl.Classic,commander:{template:s},team:a,option:{solo:!1,mod:t.mod||null,requestedSize:t.requestedSize}}).subscribe(this.setUserStatus.bind(this)),this.cache.getUserTeam()?this.createTeams(this.createParticipantsFromTeam(this.cache.getUserTeam())):this.createTeams({members:[{displayName:this.cache.getUserName(),externalIds:{},id:this.cache.getUserId(),online:!0,league:this.cache.getUserLeague(),participantData:{commander:i}}]});break;default:Object(Pc.a)("Starting default case match...");let o={mode:"tutorial"===t.playMode?Vl.Tutorial:Vl.Coop,commander:{},option:{solo:!!t.missionId,difficulty:this.difficulties[t.difficulty],map:t.missionId,mod:t.mod||null}};t.campaignId&&t.nodeId&&(o.option.campaign={template:t.campaignId,node:t.nodeId}),i&&i.available&&(o.commander.id=n),t.commanderId&&(o.commander.template=s),a&&r&&(Object(Pc.a)("launching team match..."),o.team=a),this.cache.getUserTeam()?this.createTeams(this.createParticipantsFromTeam(this.cache.getUserTeam())):this.createTeams({members:[{displayName:this.cache.getUserName(),externalIds:{},id:this.cache.getUserId(),online:!0,league:this.cache.getUserLeague(),participantData:{commander:i}}]}),this.matchMakingService.Request(o).subscribe(this.setUserStatus.bind(this))}}createParticipantsFromTeam(t){return{members:Object.keys(t.members).map(e=>{let i=t.members[e],n=this.cache.getCommanderTemplate(i.commander.template);return{displayName:i.displayName,id:e,premium:!1,type:n.type,commander:n,league:i.league}})}}OnMatchUpdated(t){Object(Pc.a)("MatchUpdatedMessage: ",t)}getMatchState(){return this.matchService.state}getMatchMakingState(){return this.matchMakingService.state}isServerLoading(){return this.matchService.state===Gl.LOADING}getServerLoadingProgress(){return this.matchService.progress||0}isServerReady(){return this.matchService&&this.matchService.state===Gl.READY}isServerProgress(){return 100===this.getServerLoadingProgress()||this.isServerLoading()&&!this.isServerReady()}getTimeConnecting(){return 0}isTimerShowing(){return!(this.error||!this.timer||this.isServerProgress()||this.isServerReady())}isErrorShowing(){return!(!this.error||!this.error.dcode||this.isServerReady())}getEstimatedTime(){return this.launchOptions?"pve"===this.launchOptions.gameMode||"coop"===this.launchOptions.playMode?2:10:1}renderErrorJson(t){return(t=JSON.parse(JSON.stringify(t))).text=JSON.parse(t.text),JSON.stringify(t,null,"\t").replace(/(\t)/gim,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/\"[a-z_]{0,}\"\:/gim,function(t){return t.replace(/\"/gim,"")}).replace(/(".*?")/gim,"<b>$1</b>").replace(/(\n|\r)/gim,"<br>")}autoConnect(){this.canConnect()&&this.connect()}autoCancel(){setTimeout(()=>{this.cancel()},2e3)}canShowCancelButton(){return this.matchService.state===Gl.NONE}setUserStatus(t){this.userStatus=t&&t.status||null,this.cache.getCommander(this.launchOptions.commanderId);let e=this.cache.getCommanderProgress(this.launchOptions.commanderId),[i,n]=[Math.max(3,e.currentLevel),Math.min(6,e.currentLevel+this.userStatus.uplevel)];this.userStatus.commanderLevel=e.currentLevel,this.userStatus.upLevel=i===n?""+i:`${i}-${n}`,this.userStatus.upLevelRoman=i===n?""+this.L("level."+i):`${this.L("level."+i)}-${this.L("level."+n)}`,this.cache.devMode&&console.log("UserStatus: ",this.userStatus)}generateLevelsInfo(t){this.levelInfo=[];let e={};if(t)for(let n=0;n<t.length;n++){let i=t[n];e[i.level]||(e[i.level]=0),e[i.level]+=i.count}let i=t=>{for(let e in KL)if(t>=KL[e])return e};for(let n=3;n<=6;n++)this.levelInfo.push(e[n]?{level:n,count:e[n],amount:i(e[n])}:{level:n,count:0,amount:ZL.None});this.cache.devMode&&console.log(t,e,this.levelInfo)}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}hasFlag(t){return this.cache.hasFlag(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Gd),o.Nb(Yd),o.Nb(Gc),o.Nb(nd),o.Nb(Uc),o.Nb(xn),o.Nb(Ys),o.Nb(qt),o.Nb(Bl),o.Nb(Ou))},t.\u0275cmp=o.Hb({type:t,selectors:[["match-window"]],viewQuery:function(t,e){if(1&t&&o.Qc(wL,!0),2&t){let t;o.vc(t=o.Zb())&&(e.confirmation=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("grid-default",!0)},outputs:{onCancel:"onCancel"},features:[o.Ab([Gd,Yd,nd,Bl])],decls:31,vars:32,consts:[["g-players","","class","teams",4,"ngIf"],["g-title",""],["g-timer",""],[1,"row","align-middle"],[1,"col-2"],[1,"user-image-wrapper"],[3,"player"],[1,"col-4","align-right"],["class","timer",4,"ngIf"],[1,"col-4"],["class","status estimated",4,"ngIf"],["g-slider",""],[3,"controls","length","mode","slideTimeout",4,"ngIf"],["style","position: absolute; top: 20%; left: 10%; z-index: 5;",4,"ngIf"],["g-status",""],[1,"status"],["class","progress-bar static",4,"ngIf"],["class","status error",4,"ngIf"],["class","status",4,"ngIf"],["g-buttons","",1,"align-center"],["class","button large",3,"alertSound","click",4,"ngIf"],[1,"button","large",3,"alertSound","click"],[3,"confirmation","confirmCallback","declineCallback"],["confirmation",""],["g-players","",1,"teams"],[3,"tooltip-hint","lined",4,"ngFor","ngForOf"],[3,"tooltip-hint"],[1,"left-side"],[3,"lined",4,"ngFor","ngForOf"],["class","fight-mark",3,"above",4,"ngIf"],[1,"right-side"],[1,"fight-mark"],["src","assets/img/icons/svg/br.svg","image-load","",1,"hero-icon"],[1,"timer"],[3,"innerHTML"],[1,"status","estimated"],[3,"controls","length","mode","slideTimeout"],["class","slider-item",4,"ngFor","ngForOf"],[1,"slider-item"],[1,"content"],[2,"font-size","calc(var(--font-size) * 0.9)",3,"innerHTML"],[1,"slider-image"],["image-load","null","draggable","false",3,"src",4,"ngIf"],["style","position: absolute; z-index: 3; top: 0; right: 0",4,"ngIf"],[1,"overlay"],[3,"src"],["class","slider-icon",4,"ngIf"],["image-load","null","draggable","false",3,"src"],[2,"position","absolute","z-index","3","top","0","right","0"],[1,"slider-icon"],[1,"image-contain"],[2,"position","absolute","top","20%","left","10%","z-index","5"],["type","text","placeholder","tip ID...",1,"input",3,"keydown"],[1,"progress-bar","static"],[1,"status","error"]],template:function(t,e){1&t&&(o.Jc(0,LL,3,1,"div",0),o.Jc(1,xL,6,3,"div",0),o.Rb(2,"div",1),o.Rb(3,"h2"),o.Lc(4),o.Qb(),o.Qb(),o.Rb(5,"div",2),o.Rb(6,"div",3),o.Ob(7,"div",4),o.Rb(8,"div",4),o.Rb(9,"div",5),o.Ob(10,"user-image",6),o.Qb(),o.Qb(),o.Rb(11,"div",7),o.Jc(12,BL,3,3,"h2",8),o.Jc(13,jL,2,1,"h2",8),o.Qb(),o.Rb(14,"div",9),o.Jc(15,ML,5,2,"h3",10),o.Qb(),o.Qb(),o.Qb(),o.Rb(16,"div",11),o.Jc(17,FL,2,5,"slider",12),o.Jc(18,PL,2,0,"div",13),o.Qb(),o.Rb(19,"div",14),o.Rb(20,"div",15),o.Jc(21,UL,2,2,"div",16),o.Qb(),o.Jc(22,zL,2,1,"div",17),o.Jc(23,JL,2,1,"div",18),o.Jc(24,qL,2,1,"div",18),o.Qb(),o.Rb(25,"div",19),o.Jc(26,VL,2,3,"button",20),o.Rb(27,"button",21),o.Yb("click",function(){return e.tryCancel()}),o.Lc(28),o.Qb(),o.Qb(),o.Ob(29,"confirmation",22,23)),2&t&&(o.jc("ngIf",e.participants.length),o.Bb(1),o.jc("ngIf",!e.participants.length),o.Bb(3),o.Nc("",e.title,"\xa0"),o.Bb(6),o.jc("player",o.pc(23,$L,e.user.displayName,e.user.league&&e.user.league.id?e.user.league.id:"",o.oc(20,SL,e.userAvatar.portrait,e.userAvatar.wreath))),o.Bb(2),o.jc("ngIf",e.timer&&!e.isServerProgress()&&!e.isServerReady()),o.Bb(1),o.jc("ngIf",e.isServerReady()),o.Bb(2),o.jc("ngIf",e.isTimerShowing()),o.Bb(2),o.jc("ngIf",e.hints&&e.hints.length),o.Bb(1),o.jc("ngIf",e.hasFlag("debug")),o.Bb(3),o.jc("ngIf",e.isServerProgress()),o.Bb(1),o.jc("ngIf",e.isErrorShowing()),o.Bb(1),o.jc("ngIf",!e.isServerReady()),o.Bb(1),o.jc("ngIf",e.isServerProgress()),o.Bb(2),o.jc("ngIf",e.canConnect()),o.Bb(1),o.jc("alertSound","ui_back"),o.Cb("data-tooltip",e.L("meta.ui.match.cancel")),o.Bb(1),o.Nc(" ",e.L("meta.ui.match.cancel")," "),o.Bb(1),o.jc("confirmation",o.oc(29,YL,o.mc(27,GL),o.mc(28,HL)))("confirmCallback",e.cancel.bind(e,!1))("declineCallback",e.resetCancelModal.bind(e)))},directives:[ee,gL,Zv,Km,Zt,tp,Qf,_L],pipes:[kL,re],encapsulation:2}),t})();var ZL=function(t){return t.None="none",t.Few="few",t.Normal="normal",t.Many="many",t}({});const tR=["credits"];function eR(t,e){1&t&&o.Ob(0,"img",13)}function iR(t,e){1&t&&o.Ob(0,"img",14)}const nR=function(){return{hover:"ui_hover_top_panel",click:"ui_click_default"}};var sR=function(t){return t.Idle="idle",t.Running="running",t.Pause="pause",t}({});const aR={lastTime:0,delta:0,speed:1,state:sR.Idle,progress:0};let rR=(()=>{class t{constructor(t){this.cache=t,this.creditsEnded=!1,this.creditsTimeOuts=[],this.onInitTimeOut=null,this.onScrollEndTimeOut=null,this.titlesArray=[],this.state=aR,this.pixelRatio=window.innerHeight/1080,this.localizator=new al,al.instance.data.subscribe(t=>this.L=t)}ngAfterViewInit(){this.credits=this.creditsRef.nativeElement,console.dir(this.credits)}ngOnInit(){this.localizator.getData(),this.cache.alertBackgroundMusicForState(cd.Authors),setTimeout(()=>{this.startAnimaiton()},1e3)}startAnimaiton(){this.state.lastTime=(new Date).getTime(),this.state.state=sR.Running,this._animationTick()}playPause(){this.state.state===sR.Idle?this.startAnimaiton():this.state.state===sR.Running?this.state.state=sR.Pause:(this.state.lastTime=(new Date).getTime(),this.state.state=sR.Running)}stepUp(){this.state.speed<3&&this.state.speed++}stepDown(){this.state.speed>1&&this.state.speed--}resetAnimation(){this.state={lastTime:0,delta:0,speed:1,state:sR.Idle,progress:0},cancelAnimationFrame(this._animationIndex),this.credits.scrollTop=0,console.log("End of credits")}_animationTick(){if(this.state.progress>this.credits.scrollHeight-this.credits.getBoundingClientRect().height-50)return void setTimeout(()=>{this.resetAnimation()},1e3);if(this._animationIndex=requestAnimationFrame(this._animationTick.bind(this)),this.state.state===sR.Pause)return;let t=(new Date).getTime();this.state.delta=t-this.state.lastTime;let e=this.credits.scrollTop+.1*this.pixelRatio*this.state.delta*this.state.speed;this.state.progress=e,this.credits.scrollTop=e,this.state.lastTime=t}ngOnDestroy(){this.keydownSubscription&&this.keydownSubscription.unsubscribe(),this.creditsTimeOuts.forEach(t=>{clearTimeout(t)}),this.scrollEndSubscription&&this.scrollEndSubscription.unsubscribe(),this.cache.alertBackgroundMusicForState(cd.Meta)}onCreditsEnd(t){this.creditsEnded=!0,this.creditsTimeOuts.push(this.onScrollEndTimeOut)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd))},t.\u0275cmp=o.Hb({type:t,selectors:[["credits"]],viewQuery:function(t,e){if(1&t&&o.Qc(tR,!0),2&t){let t;o.vc(t=o.Zb())&&(e.creditsRef=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("grid-learn",!0)},features:[o.Ab([nd])],decls:21,vars:15,consts:[[1,"credits"],["credits",""],[1,"space-wrapper"],[1,"section"],[1,"details",3,"innerHTML"],[1,"align-center"],[1,"controls"],[1,"button","small","square",3,"alertSound","click"],["src","assets/img/icons/svg/round_minus.svg","alt","",1,"icon"],["class","icon","src","assets/img/icons/svg/play-icon.svg","alt","","style","transform: scale(1.4)",4,"ngIf"],["class","icon","src","assets/img/icons/svg/pause.svg","alt","","style","transform: scale(0.9)",4,"ngIf"],["src","assets/img/icons/svg/round_plus.svg","alt","",1,"icon"],[2,"font-weight","900"],["src","assets/img/icons/svg/play-icon.svg","alt","",1,"icon",2,"transform","scale(1.4)"],["src","assets/img/icons/svg/pause.svg","alt","",1,"icon",2,"transform","scale(0.9)"]],template:function(t,e){1&t&&(o.Rb(0,"div",0,1),o.Rb(2,"div",2),o.Rb(3,"section",3),o.Ob(4,"article",4),o.Qb(),o.Rb(5,"section",5),o.Rb(6,"article"),o.Rb(7,"h1"),o.Lc(8),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(9,"div",6),o.Rb(10,"button",7),o.Yb("click",function(){return e.stepDown()}),o.Ob(11,"img",8),o.Qb(),o.Rb(12,"button",7),o.Yb("click",function(){return e.playPause()}),o.Jc(13,eR,1,0,"img",9),o.Jc(14,iR,1,0,"img",10),o.Qb(),o.Rb(15,"button",7),o.Yb("click",function(){return e.stepUp()}),o.Ob(16,"img",11),o.Qb(),o.Ob(17,"br"),o.Rb(18,"small"),o.Rb(19,"b",12),o.Lc(20),o.Qb(),o.Qb(),o.Qb()),2&t&&(o.Bb(4),o.jc("innerHTML",e.L("meta.ui.credits.credits_details").markdown(),o.Ac),o.Bb(4),o.Mc(e.L("meta.ui.credits.credits_final").markdown()),o.Bb(2),o.Fb("disabled",e.state.speed<=1),o.jc("alertSound",o.mc(12,nR)),o.Bb(2),o.jc("alertSound",o.mc(13,nR)),o.Bb(1),o.jc("ngIf","pause"===e.state.state||"idle"===e.state.state),o.Bb(1),o.jc("ngIf","running"===e.state.state),o.Bb(1),o.Fb("disabled",e.state.speed>=3),o.jc("alertSound",o.mc(14,nR)),o.Bb(5),o.Nc("x",e.state.speed,""))},encapsulation:2}),t})();var oR=function(t){return t.Task="task",t.League="league",t.DLC="dlc",t}({});const cR=["modal"];function lR(t,e){if(1&t&&(o.Rb(0,"div",8),o.Ob(1,"span"),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Ic("width",t.cache.getLoadingProgress("openContainer")+"%")}}function uR(t,e){if(1&t&&(o.Rb(0,"h3",9),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Fb("visible",t.rewardsVisible),o.Bb(1),o.Nc(" ",t.L(t.type==t.RewardType.DLC?"meta.ui.reward."+t.type+"_completed_"+t.dlcType:"meta.ui.reward."+t.type+"_completed")," ")}}const dR=function(t,e){return{current:t,target:e}};function hR(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.Nc(" ",t.L("meta.task."+t.activeContainer.taskTemplate+".desc",o.oc(1,dR,t.progress.current.cat(),t.progress.target.cat()))," ")}}function bR(t,e){if(1&t&&(o.Rb(0,"div",14),o.Rb(1,"div",15),o.Lc(2),o.Qb(),o.Jc(3,hR,2,4,"span",16),o.Qb()),2&t){const t=o.bc(2);o.Fb("large",t.type==t.RewardType.League||!t.progressPersent),o.Bb(2),o.Mc(t.L("meta.task."+t.activeContainer.taskTemplate+".short")),o.Bb(1),o.jc("ngIf",t.progress)}}function mR(t,e){if(1&t&&(o.Rb(0,"div",10),o.Rb(1,"div",11),o.Ob(2,"img",12),o.Qb(),o.Jc(3,bR,4,4,"div",13),o.Qb()),2&t){const t=o.bc();o.Bb(2),o.jc("src","assets/img/icons/svg/task-badge.svg",o.Cc),o.Bb(1),o.jc("ngIf",t.activeContainer&&t.activeContainer.taskTemplate)}}function pR(t,e){if(1&t&&(o.Rb(0,"div",24),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Mc(t.L("meta.ui.dlc.type_"+t.dlcType))}}function gR(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",17),o.Rb(1,"div",18),o.Rb(2,"div",19),o.Ob(3,"img",20),o.Ob(4,"img",21),o.Qb(),o.Jc(5,pR,2,1,"div",22),o.Qb(),o.Rb(6,"button",23),o.Yb("click",function(){return o.zc(t),o.bc().getDLCReward()}),o.Lc(7),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(5),o.jc("ngIf",t.dlcType),o.Bb(1),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.reward.button_start")," ")}}function fR(t,e){if(1&t){const t=o.Sb();o.Rb(0,"rewards",26),o.Yb("onRewardFinished",function(e){o.zc(t);const i=o.bc(2);return i.type==i.RewardType.DLC?i.close():i.onRewardFinished(e,i.activeContainer.id)}),o.Qb()}if(2&t){const t=o.bc(2);o.jc("rewards",t.activeContainerRewards)("appearance","single")("dlcShow",t.type==t.RewardType.DLC)("buttonsLocked",t.buttonsLocked)}}function vR(t,e){if(1&t&&(o.Rb(0,"div",18),o.Jc(1,fR,1,4,"rewards",25),o.Qb()),2&t){const t=o.bc();o.Fb("full-height",t.type==t.RewardType.DLC),o.Bb(1),o.jc("ngIf",t.activeContainerRewards)}}let yR=(()=>{class t{constructor(t,e,i,n,s){this.cache=t,this.tasksService=e,this.visitService=i,this.notificatorService=n,this.authenticationService=s,this.onOpen=new o.o,this.onClose=new o.o,this.globalEvent=new uu,this.containers=[],this.containerCount=0,this.activeContainer=null,this.activeContainerRewards=[],this.RewardType=oR,this.progress=null,this.rewardsVisible=!0,this.buttonsLocked=!1,(new al).data.subscribe(t=>this.L=t)}ngOnInit(){this.containers=this.tasksService.getContainers(),this.containers&&this.containers.length&&this.computeTaskReward(this.containers[this.containerCount].id).then(()=>{this.activeContainerRewards&&this.activeContainerRewards.length&&setTimeout(()=>{this.modal&&this.modal.open()},150)}),this.containerAddSubscription=this.tasksService.onContainerAdd.pipe(We(t=>null!==t)).subscribe(t=>{if(t&&t.container)for(let e of t.container)this.computeTaskReward(e.id).then(()=>{this.activeContainerRewards&&this.activeContainerRewards.length&&setTimeout(()=>{this.modal&&this.modal.open()},150)})}),this.onMessageSubscription=this.authenticationService.onMessage.subscribe(t=>{if(!t.error&&t&&!this.cache.isMatching)switch((t=JSON.parse(JSON.stringify(t))).extCode){case"onDlcApply":if(!t.data.dlc||!t.data.content)return;this.rewardsVisible=!1,this.showDlcReward(t.data.content,t.data.dlc)}}),this.keydownSubscription=pd.onKeyDown.pipe(We(t=>null!==t)).subscribe(t=>{this.keydownHandler(t)})}ngOnDestroy(){this.onModalClose(),this.containerAddSubscription&&this.containerAddSubscription.unsubscribe(),this.keydownSubscription&&this.keydownSubscription.unsubscribe()}computeTaskReward(t){if(t&&t.length)return new Promise((e,i)=>{let n=this.tasksService.getContainers();n.find(e=>e.id==t)&&(this.activeContainer=n.find(e=>e.id==t)),this.activeContainer&&this.activeContainer.reward&&(this.activeContainerRewards=this.activeContainer.reward),this.activeContainer&&this.activeContainer.taskTemplate&&(this.type=oR.Task),this.activeContainer.source&&this.activeContainer.source.league&&(this.type=oR.League),this.progress=this.setProgress(),e(null)})}computeDLCReward(t,e){return new Promise((i,n)=>{let s=[];s.push({key:"description",description:{title:this.L("meta.shop.item.dlc_"+e+".subtitle").markdown({list:{prefix:"\u2014"}}).br(),text:this.L("meta.shop.item.dlc_"+e+".desc").markdown({list:{prefix:"\u2014"}}).br()}});let a=this.getRewards(t);this.activeContainerRewards=s.concat(a),i(null)})}getRewards(t){let e=[];for(let i in t){if(i===_R.Portrait)for(let n of t[i])e.push({key:i,amount:1,portrait:n});if(i===_R.Unit)for(let n in t[i])e.push({key:i,amount:t[i][n],unitId:n,unit:kl.clone(this.cache.getTreeUnit(n),{open:!0,mode:gl.Exchanger})});if(i===_R.Wreath)for(let n of t[i])e.push({key:i,amount:1,wreath:n});if(i===_R.Campaign)for(let n of t[i])e.push({key:i,amount:1,campaignId:n})}return e}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}setProgress(){let t={current:0,target:0},e=this.tasksService.getTask(this.activeContainer.id,this.activeContainer.taskTemplate);return e&&e.complete_condition&&e.complete_condition[0]&&(t.target=e.complete_condition[0].value?e.complete_condition[0].value:0,t.current=e.activate_condition&&e.activate_condition[0]&&e.activate_condition[0].id?this.cache.getCounter(e.activate_condition[0].id):0),t}onRewardFinished(t,e){t&&e&&(this.buttonsLocked=!0,this.cache.startLoadingProgress("openContainer"),this.tasksService.openContainer(e).subscribe(t=>{t&&t.scriptData&&(this.visitService.clear("container_"+e),this.modal.close(),this.buttonsLocked=!1,this.cache.stopLoadingProgress("openContainer"))},t=>{this.buttonsLocked=!1,this.cache.stopLoadingProgress("openContainer")}))}showDlcReward(t,e){t&&(this.type=oR.DLC,this.dlcType=e,this.computeDLCReward(t,e).then(()=>{this.activeContainerRewards&&this.activeContainerRewards.length&&setTimeout(()=>{this.modal&&this.modal.open()},150)}))}close(){this.modal&&this.modal.close()}getDLCReward(){this.rewardsVisible=!0}onModalOpen(t){}onModalClose(t){this.containers&&this.containers.length&&this.containerCount<=this.containers.length-1&&(this.containerCount++,this.containers[this.containerCount]&&this.containers[this.containerCount].id&&this.computeTaskReward(this.containers[this.containerCount].id).then(()=>{this.activeContainerRewards&&this.activeContainerRewards.length&&setTimeout(()=>{this.modal&&this.modal.open()},150)}))}keydownHandler(t){if(27===t.keyCode&&this.modal.opened){let t=this.containers&&this.containers.length?this.containers:this.tasksService.getContainers(),e=t.length;this.cache.startLoadingProgress("openContainer");for(let i of t){const t=i.id;this.buttonsLocked=!0,this.tasksService.openContainer(t).subscribe(i=>{i&&i.scriptData&&(console.log(`<- container ${t} opened`),this.removeContainer(t),e--,e<1&&(this.modal.close(),this.cache.stopLoadingProgress("openContainer"),this.buttonsLocked=!1,this.cache.alertSound("ui_dlc")))},t=>{this.buttonsLocked=!1,this.cache.stopLoadingProgress("openContainer"),console.error(t),this.notificatorService.push({response:t,parameters:""})})}}}removeContainer(t){let e=this.containers.findIndex(e=>e.id===t);e>=0&&this.containers.splice(e,1)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Tl),o.Nb(Sl),o.Nb(Uc),o.Nb(Gc))},t.\u0275cmp=o.Hb({type:t,selectors:[["rewards-modal"]],viewQuery:function(t,e){if(1&t&&o.Qc(cR,!0),2&t){let t;o.vc(t=o.Zb())&&(e.modal=t.first)}},outputs:{onOpen:"onOpen",onClose:"onClose"},features:[o.Ab([nd,Tl,Sl,Uc])],decls:8,vars:8,consts:[["id","rewardsModal",1,"medium","rewards-modal",3,"nonClosing","ignoreBackgroundClick","id","onOpen","onClose"],["modal",""],["class","progress-bar simple",4,"ngIf"],["class","align-center main-title",3,"visible",4,"ngIf"],[1,"main-body"],["class","task-info tile texture-border no-hover",4,"ngIf"],["class","dlc-preview",4,"ngIf"],["class","verticaly-middle",3,"full-height",4,"ngIf"],[1,"progress-bar","simple"],[1,"align-center","main-title"],[1,"task-info","tile","texture-border","no-hover"],[1,"task-badge"],["image-load","",1,"badge-icon",3,"src"],["class","description",3,"large",4,"ngIf"],[1,"description"],[1,"task-title"],[4,"ngIf"],[1,"dlc-preview"],[1,"verticaly-middle"],[1,"logo"],["src","assets/img/logo.svg","image-load","",1,"logo-image"],["src","assets/img/logo_sparks.png","image-load","",1,"logo-sparks"],["class","dlc-title",4,"ngIf"],["type","button",1,"button","large",3,"alertSound","click"],[1,"dlc-title"],[3,"rewards","appearance","dlcShow","buttonsLocked","onRewardFinished",4,"ngIf"],[3,"rewards","appearance","dlcShow","buttonsLocked","onRewardFinished"]],template:function(t,e){1&t&&(o.Rb(0,"modal",0,1),o.Yb("onOpen",function(t){return e.onModalOpen(t)})("onClose",function(t){return e.onModalClose(t)}),o.Jc(2,lR,2,2,"div",2),o.Jc(3,uR,2,3,"h3",3),o.Rb(4,"div",4),o.Jc(5,mR,4,2,"div",5),o.Jc(6,gR,8,3,"div",6),o.Jc(7,vR,2,3,"div",7),o.Qb(),o.Qb()),2&t&&(o.jc("nonClosing",!0)("ignoreBackgroundClick",!0)("id","rewards_list"),o.Bb(2),o.jc("ngIf",e.cache.isLoadingProgressRunning("openContainer")),o.Bb(1),o.jc("ngIf",e.type&&e.type.length),o.Bb(2),o.jc("ngIf",e.type===e.RewardType.Task||e.type===e.RewardType.League),o.Bb(1),o.jc("ngIf",e.type===e.RewardType.DLC&&!e.rewardsVisible),o.Bb(1),o.jc("ngIf",e.rewardsVisible))},directives:[Qh,ee,Qf,Zv,ug],encapsulation:2}),t})();var _R=function(t){return t.Unit="unit",t.Commander="commander",t.Campaign="campaign",t.Wreath="wreath",t.Portrait="portrait",t}({});const kR=["userMainImage"],wR=function(){return["/campaigns/"]},SR=function(){return{hover:"ui_hover_top_panel",click:"ui_click_default"}};function IR(t,e){if(1&t){const t=o.Sb();o.Rb(0,"a",13),o.Yb("click",function(){return o.zc(t),o.bc().triggerGlobalEvent("button.navigation.campaigns")}),o.Rb(1,"span",12),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Fb("active",t.isNotTutorialCampaignSelected())("disabled",!t.allow("campaign.menu")||!t.userIsTeamOwner&&t.teamId&&t.redirectLocation&&!t.redirectLocation.campaign),o.kc("tooltip-hint",t.L("meta.ui.menu.campaigns")),o.jc("routerLink",o.mc(8,wR))("alertSound",o.mc(9,SR)),o.Bb(2),o.Mc(t.L("meta.ui.menu.campaigns"))}}function CR(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",26),o.Yb("click",function(){return o.zc(t),o.bc().leaveFromLobby()}),o.Rb(1,"span",27),o.Ob(2,"img",28),o.Ob(3,"img",29),o.Qb(),o.Lc(4),o.Qb()}if(2&t){const t=o.bc();o.kc("tooltip-hint",t.L("meta.ui.lobby.lobby_leave_custom")),o.jc("alertSound",o.mc(3,SR)),o.Bb(4),o.Nc(" ",t.L("meta.ui.lobby.lobby_leave_custom")," ")}}function LR(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",33),o.Yb("click",function(){return o.zc(t),o.bc(2).leaveFromTeam()}),o.Ob(1,"img",34),o.Qb()}if(2&t){const t=o.bc(2);o.Fb("spaced-left",t.teamMembers.length<t.maxTeamLength),o.kc("tooltip-hint",t.L("meta.ui.team.exit")),o.jc("alertSound",o.mc(4,SR))}}function RR(t,e){1&t&&(o.Rb(0,"span",42),o.Ob(1,"img",43),o.Qb())}function OR(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",44),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit;return o.bc(2).removeUserFromTeam(e.id)}),o.Ob(1,"img",45),o.Qb()}if(2&t){const t=o.bc(3);o.kc("tooltip-hint",t.L("meta.ui.chat.system.team_friend_remove")),o.jc("alertSound",o.mc(2,SR))}}const TR=function(t,e){return{portrait:t,wreath:e}},xR=function(t,e,i,n,s,a,r){return{displayName:t,commanderLevel:e,onlineStatus:null,league:i,commander:n,leader:s,self:a,avatar:r}};function BR(t,e){if(1&t&&o.Ob(0,"user-image",25),2&t){const t=o.bc().$implicit,e=o.bc(2);o.jc("player",o.tc(7,xR,t.displayName,t.commander?t.commander.maxUnitLevel:null,t.league,t.commander&&t.commander.template?e.cache.getCommander(t.commander.template).type:"","leader"==t.state,t.id==e.userId,t.id==e.userId?o.oc(1,TR,e.userAvatar.portrait,e.userAvatar.wreath):o.oc(4,TR,t.portrait,t.wreath)))}}function jR(t,e){if(1&t&&o.Ob(0,"img",46),2&t){const t=o.bc().$implicit;o.jc("src","assets/img/icons/svg/check_circle_"+t.online.state+".svg",o.Cc)}}function MR(t,e){1&t&&o.Ob(0,"span",47)}function QR(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",35),o.Yb("click",function(){o.zc(t);const e=o.bc(2);return e.allow("social.menu")?e.emitChatOpen():e.void()}),o.Rb(1,"div",36),o.Jc(2,RR,2,0,"span",37),o.Jc(3,OR,2,3,"button",38),o.Qb(),o.Jc(4,BR,1,15,"user-image",39),o.Jc(5,jR,1,1,"img",40),o.Jc(6,MR,1,0,"span",41),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Fb("not-confirmed","requested"===t.state||"accepted"===t.state),o.jc("alertSound",o.mc(8,SR)),o.Bb(2),o.jc("ngIf","leader"==t.state),o.Bb(1),o.jc("ngIf",i.userIsTeamOwner&&"leader"!==t.state&&"empty"!==t),o.Bb(1),o.jc("ngIf","empty"!=t),o.Bb(1),o.jc("ngIf",t.ready),o.Bb(1),o.jc("ngIf","empty"==t)}}const AR=function(t){return[t]};function DR(t,e){if(1&t&&(o.Rb(0,"div",30),o.Jc(1,LR,2,5,"button",31),o.Jc(2,QR,7,9,"div",32),o.cc(3,"slice"),o.Qb()),2&t){const t=o.bc();o.kc("tooltip-hint",t.getTeamTooltip()),o.Bb(1),o.jc("ngIf",t.teamMembers&&t.teamMembers.length&&t.teamId),o.Bb(1),o.jc("ngForOf",o.fc(3,3,t.teamMembers,0,o.nc(7,AR,t.teamMaxMemberCount)))}}function ER(t,e){if(1&t&&o.Ob(0,"span",48),2&t){const t=o.bc();o.Cb("data-value",t.unreadedMessagesCount?t.unreadedMessagesCount:"")}}function NR(t,e){if(1&t&&o.Ob(0,"span",48),2&t){const t=o.bc();o.Cb("data-value",t.unreadedHQCount)}}const FR=function(){return["/editor"]};function PR(t,e){1&t&&(o.Rb(0,"a",49),o.Ob(1,"img",50),o.Qb()),2&t&&o.jc("routerLink",o.mc(2,FR))("alertSound",o.mc(3,SR))}const UR=function(){return["/multiplayer/lobby"]},zR=function(){return["/multiplayer"]},JR=function(){return["/tutorial"]},qR=function(t,e,i,n){return{displayName:t,onlineStatus:e,league:i,avatar:n}};let VR=(()=>{class t{constructor(t,e,i,n,s,a,r,c,l){this.cache=t,this.chatService=e,this.cdr=i,this.helpService=n,this.profileService=s,this.router=a,this.visitService=r,this.lobbyService=c,this.redirectService=l,this.userId="",this.onlineStatus="",this.localizator=new al,this.onChatOpen=new o.o,this.globalEvent=new uu,this.demoModeEnabled=!1,this.userIsTeamOwner=!1,this.teamId="",this.teamMembers=[],this.teamData=null,this.currentUrl="",this.navigationTop=!1,this.friendRequestData=null,this.newFriendRequest=!1,this.teamMaxMemberCount=5,this.redirectLocation=null,this.userId=this.cache.getUserId(),this.user=this.cache.getUser(),this.userAvatar=this.profileService.getUserAvatar(),this.localizator.data.subscribe(t=>this.L=t),this.demoModeEnabled=this.cache.demoModeEnabled()}ngOnInit(){this.currentUrl=this.router.url,this.userIsTeamOwner=this.cache.isTeamOwner(),this.teamData=this.chatService.getTeamData(),this.teamData&&(this.teamMembers=this.computeTeamMembers(),this.teamId=this.cache.getUserTeamId()),this.chatService.globalMessages.subscribe(t=>{t&&t.length&&(this.unreadedMessagesCount=this.chatService.getUnreadedMessagesCount(),this.unreadedHQCount=this.chatService.getUnreadedHQNotificationCount())}),this.teamDataSubscription=this.chatService.teamsData.pipe(We(t=>null!==t)).subscribe(t=>{t&&t.id&&(this.teamId=t.id,this.teamMembers=this.computeTeamMembers(),this.teamData=t),t&&t.leave&&!0===t.leave&&(this.teamMembers=[],this.teamId="",this.teamData=null),this.userIsTeamOwner=this.cache.isTeamOwner()}),this.cache.onlineStatus.subscribe(t=>{this.onlineStatus=t}),this.lobbyService.onLobbyInvite.pipe(We(t=>null!==t)).subscribe(t=>{t&&this.sendLobbyNotification(t)}),this.profileAvatarSubscription=this.profileService.onAvatarChange.pipe(We(t=>null!==t)).subscribe(t=>{this.userAvatar=this.profileService.getUserAvatar()}),this.router.events.subscribe(t=>{t instanceof Ci&&t.url&&(this.currentUrl=t.url)}),this.globalEvent.subscribe(t=>{"navigation.to_top"==t.key&&(this.navigationTop=!0),"navigation.to_bottom"==t.key&&(this.navigationTop=!1)}),this.chatService.friendRequestIn.pipe(We(t=>null!==t)).subscribe(t=>{t&&t.id&&(this.visitService.visit("friendRequest"+t.id),this.friendRequestData=t,this.newFriendRequest=!0)}),this.visitService.onVisit.subscribe(()=>{this.friendRequestData&&this.friendRequestData.id&&!this.visitService.isVisited("friendRequest"+this.friendRequestData.id)&&(this.friendRequestData=null,this.newFriendRequest=!1)}),this.redirectService.onLocationChange.subscribe(t=>{this.redirectLocation=t})}isTutorialCampaignSelected(){return!!this.currentUrl.match(/tutorial/g)}isNotTutorialCampaignSelected(){return!(!this.currentUrl.match(/campaigns/g)||this.currentUrl.match(/tutorial/g))}ngAfterViewChecked(){this.cdr.detectChanges()}emitChatOpen(){this.triggerGlobalEvent("friends.open",{tutorial:!0,tutorialFriends:!0}),this.friendRequestData&&this.friendRequestData.id&&(this.visitService.clear("friendRequest"+this.friendRequestData.id),this.friendRequestData=null,this.newFriendRequest=!1)}toggleHQMessages(){this.triggerGlobalEvent("hq_messages.toggle")}isFeaturesAvailable(){return this.cache.hasFlag("features_in_progress")}allow(t){return this.cache.allow(t)}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e||{})}openHelpWindow(t){this.helpService.openWindow(t)}computeTeamMembers(){let t=this.chatService.getTeamMembers().sort((t,e)=>t.id==this.userId?-1:1);if(t.length<5){let e=t.length;for(;e<5;)t.splice(e,0,"empty"),e++}return t}leaveFromTeam(){this.cache.startLoadingProgress("teamOperation");let t={team:this.cache.getUserTeamId(),operation:"leave",player:this.cache.getUserId()};this.chatService.teamOperation(t).then(t=>{this.cache.stopLoadingProgress("teamOperation")})}removeUserFromTeam(t){this.userIsTeamOwner&&this.teamMembers.length&&this.chatService.teamOperation({operation:"reject",player:t,team:this.teamId})}void(){}hasLobby(){return this.lobbyService.hasLobby()}leaveFromLobby(){let t=this.lobbyService.lobbyGetId();t&&this.lobbyService.lobbyLeave(t)}sendLobbyNotification(t){if(!t)return;let e=this.chatService.getFriends().find(e=>e.id==t.from.id),i=e?{displayName:e.displayName,league:e.league,avatar:{portrait:e.portrait,wreath:e.wreath}}:null;this.chatService.sendMessageToHQChat(this.L("meta.ui.chat."+t.lobbyType+".request_title"),this.L("meta.ui.chat."+t.lobbyType+".join_message",{name:e.displayName}),"invitation_lobby_"+(new Date).getTime(),{player:i},{key:"lobby_invitation.accept",data:t},{key:"lobby_invitation.decline",data:t}),this.cache.alertSound("ui_lobby_invite")}onOptions(){alert("options")}getTeamTooltip(){if(!this.teamMembers||!this.teamMembers.length||!this.teamId)return;let t="";for(let e of this.teamMembers)if("empty"!=e){let i=e.displayName,n=this.L(e.id==this.userId?"meta.ui.members.state.user":"meta.ui.members.state."+e.state),s=this.L(e.commander?"commander."+e.commander.template+".name":"meta.ui.not_selected");t=t.concat(`<div class="margin-bottom-small cell"><div class="color-white">${i}</div><div class="color-white-blue">${n}</div><div>${s}</div></div>`)}return t}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Pd),o.Nb(o.h),o.Nb(Kd),o.Nb(Ou),o.Nb(Ys),o.Nb(Sl),o.Nb(Bl),o.Nb(Md))},t.\u0275cmp=o.Hb({type:t,selectors:[["app-navigation"]],viewQuery:function(t,e){if(1&t&&o.Qc(kR,!0),2&t){let t;o.vc(t=o.Zb())&&(e.userMainImage=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("to-top",e.navigationTop)},outputs:{onChatOpen:"onChatOpen"},features:[o.Ab([Pd,Tl,Sl,Bl,Kd,Ou])],decls:31,vars:57,consts:[[1,"grid-navigation"],["options",""],[1,"wrapper"],["type","button",3,"tooltip-hint","alertSound","click"],["draggable","false","src","assets/img/icons/svg/settings.svg",1,"icon"],["logo",""],[1,"logo-cover"],["src","assets/img/logo_spark.png","alt","logo","draggable","false"],["menu",""],["href","","queryParamsHandling","merge","class","button navigation-button",3,"routerLink","active","tooltip-hint","alertSound","disabled","click",4,"ngIf"],["type","button","class","button white lobby-exit",3,"tooltip-hint","alertSound","click",4,"ngIf"],["href","","queryParamsHandling","merge","routerLinkActive","active",1,"button","navigation-button",3,"routerLink","alertSound","tooltip-hint","click"],[1,"text"],["href","","queryParamsHandling","merge",1,"button","navigation-button",3,"routerLink","tooltip-hint","alertSound","click"],["buttons",""],["class","team-group",3,"tooltip-hint",4,"ngIf"],["type","button",1,"button","friends-button","action-button",3,"alertSound","tooltip-hint","click"],["src","assets/img/icons/svg/friends-icon.svg","alt","icon","image-load","","draggable","false",1,"icon"],["class","marker",4,"ngIf"],[1,"hq-messages-cover"],["type","button",1,"button","notification-button","action-button",3,"alertSound","tooltip-hint","click"],["src","assets/img/icons/svg/notification-icon.svg","image-load","","draggable","false",1,"icon","animated-icon"],["href","","queryParamsHandling","merge","routerLinkActive","active","class","button action-button debug-button",3,"routerLink","alertSound",4,"ngIf"],["avatar",""],["href","","queryParamsHandling","merge","routerLinkActive","active",1,"profile-link",3,"routerLink","alertSound","tooltip-hint"],[3,"player"],["type","button",1,"button","white","lobby-exit",3,"tooltip-hint","alertSound","click"],[1,"icon-group"],["src","assets/img/icons/svg/back-button-icon.svg","draggable","false",1,"icon","hover-hidden"],["src","assets/img/icons/svg/back-button-icon_hover.svg","draggable","false",1,"icon","hover-visible"],[1,"team-group",3,"tooltip-hint"],["class","button team-exit",3,"tooltip-hint","alertSound","spaced-left","click",4,"ngIf"],["class","member",3,"not-confirmed","alertSound","click",4,"ngFor","ngForOf"],[1,"button","team-exit",3,"tooltip-hint","alertSound","click"],["src","assets/img/icons/svg/exit.svg",1,"icon","medium"],[1,"member",3,"alertSound","click"],[1,"top-button"],["class","control-button",4,"ngIf"],["type","button","class","control-button clickable",3,"tooltip-hint","alertSound","click",4,"ngIf"],[3,"player",4,"ngIf"],["class","ready-icon",3,"src",4,"ngIf"],["class","empty member",4,"ngIf"],[1,"control-button"],["src","assets/img/icons/svg/leader_active.svg","alt","icon","image-load","","draggable","false",1,"icon"],["type","button",1,"control-button","clickable",3,"tooltip-hint","alertSound","click"],["src","assets/img/icons/svg/cross-icon.svg","draggable","false"],[1,"ready-icon",3,"src"],[1,"empty","member"],[1,"marker"],["href","","queryParamsHandling","merge","routerLinkActive","active",1,"button","action-button","debug-button",3,"routerLink","alertSound"],["src","assets/img/icons/svg/bug.svg","alt","",1,"icon"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Rb(1,"div",1),o.Rb(2,"div",2),o.Rb(3,"button",3),o.Yb("click",function(){return e.onOptions(),e.triggerGlobalEvent("button.navigation.options")}),o.Ob(4,"img",4),o.Qb(),o.Qb(),o.Qb(),o.Rb(5,"div",5),o.Rb(6,"figure",6),o.Ob(7,"img",7),o.Qb(),o.Qb(),o.Rb(8,"div",8),o.Rb(9,"nav"),o.Jc(10,IR,3,10,"a",9),o.Jc(11,CR,5,4,"button",10),o.Rb(12,"a",11),o.Yb("click",function(){return e.triggerGlobalEvent("button.navigation.multiplayer")}),o.Rb(13,"span",12),o.Lc(14),o.Qb(),o.Qb(),o.Rb(15,"a",13),o.Yb("click",function(){return e.triggerGlobalEvent("button.navigation.learn")}),o.Rb(16,"span",12),o.Lc(17),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(18,"div",14),o.Jc(19,DR,4,9,"div",15),o.Rb(20,"button",16),o.Yb("click",function(){return e.allow("social.menu")?e.emitChatOpen():e.void()}),o.Ob(21,"img",17),o.Jc(22,ER,1,1,"span",18),o.Qb(),o.Rb(23,"div",19),o.Rb(24,"button",20),o.Yb("click",function(){return e.toggleHQMessages()}),o.Ob(25,"img",21),o.Jc(26,NR,1,1,"span",18),o.Qb(),o.Qb(),o.Jc(27,PR,2,4,"a",22),o.Qb(),o.Rb(28,"div",23),o.Rb(29,"a",24),o.Ob(30,"user-image",25),o.Qb(),o.Qb(),o.Qb()),2&t&&(o.Bb(3),o.kc("tooltip-hint",e.L("meta.hint.menu.option")),o.jc("alertSound",o.mc(38,SR)),o.Bb(7),o.jc("ngIf",!e.hasLobby()),o.Bb(1),o.jc("ngIf",e.hasLobby()),o.Bb(1),o.Fb("disabled",!e.allow("multi.mm.menu")||!e.userIsTeamOwner&&e.teamId&&e.redirectLocation&&!e.redirectLocation.multiplayer),o.kc("tooltip-hint",e.L("meta.ui.menu.multiplayer_button")),o.jc("routerLink",e.hasLobby()?o.mc(39,UR):o.mc(40,zR))("alertSound",o.mc(41,SR)),o.Bb(2),o.Mc(e.L("meta.ui.menu.multiplayer_button")),o.Bb(1),o.Fb("active",e.isTutorialCampaignSelected())("disabled",!e.allow("learn.menu")),o.kc("tooltip-hint",e.L("meta.ui.menu.learn")),o.jc("routerLink",o.mc(42,JR))("alertSound",o.mc(43,SR)),o.Bb(2),o.Mc(e.L("meta.ui.menu.learn")),o.Bb(2),o.jc("ngIf",!e.demoModeEnabled),o.Bb(1),o.Fb("disabled",!e.allow("social.menu")),o.kc("tooltip-hint",e.L("meta.hint.button.friends_menu_open")),o.jc("alertSound",o.mc(44,SR)),o.Bb(2),o.jc("ngIf",e.unreadedMessagesCount||e.newFriendRequest),o.Bb(2),o.Fb("disabled",!e.allow("notifications.menu"))("animated",e.unreadedHQCount),o.kc("tooltip-hint",e.L("meta.hint.button.notification_open")),o.jc("alertSound",o.mc(45,SR)),o.Bb(2),o.jc("ngIf",e.unreadedHQCount),o.Bb(1),o.jc("ngIf",e.cache.hasFlag("debug")),o.Bb(2),o.Fb("disabled",!e.allow("profile.menu")),o.kc("tooltip-hint",e.L("meta.ui.chat.profile_option.view_profile")),o.jc("routerLink",o.nc(46,AR,"/profile/"+e.userId))("alertSound",o.mc(48,SR)),o.Bb(1),o.jc("player",o.qc(52,qR,e.user.displayName,e.onlineStatus,e.user.league&&e.user.league.id?e.user.league.id:"",o.oc(49,TR,e.userAvatar.portrait,e.userAvatar.wreath))))},encapsulation:2}),t})();const $R=["scrollable"],GR=["selectBotModal"],HR=["botFilterSeekLink"],YR=["lobbyMembersModal"],WR=["lobbyInvitationModal"],KR=["commanders"],XR=["chatInput"],ZR=["chat"],tO=["botSelect"];function eO(t,e){if(1&t&&(o.Rb(0,"h3",53),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.L("meta.ui.play."+t.lobbyType+".title"))}}function iO(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Nc("",t.L("meta.ui.lobby.options.submode."+(t.options.submode||"none")).trim(),", ")}}function nO(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Nc("",t.L("meta.ui.lobby.options.army."+t.options.armyMode).trim(),", ")}}function sO(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.L("meta.mission."+t.options.map+".name").trim())}}function aO(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Oc("",t.playersReady," ",t.L(1==t.playersReady?"meta.ui.lobby.lobby_player_ready":"meta.ui.lobby.lobby_players_ready"),"")}}function rO(t,e){if(1&t&&(o.Rb(0,"span",55),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("commander."+t.selectedCommander._id+".name")),o.Bb(1),o.Nc(" ",t.L("commander."+t.selectedCommander._id+".name")," ")}}const oO=function(){return{hover:"ui_hover_side_panel",click:"ui_click_default"}};function cO(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",4),o.Yb("click",function(){o.zc(t);const e=o.bc();return e.goToCommanders(),e.triggerGlobalEvent("button.select_troops")}),o.Ob(1,"span",5),o.Rb(2,"span",6),o.Lc(3),o.Qb(),o.Rb(4,"span",7),o.Jc(5,rO,2,2,"span",54),o.Qb(),o.Ob(6,"img",9),o.Ob(7,"img",10),o.Qb()}if(2&t){const t=o.bc();o.Fb("active","troops"==t.tab)("disabled",t.buttonsLocked),o.kc("tooltip-hint",t.L("meta.ui.play.select_troops")),o.jc("alertSound",o.mc(10,oO)),o.Bb(3),o.Mc(t.L("meta.ui.play.select_troops")),o.Bb(2),o.jc("ngIf",t.selectedCommander&&t.selectedCommander._id),o.Bb(1),o.jc("src","assets/img/icons/buttons/lobby_batallion.svg",o.Cc),o.Bb(1),o.jc("src","assets/img/icons/buttons/lobby_batallion_hover.svg",o.Cc)}}function lO(t,e){if(1&t&&(o.Rb(0,"h3",59),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.Fb("color-primary",t.teamSide==t.LobbyTeam.Spectators),o.Bb(1),o.Mc(t.L("meta.ui.lobby.team_s.title"))}}function uO(t,e){if(1&t&&o.Ob(0,"img",72),2&t){const t=o.bc(2).$implicit,e=o.bc(2);o.jc("src","assets/img/flags/campaign_"+e.getUserArmy(t.player.commander.template)+".png",o.Cc)}}function dO(t,e){if(1&t&&(o.Rb(0,"div",73),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).$implicit,e=o.bc(2);o.Bb(1),o.Mc(e.L("commander."+t.player.commander.template+".name"))}}function hO(t,e){if(1&t&&o.Ob(0,"img",74),2&t){const t=o.bc(2).$implicit;o.jc("src","assets/img/icons/svg/check_circle_"+t.player.online.state+".svg",o.Cc)}}function bO(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",75),o.Yb("click",function(){o.zc(t),o.bc();const e=o.wc(10),i=o.bc().$implicit;return o.bc(2).lobbyKickPlayer(i.playerId),e.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(4);o.Bb(1),o.Fb("disabled",t.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.kick_player")," ")}}function mO(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",75),o.Yb("click",function(){o.zc(t),o.bc();const e=o.wc(10),i=o.bc().$implicit;return o.bc(2).addNewFriendRequest(i.playerId),e.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(4);o.Bb(1),o.Fb("disabled",t.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.friend.action_add")," ")}}function pO(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",75),o.Yb("click",function(){return o.zc(t),o.bc(4).lobbyTakeSlot("u")}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(4);o.Bb(1),o.Fb("disabled",t.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.custom.take_u")," ")}}const gO=function(t,e){return{portrait:t,wreath:e}},fO=function(t,e,i,n,s,a,r){return{displayName:t,onlineStatus:null,league:e,premium:!1,commander:i,leader:n,level:s,commanderLevel:a,avatar:r}};function vO(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div"),o.Jc(1,uO,1,1,"img",61),o.Rb(2,"div",62),o.Ob(3,"user-image",63),o.Qb(),o.Rb(4,"div",64),o.Ob(5,"nickname",65),o.Jc(6,dO,2,1,"div",66),o.Qb(),o.Rb(7,"div",67),o.Jc(8,hO,1,1,"img",68),o.Rb(9,"dropdown",69,70),o.Yb("onOpen",function(){o.zc(t);const e=o.bc().index;return o.bc(2).openedSlotIndex=e})("onClose",function(){return o.zc(t),o.bc(3).openedSlotIndex=null}),o.Rb(11,"ul",71),o.Jc(12,bO,3,4,"li",8),o.Jc(13,mO,3,4,"li",8),o.Jc(14,pO,3,4,"li",8),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc().$implicit,e=o.bc().key,i=o.bc();o.Bb(1),o.jc("ngIf","player"==t.state&&t.player.commander&&!t.player.commander.hidden&&e!==i.LobbyTeam.Spectators&&t.player.ready&&1==t.player.ready),o.Bb(2),o.jc("player",o.tc(16,fO,t.player.displayName,t.player.league,t.player.commander&&!t.player.commander.hidden&&e!==i.LobbyTeam.Spectators?i.getUserCommander(t.player.commander.template):null,t.player.id==i.lobbyOwner,t.player.commander&&!t.player.commander.hidden?null:t.player.level,t.player.commander&&!t.player.commander.hidden?t.player.commander.maxUnitLevel:null,o.oc(13,gO,t.player.portrait,t.player.wreath))),o.Bb(2),o.jc("name",t.player.displayName||"No Name"),o.Bb(1),o.jc("ngIf",t.player.commander&&t.player.commander.template&&e!==i.LobbyTeam.Spectators&&t.player.ready&&1==t.player.ready),o.Bb(2),o.jc("ngIf",t.player.ready&&1==t.player.ready),o.Bb(1),o.Fb("visible",t.playerId==i.userId||i.userIsLobbyOwner),o.kc("tooltip-hint",i.L("meta.ui.lobby.slot.option")),o.jc("icon","tree-points")("btn","control-button"),o.Bb(3),o.jc("ngIf",i.userIsLobbyOwner&&t.playerId!==i.userId),o.Bb(1),o.jc("ngIf",!i.checkIfUserIsAFriend(t.playerId)&&t.playerId&&t.playerId!==i.userId),o.Bb(1),o.jc("ngIf",t.playerId==i.userId)}}function yO(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",83),o.Yb("click",function(){o.zc(t),o.bc();const e=o.wc(4),i=o.bc(2).$implicit,n=o.bc().key;return o.bc().openBotSelection(i.id,n),e.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(4).key,e=o.bc();o.Fb("hidden","coop"==e.options.mode&&t==e.LobbyTeam.TeamA),o.Bb(1),o.Fb("disabled",e.buttonsLocked),o.Bb(1),o.Nc(" ",e.L("meta.ui.lobby.add_bot")," ")}}function _O(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",83),o.Yb("click",function(){o.zc(t),o.bc();const e=o.wc(4),i=o.bc(2).$implicit;return o.bc(2).lobbySetupSlot(i.id,"closed"),e.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(5);o.Bb(1),o.Fb("disabled",t.buttonsLocked),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.close_slot")," ")}}function kO(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",67),o.Rb(1,"button",80),o.Yb("click",function(){o.zc(t);const e=o.bc(2).$implicit,i=o.bc(2);return i.triggerGlobalEvent("button.lobby.take_slot"),i.lobbyTakeSlot(e.id)}),o.Lc(2),o.Qb(),o.Rb(3,"dropdown",81,82),o.Yb("onOpen",function(){o.zc(t);const e=o.bc(2).index;return o.bc(2).openedSlotIndex=e})("onClose",function(){return o.zc(t),o.bc(4).openedSlotIndex=null}),o.Rb(5,"ul",71),o.Rb(6,"li"),o.Rb(7,"button",83),o.Yb("click",function(){o.zc(t);const e=o.wc(4),i=o.bc(2).$implicit,n=o.bc().key;return o.bc().openInvitationModal(i.id,n),e.hide()}),o.Lc(8),o.Qb(),o.Qb(),o.Jc(9,yO,3,5,"li",84),o.Jc(10,_O,3,3,"li",8),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc(3).key,e=o.bc();o.Bb(1),o.Fb("hidden","pve"==e.options.mode&&t==e.LobbyTeam.TeamB)("disabled",e.buttonsLocked),o.kc("tooltip-hint",e.L("meta.ui.lobby.take_slot")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.lobby.take_slot")," "),o.Bb(1),o.kc("tooltip-hint",e.L("meta.ui.lobby.slot.options")),o.jc("icon","tree-points")("btn","control-button"),o.Bb(3),o.Fb("hidden","pve"==e.options.mode&&t==e.LobbyTeam.TeamB),o.Bb(1),o.Fb("disabled",e.buttonsLocked),o.Bb(1),o.Nc(" ",e.L("meta.ui.lobby.add_player")," "),o.Bb(1),o.jc("ngIf",e.userIsLobbyOwner&&t!==e.LobbyTeam.Spectators&&"custom"==e.lobbyType),o.Bb(1),o.jc("ngIf",e.userIsLobbyOwner&&"duel"!==e.options.mode)}}function wO(t,e){if(1&t&&(o.Rb(0,"div"),o.Rb(1,"div",76),o.Ob(2,"img",77),o.Qb(),o.Rb(3,"div",64),o.Rb(4,"div",78),o.Lc(5),o.Qb(),o.Qb(),o.Jc(6,kO,11,17,"div",79),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(2);o.Bb(1),o.Fb("animated",e.loadingAI&&e.activeSlotWithAI&&e.activeSlotWithAI==t.id),o.Bb(1),o.jc("src",e.loadingAI&&e.activeSlotWithAI&&e.activeSlotWithAI==t.id?"assets/img/icons/svg/lobby-update.svg":"assets/img/icons/svg/user-empty.svg",o.Cc),o.Bb(3),o.Nc(" ",e.L(e.loadingAI&&e.activeSlotWithAI&&e.activeSlotWithAI==t.id?"meta.ui.lobby.slot_ai_loading":"meta.ui.lobby.slot_state_"+t.state)," "),o.Bb(1),o.jc("ngIf",!e.loadingAI&&!e.activeSlotWithAI)}}function SO(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",89),o.Yb("click",function(){o.zc(t),o.bc();const e=o.wc(3),i=o.bc(2).$implicit;return o.bc(2).lobbySetupSlot(i.id,"open"),e.hide()}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(5);o.Fb("disabled",t.buttonsLocked),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.open_slot")," ")}}function IO(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",83),o.Yb("click",function(){o.zc(t),o.bc();const e=o.wc(3),i=o.bc(2).$implicit,n=o.bc().key;return o.bc().openBotSelection(i.id,n),e.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(5);o.Bb(1),o.Fb("disabled",t.buttonsLocked),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.add_bot")," ")}}function CO(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",67),o.Jc(1,SO,2,3,"button",87),o.Rb(2,"dropdown",81,88),o.Yb("onOpen",function(){o.zc(t);const e=o.bc(2).index;return o.bc(2).openedSlotIndex=e})("onClose",function(){return o.zc(t),o.bc(4).openedSlotIndex=null}),o.Rb(4,"ul",71),o.Jc(5,IO,3,3,"li",8),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc(3).key,e=o.bc();o.Bb(1),o.jc("ngIf","duel"!==e.options.mode),o.Bb(1),o.Fb("disabled",e.options&&"coop"===e.options.mode),o.kc("tooltip-hint",e.L("meta.ui.lobby.slot.options")),o.jc("icon","tree-points")("btn","control-button"),o.Bb(3),o.jc("ngIf",e.userIsLobbyOwner&&t!==e.LobbyTeam.Spectators)}}function LO(t,e){if(1&t&&(o.Rb(0,"div",55),o.Rb(1,"div",76),o.Ob(2,"img",85),o.Qb(),o.Rb(3,"div",64),o.Rb(4,"div",86),o.Lc(5),o.Qb(),o.Qb(),o.Jc(6,CO,6,7,"div",79),o.Qb()),2&t){const t=o.bc(),e=t.$implicit,i=t.index,n=o.bc(2);o.kc("tooltip-hint",n.L("meta.ui.lobby.option_blocked")),o.Bb(5),o.Mc(n.L("meta.ui.lobby.slot_state_"+e.state)),o.Bb(1),o.jc("ngIf",n.userIsLobbyOwner&&(!n.options.size||i+1<=n.options.size))}}function RO(t,e){if(1&t&&o.Ob(0,"img",72),2&t){const t=o.bc(2).$implicit;o.jc("src","assets/img/flags/campaign_"+t.bot.army+".png",o.Cc)}}const OO=function(){return{portrait:"",wreath:""}},TO=function(t,e,i,n){return{displayName:t,onlineStatus:null,premium:!1,commander:e,commanderLevel:i,avatar:n}};function xO(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div"),o.Jc(1,RO,1,1,"img",61),o.Rb(2,"div",90),o.Ob(3,"user-image",63),o.Qb(),o.Rb(4,"div",64),o.Ob(5,"nickname",65),o.Rb(6,"div",73),o.Lc(7),o.Qb(),o.Qb(),o.Rb(8,"div",67),o.Ob(9,"img",91),o.Rb(10,"dropdown",69,92),o.Yb("onOpen",function(){o.zc(t);const e=o.bc().index;return o.bc(2).openedSlotIndex=e})("onClose",function(){return o.zc(t),o.bc(3).openedSlotIndex=null}),o.Rb(12,"ul",71),o.Rb(13,"li"),o.Rb(14,"button",75),o.Yb("click",function(){o.zc(t);const e=o.wc(11),i=o.bc().$implicit;return o.bc(2).lobbySetupSlot(i.id,"open"),e.hide()}),o.Lc(15),o.Qb(),o.Qb(),o.Rb(16,"li"),o.Rb(17,"button",75),o.Yb("click",function(){o.zc(t);const e=o.wc(11),i=o.bc().$implicit;return o.bc(2).lobbySetupSlot(i.id,"closed"),e.hide()}),o.Lc(18),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc().$implicit,e=o.bc(2);o.Bb(1),o.jc("ngIf",t.bot&&t.bot.army),o.Bb(1),o.kc("tooltip-hint",t.bot&&t.bot.bot&&t.bot.bot.icon?"<h4>"+e.L("commander."+t.bot.bot.icon+".name")+"</h4>\n"+e.L("commander."+t.bot.bot.icon+".desc"):e.L("meta.ui.lobby.select_bot.button_random")),o.Bb(1),o.jc("player",o.qc(19,TO,t.bot&&t.bot.bot&&t.bot.bot.level?e.L("meta.ui.stats.ai")+", "+e.L("meta.ui.lobby.options.unit_level."+t.bot.bot.level):e.L("meta.ui.stats.ai"),e.getBotCommanderType(t.playerId),t.bot&&t.bot.bot&&t.bot.bot.level?t.bot.bot.level:null,o.mc(18,OO))),o.Bb(2),o.jc("name",t.bot&&t.bot.bot&&t.bot.bot.level?e.L("meta.ui.stats.ai")+", "+e.L("meta.ui.lobby.options.unit_level."+t.bot.bot.level):e.L("meta.ui.stats.ai")),o.Bb(2),o.Mc(t.bot&&t.bot.id?e.L("commander."+t.bot.text+".name").dropDashSpace():e.L("meta.ui.lobby.select_bot.button_random")),o.Bb(3),o.Fb("visible",e.userIsLobbyOwner),o.kc("tooltip-hint",e.L("meta.ui.lobby.slot.option")),o.jc("icon","tree-points")("btn","control-button"),o.Bb(4),o.Fb("disabled",e.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.lobby.custom.remove_ai")," "),o.Bb(2),o.Fb("disabled",e.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.lobby.close_slot")," ")}}function BO(t,e){if(1&t&&(o.Rb(0,"div",55),o.Rb(1,"div",76),o.Ob(2,"img",85),o.Qb(),o.Rb(3,"div",64),o.Rb(4,"div",86),o.Lc(5),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(2);o.kc("tooltip-hint",e.L("meta.hint.lobby.slot_disabled")),o.Bb(5),o.Mc(e.L("meta.ui.lobby.slot_state_"+t.state))}}function jO(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",75),o.Yb("click",function(){o.zc(t),o.bc();const e=o.wc(1),i=o.bc(2).$implicit;return o.bc(2).lobbyKickPlayer(i.playerId),e.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(5);o.Bb(1),o.Fb("disabled",t.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.lobby.kick_player")),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.kick_player")," ")}}function MO(t,e){if(1&t){const t=o.Sb();o.Rb(0,"dropdown",94,95),o.Yb("onOpen",function(){o.zc(t);const e=o.bc(2).index;return o.bc(2).openedSlotIndex=e})("onClose",function(){return o.zc(t),o.bc(4).openedSlotIndex=null}),o.Rb(2,"ul",71),o.Jc(3,jO,3,5,"li",8),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2).$implicit,e=o.bc(2);o.kc("tooltip-hint",e.L("meta.ui.lobby.slot.option")),o.jc("icon","tree-points")("btn","control-button"),o.Bb(3),o.jc("ngIf",e.userIsLobbyOwner&&t.playerId!==e.userId)}}const QO=function(t,e,i,n,s,a){return{displayName:t,onlineStatus:null,league:e,commander:i,leader:n,commanderLevel:s,avatar:a}};function AO(t,e){if(1&t&&(o.Rb(0,"div",55),o.Rb(1,"div",62),o.Ob(2,"user-image",63),o.Qb(),o.Rb(3,"div",64),o.Ob(4,"nickname",65),o.Rb(5,"div",73),o.Lc(6),o.Qb(),o.Qb(),o.Rb(7,"div",67),o.Jc(8,MO,4,4,"dropdown",93),o.Qb(),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(2);o.kc("tooltip-hint",e.L("meta.hint.lobby.slot_invited")),o.Bb(2),o.jc("player",o.sc(8,QO,t.player.displayName,t.player.league,t.player.commander&&!t.player.commander.hidden?e.getUserCommander(t.player.commander.template):null,t.player.id==e.lobbyOwner,t.player.commander&&!t.player.commander.hidden?t.player.commander.maxUnitLevel:null,o.oc(5,gO,t.player.portrait,t.player.wreath))),o.Bb(2),o.jc("name",t.player.displayName||"No Name"),o.Bb(2),o.Mc(e.L("meta.ui.lobby.slot_state_"+t.state)),o.Bb(2),o.jc("ngIf",t.playerId==e.userId||e.userIsLobbyOwner)}}function DO(t,e){if(1&t&&(o.Rb(0,"div",55),o.Rb(1,"div",76),o.Ob(2,"img",85),o.Qb(),o.Rb(3,"div",64),o.Rb(4,"div",78),o.Lc(5),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc(3);o.kc("tooltip-hint",t.L("meta.ui.lobby.slot.not_available")),o.Bb(5),o.Mc(t.L("meta.ui.lobby.slot.not_available"))}}function EO(t,e){if(1&t&&(o.Rb(0,"div",60),o.Jc(1,vO,15,24,"div",8),o.Jc(2,wO,7,5,"div",8),o.Jc(3,LO,7,3,"div",54),o.Jc(4,xO,19,24,"div",8),o.Jc(5,BO,6,2,"div",54),o.Jc(6,AO,9,15,"div",54),o.Jc(7,DO,6,2,"div",54),o.Qb()),2&t){const t=e.$implicit,i=e.index,n=o.bc().key,s=o.bc();o.Fb("active",s.openedSlotIndex==i),o.Bb(1),o.jc("ngIf","player"==t.state),o.Bb(1),o.jc("ngIf","open"==t.state&&s.userIsLobbyOwner||"open"==t.state&&"custom"==s.lobbyType||"open"==t.state&&"gm"==s.lobbyType&&s.teamSide==n),o.Bb(1),o.jc("ngIf","closed"==t.state),o.Bb(1),o.jc("ngIf","bot"==t.state),o.Bb(1),o.jc("ngIf","disabled"==t.state),o.Bb(1),o.jc("ngIf","invited"==t.state),o.Bb(1),o.jc("ngIf","open"==t.state&&"gm"==s.lobbyType&&!s.userIsLobbyOwner&&s.teamSide!=n)}}function NO(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",83),o.Yb("click",function(){o.zc(t);const e=o.bc(3).$implicit,i=o.bc(2).key,n=o.bc();return n.openInvitationModal(e.id,i),n.openSlotOptions.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(6);o.Bb(1),o.Fb("disabled",t.buttonsLocked),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.add_player")," ")}}function FO(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",75),o.Yb("click",function(){o.zc(t),o.bc();const e=o.wc(1),i=o.bc(2).$implicit;return o.bc(3).lobbyKickPlayer(i.id),e.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(6);o.Bb(1),o.Fb("disabled",t.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.lobby.kick_player")),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.kick_player")," ")}}function PO(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",75),o.Yb("click",function(){o.zc(t),o.bc();const e=o.wc(1),i=o.bc(2).$implicit;return o.bc(3).addNewFriendRequest(i.id),e.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(6);o.Bb(1),o.Fb("disabled",t.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.friend.action_add")),o.Bb(1),o.Nc(" ",t.L("meta.ui.friend.action_add")," ")}}function UO(t,e){if(1&t){const t=o.Sb();o.Rb(0,"dropdown",81,99),o.Yb("onOpen",function(){o.zc(t);const e=o.bc(2).index;return o.bc(3).openedSlotIndex=e})("onClose",function(){return o.zc(t),o.bc(5).openedSlotIndex=null}),o.Rb(2,"ul",71),o.Jc(3,NO,3,3,"li",8),o.Jc(4,FO,3,5,"li",8),o.Jc(5,PO,3,5,"li",8),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2).$implicit,e=o.bc(3);o.kc("tooltip-hint",e.L("meta.ui.lobby.slot.options")),o.jc("icon","tree-points")("btn","control-button"),o.Bb(3),o.jc("ngIf",e.userIsLobbyOwner&&t.id!==e.userId),o.Bb(1),o.jc("ngIf",e.userIsLobbyOwner&&t.id!==e.userId),o.Bb(1),o.jc("ngIf",!e.checkIfUserIsAFriend(t.id)&&t.id!==e.userId)}}const zO=function(t,e,i,n,s){return{displayName:t,level:e,onlineStatus:null,league:i,leader:n,premium:!1,avatar:s}};function JO(t,e){if(1&t&&(o.Rb(0,"div"),o.Rb(1,"div",62),o.Ob(2,"user-image",63),o.Qb(),o.Rb(3,"div",64),o.Ob(4,"nickname",65),o.Qb(),o.Rb(5,"div",67),o.Jc(6,UO,6,6,"dropdown",98),o.Qb(),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(3);o.Bb(2),o.jc("player",o.rc(6,zO,t.displayName,t.level,t.league,t.id==e.lobbyOwner,o.oc(3,gO,t.portrait,t.wreath))),o.Bb(2),o.jc("name",t.displayName||"No Name"),o.Bb(2),o.jc("ngIf",e.userIsLobbyOwner&&t.id!==e.userId||!e.checkIfUserIsAFriend(t.id)&&t.id!==e.userId)}}function qO(t,e){if(1&t&&(o.Rb(0,"div",60),o.Jc(1,JO,7,12,"div",8),o.Qb()),2&t){const t=e.$implicit,i=e.index,n=o.bc(3);o.Fb("active",i==n.openedSlotIndex),o.Bb(1),o.jc("ngIf","u"==t.slot)}}function VO(t,e){if(1&t&&(o.Rb(0,"div"),o.Rb(1,"h3",96),o.Lc(2),o.Qb(),o.Jc(3,qO,2,3,"div",97),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Fb("color-primary","none"==t.teamSide),o.Bb(1),o.Mc(t.L("meta.ui.lobby.custom.reserve")),o.Bb(1),o.jc("ngForOf",t.unbound)}}function $O(t,e){if(1&t&&(o.Rb(0,"div",56),o.Jc(1,lO,2,3,"h3",57),o.Jc(2,EO,8,9,"div",58),o.Jc(3,VO,4,4,"div",8),o.Qb()),2&t){const t=e.team,i=e.key,n=o.bc();o.Bb(1),o.jc("ngIf",i==n.LobbyTeam.Spectators),o.Bb(1),o.jc("ngForOf",t)("ngForTrackBy",n.slotId),o.Bb(1),o.jc("ngIf",i==n.LobbyTeam.Spectators&&n.unbound.length)}}function GO(t,e){if(1&t&&(o.Rb(0,"h3",100),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.L("meta.ui.play.battalions"))}}const HO=function(){return[]};function YO(t,e){if(1&t&&(o.Rb(0,"div",101),o.Ob(1,"select-army",102),o.Qb()),2&t){o.bc();const t=o.wc(30);o.Bb(1),o.jc("commanders",(null==t?null:t.commanders)||o.mc(1,HO))}}function WO(t,e){if(1&t&&(o.Rb(0,"div",103),o.Ob(1,"commander-details",104),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("commander",t.selectedCommander)}}function KO(t,e){if(1&t&&(o.Rb(0,"h3",105),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Fb("color-primary",t.teamSide==t.LobbyTeam.TeamA),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.team_a.title"),"\n")}}function XO(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",108),o.Yb("click",function(){o.zc(t);const e=o.bc(2);return e.setSlotsWithAI(e.LobbyTeam.TeamA)}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(2);o.Fb("disabled",t.buttonsLocked),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.fill_with_ai")," ")}}function ZO(t,e){if(1&t&&(o.Rb(0,"div",106),o.Jc(1,XO,2,3,"button",107),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf","coop"!==t.options.mode&&t.userIsLobbyOwner)}}const tT=function(t,e){return{team:t,key:e}};function eT(t,e){if(1&t&&(o.Rb(0,"div",109),o.Pb(1,110),o.Qb()),2&t){const t=o.bc(),e=o.wc(26);o.Bb(1),o.jc("ngTemplateOutlet",e)("ngTemplateOutletContext",o.oc(2,tT,t.slots.teamA,t.LobbyTeam.TeamA))}}function iT(t,e){if(1&t&&(o.Rb(0,"h3",111),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Fb("color-primary",t.teamSide==t.LobbyTeam.TeamB),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.team_b.title"),"\n")}}function nT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",108),o.Yb("click",function(){o.zc(t);const e=o.bc(2);return e.setSlotsWithAI(e.LobbyTeam.TeamB)}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(2);o.Fb("disabled",t.buttonsLocked),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.fill_with_ai")," ")}}function sT(t,e){if(1&t&&(o.Rb(0,"div",112),o.Jc(1,nT,2,3,"button",107),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf","coop"!==t.options.mode&&t.userIsLobbyOwner)}}function aT(t,e){if(1&t&&(o.Rb(0,"div",113),o.Pb(1,110),o.Qb()),2&t){const t=o.bc(),e=o.wc(26);o.Bb(1),o.jc("ngTemplateOutlet",e)("ngTemplateOutletContext",o.oc(2,tT,t.slots.teamB,t.LobbyTeam.TeamB))}}function rT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",108),o.Yb("click",function(){return o.zc(t),o.bc(2).setTeamAutobalance()}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(2);o.Fb("disabled",t.buttonsLocked||t.lobbyMembers.length<2),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.team_autobalance")," ")}}function oT(t,e){if(1&t&&(o.Rb(0,"div",114),o.Jc(1,rT,2,3,"button",107),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf","coop"!==t.options.mode&&"pve"!==t.options.mode&&t.userIsLobbyOwner)}}function cT(t,e){if(1&t&&(o.Rb(0,"div",115),o.Pb(1,110),o.Qb()),2&t){const t=o.bc(),e=o.wc(26);o.Bb(1),o.jc("ngTemplateOutlet",e)("ngTemplateOutletContext",o.oc(2,tT,t.slots.teamS,t.LobbyTeam.Spectators))}}function lT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"h3",116),o.Rb(1,"span",55),o.Lc(2),o.Rb(3,"button",117),o.Yb("click",function(){return o.zc(t),o.bc(),o.wc(57).open()}),o.Rb(4,"span",118),o.Ob(5,"img",119),o.Ob(6,"img",120),o.Qb(),o.Rb(7,"span",121),o.Lc(8),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(1),o.kc("tooltip-hint",t.options.mode&&"coop"==t.options.mode?t.L("meta.hint.mode.mission_disabled"):""),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.setting_button.title")," "),o.Bb(1),o.Fb("disabled",t.options.mode&&"coop"==t.options.mode||!t.options.submode||!t.options.submode.length),o.Bb(5),o.Mc(t.L("meta.ui.mode.rules.button_text"))}}function uT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",143),o.Rb(1,"label",144),o.Lc(2),o.Qb(),o.Rb(3,"input",145,146),o.Yb("ngModelChange",function(e){return o.zc(t),o.bc(2).options.name=e})("keydown",function(e){return o.zc(t),o.bc(2).onInputKeydown(e)}),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.Bb(2),o.Nc(" ",t.L("meta.ui.lobby.tournament_name")," "),o.Bb(1),o.jc("ngModel",t.options.name)("placeholder",t.L("meta.ui.lobby.type_tournament_name"))}}function dT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",55),o.Rb(1,"button",132),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(1);return o.bc(2).setOption("mode",i),n.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(3);o.Fb("active",i.options.mode===t),o.kc("tooltip-hint",i.L("meta.ui.lobby.options.mode."+t)),o.Bb(1),o.Fb("disabled","coop"==t?!i.allow("multi.lobby.mission"):!i.allow("multi.lobby."+t)),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L("meta.ui.lobby.options.mode."+t)),o.Bb(1),o.Nc(" ",i.L("meta.ui.lobby.options.mode."+t)," ")}}function hT(t,e){if(1&t&&(o.Rb(0,"dropdown",126,147),o.Rb(2,"ul",71),o.Jc(3,dT,3,8,"li",128),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.kc("tooltip-hint","coop"==t.options.mode&&t.allow("multi.lobby.mission")||t.allow("multi.lobby."+t.options.mode)?t.L("meta.ui.lobby.options.mode."+t.options.mode):t.L("meta.ui.not_selected")),o.jc("text","coop"==t.options.mode&&t.allow("multi.lobby.mission")||t.allow("multi.lobby."+t.options.mode)?t.L("meta.ui.lobby.options.mode."+t.options.mode):t.L("meta.ui.not_selected"))("label",t.L("meta.ui.lobby.options.mode.label"))("disabled",!t.userIsLobbyOwner)("origin","bottom"),o.Bb(3),o.jc("ngForOf",t.modes)}}function bT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",55),o.Rb(1,"button",132),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(5),s=o.bc();return s.setOption("submode",i),n.hide(),s.triggerGlobalEvent("select.lobby.submodes."+i,{tutorial:!0})}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Fb("active",i.options.submode===t),o.kc("tooltip-hint",i.L("meta.ui.lobby.options.submode."+(t||"none"))),o.Bb(1),o.Fb("disabled",i.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L("meta.ui.lobby.options.submode."+(t||"none"))),o.Bb(1),o.Nc(" ",i.L("meta.ui.lobby.options.submode."+(t||"none"))," ")}}function mT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",55),o.Rb(1,"button",132),o.Yb("click",function(){o.zc(t),o.bc();const e=o.wc(1);return o.bc(2).setOption("map","random"),e.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(3);o.Fb("active","random"===t.options.map),o.kc("tooltip-hint",t.L("meta.mission.random.name")),o.Bb(1),o.Fb("disabled",t.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.mission.random.name")),o.Bb(1),o.Nc(" ",t.L("meta.mission.random.name")," ")}}function pT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",55),o.Rb(1,"button",132),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(1),s=o.bc(2);return s.setOption("map",i),n.hide(),s.triggerGlobalEvent("select.lobby.map."+i,{tutorial:!0})}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(3);o.Fb("active",i.options.map===t),o.kc("tooltip-hint",i.L("meta.mission."+t+".name")),o.Bb(1),o.Fb("disabled",i.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L("meta.mission."+t+".name")),o.Bb(1),o.Nc(" ",i.L("meta.mission."+t+".name")," ")}}function gT(t,e){if(1&t&&(o.Rb(0,"dropdown",126,148),o.Rb(2,"scrollable",149),o.Rb(3,"ul",71),o.Jc(4,mT,3,8,"li",150),o.Jc(5,pT,3,8,"li",128),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.Fb("tutorial-dropdown",t.counters["ui.tutorial.mark.options.maps"]),o.kc("tooltip-hint",t.L("meta.mission."+t.options.map+".name")),o.jc("text",t.L("meta.mission."+t.options.map+".name"))("label",t.L("meta.ui.lobby.options.map.label"))("disabled",!t.userIsLobbyOwner)("origin","bottom"),o.Bb(4),o.jc("ngIf","coop"!==t.options.mode),o.Bb(1),o.jc("ngForOf",t.lobbyMaps)}}function fT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",55),o.Rb(1,"button",132),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(1),s=o.bc(2);return s.setOption("difficulty",s.difficultiesString[i]),n.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(3);o.Fb("active",i.options.difficulty===i.difficultiesString[t]),o.kc("tooltip-hint",i.L("meta.ui.play.difficulty_level."+t)),o.Bb(1),o.Fb("disabled",i.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L("meta.ui.play.difficulty_level."+t)),o.Bb(1),o.Nc(" ",i.L("meta.ui.play.difficulty_level."+t)," ")}}function vT(t,e){if(1&t&&(o.Rb(0,"dropdown",126,151),o.Rb(2,"ul",71),o.Jc(3,fT,3,8,"li",128),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.Fb("tutorial-dropdown",t.counters["ui.tutorial.mark.options.difficulty"]),o.kc("tooltip-hint",t.L("meta.ui.play.difficulty_level."+t.difficultiesKeys[t.options.difficulty])),o.jc("text",t.L("meta.ui.play.difficulty_level."+t.difficultiesKeys[t.options.difficulty]))("label",t.L("meta.ui.lobby.options.difficulty.label"))("disabled",!t.userIsLobbyOwner)("origin","bottom"),o.Bb(3),o.jc("ngForOf",t.difficulties)}}function yT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",55),o.Rb(1,"button",132),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(1);return o.bc(2).setOption("commanderVisibility",i),n.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(3);o.Fb("active",i.options.commanderVisibility===t),o.kc("tooltip-hint",i.L("meta.ui.lobby.options.commander_visibility."+t)),o.Bb(1),o.Fb("disabled",i.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L("meta.ui.lobby.options.commander_visibility."+t)),o.Bb(1),o.Nc(" ",i.L("meta.ui.lobby.options.commander_visibility."+t)," ")}}function _T(t,e){if(1&t&&(o.Rb(0,"dropdown",126,152),o.Rb(2,"ul",71),o.Jc(3,yT,3,8,"li",128),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.Fb("tutorial-dropdown",t.counters["ui.tutorial.mark.options.commander_visibility"]),o.kc("tooltip-hint",t.L("meta.ui.lobby.options.commander_visibility."+t.options.commanderVisibility)),o.jc("text",t.L("meta.ui.lobby.options.commander_visibility."+t.options.commanderVisibility))("label",t.L("meta.ui.lobby.options.commander_visibility.label"))("disabled",!t.userIsLobbyOwner)("origin","bottom"),o.Bb(3),o.jc("ngForOf",t.commanderVisibility)}}function kT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",55),o.Rb(1,"button",132),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(13),s=o.bc();return s.setOption("environment",i),n.hide(),s.triggerGlobalEvent("select.lobby.environment."+i,{tutorial:!0})}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Fb("active",i.options.environment===t),o.kc("tooltip-hint",i.L(t?"meta.ui.lobby.options.environment."+t:"meta.ui.lobby.options.environment.all")),o.Bb(1),o.Fb("disabled",i.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L(t?"meta.ui.lobby.options.environment."+t:"meta.ui.lobby.options.environment.all")),o.Bb(1),o.Nc(" ",i.L(t?"meta.ui.lobby.options.environment."+t:"meta.ui.lobby.options.environment.all")," ")}}function wT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",55),o.Rb(1,"button",132),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(17),s=o.bc();return s.setOption("unitLevel",i),n.hide(),s.triggerGlobalEvent("select.lobby.unit_level."+i,{tutorial:!0})}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Fb("active",i.options.unitLevel===t),o.kc("tooltip-hint",i.L("meta.ui.lobby.options.unit_level."+t)),o.Bb(1),o.Fb("disabled",i.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L("meta.ui.lobby.options.unit_level."+t)),o.Bb(1),o.Nc(" ",i.L("meta.ui.lobby.options.unit_level."+t)," ")}}function ST(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",55),o.Rb(1,"button",132),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(24),s=o.bc();return s.setOption("realism",i),n.hide(),s.triggerGlobalEvent("select.lobby.realism."+i)}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Fb("active",i.options.realism===t),o.kc("tooltip-hint",i.L("meta.ui.lobby.options.realism."+t)),o.Bb(1),o.Fb("disabled",i.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L("meta.ui.lobby.options.realism."+t)),o.Bb(1),o.Nc(" ",i.L("meta.ui.lobby.options.realism."+t)," ")}}function IT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",55),o.Rb(1,"button",132),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(29),s=o.bc();return s.setOption("size",i),n.hide(),s.triggerGlobalEvent("select.lobby.size."+i,{tutorial:!0})}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Fb("active",i.options.size===t),o.kc("tooltip-hint",i.L("meta.ui.lobby.options.team_size."+t)),o.Bb(1),o.Fb("disabled",i.options.mode&&"duel"==i.options.mode&&(t>i.duelMaxTeamSize||!t)),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L("meta.ui.lobby.options.team_size."+t)),o.Bb(1),o.Nc(" ",i.L("meta.ui.lobby.options.team_size."+t)," ")}}function CT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",55),o.Rb(1,"button",132),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(33),s=o.bc();return s.setOption("armyMode",i),n.hide(),s.triggerGlobalEvent("select.lobby.army_mode."+i,{tutorial:!0})}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Fb("active",i.options.armyMode===t),o.kc("tooltip-hint",i.L("meta.ui.lobby.options.army."+t)),o.Bb(1),o.Fb("disabled",i.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L("meta.ui.lobby.options.army."+t)),o.Bb(1),o.Nc(" ",i.L("meta.ui.lobby.options.army."+t)," ")}}function LT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",55),o.Rb(1,"button",132),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(37);return o.bc().setOption("armyA",i.value),n.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Fb("active",i.options.armyA===t.value),o.kc("tooltip-hint",i.L("meta.ui.menu.nation."+t.value)),o.Bb(1),o.Fb("disabled",t.disabled||i.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L("meta.ui.menu.nation."+t.value)),o.Bb(1),o.Nc(" ",i.L("meta.ui.menu.nation."+t.value)," ")}}function RT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",55),o.Rb(1,"button",132),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(44),s=o.bc();return s.setOption("armyB",i.value),n.hide(),s.triggerGlobalEvent("select.lobby.army_a."+s.options.armyA+".army_b."+i.value,{tutorial:!0})}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Fb("active",i.options.armyB===t.value),o.kc("tooltip-hint",i.L("meta.ui.menu.nation."+t.value)),o.Bb(1),o.Fb("disabled",t.disabled||i.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L("meta.ui.menu.nation."+t.value)),o.Bb(1),o.Nc(" ",i.L("meta.ui.menu.nation."+t.value)," ")}}function OT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",55),o.Rb(1,"button",132),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(52);return o.bc().setOption("serverPlacement",i),n.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Fb("active",i.options.serverPlacement===i.a),o.kc("tooltip-hint",i.L("meta.ui.lobby.options.server_placement_"+t)),o.Bb(1),o.Fb("disabled",i.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",i.L("meta.ui.lobby.options.server_placement_"+t)," ")}}function TT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"dropdown",126,153),o.Rb(2,"ul",71),o.Rb(3,"li"),o.Rb(4,"button",154),o.Yb("click",function(){o.zc(t);const e=o.wc(1),i=o.bc(2);return i.isPasswordActive=!1,i.setOption("hidden",!0),e.hide(),i.options.password=""}),o.Lc(5),o.Qb(),o.Qb(),o.Rb(6,"li"),o.Rb(7,"button",154),o.Yb("click",function(){o.zc(t);const e=o.wc(1),i=o.bc(2);return i.isPasswordActive=!1,i.setOption("hidden",!1),e.hide(),i.options.password=""}),o.Lc(8),o.Qb(),o.Qb(),o.Rb(9,"li"),o.Rb(10,"button",154),o.Yb("click",function(){o.zc(t);const e=o.wc(1),i=o.bc(2);return i.isPasswordActive=!0,e.hide(),i.setOption("hidden",!1),i.options.password=""}),o.Lc(11),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("meta.ui.lobby.options.privacy_title")),o.jc("text",t.L(t.options.password||t.isPasswordActive?"meta.ui.lobby.options.hidden_false_password":"meta.ui.lobby.options.hidden_"+t.options.hidden))("label",t.L("meta.ui.lobby.options.privacy_title"))("disabled",!t.userIsLobbyOwner)("origin","bottom"),o.Bb(3),o.Fb("active",!t.isPasswordActive&&t.options.hidden),o.Bb(1),o.kc("tooltip-hint",t.L("meta.ui.lobby.options.hidden_true")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Mc(t.L("meta.ui.lobby.options.hidden_true")),o.Bb(1),o.Fb("active",!t.isPasswordActive&&!t.options.hidden&&!t.options.password),o.Bb(1),o.kc("tooltip-hint",t.L("meta.ui.lobby.options.hidden_false")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Mc(t.L("meta.ui.lobby.options.hidden_false")),o.Bb(1),o.Fb("active",t.isPasswordActive||t.options.password),o.Bb(1),o.kc("tooltip-hint",t.L("meta.ui.lobby.options.hidden_false_password")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Mc(t.L("meta.ui.lobby.options.hidden_false_password"))}}function xT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",143),o.Rb(1,"input-password",155),o.Yb("onInputKeydown",function(e){return o.zc(t),o.bc(2).getPasswordData(e)}),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.Fb("disabled",!t.isPasswordActive)("error",t.isPasswordActive&&!t.options.password.length),o.Bb(1),o.jc("password",t.options.password?t.options.password:"")("placeholder",t.L("meta.ui.lobby.type_password"))("label",t.L("meta.ui.lobby.password_label"))}}function BT(t,e){if(1&t&&(o.Rb(0,"div",156),o.Rb(1,"label",157),o.Lc(2),o.Qb(),o.Ob(3,"input",158,159),o.Qb()),2&t){const t=o.bc(2);o.Bb(2),o.Nc(" ",t.L("meta.ui.lobby.password_label")," "),o.Bb(1),o.jc("value",t.options.password)}}function jT(t,e){if(1&t&&(o.Rb(0,"pre",160),o.Lc(1),o.cc(2,"json"),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Mc(o.dc(2,1,t.options).markdown())}}const MT=function(){return[3,4,5,6]},QT=function(){return[!0,!1]},AT=function(){return[0,1,2,3,4,5]},DT=function(){return["all","exact","ally"]},ET=function(){return["local","dedicated","auto"]};function NT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",122),o.Rb(1,"div",123),o.Jc(2,uT,5,3,"div",124),o.Jc(3,hT,4,6,"dropdown",125),o.Rb(4,"dropdown",126,127),o.Rb(6,"ul",71),o.Jc(7,bT,3,8,"li",128),o.Qb(),o.Qb(),o.Jc(8,gT,6,9,"dropdown",129),o.Jc(9,vT,4,8,"dropdown",129),o.Qb(),o.Rb(10,"div",123),o.Jc(11,_T,4,8,"dropdown",129),o.Rb(12,"dropdown",126,130),o.Rb(14,"ul",71),o.Jc(15,kT,3,8,"li",128),o.Qb(),o.Qb(),o.Rb(16,"dropdown",126,131),o.Rb(18,"ul",71),o.Rb(19,"li",55),o.Rb(20,"button",132),o.Yb("click",function(){o.zc(t);const e=o.wc(17);return o.bc().setOption("unitLevel",0),e.hide()}),o.Lc(21),o.Qb(),o.Qb(),o.Jc(22,wT,3,8,"li",128),o.Qb(),o.Qb(),o.Rb(23,"dropdown",126,133),o.Rb(25,"ul",71),o.Jc(26,ST,3,8,"li",128),o.Qb(),o.Qb(),o.Qb(),o.Rb(27,"div",123),o.Rb(28,"dropdown",126,134),o.Rb(30,"ul",71),o.Jc(31,IT,3,8,"li",128),o.Qb(),o.Qb(),o.Rb(32,"dropdown",126,135),o.Rb(34,"ul",71),o.Jc(35,CT,3,8,"li",128),o.Qb(),o.Qb(),o.Rb(36,"dropdown",126,136),o.Rb(38,"ul",71),o.Rb(39,"li",55),o.Rb(40,"button",132),o.Yb("click",function(){o.zc(t);const e=o.wc(37);return o.bc().setOption("armyA",""),e.hide()}),o.Lc(41),o.Qb(),o.Qb(),o.Jc(42,LT,3,8,"li",128),o.Qb(),o.Qb(),o.Rb(43,"dropdown",126,137),o.Rb(45,"ul",71),o.Rb(46,"li",55),o.Rb(47,"button",132),o.Yb("click",function(){o.zc(t);const e=o.wc(44);return o.bc().setOption("armyB",""),e.hide()}),o.Lc(48),o.Qb(),o.Qb(),o.Jc(49,RT,3,8,"li",128),o.Qb(),o.Qb(),o.Qb(),o.Rb(50,"div",123),o.Rb(51,"dropdown",138,139),o.Rb(53,"ul",71),o.Jc(54,OT,3,7,"li",128),o.Qb(),o.Qb(),o.Jc(55,TT,12,20,"dropdown",125),o.Jc(56,xT,2,7,"div",140),o.Jc(57,BT,5,2,"div",141),o.Jc(58,jT,3,3,"pre",142),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(2),o.jc("ngIf","gm"==t.lobbyType),o.Bb(1),o.jc("ngIf",t.modes.length&&"custom"==t.lobbyType),o.Bb(1),o.Fb("tutorial-dropdown",t.counters["ui.tutorial.mark.options.submodes"]),o.kc("tooltip-hint",t.L("meta.ui.lobby.options.submode."+(t.options.submode||"none"))),o.jc("text",t.L("meta.ui.lobby.options.submode."+(t.options.submode||"none")))("label",t.L("meta.ui.lobby.options.submode.label"))("disabled",!t.userIsLobbyOwner)("origin","bottom"),o.Bb(3),o.jc("ngForOf",t.submodes),o.Bb(1),o.jc("ngIf",t.lobbyMaps.length),o.Bb(1),o.jc("ngIf",t.difficultiesString.length&&"custom"==t.lobbyType),o.Bb(2),o.jc("ngIf",t.commanderVisibility.length),o.Bb(1),o.Fb("tutorial-dropdown",t.counters["ui.tutorial.mark.options.environment"]),o.kc("tooltip-hint",t.L(t.options.environment?"meta.ui.lobby.options.environment."+t.options.environment:"meta.ui.lobby.options.environment.all")),o.jc("text",t.L(t.options.environment?"meta.ui.lobby.options.environment."+t.options.environment:"meta.ui.lobby.options.environment.all"))("label",t.L("meta.ui.lobby.options.environment.label"))("disabled",!t.userIsLobbyOwner||t.options.mode&&"coop"==t.options.mode)("origin","bottom"),o.Bb(3),o.jc("ngForOf",t.environmentKeys),o.Bb(1),o.Fb("tutorial-dropdown",t.counters["ui.tutorial.mark.options.unit_level"]),o.kc("tooltip-hint",t.L("meta.ui.lobby.options.unit_level."+t.options.unitLevel)),o.jc("text",t.L("meta.ui.lobby.options.unit_level."+t.options.unitLevel))("label",t.L("meta.ui.lobby.options.unit_level.label"))("disabled",!t.userIsLobbyOwner)("origin","bottom"),o.Bb(3),o.Fb("active",0===t.options.unitLevel),o.kc("tooltip-hint",t.L("meta.ui.lobby.options.unit_level.0")),o.Bb(1),o.Fb("disabled",t.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.lobby.options.unit_level.0")),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.options.unit_level.0")," "),o.Bb(1),o.jc("ngForOf",o.mc(101,MT)),o.Bb(1),o.kc("tooltip-hint",t.L("meta.ui.lobby.options.realism."+t.options.realism)),o.jc("text",t.L("meta.ui.lobby.options.realism."+t.options.realism))("label",t.L("meta.ui.lobby.options.realism.label"))("disabled",!t.userIsLobbyOwner)("origin","bottom"),o.Bb(3),o.jc("ngForOf",o.mc(102,QT)),o.Bb(2),o.Fb("tutorial-dropdown",t.counters["ui.tutorial.mark.options.team_size"]),o.kc("tooltip-hint",t.L("meta.ui.lobby.options.team_size."+t.options.size)),o.jc("text",t.L("meta.ui.lobby.options.team_size."+t.options.size))("label",t.L("meta.ui.lobby.options.team_size.label"))("disabled",!t.userIsLobbyOwner)("origin","bottom"),o.Bb(3),o.jc("ngForOf",o.mc(103,AT)),o.Bb(1),o.Fb("tutorial-dropdown",t.counters["ui.tutorial.mark.options.army_mode"]),o.kc("tooltip-hint",t.L("meta.ui.lobby.options.army."+t.options.armyMode)),o.jc("text",t.L("meta.ui.lobby.options.army."+t.options.armyMode))("label",t.L("meta.ui.lobby.options.army.label"))("disabled",!t.userIsLobbyOwner||"coop"==t.options.mode)("origin","bottom"),o.Bb(3),o.jc("ngForOf",o.mc(104,DT)),o.Bb(1),o.Fb("tutorial-dropdown",t.counters["ui.tutorial.mark.options.team"]),o.kc("tooltip-hint",t.L(t.options.armyA?"meta.ui.menu.nation."+t.options.armyA:"meta.ui.not_selected")),o.jc("text",t.L(t.options.armyA?"meta.ui.menu.nation."+t.options.armyA:"meta.ui.not_selected"))("label",t.L("meta.ui.lobby.options.army_a.label"))("disabled",!t.userIsLobbyOwner||"all"===t.options.armyMode)("origin","bottom"),o.Bb(3),o.Fb("active",""===t.options.armyA),o.kc("tooltip-hint",t.L("meta.ui.not_selected")),o.Bb(1),o.Fb("disabled",t.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.not_selected")),o.Bb(1),o.Nc(" ",t.L("meta.ui.not_selected")," "),o.Bb(1),o.jc("ngForOf",t.armies),o.Bb(1),o.Fb("tutorial-dropdown",t.counters["ui.tutorial.mark.options.team"]),o.kc("tooltip-hint",t.L(t.options.armyB?"meta.ui.menu.nation."+t.options.armyB:"meta.ui.not_selected")),o.jc("text",t.L(t.options.armyB?"meta.ui.menu.nation."+t.options.armyB:"meta.ui.not_selected"))("label",t.L("meta.ui.lobby.options.army_b.label"))("disabled",!t.userIsLobbyOwner||"all"===t.options.armyMode)("origin","bottom"),o.Bb(3),o.Fb("active",""===t.options.armyB),o.kc("tooltip-hint",t.L("meta.ui.not_selected")),o.Bb(1),o.Fb("disabled",t.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.not_selected")),o.Bb(1),o.Nc(" ",t.L("meta.ui.not_selected")," "),o.Bb(1),o.jc("ngForOf",t.armies),o.Bb(2),o.kc("tooltip-hint",t.L("meta.ui.lobby.options.server_placement")),o.jc("text",t.L("meta.ui.lobby.options.server_placement_"+t.options.serverPlacement))("label",t.L("meta.ui.lobby.options.server_placement"))("disabled",!t.userIsLobbyOwner)("origin","bottom"),o.Bb(3),o.jc("ngForOf",o.mc(105,ET)),o.Bb(1),o.jc("ngIf","custom"==t.lobbyType),o.Bb(1),o.jc("ngIf","custom"==t.lobbyType&&t.userIsLobbyOwner),o.Bb(1),o.jc("ngIf","custom"==t.lobbyType&&t.options.password&&!t.userIsLobbyOwner),o.Bb(1),o.jc("ngIf",t.hasFlag("debug")||t.devMode)}}function FT(t,e){if(1&t&&(o.Rb(0,"div",172),o.Lc(1),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.Mc("min: "+t.victoryPointsRange.min+", max: "+t.victoryPointsRange.max)}}function PT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",143),o.Rb(1,"label",168),o.Lc(2),o.Qb(),o.Rb(3,"input",169,170),o.Yb("ngModelChange",function(e){return o.zc(t),o.bc(2).options.victoryPoints=e})("keydown",function(e){return o.zc(t),o.bc(2).onInputKeydown(e)}),o.Qb(),o.Jc(5,FT,2,1,"div",171),o.Qb()}if(2&t){const t=o.wc(4),e=o.bc(2);o.Fb("error",null!==e.options.victoryPoints&&(e.options.victoryPoints<e.victoryPointsRange.min||e.options.victoryPoints>e.victoryPointsRange.max))("disabled",!e.userIsLobbyOwner),o.Bb(2),o.Mc(e.L("meta.ui.lobby.options.victory_points")),o.Bb(1),o.jc("ngModel",e.options.victoryPoints)("min",t.min)("max",t.max)("pattern","^[1-9][0-9]*$")("disabled",!e.userIsLobbyOwner),o.Bb(2),o.jc("ngIf",null!==e.options.victoryPoints&&(e.options.victoryPoints<e.victoryPointsRange.min||e.options.victoryPoints>e.victoryPointsRange.max))}}function UT(t,e){if(1&t&&(o.Rb(0,"div",172),o.Lc(1),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.Mc("min: "+t.durationRange.min+", max: "+t.durationRange.max)}}function zT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",143),o.Rb(1,"label",173),o.Lc(2),o.Qb(),o.Rb(3,"input",174,175),o.Yb("ngModelChange",function(e){return o.zc(t),o.bc(2).options.duration=e})("keydown",function(e){return o.zc(t),o.bc(2).onInputKeydown(e)}),o.Qb(),o.Jc(5,UT,2,1,"div",171),o.Qb()}if(2&t){const t=o.wc(4),e=o.bc(2);o.Fb("error",null!==e.options.duration&&(e.options.duration<e.durationRange.min||e.options.duration>e.durationRange.max))("disabled",!e.userIsLobbyOwner),o.Bb(2),o.Mc(e.L("meta.ui.lobby.options.duration")),o.Bb(1),o.jc("ngModel",e.options.duration)("min",t.min)("max",t.max)("pattern","^[1-9][0-9]*$")("disabled",!e.userIsLobbyOwner),o.Bb(2),o.jc("ngIf",null!==e.options.duration&&(e.options.duration<e.durationRange.min||e.options.duration>e.durationRange.max))}}function JT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",55),o.Rb(1,"button",132),o.Yb("click",function(){o.zc(t),o.bc();const e=o.wc(1);return o.bc(2).setOption("budget",null),e.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(3);o.Fb("active",!t.options.budget||null===t.options.budget),o.kc("tooltip-hint",t.L("meta.ui.not_selected")),o.Bb(1),o.Fb("disabled",t.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.not_selected")," ")}}function qT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",179),o.Rb(1,"button",132),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(1);return o.bc(2).setOption("budget",i.id),n.hide()}),o.Lc(2),o.Qb(),o.Rb(3,"div",180),o.Lc(4),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(3);o.Fb("active",i.options.budget===t.id),o.Bb(1),o.Fb("disabled",i.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",i.L("meta.ui.budget."+t.id+".name")," "),o.Bb(2),o.Mc(i.L("meta.ui.budget."+t.id+".desc"))}}function VT(t,e){if(1&t&&(o.Rb(0,"dropdown",176,177),o.Rb(2,"ul",71),o.Jc(3,JT,3,7,"li",150),o.Jc(4,qT,5,7,"li",178),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L(t.options.budget&&null!==t.options.budget?"meta.ui.budget."+t.options.budget+".desc":"meta.ui.not_selected")),o.jc("text",t.L(t.options.budget&&null!==t.options.budget?"meta.ui.budget."+t.options.budget+".name":"meta.ui.not_selected"))("disabled",!t.userIsLobbyOwner||t.budgetData[t.options.mode]&&t.budgetData[t.options.mode].length<=1)("origin","top"),o.Bb(3),o.jc("ngIf",!t.options.budget||null===t.options.budget),o.Bb(1),o.jc("ngForOf",t.budgetData[t.options.mode])}}function $T(t,e){if(1&t&&(o.Rb(0,"div",161),o.Rb(1,"details",162),o.Rb(2,"summary"),o.Lc(3),o.Qb(),o.Jc(4,PT,6,11,"div",163),o.Jc(5,zT,6,11,"div",163),o.Jc(6,VT,5,6,"dropdown",164),o.Rb(7,"div",165),o.Ob(8,"img",166),o.Rb(9,"div",167),o.Lc(10),o.Qb(),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Fb("disabled",!t.userIsLobbyOwner),o.Cb("open",t.options.victoryPoints||t.options.duration||t.options.budget),o.Bb(2),o.Mc(t.L("meta.ui.lobby.advanced_settings")),o.Bb(1),o.jc("ngIf",t.userIsLobbyOwner||!t.userIsLobbyOwner&&t.options.victoryPoints&&null!==t.options.victoryPoints),o.Bb(1),o.jc("ngIf",t.userIsLobbyOwner||!t.userIsLobbyOwner&&t.options.duration&&null!==t.options.duration),o.Bb(1),o.jc("ngIf",t.userIsLobbyOwner&&t.budgetData||!t.userIsLobbyOwner&&t.options.budget&&null!==t.options.budget&&t.budgetData),o.Bb(4),o.Nc(" ",t.L("meta.ui.lobby.advanced_settings_warning")," ")}}const GT=function(){return{hover:"ui_hover_default"}};function HT(t,e){if(1&t&&(o.Rb(0,"div",181),o.Rb(1,"figure",182),o.Ob(2,"img",183),o.Ob(3,"img",184),o.Ob(4,"div",185),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.kc("tooltip-hint",t.L("meta.mission."+t.options.map+".name")),o.jc("alertSound",o.mc(4,GT)),o.Bb(3),o.Ic("background-image","url(assets/img/minimap/"+t.mapBackground+".jpg)")}}function YT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",186),o.Yb("click",function(){return o.zc(t),o.bc().lobbyStart()}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc();o.Fb("disabled",!t.slots.teamA.notEmpty||!t.slots.teamB.notEmpty||t.buttonsLocked),o.kc("tooltip-hint",t.L("meta.hint.play.play")),o.jc("alertSound","ui_game_start"),o.Bb(1),o.Nc(" ",t.L("meta.ui.play.play_button")," ")}}function WT(t,e){if(1&t&&(o.Rb(0,"div",187),o.Ob(1,"article",36),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("innerHTML",t.L("meta.ui.chat.no_friends"),o.Ac)}}function KT(t,e){if(1&t&&(o.Rb(0,"div",73),o.Lc(1),o.Qb()),2&t){const t=o.bc(4);o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.invited_state")," ")}}function XT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",196),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit;return o.bc(3).lobbyKickPlayer(e.id)}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(4);o.Fb("disabled",t.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.members.team_remove_invitation")," ")}}function ZT(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",197),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit;return o.bc(3).addUserToNewLobby(e.id,e.isLobby)}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(4);o.Fb("disabled",t.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.chat.system.lobby_new_friend_add")," ")}}function tx(t,e){if(1&t&&(o.Rb(0,"div",198),o.Lc(1),o.Qb()),2&t){const t=o.bc(4);o.Bb(1),o.Nc(" ",t.L("meta.ui.friend.game.state.lobby")," ")}}function ex(t,e){if(1&t&&(o.Rb(0,"div",199),o.Ob(1,"span"),o.Qb()),2&t){const t=o.bc(4);o.Bb(1),o.Ic("width",t.cache.getLoadingProgress("addToLobby")+"%")}}const ix=function(t,e,i,n,s,a){return{displayName:t,level:e,onlineStatus:i,league:n,commander:s,avatar:a}};function nx(t,e){if(1&t&&(o.Rb(0,"div",60),o.Rb(1,"div",62),o.Ob(2,"user-image",63),o.Qb(),o.Rb(3,"div",64),o.Ob(4,"nickname",65),o.Jc(5,KT,2,1,"div",66),o.Qb(),o.Rb(6,"div",67),o.Jc(7,XT,2,4,"button",192),o.Jc(8,ZT,2,4,"button",193),o.Jc(9,tx,2,1,"div",194),o.Qb(),o.Jc(10,ex,2,2,"div",195),o.Qb()),2&t){const t=e.$implicit,i=o.bc(3);o.Fb("active",i.slotIndex==i.openedSlotIndex),o.Bb(2),o.jc("player",o.sc(12,ix,t.displayName,t.level,t.online?t.online.state:null,t.league,t.commander?i.getUserCommander(t.commander.template):null,o.oc(9,gO,t.portrait,t.wreath))),o.Bb(2),o.jc("name",t.displayName||"No Name"),o.Bb(1),o.jc("ngIf",i.invitedFriends&&i.invitedFriends.length&&i.invitedFriends.includes(t.id)&&i.userIsLobbyOwner),o.Bb(2),o.jc("ngIf",i.invitedFriends&&i.invitedFriends.length&&i.invitedFriends.includes(t.id)&&i.userIsLobbyOwner),o.Bb(1),o.jc("ngIf",!i.invitedFriends||!i.invitedFriends.length||!i.invitedFriends.includes(t.id)),o.Bb(1),o.jc("ngIf",i.invitedFriends&&i.invitedFriends.length&&i.invitedFriends.includes(t.id)&&!i.userIsLobbyOwner),o.Bb(1),o.jc("ngIf",i.cache.isLoadingProgressRunning("addToLobby")&&i.invitedPlayerId==t.id)}}function sx(t,e){if(1&t&&(o.Rb(0,"scrollable",190,191),o.Jc(2,nx,11,19,"div",97),o.Qb()),2&t){const t=o.bc(2);o.jc("height","100%")("bbox",!0),o.Bb(2),o.jc("ngForOf",t.friendsToInvite)}}function ax(t,e){if(1&t&&(o.Rb(0,"div",188),o.Jc(1,sx,3,3,"scrollable",189),o.Qb()),2&t){o.bc();const t=o.wc(62);o.Bb(1),o.jc("ngIf",t.opened)}}function rx(t,e){if(1&t&&o.Ob(0,"div",200),2&t){const t=o.bc();o.jc("innerHTML",t.L("meta.hint.play.commander.low_filling").markdown().br(),o.Ac)}}const ox=function(t,e){return{current:t,set:e}};function cx(t,e){if(1&t&&o.Ob(0,"div",200),2&t){const t=o.bc();o.jc("innerHTML",t.L("meta.ui.lobby.options.unit_level.error",o.oc(1,ox,t.selectedCommanderUnitLevel.max,t.options.unitLevel)).markdown().br(),o.Ac)}}const lx=function(t){return{available:t}};function ux(t,e){if(1&t&&o.Ob(0,"div",200),2&t){const t=o.bc();o.jc("innerHTML",t.L("meta.ui.lobby.options.army.error",o.nc(1,lx,t.getAvailableArmies())).markdown().br(),o.Ac)}}function dx(t,e){if(1&t&&o.Ob(0,"div",200),2&t){const t=o.bc();o.jc("innerHTML",t.L("meta.ui.play.commander_unlock_commander").markdown().br(),o.Ac)}}function hx(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",186),o.Yb("click",function(){return o.zc(t),o.bc().checkIfCanStart()}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc();o.Fb("disabled",!t.isTeamsReady()||t.buttonsLocked||t.playersReady!==t.allPlayersCount),o.kc("tooltip-hint",t.L("meta.hint.play.play")),o.jc("alertSound","ui_game_start"),o.Bb(1),o.Nc(" ",t.L("meta.ui.play.start_game")," ")}}function bx(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",201),o.Yb("click",function(){return o.zc(t),o.bc().setReady()}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc();o.Fb("large",!t.userIsLobbyOwner)("disabled",!t.isFreemimCommanderOpen(t.selectedCommander)||t.selectedCommander.containsForbiddenUnits||!t.isCommanderFilled(t.selectedCommander)||!t.isUnitLevelFits()||!t.isNationAvailable()||t.buttonsLocked||!t.selectedCommander.available&&!t.selectedCommander.const)("red",t.userData&&t.userData.ready&&0==t.userData.ready||t.userData&&!t.userData.ready),o.kc("tooltip-hint",t.L("meta.hint.play.ready")),o.jc("alertSound","ui_ready_to_battle"),o.Bb(1),o.Nc(" ",t.L(t.userData&&t.userData.ready?"meta.ui.play.waiting_button":"meta.ui.play.ready_button")," ")}}function mx(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",202),o.Yb("click",function(){o.zc(t);const e=o.bc();return e.saveOptions(),e.triggerGlobalEvent("button.lobby.save_options",{tutorial:!0})}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc();o.Fb("disabled",t.isPasswordActive&&!t.options.password.length||t.buttonsLocked),o.jc("alertSound","ui_save"),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.save_options")," ")}}function px(t,e){if(1&t&&o.Ob(0,"span",222),2&t){const t=o.bc().$implicit;o.Cb("data-value",t.unreaded)}}function gx(t,e){if(1&t&&o.Ob(0,"img",223),2&t){const t=o.bc(4);o.kc("tooltip-hint",t.L("meta.hint.chat.friend.muted"))}}function fx(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(3);o.Bb(1),o.Nc(" ",e.L("meta.ui."+e.lobbyType+".members.state."+t.state)," ")}}const vx=function(t,e,i,n,s,a){return{displayName:t,onlineStatus:e,league:i,commander:n,leader:s,avatar:a}};function yx(t,e){if(1&t&&(o.Rb(0,"div",220),o.Rb(1,"div",62),o.Ob(2,"user-image",63),o.Qb(),o.Rb(3,"div",64),o.Ob(4,"nickname",65),o.Jc(5,px,1,1,"span",211),o.Jc(6,gx,1,1,"img",221),o.Rb(7,"div",73),o.Jc(8,fx,2,1,"span",8),o.Qb(),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=o.bc(3);o.Bb(2),o.jc("player",o.sc(8,vx,t.displayName,t.online?t.online.state:null,t.league,t.commander?i.getUserCommander(t.commander.template):null,"leader"==t.state,o.oc(5,gO,t.portrait,t.wreath))),o.Bb(2),o.jc("name",t&&t.displayName||"No Name"),o.Bb(1),o.jc("ngIf",t.unreaded>0),o.Bb(1),o.jc("ngIf",t.muteExpires),o.Bb(2),o.jc("ngIf",t.state&&"none"!=t.state)}}function _x(t,e){if(1&t&&(o.Rb(0,"div",218),o.Jc(1,yx,9,15,"div",219),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("ngForOf",t.lobbyMembers)}}function kx(t,e){if(1&t&&o.Ob(0,"span",222),2&t){const t=o.bc().$implicit;o.Cb("data-value",t.unreaded)}}function wx(t,e){if(1&t&&o.Ob(0,"img",223),2&t){const t=o.bc(4);o.kc("tooltip-hint",t.L("meta.hint.chat.friend.muted"))}}function Sx(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(3);o.Bb(1),o.Nc(" ",e.L("meta.ui."+e.lobbyType+".members.state."+t.state)," ")}}function Ix(t,e){if(1&t&&(o.Rb(0,"div",220),o.Rb(1,"div",62),o.Ob(2,"user-image",63),o.Qb(),o.Rb(3,"div",64),o.Ob(4,"nickname",65),o.Jc(5,kx,1,1,"span",211),o.Jc(6,wx,1,1,"img",221),o.Rb(7,"div",73),o.Jc(8,Sx,2,1,"span",8),o.Qb(),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=o.bc(3);o.Bb(2),o.jc("player",o.sc(8,vx,t.displayName,t.online?t.online.state:null,t.league,t.commander?i.getUserCommander(t.commander.template):null,"leader"==t.state,o.oc(5,gO,t.portrait,t.wreath))),o.Bb(2),o.jc("name",t&&t.displayName||"No Name"),o.Bb(1),o.jc("ngIf",t.unreaded>0),o.Bb(1),o.jc("ngIf",t.muteExpires),o.Bb(2),o.jc("ngIf",t.state&&"none"!=t.state)}}function Cx(t,e){if(1&t&&(o.Rb(0,"div",218),o.Jc(1,Ix,9,15,"div",219),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("ngForOf",t.teamMembers)}}function Lx(t,e){if(1&t&&o.Ob(0,"span",222),2&t){const t=o.bc(2);o.Cb("data-value",t.getUnreadedMessages(t.lobbyId))}}function Rx(t,e){if(1&t&&(o.Rb(0,"span",210),o.Lc(1),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.Mc(t.L("meta.ui.lobby.custom.reserve"))}}function Ox(t,e){if(1&t&&(o.Rb(0,"span",210),o.Lc(1),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.Mc(t.L("meta.ui.lobby."+t.teamSide+".title"))}}function Tx(t,e){if(1&t&&o.Ob(0,"span",222),2&t){const t=o.bc(3);o.Cb("data-value",t.getUnreadedMessages(t.lobbyId+"_"+t.teamSide))}}function xx(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",209),o.Yb("click",function(){o.zc(t);const e=o.bc(2);return e.setChatTab(e.LobbyChatTab.Team)}),o.Jc(1,Rx,2,1,"span",224),o.Jc(2,Ox,2,1,"span",224),o.Jc(3,Tx,1,1,"span",211),o.Qb()}if(2&t){const t=o.bc(2);o.Fb("active",t.activeChatTab==t.LobbyChatTab.Team)("disabled",t.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Bb(1),o.jc("ngIf",t.teamSide&&"none"==t.teamSide),o.Bb(1),o.jc("ngIf",t.teamSide&&"none"!=t.teamSide),o.Bb(1),o.jc("ngIf",t.getUnreadedMessages(t.lobbyId+"_"+t.teamSide)>0)}}function Bx(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",203),o.Rb(1,"div",204),o.Rb(2,"div",205),o.Rb(3,"scrollable",206,191),o.Jc(5,_x,2,1,"div",207),o.Jc(6,Cx,2,1,"div",207),o.Qb(),o.Rb(7,"div",208),o.Rb(8,"button",209),o.Yb("click",function(){o.zc(t);const e=o.bc();return e.setChatTab(e.LobbyChatTab.All)}),o.Rb(9,"span",210),o.Lc(10),o.Qb(),o.Jc(11,Lx,1,1,"span",211),o.Qb(),o.Jc(12,xx,4,8,"button",212),o.Qb(),o.Qb(),o.Rb(13,"div",213),o.Rb(14,"div",214),o.Rb(15,"div",215),o.Rb(16,"div",216),o.Ob(17,"span"),o.Lc(18),o.Qb(),o.Ob(19,"chat",null,217),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(3),o.jc("height","100%")("bbox",!0)("origin","left")("contentBottom",!0),o.Bb(2),o.jc("ngIf",t.activeChatTab==t.LobbyChatTab.All&&t.lobbyMembers.length),o.Bb(1),o.jc("ngIf",t.activeChatTab==t.LobbyChatTab.Team&&t.teamMembers.length),o.Bb(2),o.Fb("active",t.activeChatTab==t.LobbyChatTab.All)("disabled",t.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Bb(2),o.Mc(t.L("meta.ui.lobby.chat.all")),o.Bb(1),o.jc("ngIf",t.getUnreadedMessages(t.lobbyId)>0),o.Bb(1),o.jc("ngIf",t.teamSide),o.Bb(4),o.Fb("disabled",t.chatLoaded),o.Bb(2),o.Nc("",t.L("meta.ui.chat.preloader_message")," ")}}const jx=function(t){return{player:t}},Mx={min:1,max:5e3},Qx={min:5,max:90};let Ax=(()=>{class t{constructor(t,e,i,n,s,a){this.cache=t,this.lobbyService=e,this.matchMaking=i,this.chatService=n,this.notificatorService=s,this.activatedRoute=a,this.devMode=this.cache.devMode,this.onChatOpen=new o.o,this.LobbyTab=Jl,this.globalEvent=new uu,this.lobbyId="",this.lobby=null,this.LobbyTeam=Al,this.lobbyOwner="",this.teams={teamA:[],teamB:[],spectators:[]},this.userId="",this.userIsLobbyOwner=!1,this.difficulty=0,this.difficulties=[4,3,2,1,0],this.difficultiesString=["novice","easy","normal","hard","nightmare"],this.difficultiesKeys={novice:0,easy:1,normal:2,hard:3,nightmare:4},this.modes=[Dl.PVP,Dl.PVE,Dl.COOP,Dl.DUEL,Dl.TANKS,Dl.CLASSIC],this.submodes=[],this.commanderVisibility=[Ml.Team,Ml.All],this.options=Ul,this.previousOptions=null,this.optionsNotSaved=!1,this.lobbyMaps=[],this.lobbyMapsList={},this.lobbyMapsWithSubmodes={},this.userData=null,this.LobbyChatTab=Dx,this.activeChatTab=Dx.All,this.messageInput="",this.userIsInTeam=!1,this.lastSelectedCommanderId="",this.selectedCommanderUnitLevel={min:0,max:0},this.slots={},this.unbound=[],this.playerIsNotUnbound=!1,this.friends=[],this.allFriendData=[],this.friendsToInvite=[],this.invitedPlayerId="",this.slotToInvite="",this.armies=[],this.requestToLobbyId="",this.chatActive=!1,this.invitedFriends=[],this.lobbyMembers=[],this.teamMembers=[],this.playersReady=0,this.allPlayersCount=0,this.botCommanders=this.cache.getBotCommanders(),this.isFlooded=!1,this.floodExpires=null,this.floodCountdownString="00:00",this.counters={},this.environmentKeys=[Ql.All,Ql.Morning,Ql.Day,Ql.Rain,Ql.Evening,Ql.Night],this.isPasswordActive=!1,this.duelMaxTeamSize=5,this.activeMode="",this.selectedMissionId="",this.commanderListData={},this.slotsToFillWithAI=[],this.activeSlotWithAI="",this.loadingAI=!1,this.buttonsLocked=!1,this.modeDefaulSettings={pvp:{submode:"groundcontrol",commanderVisibility:Ml.All,armyMode:Nl.All,realism:!1,armyA:"",armyB:"",size:0},pve:{submode:"groundcontrol",commanderVisibility:Ml.All,armyMode:Nl.All,realism:!1,armyA:"",armyB:"",size:0},coop:{submode:"mission",commanderVisibility:Ml.All,armyMode:Nl.All,realism:!1,armyA:"",armyB:"",size:0},duel:{submode:"battlezones_duel",commanderVisibility:Ml.All,armyMode:Nl.All,realism:!1,armyA:"",armyB:"",size:1},tanks:{submode:"battlezones_armored",commanderVisibility:Ml.All,armyMode:Nl.All,realism:!1,armyA:"",armyB:"",size:0},classic:{submode:"groundcontrol_manpower",commanderVisibility:Ml.All,armyMode:Nl.Ally,map:"groundcontrol_manpower_suburb",realism:!0,armyA:"rus",armyB:"ger",size:0}},this.victoryPointsRange=Mx,this.durationRange=Qx,this.budgetData=null,this.mapBackground="",this.chatLoaded=!1,(new al).data.subscribe(t=>this.L=t),this.options.commanderVisibility=Ml.Team,this.matchMaking.insertGameSparks(nd.gameSparks),this.notificatorService.notifications.subscribe(t=>{t&&t.response&&setTimeout(()=>{this.buttonsLocked=!1},250)})}ngOnInit(){this.lobbyId=this.activatedRoute.params.value.lobbyId,console.log("lobby Id taken from url",this.lobbyId),this.userIsInTeam=!!this.cache.getUserTeamId(),this.friends=this.chatService.getFriendsByRelation("friend"),this.friendsToInvite=this.friends.filter(t=>!this.invitedFriends.includes(t.id)),this.allFriendData=this.chatService.getFriends(),this.armies=pk.armiesToArray(pk.createArmies({disabled:!1})),this.selectedCommanderSubscription=this.cache.commanderId.subscribe(t=>{this.selectedCommander=this.cache.getCommander(t),this.selectedCommander&&(this.selectedCommanderUnitLevel=this.cache.getCommanderSlotsLevels(this.selectedCommander.id)),this.userData&&this.userData.ready&&this.userData.ready&&this.unsetReady()}),this.userId=this.cache.getUserId(),this.options=this.lobbyService.lobbyGetOptions(),this.setCommanderOption(),this.userData=this.lobbyService.lobbyGetUser(this.cache.getUserId()),this.tab=this.lobbyService.getSavedLobbyTab()||Jl.Teams,this.lobbyService.lobbyGet(this.lobbyId).subscribe(t=>{t&&(this.lobby=t,this.cache.devMode&&console.log(this.options),this.options=this.lobbyService.lobbyGetOptions(),this.setCommanderOption(),this.activeMode=this.options&&this.options.mode?this.options.mode:Dl.PVP,this.selectedMissionId=this.options&&this.options.map&&this.options.mode===Dl.COOP?this.options.map:"",this.userData=this.lobbyService.lobbyGetUser(this.cache.getUserId()),this.lobbyOwner=t.owner,this.userIsLobbyOwner=this.userId==t.owner,this.slots=this.lobbyService.lobbyGetSlots(),this.unbound=this.lobbyService.lobbyGetTeam(Al.Unbound),this.playerIsNotUnbound=this.playerIsNotUnboundTeam(this.unbound),this.teamSide=this.lobbyService.getLobbyTeam(),this.lobbyType=t.type,this.mapBackground=this.getMapBackground(this.options.map),this.userData.ready&&this.cache.setReadyToFight(!0),this.setActiveChatMessages(),this.setLobbyMembers(),this.teamMembers=this.lobbyService.lobbyGetTeam(this.teamSide),this.countReadyPlayers(),this.countAllPlayers(),this.addToInvitedList(),this.setActiveBudget())}),this.lobbyChangeSubscription=this.lobbyService.onLobbyChange.pipe(We(t=>null!==t)).subscribe(t=>{this.lobby=this.lobbyService.lobbyGetData(),this.slots=this.lobbyService.lobbyGetSlots(),this.unbound=this.lobbyService.lobbyGetTeam(Al.Unbound),this.playerIsNotUnbound=this.playerIsNotUnboundTeam(this.unbound),this.userId!==this.lobbyOwner&&(this.options=this.lobbyService.lobbyGetOptions()),this.userData=this.lobbyService.lobbyGetUser(this.cache.getUserId()),this.cache.devMode&&(console.group("-> LobbyChange (teams, options, user data)"),console.log(this.slots),console.log(this.options),console.log(this.userData),console.groupEnd()),this.setLobbyMembers(),this.teamSide=this.lobbyService.getLobbyTeam(),this.teamMembers=this.lobbyService.lobbyGetTeam(this.teamSide),this.lobbyService.getLobbyTeam()!=this.teamSide&&(this.chatLoaded=!1,this.setActiveChatMessages()),this.countReadyPlayers(),this.countAllPlayers(),this.removeFromInvitedList(),this.addToInvitedList();let e=this.cache.getCurrentArmy();if(!hu.hasTag(e,this.options.map)){let t=hu.getArmy(this.options.map);t&&t!==e&&(this.cache.setArmy(t),Object(Pc.a)(`army changed due to mission: ${e} => ${t}`))}this.options.mode!=this.activeMode&&(this.activeMode=this.options.mode),this.selectedMissionId=this.options.map,this.slotsToFillWithAI&&this.slotsToFillWithAI.length?(this.loadingAI=!0,this.fillSlotWithAI()):this.clearAILoading(),this.setCommanderOption(),this.mapBackground=this.getMapBackground(this.options.map)}),this.onFriendChangeSubscription=this.chatService.chats.pipe(We(t=>null!==t)).subscribe(t=>{t&&t.friend&&!t.friend.side&&this.updateFriendData(t)}),this.grabMapsForCurrentModes(),this.userOptions=this.cache.getPlayerOptions(),this.userOptionsSubscription=this.cache.userOptions.pipe(We(t=>null!==t)).subscribe(t=>this.userOptions=t),this.counters=this.cache.getCounters(),this.counterChangeSubscription=this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>this.counters[t.path]=t.value),this.lobbyMapsWithSubmodes=this.getMapWithSubmode(),this.informator=new dl,this.budgetData=this.setBudget()}ngOnDestroy(){this.selectedCommanderSubscription&&this.selectedCommanderSubscription.unsubscribe(),this.onFriendChangeSubscription&&this.onFriendChangeSubscription.unsubscribe(),this.lobbyChangeSubscription&&this.lobbyChangeSubscription.unsubscribe(),this.userOptionsSubscription&&this.userOptionsSubscription.unsubscribe()}isFeaturesAvailable(){return this.cache.hasFlag("features_in_progress")}hasFlag(t){return this.cache.hasFlag(t)}allow(t){return this.cache.allow(t)}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}openInvitationModal(t,e){t&&(this.buttonsLocked=!0,this.friends&&this.friends.length||(this.friends=this.chatService.getFriendsByRelation("friend")),this.friendsToInvite=this.friends.filter(t=>!this.invitedFriends.includes(t.id)),this.slotToInvite=t,this.lobbyInvitationModal.open(),this.buttonsLocked=!1)}kickFromLobby(t){t&&this.lobbyService.lobbyKick(this.lobbyId,t)}leaveFromLobby(){this.lobbyId&&this.lobbyService.lobbyLeave(this.lobbyId)}getUserCommander(t){return this.cache.getCommander(t)?this.cache.getCommander(t).type:null}goToCommanders(){this.optionsNotSaved&&this.userIsLobbyOwner?this.showConfirmationModal():(this.tab=this.tab===Jl.Troops?Jl.Teams:Jl.Troops,this.lobbyService.saveLobbyTab(this.tab)),this.chatLoaded=!1,this.setActiveChatMessages()}goToSettings(){this.previousOptions=Object.assign({},this.options),this.tab=Jl.Options,this.lobbyService.saveLobbyTab(this.tab),this.chatLoaded=!1,this.setActiveChatMessages()}goToTeams(){this.optionsNotSaved&&this.userIsLobbyOwner?this.showConfirmationModal():(this.tab=Jl.Teams,this.lobbyService.saveLobbyTab(this.tab)),this.chatLoaded=!1,this.setActiveChatMessages()}getUserArmy(t){return this.cache.getCommander(t).army}setReady(t=!1){let e=this.selectedCommander.id,i=this.cache.isReadyToFight();this.buttonsLocked=!0,t||!i?(this.cache.setReadyToFight(!0),this.tab=Jl.Teams,this.lobbyService.saveLobbyTab(this.tab),this.lobbyService.lobbySetCommander(this.lobbyId,e).subscribe(()=>{this.buttonsLocked=!1})):(this.unsetReady(),this.buttonsLocked=!1),this.chatLoaded=!1,this.setActiveChatMessages()}unsetReady(){this.cache.setReadyToFight(!1),this.lobbyService.lobbySetReady(this.lobbyId,!1)}setOption(t,e){if(this.options[t]=e,this.buttonsLocked=!0,"mode"!==t&&"submode"!==t||(this.grabMapsForCurrentModes(),this.submodes.indexOf(this.options.submode)<0&&("submode"===t&&""!==e||"mode"===t&&e===Dl.COOP)&&this.setOption("submode",this.submodes[0]),this.lobbyMaps.indexOf(this.options.map)<0&&this.setOption("map",this.lobbyMaps[0])),"armyMode"===t&&"all"===e&&(this.setOption("armyA",""),this.setOption("armyB","")),"mode"===t){this.selectedMissionId="",e===Dl.COOP&&(this.selectedMissionId=this.options.map),e!==Dl.DUEL&&e!==Dl.COOP&&(this.selectedCommander=this.cache.getCommander(this.cache.getActiveCommanderId()));for(let t in this.modeDefaulSettings[e])this.setOption(t,this.modeDefaulSettings[e][t]);this.unsetReady(),this.setActiveBudget()}"map"==t&&this.options.mode==Dl.COOP&&(this.selectedMissionId=this.options.map),this.mapBackground=this.getMapBackground(this.options.map),this.buttonsLocked=!1,this.optionsNotSaved=!0}getMapBackground(t){let e=this.cache.getMission(t),i="";return i=e?e.background?e.background:e.id:t,i}setActiveBudget(){this.setOption("budget",this.budgetData[this.options.mode]&&this.budgetData[this.options.mode].length>1?this.budgetData[this.options.mode].find(t=>!0===t.default).id:null),this.optionsNotSaved=!1}saveOptions(){this.options.victoryPoints&&(this.options.victoryPoints=Math.floor(this.options.victoryPoints)),this.options.duration&&(this.options.duration=Math.floor(this.options.duration)),this.lobbyService.lobbySetOptions(this.options).subscribe(()=>{this.tab=Jl.Teams,this.lobbyService.saveLobbyTab(this.tab),this.options=this.lobbyService.lobbyGetOptions(),this.previousOptions=null,this.optionsNotSaved=!1,this.setActiveChatMessages()})}setCommanderOption(){this.commanderListData.activeMode=this.options.mode,this.commanderListData.missionId="coop"==this.options.mode?this.options.map:"",this.commanderListData.static="coop"==this.options.mode}clearOptions(){this.options=this.previousOptions?Object.assign({},this.previousOptions):this.lobbyService.lobbyGetOptions(),this.previousOptions=null,this.optionsNotSaved=!1,this.tab=Jl.Teams,this.lobbyService.saveLobbyTab(this.tab),this.selectedMissionId="",this.setActiveChatMessages()}showConfirmationModal(){this.cache.openConfirmModal({key:"meta.ui.lobby.options.save_message",confirm:"meta.ui.lobby.save_options",decline:"meta.ui.exchange.cancel_button",title:"meta.ui.lobby.options.save_title"},()=>{this.saveOptions()},null,()=>{this.clearOptions()})}grabMapsForCurrentModes(){let t=this.cache.getLobbyMaps(this.options.mode);this.lobbyMapsList={},this.lobbyMaps=t.maps.filter(t=>!this.options.submode||this.options.submode&&t.submode&&t.submode.indexOf(this.options.submode)>=0).map(t=>(this.lobbyMapsList[t._id]=t,t._id)),this.submodes=t.submodes,this.cache.devMode&&console.log(this.lobbyMaps,t)}checkIfCanStart(){let t=this.getNotReadyPlayers();t.length?(console.log("notReadyPlayers",t),this.lobbyMembersModal.open()):this.lobbyStart()}lobbyStart(){this.buttonsLocked=!0,this.lobbyService.lobbyStart().subscribe(()=>{this.lobbyService.lobbyClose(),this.buttonsLocked=!1})}setChatTab(t){this.activeChatTab=t,this.chatLoaded=!1,this.setActiveChatMessages()}markAsReaded(t){this.chatService.markAsReaded(t)}leaveFromTeam(){let t={operation:"leave",player:this.cache.getUserId(),team:this.cache.getUserTeamId()};this.chatService.teamOperation(t).then(()=>{this.lobbyService.lobbyClose()})}getPlayerReadyToFight(){return this.cache.isReadyToFight()}setActiveChatMessages(){setTimeout(()=>{this.chat&&this.chat.close(),this.activeChatTab==Dx.All&&this.chat?(this.chat.open(this.chatService.getFriends().find(t=>t.id==this.lobbyId)),this.setUnreadedMessages(this.lobbyId,0)):this.activeChatTab==Dx.Team&&this.chat&&(this.chat.open(this.chatService.getFriends().find(t=>t.id==this.lobbyId+"_"+this.teamSide)),this.setUnreadedMessages(this.lobbyId+"_"+this.teamSide,0)),this.messageInput="",this.chatLoaded=!0},150)}getUnreadedMessages(t){return t&&this.chatService.getFriends().find(e=>e.id==t)?this.chatService.getFriends().find(e=>e.id==t).unreaded:0}setUnreadedMessages(t,e){this.markAsReaded(t);let i=this.chatService.getFriends().find(e=>e.id===t);i&&(i.unreaded=e)}sendMessage(){if(!this.messageInput.length)return;let t=this.cache.getUserName(),e="",i=this.lobbyId;this.activeChatTab==Dx.All?e=zd.Lobby:this.activeChatTab==Dx.Team&&(e=zd.LobbyCustom),this.chatService.messageSend(this.messageInput.trim(),i,t,e).subscribe(t=>{(t.scriptData||t.scriptData.result||t.scriptData.result.sent)&&(1==t.scriptData.result.sent?(this.isFlooded=!1,this.floodExpires=null,this.messageInput="",this.markAsReaded(i),this.buttonsLocked=!1):(this.isFlooded=t.scriptData.result.flood,this.floodExpires=t.scriptData.result.floodExpires,this.cache.alertSound("error"),this.buttonsLocked=!1,this.runFloodCountown()))})}runFloodCountown(){let t;this.isFlooded&&(t=setInterval(()=>{if(new Date(this.floodExpires).isGreaterEqual(new Date)){let t=new Date(this.floodExpires).diff(new Date);this.floodCountdownString=(new Date).getDifferenceString(t,"",!0,this.L)}else clearInterval(t),this.isFlooded=!1,this.floodExpires=null,setTimeout(()=>{this.chatInput&&this.chatInput.nativeElement.focus()})},250))}onModelKeydown(t){13===t.keyCode&&this.sendMessage()}onInputKeydown(t){!this.optionsNotSaved&&this.userIsLobbyOwner&&(this.optionsNotSaved=!0)}joinToLobbyTeam(t){t&&this.lobbyId&&this.lobbyService.lobbyJoinByOwner(this.lobbyId,t)}isCommanderFilled(t){return this.cache.isCommanderFilled(t)}isFreemimCommanderOpen(t){return this.cache.isPremium()||t?t.freemium:null}lobbyKickPlayer(t){t&&this.lobbyId&&(this.buttonsLocked=!0,this.lobbyService.lobbyKickPlayer(this.lobbyId,t).subscribe(e=>{this.removePlayerFromMembers(t),this.buttonsLocked=!1,this.invitedPlayerId=""}))}lobbyTakeSlot(t,e){t&&this.lobbyId&&(this.buttonsLocked=!0,this.lobbyService.lobbyTakeSlot(this.lobbyId,t).subscribe(t=>{this.buttonsLocked=!1,this.chatLoaded=!1,this.setActiveChatMessages()}))}lobbySetupSlot(t,e,i){this.lobbyId&&(this.buttonsLocked=!0,i&&"bot"==e?this.lobbyService.lobbySetupSlot(this.lobbyId,t,e,i).subscribe(()=>{this.options=this.lobbyService.lobbyGetOptions(),this.buttonsLocked=!1}):this.lobbyService.lobbySetupSlot(this.lobbyId,t,e).subscribe(()=>{this.options=this.lobbyService.lobbyGetOptions(),this.buttonsLocked=!1}))}playerIsNotUnboundTeam(t){return!t.length||!t.find(t=>t.id===this.userId)}openBotSelection(t,e){let i=this.options.unitLevel,n=this.selectArmyForBot(e);this.botSelect.open(t,i,n,this.options.mode)}selectArmyForBot(t){let e=[];if(this.options.armyMode===Nl.Exact)switch(t){case Al.TeamA:this.options.armyA&&this.options.armyA.length?e.push(this.options.armyA):e=[];break;case Al.TeamB:this.options.armyB&&this.options.armyB.length?e.push(this.options.armyB):e=[]}else if(this.options.armyMode===Nl.Ally)switch(t){case Al.TeamA:e=this.options.armyA&&this.options.armyA.length?Pl[this.options.armyA]:[];break;case Al.TeamB:e=this.options.armyB&&this.options.armyB.length?Pl[this.options.armyB]:[]}return e}selectBotCommander(t){let e=t.commander;return"empty"===e?(this.lobbySetupSlot(t.slotId,zl.Bot,null),void(this.buttonsLocked=!1)):e&&e.id&&t.slotId?void this.lobbySetupSlot(t.slotId,zl.Bot,e.id):(console.error("no commander",t),void(this.buttonsLocked=!1))}getBotArmy(t){if(this.botCommanders&&t)return this.botCommanders.commanders.find(e=>e._id===t).army}getBotCommanderType(t){if(this.botCommanders&&t)return this.botCommanders.commanders.find(e=>e._id===t).type}getNotReadyPlayers(){let t=[];if(!this.lobby||this.lobby&&!this.lobby.members)return t;for(let e in this.lobby.members){let i=this.lobby.members[e];i.type!==Al.TeamA&&i.type!==Al.TeamB||i.ready||t.push(i)}return t}getNotReadyPlayersNames(){return this.getNotReadyPlayers().map((t,e,i)=>(e===i.length-1&&e>0?" "+this.L("meta.ui.lobby.players_and"):e>0?",":"")+" "+`**${t.displayName}**`).join("")}checkIfUserIsAFriend(t){let e=!0;if(this.allFriendData&&this.allFriendData.length&&t!=this.userId)return e=!!this.allFriendData.find(e=>e.id==t),e}addNewFriendRequest(t){t&&(this.buttonsLocked=!0,this.chatService.requestFriendAdd(t).subscribe(t=>{this.buttonsLocked=!1}))}isUnitLevelFits(){return this.options.unitLevel<3||this.options.unitLevel>=3&&this.selectedCommanderUnitLevel.max<=this.options.unitLevel}getNationFromOptions(){return this.lobbyService.getLobbyTeam()===Al.TeamA?this.options.armyA||El.All:this.options.armyB||El.All}isNationAvailable(){return this.options.armyMode===Nl.All||this.getNationFromOptions()==El.All||this.getNationFromOptions()==El.None||(this.options.armyMode===Nl.Exact&&this.selectedCommander?this.selectedCommander.army===this.getNationFromOptions():this.options.armyMode===Nl.Ally&&this.selectedCommander?this.lobbyService.lobbyIsAllyNation(this.selectedCommander.army,this.getNationFromOptions()):void 0)}getAvailableArmies(){let t=[];return this.options.armyMode===Nl.Exact?t=[this.getNationFromOptions()]:this.options.armyMode===Nl.Ally&&(t=Pl[this.getNationFromOptions()]),t.map(t=>`**${this.L("meta.ui.menu.nation."+t)}**`).join(", ")}getPlayerCommanderLevel(){return this.cache.getCommanderProgress(this.cache.getActiveCommanderId()).currentLevel}slotId(t,e){return e.id}addUserToNewLobby(t,e){if(!this.lobbyId||!t||e)return;this.invitedPlayerId=t;let i=this.getSlotToInvite(this.slotToInvite);i&&(this.cache.startLoadingProgress("addToLobby"),this.lobbyService.lobbyInvite(this.lobbyId,t,i).subscribe(e=>{this.requestToLobbyId=t,this.invitedFriends.push(t),this.cache.stopLoadingProgress("addToLobby"),this.buttonsLocked=!1},t=>{this.buttonsLocked=!1,this.cache.stopLoadingProgress("addToLobby"),this.clearInvitationData()}))}getSlotToInvite(t){let e="",i=this.lobbyService.lobbyGetData().slots,n=Object.keys(i),s=n.indexOf(t);return e=i&&i[t]&&"open"!==i[t].state?n.indexOf(t)+1<=n.length-1?this.getSlotToInvite(n[s+1]):this.getSlotToInvite(n[0]):t,this.slotToInvite=e,e}isTeamsReady(){return[Dl.PVP,Dl.DUEL,Dl.TANKS,Dl.CLASSIC].indexOf(this.options.mode)>=0?this.slots.teamA.notEmpty&&this.slots.teamB.notEmpty:this.options.mode===Dl.PVE||this.options.mode===Dl.COOP?this.slots.teamA.notEmpty:void 0}clearInvitationData(){this.slotToInvite="",this.requestToLobbyId="",this.invitedPlayerId=""}updateFriendData(t){if(!t||!this.allFriendData)return;let e=this.allFriendData.find(e=>e.id===t.id);e?(Object.assign(e,t),e.relation==Ud.Friend?this.friends.push(t):e.relation==Ud.None&&this.clearFriendList(e.id)):this.allFriendData.push(t)}clearFriendList(t){if(!this.friends||!this.friends.length)return;let e=null;this.friends.map((i,n)=>{i.id==t&&(e=n)}),this.friends.splice(e,1)}removeFromInvitedList(){let t=this.lobby&&this.lobby.members?this.lobby.members:null;if(t&&this.invitedFriends&&this.invitedFriends.length){let e=0;for(let i of this.invitedFriends)t[i]||(e=this.invitedFriends.indexOf(i),this.invitedFriends.splice(e,1))}}addToInvitedList(){let t=this.lobby&&this.lobby.members?this.lobby.members:null;if(t)for(let e in t){if(e==this.userId)return;this.invitedFriends.length&&this.invitedFriends.includes(e)||this.invitedFriends.push(e)}}getMapWithSubmode(){let t=this.cache.getLobbyMaps(this.options.mode),e={};if(t&&t.maps&&t.maps.length)for(let i of t.maps)i._id&&(e[i._id]=i.submode[0]?i.submode[0]:null);return e}countReadyPlayers(){this.lobbyMembers&&this.lobbyMembers.length&&(this.playersReady=this.lobbyMembers.filter(t=>t.ready&&1==t.ready).length)}countAllPlayers(){this.lobbyMembers&&this.lobbyMembers.length&&(this.allPlayersCount=this.lobbyMembers.filter(t=>t.slot&&"u"!==t.slot).length)}setLobbyMembers(){if(this.lobby&&this.lobby.members){if(this.lobbyMembers&&this.lobbyMembers.length)for(let t of this.lobbyMembers)if(!this.lobby.members[t.id]){const e=this.lobbyMembers.indexOf(t);this.lobbyMembers.splice(e,1)}for(let t in this.lobby.members)if(this.lobbyMembers.find(e=>e.id==t))Object.assign(this.lobbyMembers.find(e=>e.id==t),this.lobby.members[t]);else{let e=this.lobby.members[t];e.id=t,this.lobbyMembers.push(e)}}}removePlayerFromMembers(t){if(this.lobbyMembers&&this.lobbyMembers.length){let e=this.lobbyMembers.find(e=>e.id==t);if(e){const t=this.lobbyMembers.indexOf(e);this.lobbyMembers.splice(t,1)}}if(this.teamMembers&&this.teamMembers.length){let e=this.teamMembers.find(e=>e.id==t);if(e){const t=this.teamMembers.indexOf(e);this.teamMembers.splice(t,1)}}}setSlotsWithAI(t){if(t){switch(t){case Al.TeamA:this.slotsToFillWithAI=this.slots.teamA.filter(t=>t.state&&"open"==t.state);break;case Al.TeamB:this.slotsToFillWithAI=this.slots.teamB.filter(t=>t.state&&"open"==t.state)}this.slotsToFillWithAI&&this.slotsToFillWithAI.length?(this.loadingAI=!0,this.fillSlotWithAI(),this.buttonsLocked=!1,this.loadingAI=!1):this.clearAILoading()}}fillSlotWithAI(){this.buttonsLocked=!0;let t=this.slotsToFillWithAI[0];this.slotsToFillWithAI&&this.slotsToFillWithAI.length&&this.slotsToFillWithAI[1]&&(this.activeSlotWithAI=this.slotsToFillWithAI[1].id),t&&t.state&&"open"==t.state&&t.id&&this.botSelect.selectBot(t.id,"empty"),this.slotsToFillWithAI.shift()}clearAILoading(){this.loadingAI=!1,this.slotsToFillWithAI=[],this.activeSlotWithAI="",this.buttonsLocked=!1}getPasswordData(t){this.options.password=t.password}setTeamAutobalance(){this.lobbyId&&(this.buttonsLocked=!0,this.cache.startLoadingProgress("addToLobby"),this.lobbyService.lobbyShuffle(this.lobbyId).subscribe(t=>{this.cache.stopLoadingProgress("addToLobby"),this.buttonsLocked=!1},t=>{this.buttonsLocked=!1,this.cache.stopLoadingProgress("addToLobby")}))}setBudget(){let t={};if(!this.informator)return null;let e=this.informator.getBudget();for(let i in e)if(e[i].mode)for(let n of e[i].mode)t[n]||(t[n]=[]),t[n].splice(e[i].display_order,0,{id:i,default:e[i].default});return t}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Bl),o.Nb(Yd),o.Nb(Pd),o.Nb(Uc),o.Nb(xn))},t.\u0275cmp=o.Hb({type:t,selectors:[["lobby"]],viewQuery:function(t,e){if(1&t&&(o.Qc($R,!0),o.Qc(GR,!0),o.Qc(HR,!0),o.Qc(YR,!0),o.Qc(WR,!0),o.Qc(KR,!0),o.Qc(XR,!0),o.Qc(ZR,!0),o.Qc(tO,!0)),2&t){let t;o.vc(t=o.Zb())&&(e.scrollable=t.first),o.vc(t=o.Zb())&&(e.selectBotModal=t.first),o.vc(t=o.Zb())&&(e.botFilterSeekLink=t.first),o.vc(t=o.Zb())&&(e.lobbyMembersModal=t.first),o.vc(t=o.Zb())&&(e.lobbyInvitationModal=t.first),o.vc(t=o.Zb())&&(e.commandersPage=t.first),o.vc(t=o.Zb())&&(e.chatInput=t.first),o.vc(t=o.Zb())&&(e.chat=t.first),o.vc(t=o.Zb())&&(e.botSelect=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("grid-default",!0)},outputs:{onChatOpen:"onChatOpen"},features:[o.Ab([nd,Bl,Yd,Pd,Uc])],decls:75,vars:73,consts:[["g-lobby-title","","class","color-white",4,"ngIf"],["g-lobby-modes",""],[1,"large-tabs-list","clear"],["fade-in","down",1,"list-item"],["type","button","fade-in","up",1,"large-tab-button","texture-border",3,"alertSound","tooltip-hint","click"],[1,"tab-shadow"],[1,"tab-title","text-overflow"],[1,"tab-description","text-overflow"],[4,"ngIf"],["draggable","false",1,"tab-icon","default",3,"src"],["draggable","false",1,"tab-icon","hover",3,"src"],["class","large-tab-button texture-border","type","button","fade-in","up",3,"alertSound","tooltip-hint","active","disabled","click",4,"ngIf"],["teamColumnTemplate",""],["g-lobby-troops-title","",4,"ngIf"],["g-lobby-troops","",2,"width","calc(var(--commander-width) * 3 + var(--unit-list-gutter) * 8)"],[3,"ignoreClosed","static","missionId","tag"],["commandersList",""],["g-lobby-army-select","",4,"ngIf"],["g-lobby-commander-detail","",4,"ngIf"],["g-lobby-team-a-title","",3,"color-primary",4,"ngIf"],["g-lobby-team-a-button","","class","align-right",4,"ngIf"],["g-lobby-team-a","","class","lobby-team tile texture-border no-hover",4,"ngIf"],["g-lobby-team-b-title","",3,"color-primary",4,"ngIf"],["g-lobby-team-b-button","","class","align-right",4,"ngIf"],["g-lobby-team-b","","class","lobby-team tile texture-border no-hover",4,"ngIf"],["g-lobby-team-s-button","","class","align-right",4,"ngIf"],["g-lobby-reserve","","class","lobby-team tile texture-border no-hover",4,"ngIf"],["g-lobby-settings-title","",4,"ngIf"],["g-lobby-settings","","class","settings-grid",4,"ngIf"],["g-lobby-advanced","",4,"ngIf"],["g-lobby-map","",4,"ngIf"],[3,"onSelect"],["botSelect",""],[3,"id","header","icon"],["lobbyMembersModal",""],[1,"body","collapsed-top","align-center"],[3,"innerHTML"],["type","button","class","button large",3,"disabled","tooltip-hint","alertSound","click",4,"ngIf"],[1,"button","transparent","margin-left",3,"alertSound","click"],[3,"id"],["rulesModal",""],[1,"body"],[1,"rules-article"],["fade-in","down",1,"description",3,"innerHTML"],[1,"smaller",3,"id","header","onClose"],["lobbyInvitationModal",""],["class","body align-center collapsed-top",4,"ngIf"],["class","body collapsed-top scroll-height",4,"ngIf"],["g-lobby-play","","fade-in","down",1,"align-center"],["class","alert simple",3,"innerHTML",4,"ngIf"],["type","button","class","button waiting-button middle",3,"tooltip-hint","large","alertSound","disabled","red","click",4,"ngIf"],["type","button","class","button large",3,"alertSound","disabled","click",4,"ngIf"],["class","lobby-chat tile texture-border no-hover verticaly-bottom","g-lobby-chat","",4,"ngIf"],["g-lobby-title","",1,"color-white"],[3,"tooltip-hint",4,"ngIf"],[3,"tooltip-hint"],[1,"team-cover"],["class","spaced-bottom",3,"color-primary",4,"ngIf"],["class","chat-item darken","fade-in","down",3,"active",4,"ngFor","ngForOf","ngForTrackBy"],[1,"spaced-bottom"],["fade-in","down",1,"chat-item","darken"],["class","chat-flag-image","draggable","false",3,"src",4,"ngIf"],[1,"chat-image"],[3,"player"],[1,"caption"],[3,"name"],["class","chat-status",4,"ngIf"],[1,"controls","visible"],["class","control-icon",3,"src",4,"ngIf"],[1,"title-dropdown","not-visible",3,"tooltip-hint","icon","btn","onOpen","onClose"],["playerOptions",""],[1,"clear"],["draggable","false",1,"chat-flag-image",3,"src"],[1,"chat-status"],[1,"control-icon",3,"src"],["type","button",1,"button","transparent","block",3,"alertSound","click"],[1,"chat-image","empty"],["draggable","false",3,"src"],[1,"name","capitalize"],["class","controls visible",4,"ngIf"],["type","button",1,"button","small",3,"tooltip-hint","alertSound","click"],[1,"title-dropdown",3,"icon","btn","tooltip-hint","onOpen","onClose"],["openSlotOptions",""],["type","button",1,"button","transparent","block",3,"click"],[3,"hidden",4,"ngIf"],["src","assets/img/icons/svg/lock-icon.svg","draggable","false"],[1,"name"],["class","button small","type","button",3,"disabled","click",4,"ngIf"],["closedSlotOptions",""],["type","button",1,"button","small",3,"click"],[1,"chat-image",3,"tooltip-hint"],["src","assets/img/icons/svg/check_circle_online.svg",1,"control-icon"],["botOptions",""],["class","title-dropdown",3,"tooltip-hint","icon","btn","onOpen","onClose",4,"ngIf"],[1,"title-dropdown",3,"tooltip-hint","icon","btn","onOpen","onClose"],["invitedPlayerOptions",""],[1,"spaced-bottom","spaced-top"],["class","chat-item darken","fade-in","down",3,"active",4,"ngFor","ngForOf"],["class","title-dropdown",3,"icon","btn","tooltip-hint","onOpen","onClose",4,"ngIf"],["unboundPlayerOptions",""],["g-lobby-troops-title",""],["g-lobby-army-select",""],[3,"commanders"],["g-lobby-commander-detail",""],[3,"commander"],["g-lobby-team-a-title",""],["g-lobby-team-a-button","",1,"align-right"],["class","small button","type","button",3,"disabled","click",4,"ngIf"],["type","button",1,"small","button",3,"click"],["g-lobby-team-a","",1,"lobby-team","tile","texture-border","no-hover"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["g-lobby-team-b-title",""],["g-lobby-team-b-button","",1,"align-right"],["g-lobby-team-b","",1,"lobby-team","tile","texture-border","no-hover"],["g-lobby-team-s-button","",1,"align-right"],["g-lobby-reserve","",1,"lobby-team","tile","texture-border","no-hover"],["g-lobby-settings-title",""],[1,"button","white","spaced-left",3,"click"],[1,"icon-group"],["src","assets/img/icons/svg/attention-light.svg","draggable","false",1,"icon","hover-hidden"],["src","assets/img/icons/svg/attention-red.svg","draggable","false",1,"icon","hover-visible"],[1,"text"],["g-lobby-settings","",1,"settings-grid"],[1,"lobby-options"],["class","form-group labeled-group",4,"ngIf"],[3,"text","label","disabled","origin","tooltip-hint",4,"ngIf"],[3,"text","label","disabled","origin","tooltip-hint"],["submodesDropdown",""],[3,"active","tooltip-hint",4,"ngFor","ngForOf"],[3,"text","label","disabled","origin","tutorial-dropdown","tooltip-hint",4,"ngIf"],["environmentDropdown",""],["unitLevelDropdown",""],[1,"button","transparent","block",3,"alertSound","click"],["realismModeDropdown",""],["sizeDropdown",""],["armiesModeDropdown",""],["armyADropdown",""],["armyBDropdown",""],[3,"text","label","disabled","tooltip-hint","origin"],["serverPlacementDropdown",""],["class","form-group labeled-group",3,"disabled","error",4,"ngIf"],["class","form-group labeled-group disabled",4,"ngIf"],["style","font-size: var(--small-font-size); text-align: left;",4,"ngIf"],[1,"form-group","labeled-group"],["for","tournamentNameInput",1,"input-label"],["type","text","maxlength","250","id","tournamentName",1,"input","small",3,"ngModel","placeholder","ngModelChange","keydown"],["tournamentNameInput",""],["modesDropdown",""],["lobbyMapsDropdown",""],[2,"height","calc(var(--font-size) * 25)"],[3,"active","tooltip-hint",4,"ngIf"],["difficultiesStringDropdown",""],["commanderVisibilityDropdown",""],["passwordDropdown",""],[1,"button","transparent","block",3,"alertSound","tooltip-hint","click"],[3,"password","placeholder","label","onInputKeydown"],[1,"form-group","labeled-group","disabled"],["for","lobbyPassword",1,"input-label"],["type","password","disabled","","id","lobbyPassword",1,"input","disabled","small",3,"value"],["passwordInput",""],[2,"font-size","var(--small-font-size)","text-align","left"],["g-lobby-advanced",""],[1,"simple"],["class","form-group labeled-group",3,"error","disabled",4,"ngIf"],[3,"text","disabled","origin","tooltip-hint",4,"ngIf"],[1,"warning-info"],["src","assets/img/icons/svg/warning.svg",1,"warning-icon"],[1,"warning-text"],["for","victoryPoints",1,"input-label"],["type","number","maxlength","64","id","victoryPoints",1,"input","small",3,"ngModel","min","max","pattern","disabled","ngModelChange","keydown"],["victoryPoints",""],["class","error-hint align-right",4,"ngIf"],[1,"error-hint","align-right"],["for","duration",1,"input-label"],["type","number","maxlength","64","id","duration",1,"input","small",3,"ngModel","min","max","pattern","disabled","ngModelChange","keydown"],["duration",""],[3,"text","disabled","origin","tooltip-hint"],["budgetDropdown",""],["class","with-helper",3,"active",4,"ngFor","ngForOf"],[1,"with-helper"],[1,"helper"],["g-lobby-map",""],[1,"lobby-map","tile","texture-border",3,"alertSound","tooltip-hint"],["src","assets/img/fake_1x1.png",1,"fake-image"],["src","assets/img/minimap/random.svg",1,"random-icon"],[1,"bottom-cover"],["type","button",1,"button","large",3,"tooltip-hint","alertSound","click"],[1,"body","align-center","collapsed-top"],[1,"body","collapsed-top","scroll-height"],[3,"height","bbox",4,"ngIf"],[3,"height","bbox"],["scrollable",""],["class","button small",3,"disabled","alertSound","click",4,"ngIf"],["class","button small red","type","button",3,"disabled","alertSound","click",4,"ngIf"],["class","control-status",4,"ngIf"],["class","progress-bar simple",4,"ngIf"],[1,"button","small",3,"alertSound","click"],["type","button",1,"button","small","red",3,"alertSound","click"],[1,"control-status"],[1,"progress-bar","simple"],[1,"alert","simple",3,"innerHTML"],["type","button",1,"button","waiting-button","middle",3,"tooltip-hint","alertSound","click"],["type","button",1,"button","large",3,"alertSound","click"],["g-lobby-chat","",1,"lobby-chat","tile","texture-border","no-hover","verticaly-bottom"],[1,"main-body","grid-cover"],[1,"chats","left-side","side","with-bottom-tabs"],[3,"height","bbox","origin","contentBottom"],["class","chats-cover",4,"ngIf"],[1,"chat-tabs","bottom-part"],["type","button",1,"button","small","chat-tab",3,"alertSound","click"],[1,"button-text"],["class","marker",4,"ngIf"],["type","button","class","button small chat-tab",3,"alertSound","active","disabled","click",4,"ngIf"],[1,"details","right-side","side","no-header"],[1,"chat-main"],[1,"team","chat-main"],[1,"preloader"],["chat",""],[1,"chats-cover"],["class","chat-item","fade-in","down",4,"ngFor","ngForOf"],["fade-in","down",1,"chat-item"],["src","assets/img/icons/svg/mute.svg","draggable","false","class","icon muted",3,"tooltip-hint",4,"ngIf"],[1,"marker"],["src","assets/img/icons/svg/mute.svg","draggable","false",1,"icon","muted",3,"tooltip-hint"],["class","button-text",4,"ngIf"]],template:function(t,e){if(1&t){const t=o.Sb();o.Jc(0,eO,2,1,"h3",0),o.Rb(1,"div",1),o.Rb(2,"ul",2),o.Rb(3,"li",3),o.Rb(4,"button",4),o.Yb("click",function(){return e.triggerGlobalEvent("button.lobby.setting",{tutorial:!0}),e.goToSettings()}),o.Ob(5,"span",5),o.Rb(6,"span",6),o.Lc(7),o.Qb(),o.Rb(8,"span",7),o.Jc(9,iO,2,1,"span",8),o.Jc(10,nO,2,1,"span",8),o.Jc(11,sO,2,1,"span",8),o.Qb(),o.Ob(12,"img",9),o.Ob(13,"img",10),o.Qb(),o.Qb(),o.Rb(14,"li",3),o.Rb(15,"button",4),o.Yb("click",function(){return e.triggerGlobalEvent("button.lobby.teams"),e.goToTeams()}),o.Ob(16,"span",5),o.Rb(17,"span",6),o.Lc(18),o.Qb(),o.Rb(19,"span",7),o.Jc(20,aO,2,2,"span",8),o.Qb(),o.Ob(21,"img",9),o.Ob(22,"img",10),o.Qb(),o.Qb(),o.Rb(23,"li",3),o.Jc(24,cO,8,11,"button",11),o.Qb(),o.Qb(),o.Qb(),o.Jc(25,$O,4,4,"ng-template",null,12,o.Kc),o.Jc(27,GO,2,1,"h3",13),o.Rb(28,"div",14),o.Ob(29,"commanders-list",15,16),o.Qb(),o.Jc(31,YO,2,2,"div",17),o.Jc(32,WO,2,1,"div",18),o.Jc(33,KO,2,3,"h3",19),o.Jc(34,ZO,2,1,"div",20),o.Jc(35,eT,2,5,"div",21),o.Jc(36,iT,2,3,"h3",22),o.Jc(37,sT,2,1,"div",23),o.Jc(38,aT,2,5,"div",24),o.Jc(39,oT,2,1,"div",25),o.Jc(40,cT,2,5,"div",26),o.Jc(41,lT,9,5,"h3",27),o.Jc(42,NT,59,106,"div",28),o.Jc(43,$T,11,8,"div",29),o.Jc(44,HT,5,5,"div",30),o.Rb(45,"bot-select",31,32),o.Yb("onSelect",function(t){return e.selectBotCommander(t)}),o.Qb(),o.Rb(47,"modal",33,34),o.Rb(49,"div",35),o.Rb(50,"article"),o.Ob(51,"p",36),o.Qb(),o.Qb(),o.Rb(52,"div",35),o.Jc(53,YT,2,5,"button",37),o.Rb(54,"button",38),o.Yb("click",function(){return o.zc(t),o.wc(48).close()}),o.Lc(55),o.Qb(),o.Qb(),o.Qb(),o.Rb(56,"modal",39,40),o.Rb(58,"div",41),o.Rb(59,"article",42),o.Ob(60,"p",43),o.Qb(),o.Qb(),o.Qb(),o.Rb(61,"modal",44,45),o.Yb("onClose",function(){return e.clearInvitationData()}),o.Rb(63,"div",41),o.Jc(64,WT,2,1,"div",46),o.Jc(65,ax,2,1,"div",47),o.Qb(),o.Qb(),o.Rb(66,"div",48),o.Jc(67,rx,1,1,"div",49),o.Jc(68,cx,1,4,"div",49),o.Jc(69,ux,1,3,"div",49),o.Jc(70,dx,1,1,"div",49),o.Jc(71,hx,2,5,"button",37),o.Jc(72,bx,2,9,"button",50),o.Jc(73,mx,2,4,"button",51),o.Qb(),o.Jc(74,Bx,21,17,"div",52)}2&t&&(o.jc("ngIf",e.lobbyType),o.Bb(4),o.Fb("active","options"==e.tab)("disabled",e.buttonsLocked),o.kc("tooltip-hint",e.L("meta.hint.lobby.setting_button.hint")),o.jc("alertSound",o.mc(69,oO)),o.Bb(3),o.Mc(e.L("meta.ui.lobby.setting_button.title")),o.Bb(2),o.jc("ngIf",e.options.submode),o.Bb(1),o.jc("ngIf",e.options.armyMode),o.Bb(1),o.jc("ngIf",e.options.map),o.Bb(1),o.jc("src","assets/img/icons/buttons/lobby_setting.svg",o.Cc),o.Bb(1),o.jc("src","assets/img/icons/buttons/lobby_setting_hover.svg",o.Cc),o.Bb(2),o.Fb("active","teams"==e.tab)("disabled",e.buttonsLocked),o.kc("tooltip-hint",e.L("meta.hint.lobby.teams_button.hint")),o.jc("alertSound",o.mc(70,oO)),o.Bb(3),o.Mc(e.L("meta.ui.lobby.teams_button.title")),o.Bb(2),o.jc("ngIf",e.playersReady),o.Bb(1),o.jc("src","assets/img/icons/buttons/lobby_team.svg",o.Cc),o.Bb(1),o.jc("src","assets/img/icons/buttons/lobby_team_hover.svg",o.Cc),o.Bb(2),o.jc("ngIf",e.playerIsNotUnbound),o.Bb(3),o.jc("ngIf","troops"==e.tab),o.Bb(1),o.Fb("active","troops"==e.tab),o.Bb(1),o.jc("ignoreClosed",!0)("static",e.commanderListData.static)("missionId",e.commanderListData.missionId)("tag",e.commanderListData.activeMode),o.Bb(2),o.jc("ngIf","troops"==e.tab&&e.selectedCommander),o.Bb(1),o.jc("ngIf","troops"==e.tab&&e.selectedCommander),o.Bb(1),o.jc("ngIf",e.slots&&"teams"==e.tab),o.Bb(1),o.jc("ngIf",e.slots&&"teams"==e.tab&&"custom"==e.lobbyType),o.Bb(1),o.jc("ngIf",e.slots&&"teams"==e.tab),o.Bb(1),o.jc("ngIf",e.slots&&"teams"==e.tab),o.Bb(1),o.jc("ngIf",e.slots&&"teams"==e.tab&&"custom"==e.lobbyType),o.Bb(1),o.jc("ngIf",e.slots&&"teams"==e.tab),o.Bb(1),o.jc("ngIf",e.slots&&"teams"==e.tab&&"custom"==e.lobbyType),o.Bb(1),o.jc("ngIf",e.slots&&"teams"==e.tab),o.Bb(1),o.jc("ngIf","options"==e.tab),o.Bb(1),o.jc("ngIf","options"==e.tab),o.Bb(1),o.jc("ngIf","options"==e.tab&&"coop"!==e.options.mode),o.Bb(1),o.jc("ngIf","options"==e.tab),o.Bb(3),o.jc("id","lobby_not_ready_members")("header",e.L("meta.ui.error.attention"))("icon","warning"),o.Bb(4),o.jc("innerHTML",e.L("meta.ui.lobby.player"+(e.getNotReadyPlayers().length>1?"s_are":"_is")+"_not_ready",o.nc(71,jx,e.getNotReadyPlayersNames())).markdown().br(),o.Ac),o.Bb(2),o.jc("ngIf",e.userIsLobbyOwner&&e.tab===e.LobbyTab.Teams),o.Bb(1),o.Fb("disabled",e.buttonsLocked),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L("meta.ui.match.cancel")),o.Bb(1),o.Nc(" ",e.L("meta.ui.match.cancel")," "),o.Bb(1),o.jc("id","lobby_rules."+e.options.mode),o.Bb(4),o.jc("innerHTML",e.L("meta.ui.mode."+e.options.submode+".rules").markdown(),o.Ac),o.Bb(1),o.jc("id","custom_lobby_invitation")("header",e.L(e.friendsToInvite&&e.friendsToInvite.length?"meta.ui.chat.lobby_invitation":"meta.ui.chat.friends_list_empty")),o.Bb(3),o.jc("ngIf",!e.friendsToInvite||!e.friendsToInvite.length),o.Bb(1),o.jc("ngIf",e.friendsToInvite&&e.friendsToInvite.length),o.Bb(2),o.jc("ngIf",e.selectedCommander&&!e.isCommanderFilled(e.selectedCommander)&&"options"!==e.tab&&e.playerIsNotUnbound),o.Bb(1),o.jc("ngIf",!e.isUnitLevelFits()&&"options"!==e.tab),o.Bb(1),o.jc("ngIf",!e.isNationAvailable()&&"options"!==e.tab&&e.selectedCommander),o.Bb(1),o.jc("ngIf",e.selectedCommander&&!e.selectedCommander.available&&"options"!==e.tab&&e.playerIsNotUnbound&&!e.selectedCommander.const),o.Bb(1),o.jc("ngIf",e.userIsLobbyOwner&&e.tab!==e.LobbyTab.Options),o.Bb(1),o.jc("ngIf",e.userData&&e.userData.slot&&"u"!=e.userData.slot&&(e.tab===e.LobbyTab.Troops||e.tab===e.LobbyTab.Teams)),o.Bb(1),o.jc("ngIf",e.userIsLobbyOwner&&e.tab===e.LobbyTab.Options),o.Bb(1),o.jc("ngIf","teams"==e.tab))},encapsulation:2}),t})();var Dx=function(t){return t.All="all",t.Team="team",t}({});let Ex=(()=>{class t{transform(t,e){if(Array.isArray(t)){if(!e)return t;if("string"==typeof e){let i=!1;"!"===e[0]&&(i=!0,e=e.substr(1)),t.sort((t,n)=>(i?Iu(t,e)>Iu(n,e):Iu(t,e)<Iu(n,e))?1:(i?Iu(t,e)<Iu(n,e):Iu(t,e)>Iu(n,e))?-1:0)}else"function"==typeof e&&t.sort(e);return t}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Mb({name:"sortList",type:t,pure:!0}),t})(),Nx=function(t){let e,i=t.replace(/\!/gim,"");i===this.sortingKey.replace(/\!/gim,"")?(e="!"===this.sortingKey[0],this.sortingKey=`${e?"":"!"}${i}`):this.sortingKey=t};const Fx=["refreshButton"],Px=["passwordModal"],Ux=["passwordInput"],zx=["createLobbyModal"];function Jx(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",28),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(8);return o.bc().choosenModeFilter=i,n.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Fb("active",i.choosenModeFilter==t),o.Bb(1),o.kc("tooltip-hint",i.L("meta.ui.lobby.options.mode."+t)),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L("meta.ui.lobby.create.gm")),o.Bb(1),o.Nc(" ",i.L("meta.ui.lobby.options.mode."+t)," ")}}function qx(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",28),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(13);return o.bc().choosenMapFilter=i,n.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Fb("active",i.choosenMapFilter==t),o.Bb(1),o.kc("tooltip-hint",i.L("meta.mission."+t+".name")),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L("meta.ui.lobby.create.gm")),o.Bb(1),o.Nc(" ",i.L("all"==t?"meta.mission.random.name":"meta.mission."+t+".name")," ")}}function Vx(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",28),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(18);return o.bc().choosenOpenFilters=i,n.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Fb("active",i.choosenOpenFilters==t),o.Bb(1),o.kc("tooltip-hint",i.L("meta.ui.lobby.slot_state_"+t)),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L("meta.ui.lobby.create.gm")),o.Bb(1),o.Nc(" ",i.L("meta.ui.lobby.slot_state_"+t)," ")}}function $x(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",11),o.Rb(1,"div",12),o.Rb(2,"div",13),o.Lc(3),o.Qb(),o.Rb(4,"input",14,15),o.Yb("ngModelChange",function(e){return o.zc(t),o.bc().filterRequest=e})("keyup",function(){return o.zc(t),o.bc().onFilterKeydown()}),o.Qb(),o.Qb(),o.Rb(6,"div",16),o.Rb(7,"dropdown",17,18),o.Rb(9,"ul",19),o.Jc(10,Jx,3,6,"li",20),o.Qb(),o.Qb(),o.Qb(),o.Rb(11,"div",16),o.Rb(12,"dropdown",17,21),o.Rb(14,"ul",19),o.Jc(15,qx,3,6,"li",20),o.Qb(),o.Qb(),o.Qb(),o.Rb(16,"div",16),o.Rb(17,"dropdown",17,22),o.Rb(19,"ul",19),o.Jc(20,Vx,3,6,"li",20),o.Qb(),o.Qb(),o.Qb(),o.Rb(21,"div",16),o.Rb(22,"button",23,24),o.Yb("click",function(){return o.zc(t),o.bc().refreshLobbyList()}),o.Ob(24,"img",25),o.Qb(),o.Qb(),o.Rb(25,"div",26),o.Rb(26,"button",27),o.Yb("click",function(){return o.zc(t),o.bc().createLobbyModal.open()}),o.Lc(27),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(1),o.Fb("disabled",!t.lobbies||!t.lobbies.length),o.Bb(2),o.Mc(t.L("meta.ui.lobby.custom.name")),o.Bb(1),o.Fb("filled",t.filterRequest),o.kc("placeholder",t.L("meta.ui.lobby.type_input")),o.jc("ngModel",t.filterRequest),o.Bb(3),o.Fb("disabled",!t.lobbies||!t.lobbies.length),o.jc("text",t.L("meta.ui.lobby.options.mode."+t.choosenModeFilter))("origin","bottom")("label",t.L("meta.ui.lobby.custom.game_mode")),o.Bb(3),o.jc("ngForOf",t.modeFilters),o.Bb(2),o.Fb("disabled",!t.lobbies||!t.lobbies.length),o.jc("text",t.L("all"==t.choosenMapFilter?"meta.mission.random.name":"meta.mission."+t.choosenMapFilter+".name"))("origin","bottom")("label",t.L("meta.ui.lobby.options.map.label")),o.Bb(3),o.jc("ngForOf",t.mapFilters),o.Bb(2),o.Fb("disabled",!t.lobbies||!t.lobbies.length),o.jc("text",t.L("meta.ui.lobby.slot_state_"+t.choosenOpenFilters))("origin","bottom")("label",t.L("meta.ui.lobby.slot_state_open")),o.Bb(3),o.jc("ngForOf",t.openFilters),o.Bb(2),o.kc("tooltip-hint",t.L("meta.hint.lobby.custom.refresh")),o.jc("alertSound","ui_click_default"),o.Bb(4),o.Fb("disabled",t.buttonsLocked),o.kc("tooltip-hint",t.L("meta.ui.lobby.create.custom")),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.lobby.create.custom")),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.create.custom")," ")}}function Gx(t,e){if(1&t&&(o.Rb(0,"span",58),o.Lc(1),o.Qb()),2&t){const t=o.bc(4);o.Bb(1),o.Nc("",t.L("meta.ui.play.gm.title"),": ")}}function Hx(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(3);o.Bb(1),o.Mc(e.L("meta.mission."+t.map+".name"))}}function Yx(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc(4);o.Bb(1),o.Mc(t.L("meta.mission.random.name"))}}function Wx(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc().$implicit;o.Fb("color-simple",t.ping<50)("color-secondary",t.ping>=50&&t.ping<100)("color-gold",t.ping>=100&&t.ping<200)("color-error",t.ping>=200),o.Bb(1),o.Mc(t.ping)}}function Kx(t,e){if(1&t){const t=o.Sb();o.Rb(0,"tr",48),o.Yb("dblclick",function(){o.zc(t);const i=e.$implicit;return o.bc(3).tryToJoinLobby(i)}),o.Rb(1,"td",49),o.Rb(2,"div",50),o.Jc(3,Gx,2,1,"span",51),o.Ob(4,"span",52),o.Qb(),o.Qb(),o.Rb(5,"td",53),o.Lc(6),o.Qb(),o.Rb(7,"td",53),o.Jc(8,Hx,2,1,"span",54),o.Jc(9,Yx,2,1,"span",54),o.Qb(),o.Rb(10,"td",53),o.Rb(11,"span",55),o.Lc(12),o.Qb(),o.Qb(),o.Rb(13,"td",53),o.Jc(14,Wx,2,9,"span",56),o.Qb(),o.Rb(15,"td",57),o.Lc(16),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(3);o.Fb("hidden",t.hidden)("disabled",i.buttonsLocked),o.kc("tooltip-hint",i.L("meta.hint."+t.type+".join_to_team")),o.Bb(1),o.Ic("width",i.cellWidth(0)),o.Bb(2),o.jc("ngIf",t.type&&"gm"==t.type),o.Bb(1),o.jc("innerHTML",i.filterRequest?t.name.replace(i.filterRequest.escapeSpecialChars(),"<mark>"+i.filterRequest.escapeSpecialChars()+"</mark>"):t.name.markdown(),o.Ac),o.Bb(1),o.Ic("width",i.cellWidth(1)),o.Bb(1),o.Nc(" ",i.L("meta.ui.lobby.options.mode."+t.mode)," "),o.Bb(1),o.Ic("width",i.cellWidth(2)),o.Bb(1),o.jc("ngIf",t.map),o.Bb(1),o.jc("ngIf",!t.map),o.Bb(1),o.Ic("width",i.cellWidth(3)),o.Bb(2),o.Oc("",t.connected," / ",t.capacity,""),o.Bb(1),o.Ic("width",i.cellWidth(4)),o.Bb(1),o.jc("ngIf",t.ping),o.Bb(1),o.Ic("width",i.cellWidth(5)),o.Bb(1),o.Nc(" ",i.L("gm"==t.type?"meta.ui.lobby.slot_state_closed":t.password?"meta.ui.lobby.password_label":"meta.ui.lobby.slot_state_open")," ")}}function Xx(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",39),o.Rb(1,"table",40),o.Rb(2,"thead"),o.Rb(3,"tr"),o.Rb(4,"th",41),o.Yb("click",function(){return o.zc(t),o.bc(2).sortBy("!name")}),o.Lc(5),o.Qb(),o.Rb(6,"th",42),o.Yb("click",function(){return o.zc(t),o.bc(2).sortBy("mode")}),o.Lc(7),o.Qb(),o.Rb(8,"th",42),o.Yb("click",function(){return o.zc(t),o.bc(2).sortBy("map")}),o.Lc(9),o.Qb(),o.Rb(10,"th",42),o.Yb("click",function(){return o.zc(t),o.bc(2).sortBy("connected")}),o.Lc(11),o.Qb(),o.Rb(12,"th",42),o.Yb("click",function(){return o.zc(t),o.bc(2).sortBy("ping")}),o.Lc(13),o.Qb(),o.Rb(14,"th",42),o.Yb("click",function(){return o.zc(t),o.bc(2).sortBy("type")}),o.Lc(15),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(16,"div",43),o.Rb(17,"scrollable",44,45),o.Rb(19,"table",46),o.Rb(20,"tbody"),o.Jc(21,Kx,17,26,"tr",47),o.cc(22,"filterList"),o.cc(23,"filterList"),o.cc(24,"filterList"),o.cc(25,"sortList"),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.Bb(4),o.Ic("width",t.cellWidth(0)),o.Fb("sorting-asc","!name"===t.sortingKey)("sorting-desc","name"===t.sortingKey),o.kc("tooltip-hint",t.L("meta.ui.lobby.custom.name")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.custom.name")," "),o.Bb(1),o.Ic("width",t.cellWidth(1)),o.Fb("sorting-asc","mode"===t.sortingKey)("sorting-desc","!mode"===t.sortingKey),o.kc("tooltip-hint",t.L("meta.ui.lobby.custom.game_mode")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.custom.game_mode")," "),o.Bb(1),o.Ic("width",t.cellWidth(2)),o.Fb("sorting-asc","map"===t.sortingKey)("sorting-desc","!map"===t.sortingKey),o.kc("tooltip-hint",t.L("meta.ui.lobby.options.map.label")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.options.map.label")," "),o.Bb(1),o.Ic("width",t.cellWidth(3)),o.Fb("sorting-asc","connected"===t.sortingKey)("sorting-desc","!connected"===t.sortingKey),o.kc("tooltip-hint",t.L("meta.ui.lobby.custom.place")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.custom.place")," "),o.Bb(1),o.Ic("width",t.cellWidth(4)),o.Fb("sorting-asc","ping"===t.sortingKey)("sorting-desc","!ping"===t.sortingKey),o.kc("tooltip-hint",t.L("meta.ui.lobby.custom.ping")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.custom.ping")," "),o.Bb(1),o.Ic("width",t.cellWidth(5)),o.Fb("sorting-asc","type"===t.sortingKey)("sorting-desc","!type"===t.sortingKey),o.kc("tooltip-hint",t.L("meta.ui.lobby.slot_state_open")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.slot_state_open")," "),o.Bb(2),o.jc("bbox",!0),o.Bb(4),o.jc("ngForOf",o.fc(22,56,o.fc(23,60,o.fc(24,64,o.ec(25,68,t.lobbies,t.sortingKey),"mode",t.choosenModeFilter),"map",t.choosenMapFilter),"open",t.choosenOpenFilters))}}const Zx=function(t){return{count:t}};function tB(t,e){if(1&t&&o.Ob(0,"empty",59),2&t){const t=o.bc(2);o.jc("subtitle",t.L("meta.ui.lobby.no_search_result",o.nc(2,Zx,t.lobbies.length)))("desc",t.L("meta.ui.lobby.no_search_suggestion"))}}function eB(t,e){if(1&t&&o.Ob(0,"empty",60),2&t){const t=o.bc(2);o.jc("icon","time-line")("subtitle",t.L("meta.ui.lobby.custom.no_lobbies_result"))("desc",t.L("meta.ui.lobby.custom.no_lobbies_suggestion"))}}function iB(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",61),o.Rb(1,"div",62),o.Rb(2,"article"),o.Ob(3,"p",52),o.Qb(),o.Rb(4,"div",63),o.Rb(5,"input-password",64,65),o.Yb("onInputKeydown",function(e){return o.zc(t),o.bc(2).submit(e)}),o.Qb(),o.Qb(),o.Qb(),o.Rb(7,"div",66),o.Rb(8,"button",67),o.Yb("click",function(){return o.zc(t),o.bc(2).closePasswordWindow()}),o.Lc(9),o.Qb(),o.Qb(),o.Rb(10,"div",68),o.Rb(11,"button",69),o.Yb("click",function(){o.zc(t);const e=o.bc(2);return e.joinToLobby(e._lobbyWithPasswordToJoin.id,e._lobbyWithPasswordToJoin.type,e.lobbyPasswordModel)}),o.Lc(12),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.Bb(3),o.jc("innerHTML",t.L("meta.ui.lobby.password.desc"),o.Ac),o.Bb(2),o.jc("password","")("placeholder",t.L("meta.ui.lobby.type_password")),o.Bb(3),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.password.decline")," "),o.Bb(2),o.Fb("disabled",!t.isPasswordValid()),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.password.submit")," ")}}function nB(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",74),o.Yb("click",function(){o.zc(t),o.bc();const e=o.wc(3),i=o.bc(2);return i.isPasswordActive=!1,i.setLobbyType("gm"),e.hide(),i.setLobbyOption("password","")}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(3);o.Fb("active","gm"==t.lobbySettings.type),o.Bb(1),o.kc("tooltip-hint",t.L("meta.hint.lobby.create_new_lobby")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Mc(t.L("meta.ui.lobby.create.gm"))}}function sB(t,e){1&t&&o.Ob(0,"img",84)}function aB(t,e){1&t&&o.Ob(0,"img",85)}function rB(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",61),o.Rb(1,"div",70),o.Rb(2,"dropdown",71,72),o.Rb(4,"ul",19),o.Jc(5,nB,3,5,"li",73),o.Rb(6,"li"),o.Rb(7,"button",74),o.Yb("click",function(){o.zc(t);const e=o.wc(3),i=o.bc(2);return i.isPasswordActive=!1,i.setLobbyType("custom"),i.setLobbyOption("hidden",!1),e.hide(),i.setLobbyOption("password","")}),o.Lc(8),o.Qb(),o.Qb(),o.Rb(9,"li"),o.Rb(10,"button",74),o.Yb("click",function(){o.zc(t);const e=o.wc(3),i=o.bc(2);return i.isPasswordActive=!0,e.hide(),i.setLobbyType("custom"),i.setLobbyOption("hidden",!1),i.setLobbyOption("password","")}),o.Lc(11),o.Qb(),o.Qb(),o.Rb(12,"li"),o.Rb(13,"button",74),o.Yb("click",function(){o.zc(t);const e=o.wc(3),i=o.bc(2);return i.isPasswordActive=!1,i.setLobbyType("custom"),i.setLobbyOption("hidden",!0),e.hide(),i.setLobbyOption("password","")}),o.Lc(14),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(15,"div",75),o.Rb(16,"input-password",76,77),o.Yb("onInputKeydown",function(e){return o.zc(t),o.bc(2).getLobbyPasswordData(e)}),o.Qb(),o.Qb(),o.Rb(18,"div",78),o.Rb(19,"button",79),o.Yb("click",function(){o.zc(t);const e=o.bc(2);return e.copyLobbyPassword(e.lobbySettings.options.password)}),o.Jc(20,sB,1,0,"img",80),o.Jc(21,aB,1,0,"img",81),o.Lc(22),o.Qb(),o.Qb(),o.Qb(),o.Rb(23,"div",82),o.Rb(24,"button",83),o.Yb("click",function(){return o.zc(t),o.bc(2).createLobby()}),o.Lc(25),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.Bb(2),o.kc("tooltip-hint",t.L(t.lobbySettings.options.password?"meta.ui.lobby.options.hidden_false_password":"meta.ui.lobby.options.hidden_"+t.lobbySettings.options.hidden)),o.jc("text",t.L("gm"==t.lobbySettings.type?"meta.ui.lobby.create.gm":t.isPasswordActive?"meta.ui.lobby.options.hidden_false_password":"meta.ui.lobby.options.hidden_"+t.lobbySettings.options.hidden))("label",t.L("meta.ui.lobby.options.privacy_title"))("origin","bottom"),o.Bb(3),o.jc("ngIf",t.hasFlag("create_lobby")),o.Bb(1),o.Fb("active",!t.isPasswordActive&&!t.lobbySettings.options.hidden),o.Bb(1),o.kc("tooltip-hint",t.L("meta.ui.lobby.options.hidden_false")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Mc(t.L("meta.ui.lobby.options.hidden_false")),o.Bb(1),o.Fb("active",t.isPasswordActive),o.Bb(1),o.kc("tooltip-hint",t.L("meta.ui.lobby.options.hidden_false_password")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Mc(t.L("meta.ui.lobby.options.hidden_false_password")),o.Bb(1),o.Fb("active",!t.isPasswordActive&&t.lobbySettings.options.hidden),o.Bb(1),o.kc("tooltip-hint",t.L("meta.ui.lobby.options.hidden_true")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Mc(t.L("meta.ui.lobby.options.hidden_true")),o.Bb(1),o.Fb("disabled",!t.isPasswordActive)("error",t.isPasswordActive&&!t.lobbySettings.options.password.length),o.Bb(1),o.jc("password",t.lobbySettings.options.password)("placeholder",t.L("meta.ui.lobby.type_password"))("label",t.L("meta.ui.lobby.password_label")),o.Bb(3),o.Fb("disabled",!t.isPasswordActive||!t.lobbySettings.options.password),o.kc("tooltip-hint",t.L("meta.ui.lobby.clipboard_copy")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.jc("ngIf",!t.copiedSucces),o.Bb(1),o.jc("ngIf",t.copiedSucces),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.clipboard_copy")," "),o.Bb(2),o.Fb("disabled",t.isPasswordActive&&!t.lobbySettings.options.password),o.kc("tooltip-hint",t.L("meta.ui.lobby.create.custom")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.lobby.create_button")," ")}}function oB(t,e){if(1&t&&(o.Rb(0,"div",29),o.Jc(1,Xx,26,71,"div",30),o.Rb(2,"div",31),o.Jc(3,tB,1,4,"empty",32),o.Jc(4,eB,1,3,"empty",33),o.Qb(),o.Rb(5,"modal",34,35),o.Jc(7,iB,13,9,"div",36),o.Qb(),o.Rb(8,"modal",37,38),o.Jc(10,rB,26,39,"div",36),o.Qb(),o.Qb()),2&t){const t=o.wc(6),e=o.wc(9),i=o.bc();o.Bb(1),o.jc("ngIf",i.lobbies&&i.lobbies.length&&!i.filterResultEmpty),o.Bb(2),o.jc("ngIf",i.isLoaded&&i.filterResultEmpty),o.Bb(1),o.jc("ngIf",!i.lobbies||!i.lobbies.length),o.Bb(1),o.jc("id","lobby_password_window")("header",i.L("meta.ui.lobby.password.title")),o.Bb(2),o.jc("ngIf",t.opened),o.Bb(1),o.jc("id","lobby_createLobby_window")("header",i.L("meta.ui.lobby.create.custom")),o.Bb(2),o.jc("ngIf",e.opened)}}const cB=function(){return["/multiplayer/main"]},lB=function(){return{hover:"ui_hover_side_panel",click:"ui_click_default"}},uB=function(){return["/multiplayer/lobby"]},dB=function(t){return[t]};let hB=(()=>{class t{constructor(t,e,i,n,s){this.cache=t,this.lobbyService=e,this.matchMaking=i,this.chatService=n,this.notificatorService=s,this.globalEvent=new uu,this.difficulty=0,this.difficulties=[4,3,2,1,0],this.difficultiesString=["novice","easy","normal","hard","nightmare"],this.difficultiesKeys={novice:0,easy:1,normal:2,hard:3,nightmare:4},this.modes=[Dl.PVP,Dl.PVE],this.commanderVisibility=[Ml.Team,Ml.TeamAndGM,Ml.All],this.lobbies=[],this.sortingKey="name",this.tableCell=["25%","12%","20%","11%","16%","16%"],this.filterResultEmpty=!1,this.filterRequest="",this.LobbyType=jl,this.isLoaded=!1,this.counters={},this._lobbyWithPasswordToJoin=null,this.lobbyPasswordModel="",this.modeFilters=["all"],this.choosenModeFilter="",this.mapFilters=["all"],this.choosenMapFilter="",this.openFilters=["all"],this.choosenOpenFilters="",this.buttonsLocked=!1,this.regionLatency=null,this.lobbySettings={type:"custom",options:{hidden:!1,password:""}},this.isPasswordActive=!1,this.copiedSucces=!1,this.userId="",this.sortBy=Nx.bind(this),(new al).data.subscribe(t=>this.L=t),this.matchMaking.insertGameSparks(nd.gameSparks)}ngOnInit(){if(this.isLoaded=!1,this.userId=this.cache.getUserId(),this.counters=this.cache.getCounters(),this.counterChangeSubscription=this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>this.counters[t.path]=t.value),this.lobbyService.hasLobby())return Object(Pc.a)("Custom Lobby List: already have lobby, redirecting to ..."+this.lobbyService.lobbyGetId()),this.cache.redirect(["multiplayer","lobby",this.lobbyService.lobbyGetId()]),void(this.isLoaded=!0);this.lobbyService.lobbyGetList().subscribe(t=>{t&&t.scriptData&&(this.lobbies=t.scriptData.lobby,this.regionLatency=t.scriptData.regionLatency,this.isLoaded=!0,this.cache.devMode&&console.log(t),setTimeout(()=>{this.setLobbiesFilters(),this.setLobbiesPing()},10))}),this.listChange=this.lobbyService.onLobbyListChange.pipe(We(t=>null!==t)).subscribe(t=>{if("change"===t.key)this.patchListItem(t.data.lobby,t.data.content);else if("delete"===t.key)this.deleteListItem(t.data.lobby);else if("batch"==t.key)for(let i in t.data.batch)t.data.batch[i]?this.patchListItem(i,t.data.batch[i]):this.deleteListItem(i);let e=this.lobbies.slice();this.lobbies=e,this.setLobbiesFilters(),this.removeOutdatedFilters(),this.onFilterKeydown(),this.setLobbiesPing()}),this.choosenModeFilter="all",this.choosenMapFilter="all",this.choosenOpenFilters="all"}ngOnDestroy(){this.listChange&&this.listChange.unsubscribe()}patchListItem(t,e){for(let i=0;i<this.lobbies.length;i++)if(this.lobbies[i].id===t)return void this.lobbies.splice(i,1,e);this.lobbies.push(e)}deleteListItem(t){for(let e=0;e<this.lobbies.length;e++)this.lobbies[e].id===t&&this.lobbies.splice(e,1)}isFeaturesAvailable(){return this.cache.hasFlag("features_in_progress")}allow(t){return this.cache.allow(t)}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}getUserCommander(t){return this.cache.getCommander(t).type}createLobby(){this.lobbySettings&&(this.buttonsLocked=!0,this.lobbyService.lobbyCreate(this.lobbySettings.type,this.lobbySettings.options).subscribe(t=>{console.log(this.lobbySettings.type+" lobby created",this.lobbySettings.options,t),this.refreshLobbyList(),this.buttonsLocked=!1},t=>{this.buttonsLocked=!1}))}setLobbyOption(t,e){this.lobbySettings.options[t]=e,console.log(this.lobbySettings)}setLobbyType(t){this.lobbySettings.type=t,console.log(this.lobbySettings)}getLobbyPasswordData(t){console.log(t),t&&t.password&&this.setLobbyOption("password",t.password)}isLobbyPasswordValid(){}deleteCustomLobby(){this.lobbyService.lobbyLeave(this.lobbyService.lobbyGetId())}unwrapUnit(t){t.unwraped=!t.unwraped}cellWidth(t){return""+this.tableCell[t]}joinToLobby(t,e,i){if(!t||"gm"==e)return;let n=i||"";this.lobbyService.hasLobby()?this.lobbyService.lobbyGetId()===t?(Object(Pc.a)("connect to existed lobby (same)",t),this.cache.redirect(["multiplayer","lobby",t])):Object(Pc.a)("connect to existed lobby (different)",`leave ${this.lobbyService.lobbyGetId()} and connect to ${t}`):this.lobbyService.lobbyJoin(t,"",n).subscribe(e=>{console.log("Lobby JOIN"),this.cache.redirect(["multiplayer","lobby",t])})}onFilterKeydown(){if(!this.lobbies.length)return;let t=this.filterRequest.trim(),e=new RegExp(t,"gim"),i=[];this.lobbies.filter((n,s)=>{t.length>0?n.name.trim().match(e)?(n.hidden=!1,i.splice(s,0,n)):(n.hidden=!0,i.splice(s,1)):(n.hidden=!1,i=this.lobbies)}),this.filterResultEmpty=!(i.length>0)}goToLobby(t){this.cache.redirect(["multiplayer","lobby",t])}hasFlag(t){return this.cache.hasFlag(t)}refreshLobbyList(){this.refreshButton.nativeElement.classList.add("animated"),this.lobbyService.lobbyGetList().subscribe(t=>{t&&t.scriptData&&(this.lobbies=t.scriptData.lobby,this.regionLatency=t.scriptData.regionLatency,this.refreshButton.nativeElement.classList.remove("animated"),setTimeout(()=>{this.setLobbiesFilters(),this.setLobbiesPing()}))})}tryToJoinLobby(t){this.buttonsLocked=!0,t&&t.password?(this._lobbyWithPasswordToJoin=t,this.passwordModal&&(this.passwordModal.open(),setTimeout(()=>{this.buttonsLocked=!1,this.passwordInput&&this.passwordInput.nativeElement.focus()},500))):(this.joinToLobby(t.id,t.type),this.buttonsLocked=!1)}isPasswordValid(){return!0}submit(t){this.lobbyPasswordModel=t.password,13===t.event.keyCode&&this.isPasswordValid()&&this.joinToLobby(this._lobbyWithPasswordToJoin.id,this._lobbyWithPasswordToJoin.type,this.lobbyPasswordModel)}closePasswordWindow(){this.passwordModal.close(),this.lobbyPasswordModel=""}setLobbiesFilters(){if(this.lobbies&&this.lobbies.length){for(let t of this.lobbies)t.map&&t.map.length&&this.mapFilters.push(t.map),t.mode&&t.mode.length&&this.modeFilters.push(t.mode),!t.type||!t.type.length||t.password&&t.password.length||(t.open=t.type==jl.GM?"closed":"open",this.openFilters.push(t.open)),t.password&&(t.password.length||1==t.password)&&(t.open="password",this.openFilters.push(t.open));this.mapFilters=[...new Set(this.mapFilters)],this.modeFilters=[...new Set(this.modeFilters)],this.openFilters=[...new Set(this.openFilters)]}}setLobbiesPing(){this.lobbies&&this.lobbies.length&&this.regionLatency&&this.lobbies.map(t=>{t.ping=this.regionLatency[t.region]})}removeOutdatedFilters(){if(this.lobbies&&this.lobbies.length){for(let t of this.mapFilters)if("all"!==t&&!this.lobbies.find(e=>e.map&&t==e.map)){let e=this.mapFilters.indexOf(t);e>=0&&this.mapFilters.splice(e,1)}for(let t of this.modeFilters)if("all"!==t&&!this.lobbies.find(e=>e.mode&&t==e.mode)){let e=this.modeFilters.indexOf(t);e>=0&&this.modeFilters.splice(e,1)}for(let t of this.openFilters)if("all"!==t&&!this.lobbies.find(e=>e.open&&t==e.open)){let e=this.openFilters.indexOf(t);e>=0&&this.openFilters.splice(e,1)}}}copyLobbyPassword(t){if(!t)return;const e=document.createElement("textarea");e.style.position="fixed",e.style.left="0",e.style.top="0",e.style.opacity="0",e.value=t,document.body.appendChild(e),e.focus(),e.select(),document.execCommand("copy"),document.body.removeChild(e),this.copiedSucces=!0,setTimeout(()=>{this.copiedSucces=!1},350)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Bl),o.Nb(Yd),o.Nb(Pd),o.Nb(Uc))},t.\u0275cmp=o.Hb({type:t,selectors:[["lobby_list"]],viewQuery:function(t,e){if(1&t&&(o.Qc(Fx,!0),o.Qc(Px,!0),o.Qc(Ux,!0),o.Qc(zx,!0)),2&t){let t;o.vc(t=o.Zb())&&(e.refreshButton=t.first),o.vc(t=o.Zb())&&(e.passwordModal=t.first),o.vc(t=o.Zb())&&(e.passwordInput=t.first),o.vc(t=o.Zb())&&(e.createLobbyModal=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("grid-default",!0)},features:[o.Ab([nd,Bl,Yd,Pd,Uc])],decls:29,vars:27,consts:[["modes",""],[1,"large-tabs-list","clear"],["fade-in","down",1,"list-item"],["routerLinkActive","active","queryParamsHandling","merge",1,"large-tab-button","texture-border",3,"routerLink","alertSound"],[1,"tab-shadow"],[1,"tab-title","text-overflow"],[1,"tab-description","text-overflow"],["draggable","false",1,"tab-icon","default",3,"src"],["draggable","false",1,"tab-icon","hover",3,"src"],["class","filter-cover","g-lobby-filter","",4,"ngIf"],["g-lobby-list","",4,"ngIf"],["g-lobby-filter","",1,"filter-cover"],[1,"filter-cell","labeled-group"],[1,"input-label"],["type","text","maxlength","250","id","filterInput",1,"input","small-height",3,"ngModel","placeholder","ngModelChange","keyup"],["input",""],[1,"filter-cell"],[3,"text","origin","label"],["modeFilterDropdown",""],[1,"clear"],[3,"active",4,"ngFor","ngForOf"],["mapFilterDropdown",""],["openFilterDropdown",""],["type","button",1,"icon-group","larger","button-inline","refresh-button",3,"alertSound","tooltip-hint","click"],["refreshButton",""],["src","assets/img/icons/svg/lobby-update.svg","alt","update",1,"icon"],[1,"buttons-create"],["type","button",1,"button","red",3,"alertSound","tooltip-hint","click"],["type","button",1,"button","transparent","block",3,"tooltip-hint","alertSound","click"],["g-lobby-list",""],["class","table-cover",4,"ngIf"],["fade-in","down",1,"empty-lobbies"],[3,"subtitle","desc",4,"ngIf"],[3,"icon","subtitle","desc",4,"ngIf"],["id","passwordModal",3,"id","header"],["passwordModal",""],["class","body",4,"ngIf"],["id","createLobbyModal",3,"id","header"],["createLobbyModal",""],[1,"table-cover"],[1,"table","simple-table","fixed-table","table-head"],[1,"align-left",2,"width","calc(var(--unit-width) + var(--table-padding) * 2)",3,"tooltip-hint","alertSound","click"],[1,"align-left",3,"tooltip-hint","alertSound","click"],[1,"table-main"],[3,"bbox"],["battlesScrollable",""],[1,"table","simple-table"],["fade-in","down",3,"hidden","disabled","tooltip-hint","dblclick",4,"ngFor","ngForOf"],["fade-in","down",3,"tooltip-hint","dblclick"],[1,"align-left",2,"width","calc(var(--unit-width) + var(--table-padding) * 2)"],[1,"lobby-name","line"],["class","lobby-type",4,"ngIf"],[3,"innerHTML"],[1,"align-left"],[4,"ngIf"],[1,"line"],[3,"color-simple","color-secondary","color-gold","color-error",4,"ngIf"],[1,"align-left","capitalize"],[1,"lobby-type"],[3,"subtitle","desc"],[3,"icon","subtitle","desc"],[1,"body"],[1,"body","collapsed-top"],[1,"form-group"],[3,"password","placeholder","onInputKeydown"],["lobbyOpenPassword",""],[1,"body","collapsed-top","collapsed-bottom","align-center"],["type","button",1,"button",3,"alertSound","click"],[1,"body","align-center"],["type","button",1,"button","large",3,"alertSound","click"],[1,"body","collapsed-top","lobby-options"],[3,"text","label","origin","tooltip-hint"],["lobbySettinsDropdown",""],[3,"active",4,"ngIf"],[1,"button","transparent","block",3,"alertSound","tooltip-hint","click"],[1,"form-group","labeled-group","collapsed-bottom"],[3,"password","placeholder","label","onInputKeydown"],["lobbySettinsPassword",""],[1,"spaced-top"],[1,"button","transparent","small",3,"tooltip-hint","alertSound","click"],["src","assets/img/icons/svg/copy.svg","draggable","false","class","icon",4,"ngIf"],["src","assets/img/icons/svg/check_active.svg","draggable","false","class","icon",4,"ngIf"],[1,"body","align-center","collapsed-top"],["type","button",1,"button","large",3,"alertSound","tooltip-hint","click"],["src","assets/img/icons/svg/copy.svg","draggable","false",1,"icon"],["src","assets/img/icons/svg/check_active.svg","draggable","false",1,"icon"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Rb(1,"ul",1),o.Rb(2,"li",2),o.Rb(3,"a",3),o.Ob(4,"span",4),o.Rb(5,"span",5),o.Lc(6),o.Qb(),o.Ob(7,"span",6),o.Ob(8,"img",7),o.Ob(9,"img",8),o.Qb(),o.Qb(),o.Rb(10,"li",2),o.Rb(11,"a",3),o.Ob(12,"span",4),o.Rb(13,"span",5),o.Lc(14),o.Qb(),o.Ob(15,"span",6),o.Ob(16,"img",7),o.Ob(17,"img",8),o.Qb(),o.Qb(),o.Rb(18,"li",2),o.Rb(19,"a",3),o.Ob(20,"span",4),o.Rb(21,"span",5),o.Lc(22),o.Qb(),o.Rb(23,"span",6),o.Lc(24),o.Qb(),o.Ob(25,"img",7),o.Ob(26,"img",8),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Jc(27,$x,28,33,"div",9),o.Jc(28,oB,11,9,"div",10)),2&t&&(o.Bb(3),o.jc("routerLink",o.mc(20,cB))("alertSound",o.mc(21,lB)),o.Bb(3),o.Mc(e.L("meta.ui.menu.multiplayer.matchmaking")),o.Bb(2),o.jc("src","assets/img/icons/buttons/matchmaking.svg",o.Cc),o.Bb(1),o.jc("src","assets/img/icons/buttons/matchmaking_hover.svg",o.Cc),o.Bb(2),o.jc("routerLink",o.mc(22,uB))("alertSound",o.mc(23,lB)),o.Bb(3),o.Mc(e.L("meta.ui.menu.multiplayer.lobby")),o.Bb(2),o.jc("src","assets/img/icons/buttons/lobby.svg",o.Cc),o.Bb(1),o.jc("src","assets/img/icons/buttons/lobby_hover.svg",o.Cc),o.Bb(2),o.Fb("disabled",!e.allow("profile.menu")),o.jc("routerLink",o.nc(24,dB,"/profile/"+e.userId))("alertSound",o.mc(26,lB)),o.Bb(3),o.Mc(e.L("meta.ui.menu.multiplayer.statistic")),o.Bb(2),o.Mc(e.L("meta.ui.menu.multiplayer.statistic_helper")),o.Bb(1),o.jc("src","assets/img/icons/buttons/statistic.svg",o.Cc),o.Bb(1),o.jc("src","assets/img/icons/buttons/statistic_hover.svg",o.Cc),o.Bb(1),o.jc("ngIf",e.isLoaded),o.Bb(1),o.jc("ngIf",e.isLoaded))},encapsulation:2}),t})();const bB=["scrollable"],mB=["loadingModal"];function pB(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",13),o.Rb(1,"div",14),o.Rb(2,"button",15),o.Yb("click",function(){o.zc(t);const e=o.bc();return e.triggerGlobalEvent("button.stats.personal"),e.goToPersonal()}),o.Lc(3),o.Qb(),o.Rb(4,"button",16),o.Yb("click",function(){o.zc(t);const e=o.bc();return e.triggerGlobalEvent("button.stats.public"),e.goToPublic()}),o.Lc(5),o.Qb(),o.Rb(6,"button",15),o.Yb("click",function(){o.zc(t);const e=o.bc();return e.triggerGlobalEvent("button.stats.downloaded"),e.goToDownloaded()}),o.Lc(7),o.Qb(),o.Rb(8,"button",15),o.Yb("click",function(){o.zc(t);const e=o.bc();return e.triggerGlobalEvent("button.stats.tournament"),e.goToTournament()}),o.Lc(9),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(2),o.Fb("red","personal"===t.tab),o.kc("tooltip-hint",t.L("meta.hint.profile.stats.result.personal")),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.profile.stats.result.personal")),o.Bb(1),o.Nc(" ",t.L("meta.ui.profile.stats.result.personal")," "),o.Bb(1),o.Fb("red","public"===t.tab),o.kc("tooltip-hint",t.L("meta.hint.profile.stats.result.public")),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.profile.stats.result.public")),o.Bb(1),o.Nc(" ",t.L("meta.ui.profile.stats.result.public")," "),o.Bb(1),o.Fb("red","downloaded"===t.tab),o.kc("tooltip-hint",t.L("meta.hint.profile.stats.result.downloaded")),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.profile.stats.result.downloaded")),o.Bb(1),o.Nc(" ",t.L("meta.ui.profile.stats.result.downloaded")," "),o.Bb(1),o.Fb("red","tournament"===t.tab)("disabled",t.campaignId),o.kc("tooltip-hint",t.L("meta.hint.profile.stats.result.tournament")),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.profile.stats.result.tournament")),o.Bb(1),o.Nc(" ",t.L("meta.ui.profile.stats.result.tournament")," ")}}function gB(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",17),o.Rb(1,"div",18),o.Rb(2,"input",19,20),o.Yb("ngModelChange",function(e){return o.zc(t),o.bc().inputSessionId=e})("keydown",function(e){o.zc(t);const i=o.bc();return i.searchSession(e,{id:i.inputSessionId})}),o.Qb(),o.Rb(4,"button",21),o.Yb("click",function(){o.zc(t);const e=o.bc();return e.sendSearchRequest(e.inputSessionId),e.checkIfNotEmpty(e.inputSessionId)}),o.Ob(5,"img",22),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Fb("error",t.searchError),o.Bb(2),o.kc("placeholder",t.L("meta.ui.stats.table.filter_placeholder")),o.jc("ngModel",t.inputSessionId),o.Bb(2),o.kc("tooltip-hint",t.L("meta.ui.chat.start_search_title")),o.jc("alertSound","ui_click_default")}}function fB(t,e){if(1&t){const t=o.Sb();o.Rb(0,"table",23),o.Rb(1,"thead"),o.Rb(2,"tr"),o.Rb(3,"th",24),o.Yb("click",function(){return o.zc(t),o.bc().sortBy("closeTime")}),o.Lc(4),o.Qb(),o.Rb(5,"th",24),o.Yb("click",function(){return o.zc(t),o.bc().sortBy("!game.type")}),o.Lc(6),o.Qb(),o.Rb(7,"th",24),o.Yb("click",function(){return o.zc(t),o.bc().sortBy("game.players")}),o.Lc(8),o.Qb(),o.Rb(9,"th",24),o.Yb("click",function(){return o.zc(t),o.bc().sortBy("game.name")}),o.Lc(10),o.Qb(),o.Rb(11,"th",24),o.Yb("click",function(){return o.zc(t),o.bc().sortBy("!game.mode")}),o.Lc(12),o.Qb(),o.Rb(13,"th",24),o.Yb("click",function(){return o.zc(t),o.bc().sortBy("!game.mapName")}),o.Lc(14),o.Qb(),o.Rb(15,"th",24),o.Yb("click",function(){return o.zc(t),o.bc().sortBy("!commanderTemplate")}),o.Lc(16),o.Qb(),o.Rb(17,"th",24),o.Yb("click",function(){return o.zc(t),o.bc().sortBy("!game.result")}),o.Lc(18),o.Qb(),o.Ob(19,"th"),o.Rb(20,"th",25),o.Lc(21),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(3),o.Fb("sorting-asc","closeTime"===t.sortingKey)("sorting-desc","!closeTime"===t.sortingKey),o.jc("alertSound","ui_click_default"),o.Cb("style",t.getColumnWidth(0),o.Bc),o.Bb(1),o.Mc(t.L("meta.ui.stats.table.date_time")),o.Bb(1),o.Fb("sorting-asc","!game.type"===t.sortingKey)("sorting-desc","game.type"===t.sortingKey),o.jc("alertSound","ui_click_default"),o.Cb("style",t.getColumnWidth(1),o.Bc),o.Bb(1),o.Mc(t.L("meta.ui.stats.table.type")),o.Bb(1),o.Fb("sorting-asc","game.players"===t.sortingKey)("sorting-desc","!game.players"===t.sortingKey),o.jc("alertSound","ui_click_default"),o.Cb("style",t.getColumnWidth(2),o.Bc),o.Bb(1),o.Mc(t.L("meta.ui.stats.table.players")),o.Bb(1),o.Fb("sorting-asc","game.name"===t.sortingKey)("sorting-desc","!game.name"===t.sortingKey),o.jc("alertSound","ui_click_default"),o.Cb("style",t.getColumnWidth(3),o.Bc),o.Bb(1),o.Mc(t.L("meta.ui.stats.table.game_name")),o.Bb(1),o.Fb("sorting-asc","!game.mode"===t.sortingKey)("sorting-desc","game.mode"===t.sortingKey),o.jc("alertSound","ui_click_default"),o.Cb("style",t.getColumnWidth(4),o.Bc),o.Bb(1),o.Mc(t.L("meta.ui.stats.table.mode")),o.Bb(1),o.Fb("sorting-asc","!game.mapName"===t.sortingKey)("sorting-desc","game.mapName"===t.sortingKey),o.jc("alertSound","ui_click_default"),o.Cb("style",t.getColumnWidth(5),o.Bc),o.Bb(1),o.Mc(t.L("meta.ui.stats.table.map_name")),o.Bb(1),o.Fb("sorting-asc","!commanderTemplate"===t.sortingKey)("sorting-desc","commanderTemplate"===t.sortingKey),o.jc("alertSound","ui_click_default"),o.Cb("style",t.getColumnWidth(6),o.Bc),o.Bb(1),o.Mc(t.L("meta.ui.stats.table.commander_name")),o.Bb(1),o.Fb("sorting-asc","!game.result"===t.sortingKey)("sorting-desc","game.result"===t.sortingKey),o.jc("alertSound","ui_click_default"),o.Cb("style",t.getColumnWidth(7),o.Bc),o.Bb(1),o.Mc(t.L("meta.ui.stats.table.result")),o.Bb(1),o.Cb("style",t.getColumnWidth(8),o.Bc),o.Bb(1),o.Cb("style",t.getColumnWidth(9),o.Bc),o.Bb(1),o.Nc(" ",t.L("meta.ui.profile.menu.replay")," ")}}function vB(t,e){if(1&t&&o.Ob(0,"img",51),2&t){const t=o.bc().$implicit;o.jc("src","assets/img/flags/campaign_"+t.army+".png",o.Cc)}}function yB(t,e){if(1&t&&(o.Rb(0,"span"),o.Rb(1,"span",52),o.Lc(2),o.Qb(),o.Lc(3,"x"),o.Rb(4,"span",52),o.Lc(5),o.Qb(),o.Qb()),2&t){const t=o.bc(2).$implicit,e=o.bc(2);o.Bb(1),o.kc("tooltip-hint",e.L("meta.ui.stats.team_a")),o.Bb(1),o.Mc(t.playerTeam.playerCount),o.Bb(2),o.kc("tooltip-hint",e.L("meta.ui.stats.team_b")),o.Bb(1),o.Mc(t.opponentTeam.playerCount)}}function _B(t,e){if(1&t&&(o.Rb(0,"span",52),o.Lc(1),o.Qb()),2&t){const t=o.bc(3).$implicit,e=o.bc(2);o.kc("tooltip-hint",e.L("meta.ui.stats.team_b")),o.Bb(1),o.Mc(t.opponentTeam.playerCount)}}function kB(t,e){if(1&t&&(o.Rb(0,"span",52),o.Lc(1),o.Qb()),2&t){const t=o.bc(3).$implicit,e=o.bc(2);o.kc("tooltip-hint",e.L("meta.ui.stats.team_a")),o.Bb(1),o.Mc(t.playerTeam.playerCount)}}function wB(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1," x"),o.Jc(2,_B,2,2,"span",53),o.Jc(3,kB,2,2,"span",53),o.Qb()),2&t){const t=o.bc(2).$implicit;o.Bb(2),o.jc("ngIf",t.opponentTeam.playerCount),o.Bb(1),o.jc("ngIf",t.playerTeam.playerCount)}}function SB(t,e){if(1&t&&(o.Rb(0,"span"),o.Jc(1,yB,6,4,"span",34),o.Jc(2,wB,4,2,"span",34),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.jc("ngIf",t.playerTeam.playerCount&&t.opponentTeam.playerCount),o.Bb(1),o.jc("ngIf",!t.playerTeam.playerCount||!t.opponentTeam.playerCount)}}function IB(t,e){if(1&t&&(o.Rb(0,"span"),o.Rb(1,"span",52),o.Lc(2),o.Qb(),o.Lc(3,"x"),o.Rb(4,"span",52),o.Lc(5),o.Qb(),o.Qb()),2&t){const t=o.bc(2).$implicit,e=o.bc(2);o.Bb(1),o.kc("tooltip-hint",e.L("meta.ui.stats.team_a")),o.Bb(1),o.Mc(t.playerTeam.count),o.Bb(2),o.kc("tooltip-hint",e.L("meta.ui.stats.team_b")),o.Bb(1),o.Mc(t.opponentTeam.count)}}function CB(t,e){if(1&t&&(o.Rb(0,"span",52),o.Lc(1),o.Qb()),2&t){const t=o.bc(3).$implicit,e=o.bc(2);o.kc("tooltip-hint",e.L("meta.ui.stats.team_b")),o.Bb(1),o.Mc(t.opponentTeam.count)}}function LB(t,e){if(1&t&&(o.Rb(0,"span",52),o.Lc(1),o.Qb()),2&t){const t=o.bc(3).$implicit,e=o.bc(2);o.kc("tooltip-hint",e.L("meta.ui.stats.team_a")),o.Bb(1),o.Mc(t.playerTeam.playerCount)}}function RB(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1," x"),o.Jc(2,CB,2,2,"span",53),o.Jc(3,LB,2,2,"span",53),o.Qb()),2&t){const t=o.bc(2).$implicit;o.Bb(2),o.jc("ngIf",t.opponentTeam.count),o.Bb(1),o.jc("ngIf",t.playerTeam.playerCount)}}function OB(t,e){if(1&t&&(o.Rb(0,"span"),o.Jc(1,IB,6,4,"span",34),o.Jc(2,RB,4,2,"span",34),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.jc("ngIf",t.playerTeam.count&&t.opponentTeam.count),o.Bb(1),o.jc("ngIf",!t.playerTeam.count||!t.opponentTeam.count)}}function TB(t,e){if(1&t&&(o.Rb(0,"span",37),o.Lc(1),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.Nc(" ",t.game.name," ")}}function xB(t,e){if(1&t&&o.Ob(0,"div",54),2&t){const t=o.bc(3);o.kc("tooltip-hint",t.L("meta.ui.stats.victory"))}}function BB(t,e){if(1&t&&o.Ob(0,"div",55),2&t){const t=o.bc(3);o.kc("tooltip-hint",t.L("meta.ui.stats.draw"))}}function jB(t,e){if(1&t&&o.Ob(0,"div",56),2&t){const t=o.bc(3);o.kc("tooltip-hint",t.L("meta.ui.stats.defeat"))}}function MB(t,e){if(1&t&&o.Ob(0,"span",57),2&t){const t=o.bc(3);o.Cb("data-value",t.getCounterValue("ui.mark.stats.last_battle"))}}function QB(t,e){if(1&t&&(o.Rb(0,"span",58),o.Ob(1,"img",59),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(2);o.lc("tooltip-hint","",e.L("meta.ui.stats.battle_ignored_status"),"</br>",e.L("meta.ui.stats.battle_ignored_reason."+t.control.ignoreReason),"")}}function AB(t,e){if(1&t&&(o.Rb(0,"span",58),o.Ob(1,"img",60),o.Qb()),2&t){const t=o.bc(3);o.kc("tooltip-hint",t.L("meta.ui.stats.battle_not_ignored"))}}function DB(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",61),o.Yb("click",function(e){o.zc(t);const i=o.bc().$implicit,n=o.wc(35);return o.bc(2).setSessionVisibility(i._id,!i.public,e),n.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc().$implicit,e=o.bc(2);o.Bb(1),o.kc("tooltip-hint",e.L(t.public?"meta.hint.profile.stats.hide_battle":"meta.hint.profile.stats.show_battle")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L(t.public?"meta.ui.battle.replay_hide":"meta.ui.battle.replay_share")," ")}}function EB(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",61),o.Yb("click",function(e){o.zc(t);const i=o.bc().$implicit,n=o.wc(35);return o.bc(2).downloadSession(i._id,e),n.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(3);o.Bb(1),o.kc("tooltip-hint",t.L("meta.hint.profile.stats.download_battle")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.battle.replay_download")," ")}}function NB(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",61),o.Yb("click",function(e){o.zc(t);const i=o.bc().$implicit,n=o.wc(35);return o.bc(2).deleteSession(i._id,e),n.hide()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(3);o.Bb(1),o.kc("tooltip-hint",t.L("meta.hint.profile.stats.delete_battle")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.battle.replay_detele")," ")}}function FB(t,e){if(1&t){const t=o.Sb();o.Rb(0,"tr"),o.Rb(1,"td",24),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(2).goToSession(i._id)}),o.Jc(2,vB,1,1,"img",30),o.Rb(3,"span",31),o.Lc(4),o.Qb(),o.Qb(),o.Rb(5,"td",32),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(2).goToSession(i._id)}),o.Lc(6),o.Qb(),o.Rb(7,"td",33),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(2).goToSession(i._id)}),o.Jc(8,SB,3,2,"span",34),o.Jc(9,OB,3,2,"span",34),o.Qb(),o.Rb(10,"td",35),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(2).goToSession(i._id)}),o.Jc(11,TB,2,1,"span",36),o.Qb(),o.Rb(12,"td",35),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(2).goToSession(i._id)}),o.Rb(13,"div",37),o.Lc(14),o.Qb(),o.Qb(),o.Rb(15,"td",35),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(2).goToSession(i._id)}),o.Rb(16,"div",37),o.Lc(17),o.Qb(),o.Qb(),o.Rb(18,"td",35),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(2).goToSession(i._id)}),o.Rb(19,"div",37),o.Lc(20),o.Qb(),o.Qb(),o.Rb(21,"td",24),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(2).goToSession(i._id)}),o.Jc(22,xB,1,1,"div",38),o.Jc(23,BB,1,1,"div",39),o.Jc(24,jB,1,1,"div",40),o.Jc(25,MB,1,1,"span",41),o.Qb(),o.Rb(26,"td",42),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(2).goToSession(i._id)}),o.Jc(27,QB,2,2,"span",43),o.Jc(28,AB,2,1,"span",43),o.Qb(),o.Rb(29,"td",44),o.Rb(30,"button",45),o.Yb("click",function(i){o.zc(t);const n=e.$implicit;return o.bc(2).replaySession(n,i)}),o.Lc(31),o.Rb(32,"span",46),o.Ob(33,"img",47),o.Qb(),o.Qb(),o.Rb(34,"dropdown",48,49),o.Rb(36,"ul",50),o.Jc(37,DB,3,3,"li",34),o.Jc(38,EB,3,3,"li",34),o.Jc(39,NB,3,3,"li",34),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Bb(1),o.jc("alertSound","ui_click_default"),o.Cb("style",i.getColumnWidth(0),o.Bc),o.Bb(1),o.jc("ngIf",t.army),o.Bb(2),o.Mc(i.getTime(t.closeTime,"dd.mm.yyyy h:m")),o.Bb(1),o.kc("tooltip-hint",i.L("meta.ui.stats.type."+t.game.type)),o.jc("alertSound","ui_click_default"),o.Cb("style",i.getColumnWidth(1),o.Bc),o.Bb(1),o.Nc(" ",i.L("meta.ui.stats.type."+t.game.type)," "),o.Bb(1),o.jc("alertSound","ui_click_default"),o.Cb("style",i.getColumnWidth(2),o.Bc),o.Bb(1),o.jc("ngIf",t.commanderTemplate),o.Bb(1),o.jc("ngIf",!t.commanderTemplate),o.Bb(1),o.kc("tooltip-hint",t.game.name),o.jc("alertSound","ui_click_default"),o.Cb("style",i.getColumnWidth(3),o.Bc),o.Bb(1),o.jc("ngIf",t.game&&t.game.name),o.Bb(1),o.kc("tooltip-hint",t.game.mode?i.L("meta.ui.stats.mode."+t.game.mode):""),o.jc("alertSound","ui_click_default"),o.Cb("style",i.getColumnWidth(4),o.Bc),o.Bb(2),o.Mc(i.L("meta.ui.stats.mode."+t.game.mode)),o.Bb(1),o.kc("tooltip-hint",t.game.mapName),o.jc("alertSound","ui_click_default"),o.Cb("style",i.getColumnWidth(5),o.Bc),o.Bb(2),o.Mc(t.game.mapName),o.Bb(1),o.kc("tooltip-hint",t.commanderTemplate?i.L("commander."+t.commanderTemplate+".name"):""),o.jc("alertSound","ui_click_default"),o.Cb("style",i.getColumnWidth(6),o.Bc),o.Bb(2),o.Nc(" ",t.commanderTemplate?i.L("commander."+t.commanderTemplate+".name"):" "," "),o.Bb(1),o.jc("alertSound","ui_click_default"),o.Cb("style",i.getColumnWidth(7),o.Bc),o.Bb(1),o.jc("ngIf",t.winner),o.Bb(1),o.jc("ngIf",t.draw),o.Bb(1),o.jc("ngIf",!t.winner&&!t.draw&&!i.isSearchResult),o.Bb(1),o.jc("ngIf",i.getCounter("ui.mark.stats.last_battle")&&i.lastSession&&i.lastSession._id===t._id),o.Bb(1),o.jc("alertSound","ui_click_default"),o.Cb("style",i.getColumnWidth(8),o.Bc),o.Bb(1),o.jc("ngIf",t.control&&t.control.ignored&&1==t.control.ignored),o.Bb(1),o.jc("ngIf",!t.control||!t.control.ignored),o.Bb(1),o.Cb("style",i.getColumnWidth(9),o.Bc),o.Bb(1),o.kc("tooltip-hint",i.cache.getLoadingProgress("replaySession")>1?i.L("meta.hint.profile.stats.loading_battle"):i.L("meta.hint.profile.stats.replay_battle")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",i.L("meta.ui.battle.replay_start")," "),o.Bb(1),o.Fb("animated",i.cache.getLoadingProgress("replaySession")<100&&i.loadingBattle&&i.loadingBattle._id==t._id),o.Bb(1),o.jc("src",i.cache.getLoadingProgress("replaySession")>1&&i.loadingBattle&&i.loadingBattle._id==t._id?"assets/img/icons/svg/lobby-update.svg":"assets/img/icons/svg/replay.svg",o.Cc),o.Bb(1),o.kc("tooltip-hint",i.L("meta.ui.battle.replay_options")),o.jc("icon","tree-points")("btn","control-button"),o.Bb(3),o.jc("ngIf",i.playerIsUser&&t.belongsToPlayer),o.Bb(1),o.jc("ngIf",!t.local),o.Bb(1),o.jc("ngIf",t.local)}}function PB(t,e){if(1&t&&(o.Rb(0,"div",26),o.Rb(1,"scrollable",27,28),o.Rb(3,"table",23),o.Rb(4,"tbody"),o.Jc(5,FB,40,51,"tr",29),o.cc(6,"sortList"),o.Qb(),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("bbox",!0),o.Bb(4),o.jc("ngForOf",o.ec(6,2,t.sessions,t.sortingKey))}}function UB(t,e){if(1&t&&(o.Rb(0,"div"),o.Ob(1,"empty",63),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("subtitle",t.L("meta.ui.stats.table.no_sessions_result"))("desc",t.L("meta.ui.stats.table.no_sessions_suggestion"))}}function zB(t,e){if(1&t&&(o.Rb(0,"div"),o.Ob(1,"empty",63),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("subtitle",t.L("meta.ui.stats.table.no_"+t.tab+"_sessions"))("desc",t.L(t.playerIsUser?t.campaignId?"meta.ui.stats.table.no_campaign_sessions_message":"meta.ui.stats.table.no_"+t.tab+"_sessions_message":"meta.ui.stats.table.no_personal_message_for_other"))}}function JB(t,e){if(1&t&&(o.Rb(0,"div",62),o.Jc(1,UB,2,2,"div",34),o.Jc(2,zB,2,2,"div",34),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf",t.isSearchResult&&!t.foundedSessions.length),o.Bb(1),o.jc("ngIf",t.sessionsLoaded&&!t.sessions.length&&!t.isSearchResult)}}const qB=function(t){return{time:t}};function VB(t,e){if(1&t&&o.Ob(0,"empty",65),2&t){const t=o.bc(2);o.jc("desc",t.open.time?t.L("meta.ui.stats.closed_requestor_time",o.nc(1,qB,t.timeout)):t.L("meta.ui.stats.closed_requestor"))}}function $B(t,e){if(1&t&&o.Ob(0,"empty",65),2&t){const t=o.bc(2);o.jc("desc",t.L("meta.ui.stats.closed_player"))}}function GB(t,e){if(1&t&&(o.Rb(0,"div",62),o.Jc(1,VB,1,3,"empty",64),o.Jc(2,$B,1,1,"empty",64),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf",t.userId!=t.playerId&&t.open&&(!t.open.requestor||0==t.open.requestor)),o.Bb(1),o.jc("ngIf",t.userId!=t.playerId&&t.open&&(!t.open.player||0==t.open.player)&&t.open.requestor)}}function HB(t,e){if(1&t&&o.Ob(0,"div",54),2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("meta.ui.stats.victory"))}}function YB(t,e){if(1&t&&o.Ob(0,"div",55),2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("meta.ui.stats.draw"))}}function WB(t,e){if(1&t&&o.Ob(0,"div",56),2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("meta.ui.stats.defeat"))}}function KB(t,e){if(1&t&&(o.Rb(0,"div",66),o.Rb(1,"div",67),o.Jc(2,HB,1,1,"div",38),o.Jc(3,YB,1,1,"div",39),o.Jc(4,WB,1,1,"div",40),o.Qb(),o.Rb(5,"div",68),o.Rb(6,"figure",69),o.Ob(7,"img",70),o.Qb(),o.Rb(8,"div",71),o.Lc(9),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(2),o.jc("ngIf",t.loadingBattle.winner),o.Bb(1),o.jc("ngIf",t.loadingBattle.draw),o.Bb(1),o.jc("ngIf",!t.loadingBattle.winner&&!t.loadingBattle.draw),o.Bb(3),o.jc("src",t.loadingBattle.commanderObject.image?"assets/img/commanders/"+t.loadingBattle.commanderObject.image+".png":"assets/img/commanders/"+t.loadingBattle.commanderObject._id+".png",o.Cc),o.Bb(2),o.Nc(" ",t.loadingBattle.commanderTemplate?t.L("commander."+t.loadingBattle.commanderTemplate+".name"):" "," ")}}function XB(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Mc(t.L("meta.ui.menu.nation."+t.loadingBattle.army))}}function ZB(t,e){if(1&t&&(o.Rb(0,"span"),o.Rb(1,"span",52),o.Lc(2),o.Qb(),o.Lc(3," x"),o.Rb(4,"span",52),o.Lc(5),o.Qb(),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.kc("tooltip-hint",t.L("meta.ui.stats.team_a")),o.Bb(1),o.Mc(t.loadingBattle.playerTeam.playerCount),o.Bb(2),o.kc("tooltip-hint",t.L("meta.ui.stats.team_b")),o.Bb(1),o.Mc(t.loadingBattle.opponentTeam.playerCount)}}function tj(t,e){if(1&t&&(o.Rb(0,"span",52),o.Lc(1),o.Qb()),2&t){const t=o.bc(4);o.kc("tooltip-hint",t.L("meta.ui.stats.team_b")),o.Bb(1),o.Mc(t.loadingBattle.opponentTeam.playerCount)}}function ej(t,e){if(1&t&&(o.Rb(0,"span",52),o.Lc(1),o.Qb()),2&t){const t=o.bc(4);o.kc("tooltip-hint",t.L("meta.ui.stats.team_a")),o.Bb(1),o.Mc(t.loadingBattle.playerTeam.playerCount)}}function ij(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1," x"),o.Jc(2,tj,2,2,"span",53),o.Jc(3,ej,2,2,"span",53),o.Qb()),2&t){const t=o.bc(3);o.Bb(2),o.jc("ngIf",t.loadingBattle.opponentTeam.playerCount),o.Bb(1),o.jc("ngIf",t.loadingBattle.playerTeam.playerCount)}}function nj(t,e){if(1&t&&(o.Rb(0,"span"),o.Jc(1,ZB,6,4,"span",34),o.Jc(2,ij,4,2,"span",34),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("ngIf",t.loadingBattle.playerTeam.playerCount&&t.loadingBattle.opponentTeam.playerCount),o.Bb(1),o.jc("ngIf",!t.loadingBattle.playerTeam.playerCount||!t.loadingBattle.opponentTeam.playerCount)}}function sj(t,e){if(1&t&&(o.Rb(0,"span"),o.Rb(1,"span",52),o.Lc(2),o.Qb(),o.Lc(3,"x"),o.Rb(4,"span",52),o.Lc(5),o.Qb(),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.kc("tooltip-hint",t.L("meta.ui.stats.team_a")),o.Bb(1),o.Mc(t.loadingBattle.playerTeam.count),o.Bb(2),o.kc("tooltip-hint",t.L("meta.ui.stats.team_b")),o.Bb(1),o.Mc(t.loadingBattle.opponentTeam.count)}}function aj(t,e){if(1&t&&(o.Rb(0,"span",52),o.Lc(1),o.Qb()),2&t){const t=o.bc(4);o.kc("tooltip-hint",t.L("meta.ui.stats.team_b")),o.Bb(1),o.Mc(t.loadingBattle.opponentTeam.count)}}function rj(t,e){if(1&t&&(o.Rb(0,"span",52),o.Lc(1),o.Qb()),2&t){const t=o.bc(4);o.kc("tooltip-hint",t.L("meta.ui.stats.team_a")),o.Bb(1),o.Mc(t.loadingBattle.playerTeam.playerCount)}}function oj(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1," x"),o.Jc(2,aj,2,2,"span",53),o.Jc(3,rj,2,2,"span",53),o.Qb()),2&t){const t=o.bc(3);o.Bb(2),o.jc("ngIf",t.loadingBattle.opponentTeam.count),o.Bb(1),o.jc("ngIf",t.loadingBattle.playerTeam.playerCount)}}function cj(t,e){if(1&t&&(o.Rb(0,"span"),o.Jc(1,sj,6,4,"span",34),o.Jc(2,oj,4,2,"span",34),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("ngIf",t.loadingBattle.playerTeam.count&&t.loadingBattle.opponentTeam.count),o.Bb(1),o.jc("ngIf",!t.loadingBattle.playerTeam.count||!t.loadingBattle.opponentTeam.count)}}function lj(t,e){if(1&t&&(o.Rb(0,"span",37),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Nc(" ",t.loadingBattle.game.name," ")}}function uj(t,e){if(1&t&&(o.Rb(0,"div",66),o.Rb(1,"table",72),o.Rb(2,"thead"),o.Rb(3,"tr"),o.Rb(4,"th",73),o.Lc(5),o.Qb(),o.Rb(6,"th",73),o.Lc(7),o.Qb(),o.Rb(8,"th",73),o.Lc(9),o.Qb(),o.Rb(10,"th",73),o.Lc(11),o.Qb(),o.Rb(12,"th",73),o.Lc(13),o.Qb(),o.Rb(14,"th",73),o.Lc(15),o.Qb(),o.Rb(16,"th",73),o.Lc(17),o.Qb(),o.Qb(),o.Qb(),o.Rb(18,"tr"),o.Rb(19,"td",74),o.Jc(20,XB,2,1,"span",34),o.Qb(),o.Rb(21,"td",74),o.Lc(22),o.Qb(),o.Rb(23,"td",74),o.Lc(24),o.Qb(),o.Rb(25,"td",74),o.Jc(26,nj,3,2,"span",34),o.Jc(27,cj,3,2,"span",34),o.Qb(),o.Rb(28,"td",74),o.Jc(29,lj,2,1,"span",36),o.Qb(),o.Rb(30,"td",74),o.Rb(31,"div",37),o.Lc(32),o.Qb(),o.Qb(),o.Rb(33,"td",74),o.Rb(34,"div",37),o.Lc(35),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(36,"div",75),o.Rb(37,"div",76),o.Lc(38),o.Qb(),o.Rb(39,"div",77),o.Ob(40,"span"),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(5),o.Mc(t.L("meta.ui.profile.preferences.army")),o.Bb(2),o.Mc(t.L("meta.ui.stats.table.date_time")),o.Bb(2),o.Mc(t.L("meta.ui.stats.table.type")),o.Bb(2),o.Mc(t.L("meta.ui.stats.table.players")),o.Bb(2),o.Mc(t.L("meta.ui.stats.table.game_name")),o.Bb(2),o.Mc(t.L("meta.ui.stats.table.mode")),o.Bb(2),o.Mc(t.L("meta.ui.stats.table.map_name")),o.Bb(3),o.jc("ngIf",t.loadingBattle.army),o.Bb(2),o.Mc(t.getTime(t.loadingBattle.closeTime,"dd.mm.yyyy h:m")),o.Bb(2),o.Mc(t.L("meta.ui.stats.type."+t.loadingBattle.game.type)),o.Bb(2),o.jc("ngIf",t.loadingBattle.commanderTemplate),o.Bb(1),o.jc("ngIf",!t.loadingBattle.commanderTemplate),o.Bb(2),o.jc("ngIf",t.loadingBattle.game&&t.loadingBattle.game.name),o.Bb(3),o.Mc(t.L("meta.ui.stats.mode."+t.loadingBattle.game.mode)),o.Bb(3),o.Mc(t.loadingBattle.game.mapName),o.Bb(3),o.Mc(t.cache.getLoadingProgress("replaySession")+"%"),o.Bb(2),o.Ic("width",t.cache.getLoadingProgress("replaySession")+"%")}}JSON;const dj=9e3;let hj=(()=>{class t{constructor(t,e,i,n,s){this.cache=t,this.router=e,this.sanitizer=i,this.activatedRoute=n,this.notificatorService=s,this.campaignId="",this.allSessions=[],this.sessions=[],this.sessionsLocal=[],this.sessionsLoaded=!1,this.tableCell=["16%","6%","6%","11%","10%","11%","18%","7","4%","11%"],this.sortingKey="closeTime",this.counters={},this.globalEvent=new uu,this.playerId="",this.userId="",this.playerIsUser=!1,this.tab=bj.Personal,this.StatisticTab=bj,this.inputSessionId="",this.isSearchResult=!1,this.foundedSessionBelongsToPlayer=!1,this.playerSessions=[],this.publicSessions=[],this.downloadSessions=[],this.tournamentSessions=[],this.foundedSessions=[],this.loadingBattle=null,this.open=null,this.timeout="",this.searchError=!1,this.localizator=new al,this.localizator.data.subscribe(t=>this.L=t)}ngOnInit(){this.sessionsLoaded=!1,this.playerId=this.activatedRoute.params.value.id,this.userId=this.cache.getUserId(),this.playerIsUser=!this.playerId||this.playerId==this.userId,this.playerIsUser?this.cache.getSessions().subscribe(t=>{this.playerSessions=t,this.lastSession=this.cache.getLastSession(),this.checkIfSessionBelongsToPlayer(this.playerSessions),t=this.checkLocal(t),this.computeSessions(t)}):this.cache.searchPlayerSessionFromList(this.playerId).subscribe(t=>{t&&t.scriptData&&t.scriptData.session&&(this.playerSessions=t.scriptData.session,this.computeSessions(t.scriptData.session)),t&&t.scriptData&&t.scriptData.open&&(this.open=t.scriptData.open,t.scriptData.open.time&&this.timeoutTick(t.scriptData.open.time))}),this.counters=this.cache.getCounters(),this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>this.counters[t.path]=t.value),this.cache.setCounter("ui.mark.stats.menu",0),this.globalEvent.subscribe(t=>{t&&t&&"modal.close"==t.key&&t.data&&t.data.id&&"loading_modal"==t.data.id&&this.clearLoadingSession()})}checkLocal(t){let e=this.cache.getSessionsLocal(),i=[];for(let n of e){let e=t.find(t=>t._id===n._id);e?e.local=!0:i.push(n)}return this.removeDuplicateItems(t.concat(i))}removeDuplicateItems(t){for(var e=t.concat(),i=0;i<e.length;++i)for(var n=i+1;n<e.length;++n)e[i]===e[n]&&e.splice(n--,1);return e}getCounter(t){return this.cache.getCounter(t)}getCounterValue(t){let e=this.cache.getCounter(t);return e>1?e:""}computeSessions(t){for(let e=0;e<t.length;e++){let i=t[e];i.game.map.search(":"),i.game.map.slice(0,i.game.map.search(":")),i.game.mapName=i.game.mapId?this.L("meta.mission."+i.game.mapId+".name"):"",i.game.players=i.playerTeam.playerCount+i.opponentTeam.playerCount,i.game.name="lobby"==i.game.type&&i.game.request.lobby.name?i.game.request.lobby.name:"campaign"==i.game.type?this.L("meta.campaign."+i.game.request.campaign.template+".name"):"-",i.game.result=i.winner?"a":i.draw?"c":"b";let n=this.cache.getCommander(i.commanderTemplate);i.army=n?n.army:"",i.commanderObject=n}this.allSessions=t,this.cache.devMode&&console.log("allSessions: ",this.allSessions),this.setActiveSessionList(this.tab),setTimeout(()=>{this.sessionsLoaded=!0})}getBattleResultTitle(t){return t?this.L(t.winner?"meta.ui.stats.victory":t.draw?"meta.ui.stats.draw":"meta.ui.stats.defeat"):""}setImageFallback(t){t.image.split("/")}goToSession(t){this.triggerGlobalEvent("statistics_detail.open",{sessionId:t})}getColumnWidth(t){return this.sanitizer.bypassSecurityTrustStyle(`width: ${this.tableCell[t]};`)}sortBy(t){let e,i=t.replace(/\!/gim,"");i===this.sortingKey.replace(/\!/gim,"")?(e="!"===this.sortingKey[0],this.sortingKey=`${e?"":"!"}${i}`):this.sortingKey=t}void(){}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}goToPersonal(){this.tab=bj.Personal,this.setActiveSessionList(this.tab),this.checkIfSessionBelongsToPlayer(this.playerSessions)}goToPublic(){this.tab=bj.Public,this.setActiveSessionList(this.tab),this.checkIfSessionBelongsToPlayer(this.publicSessions)}goToDownloaded(){this.tab=bj.Downloaded,this.setActiveSessionList(this.tab),this.checkIfSessionBelongsToPlayer(this.downloadSessions)}goToTournament(){this.tab=bj.Tournament,this.setActiveSessionList(this.tab),this.checkIfSessionBelongsToPlayer(this.tournamentSessions)}getTime(t,e){return new Date(t).parseDate(e)}searchSession(t,e){e&&wu(()=>{e.id&&e.id.length?(this.searchError=!1,13===t.keyCode&&this.sendSearchRequest(e.id)):(this.isSearchResult=!1,this.foundedSessions=[],this.setActiveSessionList(this.tab))},200,"session_search_request")}checkIfNotEmpty(t){t&&t.length||(this.searchError=!0),setTimeout(()=>{this.searchError=!1},500)}sendSearchRequest(t){if(t&&t.length)return t.match(new RegExp(/^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$/,"gim"))?void this.cache.searchSessionFromList(t).subscribe(t=>{t&&t.scriptData&&(this.isSearchResult=!0,t.scriptData.session&&t.scriptData.session.length?(this.cache.devMode&&console.log("session_search_request",t.scriptData.session),this.foundedSessions=t.scriptData.session,this.checkIfSessionBelongsToPlayer(this.foundedSessions)):this.foundedSessions=[],this.sessions=this.foundedSessions)},t=>{console.log(t),this.notificatorService.push({response:t,parameters:""}),this.searchError=!0}):(this.searchError=!0,void console.warn("wrong sesion id"))}checkIfSessionBelongsToPlayer(t){for(let e of t){let t=this.playerSessions.find(t=>t._id==e._id);e.belongsToPlayer=!!t}}setSessionVisibility(t,e,i){i.stopImmediatePropagation(),t&&this.cache.setSessionVisibility(t,e).subscribe(i=>{this.changeSession(t,{public:e})})}replaySession(t,e){e.stopImmediatePropagation(),t&&(this.cache.alert("replay_play:"+t._id),this.loadingBattle=t,setTimeout(()=>{this.loadingModal.open()},250))}startLoadingProgress(){setTimeout(()=>{this.cache.startLoadingProgress("replaySession")},2e3)}clearLoadingSession(){this.loadingBattle=null,this.cache.stopLoadingProgress("replaySession")}deleteSession(t,e){console.log(t),e.stopImmediatePropagation(),t&&(console.log(e),this.cache.alert("replay_delete:"+t),this.changeSession(t,{local:!1}),this.cache.removeSessionLocal(t),this.removeSessionFromList(t))}downloadSession(t,e){e.stopImmediatePropagation(),t&&this.getSessionData(t)}getSessionData(t){let e=this.getCurrentSession(t),i={};this.cache.getSessionDetail(t).subscribe(n=>{i=n,t&&e&&i&&n&&(this.sendSessionDownloadAlert(t,e,i),this.changeSession(t,{local:!0}),this.cache.addSessionLocal(e))})}sendSessionDownloadAlert(t,e,i){if(!t||!e||!i)return;let n=JSON.stringify(e),s=JSON.stringify(i);this.cache.alert("replay_download:"+t+","+n),this.cache.alert("replay_data_start:"+t);let a=Math.ceil(s.length/dj);for(let r=0;r<a;r++)this.cache.alert("replay_data_part:"+t+","+s.slice(r*dj,(r+1)*dj),!1);this.cache.alert("replay_data_end:"+t)}getCurrentSession(t){return this.sessions.find(e=>e._id==t)}changeSession(t,e){let i=this.allSessions.find(e=>e._id==t);if(i&&e&&Object.assign(i,e),this.foundedSessions&&this.foundedSessions.length&&this.foundedSessionBelongsToPlayer){let i=this.foundedSessions.find(e=>e._id==t);i&&e&&Object.assign(i,e)}this.setActiveSessionList(this.tab)}filterplayerSessions(){this.sessions=this.filterCampaignSessions(this.playerSessions)}filterPublicSessions(){this.publicSessions=this.allSessions.filter(t=>1==t.public),this.sessions=this.filterCampaignSessions(this.publicSessions)}filterDownloadSessions(){this.downloadSessions=this.allSessions.filter(t=>1==t.local),this.sessions=this.filterCampaignSessions(this.downloadSessions)}filterTournamentSessions(){this.tournamentSessions=this.allSessions.filter(t=>1==t.tournament),this.sessions=this.filterCampaignSessions(this.tournamentSessions)}filterCampaignSessions(t){let e=[];return e=this.campaignId?t.filter(t=>t.game&&t.game.request&&t.game.request.campaign&&t.game.request.campaign.template&&t.game.request.campaign.template==this.campaignId):t,e}setActiveSessionList(t){switch(this.sessions=[],this.isSearchResult&&(this.isSearchResult=!1),t){case bj.Personal:this.filterplayerSessions();break;case bj.Public:this.filterPublicSessions();break;case bj.Downloaded:this.filterDownloadSessions();break;case bj.Tournament:this.filterTournamentSessions()}}timeoutTick(t){let e=new Date,i=new Date(t);if(e.isLess(i)){let n=e.diff(i);this.timeout=(new Date).getDifferenceString(n,"%d %h:%m:%s",!0,this.L,!0),setTimeout(()=>{this.timeoutTick(t)},1e3)}else this.timeout=""}removeSessionFromList(t){let e=this.sessions.find(e=>e._id===t),i=this.sessions.indexOf(e);i>=0&&this.sessions.splice(i,1)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Ys),o.Nb(Er),o.Nb(xn),o.Nb(Uc))},t.\u0275cmp=o.Hb({type:t,selectors:[["statistics"]],viewQuery:function(t,e){if(1&t&&(o.Qc(bB,!0),o.Qc(mB,!0)),2&t){let t;o.vc(t=o.Zb())&&(e.scrollable=t.first),o.vc(t=o.Zb())&&(e.loadingModal=t.first)}},inputs:{campaignId:"campaignId"},features:[o.Ab([Uc])],decls:18,vars:18,consts:[[1,"grid-default"],[1,"preloader","small","bold"],["g-header","",4,"ngIf"],["class","form-group with-icon","g-header-search","",3,"error",4,"ngIf"],["g-sessions",""],["class","table sessions-list",4,"ngIf"],["style","height: calc(100% - var(--margin))",4,"ngIf"],["class","spaced-top-larger limited-width",4,"ngIf"],[1,"medium",3,"id","header","onOpen","onCLose"],["loadingModal",""],["class","body collapsed-top",4,"ngIf"],[1,"body","align-center"],[1,"button","large",3,"alertSound","click"],["g-header",""],[1,"tabs-nav"],["fade-in","up",1,"button","small",3,"tooltip-hint","alertSound","click"],["type","button","fade-in","up",1,"button","small",3,"tooltip-hint","alertSound","click"],["g-header-search","",1,"form-group","with-icon"],[1,"relative"],["type","text","id","formInput","autocomplete","off",1,"input","small-height",3,"ngModel","placeholder","ngModelChange","keydown"],["input",""],["type","button",1,"form-icon","button","transparent","verticaly-middle",3,"alertSound","tooltip-hint","click"],["src","assets/img/icons/svg/search-icon.svg","draggable","false"],[1,"table","sessions-list"],[3,"alertSound","click"],[1,"paddless"],[2,"height","calc(100% - var(--margin))"],[2,"height","calc(100%)",3,"bbox"],["battlesScrollable",""],[4,"ngFor","ngForOf"],["class","army-flag",3,"src",4,"ngIf"],[1,"text"],[3,"tooltip-hint","alertSound","click"],[1,"faded",3,"alertSound","click"],[4,"ngIf"],[1,"faded",3,"tooltip-hint","alertSound","click"],["class","cropped-title",4,"ngIf"],[1,"cropped-title"],["class","battle-state win hovered",3,"tooltip-hint",4,"ngIf"],["class","battle-state draw hovered",3,"tooltip-hint",4,"ngIf"],["class","battle-state defeat hovered",3,"tooltip-hint",4,"ngIf"],["class","marker","origin","right",4,"ngIf"],[1,"visible",3,"alertSound","click"],["class","icon hovered",3,"tooltip-hint",4,"ngIf"],[1,"paddless","visible"],["type","button",1,"button","small","play-button",3,"tooltip-hint","alertSound","click"],[1,"button-image","refresh-button"],["draggable","false",1,"icon","action-image","to-light",3,"src"],[3,"icon","btn","tooltip-hint"],["replayOptions",""],[1,"clear"],[1,"army-flag",3,"src"],[3,"tooltip-hint"],[3,"tooltip-hint",4,"ngIf"],[1,"battle-state","win","hovered",3,"tooltip-hint"],[1,"battle-state","draw","hovered",3,"tooltip-hint"],[1,"battle-state","defeat","hovered",3,"tooltip-hint"],["origin","right",1,"marker"],[1,"icon","hovered",3,"tooltip-hint"],["src","assets/img/icons/svg/exclamation.svg","draggable","false",1,"icon"],["src","assets/img/icons/svg/check_circle_stroke.svg","draggable","false",1,"icon"],["type","button",1,"button","transparent","block","with-icon",3,"alertSound","tooltip-hint","click"],[1,"spaced-top-larger","limited-width"],[3,"subtitle","desc"],["class","spaced-top",3,"desc",4,"ngIf"],[1,"spaced-top",3,"desc"],[1,"body","collapsed-top"],[1,"battle-info","align-center","spaced-bottom"],[1,"commanders-line-info"],[1,"image-cover"],["image-load","","draggable","false",3,"src"],[1,"align-center","commander-title"],[1,"table"],[1,"paddless-all"],[1,"faded","paddless-all"],[1,"progress-cover","spaced-top"],[1,"align-center","subheader"],[1,"progress-bar"]],template:function(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",0),o.Rb(1,"div",1),o.Ob(2,"span"),o.Lc(3),o.Qb(),o.Jc(4,pB,10,26,"div",2),o.Jc(5,gB,6,6,"div",3),o.Rb(6,"div",4),o.Jc(7,fB,22,59,"table",5),o.Jc(8,PB,7,5,"div",6),o.Jc(9,JB,3,2,"div",7),o.Jc(10,GB,3,2,"div",7),o.Qb(),o.Qb(),o.Rb(11,"modal",8,9),o.Yb("onOpen",function(){return e.startLoadingProgress()})("onCLose",function(){return e.clearLoadingSession()}),o.Jc(13,KB,10,5,"div",10),o.Jc(14,uj,41,18,"div",10),o.Rb(15,"div",11),o.Rb(16,"button",12),o.Yb("click",function(){return o.zc(t),o.wc(12).close()}),o.Lc(17),o.Qb(),o.Qb(),o.Qb()}2&t&&(o.Bb(1),o.Fb("disabled",e.sessionsLoaded),o.Bb(2),o.Mc(e.L("meta.ui.stats.preloader")),o.Bb(1),o.jc("ngIf",e.playerIsUser),o.Bb(1),o.jc("ngIf",e.playerIsUser),o.Bb(2),o.jc("ngIf",e.sessions.length&&!e.open||e.open&&e.open.player&&e.open.requestor),o.Bb(1),o.jc("ngIf",e.sessions.length&&!e.open||e.open&&e.open.player&&e.open.requestor),o.Bb(1),o.jc("ngIf",!e.open||e.open&&e.open.player&&e.open.requestor),o.Bb(1),o.jc("ngIf",e.open&&(!e.open.player||!e.open.requestor)),o.Bb(1),o.jc("id","loading_modal")("header",e.L("meta.ui.chat.preloader_message")),o.Bb(2),o.jc("ngIf",e.loadingBattle),o.Bb(1),o.jc("ngIf",e.loadingBattle),o.Bb(2),o.Fb("disabled",e.cache.getLoadingProgress("replaySession")<100),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L("meta.ui.store.close")),o.Bb(1),o.Nc(" ",e.L("meta.ui.store.close")," "))},encapsulation:2}),t})();var bj=function(t){return t.Personal="personal",t.Public="public",t.Downloaded="downloaded",t.Tournament="tournament",t}({});const mj=["battleResultModal"],pj=["confirmation"];function gj(t,e){if(1&t&&(o.Rb(0,"dt",9),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("meta.hint.stats.info_game")),o.Bb(1),o.Mc(t.L("meta.ui.stats.info_game"))}}function fj(t,e){if(1&t&&(o.Rb(0,"dd"),o.Rb(1,"span"),o.Lc(2),o.Qb(),o.Qb()),2&t){const t=o.bc().data;o.Bb(2),o.Mc(t&&t.silverGame?t.silverGame.cat():"-")}}function vj(t,e){if(1&t&&(o.Rb(0,"dt",9),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("meta.hint.stats.info_action")),o.Bb(1),o.Mc(t.L("meta.ui.stats.info_action"))}}function yj(t,e){if(1&t&&(o.Rb(0,"dd"),o.Rb(1,"span"),o.Lc(2),o.Qb(),o.Qb()),2&t){const t=o.bc().data;o.Bb(2),o.Mc(t&&t.silverAction?t.silverAction.cat():"-")}}function _j(t,e){if(1&t&&(o.Rb(0,"dt",9),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("meta.hint.stats.info_capture")),o.Bb(1),o.Mc(t.L("meta.ui.stats.info_capture"))}}function kj(t,e){if(1&t&&(o.Rb(0,"dd"),o.Rb(1,"span"),o.Lc(2),o.Qb(),o.Qb()),2&t){const t=o.bc().data;o.Bb(2),o.Mc(t&&t.silverCapture?t.silverCapture.cat():"-")}}function wj(t,e){if(1&t&&(o.Rb(0,"dt",9),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("meta.hint.stats.info_control")),o.Bb(1),o.Mc(t.L("meta.ui.stats.info_control"))}}function Sj(t,e){if(1&t&&(o.Rb(0,"dd"),o.Rb(1,"span"),o.Lc(2),o.Qb(),o.Qb()),2&t){const t=o.bc().data;o.Bb(2),o.Mc(t&&t.silverControl?t.silverControl.cat():"-")}}function Ij(t,e){if(1&t&&(o.Rb(0,"div",6),o.Rb(1,"dl"),o.Jc(2,gj,2,2,"dt",7),o.Jc(3,fj,3,1,"dd",8),o.Qb(),o.Rb(4,"dl"),o.Jc(5,vj,2,2,"dt",7),o.Jc(6,yj,3,1,"dd",8),o.Qb(),o.Rb(7,"dl"),o.Jc(8,_j,2,2,"dt",7),o.Jc(9,kj,3,1,"dd",8),o.Qb(),o.Rb(10,"dl"),o.Jc(11,wj,2,2,"dt",7),o.Jc(12,Sj,3,1,"dd",8),o.Qb(),o.Qb()),2&t){const t=e.data;o.Bb(2),o.jc("ngIf",!t||!t.hideTitles),o.Bb(1),o.jc("ngIf",!t||!t.hideValues),o.Bb(2),o.jc("ngIf",!t||!t.hideTitles),o.Bb(1),o.jc("ngIf",!t||!t.hideValues),o.Bb(2),o.jc("ngIf",!t||!t.hideTitles),o.Bb(1),o.jc("ngIf",!t||!t.hideValues),o.Bb(2),o.jc("ngIf",!t||!t.hideTitles),o.Bb(1),o.jc("ngIf",!t||!t.hideValues)}}function Cj(t,e){if(1&t&&(o.Rb(0,"figure",29),o.Ob(1,"img",30),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("src",t.getCommanderImageSrc(t.selectedPlayer),o.Cc)}}function Lj(t,e){1&t&&(o.Rb(0,"figure",29),o.Ob(1,"img",31),o.Qb()),2&t&&(o.Bb(1),o.jc("src","assets/img/no-commander.jpg",o.Cc))}function Rj(t,e){if(1&t&&o.Ob(0,"img",32),2&t){const t=o.bc(2);o.jc("src","assets/img/flags/campaign_"+t.selectedPlayer.army+".png",o.Cc)}}function Oj(t,e){if(1&t&&(o.Rb(0,"span",9),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("commander."+t.selectedPlayer.commander.template+".name")),o.Bb(1),o.Nc(" ",t.L("commander."+t.selectedPlayer.commander.template+".name")," ")}}function Tj(t,e){if(1&t&&(o.Rb(0,"span",9),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("commander."+(t.selectedPlayer.botCommander.text||t.selectedPlayer.botCommander.id)+".name")),o.Bb(1),o.Nc(" ",t.L("commander."+(t.selectedPlayer.botCommander.text||t.selectedPlayer.botCommander.id)+".name")," ")}}function xj(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",33),o.Yb("click",function(e){o.zc(t);const i=o.bc(2);return i.addNewFriendRequest(i.selectedPlayer,e)}),o.Ob(1,"img",34),o.Qb()}if(2&t){const t=o.bc(2);o.kc("tooltip-hint",t.L("meta.ui.friend.action_add")+" "+t.selectedPlayer.displayName),o.jc("alertSound","ui_click_default")}}function Bj(t,e){if(1&t&&(o.Rb(0,"div",39),o.Lc(1),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.Nc(" ",t.selectedPlayer.rankNew.cat(" ")," ")}}function jj(t,e){if(1&t&&(o.Rb(0,"div",40),o.Rb(1,"span"),o.Lc(2),o.Qb(),o.Lc(3),o.Qb()),2&t){const t=o.bc(3);o.Fb("positive",t.selectedPlayer.rankNew>t.selectedPlayer.rankOld)("negative",t.selectedPlayer.rankNew<=t.selectedPlayer.rankOld),o.Bb(2),o.Mc(t.selectedPlayer.rankNew>t.selectedPlayer.rankOld?"+":"-"),o.Bb(1),o.Nc(" ",t.selectedPlayer.rankNew-t.selectedPlayer.rankOld," ")}}function Mj(t,e){if(1&t&&(o.Rb(0,"div",35),o.Jc(1,Bj,2,1,"div",36),o.Ob(2,"img",37),o.Jc(3,jj,4,6,"div",38),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("ngIf",t.selectedPlayer.rankNew),o.Bb(2),o.jc("ngIf",t.selectedPlayer.rankOld)}}const Qj=function(t,e){return{new:t,old:e}},Aj=function(t,e){return{portrait:t,wreath:e}},Dj=function(t,e,i,n,s,a,r,o){return{displayName:t,commander:e,league:i,level:n,rank:s,tooltip:a,bot:r,avatar:o}};function Ej(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",10),o.Jc(1,Cj,2,1,"figure",11),o.Jc(2,Lj,2,1,"figure",11),o.Qb(),o.Rb(3,"div",12),o.Rb(4,"div",13),o.Rb(5,"button",14),o.Yb("click",function(){return o.zc(t),o.bc().getPreviousPlayerInTeam()}),o.Ob(6,"img",15),o.Qb(),o.Qb(),o.Rb(7,"div",16),o.Rb(8,"div",17),o.Jc(9,Rj,1,1,"img",18),o.Rb(10,"div",19),o.Ob(11,"user-image",20),o.Qb(),o.Rb(12,"div",21),o.Ob(13,"nickname",22),o.Rb(14,"div",23),o.Jc(15,Oj,2,2,"span",7),o.Jc(16,Tj,2,2,"span",7),o.Qb(),o.Qb(),o.Rb(17,"div",24),o.Jc(18,xj,2,2,"button",25),o.Qb(),o.Qb(),o.Jc(19,Mj,4,2,"div",26),o.Qb(),o.Rb(20,"div",13),o.Rb(21,"button",27),o.Yb("click",function(){return o.zc(t),o.bc().getNextPlayerInTeam()}),o.Ob(22,"img",28),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(1),o.jc("ngIf",t.selectedPlayer.commander),o.Bb(1),o.jc("ngIf",!(t.selectedPlayer.commander||null!=t.selectedPlayer.commander&&t.selectedPlayer.commander.template)),o.Bb(3),o.kc("tooltip-hint",t.L("meta.hint.stats.prev_player")),o.jc("alertSound","ui_click_default"),o.Bb(3),o.Fb("selected",t.selectedPlayer.eid==t.userId),o.Bb(1),o.jc("ngIf",t.selectedPlayer.commander),o.Bb(2),o.jc("player",o.uc(21,Dj,t.selectedPlayer.displayName||t.L("meta.ui.stats.ai"),null==t.selectedPlayer.commander?null:t.selectedPlayer.commander.type,t.selectedPlayer.league,t.selectedPlayer.botCommander?t.L("level."+t.selectedPlayer.botCommander.bot.level):t.getPlayerLevel(t.selectedPlayer),t.selectedPlayer.bot||!t.selectedPlayer.displayName?null:o.oc(15,Qj,t.selectedPlayer.rankNew||0,t.selectedPlayer.rankOld||0),t.selectedPlayer.commander&&t.selectedPlayer.commander.template?t.L("commander."+t.selectedPlayer.commander.template+".name"):t.selectedPlayer.bot?t.L("commander."+(null==t.selectedPlayer.botCommander?null:t.selectedPlayer.botCommander.id)+".name"):"",!!t.selectedPlayer.bot,o.oc(18,Aj,t.selectedPlayer.portrait,t.selectedPlayer.wreath))),o.Bb(2),o.jc("name",t.selectedPlayer.bot&&t.selectedPlayer.botCommander&&t.selectedPlayer.botCommander.bot&&t.selectedPlayer.botCommander.bot.level?t.L("meta.ui.stats.ai")+", "+t.L("meta.ui.lobby.options.unit_level."+t.selectedPlayer.botCommander.bot.level):t.selectedPlayer.bot&&t.selectedPlayer.commander&&t.selectedPlayer.commander.level?t.L("meta.ui.stats.ai")+", "+t.L("meta.ui.lobby.options.unit_level."+t.selectedPlayer.commander.level):t.selectedPlayer.displayName?t.selectedPlayer.displayName:"No Name"),o.Bb(2),o.jc("ngIf",t.selectedPlayer.commander&&t.selectedPlayer.commander.template),o.Bb(1),o.jc("ngIf",t.selectedPlayer.botCommander&&t.selectedPlayer.botCommander.bot),o.Bb(2),o.jc("ngIf",t.selectedPlayer.eid!=t.userId&&!t.checkIfUserIsAFriend(t.selectedPlayer.eid)&&!t.selectedPlayer.bot&&t.selectedPlayer.displayName),o.Bb(1),o.jc("ngIf",t.selectedPlayer&&t.selectedPlayer.rankNew&&!t.selectedPlayer.bot&&t.selectedPlayer.displayName),o.Bb(2),o.kc("tooltip-hint",t.L("meta.hint.stats.next_player")),o.jc("alertSound","ui_click_default")}}function Nj(t,e){1&t&&o.Ob(0,"span",45)}function Fj(t,e){if(1&t&&(o.Rb(0,"div"),o.Rb(1,"div",9),o.Ob(2,"currency",41),o.Qb(),o.Rb(3,"div",9),o.Rb(4,"div",42),o.Ob(5,"currency",41),o.Qb(),o.Qb(),o.Rb(6,"div",43),o.Ob(7,"currency",41),o.Jc(8,Nj,1,0,"span",44),o.Qb(),o.Qb()),2&t){const t=e.data,i=o.bc();o.Fb("active",t.premium),o.Bb(1),o.kc("tooltip-hint",i.L("meta.hint.stats.silver")),o.Bb(1),o.jc("type","silver")("value",t.silverCredit.cat())("smallSize",!0),o.Bb(1),o.kc("tooltip-hint",i.L("meta.hint.stats.xp")),o.Bb(2),o.jc("type","exp")("value",t.xpUnit.cat())("smallSize",!0),o.Bb(1),o.kc("tooltip-hint",i.L("meta.hint.stats.free_xp")),o.Bb(1),o.jc("type","free_xp")("value",t.xpFree.cat())("smallSize",!0),o.Bb(1),o.jc("ngIf",i.hasCounter("ui.mark.stats.currency"))}}function Pj(t,e){if(1&t&&(o.Rb(0,"div",46),o.Rb(1,"div",47),o.Ob(2,"empty",48),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(2),o.jc("title",t.L("meta.ui.error.attention"))("desc",t.L("meta.ui.stats.session_unavailable"))}}function Uj(t,e){if(1&t&&(o.Rb(0,"span",63),o.Ob(1,"img",64),o.Qb()),2&t){const t=o.bc(2);o.lc("tooltip-hint","",t.L("meta.ui.stats.battle_ignored_status"),"</br>",t.L("meta.ui.stats.battle_ignored_reason."+t.session.control.ignoreReason),"")}}function zj(t,e){if(1&t&&(o.Rb(0,"div",73),o.Rb(1,"div",74),o.Rb(2,"div",75),o.Rb(3,"h3"),o.Lc(4),o.Qb(),o.Rb(5,"div",76),o.Rb(6,"div",77),o.Ob(7,"span"),o.Rb(8,"b",78),o.Lc(9),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(10,"div",79),o.Rb(11,"div",74),o.Rb(12,"div",80),o.Rb(13,"div",81),o.Ob(14,"img",82),o.Qb(),o.Qb(),o.Rb(15,"div",80),o.Rb(16,"div",81),o.Ob(17,"img",82),o.Qb(),o.Qb(),o.Rb(18,"div",83),o.Rb(19,"div",81),o.Ob(20,"img",84),o.Qb(),o.Qb(),o.Rb(21,"div",85),o.Rb(22,"div",81),o.Ob(23,"img",84),o.Qb(),o.Qb(),o.Rb(24,"div",83),o.Rb(25,"div",86),o.Ob(26,"img",84),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=e.index,n=o.bc(3);o.Fb("positive",n.sessionBelongsToPlayer&&t.teamId===n.userTeam.teamId)("negative",n.sessionBelongsToPlayer&&t.teamId!==n.userTeam.teamId),o.Cb("s-team",i+1),o.Bb(4),o.Mc(n.L("meta.ui.stats.team_"+t.teamId)),o.Bb(2),o.Fb("positive",0==i)("negative",1==i),o.Bb(1),o.Gc("width:"+n.session.team[t.teamId].score/2500*100+"0%"),o.Bb(2),o.Mc(n.session.team[t.teamId].score.cat()),o.Bb(3),o.kc("tooltip-hint",n.L("meta.ui.commander.type.inf")+"<br>"+n.L("meta.ui.stats.table.eliminated")),o.Bb(2),o.jc("src","assets/img/liga/inf.svg",o.Cc),o.Bb(1),o.kc("tooltip-hint",n.L("meta.ui.store.unit")+"<br>"+n.L("meta.ui.stats.table.eliminated")),o.Bb(2),o.jc("src","assets/img/liga/tnk.svg",o.Cc),o.Bb(1),o.kc("tooltip-hint",n.L("meta.ui.stats.info_action")),o.Bb(2),o.jc("src","assets/img/icons/svg/win.svg",o.Cc),o.Bb(1),o.kc("tooltip-hint",n.L("meta.ui.stats.button_personal_score")),o.Bb(2),o.jc("src","assets/img/icons/svg/target.svg",o.Cc),o.Bb(1),o.kc("tooltip-hint",n.L("meta.ui.store.currency.exp")),o.Bb(2),o.jc("src","assets/img/icons/svg/exp.svg",o.Cc)}}function Jj(t,e){if(1&t&&o.Ob(0,"img",32),2&t){const t=o.bc(2).$implicit;o.jc("src","assets/img/flags/campaign_"+t.army+".png",o.Cc)}}function qj(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).$implicit,e=o.bc(4);o.Bb(1),o.Nc(" ",e.L("commander."+t.commander.template+".name")," ")}}function Vj(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).$implicit,e=o.bc(4);o.Bb(1),o.Nc(" ",e.L("commander."+(t.botCommander.text||t.botCommander.id)+".name")," ")}}function $j(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",33),o.Yb("click",function(e){o.zc(t);const i=o.bc(2).$implicit;return o.bc(4).addNewFriendRequest(i,e)}),o.Ob(1,"img",34),o.Qb()}if(2&t){const t=o.bc(2).$implicit,e=o.bc(4);o.kc("tooltip-hint",e.L("meta.ui.friend.action_add")+" "+t.displayName),o.jc("alertSound","ui_click_default")}}const Gj=function(t){return{lobby:t}};function Hj(t,e){if(1&t&&(o.Rb(0,"span",108),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).$implicit,e=o.bc(4);o.kc("tooltip-hint",e.L("meta.hint.stats.lobby_team",o.nc(2,Gj,e.getPlayerLobbyTeam(t.pack)))),o.Bb(1),o.Mc(e.getPlayerLobbyTeam(t.pack))}}function Yj(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div"),o.Rb(1,"div",96),o.Rb(2,"div",97),o.Rb(3,"div",98),o.Jc(4,Jj,1,1,"img",18),o.Rb(5,"div",99),o.Yb("click",function(){o.zc(t);const e=o.bc(),i=e.$implicit,n=e.index,s=o.bc().$implicit,a=o.bc(3);return a.selectPlayer(i,s,n),a.tab="personal"}),o.Ob(6,"user-image",20),o.Qb(),o.Rb(7,"div",100),o.Yb("click",function(){o.zc(t);const e=o.bc(),i=e.$implicit,n=e.index,s=o.bc().$implicit,a=o.bc(3);return a.selectPlayer(i,s,n),a.tab="personal"}),o.Ob(8,"nickname",22),o.Rb(9,"div",23),o.Jc(10,qj,2,1,"span",8),o.Jc(11,Vj,2,1,"span",8),o.Qb(),o.Qb(),o.Rb(12,"div",24),o.Jc(13,$j,2,2,"button",25),o.Qb(),o.Jc(14,Hj,2,4,"span",101),o.Qb(),o.Qb(),o.Rb(15,"div",102),o.Rb(16,"div",103),o.Rb(17,"div",104),o.Rb(18,"span",105),o.Lc(19),o.Qb(),o.Qb(),o.Rb(20,"div",104),o.Rb(21,"span",105),o.Lc(22),o.Qb(),o.Qb(),o.Rb(23,"div",106),o.Rb(24,"span"),o.Lc(25),o.Qb(),o.Qb(),o.Rb(26,"div",104),o.Rb(27,"span"),o.Lc(28),o.Qb(),o.Qb(),o.Rb(29,"div",106),o.Rb(30,"span",107),o.Lc(31),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc().$implicit,e=o.bc().$implicit,i=o.bc(3);o.Bb(1),o.Fb("positive",i.sessionBelongsToPlayer&&e.teamId===i.userTeam.teamId)("negative",i.sessionBelongsToPlayer&&e.teamId!==i.userTeam.teamId),o.kc("tooltip-hint",i.L("meta.hint.profile.stats.result.personal")),o.jc("alertSound","ui_click_default"),o.Bb(2),o.Fb("selected",t.eid==i.userId),o.Cb("lobby-team",i.getPlayerLobbyTeam(t.pack)),o.Bb(1),o.jc("ngIf",t.commander),o.Bb(1),o.kc("tooltip-hint",i.L("meta.ui.stats.button_personal_score")),o.Bb(1),o.jc("player",o.uc(34,Dj,t.displayName||i.L("meta.ui.stats.ai"),null==t.commander?null:t.commander.type,t.league,t.botCommander?i.L("level."+t.botCommander.bot.level):i.getPlayerLevel(t),t.bot||!t.displayName?null:o.oc(28,Qj,t.rankNew||0,t.rankOld||0),t.commander&&t.commander.template?i.L("commander."+t.commander.template+".name"):t.bot?i.L("commander."+(null==t.botCommander?null:t.botCommander.id)+".name"):"",!!t.bot,o.oc(31,Aj,t.portrait,t.wreath))),o.Bb(1),o.kc("tooltip-hint",i.L("meta.ui.stats.button_personal_score")),o.Bb(1),o.jc("name",t.bot&&t.botCommander&&t.botCommander.bot&&t.botCommander.bot.level?i.L("meta.ui.stats.ai")+", "+i.L("meta.ui.lobby.options.unit_level."+t.botCommander.bot.level):t.bot&&t.commander&&t.commander.level?i.L("meta.ui.stats.ai")+", "+i.L("meta.ui.lobby.options.unit_level."+t.commander.level):t.displayName?t.displayName:"No Name"),o.Bb(2),o.jc("ngIf",t.commander&&t.commander.template),o.Bb(1),o.jc("ngIf",t.botCommander&&t.botCommander.bot),o.Bb(2),o.jc("ngIf",t.eid!=i.userId&&!i.checkIfUserIsAFriend(t.eid)&&!t.bot&&t.displayName),o.Bb(1),o.jc("ngIf",i.getPlayerLobbyTeam(t.pack)),o.Bb(1),o.Cb("lobby-team",i.getPlayerLobbyTeam(t.pack)),o.Bb(3),o.kc("tooltip-hint",i.L("meta.ui.stats.table.eliminated")),o.Bb(1),o.Oc(" ",t.infantryKilled?t.infantryKilled.cat():0,"/",t.infantryLost?t.infantryLost.cat():0," "),o.Bb(2),o.kc("tooltip-hint",i.L("meta.ui.stats.table.eliminated")),o.Bb(1),o.Oc(" ",t.vehicleKilled?t.vehicleKilled.cat():0,"/",t.vehicleLost?t.vehicleLost.cat():0," "),o.Bb(3),o.Mc(t.damageTotal?t.damageTotal.cat():0),o.Bb(3),o.Mc(t.score?t.score.cat():0),o.Bb(3),o.Mc(t.xpUnit?t.xpUnit.cat():0)}}function Wj(t,e){if(1&t&&(o.Rb(0,"li",95),o.Jc(1,Yj,32,43,"div",8),o.Qb()),2&t){const t=e.$implicit;o.Bb(1),o.jc("ngIf",!t.hiddenBot||0==t.hiddenBot)}}function Kj(t,e){if(1&t&&(o.Rb(0,"div",87),o.Rb(1,"scrollable",88),o.Rb(2,"ul",89),o.Jc(3,Wj,2,1,"li",90),o.Qb(),o.Rb(4,"ul",89),o.Rb(5,"li",91),o.Rb(6,"div",92),o.Ob(7,"div",75),o.Rb(8,"div",79),o.Rb(9,"div",93),o.Rb(10,"div",80),o.Rb(11,"div",21),o.Lc(12),o.Qb(),o.Qb(),o.Rb(13,"div",80),o.Rb(14,"div",21),o.Lc(15),o.Qb(),o.Qb(),o.Rb(16,"div",83),o.Rb(17,"div",21),o.Lc(18),o.Qb(),o.Qb(),o.Rb(19,"div",85),o.Rb(20,"div",21),o.Lc(21),o.Qb(),o.Qb(),o.Rb(22,"div",83),o.Rb(23,"div",94),o.Lc(24),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=e.index,n=o.bc(3);o.Cb("s-team",i+1),o.Bb(1),o.jc("bbox",!0),o.Bb(2),o.jc("ngForOf",t.players),o.Bb(7),o.kc("tooltip-hint",n.L("meta.ui.commander.type.inf")+"<br>"+n.L("meta.ui.stats.table.eliminated")),o.Bb(2),o.Oc(" ",n.getTeamSummary(t.teamId,"infantryKilled").cat(),"/",n.getTeamSummary(t.teamId,"infantryLost").cat()," "),o.Bb(1),o.kc("tooltip-hint",n.L("meta.ui.store.unit")+"<br>"+n.L("meta.ui.stats.table.eliminated")),o.Bb(2),o.Oc(" ",n.getTeamSummary(t.teamId,"vehicleKilled").cat(),"/",n.getTeamSummary(t.teamId,"vehicleLost").cat()," "),o.Bb(1),o.kc("tooltip-hint",n.L("meta.ui.stats.info_action")),o.Bb(2),o.Mc(n.getTeamSummary(t.teamId,"damageTotal").cat()),o.Bb(1),o.kc("tooltip-hint",n.L("meta.ui.stats.button_personal_score")),o.Bb(2),o.Mc(n.getTeamSummary(t.teamId,"score").cat()),o.Bb(1),o.kc("tooltip-hint",n.L("meta.ui.store.currency.exp")),o.Bb(2),o.Mc(n.getTeamSummary(t.teamId,"xpUnit").cat())}}function Xj(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",65),o.Rb(1,"div",66),o.Rb(2,"small",67),o.Yb("click",function(e){o.zc(t);const i=o.bc(2);return i.copy(i.session._id,e)}),o.Lc(3),o.Ob(4,"img",68),o.Rb(5,"span",69),o.Ob(6,"img",70),o.Lc(7),o.Qb(),o.Qb(),o.Jc(8,zj,27,23,"div",71),o.Jc(9,Kj,25,15,"div",72),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.Bb(2),o.kc("tooltip-hint",t.L("meta.hint.stats.copy_id")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Oc(" ",t.L("meta.ui.stats.table.battle_id")," // ",t.session._id," "),o.Bb(4),o.Nc(" ",t.L("meta.ui.chat.copied")," "),o.Bb(1),o.jc("ngForOf",t.session.teams),o.Bb(1),o.jc("ngForOf",t.session.teams)}}function Zj(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc(5);o.Bb(1),o.Mc(t.L("meta.ui.stats.table_unit"))}}function tM(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc(5);o.Bb(1),o.Mc(t.L("meta.ui.stats.table_enemies"))}}function eM(t,e){if(1&t){const t=o.Sb();o.Rb(0,"th",123),o.Yb("click",function(){return o.zc(t),o.bc(5).sortUnitsBy("damage")}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(5);o.Ic("width",t.tableCellWidth),o.Fb("sorting-asc","damage"===t.unitsSorting)("sorting-desc","!damage"===t.unitsSorting),o.kc("tooltip-hint",t.L("meta.hint.stats.damage")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.stats.table_damage")," ")}}function iM(t,e){if(1&t){const t=o.Sb();o.Rb(0,"th",123),o.Yb("click",function(){return o.zc(t),o.bc(5).sortUnitsBy("silver")}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(5);o.Ic("width",t.tableCellWidth),o.Fb("sorting-asc","silver"===t.unitsSorting)("sorting-desc","!silver"===t.unitsSorting),o.kc("tooltip-hint",t.L("meta.ui.campaign.currency")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.campaign.currency")," ")}}function nM(t,e){if(1&t){const t=o.Sb();o.Rb(0,"th",123),o.Yb("click",function(){return o.zc(t),o.bc(5).sortUnitsBy("xp")}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(5);o.Ic("width",t.tableCellWidth),o.Fb("sorting-asc","xp"===t.unitsSorting)("sorting-desc","!xp"===t.unitsSorting),o.kc("tooltip-hint",t.L("meta.hint.stats.xp")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.stats.table_xp")," ")}}function sM(t,e){if(1&t){const t=o.Sb();o.Rb(0,"th",123),o.Yb("click",function(){return o.zc(t),o.bc(5).sortUnitsBy("spawned")}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(5);o.Ic("width",t.tableCellWidth),o.Fb("sorting-asc","spawned"===t.unitsSorting)("sorting-desc","!spawned"===t.unitsSorting),o.kc("tooltip-hint",t.L("meta.hint.stats.table_spawned")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.stats.table_spawned")," ")}}function aM(t,e){if(1&t){const t=o.Sb();o.Rb(0,"th",123),o.Yb("click",function(){return o.zc(t),o.bc(5).sortUnitsBy("lost")}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(5);o.Ic("width",t.tableCellWidth),o.Fb("sorting-asc","lost"===t.unitsSorting)("sorting-desc","!lost"===t.unitsSorting),o.kc("tooltip-hint",t.L("meta.hint.stats.table_lost")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.stats.table_lost")," ")}}function rM(t,e){if(1&t){const t=o.Sb();o.Rb(0,"th",123),o.Yb("click",function(){return o.zc(t),o.bc(5).sortUnitsBy("rating")}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(5);o.Ic("width",t.tableCellWidth),o.Fb("sorting-asc","rating"===t.unitsSorting)("sorting-desc","!rating"===t.unitsSorting),o.kc("tooltip-hint",t.L("meta.hint.stats.table_damage_percent")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.stats.table_damage_percent")," ")}}function oM(t,e){if(1&t){const t=o.Sb();o.Rb(0,"th",123),o.Yb("click",function(){return o.zc(t),o.bc(5).sortUnitsBy("kill")}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(5);o.Ic("width",t.tableCellWidth),o.Fb("sorting-asc","kill"===t.unitsSorting)("sorting-desc","!kill"===t.unitsSorting),o.kc("tooltip-hint",t.L("meta.hint.stats.table_kill")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.stats.table_kill")," ")}}function cM(t,e){if(1&t){const t=o.Sb();o.Rb(0,"th",123),o.Yb("click",function(){return o.zc(t),o.bc(5).sortUnitsBy("damage")}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(5);o.Ic("width",t.tableCellWidth),o.Fb("sorting-asc","damage"===t.unitsSorting)("sorting-desc","!damage"===t.unitsSorting),o.kc("tooltip-hint",t.L("meta.hint.stats.table_damage")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.stats.table_damage")," ")}}function lM(t,e){if(1&t){const t=o.Sb();o.Rb(0,"th",123),o.Yb("click",function(){return o.zc(t),o.bc(5).sortUnitsBy("allyKill")}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(5);o.Ic("width",t.tableCellWidth),o.Fb("sorting-asc","allyKill"===t.unitsSorting)("sorting-desc","!allyKill"===t.unitsSorting),o.kc("tooltip-hint",t.L("meta.hint.stats.table_ally_kill")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.stats.table_ally_kill")," ")}}function uM(t,e){if(1&t){const t=o.Sb();o.Rb(0,"th",123),o.Yb("click",function(){return o.zc(t),o.bc(5).sortUnitsBy("allyDamage")}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(5);o.Ic("width",t.tableCellWidth),o.Fb("sorting-asc","allyDamage"===t.unitsSorting)("sorting-desc","!allyDamage"===t.unitsSorting),o.kc("tooltip-hint",t.L("meta.hint.stats.table_ally_damage")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.stats.table_ally_damage")," ")}}function dM(t,e){if(1&t){const t=o.Sb();o.Rb(0,"th",123),o.Yb("click",function(){return o.zc(t),o.bc(5).sortUnitsBy("captured")}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(5);o.Ic("width",t.tableCellWidth),o.Fb("sorting-asc","captured"===t.unitsSorting)("sorting-desc","!captured"===t.unitsSorting),o.kc("tooltip-hint",t.L("meta.hint.stats.table_captured")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.stats.table_captured")," ")}}function hM(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",119),o.Rb(1,"table",120),o.Rb(2,"thead"),o.Rb(3,"tr"),o.Rb(4,"th",121),o.Yb("click",function(e){return o.zc(t),o.bc(4).sortUnitsBy("data.battleRank",e)}),o.Jc(5,Zj,2,1,"span",8),o.Jc(6,tM,2,1,"span",8),o.Qb(),o.Jc(7,eM,2,9,"th",122),o.Jc(8,iM,2,9,"th",122),o.Jc(9,nM,2,9,"th",122),o.Jc(10,sM,2,9,"th",122),o.Jc(11,aM,2,9,"th",122),o.Jc(12,rM,2,9,"th",122),o.Jc(13,oM,2,9,"th",122),o.Jc(14,cM,2,9,"th",122),o.Jc(15,lM,2,9,"th",122),o.Jc(16,uM,2,9,"th",122),o.Jc(17,dM,2,9,"th",122),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc(4);o.Bb(2),o.Cb("view-mode",t.unitsViewMode),o.Bb(2),o.Fb("sorting-asc","data.battleRank"===t.unitsSorting)("sorting-desc","!data.battleRank"===t.unitsSorting),o.kc("tooltip-hint",t.L("meta.ui.unit.unit_props.battle_rank")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.jc("ngIf","unit"===t.unitsViewMode),o.Bb(1),o.jc("ngIf","enemy"===t.unitsViewMode),o.Bb(1),o.jc("ngIf","unit"===t.unitsViewMode),o.Bb(1),o.jc("ngIf","unit"===t.unitsViewMode&&t.campaignId&&t.campaignCurrency),o.Bb(1),o.jc("ngIf","unit"===t.unitsViewMode),o.Bb(1),o.jc("ngIf","unit"===t.unitsViewMode),o.Bb(1),o.jc("ngIf","unit"===t.unitsViewMode),o.Bb(1),o.jc("ngIf","unit"===t.unitsViewMode),o.Bb(1),o.jc("ngIf","enemy"===t.unitsViewMode),o.Bb(1),o.jc("ngIf","enemy"===t.unitsViewMode),o.Bb(1),o.jc("ngIf","enemy"===t.unitsViewMode),o.Bb(1),o.jc("ngIf","enemy"===t.unitsViewMode),o.Bb(1),o.jc("ngIf","enemy"===t.unitsViewMode)}}function bM(t,e){if(1&t&&o.Ob(0,"td",134),2&t){const t=o.bc().$implicit,e=o.bc(7);o.Ic("width",e.tableCellWidth),o.jc("innerHTML",t.silver?t.silver.cat():"<small>\u2014</small>",o.Ac)}}function mM(t,e){if(1&t&&(o.Rb(0,"tr"),o.Rb(1,"td",130),o.Rb(2,"div",131),o.Ob(3,"img",132),o.Qb(),o.Rb(4,"div",133),o.Lc(5),o.Qb(),o.Qb(),o.Ob(6,"td",134),o.Jc(7,bM,1,3,"td",135),o.Ob(8,"td",134),o.Ob(9,"td",134),o.Ob(10,"td",134),o.Ob(11,"td",134),o.Qb()),2&t){const t=e.$implicit,i=o.bc(7);o.Bb(3),o.jc("src","assets/img/unit/"+t.data.id+".png",o.Cc),o.Bb(2),o.Mc(i.L("unit."+t.data.id+".short")),o.Bb(1),o.Ic("width",i.tableCellWidth),o.jc("innerHTML",t.damage?t.damage.cat():"<small>\u2014</small>",o.Ac),o.Bb(1),o.jc("ngIf",i.campaignId&&i.campaignCurrency),o.Bb(1),o.Ic("width",i.tableCellWidth),o.Fb("animated",i.animated[t.id]),o.jc("innerHTML",t.xp?t.xp.cat():"<small>\u2014</small>",o.Ac),o.Bb(1),o.Ic("width",i.tableCellWidth),o.jc("innerHTML",t.spawned?t.spawned.cat():"<small>\u2014</small>",o.Ac),o.Bb(1),o.Ic("width",i.tableCellWidth),o.jc("innerHTML",t.lost?t.lost.cat():"<small>\u2014</small>",o.Ac),o.Bb(1),o.Ic("width",i.tableCellWidth),o.jc("innerHTML",t.rating?t.rating+" %":"<small>\u2014</small>",o.Ac)}}function pM(t,e){if(1&t&&(o.Rb(0,"table",120),o.Rb(1,"tbody"),o.Jc(2,mM,12,20,"tr",129),o.cc(3,"sortList"),o.Qb(),o.Qb()),2&t){const t=o.bc(6);o.Bb(2),o.jc("ngForOf",o.ec(3,1,t.selectedPlayer.units,t.unitsSorting))}}function gM(t,e){if(1&t&&(o.Rb(0,"div",131),o.Ob(1,"img",132),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(7);o.Bb(1),o.jc("src","assets/img/unit/"+e.I(t.id)+".png",o.Cc)}}function fM(t,e){if(1&t&&(o.Rb(0,"tr"),o.Rb(1,"td",130),o.Jc(2,gM,2,1,"div",136),o.Rb(3,"div",133),o.Lc(4),o.Qb(),o.Qb(),o.Ob(5,"td",134),o.Ob(6,"td",134),o.Ob(7,"td",134),o.Ob(8,"td",134),o.Ob(9,"td",134),o.Qb()),2&t){const t=e.$implicit,i=o.bc(7);o.Bb(2),o.jc("ngIf",t.id),o.Bb(2),o.Nc(" ",i.getActorName(t.id)," "),o.Bb(1),o.Ic("width",i.tableCellWidth),o.jc("innerHTML",t.kill?t.kill.cat():"<small>\u2014</small>",o.Ac),o.Bb(1),o.Ic("width",i.tableCellWidth),o.jc("innerHTML",t.damage?t.damage.cat():"<small>\u2014</small>",o.Ac),o.Bb(1),o.Ic("width",i.tableCellWidth),o.jc("innerHTML",t.allyKill?t.allyKill.cat():"<small>\u2014</small>",o.Ac),o.Bb(1),o.Ic("width",i.tableCellWidth),o.jc("innerHTML",t.allyDamage?t.allyDamage.cat():"<small>\u2014</small>",o.Ac),o.Bb(1),o.Ic("width",i.tableCellWidth),o.jc("innerHTML",t.captured?t.captured.cat():"<small>\u2014</small>",o.Ac)}}function vM(t,e){if(1&t&&(o.Rb(0,"table",120),o.Rb(1,"tbody"),o.Jc(2,fM,10,17,"tr",129),o.cc(3,"sortList"),o.Qb(),o.Qb()),2&t){const t=o.bc(6);o.Bb(2),o.jc("ngForOf",o.ec(3,1,t.selectedPlayer.enemies,t.unitsSorting))}}function yM(t,e){if(1&t&&(o.Rb(0,"scrollable",88,127),o.Jc(2,pM,4,4,"table",128),o.Jc(3,vM,4,4,"table",128),o.Qb()),2&t){const t=o.bc(5);o.jc("bbox",!0),o.Bb(2),o.jc("ngIf","unit"===t.unitsViewMode),o.Bb(1),o.jc("ngIf","enemy"===t.unitsViewMode)}}function _M(t,e){if(1&t&&(o.Rb(0,"div",137),o.Lc(1),o.Qb()),2&t){const t=o.bc(5);o.Bb(1),o.Nc(" ",t.L("meta.ui.stats.message_units_unavailable")," ")}}function kM(t,e){if(1&t&&(o.Rb(0,"div",124),o.Jc(1,yM,4,3,"scrollable",125),o.Jc(2,_M,2,1,"div",126),o.Qb()),2&t){const t=o.bc(4);o.Bb(1),o.jc("ngIf","unit"===t.unitsViewMode&&t.selectedPlayer.units.length||"enemy"===t.unitsViewMode&&t.selectedPlayer.enemies.length),o.Bb(1),o.jc("ngIf","unit"===t.unitsViewMode&&!t.selectedPlayer.units.length||"enemy"===t.unitsViewMode&&!t.selectedPlayer.enemies.length)}}function wM(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",66),o.Rb(1,"div",111),o.Pb(2,112),o.Qb(),o.Rb(3,"div",113),o.Rb(4,"div",114),o.Rb(5,"button",115),o.Yb("click",function(){return o.zc(t),o.bc(3).setUnitsViewMode("unit")}),o.Lc(6),o.Qb(),o.Rb(7,"button",115),o.Yb("click",function(){return o.zc(t),o.bc(3).setUnitsViewMode("enemy")}),o.Lc(8),o.Qb(),o.Qb(),o.Rb(9,"small",67),o.Yb("click",function(e){o.zc(t);const i=o.bc(3);return i.copy(i.session._id,e)}),o.Lc(10),o.Ob(11,"img",68),o.Rb(12,"span",69),o.Ob(13,"img",70),o.Lc(14),o.Qb(),o.Qb(),o.Jc(15,hM,18,20,"div",116),o.Qb(),o.Rb(16,"div",117),o.Jc(17,kM,3,2,"div",118),o.Qb(),o.Qb()}if(2&t){const t=o.bc(3),e=o.wc(3);o.Bb(2),o.jc("ngTemplateOutlet",e),o.Bb(3),o.Fb("active","unit"===t.unitsViewMode),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.stats.table_unit")," "),o.Bb(1),o.Fb("active","enemy"===t.unitsViewMode),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.stats.table_enemies")," "),o.Bb(1),o.kc("tooltip-hint",t.L("meta.hint.stats.copy_id")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Oc(" ",t.L("meta.ui.stats.table.battle_id")," // ",t.session._id," "),o.Bb(4),o.Nc(" ",t.L("meta.ui.chat.copied")," "),o.Bb(1),o.jc("ngIf",t.selectedPlayer&&!t.viewPremiumScore&&("unit"===t.unitsViewMode&&t.selectedPlayer.units.length||"enemy"===t.unitsViewMode&&t.selectedPlayer.enemies.length)),o.Bb(2),o.jc("ngIf",t.selectedPlayer&&!t.viewPremiumScore)}}function SM(t,e){if(1&t&&(o.Rb(0,"div",109),o.Jc(1,wM,18,16,"div",110),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("ngIf",t.selectedPlayer)}}function IM(t,e){if(1&t&&(o.Rb(0,"div",150),o.Rb(1,"h4"),o.Lc(2),o.Qb(),o.Ob(3,"currency",151),o.Qb()),2&t){const t=o.bc(3);o.Fb("if-bonds",t.userPlayer&&t.userPlayer.gold&&t.session&&t.session.game&&(!t.session.game.request||!t.session.game.request.campaign)),o.Bb(2),o.Mc(t.L("meta.ui.store.currency.rating_point")),o.Bb(1),o.jc("value",t.session.rankNew-t.session.rankOld)("type","rating")("animated",!0)}}function CM(t,e){if(1&t&&(o.Rb(0,"div",152),o.Rb(1,"h4"),o.Lc(2),o.Qb(),o.Ob(3,"currency",151),o.Qb()),2&t){const t=o.bc(3);o.Fb("if-rating",t.session.rankNew),o.Bb(2),o.Mc(t.L("meta.ui.store.currency.bonds")),o.Bb(1),o.jc("value",t.userPlayer.gold.cat())("type","gold")("animated",!0)}}function LM(t,e){if(1&t&&(o.Rb(0,"div",153),o.Rb(1,"h4"),o.Lc(2),o.Qb(),o.Ob(3,"currency",151),o.Qb()),2&t){const t=o.bc(3);o.Bb(2),o.Mc(t.L("meta.ui.store.currency."+t.campaignCurrency)),o.Bb(1),o.jc("value",t.userPlayer.silverCredit.cat())("type",t.campaignCurrency)("animated",!0)}}function RM(t,e){if(1&t&&(o.Rb(0,"div",154),o.Rb(1,"h4"),o.Lc(2),o.Qb(),o.Ob(3,"currency",151),o.Qb()),2&t){const t=o.bc(3);o.Bb(2),o.Mc(t.L("meta.ui.store.currency.exp")),o.Bb(1),o.jc("value",t.userPlayer.xpUnit.cat())("type","exp")("animated",!0)}}function OM(t,e){if(1&t&&(o.Rb(0,"div",155),o.Rb(1,"h4"),o.Lc(2),o.Qb(),o.Ob(3,"currency",151),o.Qb()),2&t){const t=o.bc(3);o.Bb(2),o.Mc(t.L("meta.ui.store.currency.free_xp")),o.Bb(1),o.jc("value",t.userPlayer.xpFree.cat())("type","free_xp")("animated",!0)}}const TM=function(t){return{data:t}};function xM(t,e){if(1&t&&(o.Rb(0,"div",138),o.Rb(1,"div",66),o.Rb(2,"div",139),o.Rb(3,"div",140),o.Pb(4,141),o.Qb(),o.Qb(),o.Rb(5,"div",142),o.Rb(6,"div",140),o.Rb(7,"div",143),o.Rb(8,"dl"),o.Rb(9,"dt"),o.Lc(10),o.Qb(),o.Rb(11,"dd"),o.Ob(12,"img",144),o.Qb(),o.Qb(),o.Rb(13,"dl"),o.Rb(14,"dt"),o.Lc(15),o.Qb(),o.Rb(16,"dd"),o.Ob(17,"img",144),o.Qb(),o.Qb(),o.Rb(18,"dl"),o.Rb(19,"dt"),o.Lc(20),o.Qb(),o.Rb(21,"dd"),o.Ob(22,"img",144),o.Qb(),o.Qb(),o.Rb(23,"dl"),o.Rb(24,"dt"),o.Lc(25),o.Qb(),o.Rb(26,"dd"),o.Ob(27,"img",144),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Jc(28,IM,4,6,"div",145),o.Jc(29,CM,4,6,"div",146),o.Jc(30,LM,4,4,"div",147),o.Jc(31,RM,4,4,"div",148),o.Jc(32,OM,4,4,"div",149),o.Qb(),o.Qb()),2&t){const t=o.bc(2),e=o.wc(1);o.Bb(4),o.jc("ngTemplateOutlet",e)("ngTemplateOutletContext",o.nc(15,TM,t.getScoreTemplateData(t.userPlayer))),o.Bb(6),o.Mc(t.L("meta.ui.battle.control_allow.reward")),o.Bb(2),o.jc("src",!t.session.control||t.session.control&&t.session.control.allow&&t.session.control.allow.reward?"assets/img/icons/svg/compare_add_green.svg":"assets/img/icons/svg/compare_remove_red.svg",o.Cc),o.Bb(3),o.Mc(t.L("meta.ui.battle.control_allow.rank_update")),o.Bb(2),o.jc("src",!t.session.control||t.session.control&&t.session.control.allow&&t.session.control.allow.rank_update?"assets/img/icons/svg/compare_add_green.svg":"assets/img/icons/svg/compare_remove_red.svg",o.Cc),o.Bb(3),o.Mc(t.L("meta.ui.battle.control_allow.stats_update")),o.Bb(2),o.jc("src",!t.session.control||t.session.control&&t.session.control.allow&&t.session.control.allow.stats_update?"assets/img/icons/svg/compare_add_green.svg":"assets/img/icons/svg/compare_remove_red.svg",o.Cc),o.Bb(3),o.Mc(t.L("meta.ui.battle.control_allow.counters_update")),o.Bb(2),o.jc("src",!t.session.control||t.session.control&&t.session.control.allow&&t.session.control.allow.counters_update?"assets/img/icons/svg/compare_add_green.svg":"assets/img/icons/svg/compare_remove_red.svg",o.Cc),o.Bb(1),o.jc("ngIf",t.session.rankNew),o.Bb(1),o.jc("ngIf",t.userPlayer&&t.userPlayer.gold&&t.session&&t.session.game&&(!t.session.game.request||!t.session.game.request.campaign)),o.Bb(1),o.jc("ngIf",t.session&&t.session.game&&t.session.game.request&&t.session.game.request.campaign&&t.userPlayer&&t.userPlayer.silverCredit&&t.campaignCurrency),o.Bb(1),o.jc("ngIf",t.userPlayer&&t.userPlayer.xpUnit&&t.session&&t.session.game&&t.session.game.request&&t.session.game.request.campaign&&t.campaignCurrency),o.Bb(1),o.jc("ngIf",t.userPlayer&&t.userPlayer.xpFree&&t.session&&t.session.game&&t.session.game.request&&t.session.game.request.campaign&&t.campaignCurrency)}}function BM(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",49),o.Rb(1,"div",50),o.Rb(2,"button",51),o.Yb("click",function(){o.zc(t);const e=o.bc();return e.selectedPlayer=null,e.tab="team",e.triggerGlobalEvent("button.stats.common_info",{sessionId:e.session._id})}),o.Lc(3),o.Qb(),o.Rb(4,"button",51),o.Yb("click",function(){o.zc(t);const e=o.bc();return e.sessionBelongsToPlayer?e.selectUserPlayer():e.selectedRandomPlayer(),e.tab="personal",e.triggerGlobalEvent("button.stats.personal_info",{sessionId:e.session._id})}),o.Lc(5),o.Qb(),o.Rb(6,"button",51),o.Yb("click",function(){o.zc(t);const e=o.bc();return e.tab="rewards",e.selectedPlayer=null,e.triggerGlobalEvent("button.stats.rewards_info",{sessionId:e.session._id})}),o.Lc(7),o.Jc(8,Uj,2,2,"span",52),o.Qb(),o.Qb(),o.Rb(9,"div",53),o.Rb(10,"div",54),o.Rb(11,"small"),o.Lc(12),o.Qb(),o.Rb(13,"small",9),o.Lc(14),o.cc(15,"datetime"),o.Qb(),o.Qb(),o.Rb(16,"table",55),o.Rb(17,"tr",56),o.Rb(18,"td"),o.Rb(19,"h2"),o.Lc(20),o.Qb(),o.Qb(),o.Rb(21,"td"),o.Rb(22,"table",57),o.Rb(23,"tr"),o.Rb(24,"td",58),o.Rb(25,"span"),o.Lc(26),o.Qb(),o.Qb(),o.Rb(27,"td",59),o.Lc(28),o.Ob(29,"br"),o.Lc(30),o.cc(31,"duration"),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Jc(32,Xj,10,7,"div",60),o.Jc(33,SM,2,1,"div",61),o.Jc(34,xM,33,17,"div",62),o.Qb()}if(2&t){const t=o.bc();o.Bb(2),o.Fb("active","team"===t.tab),o.kc("tooltip-hint",t.L("meta.ui.stats.button_team_score")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.stats.button_team_score")," "),o.Bb(1),o.Fb("active","personal"===t.tab),o.kc("tooltip-hint",t.L("meta.ui.stats.button_personal_score")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.stats.button_personal_score")," "),o.Bb(1),o.Fb("active","rewards"==t.tab)("disabled",!t.userPlayer)("ignored",t.session.control&&t.session.control.ignored&&1==t.session.control.ignored),o.kc("tooltip-hint",t.L("meta.ui.stats.button_rewards")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.stats.button_rewards")," "),o.Bb(1),o.jc("ngIf",t.session.control&&t.session.control.ignored&&1==t.session.control.ignored),o.Bb(4),o.Nc("",t.L("meta.ui.stats.mode."+t.session.game.mode)," // "),o.Bb(1),o.kc("tooltip-hint",t.L("meta.hint.stats.date")),o.Bb(1),o.Mc(o.ec(15,30,t.session.closeTime,t.localizator.getLocale())),o.Bb(6),o.Mc(t.resultTitle),o.Bb(6),o.Mc(t.getTeamsCounter()),o.Bb(2),o.Nc(" ",t.L("meta.mission."+t.session.game.mapId+".name")," "),o.Bb(2),o.Nc(" ",o.ec(31,33,t.session.duration,t.localizator.getLocale())," "),o.Bb(2),o.jc("ngIf","team"===t.tab),o.Bb(1),o.jc("ngIf","personal"===t.tab),o.Bb(1),o.jc("ngIf","rewards"===t.tab)}}let jM=(()=>{class t{constructor(t,e,i,n,s,a){this.activatedRoute=t,this.router=e,this.cache=i,this.chatService=n,this.sanitizer=s,this.changeDetectorRef=a,this.levels=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],this.showNavigationButtons=!0,this.userId="",this.cachedSessions=[],this.sessionIndex=0,this.selectedPlayer=null,this.selectedTeam=null,this.unitsSorting="damage",this.selectedPlayerIndex=0,this.sessionLoaded=!1,this.unitsViewMode="unit",this.viewPremiumScore=!1,this.counters={},this.selectedUnits=[],this.animated={},this.userIsSelected=!1,this.tableCell=["28%","12%","12%","12%","12%","12%","12%"],this.tableCellWidth="12%",this.redirectToStoreActive=!1,this.campaignId="",this.campaignCurrency="",this.sessionBelongsToPlayer=!1,this.globalEvent=new uu,this.playerId="",this.tab="team",this._lobbyTeams=[],console.log(this.sessionId),this.localizator=new al,this.localizator.data.subscribe(t=>this.L=t),this.informator=new dl,this.informator.data.subscribe(t=>this.I=t),this.userId=this.cache.getUser(!0).userId,this.sessionLoaded=!1}ngOnInit(){this.playerId=(()=>{let t=/\/profile\/(?<playerId>.*?)\//.exec(this.router.url);return t&&t.groups?t.groups.playerId:""})(),console.log(this.playerId),this.cache.getSessionDetail(this.sessionId).subscribe(t=>{Object(Pc.a)("<- Single Session",this.sessionId),this.cache.devMode&&console.log(t),this.sessionLoaded=!0,this.cachedSessions=this.cache.getCachedSessions();let e=this.cache.getSession(this.sessionId);this.sessionIndex=this.cachedSessions.findIndex(t=>t._id===this.sessionId),this.checkIfSessionBelongsToPlayer(this.sessionId,t,e)},t=>{this.sessionLoaded=!0,Object(Pc.a)("<[x] Single Session",t)});let t=this.cache.getLastSession();t&&t._id===this.sessionId&&this.cache.setCounter("ui.mark.stats.last_battle",0),this.counters=this.cache.getCounters(),this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>this.counters[t.path]=t.value)}ngOnDestroy(){this.battleResultModal&&this.battleResultModal.close()}checkIfSessionBelongsToPlayer(t,e,i){if(!t)return;let n=!1;for(let s in e.player)e.player[s]&&e.player[s].eid&&e.player[s].eid===this.cache.getUserId()&&(n=!0);this.sessionBelongsToPlayer=n,setTimeout(()=>{this.computeSession(e,i,n)})}computeSession(t,e,i){e&&(t.silverCredit=e.silverCredit,t.xpUnit=e.xpUnit,t.xpFree=e.xpFree,t.winner=e.winner,t.draw=e.draw);let n=Object.keys(t.team).map(t=>({teamId:t,players:[]}));for(let s in t.player){let e=t.player[s];if("mission"==t.game.mode||"mission_combat"==t.game.mode?((e.eid.match(/script/gim)||e.bot)&&(e.displayName=this.L("meta.ui.stats.ai")),e.commander||(e.commander={level:1,type:"inf",template:"RUS_5_sappers_battalion"})):e.botProfile||e.commander||(e.hiddenBot=!0),e.botProfile||e.bot){e.displayName||(e.displayName=this.L("meta.ui.stats.ai"));let t=this.cache.getBotCommander(e.botProfile),i=this.cache.getCommanderFromBotCommander(e.botProfile);t&&(e.botCommander=t),i&&(e.commander=i)}n.map(n=>{n.teamId===e.team&&(e.hiddenBot&&0!=e.hiddenBot||n.players.push(e),e.eid===this.userId&&i&&(t.army=e.army,this.userPlayer=e,this.userTeam=n))}),e.pack&&-1==this._lobbyTeams.indexOf(e.pack)&&this._lobbyTeams.push(e.pack),e.units=e.bot?this.getBotUnits(e):this.getPlayerUnitsArray(e),e.enemies=this.getEnemiesLostsUnits(e)}n.map(t=>{t.players=t.players.sort((t,e)=>e.xpUnit-t.xpUnit);let e=t.players.findIndex(t=>t.eid.match(/script/gim));t.players.unshift(t.players[e]),t.players.splice(e+1,1)}),t.game.mapName=t.game.map.replace(/(multi\/groundcontrol\/|:groundcontrol|arena\_)/gim,""),t.teams=n,this.session=t,this.cache.devMode&&console.log("Teams:",n),t&&t.game&&t.game.request&&t.game.request.campaign&&(this.campaignId=t.game.request.campaign.template,this.campaignId&&this.cache.getCampaign(this.campaignId)&&(this.campaignCurrency=this.cache.getCampaign(this.campaignId).currency)),this.resultTitle=this.getBattleResultTitle()}getPlayerLobbyTeam(t){return t?this._lobbyTeams.findIndex(e=>e===t)+1:0}back(){this.cache.redirect([`/profile/${this.playerId}/sessions`])}selectPlayer(t,e,i){setTimeout(()=>{this.selectedPlayer=t,this.selectedTeam=e,this.selectedPlayerIndex=i,this.userPlayer&&(this.userIsSelected=this.selectedPlayer.eid===this.userPlayer.eid),console.log(this.selectedPlayer.enemies)},10)}selectUserPlayer(){this.viewPremiumScore=!1;let t=this.userTeam.players.findIndex(t=>t.eid===this.userId);this.selectPlayer(this.userPlayer,this.userTeam,t)}selectedRandomPlayer(){let t={},e={},i=0,n=[];if(this.session&&this.session.player)for(let a in this.session.player)this.session.player[a]&&!this.session.player[a].bot&&n.push(this.session.player[a]);let s=Math.ceil(Math.random()*(n.length-1-0)+0);t=n[s],this.session&&this.session.teams&&this.session.teams.length&&t&&t.team&&(e=this.session.teams.find(e=>e.teamId==t.team)),e&&e.players&&e.players.length&&t&&(i=e.players.findIndex(e=>e.eid==t.eid)),this.selectPlayer(t,e,i)}selectUserPlayerAndGoToPremium(){this.selectUserPlayer(),this.viewPremiumScore=!0}getBattleResultTitle(){let t=this.playerId||this.cache.getUserId(),e=this.session.winnerTeam||"",i=MM.Draw;for(let n in this.session.player){let s=this.session.player[n];if(s.gid===t){if(!e){i=MM.Draw;break}i=s.team===e?MM.Victory:MM.Defeat}}return i?this.L("meta.ui.stats."+i):""}getTeamsCounter(){let t="",e=0;return this.session.teams.map(i=>{e>0&&(t+=" x "),t+=i.players.length,e++}),t}sortUnitsBy(t,e){if(e&&e.target.closest("dropdown"))return;let i,n=t.replace(/\!/gim,"");n===this.unitsSorting.replace(/\!/gim,"")?(i="!"===this.unitsSorting[0],this.unitsSorting=`${i?"":"!"}${n}`):this.unitsSorting=t}setUnitsViewMode(t){setTimeout(()=>{this.unitsViewMode=t},100)}getPreviousPlayerInTeam(){this.selectedPlayerIndex--,this.selectedPlayerIndex<0&&(this.selectedPlayerIndex=this.selectedTeam.players.length-1),this.selectPlayer(this.selectedTeam.players[this.selectedPlayerIndex],this.selectedTeam,this.selectedPlayerIndex)}getNextPlayerInTeam(){this.selectedPlayerIndex++,this.selectedPlayerIndex>this.selectedTeam.players.length-1&&(this.selectedPlayerIndex=0),this.selectPlayer(this.selectedTeam.players[this.selectedPlayerIndex],this.selectedTeam,this.selectedPlayerIndex)}resetResults(){this.selectedPlayerIndex=0,this.selectedTeam=[],this.selectedPlayer=null,this.unitsSorting=""}getPlayerUnitsArray(t){let e=[];for(let i in t.unit){let n=this.cache.getTreeUnit(i);if(!n){Object(Pc.a)("Unit is broken. Cannot take data: ["+i+"] for statistic"),console.warn("Unit is broken. Cannot take data: ["+i+"] for statistic");continue}n=JSON.parse(JSON.stringify(n)),n.open=!0,n.available=!1,n.mode=gl.Default;let s=this.getUnitDataFromActorData(t,i),a=Object.assign(Object.assign({},t.unit[i]),{id:i.toString(),data:n});s&&Object.assign(a,s);for(let t in a)t.match(/rating|percent/gim)&&(a[t]=parseFloat((100*a[t]).toFixed(0)));e.push(a)}return e}getBotUnits(t){let e={};return!(!t||!t.actor)&&(Object.keys(t.actor).map(i=>{let n=JSON.parse(JSON.stringify(t.actor[i])),s=this.I(i);n.damage=n.damageTotal,n.silver=n.silverTotal,n.xp=n.xpTotal,e[s]?(["kill","damage","allyKill","allyDamage","captured"].map(t=>e[s][t]+=n[t]),e[s].doublesCount++):(e[s]=n,e[s].doublesCount=1)}),t.unit=e,this.getPlayerUnitsArray(t))}getEnemiesLostsUnits(t){let e={};return t&&t.damageToActor&&Object.keys(t.damageToActor).map(i=>{let n=JSON.parse(JSON.stringify(t.damageToActor[i])),s=this.I(i);e[s]?(["kill","damage","allyKill","allyDamage","captured"].map(t=>e[s][t]+=n[t]),e[s].doublesCount++):(e[s]=n,e[s].doublesCount=1)}),e?Object.keys(e).map(t=>{let i=JSON.parse(JSON.stringify(e[t]));return["kill","damage","allyKill","allyDamage","captured"].map(e=>{let n=this.cache.getTreeUnit(this.I(t));i.id=t,i.data={battleRank:n&&n.battleRank||0},i[e]?e.match(/rating/gim)&&(i[e]=parseFloat((100*i[e]).toFixed(0))):i[e]=0}),i}):null}getUnitDataFromActorData(t,e){let i=[],n={};for(let s in t.actor)this.I(s)===e&&i.push(t.actor[s]);return i.map(t=>{for(let e in t)n[e]||(n[e]=0),e.match(/damageRating/gim)?n[e]=Math.max(n[e],t[e]):n[e]+=t[e]}),n}prevSession(){this.sessionIndex--,this.sessionIndex<0&&(this.sessionIndex=this.cachedSessions.length-1),this.goToSessionByIndex()}nextSession(){this.sessionIndex++,this.sessionIndex>=this.cachedSessions.length&&(this.sessionIndex=0),this.goToSessionByIndex()}goToSessionByIndex(){let t=this.router.createUrlTree([`profile/${this.playerId}/sessions`,this.cachedSessions[this.sessionIndex]._id],{queryParamsHandling:"merge"});this.router.navigateByUrl(`profile/${this.playerId}/sessions`,{skipLocationChange:!0}).then(()=>{this.router.navigateByUrl(t)})}checkIfUserIsAFriend(t){let e=this.chatService.getFriends();if(e&&e.length)return!!e.find(e=>e.id==t)}addNewFriendRequest(t,e){e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),this.chatService.friendAdd(t.eid)}getSimpleUnit(t){return kl.createSimpleUnitById(t,this.sanitizer)}getScoreTemplateData(t,e={},i=!1){let n;if(t){if(t.useRank=!1,t.rankOld||t.rankNew){t.useRank=!0;let e=t.rankNew-t.rankOld;t.rank=`${e>0?"+":""}${e.cat()}`}if(!t.premiumValues)return t;n=i?JSON.parse(JSON.stringify(t.premium?t:t.premiumValues)):JSON.parse(JSON.stringify(t.premium?t.premiumValues:t)),n.usePremium=i,["silverCredit","xpUnit","xpFree"].map(e=>n[e]=t[e]);for(let t in e)n[t]=e[t];return n}}getExpoBarWidth(t){return Math.max(this.userPlayer[t],this.userPlayer.premiumValues?this.userPlayer.premiumValues[t]:0).toString().length+1}hasCounter(t){return this.cache.hasCounter(t)}hasFlag(t){return this.cache.hasFlag(t)}void(){}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}runXpUnitAnimation(t,e,i,n){let s=this[`unit${n}Animator`];s=new hd(e,1e3),s.on(dd.Start,()=>{this.animated[n]=!0}),s.on(dd.Progress,e=>{this.selectedPlayer.units[t].xp=parseInt(e.toFixed())}),s.on(dd.End,()=>{this.animated[n]=!1}),s.goTo(i)}runXpUserAnimation(t,e,i){let n=this["user{key}Animator"];n=new hd(t,1e3),n.on(dd.Start,()=>{this.animated[i]=!0}),n.on(dd.Progress,t=>{this.userPlayer.xpUnit=parseInt(t.toFixed())}),n.on(dd.End,()=>{this.animated[i]=!1}),n.goTo(e)}ifUnitIsChecked(t){return this.selectedUnits.includes(t)}getPlayerLevel(t){let e=this.cache.getUser(!0).scriptData.progression,i=e?e.levelStart:1,n=i;return t.commander&&(n=t.commander.maxUnitLevel||i),t.displayName&&!t.bot?this.levels[n-1]:this.L("meta.ui.stats.ai")}isFeaturesAvailable(){return this.cache.hasFlag("features_in_progress")}unwrapUnit(t){setTimeout(()=>{t.unwraped=!t.unwraped},1)}nextViewMode(){this.setUnitsViewMode("unit"===this.unitsViewMode?"enemy":"unit")}getNextViewModeTooltip(){return this.L("meta.hint.stats.view_mode."+("unit"===this.unitsViewMode?"enemy":"unit"))}cellWidth(t){return""+this.tableCell[t]}copy(t,e){const i=document.createElement("textarea");i.style.position="fixed",i.style.left="0",i.style.top="0",i.style.opacity="0",i.value=t,document.body.appendChild(i),i.focus(),i.select(),document.execCommand("copy"),document.body.removeChild(i);let n=e.target.closest(".battle-system-info").querySelector(".copy-feedback");n.classList.add("active"),setTimeout(()=>{n.classList.remove("active")},3e3)}redirectToStore(){this.redirectToStoreActive&&(this.redirectToStoreActive=!1,this.cache.redirect(["store","premium"]))}getCommanderImageSrc(t){let e=t.botCommander?t.botCommander:this.cache.getCommander(t.commander.template);return"assets/img/commanders/"+(e.image?e.image:e._id)+".png"}viewProfile(t){if(!t)return;this.battleResultModal.close();let e=this.router.createUrlTree(["profile",t,"summary"],{queryParamsHandling:"merge"});this.router.navigateByUrl(e,{})}getActorName(t){let e="actor."+this.I(t)+".name",i="unit."+this.I(t)+".short";return this.L(i)!==i?this.L(i):this.L(e)!==e?this.L(e):t}getTeamSummary(t,e){let i=this.session.teams.find(e=>e.teamId&&e.teamId==t),n=0;return i&&(n=i.players.reduce((t,i)=>t+i[e],0)),n||0}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(xn),o.Nb(Ys),o.Nb(nd),o.Nb(Pd),o.Nb(Er),o.Nb(o.h))},t.\u0275cmp=o.Hb({type:t,selectors:[["statistics-detail"]],viewQuery:function(t,e){if(1&t&&(o.Qc(mj,!0),o.Qc(pj,!0)),2&t){let t;o.vc(t=o.Zb())&&(e.battleResultModal=t.first),o.vc(t=o.Zb())&&(e.confirmation=t.first)}},inputs:{sessionId:"sessionId"},features:[o.Ab([Pd])],decls:11,vars:5,consts:[["scoreStatisticsTemplate",""],["commanderTemplate",""],["battleSummaryTemplate",""],["class","alert-wrapper",4,"ngIf"],["battle-results","","fade-in","","class","grid-default",4,"ngIf"],[1,"preloader","small","bold"],[1,"characteristics"],[3,"tooltip-hint",4,"ngIf"],[4,"ngIf"],[3,"tooltip-hint"],[1,"image-cover",2,"padding-top","82.17%","margin-top","var(--grid-gap)"],["class","texture-border no-hover",4,"ngIf"],[1,"row","align-top",2,"margin","0"],[1,"col-1",2,"padding","0"],["type","button",1,"prev","margin-top-small",3,"tooltip-hint","alertSound","click"],["src","assets/img/icons/svg/arrow_left_white.svg",1,"icon"],[1,"col-10"],[1,"chat-item","darken","large-item","margin-top-small"],["class","chat-flag-image",3,"src",4,"ngIf"],[1,"chat-image"],[3,"player"],[1,"caption"],[3,"name"],[1,"chat-status"],[1,"controls","visible"],["type","button","class","control-button",3,"tooltip-hint","alertSound","click",4,"ngIf"],["class","league-points-large",4,"ngIf"],["type","button",1,"next","margin-top-small",3,"tooltip-hint","alertSound","click"],["src","assets/img/icons/svg/arrow_right_white.svg",1,"icon"],[1,"texture-border","no-hover"],["draggable","false","image-load","",3,"src"],[3,"src"],[1,"chat-flag-image",3,"src"],["type","button",1,"control-button",3,"tooltip-hint","alertSound","click"],["src","assets/img/icons/svg/add.svg","draggable","false",1,"icon"],[1,"league-points-large"],["class","score",4,"ngIf"],["src","assets/img/icons/svg/rating.svg","image-load","","draggable","false",1,"rank-icon"],["class","difference",3,"positive","negative",4,"ngIf"],[1,"score"],[1,"difference"],[3,"type","value","smallSize"],[1,"xp-text"],[1,"gold",3,"tooltip-hint"],["class","marker",4,"ngIf"],[1,"marker"],[1,"alert-wrapper"],[1,"body"],[3,"title","desc"],["battle-results","","fade-in","",1,"grid-default"],["s-nav",""],["type","button",1,"button","navigation-button",3,"alertSound","tooltip-hint","click"],["class","warning-icon icon",3,"tooltip-hint",4,"ngIf"],["s-header",""],[1,"top-caption"],[1,"table","paddless-all","flexible-table"],[1,"flexible"],[1,"table","paddless-all","info-bar"],[1,"count"],["lass","caption"],["s-tab-summary","",4,"ngIf"],["s-tab-losses","",4,"ngIf"],["s-tab-rewards","",4,"ngIf"],[1,"warning-icon","icon",3,"tooltip-hint"],["src","assets/img/icons/svg/exclamation.svg","draggable","false",1,"icon"],["s-tab-summary",""],[1,"grid-static"],[1,"battle-system-info",3,"tooltip-hint","alertSound","click"],["src","assets/img/icons/svg/copy.svg","draggable","false","alt","icon",1,"icon","action-image"],[1,"copy-feedback"],["src","assets/img/icons/svg/checked_primary.svg","alt","",1,"icon","smaller"],["s-team-header","","class","verticaly-middle",3,"positive","negative",4,"ngFor","ngForOf"],["s-team-content","",4,"ngFor","ngForOf"],["s-team-header","",1,"verticaly-middle"],[1,"row","align-middle"],[1,"col-5"],[1,"skew-progress-wrapper"],[1,"progress-bar","static","skew"],[1,"counter"],[1,"col-7"],[1,"col-2","relative-header",3,"tooltip-hint"],[1,"header-caption"],[1,"icon","larger2","hovered",3,"src"],[1,"col-3",3,"tooltip-hint"],[1,"icon","larger","hovered",3,"src"],[1,"col-2",3,"tooltip-hint"],[1,"header-caption","spaced-right"],["s-team-content",""],[3,"bbox"],[1,"clear","battle-users-list"],["fade-in","down",4,"ngFor","ngForOf"],[1,"team-score"],[1,"row","align-middle","player"],[1,"row","align-middle","align-right"],[1,"caption","spaced-right"],["fade-in","down"],[1,"player","row","align-middle","clickable","positive",3,"alertSound","tooltip-hint"],[1,"col-5",2,"position","relative","padding-right","0"],[1,"chat-item","darken","large-item"],[1,"chat-image",3,"tooltip-hint","click"],[1,"caption",3,"tooltip-hint","click"],["class","player-lobby-team",3,"tooltip-hint",4,"ngIf"],[1,"col-7",2,"position","relative"],[1,"row","align-middle","box-border","align-right"],[1,"col-2"],[1,"relative",3,"tooltip-hint"],[1,"col-3"],[1,"spaced-right"],[1,"player-lobby-team",3,"tooltip-hint"],["s-tab-losses",""],["class","grid-static",4,"ngIf"],["s-column-user",""],[3,"ngTemplateOutlet"],["s-column-table-head",""],[1,"buttons-navigation"],["type","button",1,"button","tab",3,"alertSound","click"],["class","table-head","fade-in","down",4,"ngIf"],["s-column-table-body",""],["class","personal-score","fade-in","down","style","height: 100%",4,"ngIf"],["fade-in","down",1,"table-head"],[1,"table",2,"table-layout","fixed"],[1,"align-left",3,"alertSound","tooltip-hint","click"],[3,"width","sorting-asc","sorting-desc","tooltip-hint","alertSound","click",4,"ngIf"],[3,"tooltip-hint","alertSound","click"],["fade-in","down",1,"personal-score",2,"height","100%"],[3,"bbox",4,"ngIf"],["class","alert simple","style","margin-top: 100px",4,"ngIf"],["scrollable",""],["class","table","style","table-layout: fixed;",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"unit-cell"],[1,"unit-image"],["image-load","",3,"src"],[1,"unit-name"],[3,"innerHTML"],[3,"width","innerHTML",4,"ngIf"],["class","unit-image",4,"ngIf"],[1,"alert","simple",2,"margin-top","100px"],["s-tab-rewards",""],["s-caption","","fade-in","'down'"],[1,"verticaly-middle"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["s-info","","fade-in","'down'"],[1,"characteristics","smaller-right-side"],["draggable","false",1,"icon",3,"src"],["s-rating","","fade-in","'down'",3,"if-bonds",4,"ngIf"],["s-bonds","","fade-in","'down'",3,"if-rating",4,"ngIf"],["s-campaign-currency","","fade-in","'down'",4,"ngIf"],["s-xp","","fade-in","'down'",4,"ngIf"],["s-xp-free","","fade-in","'down'",4,"ngIf"],["s-rating","","fade-in","'down'"],[3,"value","type","animated"],["s-bonds","","fade-in","'down'"],["s-campaign-currency","","fade-in","'down'"],["s-xp","","fade-in","'down'"],["s-xp-free","","fade-in","'down'"]],template:function(t,e){1&t&&(o.Jc(0,Ij,13,8,"ng-template",null,0,o.Kc),o.Jc(2,Ej,23,30,"ng-template",null,1,o.Kc),o.Jc(4,Fj,9,15,"ng-template",null,2,o.Kc),o.Jc(6,Pj,3,2,"div",3),o.Jc(7,BM,35,36,"div",4),o.Rb(8,"div",5),o.Ob(9,"span"),o.Lc(10),o.Qb()),2&t&&(o.Bb(6),o.jc("ngIf",!e.session),o.Bb(1),o.jc("ngIf",e.sessionLoaded&&e.session),o.Bb(1),o.Fb("disabled",e.sessionLoaded),o.Bb(2),o.Mc(e.L("meta.ui.stats.preloader")))},encapsulation:2}),t})();var MM=function(t){return t.Victory="victory",t.Defeat="defeat",t.Draw="draw",t}({});const QM=["unitCompareModal"],AM=["rightUnitCharacteristics"];function DM(t,e){if(1&t&&(o.Rb(0,"h1",6),o.Lc(1),o.Qb(),o.Rb(2,"div",7),o.Lc(3),o.Qb(),o.Rb(4,"div",7),o.Lc(5),o.Qb()),2&t){const t=e.unit,i=o.bc();o.Fb("premium",t.premium),o.kc("tooltip-hint",i.L("unit."+(null==t?null:t.unit)+".short")),o.Bb(1),o.Nc(" ",i.L("unit."+(null==t?null:t.unit)+".short")," "),o.Bb(1),o.Fb("premium",t.premium),o.Bb(1),o.Nc(" ",i.L("unit."+(null==t?null:t.unit)+".type")," "),o.Bb(2),o.Nc(" ",i.L("unit."+(null==t?null:t.unit)+".desc_short").markdown().br()," ")}}function EM(t,e){if(1&t&&(o.Rb(0,"div",8),o.Rb(1,"div",9),o.Rb(2,"details"),o.Rb(3,"summary"),o.Rb(4,"span",10),o.Lc(5),o.Qb(),o.Qb(),o.Rb(6,"div",11),o.Ob(7,"div",12),o.Qb(),o.Qb(),o.Qb(),o.Qb()),2&t){const t=e.unit,i=o.bc();o.Bb(5),o.Mc(i.L("meta.ui.unit.unit_description")),o.Bb(2),o.jc("innerHTML",i.L("unit."+(null==t?null:t.unit)+".desc").markdown().br(),o.Ac)}}function NM(t,e){if(1&t&&(o.Rb(0,"span",10),o.Lc(1),o.Qb()),2&t){const t=o.bc(2).tooltip;o.Bb(1),o.Mc(t.label)}}function FM(t,e){if(1&t&&(o.Rb(0,"div",17),o.Lc(1),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2).tooltip,n=o.bc();o.Fb("positive",i.key&&"advantages"==i.key)("negative",i.key&&"disadvantages"==i.key),o.Bb(1),o.Nc(" ",n.L("meta.ui.unit.unit_props."+i.key+"."+t)," ")}}function PM(t,e){if(1&t&&(o.Rb(0,"div",8),o.Rb(1,"div",9),o.Rb(2,"div",14),o.Lc(3),o.Qb(),o.Rb(4,"details"),o.Rb(5,"summary"),o.Jc(6,NM,2,1,"span",15),o.Qb(),o.Rb(7,"div",11),o.Jc(8,FM,2,5,"div",16),o.Qb(),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc().tooltip;o.Bb(3),o.Mc(t.value.length),o.Bb(3),o.jc("ngIf",t.value&&t.value.length),o.Bb(2),o.jc("ngForOf",t.value)}}function UM(t,e){if(1&t&&o.Jc(0,PM,9,3,"div",13),2&t){const t=e.tooltip;o.jc("ngIf",t.value&&t.value.length&&!t.isRelative)}}const zM=function(t){return{unit:t}};function JM(t,e){if(1&t&&(o.Rb(0,"div",19),o.Pb(1,20),o.Qb()),2&t){const t=o.bc(2),e=o.wc(1);o.Fb("spaced",t.compareModeActive&&t.rightUnit),o.Bb(1),o.jc("ngTemplateOutlet",e)("ngTemplateOutletContext",o.nc(4,zM,t.rightUnit))}}function qM(t,e){if(1&t&&(o.Rb(0,"div",19),o.Ob(1,"unit-characteristics",25,32),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("campaignId",t.campaignId)("campaignCurrency",t.campaignCurrency)("unit",t.rightUnit)("itemIndex",t.itemIndex)}}const VM=function(t){return{tooltip:t}};function $M(t,e){if(1&t&&(o.Rb(0,"div",19),o.Pb(1,20),o.Qb()),2&t){const t=o.bc(3).index,e=o.bc(2),i=o.wc(5);o.Fb("spaced",e.compareModeActive&&e.rightCharacteristics),o.Bb(1),o.jc("ngTemplateOutlet",i)("ngTemplateOutletContext",o.nc(4,VM,e.rightCharacteristics.tooltip[t]))}}function GM(t,e){if(1&t&&(o.Rb(0,"div",34),o.Rb(1,"div",19),o.Pb(2,20),o.Qb(),o.Jc(3,$M,2,6,"div",21),o.Qb()),2&t){const t=o.bc(2).$implicit,e=o.bc(2),i=o.wc(5);o.Bb(1),o.Fb("spaced",e.compareModeActive&&e.rightCharacteristics),o.Bb(1),o.jc("ngTemplateOutlet",i)("ngTemplateOutletContext",o.nc(5,VM,t)),o.Bb(1),o.jc("ngIf",e.compareModeActive&&e.rightCharacteristics)}}function HM(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,GM,4,7,"div",33),o.Qb()),2&t){const t=o.bc(),e=t.$implicit,i=t.index,n=o.bc(2);o.Bb(1),o.jc("ngIf",n.compareModeActive&&n.rightCharacteristics&&n.rightCharacteristics.tooltip[i].value.length||e.value.length)}}function YM(t,e){if(1&t&&(o.Rb(0,"div",30),o.Jc(1,HM,2,1,"div",5),o.Qb()),2&t){const t=e.$implicit;o.Bb(1),o.jc("ngIf",t.value)}}function WM(t,e){if(1&t&&(o.Rb(0,"div",19),o.Rb(1,"div",30),o.Pb(2,20),o.Qb(),o.Qb()),2&t){const t=o.bc(2),e=o.wc(3);o.Fb("spaced",t.compareModeActive&&t.rightCharacteristics),o.Bb(2),o.jc("ngTemplateOutlet",e)("ngTemplateOutletContext",o.nc(4,zM,t.rightUnit))}}const KM=function(t){return{expoLack:t}};function XM(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",38),o.Rb(1,"button",39),o.Yb("click",function(e){o.zc(t);const i=o.bc(3);return i.openUnitInTree(i.leftUnit,e),i.triggerGlobalEvent("button.tech.open_unit",{tutorial:!0})}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc(3);o.kc("tooltip-hint",t.availableToOpenLetfUnit&&t.leftUnit.available?t.L("meta.ui.play.open_troops"):t.availableToOpenLetfUnit&&!t.leftUnit.available?t.L("meta.ui.open_troop.message_open_previous"):t.L("meta.ui.open_troop.message_parent_xp_not_enough",o.nc(7,KM,t.expoLackLeftUnit))),o.Bb(1),o.Fb("red",t.availableToOpenLetfUnit&&t.leftUnit.available)("disabled",!t.availableToOpenLetfUnit||!t.leftUnit.available),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.play.open_troops")," ")}}function ZM(t,e){if(1&t&&(o.Rb(0,"div",35),o.Rb(1,"ul",36),o.Jc(2,XM,3,9,"li",37),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.Bb(2),o.jc("ngIf",!t.compareModeActive&&t.freemiumLetfUnitOpen&&!t.leftUnit.open)}}function tQ(t,e){if(1&t&&(o.Rb(0,"div"),o.Rb(1,"div",18),o.Rb(2,"div",19),o.Pb(3,20),o.Qb(),o.Jc(4,JM,2,6,"div",21),o.Qb(),o.Rb(5,"div",22),o.Rb(6,"scrollable",23),o.Rb(7,"div",24),o.Rb(8,"div",19),o.Ob(9,"unit-characteristics",25,26),o.Qb(),o.Jc(11,qM,3,4,"div",27),o.Qb(),o.Jc(12,YM,2,1,"div",28),o.Rb(13,"div",29),o.Rb(14,"div",19),o.Rb(15,"div",30),o.Pb(16,20),o.Qb(),o.Qb(),o.Jc(17,WM,3,6,"div",21),o.Qb(),o.Qb(),o.Qb(),o.Jc(18,ZM,3,1,"div",31),o.Qb()),2&t){const t=o.wc(10),e=o.bc(),i=o.wc(1),n=o.wc(3);o.Bb(3),o.jc("ngTemplateOutlet",i)("ngTemplateOutletContext",o.nc(17,zM,e.leftUnit)),o.Bb(1),o.jc("ngIf",e.compareModeActive&&e.rightUnit),o.Bb(2),o.jc("bbox",!0)("fade",!0),o.Bb(3),o.jc("campaignId",e.campaignId)("campaignCurrency",e.campaignCurrency)("unit",e.leftUnit)("itemIndex",e.itemIndex),o.Bb(2),o.jc("ngIf",e.rightUnit),o.Bb(1),o.jc("ngForOf",t.tooltip),o.Bb(2),o.Fb("spaced",e.compareModeActive&&e.rightCharacteristics),o.Bb(2),o.jc("ngTemplateOutlet",n)("ngTemplateOutletContext",o.nc(19,zM,e.leftUnit)),o.Bb(1),o.jc("ngIf",e.compareModeActive&&e.rightCharacteristics),o.Bb(1),o.jc("ngIf",!e.compareModeActive&&e.freemiumLetfUnitOpen&&!e.leftUnit.open)}}let eQ=(()=>{class t{constructor(e,i,n){if(this.cache=e,this.host=i,this.router=n,this.rightCharacteristics=null,this.onOpen=new o.o,this.onClose=new o.o,this.campaignId="",this.campaignCurrency="",this.devMode=Object(o.X)(),this.path={full:null,parent:null},this.globalEvent=new uu,this.counters={},this.openedModal=!1,this.activeModal=!1,this.compareModeActive=!1,this.leftUnit=null,this.rightUnit=null,this.expoLackLeftUnit=0,this.availableToOpenLetfUnit=!1,this.freemiumLetfUnitOpen=!1,t.instance)return t.instance;(new al).data.subscribe(t=>this.L=t),(new dl).data.subscribe(t=>this.I=t),this.setState(this.router.url),this.router.events.subscribe(t=>{t instanceof Ci&&this.setState(t.url),t instanceof Li&&this.setState(t.urlAfterRedirects)}),t.instance=this}onClick(t){this.isVisible()||(this.compareClose(),this.compareModeActive=!1)}ngOnInit(){this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>this.counters[t.path]=t.value),this.cache.globalCampaign.pipe(We(t=>null!==t)).subscribe(t=>{this.campaignId=t.id,this.campaignCurrency=t.currency})}ngOnChanges(t){t.campaignId&&(this.campaignId=t.campaignId.currentValue,t.campaignId.currentValue&&this.cache.getCampaign(t.campaignId.currentValue)&&(this.campaignCurrency=this.cache.getCampaign(t.campaignId.currentValue).currency))}setState(t){const e=t.replace(/(^\/|\?.{1,})/gim,""),i=t.replace(/(^\/|\?.{1,}|\/.{1,})/gim,"");this.path={full:e,parent:i}}isVisible(){return!0}bind(t,e){this.campaignId=e,this.isVisible()&&t&&(this.compareModeActive?(this.rightUnit=this.leftUnit&&this.leftUnit.id!=t.id?t:null,this.rightUnit&&this.cache.startLoadingProgress("rightUnitAdded"),setTimeout(()=>{this.cache.stopLoadingProgress("rightUnitAdded")},500)):(this.leftUnit=t,this.availableToOpenLetfUnit=this.cache.isUnitAvailableToOpen(t,this.campaignId),this.freemiumLetfUnitOpen=this.cache.isFreemiumUnitOpen(t),this.expoLackLeftUnit=Math.abs(this.cache.getParentsExpoLack(t,this.campaignId)).cat()),this.compareOpen())}unbind(){this.leftUnit=this.rightUnit=null,this.compareModeActive=!1}compareOpen(){this.unitCompareModal&&!this.unitCompareModal.opened&&(this.unitCompareModal.open(),this.onOpen.emit(this))}compareClose(){this.unitCompareModal.close(),this.onClose.emit(this),this.unbind()}toggleCompareMode(){this.compareModeActive=!this.compareModeActive,this.rightUnit=null,this.compareModeActive?this.unitCompareModal.enableTransparency():this.unitCompareModal.disableTransparency()}openUnitInTree(t,e){t.available&&this.cache.isUnitAvailableToOpen(t,this.campaignId)&&(this.compareClose(),this.cache.openUnitInTree(t.id,this.campaignId))}log(t){this.devMode&&console.log(t)}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(o.m),o.Nb(Ys))},t.\u0275cmp=o.Hb({type:t,selectors:[["unit-compare"]],viewQuery:function(t,e){if(1&t&&(o.Qc($S,!0),o.Qc(QM,!0),o.Qc(AM,!0)),2&t){let t;o.vc(t=o.Zb())&&(e.draggableWindow=t.first),o.vc(t=o.Zb())&&(e.unitCompareModal=t.first),o.vc(t=o.Zb())&&(e.rightCharacteristics=t.first)}},hostBindings:function(t,e){1&t&&o.Yb("click",function(t){return e.onClick(t)},!1,o.xc)},inputs:{campaignId:"campaignId"},outputs:{onOpen:"onOpen",onClose:"onClose"},features:[o.zb],decls:9,vars:2,consts:[["headerTemplate",""],["descriptionTemplate",""],["tooltipListTemplate",""],["id","unitCompareModal",1,"unit-compare-modal",3,"id","onClose"],["unitCompareModal",""],[4,"ngIf"],[1,"title",3,"tooltip-hint"],[1,"caption"],[1,"details-outer"],[1,"item"],[1,"subtitle"],[1,"details-inner"],[1,"list-item","stick-left",3,"innerHTML"],["class","details-outer",4,"ngIf"],[1,"count"],["class","subtitle",4,"ngIf"],["class","list-item",3,"positive","negative",4,"ngFor","ngForOf"],[1,"list-item"],["drag-anchor","",1,"header","cell-cover"],[1,"cell"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","cell",3,"spaced",4,"ngIf"],[1,"body","bordered-bottom","main-body"],[3,"bbox","fade"],[1,"cell-cover","spaced-bottom"],[3,"campaignId","campaignCurrency","unit","itemIndex"],["leftUnitCharacteristics",""],["class","cell",4,"ngIf"],["class","relatives",4,"ngFor","ngForOf"],[1,"cell-cover","spaced-top"],[1,"relatives"],["class","body",4,"ngIf"],["rightUnitCharacteristics",""],["class","cell-cover",4,"ngIf"],[1,"cell-cover"],[1,"body"],[1,"btn-list","clear"],["class","item",3,"tooltip-hint",4,"ngIf"],[1,"item",3,"tooltip-hint"],["type","button",1,"button",3,"alertSound","click"]],template:function(t,e){1&t&&(o.Jc(0,DM,6,8,"ng-template",null,0,o.Kc),o.Jc(2,EM,8,2,"ng-template",null,1,o.Kc),o.Jc(4,UM,1,1,"ng-template",null,2,o.Kc),o.Rb(6,"modal",3,4),o.Yb("onClose",function(){return e.compareClose()}),o.Jc(8,tQ,19,21,"div",5),o.Qb()),2&t&&(o.Bb(6),o.jc("id","unit_compare"),o.Bb(2),o.jc("ngIf",e.leftUnit))},encapsulation:2}),t})();const iQ=["textarea"],nQ=["canvas"];function sQ(t,e){if(1&t&&(o.Rb(0,"option"),o.Lc(1),o.Qb()),2&t){const t=e.$implicit;o.Bb(1),o.Mc(t)}}function aQ(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",16),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc().getUserLevel(i)}),o.Lc(1),o.Qb()}if(2&t){const t=e.$implicit;o.jc("alertSound","ui_click_default"),o.Bb(1),o.Mc(t)}}function rQ(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",16),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc().completeMission(i)}),o.Lc(1),o.Qb()}if(2&t){const t=e.$implicit;o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc("Mis. ",t+1,"")}}function oQ(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",16),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc().completeTaskSequence("RUS_21st_howitzer_artillery_regiment",i)}),o.Lc(1),o.Qb()}if(2&t){const t=e.$implicit;o.jc("alertSound","ui_click_default"),o.Bb(1),o.Mc(t)}}function cQ(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",16),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc().completeTaskSequence("GER_21st_howitzer_artillery_regiment",i)}),o.Lc(1),o.Qb()}if(2&t){const t=e.$implicit;o.jc("alertSound","ui_click_default"),o.Bb(1),o.Mc(t)}}const lQ=function(){return[0,1,2,3]},uQ=function(){return[1,2,3,4,5,6,7]},dQ=function(){return[30,25,20,10]},hQ=function(t){return{is2:t}},bQ=function(t){return[t]},mQ=function(){return[30,60,90,120]};JSON,new yl(10,30),new yl(10,130),new yl(210,10),new yl(210,130),new yl(110,230);let pQ=(()=>{class t{constructor(t,e){this.sanitized=t,this.cache=e,this.tab=gQ.Debug,this.gold=0,this.silver=0,this.xp=0,this.boosters=0,this.leagues=vd(ru),this.league=this.cache.getUser().league?this.cache.getUser().league.id:"",this.counters=["ui.mark.chat.menu","ui.mark.play.menu","ui.mark.troops.menu","ui.mark.tech.menu","ui.mark.play.pve.menu","ui.mark.play.pvp.menu","ui.mark.play.mission.menu","ui.mark.play.campaign.menu","ui.mark.shop.menu","ui.mark.stats.menu","ui.mark.stats.last_battle","ui.mark.task.menu","ui.mark.calendar.menu","ui.mark.xp_exchange","ui.mark.gold_exchange"],this.userLevels=[1,2,3,4,5,6,7,8,9],this.markdownString="",this.moneyBoxSilver=0,this.moneyBoxTimeout=0,this.flags=[],this.loop=[],this.cacheImages=[],this.lastSessionId="";let i=new al;this.L=i.getLanguage(),i.onload(t=>{this.L=i.getLanguage()});for(let n=0;n<100;n++)this.loop.push(n);this.api=this.cache.getAPIUrl()}ngOnInit(){this.flags=this.cache.getUser(!0).scriptData.flags,this.parseMarkdown(),this.gold=this.cache.getUserGold(),this.silver=this.cache.getUserSilver(),this.xp=this.cache.getUserFreeXp(),this.boosters=this.cache.getUnitBoosters()&&this.cache.getUnitBoosters().count||0;let t=this.cache.getMoneyBox();t&&(this.moneyBoxSilver=t.silver||0),this.cache.league.pipe(We(t=>null!==t)).subscribe(t=>{console.log("League changed (editor):",t)});let e=this.canvas.nativeElement.getContext("2d"),i=e.canvas.width,n=e.canvas.height,s=new yl(i/2,n/2),a=()=>{requestAnimationFrame(a),e.clearRect(0,0,i,n);let t=pd.getMousePosition("canvas");t.getMiddleWith(s),t.crossVector(s),t.rotateAroundPivot(s,t.subtract(s).getAngle()),_u.drawCampaignMapArrow(e,s,t,"#ff0000")};a()}dismissTutorial(){Il(`\n\t\t\t${this.api}&cmd=playerSetCounter&key=ui.allow.tutorial&value=0\n\t\t`).then(()=>{this.cache.setCounter("ui.allow.tutorial",1),location.reload()})}setCounter(t){Il(`\n\t\t\t${this.api}&cmd=playerSetCounter&key=${t}&value=1\n\t\t`).then(()=>{this.cache.setCounter(t,1)})}parseMarkdown(){this.textarea&&(this.markdownString=this.textarea.nativeElement.value.markdown())}triggerTransaction(t){this.cache.storeBuyItem(t)}clearDLC(){Il(`\n\t\t\t${this.api}&cmd=playerRemoveDlc&dlcList=preorder,deluxe\n\t\t`).then(()=>{})}addDLC(t){Il(`\n\t\t\t${this.api}&cmd=playerApplyDlc&dlcList=${t}\n\t\t`).then(()=>{})}getUserLevel(t){Il(`\n\t\t\t${this.api}&cmd=playerCompleteTask&task=tutorial.level${t}\n\t\t`).then(()=>{location.reload()})}resetPlayer(){Il(`\n\t\t\t${this.api}&cmd=playerReset\n\t\t`).then(()=>{Il(`\n\t\t\t\t${this.api}&cmd=playerSetCounter&key=map.rus_tank_tutorial.played&value=1\n\t\t\t`).then(()=>{location.reload()})})}wipePlayer(){Il(`\n\t\t\t${this.api}&cmd=playerWipe\n\t\t`).then(()=>{location.reload()})}completeMission(t){Il(`${this.api}&cmd=playerCompleteTask&task=tutorial.mission${t}.complete`).then(()=>{location.reload()})}completeTaskSequence(t,e){Il(`${this.api}&cmd=playerCompleteTask&task=commander.${t}.t${e}`).then(()=>{location.reload()})}applyBoosters(){Il(`${this.api}&cmd=playerSetUnitXpBoosterCount&count=${this.boosters}`).then(t=>{this.cache.getUnitBoosters()?this.cache.setUnitBoosters(Object.assign(Object.assign({},this.cache.getUnitBoosters()),{count:parseInt(this.boosters.toString())})):this.cache.setUnitBoosters({boost:0,limit:5,count:parseInt(this.boosters.toString()),time:null})})}applyMoneyBox(){Il(`${this.api}&cmd=playerSetMoneyBox&silver=${this.moneyBoxSilver}&minutes=${this.moneyBoxTimeout}`).then(t=>{location.reload()})}openMoneyBox(){this.cache.openMoneyBox()}applyCurrency(){Il(`${this.api}&cmd=playerCurrencySet&softGold=${this.gold}&silver=${this.silver}&freeXp=${this.xp}`).then(t=>{this.cache.devMode&&console.log("Currency response: ",t),t.softGold&&this.cache.setUserGold(t.softGold.new),this.gold=t.softGold.new,t.silver&&this.cache.setUserSilver(t.silver.new),this.silver=t.silver.new,t.freeXp&&this.cache.setUserFreeXp(t.freeXp.new),this.xp=t.freeXp.new})}fullscreen(){var t;t="app-root",bd.fullscreenElement?bd.cancelFullScreen?bd.cancelFullScreen():bd.mozCancelFullScreen?bd.mozCancelFullScreen():bd.webkitCancelFullScreen&&bd.webkitCancelFullScreen():bd.querySelector(t).requestFullscreen?bd.querySelector(t).requestFullscreen():bd.querySelector(t).mozRequestFullScreen?bd.querySelector(t).mozRequestFullScreen():bd.querySelector(t).webkitRequestFullscreen&&bd.querySelector(t).webkitRequestFullscreen()}applyLeague(){Il(`${this.api}&cmd=playerLeagueSet&score=1200&id=${this.league}`).then(t=>{this.cache.setUserLeague({id:this.league})})}clearLeague(){Il(this.api+"&cmd=playerLeagueSet&score=1200&id=null").then(t=>{console.log(t),this.cache.setUserLeague({id:this.league})})}playerLeagueGiveoutPrize(){Il(this.api+"&cmd=playerLeagueGiveoutPrize").then(t=>{console.log(t)})}clearPremium(){Il(this.api+"&cmd=playerAddPremium&days=-360").then(t=>{this.cache.setPremium({active:t.result.active,expiresAt:new Date(t.result.expiresAt.$date).getTime()})})}applyPremium(t){Il(`${this.api}&cmd=playerAddPremium&days=${t}`).then(t=>{console.log(t),this.cache.setPremium({active:t.result.active,expiresAt:new Date(t.result.expiresAt.$date).getTime()})})}dummyExeptionMethod(){setTimeout(()=>{document.querySelector("body").classList.add("tolik-videoregistrator"),this.runDummyExeptionMethod()},1e3)}kickMatch(){Il(this.api+"&cmd=playerMatchCancel").then(t=>{})}resetDcBagration(){Il(this.api+"&cmd=playerCampaignRandomizeUnitTree&campaign=dc_bagration&xpLevel=1&openLevel=1&amountLevel=6").then(t=>{location.reload()})}applyLastSession(){Il(`${this.api}&cmd=playerAddLastSession&session=${this.lastSessionId}`).then(t=>{location.reload()})}showGDPR(){window.gdprShowPolicy()}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Er),o.Nb(nd))},t.\u0275cmp=o.Hb({type:t,selectors:[["editor"]],viewQuery:function(t,e){if(1&t&&(o.Fc(iQ,!0),o.Fc(nQ,!0)),2&t){let t;o.vc(t=o.Zb())&&(e.textarea=t.first),o.vc(t=o.Zb())&&(e.canvas=t.first)}},features:[o.Ab([])],decls:233,vars:74,consts:[[1,"grid-default"],["g-tabs-main",""],[1,"button","tab",3,"alertSound","click"],["g-routing","",2,"position","relative"],[1,"grid-default","debug","tab-window"],["fade-in","","d-flags",""],[1,"tile","texture-border"],[1,"tile-content","full-size"],[1,"margin-bottom-small"],[1,"hr"],[1,"grey"],[1,"row","middle-xs","margin-top-small"],[1,"col-9"],["type","text","placeholder","enter session ID to see results",1,"input","small",3,"ngModel","ngModelChange"],[1,"col-3",2,"padding-left","0"],[1,"button","block",3,"alertSound","click"],[1,"button","small",3,"alertSound","click"],["fade-in","","d-reset",""],[1,"row"],[1,"col-6","margin-bottom-small"],["type","text","placeholder","days of premium",1,"input","small"],["premiumDays",""],[1,"col-4",2,"padding-left","0"],[1,"col-12"],["fade-in","","d-currency",""],[1,""],[1,"row","middle-xs","compressed","align-bottom"],[1,"row","compressed","margin-bottom-small"],[1,"col-4"],["type","text","maxlength","9",1,"input","small",3,"ngModel","ngModelChange"],[1,"col-3"],[1,"row","align-bottom","compressed"],["type","text",1,"input","small",3,"ngModel","ngModelChange"],[1,"grey",2,"white-space","nowrap"],["fade-in","","d-leagues",""],[1,"row","compressed","align-bottom"],[1,"col-5"],[1,"input","small",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],[1,"button",3,"alertSound","click"],[1,"align-center"],["fade-in","","d-money",""],["fade-in","","d-transactions",""],[1,"margin-bottom-small","margin-top-small"],["fade-in","","d-tasks",""],[1,"compact-button-pack"],["class","button small",3,"alertSound","click",4,"ngFor","ngForOf"],[1,"grey","margin-top-small"],[1,"grey","margin-bottom-small"],["d-markdown-1",""],[1,"input",2,"height","100%","border","none","background","transparent",3,"input"],["textarea",""],["d-markdown-2",""],[3,"bbox"],[2,"font-size","20px","color","#fff",3,"innerHTML"],["d-canvas",""],[3,"data","distances"],["width","500px","height","1000px",2,"background","#fff"],["canvas",""],[2,"height","32px","width","32px","display","inline-block","position","relative"],[3,"animated"],[2,"height","64px","width","64px","display","inline-block","position","relative"],[2,"height","128px","width","128px","display","inline-block","position","relative"],[2,"height","256px","width","256px","display","inline-block","position","relative"],[2,"height","512px","width","512px","display","inline-block","position","relative"]],template:function(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",0),o.Rb(1,"div",1),o.Rb(2,"button",2),o.Yb("click",function(){return e.tab="debug"}),o.Lc(3,"Debug"),o.Qb(),o.Rb(4,"button",2),o.Yb("click",function(){return e.tab="markdown"}),o.Lc(5,"Markdown"),o.Qb(),o.Rb(6,"button",2),o.Yb("click",function(){return e.tab="canvas"}),o.Lc(7,"Canvas"),o.Qb(),o.Qb(),o.Rb(8,"div",3),o.Rb(9,"div",4),o.Rb(10,"div",5),o.Rb(11,"div",6),o.Rb(12,"div",7),o.Rb(13,"h3",8),o.Lc(14,"Flags"),o.Qb(),o.Lc(15),o.Ob(16,"hr",9),o.Rb(17,"div",10),o.Lc(18,"Set battle id to open next time you enter game"),o.Qb(),o.Rb(19,"div",11),o.Rb(20,"div",12),o.Rb(21,"input",13),o.Yb("ngModelChange",function(t){return e.lastSessionId=t}),o.Qb(),o.Qb(),o.Rb(22,"div",14),o.Rb(23,"button",15),o.Yb("click",function(){return e.applyLastSession()}),o.Lc(24,"Set"),o.Qb(),o.Qb(),o.Qb(),o.Ob(25,"hr",9),o.Rb(26,"button",16),o.Yb("click",function(){return e.showGDPR()}),o.Lc(27,"GDPR window"),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(28,"div",17),o.Rb(29,"div",6),o.Rb(30,"div",7),o.Rb(31,"h3",8),o.Lc(32,"Reset player"),o.Qb(),o.Rb(33,"button",16),o.Yb("click",function(){return e.resetPlayer()}),o.Lc(34,"Reset"),o.Qb(),o.Rb(35,"button",16),o.Yb("click",function(){return e.wipePlayer()}),o.Lc(36,"Wipe"),o.Qb(),o.Rb(37,"button",16),o.Yb("click",function(){return e.dismissTutorial()}),o.Lc(38,"Dismiss tutorial"),o.Qb(),o.Ob(39,"br"),o.Ob(40,"br"),o.Rb(41,"button",16),o.Yb("click",function(){return e.kickMatch()}),o.Lc(42,"Kick match"),o.Qb(),o.Rb(43,"button",16),o.Yb("click",function(){return e.resetDcBagration()}),o.Lc(44,"Reset bagration tree"),o.Qb(),o.Ob(45,"hr",9),o.Rb(46,"h3",8),o.Lc(47,"Premium"),o.Qb(),o.Rb(48,"div",18),o.Rb(49,"div",19),o.Ob(50,"input",20,21),o.Qb(),o.Rb(52,"div",22),o.Rb(53,"button",15),o.Yb("click",function(){o.zc(t);const i=o.wc(51);return e.applyPremium(i.value)}),o.Lc(54,"Apply"),o.Qb(),o.Qb(),o.Rb(55,"div",23),o.Rb(56,"button",16),o.Yb("click",function(){return e.applyPremium(.000115740740741)}),o.Lc(57,"Add 10 sec"),o.Qb(),o.Rb(58,"button",16),o.Yb("click",function(){return e.clearPremium()}),o.Lc(59,"Clear premium"),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(60,"div",24),o.Rb(61,"div",6),o.Rb(62,"div",7),o.Rb(63,"h3",25),o.Lc(64,"Currency"),o.Qb(),o.Rb(65,"div",26),o.Rb(66,"div",23),o.Rb(67,"div",27),o.Rb(68,"div",28),o.Rb(69,"small",10),o.Lc(70,"Gold"),o.Qb(),o.Rb(71,"input",29),o.Yb("ngModelChange",function(t){return e.gold=t}),o.Qb(),o.Qb(),o.Rb(72,"div",28),o.Rb(73,"small",10),o.Lc(74,"Silver"),o.Qb(),o.Rb(75,"input",29),o.Yb("ngModelChange",function(t){return e.silver=t}),o.Qb(),o.Qb(),o.Rb(76,"div",28),o.Rb(77,"small",10),o.Lc(78,"Xp"),o.Qb(),o.Rb(79,"input",29),o.Yb("ngModelChange",function(t){return e.xp=t}),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(80,"div",30),o.Rb(81,"button",15),o.Yb("click",function(){return e.applyCurrency()}),o.Lc(82,"Set"),o.Qb(),o.Qb(),o.Qb(),o.Ob(83,"hr",9),o.Rb(84,"h3",25),o.Lc(85,"Money box"),o.Qb(),o.Rb(86,"div",31),o.Rb(87,"div",30),o.Rb(88,"small",10),o.Lc(89,"Silver"),o.Qb(),o.Rb(90,"input",32),o.Yb("ngModelChange",function(t){return e.moneyBoxSilver=t}),o.Qb(),o.Qb(),o.Rb(91,"div",30),o.Rb(92,"small",33),o.Lc(93,"Timeout (min)"),o.Qb(),o.Rb(94,"input",32),o.Yb("ngModelChange",function(t){return e.moneyBoxTimeout=t}),o.Qb(),o.Qb(),o.Rb(95,"div",30),o.Rb(96,"button",15),o.Yb("click",function(){return e.applyMoneyBox()}),o.Lc(97,"Set"),o.Qb(),o.Qb(),o.Rb(98,"div",30),o.Rb(99,"button",15),o.Yb("click",function(){return e.openMoneyBox()}),o.Lc(100,"Open"),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(101,"div",34),o.Rb(102,"div",6),o.Rb(103,"div",7),o.Rb(104,"h3",8),o.Lc(105,"Leagues"),o.Qb(),o.Rb(106,"div",35),o.Rb(107,"div",36),o.Rb(108,"small",10),o.Lc(109,"Select league"),o.Qb(),o.Rb(110,"select",37),o.Yb("ngModelChange",function(t){return e.league=t}),o.Jc(111,sQ,2,1,"option",38),o.Qb(),o.Qb(),o.Rb(112,"div",30),o.Rb(113,"button",15),o.Yb("click",function(){return e.applyLeague()}),o.Lc(114,"Set"),o.Qb(),o.Qb(),o.Rb(115,"div",28),o.Rb(116,"button",39),o.Yb("click",function(){return e.clearLeague()}),o.Lc(117,"Clear"),o.Qb(),o.Qb(),o.Qb(),o.Ob(118,"hr",9),o.Rb(119,"div",40),o.Rb(120,"button",16),o.Yb("click",function(){return e.playerLeagueGiveoutPrize()}),o.Lc(121,"Add League Prize"),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(122,"div",41),o.Rb(123,"div",6),o.Rb(124,"div",7),o.Rb(125,"h3",8),o.Lc(126,"Boosters"),o.Qb(),o.Rb(127,"div",35),o.Rb(128,"div",28),o.Rb(129,"small",10),o.Lc(130,"Boosters amount"),o.Qb(),o.Rb(131,"input",32),o.Yb("ngModelChange",function(t){return e.boosters=t}),o.Qb(),o.Qb(),o.Rb(132,"div",30),o.Rb(133,"button",15),o.Yb("click",function(){return e.applyBoosters()}),o.Lc(134,"Set"),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(135,"div",42),o.Rb(136,"div",6),o.Rb(137,"div",7),o.Rb(138,"h3",8),o.Lc(139,"Trigger transaction / DLC"),o.Qb(),o.Rb(140,"div",8),o.Lc(141,"Trigger transaction"),o.Qb(),o.Rb(142,"button",16),o.Yb("click",function(){return e.triggerTransaction("unit.id.t34_armored")}),o.Lc(143,"t34_armored"),o.Qb(),o.Rb(144,"button",16),o.Yb("click",function(){return e.triggerTransaction("gold1")}),o.Lc(145,"gold1"),o.Qb(),o.Rb(146,"button",16),o.Yb("click",function(){return e.triggerTransaction("premium1")}),o.Lc(147,"premium1"),o.Qb(),o.Ob(148,"hr",9),o.Rb(149,"div",43),o.Lc(150,"DLC"),o.Qb(),o.Rb(151,"button",16),o.Yb("click",function(){return e.addDLC("preorder")}),o.Lc(152,"Preorder"),o.Qb(),o.Rb(153,"button",16),o.Yb("click",function(){return e.addDLC("standart")}),o.Lc(154,"Standart"),o.Qb(),o.Rb(155,"button",16),o.Yb("click",function(){return e.addDLC("deluxe")}),o.Lc(156,"Deluxe"),o.Qb(),o.Ob(157,"br"),o.Ob(158,"br"),o.Rb(159,"button",16),o.Yb("click",function(){return e.clearDLC()}),o.Lc(160,"Reset all"),o.Qb(),o.Ob(161,"br"),o.Qb(),o.Qb(),o.Qb(),o.Rb(162,"div",44),o.Rb(163,"div",6),o.Rb(164,"div",7),o.Rb(165,"h3",8),o.Lc(166,"Set user level / complete tasks"),o.Qb(),o.Rb(167,"small",10),o.Lc(168,"User level (step by step)"),o.Qb(),o.Rb(169,"div",45),o.Jc(170,aQ,2,2,"button",46),o.Qb(),o.Ob(171,"hr",9),o.Rb(172,"small",10),o.Lc(173,"Complete tutorial"),o.Qb(),o.Rb(174,"div",45),o.Jc(175,rQ,2,2,"button",46),o.Qb(),o.Ob(176,"hr",9),o.Rb(177,"div"),o.Lc(178,"Complete task sequence"),o.Qb(),o.Rb(179,"small",47),o.Lc(180,"RUS_21st_howitzer_artillery_regiment"),o.Qb(),o.Rb(181,"div",45),o.Jc(182,oQ,2,2,"button",46),o.Qb(),o.Rb(183,"small",47),o.Lc(184,"GER_21st_howitzer_artillery_regiment"),o.Qb(),o.Rb(185,"div",45),o.Jc(186,cQ,2,2,"button",46),o.Qb(),o.Ob(187,"hr",9),o.Rb(188,"div"),o.Lc(189,"Fullscreen"),o.Qb(),o.Rb(190,"small",48),o.Lc(191,"Go to fullscreen mode in browser"),o.Qb(),o.Rb(192,"button",16),o.Yb("click",function(){return e.fullscreen()}),o.Lc(193,"Toggle"),o.Qb(),o.Ob(194,"hr",9),o.Rb(195,"div"),o.Lc(196,"\u0415\u043a\u0441\u0435\u043f\u0448\u0435\u043d \u0440\u0435\u043f\u043e\u0440\u0442\u0435\u0440"),o.Qb(),o.Rb(197,"small",48),o.Lc(198,"\u0414\u043b\u044f \u0442\u043e\u0433\u043e, \u0449\u043e\u0431 \u0410\u043d\u0434\u0440\u0454\u0439 \u0432 Sentry \u043d\u0430\u043a\u0438\u0434\u0443\u0432\u0430\u0432 \u0441\u043e\u0431\u0456 \u043f\u043e\u043c\u0438\u043b\u043a\u0438"),o.Qb(),o.Rb(199,"button",16),o.Yb("click",function(){return e.dummyExeptionMethod()}),o.Lc(200,"\u0417\u0430\u0435\u043a\u0441\u0435\u043f\u0448\u0435\u043d\u0438\u0442\u044c"),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(201,"div",4),o.Rb(202,"div",49),o.Rb(203,"div",6),o.Rb(204,"div",7),o.Rb(205,"textarea",50,51),o.Yb("input",function(){return e.parseMarkdown()}),o.Lc(207,"# h1 title\n## h2 title\n### h3 title\n#### h3 title\n\n--\u0440\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435\u043b\u044c--\n<br>\n**bold text** *italic* _italic again_ `monospace font`\n[ol]\n- dfasdfasdfasdfas\n- asdfasdfasdfas\n- sdfasdfasdfasd\n[/ol]\n---\n[ul]\n* sdfasdfasdfasdfasdfas\n+ asdfasdfasdfasdfasdfasdf\n- sdfasdfasdfsdfasdfasdfasdfas\n[/ul]\n\n![assets/img/unit/zis3_trailer(rus).png](\u043a\u0430\u043a\u0430\u044f-\u0442\u043e \u043f\u0443\u043a\u0430\u043b\u043a\u0430)\n\n> Blockquote of some shit\n\n\u044b\u0432\u0444 \u044b\u0432\u0430 \u0444\u044b\u0432\u043e\u043b\u0430 @this is mark@ \u0444\u044b\u0432\u043b\u0430\u043f\u0444\u0440 ada @dsfsdfas@  @asdfasdfas@ \u044b\u0432\u043f\u0430\u043b \u0440\u0444\u044b\u0432 [http://google.com](\u0421\u0446\u044b\u043b\u043a\u0430 \u043d\u0430 \u0433\u0443\u0433\u043b)\u0444 \u044b\u0432\u0430 \u0440\u0444\u044b\u0432\u043e\u0430\u0440 \u0434\u0444\u044b\u0432\u043e\u0430\u0440\u043e\u043b\u0444\u044b\u0432\u0430\u0440\u0434 \u043b\u043e\u0444\u044b\u0432\u0440\u0430\u043e\u043b \u0444\u044b\u0440\u0432\u0430\u043e\u043b \u0440\u0434\u0444\u044b\u0432\u043e\u043b\u0430 \u0444\u044b\n\n![https://www.google.com/images/branding/googlelogo/2x/googlelogo_color_272x92dp.png](\u044d\u0442\u043e \u043a\u043e\u0440\u0442\u0438\u043d\u043a\u043e-\u043d\u043e\u0434\u043f\u0438\u0441\u044c)\n\n(color:primary)Primary color(color:primary)\n\n(color:secondary)Secondary color(color:secondary)\n\n(color:info)Info color(color:info)\n\nteam leaders | John Doe, Martin Gnome, In4eg\nteam|John Doe\n\t\t\t\t\t"),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(208,"div",52),o.Rb(209,"div",6),o.Rb(210,"div",7),o.Rb(211,"scrollable",53),o.Ob(212,"article",54),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(213,"div",4),o.Rb(214,"div",55),o.Rb(215,"div",6),o.Rb(216,"div",7),o.Rb(217,"scrollable",53),o.Rb(218,"div",25),o.Ob(219,"ap-graph",56),o.Qb(),o.Rb(220,"div",25),o.Ob(221,"canvas",57,58),o.Rb(223,"div",59),o.Ob(224,"user-image",60),o.Qb(),o.Rb(225,"div",61),o.Ob(226,"user-image",60),o.Qb(),o.Rb(227,"div",62),o.Ob(228,"user-image",60),o.Qb(),o.Rb(229,"div",63),o.Ob(230,"user-image",60),o.Qb(),o.Rb(231,"div",64),o.Ob(232,"user-image",60),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb()}2&t&&(o.Bb(2),o.Fb("active","debug"===e.tab),o.jc("alertSound","ui_click_default"),o.Bb(2),o.Fb("active","markdown"===e.tab),o.jc("alertSound","ui_click_default"),o.Bb(2),o.Fb("active","canvas"===e.tab),o.jc("alertSound","ui_click_default"),o.Bb(3),o.Fb("tab-active","debug"===e.tab),o.Bb(6),o.Nc(" [",e.flags.join(", "),"] "),o.Bb(6),o.jc("ngModel",e.lastSessionId),o.Bb(2),o.jc("alertSound","ui_click_default"),o.Bb(3),o.jc("alertSound","ui_click_default"),o.Bb(7),o.jc("alertSound","ui_click_default"),o.Bb(2),o.jc("alertSound","ui_click_default"),o.Bb(2),o.jc("alertSound","ui_click_default"),o.Bb(4),o.jc("alertSound","ui_click_default"),o.Bb(2),o.jc("alertSound","ui_click_default"),o.Bb(10),o.jc("alertSound","ui_click_default"),o.Bb(3),o.jc("alertSound","ui_click_default"),o.Bb(2),o.jc("alertSound","ui_click_default"),o.Bb(13),o.jc("ngModel",e.gold),o.Bb(4),o.jc("ngModel",e.silver),o.Bb(4),o.jc("ngModel",e.xp),o.Bb(2),o.jc("alertSound","ui_click_default"),o.Bb(9),o.jc("ngModel",e.moneyBoxSilver),o.Bb(4),o.jc("ngModel",e.moneyBoxTimeout),o.Bb(2),o.jc("alertSound","ui_click_default"),o.Bb(3),o.jc("alertSound","ui_click_default"),o.Bb(11),o.jc("ngModel",e.league),o.Bb(1),o.jc("ngForOf",e.leagues),o.Bb(2),o.jc("alertSound","ui_click_default"),o.Bb(3),o.jc("alertSound","ui_click_default"),o.Bb(4),o.jc("alertSound","ui_click_default"),o.Bb(11),o.jc("ngModel",e.boosters),o.Bb(2),o.jc("alertSound","ui_click_default"),o.Bb(9),o.jc("alertSound","ui_click_default"),o.Bb(2),o.jc("alertSound","ui_click_default"),o.Bb(2),o.jc("alertSound","ui_click_default"),o.Bb(5),o.jc("alertSound","ui_click_default"),o.Bb(2),o.jc("alertSound","ui_click_default"),o.Bb(2),o.jc("alertSound","ui_click_default"),o.Bb(4),o.jc("alertSound","ui_click_default"),o.Bb(11),o.jc("ngForOf",e.userLevels),o.Bb(5),o.jc("ngForOf",o.mc(65,lQ)),o.Bb(7),o.jc("ngForOf",o.mc(66,uQ)),o.Bb(4),o.jc("ngForOf",o.mc(67,uQ)),o.Bb(6),o.jc("alertSound","ui_click_default"),o.Bb(7),o.jc("alertSound","ui_click_default"),o.Bb(2),o.Fb("tab-active","markdown"===e.tab),o.Bb(10),o.jc("bbox",!0),o.Bb(1),o.jc("innerHTML",e.markdownString,o.Ac),o.Bb(1),o.Fb("tab-active","canvas"===e.tab),o.Bb(4),o.jc("bbox",!0),o.Bb(2),o.jc("data",o.nc(71,bQ,o.nc(69,hQ,o.mc(68,dQ))))("distances",o.mc(73,mQ)),o.Bb(5),o.jc("animated",!0),o.Bb(2),o.jc("animated",!0),o.Bb(2),o.jc("animated",!0),o.Bb(2),o.jc("animated",!0),o.Bb(2),o.jc("animated",!0))},encapsulation:2}),t})();var gQ=function(t){return t.Debug="debug",t.Markdown="markdown",t.Canvas="canvas",t}({});const fQ=function(){return["/multiplayer/main"]};function vQ(t,e){if(1&t){const t=o.Sb();o.Rb(0,"a",6),o.Yb("click",function(){return o.zc(t),o.bc().triggerGlobalEvent("button.navigation.back")}),o.Rb(1,"span",7),o.Ob(2,"img",8),o.Ob(3,"img",9),o.Qb(),o.Lc(4),o.Qb()}if(2&t){const t=o.bc();o.kc("tooltip-hint",t.L("meta.ui.play.back")),o.jc("routerLink",o.mc(4,fQ))("alertSound","ui_back"),o.Bb(4),o.Nc(" ",t.L("meta.ui.play.back"),"\n")}}function yQ(t,e){if(1&t&&(o.Rb(0,"div",10),o.Rb(1,"h1"),o.Lc(2),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(2),o.Mc(t.L("meta.ui.menu.tasks"))}}const _Q=function(){return{hover:"ui_hover_default",click:"ui_click_default"}};function kQ(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",18),o.Rb(1,"task",19),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(4).setActiveTask(i)}),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=e.index,n=o.bc(4);o.Cb("fade-in",i<12?"down":null),o.Bb(1),o.Fb("active",t.id==n.activeTask.id),o.jc("task",t)("campaignId",n.campaignId)("displayTyle",!0)("alertSound",o.mc(8,_Q)),o.Cb("task-id",t.id)}}function wQ(t,e){if(1&t&&(o.Rb(0,"div",15),o.Rb(1,"h3",16),o.Lc(2),o.Qb(),o.Jc(3,kQ,2,9,"div",17),o.cc(4,"filterList"),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(2);o.Bb(2),o.Nc(" ",e.L("meta.ui.play.tasks."+t)," "),o.Bb(1),o.jc("ngForOf",o.fc(4,2,e.tasks,"category",t))}}function SQ(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,wQ,5,6,"div",14),o.cc(2,"filterList"),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2);o.Bb(1),o.jc("ngIf",o.fc(2,1,i.tasks,"category",t).length)}}function IQ(t,e){if(1&t&&(o.Rb(0,"scrollable",11,12),o.Jc(2,SQ,3,5,"div",13),o.Qb()),2&t){const t=o.bc();o.jc("bbox",!0)("fade",!0),o.Bb(2),o.jc("ngForOf",t.categories)}}function CQ(t,e){if(1&t&&o.Ob(0,"empty",20),2&t){const t=o.bc();o.jc("subtitle",t.L("meta.ui.menu.tasks"))("desc",t.L("meta.ui.play.tasks.empty_message"))}}function LQ(t,e){if(1&t&&o.Ob(0,"rewards",24,25),2&t){const t=o.bc(2);o.jc("rewards",t.activeTask.reward)("taskSequencePrice",t.sequenceResultPrice)("appearance","column")("campaignId",t.campaignId)}}function RQ(t,e){if(1&t&&(o.Rb(0,"div",21),o.Rb(1,"scrollable",22,12),o.Jc(3,LQ,2,4,"rewards",23),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Fb("campaign-position",t.campaignId)("with-map",t.campaignHasMap),o.Bb(1),o.jc("bbox",!0)("fade",!0)("origin","left"),o.Bb(2),o.jc("ngIf",t.activeTask&&t.activeTask.reward)}}JSON;let OQ=(()=>{class t{constructor(t,e,i,n,s,a,r){this.notificatorService=t,this.cache=e,this.tasksService=i,this.router=n,this.activetedRoute=s,this.visitService=a,this.cdr=r,this.globalEvent=new uu,this.campaignModeActive=!1,this.campaignId="",this.globalSelectedCampaign=null,this.tasks=[],this.activeTask=null,this.categories=[],this.campaignHasMap=!1,this.campaignId=this.activetedRoute.snapshot.params.campaignId,(new al).data.subscribe(t=>this.L=t)}ngAfterViewChecked(){this.cdr.detectChanges()}ngOnInit(){this.getTasks(),this.tasks&&this.tasks.length&&this.setActiveTask(this.tasks[0]),this.onContainerOpenSubscription=this.tasksService.onContainerOpen.pipe(We(t=>null!==t)).subscribe(t=>{t&&t.taskTemplate&&(this.getTasks(),this.tasks&&this.tasks.length&&this.setActiveTask(this.tasks[0]))})}ngOnDestroy(){this.visitSubscription&&this.visitSubscription.unsubscribe()}void(){}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}setActiveTask(t){t&&(this.activeTask=t)}getTasks(t){this.campaignId?(this.tasks=this.tasksService.getTasksForCampaign(this.campaignId),this.categories=[TQ.Progress,TQ.Commander,TQ.Unit,TQ.Special],this.globalSelectedCampaign=this.cache.getGlobalCampaign(),this.campaignHasMap=this.globalSelectedCampaign&&this.globalSelectedCampaign.phase&&this.globalSelectedCampaign.phase.length):(this.tasks=this.tasksService.getTasks(),this.categories=[xQ.Commander,xQ.Unit,xQ.League,xQ.Trial,xQ.ThisDay,xQ.ThisWeek,xQ.Special])}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Uc),o.Nb(nd),o.Nb(Tl),o.Nb(Ys),o.Nb(xn),o.Nb(Sl),o.Nb(o.h))},t.\u0275cmp=o.Hb({type:t,selectors:[["tasks"]],hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("grid-default",!0)},features:[o.Ab([nd,Tl,Sl])],decls:6,vars:5,consts:[["href","","queryParamsHandling","merge","g-back","","class","button white",3,"routerLink","tooltip-hint","alertSound","click",4,"ngIf"],["g-tasks-title-main","",4,"ngIf"],["g-tasks-main",""],["style","height: 100%",3,"bbox","fade",4,"ngIf"],[3,"subtitle","desc",4,"ngIf"],["g-tasks-detail","",3,"campaign-position","with-map",4,"ngIf"],["href","","queryParamsHandling","merge","g-back","",1,"button","white",3,"routerLink","tooltip-hint","alertSound","click"],[1,"icon-group"],["src","assets/img/icons/svg/back-button-icon.svg","draggable","false",1,"icon","hover-hidden"],["src","assets/img/icons/svg/back-button-icon_hover.svg","draggable","false",1,"icon","hover-visible"],["g-tasks-title-main",""],[2,"height","100%",3,"bbox","fade"],["scrollable",""],[4,"ngFor","ngForOf"],["class","spaced-bottom-larger",4,"ngIf"],[1,"spaced-bottom-larger"],[1,"spaced-bottom"],["class","task-inline",4,"ngFor","ngForOf"],[1,"task-inline"],[3,"task","campaignId","displayTyle","alertSound","click"],[3,"subtitle","desc"],["g-tasks-detail",""],[2,"height","99%",3,"bbox","fade","origin"],[3,"rewards","taskSequencePrice","appearance","campaignId",4,"ngIf"],[3,"rewards","taskSequencePrice","appearance","campaignId"],["rewardsComponent",""]],template:function(t,e){1&t&&(o.Jc(0,vQ,5,5,"a",0),o.Jc(1,yQ,3,1,"div",1),o.Rb(2,"div",2),o.Jc(3,IQ,3,3,"scrollable",3),o.Jc(4,CQ,1,2,"empty",4),o.Qb(),o.Jc(5,RQ,4,8,"div",5)),2&t&&(o.jc("ngIf",!e.campaignId),o.Bb(1),o.jc("ngIf",!e.campaignId),o.Bb(2),o.jc("ngIf",e.tasks&&e.tasks.length),o.Bb(1),o.jc("ngIf",!e.tasks||!e.tasks.length),o.Bb(1),o.jc("ngIf",e.tasks&&e.tasks.length))},encapsulation:2}),t})();var TQ=function(t){return t.Commander="commander",t.Unit="unit",t.Progress="progress",t.Special="special",t}({}),xQ=function(t){return t.ThisDay="this_day",t.ThisWeek="this_week",t.Special="special",t.Trial="trial",t.Commander="commander",t.League="league",t.Unit="unit",t}({});const BQ=["scrollable"];function jQ(t,e){if(1&t&&(o.Rb(0,"span",10),o.Lc(1),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.Oc("order:\t",t.display_order,", id: ",t.id,"")}}function MQ(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div"),o.Jc(1,jQ,2,2,"span",8),o.Rb(2,"task",9),o.Yb("mouseenter",function(i){o.zc(t);const n=e.$implicit;return o.bc(2).showTaskSequense(i,n)})("mouseleave",function(){return o.zc(t),o.bc(2).hideTaskSequense()})("onFinish",function(i){o.zc(t);const n=e.$implicit,s=e.index;return o.bc(2).onTaskFinished(i,n,s)}),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=e.index,n=o.bc(2);o.Cb("fade-in",i<12?"down":null),o.Bb(1),o.jc("ngIf",n.hasFlag("debug")),o.Bb(1),o.Fb("active",n.taskId===t.id)("premium-required",!n.tasksService.isFreemimTaskOpen(t)),o.jc("task",t)("campaignId",n.campaignId),o.Cb("task-id",t.id)}}function QQ(t,e){1&t&&o.Ob(0,"div",11)}function AQ(t,e){if(1&t&&(o.Rb(0,"div",2),o.Rb(1,"scrollable",3,4),o.Rb(3,"div",5),o.Jc(4,MQ,3,9,"div",6),o.Jc(5,QQ,1,0,"div",7),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("bbox",!0)("fade",!0),o.Bb(3),o.jc("ngForOf",t.tasks),o.Bb(1),o.jc("ngForOf",t.fakes)}}function DQ(t,e){if(1&t&&(o.Rb(0,"div",12),o.Rb(1,"div",13),o.Rb(2,"div",14),o.Rb(3,"div",15),o.Lc(4),o.Qb(),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(4),o.Mc(t.L("meta.ui.play.tasks.empty_message"))}}const EQ=/play\/campaigns\/(?<campaignId>.*?)\//,NQ=window.innerHeight/2;let FQ=(()=>{class t{constructor(t,e,i,n){this.cache=t,this.tasksService=e,this.activatedRoute=i,this.visitService=n,this._tasks=[],this._newTasksLoading=!1,this.tasks=[],this.fakes=[],this.type="",this.taskId="",this.timeout=null,this.campaignId="",(new al).data.subscribe(t=>this.L=t)}ngOnInit(){this.activatedRouteSubscription=this.activatedRoute.paramMap.subscribe(t=>{this.type=t.params.type,this.taskId=t.params.taskId;let e=new RegExp(EQ,"gim").exec(location.href);if(e&&e.groups.campaignId&&(this.campaignId=e.groups.campaignId),this._markTaskVisited(),this.campaignId)return this._tasks=this.tasksService.getTasksForCampaign(this.campaignId,this.type),this.tasks=this._tasks.slice(0,9),console.log(this._tasks),this.loadTaskBuckets(),void this.checkAndScrollToSelectedTask();this._tasks=this.tasksService.getTasks(null,this.type).filter(t=>"task"===t.type),this.tasks=this._tasks.slice(0,9),this.loadTaskBuckets(),this.appendFakes(),this.cache.devMode&&console.log(`Tasks for ${this.campaignId?"campaign "+this.campaignId:""} "${this.type}"`,this._tasks),this.checkAndScrollToSelectedTask()})}checkAndScrollToSelectedTask(){setTimeout(()=>{console.log(this.taskId,document.querySelector(`[task-id*="${this.taskId}"]`)),this.scrollable&&this.taskId&&this.scrollable.scrollToMiddlePoint(`[task-id*="${this.taskId}"]`)},1e3)}loadTaskBuckets(){setTimeout(()=>{let t=setInterval(()=>{this.tasks.length<this._tasks.length?this._addTasksBucket():clearInterval(t)},10)},300)}appendFakes(){if(!this.tasks.length)return;this.fakes=[];let t=3-this.tasks.length%3;if(this.tasks.length%3!=0)for(let e=0;e<t;e++)this.fakes.push(t)}ngOnDestroy(){this.activatedRouteSubscription&&this.activatedRouteSubscription.unsubscribe(),this._markTaskVisited()}_markTaskVisited(){let t=[];for(let e=0;e<this._tasks.length;e++){let i=this._tasks[e];t.push(`task_${i.task.taskTemplate}_${i.task.id}`)}this.visitService.visit(t)}onScroll(t){document.querySelector(".tile-layout > div"),this.tasks.length>=this._tasks.length||t.scroll.top>=t.scroll.maxTop-NQ&&!this._newTasksLoading&&(this._newTasksLoading=!0,this._addTasksBucket(),setTimeout(()=>{this._newTasksLoading=!1},50))}_addTasksBucket(){let t=this._tasks.slice(this.tasks.length,this.tasks.length+6);this.tasks=this.tasks.concat(t)}onTaskFinished(t,e,i){this.tasks.splice(this.tasks.findIndex(t=>t.id===e.id),1),this._tasks.splice(this.tasks.findIndex(t=>t.id===e.id),1)}hasFlag(t){return this.cache.hasFlag(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Tl),o.Nb(xn),o.Nb(Sl))},t.\u0275cmp=o.Hb({type:t,selectors:[["tasks-list"]],viewQuery:function(t,e){if(1&t&&o.Qc(BQ,!0),2&t){let t;o.vc(t=o.Zb())&&(e.scrollable=t.first)}},features:[o.Ab([nd,Tl,Sl])],decls:2,vars:2,consts:[["class","tile-layout-wrapper",4,"ngIf"],["class","store-wrapper","style","height: 50%",4,"ngIf"],[1,"tile-layout-wrapper"],[2,"height","100%",3,"bbox","fade"],["scrollable",""],[1,"tile-layout"],[4,"ngFor","ngForOf"],["class","fake",4,"ngFor","ngForOf"],["style","position: absolute; top: -1.3em; left: 0;",4,"ngIf"],[3,"task","campaignId","mouseenter","mouseleave","onFinish"],[2,"position","absolute","top","-1.3em","left","0"],[1,"fake"],[1,"store-wrapper",2,"height","50%"],[1,"verticaly-middle"],[1,"inner","align-center"],[1,"alert","simple"]],template:function(t,e){1&t&&(o.Jc(0,AQ,6,4,"div",0),o.Jc(1,DQ,5,1,"div",1)),2&t&&(o.jc("ngIf",e.tasks.length),o.Bb(1),o.jc("ngIf",!e.tasks.length))},encapsulation:2}),t})();function PQ(t,e){if(1&t&&o.Ob(0,"img",15),2&t){const t=o.bc(2);o.jc("src","assets/img/flags/campaign_"+t.task.flag+".png",o.Cc)}}function UQ(t,e){if(1&t&&(o.Rb(0,"div",16),o.Rb(1,"div",17),o.Lc(2),o.Qb(),o.Rb(3,"div",18),o.Lc(4),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.lc("tooltip-hint","",t.currentCount.cat()," / ",t.targetCount.cat(),""),o.Bb(2),o.Mc(t.currentCount.cat()),o.Bb(2),o.Nc("/ ",t.targetCount.cat(),"")}}function zQ(t,e){1&t&&(o.Rb(0,"div"),o.Lc(1,"100%"),o.Qb())}function JQ(t,e){if(1&t&&(o.Rb(0,"div",19),o.Ob(1,"span"),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Cb("style","width: "+t.progressPersent+"%",o.Bc)}}function qQ(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",20),o.Yb("click",function(){return o.zc(t),o.bc(2).complete()}),o.Ob(1,"img",21),o.Qb()}2&t&&o.jc("alertSound","ui_click_default")}const VQ=function(t,e){return{current:t,target:e}};function $Q(t,e){if(1&t&&(o.Rb(0,"div",1),o.Jc(1,PQ,1,1,"img",2),o.Rb(2,"div",3),o.Rb(3,"div",4),o.Rb(4,"div",5),o.Rb(5,"h3",6),o.Lc(6),o.Qb(),o.Rb(7,"div",7),o.Lc(8),o.Qb(),o.Qb(),o.Qb(),o.Rb(9,"div",8),o.Jc(10,UQ,5,4,"div",9),o.Jc(11,zQ,2,0,"div",10),o.Qb(),o.Rb(12,"div",11),o.Rb(13,"div",12),o.Jc(14,JQ,2,1,"div",13),o.Qb(),o.Qb(),o.Qb(),o.Jc(15,qQ,2,1,"button",14),o.Qb()),2&t){const t=o.bc();o.kc("tooltip-hint","<h4>"+t.L("meta.task."+t.task.task.taskTemplate+".short")+"</h4>"+t.L("meta.task."+t.task.task.taskTemplate+".desc",o.oc(8,VQ,t.progress.current.cat(),t.progress.target.cat()))),o.Bb(1),o.jc("ngIf",t.task.flag),o.Bb(5),o.Mc(t.L("meta.task."+t.task.task.taskTemplate+".short")),o.Bb(2),o.Nc(" ",t.L("meta.task."+t.task.task.taskTemplate+".desc",o.oc(11,VQ,t.currentCount.cat(),t.targetCount.cat()))," "),o.Bb(2),o.jc("ngIf",t.progressPersent<100),o.Bb(1),o.jc("ngIf",t.progressPersent>=100),o.Bb(3),o.jc("ngIf",t.currentCount||t.targetCount),o.Bb(1),o.jc("ngIf",t.hasFlag("autotest"))}}let GQ=(()=>{class t{constructor(t,e,i,n){this.host=t,this.tasksService=e,this.cache=i,this.visitService=n,this.timeTo="",this.currentCount=0,this.targetCount=0,this.rewards=[],this.progress=null,this.progressPersent=0,this.onRelease=new o.o,this.onFinish=new o.o,(new al).data.subscribe(t=>this.L=t)}getHint(){return this.task?this.task.army?"":this.L("meta.hint.store.buy_cat")+" "+this.task.gold.cat()+" GOLD":""}ngOnInit(){this.task&&this.task.task&&this.task.task.id&&(this.progress=this.tasksService.getTaskProgress(this.task.task.id),this.currentCount=this.progress.current,this.targetCount=this.progress.target),this.progressPersent=Math.min(100,this.getProgressPersent());let t=this.task&&this.task.task?this.tasksService.getReward(this.task.task.container||this.task.container,this.task.id):null;this.rewards=t||[],this.rewards.find(t=>"commanderDiscount"===t.key),this.rewards.find(t=>"unit"===t.key)}ngOnDestroy(){}getProgressPersent(){let t=0;return t=Math.ceil(this.currentCount/this.targetCount*100),t}getProgress(){return 0===this.targetCount?0:Math.min(this.currentCount/this.targetCount,1)}isVisited(){return this.visitService.isVisited(`task_${this.task.task.taskTemplate}_${this.task.task.id}`)}hasFlag(t){return this.cache.hasFlag(t)}complete(){this.tasksService.completeTask(this.task.task.id,this.task.id),this.onFinish.next({})}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m),o.Nb(Tl),o.Nb(nd),o.Nb(Sl))},t.\u0275cmp=o.Hb({type:t,selectors:[["task"]],inputs:{task:"task",campaignId:"campaignId",displayTyle:"displayTyle"},outputs:{onRelease:"onRelease",onFinish:"onFinish"},features:[o.Ab([nd,Tl,Sl])],decls:1,vars:1,consts:[["class","texture-border task-inner",3,"tooltip-hint",4,"ngIf"],[1,"texture-border","task-inner",3,"tooltip-hint"],["class","flag-image loaded",3,"src",4,"ngIf"],[1,"row","align-bottom"],[1,"col-8"],[1,"task-top"],[1,"title"],[1,"description"],[1,"col-4","align-right"],["class","task-progress progress",3,"tooltip-hint",4,"ngIf"],[4,"ngIf"],[1,"col-12"],[1,"progress-cover"],["class","progress-bar active static",4,"ngIf"],["class","button","tooltip-hint","Complete Task Only For Debug","style","position: absolute; z-index: 4; top: 0; right: 0;",3,"alertSound","click",4,"ngIf"],[1,"flag-image","loaded",3,"src"],[1,"task-progress","progress",3,"tooltip-hint"],[1,"top"],[1,"bottom"],[1,"progress-bar","active","static"],["tooltip-hint","Complete Task Only For Debug",1,"button",2,"position","absolute","z-index","4","top","0","right","0",3,"alertSound","click"],["src","assets/img/icons/svg/bug.svg","alt","",1,"icon"]],template:function(t,e){1&t&&o.Jc(0,$Q,16,14,"div",0),2&t&&o.jc("ngIf",e.task)},encapsulation:2}),t})();function HQ(t,e){if(1&t&&o.Ob(0,"img",8),2&t){const t=o.bc();o.jc("src","assets/img/flags/campaign_"+t.task.flag+".png",o.Cc)}}const YQ=function(t,e){return{current:t,target:e}};let WQ=(()=>{class t{constructor(t,e,i,n){this.host=t,this.tasksService=e,this.cache=i,this.visitService=n,this.currentCount=0,this.targetCount=0,this.levels=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],this.progress=null,this.sequence=null,this.sequenceResultPrice=null,this.progressPersent=0,(new al).data.subscribe(t=>this.L=t)}getHint(){return this.task?this.task.army?"":this.L("meta.hint.store.buy_cat")+" "+this.task.gold.cat()+" GOLD":""}ngOnInit(){this.task&&this.task.task&&this.task.task.id&&(this.progress=this.tasksService.getTaskProgress(this.task.task.id),this.currentCount=this.progress.current,this.targetCount=this.progress.target),this.progressPersent=Math.min(100,this.getProgressPersent())}getProgressPersent(){let t=0;return t=Math.ceil(this.currentCount/this.targetCount*100),t}getProgress(){return 0===this.targetCount?0:Math.min(this.currentCount/this.targetCount,1)}hasFlag(t){return this.cache.hasFlag(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.m),o.Nb(Tl),o.Nb(nd),o.Nb(Sl))},t.\u0275cmp=o.Hb({type:t,selectors:[["task-compact"]],inputs:{task:"task"},features:[o.Ab([nd,Tl,Sl])],decls:11,vars:9,consts:[["class","flag-image loaded",3,"src",4,"ngIf"],[1,"progress-item"],[1,"row","align-bottom",2,"margin-bottom","var(--unit-list-gutter)"],[1,"col-11"],[1,"description"],[1,"col-1"],[1,"badge"],[1,"progress-bar","static"],[1,"flag-image","loaded",3,"src"]],template:function(t,e){1&t&&(o.Jc(0,HQ,1,1,"img",0),o.Rb(1,"div",1),o.Rb(2,"div",2),o.Rb(3,"div",3),o.Rb(4,"div",4),o.Lc(5),o.Qb(),o.Qb(),o.Rb(6,"div",5),o.Rb(7,"span",6),o.Lc(8),o.Qb(),o.Qb(),o.Qb(),o.Rb(9,"div",7),o.Ob(10,"span"),o.Qb(),o.Qb()),2&t&&(o.jc("ngIf",e.task.flag),o.Bb(1),o.Fb("spaced-left",e.task.flag),o.Bb(4),o.Nc(" ",e.L("meta.task."+e.task.task.taskTemplate+".desc",o.oc(6,YQ,e.progress.current.cat(),e.progress.target.cat()))," "),o.Bb(3),o.Nc("",e.progressPersent,"%"),o.Bb(2),o.Cb("style","width: "+e.progressPersent+"%",o.Bc))},directives:[ee],encapsulation:2}),t})(),KQ=(()=>{class t{constructor(t,e,i,n,s,a,r){this.links=[{url:"summary",private:!1,disabled:!1},{url:"preferences",private:!0,disabled:!1},{url:"sessions",private:!1,disabled:!1},{url:"achievements",private:!1,disabled:!1},{url:"troops",private:!0,disabled:!1},{url:"rating",private:!0,disabled:!1},{url:"leagues",private:!0,disabled:!1}],this.counters={},this.globalEvent=new uu,this.id="",this.sessionId="",this.rating="",this.userId="",this.data={},this.isLoaded=!1,this.isError=!1,this.unitTypes=["art_basic","art_aa","art_at","inf_basic","inf_heavy","inf_mortar","inf_apc","inf_spec","tnk_basic","tnk_light","tnk_heavy"],this.url="",this.sortBy=Nx.bind(this),this.authenticationService=t,this.notificatorService=e,this.router=i,this.activatedRoute=n,this.cache=s,this.visitService=a,this.profileService=r,(new al).data.subscribe(t=>this.L=t),this.userId=this.cache.getUserId(),this.globalEvent.subscribe(t=>{t&&"profile.onload"===t.key&&setTimeout(()=>{this.onProfileLoad()},10)})}checkDisabledLinksRedirect(){let t=this.links.find(t=>t.url===this.activatedRoute.routeConfig.path);t&&t.disabled&&(this.cache.devMode&&console.log("redirecting to /summary since "+t.url+" is disabled in config"),this.cache.redirect(["profile",this.id,"summary"]))}fetchInitialParameters(){let t=this.activatedRoute.params.value.id;!this.id&&t&&(this.id=t);let e=this.activatedRoute.queryParams.value.session;!this.sessionId&&e&&(this.sessionId=e);let i=this.activatedRoute.queryParams.value.rating;!this.rating&&i&&(this.rating=i),this.checkDisabledLinksRedirect()}fetchParameters(){this.id=this.activatedRoute.params.value.id,this.sessionId=this.activatedRoute.queryParams.value.session,this.rating=this.activatedRoute.queryParams.value.rating}fetchProfileData(){this.isLoaded=!1,this.isError=!1,this.profileService.getPlayerProfile(this.id).subscribe(t=>{this.data=t,this.isLoaded=!0,this.isError=!1,this.globalEvent.trigger("profile.onload")},t=>{this.data={},this.isLoaded=!0,this.isError=!0,this.globalEvent.trigger("profile.onerror"),this.notificatorService.push({response:t})})}void(){}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e||null)}getValue(t){return Iu(this.data,t)}isUserPlayer(){return this.id===this.userId}ngOnInit(){this.fetchInitialParameters(),this.fetchProfileData(),this.url=this.router.url,this.routerSubscription=this.router.events.subscribe(t=>{t instanceof Li&&(this.url=t.url)}),this.activatedRouteSubscription=this.activatedRoute.paramMap.subscribe(t=>{t.params.id!==this.id&&(this.id=t.params.id,this.fetchParameters(),this.fetchProfileData())})}goToProfile(t,e){let i=this.router.createUrlTree(["profile",t,"summary"],{queryParamsHandling:"merge",queryParams:e||{}});this.router.navigateByUrl(i)}isUrlMatch(t){return!!this.url.match(new RegExp(t,"gim"))}onProfileLoad(){}}return t.instances=[],t.\u0275fac=function(e){return new(e||t)(o.Nb(Gc),o.Nb(Uc),o.Nb(Ys),o.Nb(xn),o.Nb(nd),o.Nb(Sl),o.Nb(Ou))},t.\u0275cmp=o.Hb({type:t,selectors:[["ng-component"]],inputs:{id:"id",sessionId:"sessionId",rating:"rating"},decls:0,vars:0,template:function(t,e){},encapsulation:2}),t})();const XQ=function(t){return[t]};function ZQ(t,e){if(1&t&&(o.Rb(0,"a",6),o.Rb(1,"span",7),o.Ob(2,"img",8),o.Ob(3,"img",9),o.Qb(),o.Lc(4),o.Qb()),2&t){const t=o.bc();o.kc("tooltip-hint",t.L("meta.ui.play.back")),o.jc("routerLink",o.nc(5,XQ,"/profile/"+t.userId+"/rating"))("alertSound","ui_back")("key-duplicator",27),o.Bb(4),o.Nc(" ",t.L("meta.ui.play.back")," ")}}const tA=function(){return["/multiplayer/main"]};function eA(t,e){if(1&t&&(o.Rb(0,"a",6),o.Rb(1,"span",7),o.Ob(2,"img",8),o.Ob(3,"img",9),o.Qb(),o.Lc(4),o.Qb()),2&t){const t=o.bc();o.kc("tooltip-hint",t.L("meta.ui.play.back")),o.jc("routerLink",o.mc(5,tA))("alertSound","ui_back")("key-duplicator",27),o.Bb(4),o.Nc(" ",t.L("meta.ui.play.back")," ")}}function iA(t,e){if(1&t){const t=o.Sb();o.Rb(0,"span"),o.Rb(1,"a",11),o.Yb("click",function(){o.zc(t);const e=o.bc().$implicit;return o.bc().triggerGlobalEvent("button.navigation.profile."+e.url,{tutorial:!0})}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc().$implicit,e=o.bc();o.Bb(1),o.Fb("active",e.isUrlMatch("/profile/(.*?)/"+t.url))("disabled",!e.isUserPlayer()&&t.private),o.kc("tooltip-hint",e.L("meta.hint.profile.menu."+t.url)),o.jc("routerLink",o.nc(9,XQ,"/profile/"+e.id+"/"+t.url))("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L("meta.ui.profile.menu."+t.url)),o.Bb(1),o.Nc(" ",e.L("meta.ui.profile.menu."+t.url)," ")}}function nA(t,e){if(1&t&&o.Ob(0,"span",12),2&t){const t=o.bc().$implicit,e=o.bc();o.Cb("data-value",e.counters[t.url])}}function sA(t,e){if(1&t&&(o.Rb(0,"span"),o.Jc(1,iA,3,11,"span",5),o.Jc(2,nA,1,1,"span",10),o.Qb()),2&t){const t=e.$implicit,i=o.bc();o.Bb(1),o.jc("ngIf",!t.disabled),o.Bb(1),o.jc("ngIf",i.counters[t.url])}}function aA(t,e){1&t&&o.Ob(0,"router-outlet")}JSON;let rA=(()=>{class t extends KQ{constructor(t,e,i,n,s,a,r){super(t,e,i,n,s,a,r),this.counters={},this.counters=this.cache.getCounters(),this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>{this.counters[t.path]=t.value})}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Gc),o.Nb(Uc),o.Nb(Ys),o.Nb(xn),o.Nb(nd),o.Nb(Sl),o.Nb(Ou))},t.\u0275cmp=o.Hb({type:t,selectors:[["profile"]],hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("loaded",e.isLoaded)},features:[o.Ab([Ou]),o.yb],decls:7,vars:4,consts:[[1,"grid-default"],["g-back","","href","","queryParamsHandling","merge","routerLinkActive","active","class","button white ",3,"routerLink","tooltip-hint","alertSound","key-duplicator",4,"ngIf"],["g-tabs-main",""],[4,"ngFor","ngForOf"],["g-routing",""],[4,"ngIf"],["g-back","","href","","queryParamsHandling","merge","routerLinkActive","active",1,"button","white",3,"routerLink","tooltip-hint","alertSound","key-duplicator"],[1,"icon-group"],["src","assets/img/icons/svg/back-button-icon.svg","draggable","false",1,"icon","hover-hidden"],["src","assets/img/icons/svg/back-button-icon_hover.svg","draggable","false",1,"icon","hover-visible"],["class","marker",4,"ngIf"],["href","","queryParamsHandling","merge","seek-link","",1,"button","tab",3,"routerLink","tooltip-hint","alertSound","click"],[1,"marker"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Jc(1,ZQ,5,7,"a",1),o.Jc(2,eA,5,6,"a",1),o.Rb(3,"div",2),o.Jc(4,sA,3,2,"span",3),o.Qb(),o.Rb(5,"div",4),o.Jc(6,aA,1,0,"router-outlet",5),o.Qb(),o.Qb()),2&t&&(o.Bb(1),o.jc("ngIf",!e.isUserPlayer()),o.Bb(1),o.jc("ngIf",e.isUserPlayer()),o.Bb(2),o.jc("ngForOf",e.links),o.Bb(2),o.jc("ngIf",e.isLoaded))},encapsulation:2}),t})();function oA(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",10),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(2),s=o.bc();return s.setFilter("status",i),n.hide(),s.triggerGlobalEvent("button.profile.achievement_status."+i)}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Fb("active",i.filter.status===t),o.Bb(1),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L("meta.ui.profile.achievements.status."+t)),o.Bb(1),o.Nc(" ",i.L("meta.ui.profile.achievements.status."+t)," ")}}function cA(t,e){1&t&&(o.Rb(0,"span"),o.Lc(1,"\u2191"),o.Qb())}function lA(t,e){1&t&&(o.Rb(0,"span"),o.Lc(1,"\u2193"),o.Qb())}function uA(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li"),o.Rb(1,"button",10),o.Yb("click",function(){o.zc(t);const i=e.$implicit;o.bc();const n=o.wc(6),s=o.bc();return s.sortBy("title"===i||"status"===i?"!"+i:i),n.hide(),s.triggerGlobalEvent("button.profile.achievement_sorting."+i)}),o.Lc(2),o.Jc(3,cA,2,0,"span",11),o.Jc(4,lA,2,0,"span",11),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Fb("active",i.isSortingActive(t)),o.Bb(1),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",i.L("meta.ui.profile.achievements.status."+t)),o.Bb(1),o.Nc(" ",i.sortingLabels[t]," "),o.Bb(1),o.jc("ngIf",i.sortingKey===t),o.Bb(1),o.jc("ngIf",i.sortingKey==="!"+t)}}function dA(t,e){if(1&t&&(o.Rb(0,"div",3),o.Rb(1,"dropdown",4,5),o.Rb(3,"ul",6),o.Jc(4,oA,3,5,"li",7),o.Qb(),o.Qb(),o.Rb(5,"dropdown",8,9),o.Rb(7,"ul",6),o.Jc(8,uA,5,7,"li",7),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("text",t.L("meta.ui.profile.achievements.status."+t.filter.status))("label",t.L("meta.ui.profile.achievements.status.label"))("origin","bottom"),o.Bb(3),o.jc("ngForOf",t.filtersKeys.status),o.Bb(1),o.jc("text",t.sortingLabels[t.sortingKey])("label",t.L("meta.ui.profile.preferences.sorting.label"))("origin","bottom"),o.Bb(3),o.jc("ngForOf",t.sortingKeys)}}function hA(t,e){if(1&t){const t=o.Sb();o.Rb(0,"figure",35),o.Rb(1,"img",36),o.Yb("error",function(){o.zc(t);const e=o.bc().$implicit;return o.bc(4).setImageFallback(e,"no-image")}),o.Qb(),o.Qb()}if(2&t){const t=o.bc().$implicit;o.Bb(1),o.jc("src","assets/img/achievements/"+t.icon+".png",o.Cc)}}function bA(t,e){if(1&t&&(o.Rb(0,"div",37),o.Rb(1,"div",38),o.Lc(2),o.Qb(),o.Rb(3,"div",39),o.Lc(4),o.Qb(),o.Qb()),2&t){const t=o.bc().$implicit;o.lc("tooltip-hint","",t.progress.current.cat()," / ",t.progress.target.cat(),""),o.Bb(2),o.Mc(t.progress.current.cat()),o.Bb(2),o.Nc("/ ",t.progress.target.cat(),"")}}function mA(t,e){if(1&t&&(o.Rb(0,"div",40),o.Rb(1,"div",41),o.Ob(2,"img",42),o.Qb(),o.Lc(3),o.Qb()),2&t){const t=o.bc(5);o.Bb(3),o.Nc(" ",t.L("meta.ui.profile.achievements.status.completed")," ")}}function pA(t,e){if(1&t&&(o.Rb(0,"div",43),o.Rb(1,"div",44),o.Rb(2,"div",45),o.Ob(3,"span"),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(3),o.Ic("width","completed"==t.status?"100%":100*t.progressValue+"%")}}function gA(t,e){if(1&t&&(o.Rb(0,"li",21),o.Rb(1,"div",22),o.Rb(2,"div",23),o.Rb(3,"div",24),o.Jc(4,hA,2,1,"figure",25),o.Qb(),o.Rb(5,"div",26),o.Rb(6,"div",27),o.Rb(7,"div",28),o.Rb(8,"div",29),o.Rb(9,"h4",30),o.Lc(10),o.Qb(),o.Rb(11,"div"),o.Lc(12),o.Qb(),o.Qb(),o.Qb(),o.Rb(13,"div",31),o.Jc(14,bA,5,4,"div",32),o.Jc(15,mA,4,1,"div",33),o.Qb(),o.Jc(16,pA,4,2,"div",34),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=o.bc(4);o.Fb("disabled","idle"==t.status),o.jc("alertSound","ui_click_default"),o.Bb(4),o.jc("ngIf",t.icon),o.Bb(2),o.jc("ngClass","completed"==t.status?"align-middle":"align-bottom"),o.Bb(2),o.Fb("premium-required",!i.profileService.isFreemiumAchievementOpen(t)),o.kc("tooltip-hint",i.getAchievementTooltip(t)),o.jc("ngClass",t.status),o.Bb(2),o.Mc(t.title),o.Bb(2),o.Mc(t.desc),o.Bb(2),o.jc("ngIf","active"==t.status&&t.progress),o.Bb(1),o.jc("ngIf","completed"==t.status),o.Bb(1),o.jc("ngIf","idle"!==t.status&&"completed"!==t.status)}}function fA(t,e){if(1&t&&(o.Rb(0,"div",15),o.Rb(1,"scrollable",17,18),o.Rb(3,"ul",19),o.Jc(4,gA,17,14,"li",20),o.cc(5,"sortList"),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.jc("bbox",!0)("fade",!0),o.Bb(3),o.jc("ngForOf",o.ec(5,3,t.data,t.sortingKey))}}function vA(t,e){if(1&t&&o.Ob(0,"empty",46),2&t){const t=o.bc(3);o.jc("title",t.L("meta.ui.profile.menu.achievements"))("desc",t.L("meta.ui.profile.section_empty.desc"))}}function yA(t,e){if(1&t&&(o.Rb(0,"div",15),o.Jc(1,fA,6,6,"div",13),o.Jc(2,vA,1,2,"empty",16),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("ngIf",t.id==t.userId||!t.open||t.open&&t.open.player&&t.open.requestor),o.Bb(1),o.jc("ngIf",!t.data||!t.data.length)}}const _A=function(t){return{time:t}};function kA(t,e){if(1&t&&o.Ob(0,"empty",47),2&t){const t=o.bc(2);o.jc("desc",t.open.time?t.L("meta.ui.stats.closed_requestor_time",o.nc(1,_A,t.timeout)):t.L("meta.ui.stats.closed_requestor"))}}function wA(t,e){if(1&t&&o.Ob(0,"empty",47),2&t){const t=o.bc(2);o.jc("desc",t.L("meta.ui.stats.closed_player"))}}function SA(t,e){if(1&t&&(o.Rb(0,"div",12),o.Jc(1,yA,3,2,"div",13),o.Jc(2,kA,1,3,"empty",14),o.Jc(3,wA,1,1,"empty",14),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf",t.data&&t.data.length),o.Bb(1),o.jc("ngIf",t.id!=t.userId&&t.open&&(!t.open.requestor||0==t.open.requestor)),o.Bb(1),o.jc("ngIf",t.id!=t.userId&&t.open&&(!t.open.player||0==t.open.player)&&t.open.requestor)}}JSON;let IA=(()=>{class t extends KQ{constructor(t,e,i,n,s,a,r){super(t,e,i,n,s,a,r),this.filter={status:su.All,type:eu.All},this.filterVariants={status:fd(su),type:fd(eu)},this.filtersKeys={status:vd(su),type:vd(eu)},this.sortingKeys=["status","title","progressValue"],this.sortingLabels={status:this.L("meta.ui.profile.achievements.status.label"),title:this.L("meta.ui.profile.stats.achievement.title"),progressValue:this.L("meta.ui.profile.stats.achievement.progress"),"!status":this.L("meta.ui.profile.achievements.status.label"),"!title":this.L("meta.ui.profile.stats.achievement.title"),"!progressValue":this.L("meta.ui.profile.stats.achievement.progress")},this.sortingKey="!status",this.open=null,this.timeout=""}fetchProfileData(){this.isLoaded=!1,this.data=this.setImages(this.profileService.getAchievements(this.id,this.filter)),this.cache.devMode&&console.log(this.data),this.isLoaded=!0,this.open=this.profileService.getProfileOpen(this.id),this.open&&this.open.time&&(this.timeout=this.profileService.setTimeoutTick(this.open.time))}setFilter(t,e){this.filter[t]=this.filterVariants[t][e],this.fetchProfileData()}getAchievementTooltip(t){let e=t.desc;return`<div class="subheader2">${t.title}</div></br>`+(this.profileService.isFreemiumAchievementOpen(t)?"idle"==t.status?t.chain_order<=1?this.L("meta.hint.achievement.in_progress").br():this.L("meta.hint.achievement.idle").br():"completed"==t.status?this.L("meta.hint.achievement.completed").br():e:this.L("meta.hint.achievement.premium_required").br())}isSortingActive(t){return t.substr(-3)===this.sortingKey.substr(-3)}setImages(t){return t&&t.length?(t.map(t=>{t.icon=t.achievementData&&t.achievementData.taskTemplate?t.achievementData.taskTemplate:""}),t):[]}setImageFallback(t,e){t.icon=e}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Gc),o.Nb(Uc),o.Nb(Ys),o.Nb(xn),o.Nb(nd),o.Nb(Sl),o.Nb(Ou))},t.\u0275cmp=o.Hb({type:t,selectors:[["profile-achievements"]],hostVars:4,hostBindings:function(t,e){2&t&&o.Fb("typical-profile-page",!0)("grid-default",!0)},features:[o.Ab([Ou]),o.yb],decls:4,vars:4,consts:[[1,"preloader","small","bold"],["g-achievements-filter","","fade","'down'",4,"ngIf"],["g-achievements","",4,"ngIf"],["g-achievements-filter","","fade","'down'"],[3,"text","label","origin"],["statusDropdown",""],[1,"clear"],[3,"active",4,"ngFor","ngForOf"],[1,"margin-top",3,"text","label","origin"],["sortingDropdown",""],[1,"button","transparent","block",3,"alertSound","click"],[4,"ngIf"],["g-achievements",""],["style","height: 100%",4,"ngIf"],["class","spaced-top",3,"desc",4,"ngIf"],[2,"height","100%"],[3,"title","desc",4,"ngIf"],[1,"wide-fade",3,"bbox","fade"],["battlesScrollable",""],[1,"clear","profile-achievements-list"],[3,"alertSound","disabled",4,"ngFor","ngForOf"],[3,"alertSound"],[1,"texture-border","static"],[1,"row","align-middle"],[1,"col-2"],["class","image-contain",4,"ngIf"],[1,"col-10"],[1,"row",3,"ngClass"],[1,"col-8"],[1,"achievement-element",3,"ngClass","tooltip-hint"],[1,"achievement-title"],[1,"col-4","align-right"],["class","progress task-progress",3,"tooltip-hint",4,"ngIf"],["class","completed-text",4,"ngIf"],["class","col-12",4,"ngIf"],[1,"image-contain"],["image-load","",3,"src","error"],[1,"progress","task-progress",3,"tooltip-hint"],[1,"top"],[1,"bottom"],[1,"completed-text"],[1,"completed-badge"],["src","assets/img/icons/svg/checked_dark.svg","alt","icon","image-load","",1,"icon"],[1,"col-12"],[1,"progress-cover"],[1,"progress-bar","active","static"],[3,"title","desc"],[1,"spaced-top",3,"desc"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Ob(1,"span"),o.Qb(),o.Jc(2,dA,9,8,"div",1),o.Jc(3,SA,4,3,"div",2)),2&t&&(o.Fb("disabled",e.isLoaded),o.Bb(2),o.jc("ngIf",e.isLoaded),o.Bb(1),o.jc("ngIf",e.isLoaded))},encapsulation:2}),t})();function CA(t,e){if(1&t&&(o.Rb(0,"div",20),o.Ob(1,"span"),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(4);o.Bb(1),o.Hc("width: ",e.getPercentage(t),"%")}}function LA(t,e){if(1&t&&(o.Rb(0,"div"),o.Rb(1,"div",14),o.Rb(2,"div",15),o.Rb(3,"div",16),o.Rb(4,"h5"),o.Lc(5),o.Qb(),o.Qb(),o.Rb(6,"div",17),o.Rb(7,"span",18),o.Lc(8),o.Qb(),o.Qb(),o.Qb(),o.Jc(9,CA,2,3,"div",19),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=o.bc(4);o.Bb(2),o.kc("tooltip-hint",i.L("meta.ui.profile.preferences.battle")+": "+t.data[0]+"/"+t.max[0]+"<br>"+i.getPercentage(t)+"%"),o.Bb(3),o.Mc(i.L("commander."+t.id+".name")),o.Bb(3),o.Mc(t.data[0]),o.Bb(1),o.jc("ngIf",!t.title)}}function RA(t,e){if(1&t&&(o.Rb(0,"div"),o.Rb(1,"h3"),o.Lc(2),o.Qb(),o.Jc(3,LA,10,4,"div",12),o.Qb()),2&t){const t=o.bc(),e=t.index,i=t.$implicit,n=o.bc(2);o.Fb("spaced-top-larger",e>0),o.Bb(2),o.Mc(n.L("meta.ui.menu.nation."+i)),o.Bb(1),o.jc("ngForOf",n.data.battles[2].commandersFiltered[i])}}function OA(t,e){if(1&t&&(o.Rb(0,"li"),o.Jc(1,RA,4,4,"div",13),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2);o.Bb(1),o.jc("ngIf",i.data.battles[2].commandersFiltered&&i.data.battles[2].commandersFiltered[t]&&i.data.battles[2].commandersFiltered[t].length)}}function TA(t,e){if(1&t&&(o.Rb(0,"scrollable",9,10),o.Rb(2,"ul",11),o.Jc(3,OA,2,1,"li",12),o.Qb(),o.Qb()),2&t){const t=o.bc();o.jc("bbox",!0)("fade",!0),o.Bb(3),o.jc("ngForOf",t.commandersNations)}}function xA(t,e){if(1&t&&o.Ob(0,"empty",21),2&t){const t=o.bc();o.jc("desc",t.L("meta.ui.profile.preferences.army_empty"))("centered",!1)}}function BA(t,e){if(1&t&&(o.Rb(0,"li"),o.Rb(1,"div",22),o.Rb(2,"div",23),o.Rb(3,"div",24),o.Rb(4,"h5",25),o.Lc(5),o.Qb(),o.Qb(),o.Rb(6,"div",26),o.Rb(7,"h3"),o.Lc(8),o.Qb(),o.Qb(),o.Qb(),o.Ob(9,"img",27),o.Rb(10,"div",20),o.Ob(11,"span"),o.Qb(),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2);o.Bb(5),o.Nc("",i.getPercentage(t),"%"),o.Bb(3),o.Mc(i.L("meta.ui.menu.nation."+t.id)),o.Bb(1),o.jc("src","assets/img/flags/campaign_"+t.id+".png",o.Cc),o.Bb(2),o.Hc("width: ",i.getPercentage(t),"%")}}function jA(t,e){if(1&t&&(o.Rb(0,"ul",11),o.Jc(1,BA,12,6,"li",12),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngForOf",t.data.battles[0].data)}}function MA(t,e){if(1&t&&o.Ob(0,"empty",21),2&t){const t=o.bc();o.jc("desc",t.L("meta.ui.profile.preferences.army_empty"))("centered",!1)}}function QA(t,e){if(1&t&&(o.Rb(0,"li"),o.Rb(1,"div",22),o.Rb(2,"div",23),o.Rb(3,"div",24),o.Rb(4,"h5",25),o.Lc(5),o.Qb(),o.Qb(),o.Rb(6,"div",26),o.Rb(7,"h3"),o.Lc(8),o.Qb(),o.Qb(),o.Qb(),o.Rb(9,"div",20),o.Ob(10,"span"),o.Qb(),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2);o.Bb(5),o.Nc("",i.getPercentage(t),"%"),o.Bb(3),o.Mc(i.L("meta.ui.commander.type."+t.id)),o.Bb(2),o.Hc("width: ",i.getPercentage(t),"%")}}function AA(t,e){if(1&t&&(o.Rb(0,"ul",11),o.Jc(1,QA,11,5,"li",12),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngForOf",t.data.battles[1].data)}}function DA(t,e){if(1&t&&o.Ob(0,"empty",21),2&t){const t=o.bc();o.jc("desc",t.L("meta.ui.profile.preferences.army_empty"))("centered",!1)}}JSON;let EA=(()=>{class t extends KQ{constructor(t,e,i,n,s,a,r){super(t,e,i,n,s,a,r),this.filter={sorting:Zl.Default,selection:Xl.All},this.filterVariants={selection:fd(Xl),sorting:fd(Zl)},this.filtersKeys={selection:vd(Xl),sorting:vd(Zl)},this.commandersNations=[]}fetchProfileData(){this.isLoaded=!1,this.data=this.profileService.getPlayerPreferences(this.id,this.filter),this.cache.devMode&&console.log(this.data),this.isLoaded=!0,this.setCommandersNations()}setFilter(t,e){this.filter[t]=this.filterVariants[t][e],this.fetchProfileData()}getPercentage(t){return Math.round(t.data[0]/t.max[0]*100)}setCommandersNations(){this.data.battles.length&&this.data.battles[2]&&this.data.battles[2].commandersFiltered&&(this.commandersNations=Object.keys(this.data.battles[2].commandersFiltered))}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Gc),o.Nb(Uc),o.Nb(Ys),o.Nb(xn),o.Nb(nd),o.Nb(Sl),o.Nb(Ou))},t.\u0275cmp=o.Hb({type:t,selectors:[["profile-preferences"]],hostVars:4,hostBindings:function(t,e){2&t&&o.Fb("typical-profile-page",!0)("grid-default",!0)},features:[o.Ab([Ou]),o.yb],decls:20,vars:11,consts:[[1,"preloader","small","bold"],["g-pref-batallion","","fade-in","down",1,"tile","texture-border","no-hover"],[1,"tile-content","full-size"],[1,"margin-bottom-small"],["style","height: calc(100% - var(--margin))",3,"bbox","fade",4,"ngIf"],[3,"desc","centered",4,"ngIf"],["g-pref-alligeiance","","fade-in","down","delay",".1",1,"tile","texture-border","no-hover"],["class","clear profile-preference-list",4,"ngIf"],["g-pref-type","","fade-in","down","delay",".2",1,"tile","texture-border","no-hover"],[2,"height","calc(100% - var(--margin))",3,"bbox","fade"],["scrollable",""],[1,"clear","profile-preference-list"],[4,"ngFor","ngForOf"],[3,"spaced-top-larger",4,"ngIf"],[1,"progress-item"],[1,"row",2,"margin-bottom","var(--unit-list-gutter)",3,"tooltip-hint"],[1,"col-11"],[1,"col-1"],[1,"badge"],["class","progress-bar static",4,"ngIf"],[1,"progress-bar","static"],[3,"desc","centered"],[1,"progress-item","wide"],[1,"row","align-middle",2,"margin-bottom","var(--unit-list-gutter)"],[1,"col-3"],[2,"font-size","calc(var(--h4-font-size) * 1.2)"],[1,"col-9","align-right"],[1,"army-flag",3,"src"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Ob(1,"span"),o.Qb(),o.Rb(2,"div",1),o.Rb(3,"div",2),o.Rb(4,"h3",3),o.Lc(5),o.Qb(),o.Jc(6,TA,4,3,"scrollable",4),o.Jc(7,xA,1,2,"empty",5),o.Qb(),o.Qb(),o.Rb(8,"div",6),o.Rb(9,"div",2),o.Rb(10,"h3",3),o.Lc(11),o.Qb(),o.Jc(12,jA,2,1,"ul",7),o.Jc(13,MA,1,2,"empty",5),o.Qb(),o.Qb(),o.Rb(14,"div",8),o.Rb(15,"div",2),o.Rb(16,"h3",3),o.Lc(17),o.Qb(),o.Jc(18,AA,2,1,"ul",7),o.Jc(19,DA,1,2,"empty",5),o.Qb(),o.Qb()),2&t&&(o.Fb("disabled",e.isLoaded),o.Bb(5),o.Mc(e.data.battles[2].label),o.Bb(1),o.jc("ngIf",e.data&&e.data.battles[2]&&e.data.battles[2].data&&e.data.battles[2].data.length),o.Bb(1),o.jc("ngIf",!e.data||!e.data.battles[2]||!e.data.battles[2].data.length),o.Bb(4),o.Mc(e.data.battles[0].label),o.Bb(1),o.jc("ngIf",e.data&&e.data.battles[0]&&e.data.battles[0].data&&e.data.battles[0].data.length),o.Bb(1),o.jc("ngIf",!e.data||!e.data.battles[0]||!e.data.battles[0].data.length),o.Bb(4),o.Mc(e.data.battles[1].label),o.Bb(1),o.jc("ngIf",e.data&&e.data.battles[1]&&e.data.battles[1].data&&e.data.battles[1].data.length),o.Bb(1),o.jc("ngIf",!e.data||!e.data.battles[1]||!e.data.battles[1].data.length))},encapsulation:2}),t})();JSON;const NA=function(t){return{league:t,default:!0}};function FA(t,e){if(1&t&&(o.Rb(0,"div",30),o.Rb(1,"div",31),o.Rb(2,"h3"),o.Lc(3),o.Qb(),o.Qb(),o.Rb(4,"div",31),o.Rb(5,"div",32),o.Ob(6,"user-image",33),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.Bb(3),o.Nc(" ",t.L("meta.ui.league."+t.leagueId+".short")," "),o.Bb(3),o.jc("player",o.nc(3,NA,t.leagueId))("animated",!0)}}function PA(t,e){if(1&t&&o.Ob(0,"empty",34),2&t){const t=o.bc(2);o.jc("desc",t.L("meta.ui.league.waiting_message"))}}function UA(t,e){if(1&t&&o.Ob(0,"empty",34),2&t){const t=o.bc(2);o.jc("desc",t.L("meta.ui.league.waiting_message_not_user"))}}const zA=function(t){return{time:t}};function JA(t,e){if(1&t&&o.Ob(0,"empty",35),2&t){const t=o.bc(2);o.jc("desc",t.open.time?t.L("meta.ui.stats.closed_requestor_time",o.nc(1,zA,t.timeout)):t.L("meta.ui.stats.closed_requestor"))}}function qA(t,e){if(1&t&&o.Ob(0,"empty",35),2&t){const t=o.bc(2);o.jc("desc",t.L("meta.ui.stats.closed_player"))}}function VA(t,e){if(1&t&&o.Ob(0,"profile-summary-table",36),2&t){const t=o.bc(2);o.jc("data",t.data)}}const $A=function(t){return[t]},GA=function(){return{session:null}};function HA(t,e){if(1&t&&(o.Rb(0,"div",15),o.Rb(1,"div",16),o.Rb(2,"a",17),o.Rb(3,"span",18),o.Ob(4,"img",19),o.Qb(),o.Qb(),o.Ob(5,"profile-hero",20),o.Qb(),o.Rb(6,"div",21),o.Rb(7,"div",22),o.Jc(8,FA,7,5,"div",23),o.Jc(9,PA,1,1,"empty",24),o.Jc(10,UA,1,1,"empty",24),o.Qb(),o.Qb(),o.Rb(11,"div",25),o.Rb(12,"scrollable",26,27),o.Jc(14,JA,1,3,"empty",28),o.Jc(15,qA,1,1,"empty",28),o.Jc(16,VA,1,1,"profile-summary-table",29),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(2),o.Fb("disabled",!t.sessionBelongsToPlayer),o.jc("routerLink",t.sessionBelongsToPlayer?o.nc(19,$A,"/profile/"+t.userId+"/avatar"):t.void())("queryParams",o.mc(21,GA))("alertSound","ui_click_default"),o.Bb(1),o.Fb("editable",t.sessionBelongsToPlayer),o.Bb(2),o.jc("data",t.data)("id",t.id)("achievements",3)("hideRank",!(t.id==t.userId||!t.open||t.open.requestor&&0!=t.open.requestor&&t.open.player&&0!=t.open.player)),o.Bb(3),o.jc("ngIf",t.isLoadedParts&&t.isLoadedParts.league),o.Bb(1),o.jc("ngIf",!(t.isLoadedParts&&t.isLoadedParts.league||t.id!=t.userId)),o.Bb(1),o.jc("ngIf",!(t.isLoadedParts&&t.isLoadedParts.league||t.id===t.userId)),o.Bb(2),o.jc("bbox",!0)("fade",!0),o.Bb(2),o.jc("ngIf",t.id!=t.userId&&t.open&&(!t.open.requestor||0==t.open.requestor)),o.Bb(1),o.jc("ngIf",t.id!=t.userId&&t.open&&(!t.open.player||0==t.open.player)&&t.open.requestor),o.Bb(1),o.jc("ngIf",t.id==t.userId||!t.open||t.open&&t.open.player&&t.open.requestor)}}function YA(t,e){if(1&t){const t=o.Sb();o.Rb(0,"figure",43),o.Rb(1,"img",44),o.Yb("error",function(){o.zc(t);const e=o.bc(2).$implicit;return o.bc(2).setImageFallback(e,"no-image")}),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2).$implicit,e=o.bc(2);o.kc("tooltip-hint",e.getTooltip(t)),o.Bb(1),o.jc("src",t.hidden&&1==t.hidden?"assets/img/achievements/no-image.png":"assets/img/achievements/"+t.achievementData.taskTemplate+".png",o.Cc)}}function WA(t,e){if(1&t&&(o.Rb(0,"div",41),o.Jc(1,YA,2,2,"figure",42),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.jc("ngIf",t.achievementData)}}function KA(t,e){if(1&t&&(o.Rb(0,"div",39),o.Jc(1,WA,2,1,"div",40),o.Qb()),2&t){const t=e.$implicit;o.Fb("hidden",t.hidden),o.Bb(1),o.jc("ngIf",!t.hidden)}}function XA(t,e){if(1&t&&(o.Rb(0,"div",37),o.Jc(1,KA,2,3,"div",38),o.cc(2,"reverse"),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngForOf",o.dc(2,1,t.achievements))}}function ZA(t,e){if(1&t&&o.Ob(0,"empty",45),2&t){const t=o.bc();o.jc("centered",!1)("desc",t.L(t.userId==t.id?"meta.ui.stats.table.no_achievements":"meta.ui.profile.section_empty.message"))}}function tD(t,e){if(1&t&&o.Ob(0,"img",58),2&t){const t=o.bc().$implicit;o.jc("src","assets/img/flags/campaign_"+t.army+".png",o.Cc)}}function eD(t,e){if(1&t&&o.Ob(0,"div",59),2&t){const t=o.bc(3);o.kc("tooltip-hint",t.L("meta.ui.stats.victory"))}}function iD(t,e){if(1&t&&o.Ob(0,"div",60),2&t){const t=o.bc(3);o.kc("tooltip-hint",t.L("meta.ui.stats.draw"))}}function nD(t,e){if(1&t&&o.Ob(0,"div",61),2&t){const t=o.bc(3);o.kc("tooltip-hint",t.L("meta.ui.stats.defeat"))}}function sD(t,e){if(1&t&&(o.Rb(0,"li",39),o.Jc(1,tD,1,1,"img",49),o.Rb(2,"div",50),o.Rb(3,"div",51),o.Rb(4,"h5",52),o.Lc(5),o.Qb(),o.Rb(6,"small",53),o.Lc(7),o.Qb(),o.Qb(),o.Rb(8,"div",54),o.Jc(9,eD,1,1,"div",55),o.Jc(10,iD,1,1,"div",56),o.Jc(11,nD,1,1,"div",57),o.Qb(),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2);o.Bb(1),o.jc("ngIf",t.army),o.Bb(4),o.Mc(t.commanderTemplate?i.L("commander."+t.commanderTemplate+".name"):"\xa0"),o.Bb(2),o.Oc("",i.L("meta.ui.stats.mode."+t.game.mode)," / ",i.L("meta.mission."+t.game.mapId+".name"),""),o.Bb(2),o.jc("ngIf",t.winner),o.Bb(1),o.jc("ngIf",t.draw),o.Bb(1),o.jc("ngIf",!t.winner&&!t.draw&&!i.isSearchResult)}}function aD(t,e){if(1&t&&(o.Rb(0,"scrollable",46),o.Rb(1,"ul",47),o.Jc(2,sD,12,7,"li",48),o.Qb(),o.Qb()),2&t){const t=o.bc();o.jc("fade",!0)("bbox",!0),o.Bb(2),o.jc("ngForOf",t.personalSessions)}}function rD(t,e){if(1&t&&o.Ob(0,"empty",45),2&t){const t=o.bc();o.jc("centered",!1)("desc",t.L(t.userId==t.id?"meta.ui.profile.section_empty.message":"meta.ui.stats.table.no_personal_message_for_other"))}}const oD=function(t,e){return{portrait:t,wreath:e}},cD=function(t,e,i,n){return{displayName:t,league:e,self:i,avatar:n}};function lD(t,e){if(1&t&&(o.Rb(0,"li",64),o.Rb(1,"div",50),o.Rb(2,"div",65),o.Rb(3,"span",66),o.Lc(4),o.Qb(),o.Qb(),o.Rb(5,"div",67),o.Rb(6,"div",68),o.Ob(7,"user-image",69),o.Qb(),o.Rb(8,"span",70),o.Ob(9,"nickname",71),o.Qb(),o.Qb(),o.Rb(10,"div",72),o.Rb(11,"span",73),o.Lc(12),o.Qb(),o.Ob(13,"img",74),o.Qb(),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=o.bc(3);o.Fb("selected",t.player===i.userId),o.jc("alertSound","ui_click_default"),o.Bb(4),o.Mc(t.rank.cat()),o.Bb(3),o.jc("player",o.qc(11,cD,t.displayName,t.league,t.player===i.userId,o.oc(8,oD,t.portrait,t.wreath))),o.Bb(2),o.jc("name",t.displayName),o.Bb(1),o.kc("tooltip-hint",i.L("meta.hint.store.currency.rating_point")),o.Bb(2),o.Mc(t.score.cat())}}function uD(t,e){if(1&t&&(o.Rb(0,"scrollable",46),o.Rb(1,"ul",62),o.Jc(2,lD,14,16,"li",63),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.jc("fade",!0)("bbox",!0),o.Bb(2),o.jc("ngForOf",t.ratingArray)}}function dD(t,e){if(1&t&&o.Ob(0,"empty",45),2&t){const t=o.bc(2);o.jc("centered",!1)("desc",t.L("meta.ui.profile.section_empty.desc"))}}function hD(t,e){if(1&t&&(o.Rb(0,"div",4),o.Rb(1,"h3",5),o.Lc(2),o.Qb(),o.Jc(3,uD,3,3,"scrollable",9),o.Jc(4,dD,1,2,"empty",7),o.Qb()),2&t){const t=o.bc();o.Bb(2),o.Mc(t.L("meta.ui.profile.menu.rating")),o.Bb(1),o.jc("ngIf",t.ratingArray&&t.ratingArray.length),o.Bb(1),o.jc("ngIf",t.isLoadedParts.rating&&(!t.ratingArray||!t.ratingArray.length))}}function bD(t,e){if(1&t&&(o.Rb(0,"li",39),o.Rb(1,"div",77),o.Rb(2,"div",78),o.Rb(3,"div",79),o.Rb(4,"div",80),o.Ob(5,"img",58),o.Rb(6,"h5"),o.Lc(7),o.Qb(),o.Qb(),o.Qb(),o.Rb(8,"div",81),o.Rb(9,"span",82),o.Lc(10),o.Qb(),o.Qb(),o.Qb(),o.Rb(11,"div",83),o.Ob(12,"span"),o.Qb(),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=o.bc(3);o.Bb(5),o.jc("src","assets/img/flags/campaign_"+t.id+".png",o.Cc),o.Bb(2),o.Mc(i.L("meta.ui.menu.nation."+t.id)),o.Bb(3),o.Mc(t.data[0]),o.Bb(2),o.Hc("width: ",t.data[0]/t.max[0]*100,"%")}}function mD(t,e){if(1&t&&(o.Rb(0,"ul",76),o.Jc(1,bD,13,6,"li",48),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("ngForOf",t.preferences.army.data)}}function pD(t,e){if(1&t&&o.Ob(0,"empty",45),2&t){const t=o.bc(2);o.jc("centered",!1)("desc",t.L("meta.ui.profile.preferences.army_empty"))}}function gD(t,e){if(1&t&&(o.Rb(0,"div",4),o.Rb(1,"h3",5),o.Lc(2),o.Qb(),o.Jc(3,mD,2,1,"ul",75),o.Jc(4,pD,1,2,"empty",7),o.Qb()),2&t){const t=o.bc();o.Bb(2),o.Mc(t.L("meta.ui.profile.menu.preferences")),o.Bb(1),o.jc("ngIf",t.preferences&&t.preferences.army&&t.preferences.army.data),o.Bb(1),o.jc("ngIf",t.isLoadedParts.army&&(!t.preferences||!t.preferences.army||!t.preferences.army.data||!t.preferences.army.data.length))}}function fD(t,e){if(1&t&&o.Ob(0,"img",58),2&t){const t=o.bc().$implicit;o.jc("src","assets/img/flags/campaign_"+t.commander.army+".png",o.Cc)}}function vD(t,e){if(1&t&&(o.Rb(0,"li",39),o.Rb(1,"div",85),o.Rb(2,"div",86),o.Rb(3,"figure",87),o.Ob(4,"img",88),o.Qb(),o.Jc(5,fD,1,1,"img",49),o.Qb(),o.Rb(6,"div",89),o.Rb(7,"h5"),o.Lc(8),o.Qb(),o.Rb(9,"small",90),o.Lc(10),o.Qb(),o.Rb(11,"small",90),o.Lc(12),o.Qb(),o.Qb(),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=o.bc(3);o.Bb(4),o.jc("src",t.commander.image?"assets/img/commanders/"+t.commander.image+".png":"assets/img/commanders/"+t.commander._id+".png",o.Cc),o.Bb(1),o.jc("ngIf",t.commander.army),o.Bb(3),o.Mc(i.L("commander."+t.id+".name")),o.Bb(2),o.Oc("",i.L("meta.ui.profile.preferences.battle"),": ",t.count,""),o.Bb(2),o.Oc("",i.L("meta.ui.profile.preferences.winrate"),": ",t.winRate,"%")}}function yD(t,e){if(1&t&&(o.Rb(0,"scrollable",46),o.Rb(1,"ul",84),o.Jc(2,vD,13,7,"li",48),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.jc("fade",!0)("bbox",!0),o.Bb(2),o.jc("ngForOf",t.preferences.commanders)}}function _D(t,e){if(1&t&&o.Ob(0,"empty",45),2&t){const t=o.bc(2);o.jc("centered",!1)("desc",t.L("meta.ui.profile.preferences.commanders_empty"))}}function kD(t,e){if(1&t&&(o.Rb(0,"div",4),o.Rb(1,"h3",5),o.Lc(2),o.Qb(),o.Jc(3,yD,3,3,"scrollable",9),o.Jc(4,_D,1,2,"empty",7),o.Qb()),2&t){const t=o.bc();o.Bb(2),o.Mc(t.L("meta.ui.profile.preferences.commanders")),o.Bb(1),o.jc("ngIf",t.preferences&&t.preferences.commanders&&t.preferences.commanders.length),o.Bb(1),o.jc("ngIf",t.isLoadedParts.commanders&&(!t.preferences||!t.preferences.commanders||!t.preferences.commanders.length))}}function wD(t,e){if(1&t&&(o.Rb(0,"li",39),o.Rb(1,"div",85),o.Rb(2,"div",92),o.Rb(3,"h5"),o.Lc(4),o.Qb(),o.Rb(5,"small",90),o.Lc(6),o.Qb(),o.Rb(7,"small",90),o.Lc(8),o.Qb(),o.Qb(),o.Rb(9,"div",86),o.Rb(10,"figure",93),o.Ob(11,"img",88),o.Qb(),o.Qb(),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=o.bc(3);o.Bb(4),o.Mc(i.L("unit."+t.id+".short")),o.Bb(2),o.Oc("",i.L("meta.ui.profile.preferences.battle"),": ",t.count,""),o.Bb(2),o.Oc("",i.L("meta.ui.profile.preferences.winrate"),": ",t.winRate,"%"),o.Bb(3),o.jc("src","assets/img/unit/"+t.id+".png",o.Cc)}}function SD(t,e){if(1&t&&(o.Rb(0,"scrollable",46),o.Rb(1,"ul",91),o.Jc(2,wD,12,6,"li",48),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.jc("fade",!0)("bbox",!0),o.Bb(2),o.jc("ngForOf",t.preferences.units)}}function ID(t,e){if(1&t&&o.Ob(0,"empty",45),2&t){const t=o.bc(2);o.jc("centered",!1)("desc",t.L("meta.ui.profile.preferences.units_empty"))}}function CD(t,e){if(1&t&&(o.Rb(0,"div",4),o.Rb(1,"h3",5),o.Lc(2),o.Qb(),o.Jc(3,SD,3,3,"scrollable",9),o.Jc(4,ID,1,2,"empty",7),o.Qb()),2&t){const t=o.bc();o.Bb(2),o.Mc(t.L("meta.ui.profile.preferences.units")),o.Bb(1),o.jc("ngIf",t.preferences&&t.preferences.units&&t.preferences.units.length),o.Bb(1),o.jc("ngIf",!t.preferences||!t.preferences.units||!t.preferences.units.length&&t.isLoadedParts.units)}}JSON;let LD=(()=>{class t extends KQ{constructor(t,e,i,n,s,a,r){super(t,e,i,n,s,a,r),this.registrationDate="",this.tab=RD.Summary,this.open=null,this.timeout="",this.achievements=[],this.preferences={army:[],commanders:[],battles:[],units:[]},this.isLoadedParts={achievements:!1,army:!1,commaders:!1,battles:!1,units:!1,rating:!1,league:!1},this.ratingArray=[],this.personalSessions=[],this.league=null,this.sessionBelongsToPlayer=!1,this.commanders=null,this.units=null,KQ.instances.push(this)}getRegistrationDate(){return new Date(this.getValue("personal.registration")||0).parseDate("dd.mm.yyyy")}fetchProfileData(){this.isLoaded=!1,this.data=this.profileService.getSummary(this.id),this.isLoaded=!0,this.registrationDate=this.getRegistrationDate(),this.open=this.profileService.getProfileOpen(this.id),this.sessionBelongsToPlayer=this.id===this.cache.getUserId(),this.open&&this.open.time&&(this.timeout=this.profileService.setTimeoutTick(this.open.time)),this.onProfileLoad()}goToAvatar(){this.tab=RD.Avatar}goToSummary(){this.tab=RD.Summary}onProfileLoad(){let t=this.profileService.getPlayerProfileData(this.id);this.leagueId=t&&t.summary?t.summary.personal.league:"",this.cache.getLeagueRules().subscribe(t=>{t.scriptData.rules.distribution.values.reverse().map(t=>{t.id===this.leagueId&&(this.league=t,this.cache.getLeagueState().subscribe(t=>{this.isLoadedParts.league=!0}))})});let e=this.profileService.getAchievements(this.id,{status:su.Completed}).sort((t,e)=>e.display_order-t.display_order);this.achievements=this.selectLastAchievements(e),this.isLoadedParts.achievements=!0;let i=this.profileService.getPlayerPreferences(this.id,{sorting:Zl.Decreasing,selection:Xl.All});this.preferences.army=i&&i.battles?i.battles.find(t=>"army"===t.id):null,this.isLoadedParts.army=!0,this.preferences.units=this.getPreferableElements(this.profileService.getUnits(this.id,{nation:tu.All,type:iu.All,subtype:nu.All,level:-1})),this.isLoadedParts.units=!0,this.preferences.commanders=t&&t.preference&&t.preference.battle&&t.preference.battle.commander?this.getPreferableElements(this.profileService.getCommanders(this.id,{nation:tu.All,type:eu.All})):null,console.log(this.preferences.commanders),this.isLoadedParts.commanders=!0,this.profileService.getGlobalRating(this.id,{mode:au.Around},Tu.PVP).subscribe(t=>{this.ratingArray=t.scriptData.entries||[];let e=Math.max(0,this.ratingArray.findIndex(t=>t.player===this.id)-Math.floor(3));this.ratingArray=this.ratingArray.slice(e,e+6),console.log(this.ratingArray),this.isLoadedParts.rating=!0},t=>{this.isLoadedParts.rating=!0}),this.id!==this.cache.getUserId()?this.cache.searchPlayerSessionFromList(this.id).subscribe(t=>{t&&t.scriptData&&t.scriptData.session&&(this.personalSessions=t.scriptData.session,console.log(this.personalSessions),this.isLoadedParts.battles=!0)}):this.cache.getSessions().subscribe(t=>{this.personalSessions=t;for(let e=0;e<this.personalSessions.length;e++){let t=this.personalSessions[e].commanderTemplate?this.cache.getCommander(this.personalSessions[e].commanderTemplate):null;this.personalSessions[e].army=t?t.army:""}console.log(this.personalSessions),this.isLoadedParts.battles=!0})}selectLastAchievements(t){if(!t||!t.length)return[];let e=[],i=[];if(t.map((t,e)=>{(!i.length||i.indexOf(t.chain_id)<0)&&i.push(t.chain_id)}),!i.length)return t&&t.length?t:[];for(let n of i){let i=t.filter(t=>t.chain_id&&t.chain_id==n);if(!i.length)return t&&t.length?t:[];let s=i.reduce(function(t,e){return t.chain_order&&t.chain_order>e.chain_order?t:e});e.push(s)}return e.slice(0,12)}setImageFallback(t,e){t.hidden=!0,t.icon=e}getTooltip(t){return`\n\t\t\t<div class="heading">\n\t\t\t\t<div>\n\t\t\t\t\t<b>${t.title}</b>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t${t.desc}\n\t\t`.flat()}isPremium(){return this.id===this.cache.getUserId()&&!!this.cache.isPremium()}getPreferableElements(t){let e=[];return t&&t.length?(t.filter(t=>t.count&&t.count>=10).length>=3&&(e=e.filter(t=>t.count&&t.count>=10)),e=t.sort((t,e)=>e.count-t.count).sort((t,e)=>e.winRate-t.winRate),e.map(t=>t.winRate==Math.round(t.winRate)),e.slice(0,3)):[]}void(){}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Gc),o.Nb(Uc),o.Nb(Ys),o.Nb(xn),o.Nb(nd),o.Nb(Sl),o.Nb(Ou))},t.\u0275cmp=o.Hb({type:t,selectors:[["profile-summary"]],hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("grid-default",!0)},features:[o.Ab([Ou]),o.yb],decls:34,vars:43,consts:[["g-summary","",1,"tile","texture-border","no-hover"],["style","height: 100%","class","tile-content",4,"ngIf"],["href","","queryParamsHandling","merge","g-achievements","",1,"tile","texture-border",3,"routerLink"],[1,"preloader"],[1,"tile-content","full-size"],[1,"margin-bottom-small"],["class","achievements-list",4,"ngIf"],[3,"centered","desc",4,"ngIf"],["href","","queryParamsHandling","merge","g-battles","",1,"tile","texture-border",3,"routerLink"],["style","height: calc(100% - var(--margin))",3,"fade","bbox",4,"ngIf"],["href","","queryParamsHandling","merge","g-rating","",1,"tile","texture-border",3,"routerLink"],["class","tile-content full-size",4,"ngIf"],["href","","queryParamsHandling","merge","g-preferences","",1,"tile","texture-border",3,"routerLink"],["g-regiments","",1,"tile","texture-border","no-hover"],["g-units","",1,"tile","texture-border","no-hover"],[1,"tile-content",2,"height","100%"],[1,"hero",2,"position","relative"],["href","","routerLinkActive","active","queryParamsHandling","merge",1,"avatar-button",3,"routerLink","queryParams","alertSound"],[1,"texture-border"],["src","assets/img/icons/svg/edit.svg","image-load","","draggable","false",1,"edit-icon"],["fade-in","down",3,"data","id","achievements","hideRank"],[2,"height","calc(20% - var(--grid-gap) * 2)","margin","var(--grid-gap) 0"],[1,"profile-league","texture-border","static","dark","verticaly-middle"],["class","cell-cover",4,"ngIf"],["fade-in","down","class","inner",3,"desc",4,"ngIf"],[1,"stats",2,"height","40%"],[2,"height","100%",3,"bbox","fade"],["scrollable",""],["class","spaced-top","fade-in","down",3,"desc",4,"ngIf"],[3,"data",4,"ngIf"],[1,"cell-cover"],[1,"cell"],[1,"user-image-wrapper",2,"aspect-ratio","1"],[3,"player","animated"],["fade-in","down",1,"inner",3,"desc"],["fade-in","down",1,"spaced-top",3,"desc"],[3,"data"],[1,"achievements-list"],["fade-in","down",3,"hidden",4,"ngFor","ngForOf"],["fade-in","down"],["class","decoration",4,"ngIf"],[1,"decoration"],["class","image-contain",3,"tooltip-hint",4,"ngIf"],[1,"image-contain",3,"tooltip-hint"],["image-load","",3,"src","error"],[3,"centered","desc"],[2,"height","calc(100% - var(--margin))",3,"fade","bbox"],[1,"clear","profile-battles-list"],["fade-in","down",4,"ngFor","ngForOf"],["class","army-flag",3,"src",4,"ngIf"],[1,"row","collapsed","align-middle"],[1,"col-9"],[2,"margin-bottom","calc(var(--unit-list-gutter))"],[1,"grey",2,"white-space","nowrap"],[1,"col-3"],["class","battle-state win",3,"tooltip-hint",4,"ngIf"],["class","battle-state draw",3,"tooltip-hint",4,"ngIf"],["class","battle-state defeat",3,"tooltip-hint",4,"ngIf"],[1,"army-flag",3,"src"],[1,"battle-state","win",3,"tooltip-hint"],[1,"battle-state","draw",3,"tooltip-hint"],[1,"battle-state","defeat",3,"tooltip-hint"],[1,"clear","rating-list","small"],[3,"alertSound","selected",4,"ngFor","ngForOf"],[3,"alertSound"],[1,"col-2"],[1,"badge","large"],[1,"col-7","user-info"],[1,"image"],[3,"player"],[1,"name-cover","large"],[3,"name"],[1,"col-3","align-right","rating-value",3,"tooltip-hint"],[1,"score"],["src","assets/img/icons/svg/rating.svg","image-load","","draggable","false",1,"icon"],["class","clear profile-nations-list",4,"ngIf"],[1,"clear","profile-nations-list"],[1,"progress-item"],[1,"row","align-bottom",2,"margin-bottom","var(--unit-list-gutter)"],[1,"col-11"],[1,"description"],[1,"col-1"],[1,"badge"],[1,"progress-bar","static"],[1,"clear","profile-regiments-list"],[1,"row","compressed","align-middle"],[1,"col-4",2,"position","relative"],[1,"image-cover",2,"padding-top","75%"],["image-load","","draggable","false",3,"src"],[1,"col-8",2,"padding-left","calc(var(--grid-gap) * 1.1)"],[1,"grey"],[1,"clear","profile-units-list"],[1,"col-8",2,"padding-left","calc(var(--grid-gap) * 2)"],[1,"image-cover"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Jc(1,HA,17,22,"div",1),o.Qb(),o.Rb(2,"a",2),o.Rb(3,"div",3),o.Ob(4,"span"),o.Qb(),o.Rb(5,"div",4),o.Rb(6,"h3",5),o.Lc(7),o.Qb(),o.Jc(8,XA,3,3,"div",6),o.Jc(9,ZA,1,2,"empty",7),o.Qb(),o.Qb(),o.Rb(10,"a",8),o.Rb(11,"div",3),o.Ob(12,"span"),o.Qb(),o.Rb(13,"div",4),o.Rb(14,"h3",5),o.Lc(15),o.Qb(),o.Jc(16,aD,3,3,"scrollable",9),o.Jc(17,rD,1,2,"empty",7),o.Qb(),o.Qb(),o.Rb(18,"a",10),o.Rb(19,"div",3),o.Ob(20,"span"),o.Qb(),o.Jc(21,hD,5,3,"div",11),o.Qb(),o.Rb(22,"a",12),o.Rb(23,"div",3),o.Ob(24,"span"),o.Qb(),o.Jc(25,gD,5,3,"div",11),o.Qb(),o.Rb(26,"div",13),o.Rb(27,"div",3),o.Ob(28,"span"),o.Qb(),o.Jc(29,kD,5,3,"div",11),o.Qb(),o.Rb(30,"div",14),o.Rb(31,"div",3),o.Ob(32,"span"),o.Qb(),o.Jc(33,CD,5,3,"div",11),o.Qb()),2&t&&(o.Bb(1),o.jc("ngIf",e.isLoaded),o.Bb(1),o.jc("routerLink",o.nc(35,$A,"/profile/"+e.id+"/achievements")),o.Bb(1),o.Fb("disabled",e.isLoadedParts.achievements),o.Bb(4),o.Mc(e.L("meta.ui.profile.menu.achievements")),o.Bb(1),o.jc("ngIf",e.achievements&&e.achievements.length),o.Bb(1),o.jc("ngIf",e.isLoadedParts.achievements&&(!e.achievements||!e.achievements.length)),o.Bb(1),o.jc("routerLink",o.nc(37,$A,"/profile/"+e.id+"/sessions")),o.Bb(1),o.Fb("disabled",e.isLoadedParts.battles),o.Bb(4),o.Mc(e.L("meta.ui.profile.menu.sessions")),o.Bb(1),o.jc("ngIf",e.personalSessions&&e.personalSessions.length),o.Bb(1),o.jc("ngIf",e.isLoadedParts.battles&&(!e.personalSessions||!e.personalSessions.length)),o.Bb(1),o.Fb("disabled",e.userId!==e.id),o.jc("routerLink",o.nc(39,$A,"/profile/"+e.id+"/rating")),o.Bb(1),o.Fb("disabled",e.isLoadedParts.rating),o.Bb(2),o.jc("ngIf",e.userId==e.id),o.Bb(1),o.Fb("disabled",e.userId!==e.id),o.jc("routerLink",o.nc(41,$A,"/profile/"+e.id+"/preferences")),o.Bb(1),o.Fb("disabled",e.isLoadedParts.army),o.Bb(2),o.jc("ngIf",e.userId==e.id),o.Bb(1),o.Fb("disabled",e.userId!==e.id),o.Bb(1),o.Fb("disabled",e.isLoadedParts.commanders),o.Bb(2),o.jc("ngIf",e.userId==e.id),o.Bb(1),o.Fb("disabled",e.userId!==e.id),o.Bb(1),o.Fb("disabled",e.isLoadedParts.units),o.Bb(2),o.jc("ngIf",e.userId==e.id))},encapsulation:2}),t})();var RD=function(t){return t.Summary="summary",t.Avatar="avatar",t}({});JSON;let OD=(()=>{class t{constructor(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Hb({type:t,selectors:[["profile-troops-common"]],hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("typical-profile-page",!0)},features:[o.Ab([Ou])],decls:1,vars:0,template:function(t,e){1&t&&o.Ob(0,"router-outlet")},directives:[ta],encapsulation:2}),t})();function TD(t,e){if(1&t&&(o.Rb(0,"tr",13),o.Rb(1,"td",14),o.Rb(2,"div",15),o.Rb(3,"div",16),o.Rb(4,"span",17),o.Lc(5),o.Qb(),o.Qb(),o.Rb(6,"div",18),o.Rb(7,"div",19),o.Ob(8,"img",20),o.Qb(),o.Qb(),o.Rb(9,"div",21),o.Ob(10,"img",22),o.Rb(11,"h5"),o.Ob(12,"img",23),o.Lc(13),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(14,"td",24),o.Lc(15),o.Qb(),o.Rb(16,"td",24),o.Lc(17),o.Qb(),o.Rb(18,"td",24),o.Rb(19,"span"),o.Lc(20),o.Qb(),o.Qb(),o.Rb(21,"td",24),o.Lc(22),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2);o.jc("alertSound","ui_click_default"),o.Bb(1),o.Ic("width",i.cellWidth(0)),o.Bb(4),o.Mc(i.L("level."+t.unit.level)),o.Bb(3),o.jc("src","assets/img/unit/"+t.unit.id+".png",o.Cc),o.Bb(2),o.jc("src","assets/img/flags/campaign_"+t.unit.army+".png",o.Cc),o.Bb(2),o.kc("tooltip-hint",i.L("meta.hint.play.echelon.subclass-header")+" "+i.L("meta.hint.play.echelon.subclass."+t.unit.subtype)),o.jc("src","assets/img/subtypes/"+t.unit.subtype+".svg",o.Cc),o.Bb(1),o.Nc(" ",i.L("unit."+t.unit.id+".name").dropWords(35)," "),o.Bb(1),o.Ic("width",i.cellWidth(1)),o.Bb(1),o.Nc(" ",t.averageDamage?t.averageDamage.cat():t.averageDamage," "),o.Bb(1),o.Ic("width",i.cellWidth(3)),o.Bb(1),o.Nc(" ",t.averageXp?t.averageXp.cat():t.averageXp," "),o.Bb(1),o.Ic("width",i.cellWidth(4)),o.Bb(2),o.Mc(t.count),o.Bb(1),o.Ic("width",i.cellWidth(5)),o.Bb(1),o.Nc(" ",t.winRate?t.winRate.float():t.winRate," ")}}function xD(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",5),o.Rb(1,"table",6),o.Rb(2,"thead"),o.Rb(3,"tr"),o.Rb(4,"th",7),o.Yb("click",function(){return o.zc(t),o.bc().sortBy("!name")}),o.Lc(5),o.Qb(),o.Rb(6,"th",8),o.Yb("click",function(){return o.zc(t),o.bc().sortBy("averageDamage")}),o.Lc(7),o.Qb(),o.Rb(8,"th",8),o.Yb("click",function(){return o.zc(t),o.bc().sortBy("averageXp")}),o.Lc(9),o.Qb(),o.Rb(10,"th",8),o.Yb("click",function(){return o.zc(t),o.bc().sortBy("count")}),o.Lc(11),o.Qb(),o.Rb(12,"th",8),o.Yb("click",function(){return o.zc(t),o.bc().sortBy("winRate")}),o.Lc(13),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(14,"scrollable",9,10),o.Rb(16,"table",11),o.Rb(17,"tbody"),o.Jc(18,TD,23,21,"tr",12),o.cc(19,"sortList"),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(4),o.Ic("width",t.cellWidth(0)),o.Fb("sorting-asc","!name"===t.sortingKey)("sorting-desc","name"===t.sortingKey),o.kc("tooltip-hint",t.L("meta.hint.profile.stats.unit.unit")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.profile.stats.unit.unit")," "),o.Bb(1),o.Ic("width",t.cellWidth(1)),o.Fb("sorting-asc","averageDamage"===t.sortingKey)("sorting-desc","!averageDamage"===t.sortingKey),o.kc("tooltip-hint",t.L("meta.hint.profile.stats.unit.damage")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.profile.stats.unit.damage")," "),o.Bb(1),o.Ic("width",t.cellWidth(3)),o.Fb("sorting-asc","averageXp"===t.sortingKey)("sorting-desc","!averageXp"===t.sortingKey),o.kc("tooltip-hint",t.L("meta.hint.profile.stats.unit.xp")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.profile.stats.unit.xp")," "),o.Bb(1),o.Ic("width",t.cellWidth(4)),o.Fb("sorting-asc","count"===t.sortingKey)("sorting-desc","!count"===t.sortingKey),o.kc("tooltip-hint",t.L("meta.hint.profile.stats.unit.count")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.profile.stats.unit.count")," "),o.Bb(1),o.Ic("width",t.cellWidth(5)),o.Fb("sorting-asc","winRate"===t.sortingKey)("sorting-desc","!winRate"===t.sortingKey),o.kc("tooltip-hint",t.L("meta.hint.profile.stats.unit.win")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.profile.stats.unit.win")," "),o.Bb(1),o.jc("bbox",!0)("css3",!0),o.Bb(4),o.jc("ngForOf",o.ec(19,48,t.filteredData,t.sortingKey))}}function BD(t,e){if(1&t&&o.Ob(0,"empty",25),2&t){const t=o.bc();o.jc("title",t.L("meta.ui.profile.menu.units"))("desc",t.L("meta.ui.profile.section_filter_empty.message"))}}const jD=function(t){return[t]};function MD(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",26),o.Rb(1,"div",27),o.Rb(2,"a",28,29),o.Lc(4),o.Qb(),o.Rb(5,"a",28,30),o.Lc(7),o.Qb(),o.Qb(),o.Rb(8,"div",31),o.Rb(9,"select-menu",32),o.Yb("onChange",function(e){return o.zc(t),o.bc().onFilterChange(e)}),o.Qb(),o.Qb(),o.Rb(10,"div",31),o.Rb(11,"select-menu",32),o.Yb("onChange",function(e){return o.zc(t),o.bc().onFilterChange(e)}),o.Qb(),o.Qb(),o.Rb(12,"div",31),o.Rb(13,"select-menu",32),o.Yb("onChange",function(e){return o.zc(t),o.bc().onFilterChange(e)}),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(2),o.jc("routerLink",o.nc(17,jD,"/profile/"+t.id+"/troops/units"))("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.profile.menu.units")),o.Bb(2),o.Nc(" ",t.L("meta.ui.profile.menu.units")," "),o.Bb(1),o.jc("routerLink",o.nc(19,jD,"/profile/"+t.id+"/troops/commanders"))("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.profile.menu.commanders")),o.Bb(2),o.Nc(" ",t.L("meta.ui.profile.menu.commanders")," "),o.Bb(2),o.jc("data",t.selectMenuNation)("type","checkbox")("filterType","nation"),o.Bb(2),o.jc("data",t.selectMenuSubtype)("type","checkbox")("filterType","subtype"),o.Bb(2),o.jc("data",t.selectMenuLevel)("type","checkbox")("filterType","level")}}JSON;let QD=(()=>{class t extends KQ{constructor(t,e,i,n,s,a,r){super(t,e,i,n,s,a,r),this.filter={nation:tu.All,type:iu.All,subtype:nu.All,level:-1},this.filterVariants={nation:fd(tu),type:fd(iu),subtype:fd(nu),level:[-1,1,2,3,4,5,6]},this.filtersKeys={nation:vd(tu),type:vd(iu),subtype:vd(nu),level:[-1,1,2,3,4,5,6]},this.sortingKey="averageDamage",this.tableCell=["40%","12%","12%","12%","12%","12%"],this.filteredData=[],this.selectMenuNation={root:"assets/img/flags/",ext:"png",label:"meta.ui.profile.preferences.army",showMode:Wh.Label,options:this.filtersKeys.nation.map(t=>({key:t,icon:"campaign_"+t,selected:this.filter.nation==t,flag:"all"!=t,label:"meta.ui.menu.nation."+t,type:"nation"}))},this.selectMenuSubtype={root:"assets/img/subtypes",ext:"svg",label:"meta.ui.troops.speciality.title",showMode:Wh.Icon,options:this.filtersKeys.subtype.map(t=>({key:t,icon:t,selected:this.filter.subtype==t,flag:!1,label:"meta.hint.play.echelon.subclass."+t,type:"subtype"}))},this.selectMenuLevel={root:"assets/img/icons/svg/level",ext:"svg",label:"meta.ui.profile.preferences.level",showMode:Wh.Icon,options:this.filtersKeys.level.map(t=>({key:t<0?"all":t,icon:t,selected:this.filter.level==t,flag:!1,label:t<0?"level.all":"meta.ui.unit.unit_props.level_"+t,type:"level"}))},this.initialFilter={nation:["all"],subtype:["all"],level:["all"],inProgress:this.isFeaturesAvailable(),name:""}}fetchProfileData(){this.isLoaded=!1,this.data=this.profileService.getUnits(this.id,this.filter),this.filteredData=this.data,this.cache.devMode&&console.log(this.data),this.isLoaded=!0}setFilter(t,e){this.filter[t]=this.filterVariants[t][e],this.fetchProfileData()}unwrapUnit(t){t.unwraped=!t.unwraped}cellWidth(t){return""+this.tableCell[t]}onFilterChange(t){if(!t)return;let e=t.selectedOptions,i=t.type;switch(i){case"nation":case"subtype":case"level":if(this.initialFilter[i]=[],e.find(t=>t.key&&"all"==t.key))this.initialFilter[i].push("all");else for(let t of e)this.initialFilter[i].push(t.key);break;case"name":this.initialFilter[i]=e}this.filteredData=this.data.slice().filter(t=>!!this.initialFilter.nation.find(t=>"all"===t)||this.initialFilter.nation.find(e=>t.unit&&e===t.unit.army)).filter(t=>!!this.initialFilter.subtype.find(t=>"all"===t)||this.initialFilter.subtype.find(e=>t.unit&&e===t.unit.subtype)).filter(t=>!!this.initialFilter.level.find(t=>"all"===t)||this.initialFilter.level.find(e=>t.unit&&e===t.unit.level)).filter(t=>this.L("unit."+t.unit.id+".short").trim().match(new RegExp(this.initialFilter.name,"gim")))}isFeaturesAvailable(){return this.cache.hasFlag("features_in_progress")}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Gc),o.Nb(Uc),o.Nb(Ys),o.Nb(xn),o.Nb(nd),o.Nb(Sl),o.Nb(Ou))},t.\u0275cmp=o.Hb({type:t,selectors:[["profile-units"]],hostVars:4,hostBindings:function(t,e){2&t&&o.Fb("typical-profile-page",!0)("grid-default",!0)},features:[o.Ab([Ou]),o.yb],decls:6,vars:5,consts:[[1,"preloader","small","bold"],["g-units-section",""],["style","height: 100%","fade","down",4,"ngIf"],[3,"title","desc",4,"ngIf"],["g-aside-section","","fade","'down'",4,"ngIf"],["fade","down",2,"height","100%"],[1,"table","simple-table","fixed-table"],[1,"align-left",2,"width","calc(var(--unit-width) + var(--table-padding) * 2)",3,"tooltip-hint","alertSound","click"],[3,"tooltip-hint","alertSound","click"],[2,"height","calc(100% - var(--button-large_height))",3,"bbox","css3"],["battlesScrollable",""],[1,"table","simple-table"],[3,"alertSound",4,"ngFor","ngForOf"],[3,"alertSound"],[1,"align-left",2,"width","calc(var(--unit-width) + var(--table-padding) * 2)"],[1,"row","table-unit-view","align-middle"],[1,"col-1"],[1,"badge"],[1,"col-4"],[1,"image-contain"],["image-load","",3,"src"],[1,"col-7"],["image-load","false",1,"flag-image",3,"src"],["draggable","false",1,"icon",3,"src","tooltip-hint"],[1,"align-right"],[3,"title","desc"],["g-aside-section","","fade","'down'"],[1,"margin-top-small",2,"width","fit-content"],["href","","routerLinkActive","active","queryParamsHandling","merge",1,"button","tab","block",3,"routerLink","alertSound"],["unitsLink","routerLinkActive"],["commandersLink","routerLinkActive"],[1,"margin-top"],[3,"data","type","filterType","onChange"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Ob(1,"span"),o.Qb(),o.Rb(2,"div",1),o.Jc(3,xD,20,51,"div",2),o.Jc(4,BD,1,2,"empty",3),o.Qb(),o.Jc(5,MD,14,21,"div",4)),2&t&&(o.Fb("disabled",e.isLoaded),o.Bb(3),o.jc("ngIf",e.filteredData&&e.filteredData.length),o.Bb(1),o.jc("ngIf",!e.filteredData||!e.filteredData.length),o.Bb(1),o.jc("ngIf",e.isLoaded))},encapsulation:2}),t})();const AD=function(t){return[t]};function DD(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",5),o.Rb(1,"div",6),o.Rb(2,"a",7,8),o.Lc(4),o.Qb(),o.Rb(5,"a",7,9),o.Lc(7),o.Qb(),o.Qb(),o.Rb(8,"div",10),o.Rb(9,"select-menu",11),o.Yb("onChange",function(e){return o.zc(t),o.bc().onFilterChange(e)}),o.Qb(),o.Qb(),o.Rb(10,"div",10),o.Rb(11,"select-menu",11),o.Yb("onChange",function(e){return o.zc(t),o.bc().onFilterChange(e)}),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(2),o.jc("routerLink",o.nc(14,AD,"/profile/"+t.id+"/troops/units"))("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.profile.menu.units")),o.Bb(2),o.Nc(" ",t.L("meta.ui.profile.menu.units")," "),o.Bb(1),o.jc("routerLink",o.nc(16,AD,"/profile/"+t.id+"/troops/commanders"))("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.profile.menu.commanders")),o.Bb(2),o.Nc(" ",t.L("meta.ui.profile.menu.commanders")," "),o.Bb(2),o.jc("data",t.selectMenuNation)("type","checkbox")("filterType","nation"),o.Bb(2),o.jc("data",t.selectMenuType)("type","checkbox")("filterType","type")}}function ED(t,e){if(1&t&&(o.Rb(0,"td",23),o.Rb(1,"div",24),o.Rb(2,"div",25),o.Rb(3,"div",26),o.Ob(4,"img",27),o.Qb(),o.Qb(),o.Rb(5,"div",28),o.Ob(6,"img",29),o.Rb(7,"h5"),o.Ob(8,"img",30),o.Lc(9),o.Qb(),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(2);o.Ic("width",e.cellWidth(0)),o.Bb(4),o.jc("src",t.commander.image?"assets/img/commanders/"+t.commander.image+".png":"assets/img/commanders/"+t.commander._id+".png",o.Cc),o.Bb(2),o.jc("src","assets/img/flags/campaign_"+t.commander.army+".png",o.Cc),o.Bb(2),o.jc("src","assets/img/icons/svg/"+t.commander.type+".svg",o.Cc),o.Bb(1),o.Nc(" ",t.name," ")}}function ND(t,e){if(1&t&&(o.Rb(0,"tr",20),o.Jc(1,ED,10,6,"td",21),o.Rb(2,"td",22),o.Lc(3),o.Qb(),o.Rb(4,"td",22),o.Lc(5),o.Qb(),o.Rb(6,"td",22),o.Lc(7),o.Qb(),o.Rb(8,"td",22),o.Rb(9,"span"),o.Lc(10),o.Qb(),o.Qb(),o.Rb(11,"td",22),o.Lc(12),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2);o.jc("alertSound","ui_click_default"),o.Bb(1),o.jc("ngIf",t.commander),o.Bb(1),o.Ic("width",i.cellWidth(1)),o.Bb(1),o.Nc(" ",t.nation," "),o.Bb(1),o.Ic("width",i.cellWidth(2)),o.Bb(1),o.Nc(" ",t.averageDamage?t.averageDamage.cat():t.averageDamage," "),o.Bb(1),o.Ic("width",i.cellWidth(4)),o.Bb(1),o.Nc(" ",t.averageXp?t.averageXp.cat():t.averageXp," "),o.Bb(1),o.Ic("width",i.cellWidth(5)),o.Bb(2),o.Mc(t.count),o.Bb(1),o.Ic("width",i.cellWidth(6)),o.Bb(1),o.Nc(" ",t.winRate?t.winRate.float():t.winRate," ")}}function FD(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",12),o.Rb(1,"table",13),o.Rb(2,"thead"),o.Rb(3,"tr"),o.Rb(4,"th",14),o.Yb("click",function(){return o.zc(t),o.bc().sortBy("!name")}),o.Lc(5),o.Qb(),o.Rb(6,"th",15),o.Yb("click",function(){return o.zc(t),o.bc().sortBy("!nation")}),o.Lc(7),o.Qb(),o.Rb(8,"th",15),o.Yb("click",function(){return o.zc(t),o.bc().sortBy("averageDamage")}),o.Lc(9),o.Qb(),o.Rb(10,"th",15),o.Yb("click",function(){return o.zc(t),o.bc().sortBy("averageXp")}),o.Lc(11),o.Qb(),o.Rb(12,"th",15),o.Yb("click",function(){return o.zc(t),o.bc().sortBy("count")}),o.Lc(13),o.Qb(),o.Rb(14,"th",15),o.Yb("click",function(){return o.zc(t),o.bc().sortBy("winRate")}),o.Lc(15),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(16,"scrollable",16,17),o.Rb(18,"table",18),o.Rb(19,"tbody"),o.Jc(20,ND,13,17,"tr",19),o.cc(21,"sortList"),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(4),o.Ic("width",t.cellWidth(0)),o.Fb("sorting-asc","!name"===t.sortingKey)("sorting-desc","name"===t.sortingKey),o.kc("tooltip-hint",t.L("meta.ui.profile.summary.preferable_regiment")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.profile.stats.unit.comander")," "),o.Bb(1),o.Ic("width",t.cellWidth(1)),o.Fb("sorting-asc","!nation"===t.sortingKey)("sorting-desc","nation"===t.sortingKey),o.kc("tooltip-hint",t.L("meta.hint.profile.stats.commander.army")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.profile.preferences.army")," "),o.Bb(1),o.Ic("width",t.cellWidth(2)),o.Fb("sorting-asc","averageDamage"===t.sortingKey)("sorting-desc","!averageDamage"===t.sortingKey),o.kc("tooltip-hint",t.L("meta.hint.profile.stats.unit.damage")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.profile.stats.unit.damage")," "),o.Bb(1),o.Ic("width",t.cellWidth(4)),o.Fb("sorting-asc","averageXp"===t.sortingKey)("sorting-desc","!averageXp"===t.sortingKey),o.kc("tooltip-hint",t.L("meta.hint.profile.stats.unit.xp")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.profile.stats.unit.xp")," "),o.Bb(1),o.Ic("width",t.cellWidth(5)),o.Fb("sorting-asc","count"===t.sortingKey)("sorting-desc","!count"===t.sortingKey),o.kc("tooltip-hint",t.L("meta.hint.profile.stats.unit.count")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.profile.stats.unit.count")," "),o.Bb(1),o.Ic("width",t.cellWidth(6)),o.Fb("sorting-asc","winRate"===t.sortingKey)("sorting-desc","!winRate"===t.sortingKey),o.kc("tooltip-hint",t.L("meta.hint.profile.stats.unit.win")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.profile.stats.unit.win")," "),o.Bb(1),o.jc("bbox",!0),o.Bb(4),o.jc("ngForOf",o.ec(21,56,t.filteredData,t.sortingKey))}}function PD(t,e){if(1&t&&o.Ob(0,"empty",31),2&t){const t=o.bc();o.jc("title",t.L("meta.ui.profile.menu.commanders"))("desc",t.L("meta.ui.profile.section_filter_empty.message"))}}JSON;let UD=(()=>{class t extends KQ{constructor(t,e,i,n,s,a,r){super(t,e,i,n,s,a,r),this.filter={nation:tu.All,type:eu.All},this.filterVariants={nation:fd(tu),type:fd(eu)},this.filtersKeys={nation:vd(tu),type:vd(eu)},this.sortingKey="averageDamage",this.tableCell=["28%","12%","12%","12%","12%","12%","12%"],this.filteredData=[],this.selectMenuNation={root:"assets/img/flags/",ext:"png",label:"meta.ui.profile.preferences.army",showMode:Wh.Label,options:this.filtersKeys.nation.map(t=>({key:t,icon:"campaign_"+t,selected:this.filter.nation==t,flag:"all"!=t,label:"meta.ui.menu.nation."+t,type:"nation"}))},this.selectMenuType={root:"assets/img/icons/svg",ext:"svg",label:"meta.ui.troops.types.title",showMode:Wh.Icon,options:this.filtersKeys.type.map(t=>({key:t,icon:t,selected:this.filter.type==t,flag:!1,label:"meta.ui.commander.type."+t,type:"type"}))},this.initialFilter={nation:["all"],type:["all"],inProgress:this.isFeaturesAvailable()}}fetchProfileData(){this.isLoaded=!1,this.data=this.profileService.getCommanders(this.userId,this.filter),this.filteredData=this.data.filter(t=>t&&t.commander),this.cache.devMode&&console.log(this.filteredData),this.isLoaded=!0}setFilter(t,e){this.filter[t]=this.filterVariants[t][e],this.fetchProfileData()}cellWidth(t){return""+this.tableCell[t]}onFilterChange(t){if(!t)return;let e=t.selectedOptions,i=t.type;switch(i){case"nation":case"type":if(this.initialFilter[i]=[],e.find(t=>t.key&&"all"==t.key))this.initialFilter[i].push("all");else for(let t of e)this.initialFilter[i].push(t.key)}this.filteredData=this.data.slice().filter(t=>!!this.initialFilter.nation.find(t=>"all"===t)||this.initialFilter.nation.find(e=>t.commander&&e===t.commander.army)).filter(t=>!!this.initialFilter.type.find(t=>"all"===t)||this.initialFilter.type.find(e=>t.commander&&e===t.commander.type))}isFeaturesAvailable(){return this.cache.hasFlag("features_in_progress")}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Gc),o.Nb(Uc),o.Nb(Ys),o.Nb(xn),o.Nb(nd),o.Nb(Sl),o.Nb(Ou))},t.\u0275cmp=o.Hb({type:t,selectors:[["profile-commanders"]],hostVars:4,hostBindings:function(t,e){2&t&&o.Fb("typical-profile-page",!0)("grid-default",!0)},features:[o.Ab([Ou]),o.yb],decls:6,vars:5,consts:[[1,"preloader","small","bold"],["g-aside-section","","fade","down",4,"ngIf"],["g-units-section",""],["style","height: 100%",4,"ngIf"],[3,"title","desc",4,"ngIf"],["g-aside-section","","fade","down"],[1,"margin-top-small",2,"width","fit-content"],["href","","routerLinkActive","active","queryParamsHandling","merge",1,"button","tab","block",3,"routerLink","alertSound"],["unitsLink","routerLinkActive"],["commandersLink","routerLinkActive"],[1,"margin-top"],[3,"data","type","filterType","onChange"],[2,"height","100%"],[1,"table","simple-table","fixed-table"],[1,"align-left",2,"width","calc(var(--unit-width) + var(--table-padding) * 2)",3,"tooltip-hint","alertSound","click"],[3,"tooltip-hint","alertSound","click"],[2,"height","calc(100% - var(--button-large_height))",3,"bbox"],["battlesScrollable",""],[1,"table","simple-table"],[3,"alertSound",4,"ngFor","ngForOf"],[3,"alertSound"],["class","align-left","style","width: calc(var(--unit-width) + var(--table-padding) * 2);",3,"width",4,"ngIf"],[1,"align-right"],[1,"align-left",2,"width","calc(var(--unit-width) + var(--table-padding) * 2)"],[1,"row","table-unit-view","collapsed","align-middle"],[1,"col-3"],[1,"image-cover"],["image-load","","draggable","false",3,"src"],[1,"col-9","commander-name-column"],["image-load","",1,"flag-image",3,"src"],["draggable","false",1,"icon","larger",3,"src"],[3,"title","desc"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Ob(1,"span"),o.Qb(),o.Jc(2,DD,12,18,"div",1),o.Rb(3,"div",2),o.Jc(4,FD,22,59,"div",3),o.Jc(5,PD,1,2,"empty",4),o.Qb()),2&t&&(o.Fb("disabled",e.isLoaded),o.Bb(2),o.jc("ngIf",e.isLoaded),o.Bb(2),o.jc("ngIf",e.data&&e.data.length),o.Bb(1),o.jc("ngIf",!e.filteredData||!e.filteredData.length))},encapsulation:2}),t})();const zD=function(t,e,i,n,s){return{level:t,displayName:e,league:i,premium:n,avatar:s}};function JD(t,e){if(1&t&&(o.Ob(0,"user-image",6),o.Rb(1,"h3",7),o.Lc(2),o.Qb()),2&t){const t=o.bc();o.kc("tooltip-hint",t.getValue("personal.league")?t.L("meta.ui.league."+t.getValue("personal.league")+".name"):""),o.jc("animated",!0)("player",o.rc(5,zD,(t.getValue("personal.level")||0).cat(),t.getValue("personal.displayName"),t.getValue("personal.league"),t.isPremium(),t.userAvatar)),o.Bb(1),o.kc("tooltip-hint",t.getValue("personal.displayName")),o.Bb(1),o.Mc(t.getValue("personal.displayName"))}}JSON;const qD=["shield","target","timer","flag","damage","container"];let VD=(()=>{class t{constructor(t,e,i,n){this.cache=t,this.visitService=e,this.cdr=i,this.profileService=n,this.data={},this.achievementsCount=1,this.id="",this.hideRank=!1,this.userId="",this.userAvatar={},this.achievements=[],(new al).data.subscribe(t=>this.L=t)}ngOnInit(){let t=this.profileService.getAchievements(this.id,{status:su.Completed}).sort((t,e)=>e.display_order-t.display_order);this.achievements=t.slice(0,6),this.userId=this.cache.getUserId();let e={};this.userAvatar=this.id==this.userId?this.profileService.getUserAvatar():{wreath:this.data.personal.wreath,portrait:this.data.personal.portrait},this.profileAvatarSubscription=this.profileService.onAvatarChange.pipe(We(t=>null!==t)).subscribe(t=>{t.wreath&&(e.wreath=t.wreath),t.portrait&&(e.portrait=t.portrait),this.id==this.userId&&(this.userAvatar=e)}),console.log(this.data)}getValue(t){return Iu(this.data,t)}addAchievement(t){let e=this.achievements.slice();e.unshift(qD[Math.randomInt(0,qD.length-1)]),this.achievements=e.slice(0,2*this.achievementsCount)}getTooltip(t){return`\n\t\t\t<div class="heading">\n\t\t\t\t<div>\n\t\t\t\t\t<b>${t.title}</b>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t${t.desc}\n\t\t`.flat()}isPremium(){return this.id===this.cache.getUserId()&&!!this.cache.isPremium()}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Sl),o.Nb(o.h),o.Nb(Ou))},t.\u0275cmp=o.Hb({type:t,selectors:[["profile-hero"]],inputs:{data:"data",achievementsCount:["achievements","achievementsCount"],id:"id",hideRank:"hideRank"},decls:15,vars:5,consts:[["userImageTemplate",""],[1,"image"],[3,"ngTemplateOutlet"],["rank","",3,"tooltip-hint"],["src","assets/img/icons/svg/rating.svg","image-load","","draggable","false",1,"rank-icon"],["karma",""],[1,"main-hero",3,"animated","tooltip-hint","player"],[1,"user-name-main",3,"tooltip-hint"]],template:function(t,e){if(1&t&&(o.Jc(0,JD,3,11,"ng-template",null,0,o.Kc),o.Rb(2,"div",1),o.Pb(3,2),o.Qb(),o.Rb(4,"dl",3),o.Rb(5,"dd"),o.Lc(6),o.Qb(),o.Rb(7,"dt"),o.Lc(8),o.Qb(),o.Ob(9,"img",4),o.Qb(),o.Rb(10,"dl",5),o.Rb(11,"dd"),o.Lc(12,"0"),o.Qb(),o.Rb(13,"dt"),o.Lc(14),o.Qb(),o.Qb()),2&t){const t=o.wc(1);o.Bb(3),o.jc("ngTemplateOutlet",t),o.Bb(1),o.kc("tooltip-hint",e.L("meta.hint.store.currency.rating_point")),o.Bb(2),o.Mc((e.getValue("personal.score")||0).cat(" ")),o.Bb(2),o.Mc(e.L("meta.ui.store.currency.rating_point")),o.Bb(6),o.Mc(e.L("meta.ui.profile.summary.karma"))}},encapsulation:2}),t})();JSON;let $D=(()=>{class t{constructor(t,e,i){this.cache=t,this.visitService=e,this.cdr=i,this.data={},(new al).data.subscribe(t=>this.L=t)}ngOnInit(){}getValue(t){return Iu(this.data,t)}s(t){let e=Iu(this.data,t);return"string"==typeof e&&"undefined"==e?"":Iu(this.data,t)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Sl),o.Nb(o.h))},t.\u0275cmp=o.Hb({type:t,selectors:[["profile-summary-table"]],inputs:{data:"data"},decls:65,vars:20,consts:[[1,"line"],[1,"paddless","cell"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Rb(1,"div",1),o.Rb(2,"dl"),o.Rb(3,"dd"),o.Lc(4),o.Qb(),o.Rb(5,"dt"),o.Lc(6),o.Qb(),o.Qb(),o.Qb(),o.Rb(7,"div",1),o.Rb(8,"dl"),o.Rb(9,"dd"),o.Lc(10),o.Qb(),o.Rb(11,"dt"),o.Lc(12),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(13,"div",0),o.Rb(14,"div",1),o.Rb(15,"dl"),o.Rb(16,"dd"),o.Lc(17),o.Qb(),o.Rb(18,"dt"),o.Lc(19),o.Qb(),o.Qb(),o.Qb(),o.Rb(20,"div",1),o.Rb(21,"dl"),o.Rb(22,"dd"),o.Lc(23),o.Qb(),o.Rb(24,"dt"),o.Lc(25),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(26,"div",0),o.Rb(27,"div",1),o.Rb(28,"dl"),o.Rb(29,"dd"),o.Lc(30),o.Qb(),o.Rb(31,"dt"),o.Lc(32),o.Qb(),o.Qb(),o.Qb(),o.Rb(33,"div",1),o.Rb(34,"dl"),o.Rb(35,"dd"),o.Lc(36),o.Qb(),o.Rb(37,"dt"),o.Lc(38),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(39,"div",0),o.Rb(40,"div",1),o.Rb(41,"dl"),o.Rb(42,"dd"),o.Lc(43),o.Qb(),o.Rb(44,"dt"),o.Lc(45),o.Qb(),o.Qb(),o.Qb(),o.Rb(46,"div",1),o.Rb(47,"dl"),o.Rb(48,"dd"),o.Lc(49),o.Qb(),o.Rb(50,"dt"),o.Lc(51),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(52,"div",0),o.Rb(53,"div",1),o.Rb(54,"dl"),o.Rb(55,"dd"),o.Lc(56),o.Qb(),o.Rb(57,"dt"),o.Lc(58),o.Qb(),o.Qb(),o.Qb(),o.Rb(59,"div",1),o.Rb(60,"dl"),o.Rb(61,"dd"),o.Lc(62),o.Qb(),o.Rb(63,"dt"),o.Lc(64),o.Qb(),o.Qb(),o.Qb(),o.Qb()),2&t&&(o.Bb(4),o.Mc((e.s("session.count")||0).cat()),o.Bb(2),o.Mc(e.L("meta.ui.profile.summary.battles_count")),o.Bb(4),o.Mc((e.s("session.winRate")||0).cat()),o.Bb(2),o.Mc(e.L("meta.ui.profile.summary.win_rate")),o.Bb(5),o.Mc((e.s("objective.count")||0).cat()),o.Bb(2),o.Mc(e.L("meta.ui.profile.summary.completed_objectives")),o.Bb(4),o.Mc((e.s("achievement.count")||0).cat()),o.Bb(2),o.Mc(e.L("meta.ui.profile.summary.achievements_count")),o.Bb(5),o.Mc(e.s("prefer.unit")?e.L("unit."+e.s("prefer.unit")+".short"):"\u2014"),o.Bb(2),o.Mc(e.L("meta.ui.profile.summary.preferable_unit")),o.Bb(4),o.Nc(" ",e.s("prefer.commanderTemplate")?e.L("commander."+e.s("prefer.commanderTemplate")+".name"):"\u2014"," "),o.Bb(2),o.Mc(e.L("meta.ui.profile.summary.preferable_regiment")),o.Bb(5),o.Mc((e.s("session.averageXp")||0).cat()),o.Bb(2),o.Mc(e.L("meta.ui.profile.summary.xp_per_battle")),o.Bb(4),o.Mc((e.s("session.maxXp")||0).cat()),o.Bb(2),o.Mc(e.L("meta.ui.profile.summary.max_xp")),o.Bb(5),o.Mc((e.s("session.averageDamage")||0).cat()),o.Bb(2),o.Mc(e.L("meta.ui.profile.summary.damage_per_battle")),o.Bb(4),o.Mc((e.s("session.maxDamage")||0).cat()),o.Bb(2),o.Mc(e.L("meta.ui.profile.summary.max_damage")))},encapsulation:2}),t})();function GD(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",6),o.Yb("click",function(){o.zc(t);const i=e.$implicit,n=o.bc();return n.setFilter("mode",i),n.triggerGlobalEvent("button.profile.rating_mode."+i)}),o.Lc(1),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc();o.Fb("active",i.filter.mode===t),o.kc("tooltip-hint",i.L("meta.ui.profile.rating.mode."+t)),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",i.L("meta.ui.profile.rating.mode."+t)," ")}}function HD(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",6),o.Yb("click",function(){o.zc(t);const i=e.$implicit,n=o.bc();return n.setActiveBoard(i),n.triggerGlobalEvent("button.profile.rating_leaderboard."+i)}),o.Lc(1),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc();o.Fb("active",i.activeLeaderboard===t),o.kc("tooltip-hint",i.L("meta.ui.play.mode."+t)),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",i.L("meta.ui.play.mode."+t)," ")}}const YD=function(t,e){return{portrait:t,wreath:e}},WD=function(t,e,i,n){return{displayName:t,league:e,self:i,avatar:n}};function KD(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",15),o.Yb("click",function(){o.zc(t);const i=e.$implicit,n=o.bc(3);return i.player!==n.userId?n.goToProfile(i.player,{rating:n.filter.mode}):n.void()}),o.Rb(1,"div",16),o.Rb(2,"div",17),o.Rb(3,"span",18),o.Lc(4),o.Qb(),o.Qb(),o.Rb(5,"div",19),o.Rb(6,"div",20),o.Ob(7,"user-image",21),o.Qb(),o.Rb(8,"span",22),o.Ob(9,"nickname",23),o.Qb(),o.Qb(),o.Rb(10,"div",24),o.Rb(11,"div",25),o.Rb(12,"div",26),o.Lc(13),o.Qb(),o.Rb(14,"small"),o.Lc(15),o.Qb(),o.Ob(16,"img",27),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(3);o.Fb("selected",t.player===i.userId),o.kc("tooltip-hint",i.L("meta.ui.chat.profile_option.view_profile")),o.jc("alertSound","ui_click_default"),o.Bb(4),o.Mc(t.rank.cat(",")),o.Bb(3),o.jc("player",o.qc(13,WD,t.displayName,t.league,t.player===i.userId,o.oc(10,YD,t.portrait,t.wreath))),o.Bb(2),o.jc("name",t.displayName),o.Bb(1),o.kc("tooltip-hint",i.L("meta.hint.store.currency.rating_point")),o.Bb(3),o.Mc(t.score.cat(" ")),o.Bb(2),o.Mc(i.L("meta.ui.store.currency.rating_point"))}}function XD(t,e){if(1&t&&(o.Rb(0,"div",10),o.Rb(1,"scrollable",11,12),o.Rb(3,"ul",13),o.Jc(4,KD,17,18,"li",14),o.cc(5,"sortList"),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("bbox",!0),o.Bb(3),o.jc("ngForOf",o.ec(5,2,t.data,t.sortingKey))}}function ZD(t,e){if(1&t&&o.Ob(0,"empty",28),2&t){const t=o.bc(2);o.jc("title",t.L("meta.ui.profile.menu.rating"))("desc",t.L("meta.ui.profile.section_empty.desc"))}}function tE(t,e){if(1&t&&(o.Rb(0,"div",7),o.Jc(1,XD,6,5,"div",8),o.Jc(2,ZD,1,2,"empty",9),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf",t.data&&t.data.length),o.Bb(1),o.jc("ngIf",!t.data||!t.data.length)}}JSON;let eE=(()=>{class t extends KQ{constructor(t,e,i,n,s,a,r){super(t,e,i,n,s,a,r),this.filter={mode:au.Around},this.filterVariants={mode:fd(au)},this.filtersKeys={mode:vd(au)},this.sortingKey="!rank",this.tableCell=["12%","58%","30%"],this.userId="",this.leaderboards={mode:vd(Tu)},this.userId=this.cache.getUserId(),this.setActiveBoard(Tu.PVP)}setFilter(t,e){this.filter[t]=this.filterVariants[t][e],this.fetchProfileData()}fetchProfileData(){this.isLoaded=!1,this.data=[],this.profileService.getGlobalRating(this.id,this.filter,this.activeLeaderboard).subscribe(t=>{this.data=t.scriptData.entries||[],this.isLoaded=!0,this.cache.devMode&&console.log(this.data)},t=>{this.isLoaded=!0,this.notificatorService.push({response:t})})}cellWidth(t){return""+this.tableCell[t]}setActiveBoard(t){this.activeLeaderboard!=t&&(this.activeLeaderboard=t,this.fetchProfileData())}void(){}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Gc),o.Nb(Uc),o.Nb(Ys),o.Nb(xn),o.Nb(nd),o.Nb(Sl),o.Nb(Ou))},t.\u0275cmp=o.Hb({type:t,selectors:[["profile-rating"]],hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("typical-profile-page",!0)},features:[o.Ab([Ou]),o.yb],decls:8,vars:5,consts:[[1,"rating-grid"],[1,"preloader","small","bold"],["g-rating-aside-right","","fade","'down'",1,"profile-aside"],["class","button tab block",3,"active","alertSound","tooltip-hint","click",4,"ngFor","ngForOf"],["g-rating-aside-left","","fade","'down'",1,"profile-aside"],["class","tile-layout-wrapper","g-rating-main","",4,"ngIf"],[1,"button","tab","block",3,"alertSound","tooltip-hint","click"],["g-rating-main","",1,"tile-layout-wrapper"],["class","profile-container faded-in","style","height: 100%",4,"ngIf"],[3,"title","desc",4,"ngIf"],[1,"profile-container","faded-in",2,"height","100%"],[1,"wide-fade",2,"height","calc(100%)",3,"bbox"],["battlesScrollable",""],[1,"clear","rating-list"],[3,"alertSound","selected","tooltip-hint","click",4,"ngFor","ngForOf"],[3,"alertSound","tooltip-hint","click"],[1,"row","align-middle"],[1,"col-1"],[1,"badge","large",2,"width","2em"],[1,"col-8"],[1,"image"],[3,"player"],[1,"name-cover"],[1,"larger",3,"name"],[1,"col-3","align-right",3,"tooltip-hint"],[1,"league-points"],[1,"score"],["src","assets/img/icons/svg/rating.svg","image-load","","draggable","false",1,"rank-icon"],[3,"title","desc"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Rb(1,"div",1),o.Ob(2,"span"),o.Qb(),o.Rb(3,"aside",2),o.Jc(4,GD,2,5,"button",3),o.Qb(),o.Rb(5,"aside",4),o.Jc(6,HD,2,5,"button",3),o.Qb(),o.Jc(7,tE,3,2,"div",5),o.Qb()),2&t&&(o.Bb(1),o.Fb("disabled",e.isLoaded),o.Bb(3),o.jc("ngForOf",e.filtersKeys.mode),o.Bb(2),o.jc("ngForOf",e.leaderboards.mode),o.Bb(1),o.jc("ngIf",e.isLoaded))},encapsulation:2}),t})();function iE(t,e){if(1&t&&(o.Rb(0,"h2"),o.Lc(1),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.Mc(t.L("meta.ui.profile.leagues.title"))}}function nE(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Mc((t._state.score||0).cat(" "))}}function sE(t,e){if(1&t&&(o.Rb(0,"h2"),o.Jc(1,nE,2,1,"span",4),o.Lc(2,"\xa0 "),o.Rb(3,"small"),o.Lc(4),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngIf",t._state&&t._state.score),o.Bb(3),o.Mc(t.L("meta.ui.store.currency.league_point"))}}const aE=function(t,e){return{portrait:t,wreath:e}},rE=function(t,e,i){return{displayName:t,league:e,avatar:i}};function oE(t,e){if(1&t&&o.Ob(0,"user-image",16),2&t){const t=o.bc(2);o.jc("player",o.pc(4,rE,null==t.data?null:t.data.displayName,null==t.data?null:t.data.league.id,o.oc(1,aE,null==t.data?null:t.data.portrait,null==t.data?null:t.data.wreath)))}}const cE=function(t,e){return{league:t,default:!0,displayName:e}};function lE(t,e){if(1&t&&(o.Rb(0,"div",8),o.Rb(1,"div",9),o.Rb(2,"h3",10),o.Lc(3),o.Qb(),o.Rb(4,"div",11),o.Ob(5,"user-image",12),o.Qb(),o.Rb(6,"div",13),o.Ob(7,"rewards",14),o.Qb(),o.Qb(),o.Jc(8,oE,1,8,"user-image",15),o.Qb()),2&t){const t=e.$implicit,i=o.bc();o.Fb("selected",t.id===i.userLeague),o.Bb(3),o.Nc(" ",i.L("meta.ui.league."+t.id+".short")," "),o.Bb(2),o.jc("player",o.oc(8,cE,t.id,i.L("meta.ui.league."+t.id+".name")))("animated",!0),o.Bb(2),o.jc("rewards",t.rewards)("appearance","inline"),o.Bb(1),o.jc("ngIf",t.id===i.userLeague)}}JSON;const uE=["january","february","march","april","may","june","july","august","september","october","november","december"];let dE=(()=>{class t{constructor(t,e,i){this.cache=t,this.tasksService=e,this.profileService=i,this._rules=null,this._state=null,this._info=null,this.leagues=[],this.state={},this.description="",this.headingName="",this.headingDate="",this.isLoaded=!1,this.summaryData=null,this.localizator=new al,this.localizator.data.subscribe(t=>this.L=t)}ngOnInit(){this.data=this.cache.getUser(!0).scriptData,this.summaryData=this.profileService.getSummary(this.cache.getUserId()),console.log(this.summaryData),this.userLeague=this.cache.getUserLeague(),this.cache.league.pipe(We(t=>null!==t)).subscribe(()=>{this.userLeague=this.cache.getUserLeague()}),this.cache.getLeagueRules().subscribe(t=>{this._rules=t.scriptData.rules,this.leagues=this._rules.distribution.values.reverse().map(t=>(t.condition=t.percent?this.L("meta.hint.league.percent",{percent:t.percent}):this.L("meta.hint.league.top",{percent:t.top}),t.rewards=this.tasksService.getReward([t.container]),t)),console.log(this.leagues,this.userLeague),this.isLoaded=!0},()=>{this.isLoaded=!0}),this.cache.getLeagueState().subscribe(t=>{console.log(t),this._state=t.scriptData.state||null,this._info=t.scriptData.info||null,this.state=this._state;let e=this.L("meta.ui.league.season."+new Date),i=this._info&&this._info.seazonId?uE[new Date(this._info.seazonId).getMonth()]:this._info.seazonId,n=this._info&&this._info.seazonId?new Date(this._info.seazonId).getFullYear():this._info.seazonId,s=e.match(new RegExp("meta.ui","gim"))?this.L("meta.ui.month."+i)+" "+n:e;this._info&&this._info.seazonId&&(this.headingName=this.L("meta.ui.league.heading.name",{name:s})),this.description=this.isLeagueActive()?this.L("meta.ui.league.active_message").markdown().br():this.L("meta.ui.league.waiting_message").markdown().br(),this.runCountown(),this.cache.devMode&&console.log(this.state,this._info)})}isLeagueActive(){return!(!this.state||!this.state.id)}getTimeHint(){if(!this._info)return"";let t=new Date(this._info.seazonEnd);return this.L("meta.hint.timer.league",{date:t.toLocaleString(this.localizator.getLocale())})}parseCountdown(){let t=new Date(this._info.seazonEnd);if(t.isGreaterEqual(new Date)){let e=t.diff(new Date);this.headingDate=this.L("meta.ui.league.heading.time",{remaining:(new Date).getDifferenceString(e,"",!0,this.L)})}else clearInterval(this.countdownUpdateInterval)}runCountown(){this.countdownUpdateInterval&&clearInterval(this.countdownUpdateInterval),this.parseCountdown(),this.countdownUpdateInterval=setInterval(()=>{this.parseCountdown()},1e3)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Tl),o.Nb(Ou))},t.\u0275cmp=o.Hb({type:t,selectors:[["profile-leagues"]],hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("typical-profile-page",!0)},decls:13,vars:6,consts:[["fade-in","down",1,"leagues","heading"],["l-heading-center",""],[1,"margin-bottom-small"],["l-heading-right",""],[4,"ngIf"],[3,"innerHTML"],[1,"leagues","containers"],["class","tile texture-border static","fade-in","down",3,"selected",4,"ngFor","ngForOf"],["fade-in","down",1,"tile","texture-border","static"],[1,"tile-content",2,"height","100%"],[1,"align-center"],[1,"image"],[3,"player","animated"],[1,"league"],[3,"rewards","appearance"],[3,"player",4,"ngIf"],[3,"player"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Rb(1,"div",1),o.Rb(2,"h2",2),o.Lc(3),o.Qb(),o.Rb(4,"h3"),o.Lc(5),o.Qb(),o.Qb(),o.Rb(6,"div",3),o.Rb(7,"div",2),o.Jc(8,iE,2,1,"h2",4),o.Jc(9,sE,5,2,"h2",4),o.Ob(10,"div",5),o.Qb(),o.Qb(),o.Qb(),o.Rb(11,"div",6),o.Jc(12,lE,9,11,"div",7),o.Qb()),2&t&&(o.Bb(3),o.Mc(e.headingName),o.Bb(2),o.Mc(e.headingDate),o.Bb(3),o.jc("ngIf",!e.userLeague),o.Bb(1),o.jc("ngIf",e.userLeague&&e.summaryData),o.Bb(1),o.jc("innerHTML",e.description,o.Ac),o.Bb(2),o.jc("ngForOf",e.leagues))},encapsulation:2}),t})();const hE=["userMainImage"];function bE(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",12),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc().saveAvatarPortrait(i.id)}),o.Rb(1,"div",13),o.Ob(2,"img",14),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc();o.Fb("active",t.id==i.selectedPortrait),o.jc("alertSound","ui_click_default"),o.Bb(2),o.jc("src","assets/img/portraits/"+t.id+".png",o.Cc)}}function mE(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",17),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(2).saveAvatarWreath(i.id)}),o.Rb(1,"figure",21),o.Ob(2,"img",22),o.Ob(3,"img",23),o.Ob(4,"img",24),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Fb("active",i.selectedWreath==t.id),o.jc("alertSound","ui_click_default"),o.Bb(1),o.kc("tooltip-hint",i.L("meta.ui.profile.avatar_type_"+t.id)),o.Bb(1),o.jc("src","assets/img/portraits/deluxe_oreol_"+t.id+".svg",o.Cc),o.Bb(1),o.jc("src","assets/img/portraits/deluxe_wreath_"+t.id+".svg",o.Cc),o.Bb(1),o.jc("src","assets/img/portraits/deluxe_tape_"+t.id+".svg",o.Cc)}}const pE=function(t,e){return{league:t,premium:e}};function gE(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",15),o.Rb(1,"scrollable",7,8),o.Rb(3,"ul",16),o.Rb(4,"li",17),o.Yb("click",function(){return o.zc(t),o.bc().saveAvatarWreath("league")}),o.Rb(5,"div",18),o.Ob(6,"user-image",19),o.Qb(),o.Qb(),o.Qb(),o.Rb(7,"ul",9),o.Jc(8,mE,5,7,"li",20),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(1),o.jc("bbox",!0)("origin","right")("fade",!0),o.Bb(3),o.Fb("active","league"==t.selectedWreath),o.jc("alertSound","ui_click_default"),o.Bb(2),o.jc("animated",!0)("player",o.oc(10,pE,t.getValue("personal.league"),t.isPremium))("leagueOnly",!0),o.Bb(2),o.jc("ngForOf",t.avatarWreath)}}const fE=function(t){return[t]},vE=function(){return{session:null}};JSON;let yE=(()=>{class t extends KQ{constructor(t,e,i,n,s,a,r){super(t,e,i,n,s,a,r),this.data={},this.registrationDate="",this.playerAvatarData=null,this.avatarWreath=[],this.avatarPortraits=[],this.selectedWreath="",this.selectedPortrait="",this.selectedAvatar={},this.profileInventory=null}ngOnInit(){this.id=this.cache.getUserId(),this.fetchProfileData(),this.profileInventory=this.cache.getProfileInventory(),this.getDefaultAvatars(),this.selectedAvatar=this.profileService.getUserAvatar(),this.selectedWreath=this.selectedAvatar.wreath,this.selectedPortrait=this.selectedAvatar.portrait,this.playerAvatarData={level:(this.getValue("personal.level")||0).cat(),displayName:this.getValue("personal.displayName"),league:this.getValue("personal.league"),premium:this.isPremium(),avatar:this.selectedAvatar},this.profileAvatarSubscription=this.profileService.onAvatarChange.pipe(We(t=>null!==t)).subscribe(t=>{t.wreath&&this.setAvatarWreath(t.wreath),t.portrait&&this.setAvatarPortrait(t.portrait)})}getRegistrationDate(){return new Date(this.getValue("personal.registration")||0).parseDate("dd.mm.yyyy")}fetchProfileData(){this.isLoaded=!1,this.data=this.profileService.getSummary(this.id),this.isLoaded=!0,this.registrationDate=this.getRegistrationDate()}isPremium(){return this.id===this.cache.getUserId()&&!!this.cache.isPremium()}getDefaultAvatars(){let t=this.cache.getUserInventory();this.avatarPortraits=this.selectFromInventory(t,"portrait"),this.avatarWreath=this.selectFromInventory(t,"wreath")}selectFromInventory(t,e){let i=[];if(t&&t[e]&&t[e].length)for(let n of t[e])n.id&&"league"!==n.id&&(0==n.check_inventory&&0==n.in_progress&&i.push(n),1==n.check_inventory&&0==n.in_progress&&this.profileInventory&&this.profileInventory[e]&&this.profileInventory[e].includes(n.id)&&i.push(n),1==n.in_progress&&this.isFeaturesAvailable()&&i.push(n));return i.sort((t,e)=>t.display_order-e.display_order)}isFeaturesAvailable(){return this.cache.hasFlag("features_in_progress")}setAvatarWreath(t){t&&t.length&&(this.selectedWreath=t,this.selectedAvatar.wreath=this.selectedWreath)}setAvatarPortrait(t){t&&t.length&&(this.selectedPortrait=t,this.selectedAvatar.portrait=this.selectedPortrait)}saveAvatarWreath(t){t&&t.length&&this.profileService.selectWreath(t).subscribe(t=>{this.userMainImage.bindAvatar(this.selectedAvatar)})}saveAvatarPortrait(t){t&&t.length&&this.profileService.selectPortrait(t).subscribe(t=>{this.userMainImage.bindAvatar(this.selectedAvatar)})}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(Gc),o.Nb(Uc),o.Nb(Ys),o.Nb(xn),o.Nb(nd),o.Nb(Sl),o.Nb(Ou))},t.\u0275cmp=o.Hb({type:t,selectors:[["profile-avatar"]],viewQuery:function(t,e){if(1&t&&o.Qc(hE,!0),2&t){let t;o.vc(t=o.Zb())&&(e.userMainImage=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("grid-default",!0)},inputs:{data:"data"},features:[o.Ab([Ou]),o.yb],decls:14,vars:16,consts:[[1,"preloader","small","bold"],["g-hero",""],[1,"main-hero",3,"animated","tooltip-hint","player"],["userMainImage",""],["g-buttons",""],["href","","routerLinkActive","active","queryParamsHandling","merge",1,"button","large","margin-top",3,"routerLink","queryParams"],["g-left",""],["fade-in","",3,"bbox","origin","fade"],["scrollable",""],[1,"clear","avatars-list","tree-line"],["class","avatar-item round",3,"active","alertSound","click",4,"ngFor","ngForOf"],["g-right","",4,"ngIf"],[1,"avatar-item","round",3,"alertSound","click"],[1,"image-contain"],["draggable","false",1,"user-image",3,"src"],["g-right",""],[1,"clear","avatars-list","tree-line","spaced-bottom"],[1,"league-item",3,"alertSound","click"],[1,"image-contain","league-item"],[3,"animated","player","leagueOnly"],["class","league-item",3,"active","alertSound","click",4,"ngFor","ngForOf"],[1,"image-contain","user-image",3,"tooltip-hint"],["draggable","false",1,"oreol",3,"src"],["draggable","false",1,"wreat",3,"src"],["draggable","false",1,"tape",3,"src"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Ob(1,"span"),o.Qb(),o.Rb(2,"div",1),o.Ob(3,"user-image",2,3),o.Qb(),o.Rb(5,"div",4),o.Rb(6,"a",5),o.Lc(7),o.Qb(),o.Qb(),o.Rb(8,"div",6),o.Rb(9,"scrollable",7,8),o.Rb(11,"ul",9),o.Jc(12,bE,3,4,"li",10),o.Qb(),o.Qb(),o.Qb(),o.Jc(13,gE,9,13,"div",11)),2&t&&(o.Fb("disabled",e.isLoaded),o.Bb(3),o.kc("tooltip-hint",e.getValue("personal.league")?e.L("meta.ui.league."+e.getValue("personal.league")+".name"):""),o.jc("animated",!0)("player",e.playerAvatarData),o.Bb(3),o.jc("routerLink",o.nc(13,fE,"/profile/"+e.userId+"/summary"))("queryParams",o.mc(15,vE)),o.Bb(1),o.Nc(" ",e.L("meta.ui.button_accept")," "),o.Bb(2),o.jc("bbox",!0)("origin","left")("fade",!0),o.Bb(3),o.jc("ngForOf",e.avatarPortraits),o.Bb(1),o.jc("ngIf",e.isLoaded&&e.avatarPortraits&&e.avatarPortraits.length))},encapsulation:2}),t})();const _E=["gdprModal"],kE=["confirmationModal"],wE=["scrollable"],SE=["keywordInput"];function IE(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",24),o.Rb(1,"button",35),o.Yb("click",function(){return o.zc(t),o.bc().accept()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(1),o.Fb("secondary",t.allIsAccepted)("disabled",!t.allIsAccepted||null==t.GDPROptions.stats_open),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.gdpr.profile_accept")," ")}}function CE(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",33),o.Yb("click",function(){return o.zc(t),o.bc().openConfirmation()}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc();o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.gdpr.profile_delete")," ")}}function LE(t,e){if(1&t){const t=o.Sb();o.Rb(0,"li",24),o.Rb(1,"button",33),o.Yb("click",function(){return o.zc(t),o.bc().decline()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(1),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.gdpr.profile_decline")," ")}}const RE=function(){return{hover:"ui_hover_default",click:"ui_click_default"}},OE=function(t){return{keyword:t}};JSON;let TE=(()=>{class t{constructor(t,e,i){this.cache=t,this.notificatorService=e,this.sanitizer=i,this.localizator=new al,this.documentLink="",this.globalEvent=new uu,this.allIsAccepted=!1,this.text="",this.keyword="",this.regions=[xE.Global,xE.Europe,xE.NorthAmerica,xE.SouthhAmerica,xE.Asia],this.keydownHandler=function(t){27===t.keyCode&&this.gdprModal.opened&&this.decline()},this.localizator.data.subscribe(t=>{this.L=t}),this.globalEvent.subject.pipe(We(t=>null!==t)).subscribe(t=>{"gdpr_open"===t.key&&this.open()}),this.globalEvent.subject.pipe(We(t=>null!==t)).subscribe(t=>{"gdpr_close"===t.key&&(this.close(),this.closeConfirmation())}),pd.onKeyDown.pipe(We(t=>null!==t)).subscribe(t=>{pd.getKey("F4")&&this.gdprModal&&!this.gdprModal.opened&&this.gdprModal.open()})}ngOnInit(){this.GDPROptions={region:xE.Global,stats_open:null,chat_filter_friends:!0,chat_filter_others:!1},this.getDocument(this.documentLink),this.keydownSubscription=pd.onKeyDown.pipe(We(t=>null!==t)).subscribe(t=>{this.keydownHandler(t)})}ngOnDestroy(){this.keydownSubscription&&this.keydownSubscription.unsubscribe()}setOption(t,e){this.GDPROptions[t]=e}srollToHead(t){this.scrollable&&setTimeout(()=>{this.scrollable.scrollToMiddlePoint(`[data-id="${t}"]`)},1e3)}_parseHTML(t){t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\<head\>(.*?)\<\/head\>/gim,"")).replace(/<\/?(html|body)[^>]*>/g,"")).replace(/(class|start|style|colspan|rowspan)\=\".*?\"/g,"")).replace(/(\&nbsp\;){2,10}/g,"&nbsp;")).replace(/h4/g,"h5")).replace(/h3/g,"h4")).replace(/h2/g,"h3")).replace(/h1/g,"h2");let e=[];t=t=t.replace(/<a\s+(?:[^>]*?\s+)?href=(["'])\#(.*?)\1>(.*?)<\/a>/g,(t,i,n,s)=>{let a=n;return e.push(a),`<a href='' scroll-to="#${a}">${s}</a>`});for(let i=0;i<e.length;i++){let n=e[i],s="anchor_"+Math.randomInt(0,9999);t=t.replace(new RegExp(n,"g"),s)}return t=t.replace(/\<table/gim,"<table class='table not-fixed'"),this.sanitizer.bypassSecurityTrustHtml(t)}getDocument(t){t&&Il(t,!1).then(t=>{this.text=this._parseHTML(t)})}open(){this.text=this._parseHTML(this.cache.getGDPRHTML()),this.gdprModal&&!this.gdprModal.opened&&this.gdprModal.open()}close(){this.gdprModal&&this.gdprModal.opened&&this.gdprModal.close()}accept(){this.globalEvent.trigger("gdpr_accept",this.GDPROptions),this.gdprModal.close()}decline(){this.globalEvent.trigger("gdpr_decline"),this.gdprModal.close()}canDelete(){return!!localStorage.getItem("METAGAME_GDPR")}deleteAccount(){this.inProgress=!0,this.globalEvent.trigger("delete_account"),this.isCalledByUser()&&setTimeout(()=>{this.cache.alert("exit")},1e3)}openConfirmation(){this.confirmationModal&&(this.confirmationModal.open(),setTimeout(()=>{this.keywordInput&&this.keywordInput.nativeElement.focus()},500))}closeConfirmation(){this.confirmationModal&&this.confirmationModal.close()}isKeywordValid(){return!!this.keyword&&this.keyword.trim().toLowerCase()===this.L("meta.ui.gdpr.delete.keyword").toLowerCase()}submit(t){13===t.keyCode&&this.isKeywordValid()&&this.deleteAccount()}isCalledByUser(){return this.cache.isLoaded}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Uc),o.Nb(Er))},t.\u0275cmp=o.Hb({type:t,selectors:[["gdpr"]],viewQuery:function(t,e){if(1&t&&(o.Qc(_E,!0),o.Qc(kE,!0),o.Qc(wE,!0),o.Qc(SE,!0)),2&t){let t;o.vc(t=o.Zb())&&(e.gdprModal=t.first),o.vc(t=o.Zb())&&(e.confirmationModal=t.first),o.vc(t=o.Zb())&&(e.scrollable=t.first),o.vc(t=o.Zb())&&(e.keywordInput=t.first)}},features:[o.Ab([nd,Uc])],decls:57,vars:61,consts:[["id","gdprModal",1,"largest",3,"id","header","ignoreBackgroundClick","nonClosing"],["gdprModal",""],[1,"body"],[1,"gdpr-modal"],[3,"bbox","fade"],[3,"innerHTML"],[1,"hr"],[1,"bottom-part"],[1,"title"],[1,"spaced-top","spaced-bottom"],[1,"checkbox-tile","grid-three-part",3,"tooltip-hint"],[1,"checkbox-caption","tile","texture-border",3,"alertSound","click"],[2,"height","85%",3,"bbox"],["scrollable",""],[1,"button","large"],["for","stats_open",1,"hidden"],["type","checkbox","id","stats_open",1,"checkbox",3,"checked","change"],["stats_open",""],[1,"accept-line"],[1,"checkbox"],["type","checkbox","id","acceptedInput",3,"ngModel","ngModelChange"],["for","acceptedInput"],[1,"buttons-list","clear"],["class","list-item",4,"ngIf"],[1,"list-item"],["class","button","type","button",3,"alertSound","click",4,"ngIf"],["id","gdprModal",1,"medium",3,"id","header"],["confirmationModal",""],[1,"body","collapsed-top"],[1,"form-group"],["type","text","name","","value","",1,"input",3,"ngModel","ngModelChange","keydown"],["keywordInput",""],[1,"buttons-list","align-middle"],["type","button",1,"button",3,"alertSound","click"],["type","button",1,"button","transparent",3,"alertSound","click"],["type","button",1,"button","red","large",3,"alertSound","click"]],template:function(t,e){if(1&t){const t=o.Sb();o.Rb(0,"modal",0,1),o.Rb(2,"div",2),o.Rb(3,"div",3),o.Rb(4,"scrollable",4),o.Ob(5,"article",5),o.Ob(6,"div",6),o.Rb(7,"div",7),o.Rb(8,"h3",8),o.Lc(9),o.Qb(),o.Rb(10,"div",9),o.Lc(11),o.Qb(),o.Rb(12,"div",10),o.Rb(13,"div",11),o.Yb("click",function(){return e.setOption("stats_open",!1)}),o.Rb(14,"scrollable",12,13),o.Ob(16,"article",5),o.Qb(),o.Rb(17,"div",14),o.Lc(18),o.Qb(),o.Qb(),o.Rb(19,"label",15),o.Rb(20,"input",16,17),o.Yb("change",function(){o.zc(t);const i=o.wc(21);return e.setOption("stats_open",i.checked)}),o.Qb(),o.Qb(),o.Rb(22,"span",11),o.Yb("click",function(){return e.setOption("stats_open",!0)}),o.Rb(23,"scrollable",12,13),o.Ob(25,"article",5),o.Qb(),o.Rb(26,"div",14),o.Lc(27),o.Qb(),o.Qb(),o.Qb(),o.Rb(28,"div",18),o.Rb(29,"div",19),o.Rb(30,"input",20),o.Yb("ngModelChange",function(t){return e.allIsAccepted=t}),o.Qb(),o.Rb(31,"label",21),o.Lc(32),o.Qb(),o.Qb(),o.Qb(),o.Rb(33,"ul",22),o.Jc(34,IE,3,6,"li",23),o.Rb(35,"li",24),o.Jc(36,CE,2,2,"button",25),o.Qb(),o.Jc(37,LE,3,2,"li",23),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(38,"modal",26,27),o.Rb(40,"div",28),o.Rb(41,"article"),o.Ob(42,"p",5),o.Qb(),o.Rb(43,"div",29),o.Rb(44,"input",30,31),o.Yb("ngModelChange",function(t){return e.keyword=t})("keydown",function(t){return e.submit(t)}),o.Qb(),o.Qb(),o.Qb(),o.Rb(46,"div",2),o.Rb(47,"div",32),o.Rb(48,"div",24),o.Rb(49,"button",33),o.Yb("click",function(){return e.deleteAccount()}),o.Lc(50),o.Qb(),o.Qb(),o.Rb(51,"div",24),o.Rb(52,"button",34),o.Yb("click",function(){return e.closeConfirmation()}),o.Lc(53),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(54,"div",2),o.Rb(55,"article"),o.Ob(56,"p",5),o.Qb(),o.Qb(),o.Qb()}2&t&&(o.jc("id","gdpr_window")("ignoreBackgroundClick",!0)("nonClosing",!e.isCalledByUser()),o.Bb(4),o.jc("bbox",!0)("fade",!0),o.Bb(1),o.jc("innerHTML",e.text,o.Ac),o.Bb(3),o.Fb("hidden",e.isCalledByUser()),o.Bb(1),o.Mc(e.L("meta.ui.gdpr.profile_stats_label")),o.Bb(2),o.Mc(e.L("meta.ui.gdpr.profile_stats_explainer_subtitle")),o.Bb(1),o.Fb("hidden",e.isCalledByUser()),o.kc("tooltip-hint",e.L("meta.hint.gdpr.acception_helper")),o.Bb(1),o.Fb("active",0==e.GDPROptions.stats_open),o.jc("alertSound",o.mc(57,RE)),o.Bb(1),o.jc("bbox",!0),o.Bb(2),o.jc("innerHTML",e.L("meta.ui.gdpr.profile_stats_explainer_close").markdown(),o.Ac),o.Bb(2),o.Mc(e.L("meta.ui.gdpr.profile_stats_hide")),o.Bb(2),o.jc("checked",e.GDPROptions.stats_open),o.Bb(2),o.Fb("active",1==e.GDPROptions.stats_open),o.jc("alertSound",o.mc(58,RE)),o.Bb(1),o.jc("bbox",!0),o.Bb(2),o.jc("innerHTML",e.L("meta.ui.gdpr.profile_stats_explainer_open").markdown(),o.Ac),o.Bb(2),o.Mc(e.L("meta.ui.gdpr.profile_stats_show")),o.Bb(1),o.Fb("checked",e.allIsAccepted),o.Bb(1),o.Fb("hidden",e.isCalledByUser()),o.Bb(1),o.jc("ngModel",e.allIsAccepted),o.Bb(2),o.Mc(e.L("meta.ui.gdpr.acception_text")),o.Bb(2),o.jc("ngIf",!e.isCalledByUser()),o.Bb(1),o.Fb("hidden",!e.canDelete()),o.Bb(1),o.jc("ngIf",e.canDelete()),o.Bb(1),o.jc("ngIf",!e.isCalledByUser()),o.Bb(1),o.Fb("progress",e.inProgress),o.jc("id","gdpr_confirm_window")("header",e.L("meta.ui.gdpr.delete.title")),o.Bb(4),o.jc("innerHTML",e.L("meta.ui.gdpr.delete.desc",o.nc(59,OE,e.L("meta.ui.gdpr.delete.keyword"))),o.Ac),o.Bb(1),o.Fb("success",e.isKeywordValid()),o.Bb(1),o.jc("ngModel",e.keyword),o.Bb(5),o.Fb("disabled",!e.isKeywordValid())("danger",e.isKeywordValid())("filled",e.isKeywordValid()),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.gdpr.delete.submit")," "),o.Bb(2),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L("meta.ui.gdpr.delete.decline")),o.Bb(1),o.Nc(" ",e.L("meta.ui.gdpr.delete.decline")," "),o.Bb(3),o.jc("innerHTML",e.L("meta.ui.gdpr.delete.recovery"),o.Ac))},encapsulation:2}),t})();var xE=function(t){return t.Global="global",t.Europe="europe",t.NorthAmerica="north_america",t.SouthhAmerica="south_america",t.Asia="asia",t}({});let BE=(()=>{class t{constructor(t,e){this.cache=t,this.redirectService=e,this.globalEvent=new uu,(new al).data.subscribe(t=>this.L=t)}ngOnInit(){this.redirectService.location&&this.redirectService.location.multiplayer&&this.redirectService.processLocation(this.redirectService.location,this.redirectService.teamData)}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Md))},t.\u0275cmp=o.Hb({type:t,selectors:[["multiplayer"]],features:[o.Ab([nd,Md])],decls:1,vars:0,template:function(t,e){1&t&&o.Ob(0,"router-outlet")},directives:[ta],encapsulation:2}),t})();function jE(t,e){1&t&&o.Ob(0,"task-compact",36),2&t&&o.jc("task",e.$implicit)}function ME(t,e){if(1&t&&(o.Rb(0,"div",34),o.Rb(1,"h3",32),o.Lc(2),o.Qb(),o.Jc(3,jE,1,1,"task-compact",35),o.Qb()),2&t){const t=o.bc(),e=t.index,i=t.$implicit,n=o.bc();o.Bb(2),o.Mc(n.L("meta.ui.play.tasks."+n.tasksTitlesKeys[e])),o.Bb(1),o.jc("ngForOf",n.tasks[i])}}function QE(t,e){if(1&t&&(o.Rb(0,"div",32),o.Jc(1,ME,4,2,"div",33),o.Qb()),2&t){const t=e.$implicit,i=o.bc();o.Bb(1),o.jc("ngIf",i.tasks[t].length)}}const AE=function(){return["/multiplayer/main"]},DE=function(){return{hover:"ui_hover_side_panel",click:"ui_click_default"}},EE=function(){return["/multiplayer/lobby"]},NE=function(t){return[t]},FE=function(){return{hover:"ui_hover_default",click:"ui_click_default"}},PE=function(){return["/multiplayer/pvp"]},UE=function(){return["/multiplayer/pve"]},zE=function(){return["/multiplayer/classic"]},JE=function(){return["/multiplayer/duel"]},qE=function(){return["/tasks"]},VE=["this_day","this_week","special","trial","commander","league","unit"],$E=["day_based","week_based","special","challenges","commander","league","unit"];let GE=(()=>{class t{constructor(t,e,i,n){this.cache=t,this.tasksService=e,this.chatService=i,this.redirectService=n,this.globalEvent=new uu,this.tasksKeys=VE,this.tasksTitlesKeys=$E,this.tasks={},this.userGold=0,this.userId="",this.userIsTeamOwner=!1,this.teamId="",this.teamData=null,VE.map(t=>this.tasks[t]=[]),(new al).data.subscribe(t=>this.L=t)}ngOnInit(){VE.map(t=>this.tasks[t]=this.tasksService.getTasks(null,t).filter(t=>"task"===t.type)),console.log(this.tasks),this.userGold=this.cache.getUserGold(),this.userId=this.cache.getUserId(),this.teamId=this.cache.getUserTeamId(),this.teamData=this.chatService.getTeamData(),this.userIsTeamOwner=this.cache.isTeamOwner(),this.teamDataSubscription=this.chatService.teamsData.pipe(We(t=>null!==t)).subscribe(t=>{t&&t.id&&(this.teamId=t.id,this.teamData=t),t&&t.leave&&!0===t.leave&&(this.teamId="",this.teamData=null),this.userIsTeamOwner=this.cache.isTeamOwner()}),this.userIsTeamOwner||this.redirectService.redirectToCurrentLocation()}ngOnDestroy(){this.teamDataSubscription.unsubscribe()}goToTask(){this.cache.redirect(["tasks"])}allow(t){return this.cache.allow(t)}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Tl),o.Nb(Pd),o.Nb(Md))},t.\u0275cmp=o.Hb({type:t,selectors:[["multiplayer-main-page"]],hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("grid-default",!0)},features:[o.Ab([nd,Pd,Md])],decls:62,vars:82,consts:[["heading",""],["type","button",1,"button","small",3,"tooltip-hint","alertSound","click"],[1,"margin-left",2,"display","inline-block","vertical-align","middle",3,"type","value","smallSize"],["multiplayer-social",""],["modes",""],[1,"large-tabs-list","clear"],["fade-in","down",1,"list-item"],["routerLinkActive","active","queryParamsHandling","merge",1,"large-tab-button","texture-border",3,"routerLink","alertSound"],[1,"tab-shadow"],[1,"tab-title","text-overflow",3,"tooltip-hint"],[1,"tab-description","text-overflow"],["draggable","false",1,"tab-icon","default",3,"src"],["draggable","false",1,"tab-icon","hover",3,"src"],[1,"tab-title","text-overflow"],[1,"tab-description","text-overflow",3,"tooltip-hint"],["href","","pvp","","queryParamsHandling","merge","fade-in","down",1,"tile","texture-border",3,"alertSound","routerLink"],[1,"masked-image","mask-pvp"],["image-load","",3,"src"],[1,"tile-heading"],[1,"color-white",3,"innerHTML"],[1,"tile-content"],["href","","pve","","queryParamsHandling","merge","fade-in","down","delay",".05",1,"tile","texture-border",3,"alertSound","routerLink"],[1,"masked-image","mask-pve"],["href","","classic","","queryParamsHandling","merge","fade-in","down","delay",".1",1,"tile","texture-border",3,"alertSound","routerLink"],[1,"masked-image","mask-classic"],["href","","duel","","queryParamsHandling","merge","fade-in","down","delay",".15",1,"tile","texture-border",3,"alertSound","routerLink"],[1,"masked-image","mask-duel"],["objectives","","queryParamsHandling","merge","fade-in","down","delay",".2",1,"tile","texture-border","margin-space",3,"alertSound","routerLink"],[1,"color-white","margin-bottom"],[2,"height","calc(100% - var(--h1-font-size))",3,"fade","bbox","click"],["fade-in","down",4,"ngFor","ngForOf"],["message",""],["fade-in","down"],["class","margin-bottom",4,"ngIf"],[1,"margin-bottom"],["fade-in","down",3,"task",4,"ngFor","ngForOf"],["fade-in","down",3,"task"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Rb(1,"button",1),o.Yb("click",function(){return e.triggerGlobalEvent("statistics_list.open")}),o.Lc(2),o.Qb(),o.Ob(3,"currency",2),o.Qb(),o.Ob(4,"social-links",3),o.Rb(5,"div",4),o.Rb(6,"ul",5),o.Rb(7,"li",6),o.Rb(8,"a",7),o.Ob(9,"span",8),o.Rb(10,"span",9),o.Lc(11),o.Qb(),o.Ob(12,"span",10),o.Ob(13,"img",11),o.Ob(14,"img",12),o.Qb(),o.Qb(),o.Rb(15,"li",6),o.Rb(16,"a",7),o.Ob(17,"span",8),o.Rb(18,"span",9),o.Lc(19),o.Qb(),o.Ob(20,"span",10),o.Ob(21,"img",11),o.Ob(22,"img",12),o.Qb(),o.Qb(),o.Rb(23,"li",6),o.Rb(24,"a",7),o.Ob(25,"span",8),o.Rb(26,"span",13),o.Lc(27),o.Qb(),o.Rb(28,"span",14),o.Lc(29),o.Qb(),o.Ob(30,"img",11),o.Ob(31,"img",12),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(32,"a",15),o.Rb(33,"div",16),o.Ob(34,"img",17),o.Qb(),o.Rb(35,"div",18),o.Ob(36,"h2",19),o.Qb(),o.Ob(37,"div",20),o.Qb(),o.Rb(38,"a",21),o.Rb(39,"div",22),o.Ob(40,"img",17),o.Qb(),o.Rb(41,"div",18),o.Ob(42,"h2",19),o.Qb(),o.Ob(43,"div",20),o.Qb(),o.Rb(44,"a",23),o.Rb(45,"div",24),o.Ob(46,"img",17),o.Qb(),o.Rb(47,"div",18),o.Ob(48,"h2",19),o.Qb(),o.Ob(49,"div",20),o.Qb(),o.Rb(50,"a",25),o.Rb(51,"div",26),o.Ob(52,"img",17),o.Qb(),o.Rb(53,"div",18),o.Ob(54,"h2",19),o.Qb(),o.Ob(55,"div",20),o.Qb(),o.Rb(56,"a",27),o.Rb(57,"h2",28),o.Lc(58),o.Qb(),o.Rb(59,"scrollable",29),o.Yb("click",function(){return e.goToTask()}),o.Jc(60,QE,2,1,"div",30),o.Qb(),o.Qb(),o.Ob(61,"message-of-the-day",31)),2&t&&(o.Bb(1),o.Fb("disabled",!e.allow("profile.menu")),o.kc("tooltip-hint",e.L("meta.ui.profile.menu.sessions")),o.jc("alertSound","ui_back"),o.Bb(1),o.Nc(" ",e.L("meta.ui.profile.menu.sessions")," "),o.Bb(1),o.jc("type","gold")("value",e.userGold)("smallSize",!0),o.Bb(5),o.Fb("disabled",!e.allow("multi.mm.menu")),o.jc("routerLink",o.mc(65,AE))("alertSound",o.mc(66,DE)),o.Bb(2),o.kc("tooltip-hint",e.L("meta.ui.menu.multiplayer.matchmaking")),o.Bb(1),o.Mc(e.L("meta.ui.menu.multiplayer.matchmaking")),o.Bb(2),o.jc("src","assets/img/icons/buttons/matchmaking.svg",o.Cc),o.Bb(1),o.jc("src","assets/img/icons/buttons/matchmaking_hover.svg",o.Cc),o.Bb(2),o.Fb("disabled",!e.allow("multi.lobby.menu")),o.jc("routerLink",o.mc(67,EE))("alertSound",o.mc(68,DE)),o.Bb(2),o.kc("tooltip-hint",e.L("meta.ui.menu.multiplayer.lobby")),o.Bb(1),o.Mc(e.L("meta.ui.menu.multiplayer.lobby")),o.Bb(2),o.jc("src","assets/img/icons/buttons/lobby.svg",o.Cc),o.Bb(1),o.jc("src","assets/img/icons/buttons/lobby_hover.svg",o.Cc),o.Bb(2),o.Fb("disabled",!e.allow("profile.menu")),o.jc("routerLink",o.nc(69,NE,"/profile/"+e.userId))("alertSound",o.mc(71,DE)),o.Bb(3),o.Mc(e.L("meta.ui.menu.multiplayer.statistic")),o.Bb(1),o.kc("tooltip-hint",e.L("meta.ui.menu.multiplayer.statistic_helper")),o.Bb(1),o.Mc(e.L("meta.ui.menu.multiplayer.statistic_helper")),o.Bb(1),o.jc("src","assets/img/icons/buttons/statistic.svg",o.Cc),o.Bb(1),o.jc("src","assets/img/icons/buttons/statistic_hover.svg",o.Cc),o.Bb(1),o.Fb("disabled",!e.allow("multi.mm.pvp")),o.jc("alertSound",o.mc(72,FE))("routerLink",o.mc(73,PE)),o.Bb(2),o.jc("src","assets/img/multiplayer/pvp_pr.jpg",o.Cc),o.Bb(2),o.jc("innerHTML",e.L("meta.ui.menu.multiplayer.pvp").markdown(),o.Ac),o.Bb(2),o.Fb("disabled",!e.allow("multi.mm.pve")),o.jc("alertSound",o.mc(74,FE))("routerLink",o.mc(75,UE)),o.Bb(2),o.jc("src","assets/img/multiplayer/pve_pr2.jpg",o.Cc),o.Bb(2),o.jc("innerHTML",e.L("meta.ui.menu.multiplayer.pve").markdown(),o.Ac),o.Bb(2),o.Fb("disabled",!e.allow("multi.mm.classic")),o.jc("alertSound",o.mc(76,FE))("routerLink",o.mc(77,zE)),o.Bb(2),o.jc("src","assets/img/multiplayer/classical_pr.jpg",o.Cc),o.Bb(2),o.jc("innerHTML",e.L("meta.ui.menu.multiplayer.classic").markdown(),o.Ac),o.Bb(2),o.Fb("disabled",!e.allow("multi.mm.duel")),o.jc("alertSound",o.mc(78,FE))("routerLink",o.mc(79,JE)),o.Bb(2),o.jc("src","assets/img/multiplayer/duel_pr.jpg",o.Cc),o.Bb(2),o.jc("innerHTML",e.L("meta.ui.menu.multiplayer.duel").markdown(),o.Ac),o.Bb(2),o.Fb("disabled",!e.allow("multi.mm.task")),o.jc("alertSound",o.mc(80,FE))("routerLink",o.mc(81,qE)),o.Bb(2),o.Mc(e.L("meta.ui.menu.tasks")),o.Bb(1),o.jc("fade",!0)("bbox",!0),o.Bb(1),o.jc("ngForOf",e.tasksKeys))},encapsulation:2}),t})();const HE=function(){return["/tutorial/main"]},YE=function(){return{hover:"ui_hover_side_panel",click:"ui_click_default"}},WE=function(){return["/tutorial/units"]},KE=function(){return["/tutorial/authors"]};let XE=(()=>{class t{constructor(t){this.cache=t,this.globalEvent=new uu,(new al).data.subscribe(t=>this.L=t)}loadGame(t){t||(t=""),this.cache.alert("load_game:"+t)}allow(t){return this.cache.allow(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd))},t.\u0275cmp=o.Hb({type:t,selectors:[["tutorial"]],hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("grid-default",!0)},features:[o.Ab([nd])],decls:28,vars:27,consts:[["modes",""],[1,"large-tabs-list","clear"],["fade-in","down",1,"list-item"],["routerLinkActive","active","queryParamsHandling","merge",1,"large-tab-button","texture-border",3,"routerLink","alertSound"],[1,"tab-shadow"],[1,"tab-title","text-overflow"],[1,"tab-description","text-overflow"],["draggable","false",1,"tab-icon","default",3,"src"],["draggable","false",1,"tab-icon","hover",3,"src"],["tutorial-main",""]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Rb(1,"ul",1),o.Rb(2,"li",2),o.Rb(3,"a",3),o.Ob(4,"span",4),o.Rb(5,"span",5),o.Lc(6),o.Qb(),o.Ob(7,"span",6),o.Ob(8,"img",7),o.Ob(9,"img",8),o.Qb(),o.Qb(),o.Rb(10,"li",2),o.Rb(11,"a",3),o.Ob(12,"span",4),o.Rb(13,"span",5),o.Lc(14),o.Qb(),o.Ob(15,"span",6),o.Ob(16,"img",7),o.Ob(17,"img",8),o.Qb(),o.Qb(),o.Rb(18,"li",2),o.Rb(19,"a",3),o.Ob(20,"span",4),o.Rb(21,"span",5),o.Lc(22),o.Qb(),o.Ob(23,"span",6),o.Ob(24,"img",7),o.Ob(25,"img",8),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(26,"div",9),o.Ob(27,"router-outlet"),o.Qb()),2&t&&(o.Bb(3),o.Fb("disabled",!e.allow("learn.tutorial")),o.jc("routerLink",o.mc(21,HE))("alertSound",o.mc(22,YE)),o.Bb(3),o.Mc(e.L("meta.ui.stats.mode.tutorial")),o.Bb(2),o.jc("src","assets/img/icons/buttons/learn_tutorial.svg",o.Cc),o.Bb(1),o.jc("src","assets/img/icons/buttons/learn_tutorial_hover.svg",o.Cc),o.Bb(2),o.Fb("disabled",!e.allow("learn.units")),o.jc("routerLink",o.mc(23,WE))("alertSound",o.mc(24,YE)),o.Bb(3),o.Mc(e.L("meta.ui.profile.menu.units")),o.Bb(2),o.jc("src","assets/img/icons/buttons/learn_units.svg",o.Cc),o.Bb(1),o.jc("src","assets/img/icons/buttons/learn_units_hover.svg",o.Cc),o.Bb(2),o.Fb("disabled",!e.allow("learn.authors")),o.jc("routerLink",o.mc(25,KE))("alertSound",o.mc(26,YE)),o.Bb(3),o.Mc(e.L("meta.ui.button.authors_title")),o.Bb(2),o.jc("src","assets/img/icons/buttons/learn_authors.svg",o.Cc),o.Bb(1),o.jc("src","assets/img/icons/buttons/learn_authors_hover.svg",o.Cc))},encapsulation:2}),t})();const ZE=function(){return{hover:"ui_hover_default",click:"ui_click_default"}};let tN=(()=>{class t{constructor(t,e,i,n){this.cache=t,this.router=e,this.chatService=i,this.lobbyService=n,this.globalEvent=new uu,this.tutorialCampaignId="tutorial_rus",this.tutorialCampaign=null,this.progressPercent=0,this.userId="",this.teamId="",(new al).data.subscribe(t=>this.L=t)}ngOnInit(){this.userId=this.cache.getUserId(),this.tutorialCampaign=this.cache.getCampaign(this.tutorialCampaignId),this.tutorialCampaign&&this.tutorialCampaign.progress&&this.tutorialCampaign.nodes&&(this.progressPercent=this.getProgressPercent(this.tutorialCampaign.progress.node,this.tutorialCampaign.nodes.length)),this.teamId=this.cache.getUserTeamId(),this.teamDataSubscription=this.chatService.teamsData.pipe(We(t=>null!==t)).subscribe(t=>{t&&t.id&&(this.teamId=t.id),t&&t.leave&&!0===t.leave&&(this.teamId="")})}getProgressPercent(t,e){let i=0,n=[];for(let s in t)t[s].completed&&n.push(s);return n.length&&(i=Math.round(n.length/e*100)),i}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}selectCampaign(){if(!this.tutorialCampaign)return!1;this.cache.devMode&&console.log("Selected campaign: ",this.tutorialCampaignId),this.tutorialCampaign.progress&&null!=!this.tutorialCampaign.progress?(this.saveCampaignId(this.tutorialCampaignId),this.router.navigate(["campaigns/"+this.tutorialCampaignId+"/detail/missions"],{queryParamsHandling:"merge"})):this.campaignStart(this.tutorialCampaign,this.tutorialCampaignId,!1)}campaignStart(t,e,i){e&&this.cache.campaignStart(e,i).subscribe(t=>{this.saveCampaignId(e),setTimeout(()=>{this.router.navigate(["campaigns/"+e+"/detail/missions"],{queryParamsHandling:"merge"})},50)})}saveCampaignId(t){localStorage.setItem("METAGAME_SELECTED_CAMPAIGN_"+this.userId,JSON.stringify(t))}loadGame(t){t||(t=""),this.cache.alert("load_game:"+t)}allow(t){return this.cache.allow(t)}hasLobby(){return this.lobbyService.hasLobby()}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Ys),o.Nb(Pd),o.Nb(Bl))},t.\u0275cmp=o.Hb({type:t,selectors:[["tutorial-main-page"]],hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("grid-learn",!0)},features:[o.Ab([nd,Pd,Bl])],decls:17,vars:19,consts:[["g-learn-top",""],["type","button",1,"button","small",3,"tooltip-hint","alertSound","click"],["g-learn-tile",""],["fade-in","down","delay",".1",1,"tile","texture-border","clickable",3,"alertSound","click"],[1,"masked-image","mask-tutorial"],["image-load","",3,"src"],[1,"tile-heading"],[3,"innerHTML"],[1,"tile-content"],[1,"progress"],[1,"progress-title"],[1,"progress-bar","full-width"]],template:function(t,e){1&t&&(o.Rb(0,"div",0),o.Rb(1,"button",1),o.Yb("click",function(){return e.loadGame("")}),o.Lc(2),o.Qb(),o.Rb(3,"button",1),o.Yb("click",function(){return e.triggerGlobalEvent("statistics_list.open")}),o.Lc(4),o.Qb(),o.Qb(),o.Rb(5,"div",2),o.Rb(6,"div",3),o.Yb("click",function(){return e.selectCampaign(),e.triggerGlobalEvent("play.select_campaign",{campaignId:e.tutorialCampaignId})}),o.Rb(7,"div",4),o.Ob(8,"img",5),o.Qb(),o.Rb(9,"div",6),o.Ob(10,"h2",7),o.Qb(),o.Rb(11,"div",8),o.Rb(12,"div",9),o.Rb(13,"div",10),o.Lc(14),o.Qb(),o.Rb(15,"div",11),o.Ob(16,"span"),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb()),2&t&&(o.Bb(1),o.Fb("disabled",e.hasLobby()),o.kc("tooltip-hint",e.L("meta.ui.play.load_save_button")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.play.load_save_button")," "),o.Bb(1),o.Fb("disabled",!e.allow("profile.menu")),o.kc("tooltip-hint",e.L("meta.ui.profile.menu.sessions")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",e.L("meta.ui.profile.menu.sessions")," "),o.Bb(2),o.Fb("disabled",!e.allow("learn.tutorial")||e.teamId||e.hasLobby()),o.jc("alertSound",o.mc(18,ZE)),o.Bb(2),o.jc("src","assets/img/multiplayer/rus_tank_tutorial.jpg",o.Cc),o.Bb(2),o.jc("innerHTML",e.L("meta.ui.menu.multiplayer.tutorial").markdown(),o.Ac),o.Bb(4),o.Oc(" ",e.L("meta.ui.campaign.finished"),": ",e.progressPercent,"% "),o.Bb(2),o.Cb("style","width:"+e.progressPercent+"%",o.Bc))},encapsulation:2}),t})();const eN=["barack"],iN=["calculator"];function nN(t,e){if(1&t&&(o.Rb(0,"span",10),o.Ob(1,"currency",11),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("type","gold")("value",t.userGold)("smallSize",!0)}}function sN(t,e){if(1&t&&(o.Rb(0,"span",10),o.Ob(1,"currency",12),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("type",t.campaignCurrency)("value",(null==t.campaign.progress?null:t.campaign.progress.money.silver)||0)("smallSize",!0)}}function aN(t,e){if(1&t&&o.Ob(0,"barrack",13,14),2&t){const t=o.bc();o.jc("campaignId",t.campaignId)}}function rN(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",31),o.Yb("click",function(){return o.zc(t),o.bc(6).openPurchaseMenu()}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(6);o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L("meta.ui.menu.buy")," ")}}function oN(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",32),o.Yb("click",function(){return o.zc(t),o.bc(6).dismissPurchaseMenu()}),o.Ob(1,"img",33),o.Qb()}2&t&&o.jc("alertSound","ui_click_default")}function cN(t,e){if(1&t&&(o.Rb(0,"div",28),o.Jc(1,rN,2,2,"button",29),o.Jc(2,oN,2,1,"button",30),o.Qb()),2&t){const t=o.bc(5);o.Bb(1),o.jc("ngIf",!t.purchasingUnit),o.Bb(1),o.jc("ngIf",t.purchasingUnit)}}const lN=function(t){return{amount:t}};function uN(t,e){if(1&t&&(o.Rb(0,"div",25),o.Rb(1,"div",26),o.Rb(2,"h4"),o.Lc(3),o.Qb(),o.Qb(),o.Jc(4,cN,3,2,"div",27),o.Qb()),2&t){const t=o.bc(4);o.Bb(3),o.Mc(t.L("meta.ui.troops.unit_available_amount",o.nc(2,lN,t.selectedUnit.barrack?t.selectedUnit.barrack.available:0))),o.Bb(1),o.jc("ngIf",!t.selectedUnit.collectible)}}function dN(t,e){if(1&t&&(o.Rb(0,"h4"),o.Lc(1),o.Qb()),2&t){const t=o.bc(4);o.Bb(1),o.Mc(t.L("meta.ui.troops.units_available_infinite"))}}function hN(t,e){if(1&t&&o.Ob(0,"h5",34),2&t){const t=o.bc(4);o.jc("innerHTML",t.L("meta.hint.collectible_unit").markdown().br(),o.Ac)}}function bN(t,e){if(1&t&&o.Ob(0,"currency",12),2&t){const t=o.bc(6);o.jc("type",t.campaignCurrency)("value",(t.purchasingUnit.silverCost*t.purchasingUnit.pay).cat())("smallSize",!0)}}const mN=function(t,e){return{amount:t,currency:e}};function pN(t,e){if(1&t&&(o.Rb(0,"div",44),o.Rb(1,"div"),o.Lc(2),o.Qb(),o.Rb(3,"div",45),o.Lc(4),o.Jc(5,bN,1,3,"currency",46),o.Qb(),o.Qb()),2&t){const t=o.bc(5);o.kc("tooltip-hint",t.L("meta.hint.play.unit."+t.campaignCurrency+"_cost")),o.Bb(2),o.Nc("",t.L("meta.ui.troops.cost_per_unit",o.oc(5,mN,t.purchasingUnit.silverCost,t.L("meta.ui.store.currency."+t.campaignCurrency))),"\xa0"),o.Bb(2),o.Oc(" ",t.purchasingUnit.silverCost," x ",t.purchasingUnit.pay," = "),o.Bb(1),o.jc("ngIf",t.campaignId&&t.campaignCurrency)}}function gN(t,e){if(1&t&&(o.Rb(0,"b",48),o.Rb(1,"div",45),o.Lc(2),o.Ob(3,"currency",12),o.Qb(),o.Qb()),2&t){const t=o.bc(6);o.Bb(2),o.Oc(" ",t.purchaseUnitPrice.oldPrice," x ",t.purchasingUnit.pay," = "),o.Bb(1),o.jc("type","bonds")("value",(t.purchaseUnitPrice.oldPrice*t.purchasingUnit.pay).cat())("smallSize",!0)}}function fN(t,e){if(1&t&&(o.Rb(0,"div",44),o.Rb(1,"div"),o.Lc(2),o.Qb(),o.Rb(3,"div",45),o.Lc(4),o.Ob(5,"currency",12),o.Qb(),o.Jc(6,gN,4,5,"b",47),o.Qb()),2&t){const t=o.bc(5);o.kc("tooltip-hint",t.L("meta.hint.play.unit.gold_cost")),o.Bb(2),o.Nc(" ",t.L("meta.ui.troops.cost_per_unit",o.oc(8,mN,t.purchaseUnitPrice.price,t.L("meta.ui.store.currency.bonds")))," "),o.Bb(2),o.Oc(" ",t.purchaseUnitPrice.price," x ",t.purchasingUnit.pay," = "),o.Bb(1),o.jc("type","bonds")("value",(t.purchaseUnitPrice.price*t.purchasingUnit.pay).cat())("smallSize",!0),o.Bb(1),o.jc("ngIf",t.purchaseUnitPrice.isSale)}}function vN(t,e){if(1&t&&(o.Rb(0,"div",45),o.Ob(1,"currency",12),o.Qb()),2&t){const t=o.bc(6);o.Bb(1),o.jc("type",t.campaignId&&t.campaignCurrency?t.campaignCurrency:"silver")("value",t.getSilverLack(t.purchasingUnit).cat())("smallSize",!0)}}function yN(t,e){if(1&t&&(o.Rb(0,"span"),o.Ob(1,"img",51),o.Lc(2),o.Qb()),2&t){const t=o.bc(6);o.Bb(2),o.Nc(" ",t.getGoldLack(t.purchasingUnit).cat(),"")}}function _N(t,e){if(1&t&&(o.Rb(0,"div",49),o.Lc(1),o.Ob(2,"br"),o.Jc(3,vN,2,3,"div",50),o.Jc(4,yN,3,1,"span",18),o.Qb()),2&t){const t=o.bc(5);o.Bb(1),o.Nc(" ",t.L("meta.ui.recruit.message_no_money")," "),o.Bb(2),o.jc("ngIf",!t.purchasingUnit.premiumGold),o.Bb(1),o.jc("ngIf",t.purchasingUnit.premiumGold)}}function kN(t,e){if(1&t&&(o.Rb(0,"span"),o.Ob(1,"currency",12),o.Qb()),2&t){const t=o.bc(5);o.Bb(1),o.jc("type","gold")("value",t.userGold.cat())("smallSize",!0)}}function wN(t,e){if(1&t&&(o.Rb(0,"span"),o.Ob(1,"currency",12),o.Qb()),2&t){const t=o.bc(5);o.Bb(1),o.jc("type",t.campaignCurrency)("value",(null==t.campaign.progress?null:t.campaign.progress.money.silver.cat())||0)("smallSize",!0)}}function SN(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",35),o.Rb(1,"calculator",36,37),o.Yb("onChange",function(e){return o.zc(t),o.bc(4).purchasingUnit.pay=e.value}),o.Qb(),o.Rb(3,"div",38),o.Jc(4,pN,6,8,"div",39),o.Jc(5,fN,7,11,"div",39),o.Qb(),o.Jc(6,_N,5,3,"div",40),o.Rb(7,"div",41),o.Rb(8,"div",42),o.Rb(9,"button",43),o.Yb("click",function(){return o.zc(t),o.bc(4).buyUnit()}),o.Lc(10),o.Qb(),o.Qb(),o.Rb(11,"div",42),o.Jc(12,kN,2,3,"span",18),o.Jc(13,wN,2,3,"span",18),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc(4);o.Bb(1),o.jc("min",1)("max",t.getMaximumPurchaseAmount())("step",1),o.Bb(3),o.jc("ngIf",!t.purchasingUnit.premiumGold&&t.campaignId&&t.campaignCurrency),o.Bb(1),o.jc("ngIf",t.purchasingUnit.premiumGold),o.Bb(1),o.jc("ngIf",!t.isEnoughCurrencyToBuyUnit(t.purchasingUnit)),o.Bb(3),o.Fb("disabled",!t.isEnoughCurrencyToBuyUnit(t.purchasingUnit)),o.kc("tooltip-hint",t.L("meta.hint.play.echelon.recruit")),o.jc("alertSound","ui_buy"),o.Cb("data-tooltip",t.L("meta.ui.recruit.button_recruit")),o.Bb(1),o.Nc(" ",t.L("meta.ui.recruit.button_recruit")," "),o.Bb(2),o.jc("ngIf",!t.campaignId&&!t.campaignCurrency),o.Bb(1),o.jc("ngIf",t.campaignId&&t.campaignCurrency)}}function IN(t,e){if(1&t&&(o.Rb(0,"div",21),o.Jc(1,uN,5,4,"div",22),o.Jc(2,dN,2,1,"h4",18),o.Jc(3,hN,1,1,"h5",23),o.Jc(4,SN,14,14,"div",24),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.jc("ngIf",!t.isUnitUnlimited(t.selectedUnit)),o.Bb(1),o.jc("ngIf",t.isUnitUnlimited(t.selectedUnit)),o.Bb(1),o.jc("ngIf",t.selectedUnit.collectible),o.Bb(1),o.jc("ngIf",t.purchasingUnit&&!t.purchasingUnit.collectible&&!t.isUnitUnlimited(t.purchasingUnit))}}function CN(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,IN,5,4,"div",20),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.jc("ngIf",t.selectedUnit.open&&!t.selectedCommander.containsForbiddenUnits&&!t.selectedCommander.const&&t.selectedCommander.available)}}const LN=function(){return{head:!0,fullDescription:!1,counters:!0,chart:!1}};function RN(t,e){if(1&t&&(o.Rb(0,"div",15),o.Rb(1,"scrollable",16,17),o.Jc(3,CN,2,1,"div",18),o.Ob(4,"unit-details",19),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("bbox",!0)("fade",!0),o.Bb(2),o.jc("ngIf",t.isBarackAvailable()),o.Bb(1),o.jc("unit",t.selectedUnit)("campaignId",t.campaignId)("campaignCurrency",t.campaignCurrency)("unitData",o.mc(7,LN))}}const ON=function(t){return[t]};let TN=(()=>{class t{constructor(t,e,i,n,s){this.cache=t,this.router=e,this.activatedRoute=i,this.sanitizer=n,this.notificatorService=s,this.levels=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],this.globalEvent=new uu,this.counters={},this.isTraining=!1,this.parentRoute="",this.showDifficulty=!1,this.duelModeEnabled=!1,this.showBarrack=!1,this.userGold=0,this.userSilver=0,this.userExpo=0,this.selectedCommander=null,this.selectedCommanderTask="",this.discount=null,this.discountTask=null,this.discountTaskProgress=null,this.commanderProgress=null,this.containsForbiddenUnits=!1,this.missionNodeId="",this.campaignCurrency="",this.campaign=null,this.campaignId="",this.mission=null,this.missionId="",this.missionTask=null,this.selectedUnit=null,this.slot=null,this.menuIsOpened=!1,(new al).data.subscribe(t=>this.L=t),(new dl).data.subscribe(t=>this.I=t),this.counters=this.cache.getCounters(),this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>{this.counters[t.path]=t.value})}ngOnInit(){this.isTraining=this.activatedRoute.data.value.training||!1,this.parentRoute=this.activatedRoute.data.value.parent,this.showDifficulty=this.activatedRoute.data.value.showDifficulty,this.duelModeEnabled="multiplayer/duel"===this.activatedRoute.data.value.parent||!1,this.cache.userGold.subscribe(t=>this.userGold=t),this.cache.userSilver.subscribe(t=>this.userSilver=t),this.cache.userFreeXp.subscribe(t=>this.userExpo=t),this.globalEvent.subject.pipe(We(t=>null!==t)).subscribe(t=>{t&&t.key&&t.key.match(/slot/gim)&&setTimeout(()=>{this.commanderProgress=null,this.commanderProgress=this.cache.getCommanderProgress(this.commanderId)},100),t&&"troops.select_unit"==t.key&&this.setSelectedUnit(t.data),t&&"update.select_unit"==t.key&&this.updateSelectedUnit(t.data)}),this.showBarrackSubsciption=this.cache.showBarrack.subscribe(t=>{setTimeout(()=>{this.showBarrack=t})}),this.purchaseUnitSubscription=this.cache.unitToPurchaseInBarrack.subscribe(t=>{this.processPurchaseModal(t?t.unit:null,null)}),this.purchaseUnitToSlotSubscription=this.cache.unitToPurchaseInSlot.subscribe(t=>{t?this.processPurchaseModal(t.slot?t.slot.unit||t.slot.provisionalBuy:null,t.slot):this.processPurchaseModal(null,null)}),this.slotSubscription=this.cache.slot.pipe(We(t=>null!==t)).subscribe(t=>{this.slot=t}),this.activatedRouteSubscription=this.activatedRoute.paramMap.subscribe(t=>{this.missionId=t.params.missionId,this.campaignId=t.params.campaignId,this.selectedCommander=this.cache.getCommander(t.params.commanderId),console.log(t.params.commanderId),this.campaign=this.cache.getCampaign(this.campaignId),this.campaign&&(this.campaignCurrency=this.campaign.currency),this.mission=this.cache.getMission(this.missionId),this.missionTask=this.mission&&this.mission.task?this.mission.task:null,this.selectedUnit=null})}ngOnDestroy(){this.purchaseUnitSubscription&&this.purchaseUnitSubscription.unsubscribe(),this.purchaseUnitToSlotSubscription&&this.purchaseUnitToSlotSubscription.unsubscribe(),this.showBarrackSubsciption&&this.showBarrackSubsciption.unsubscribe(),this.commandersSubscribtion&&this.commandersSubscribtion.unsubscribe(),this.cache.getSelectedCommanderForArmy(this.cache.getCurrentArmy()),this.activatedRouteSubscription&&this.activatedRouteSubscription.unsubscribe(),this.slotSubscription&&this.slotSubscription.unsubscribe()}isCommanderAvailableToBuy(t){return this.cache.isCommanderAvailableToBuy(t)}isCommanderFilled(t){return this.cache.isCommanderFilled(t)}purchaseUnits(t){t?this.cache.purchaseUnitsToBarrack(t.id):(this.cache.dismissPurchaseUnitsToBarrack(),this.cache.dismissPurchaseUnitsToSlot())}buyUnit(){if(this.purchasingUnit.premium){let t=this.purchasingUnit.pay||1;this.cache.openConfirmModal({key:"meta.hint.store.purchase_accept_message",confirm:"meta.ui.button_accept",decline:"meta.ui.button_decline",title:"meta.ui.store.confirmation"},()=>{this.processUnitPurchase()},{item:(t>1?`x${t} `:"")+this.L("unit."+this.purchasingUnit.id+".short"),cost:(this.purchaseUnitPrice.price*t).cat()})}else this.processUnitPurchase(),this.campaignId&&this.computeCampaignCurrency(this.purchasingUnit.silverCost*this.purchasingUnit.pay)}processUnitPurchase(){this.cache.startLoadingProgress("purchaseUnit"),this.cache.buyUnit(this.purchasingUnit,this.purchasingSlot,this.campaignId).subscribe(t=>{this.menuIsOpened=!1,setTimeout(()=>{this.cache.stopLoadingProgress("purchaseUnit")},500)},t=>{this.cache.stopLoadingProgress("purchaseUnit")})}isSlot(t){return!!t&&"amountUnit"in t}isUnit(t){return!!t&&"image"in t}processPurchaseModal(t,e){this.purchasingSlot=e,t?(this.purchasingUnit=kl.clone(t,{pay:1,mode:gl.Exchanger}),this.purchaseUnitPrice=this.cache.getStoreItemPrice(this.purchasingUnit.id)):this.purchasingUnit&&(this.purchasingUnit=null,this.purchasingSlot=null)}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}isLoadingProgressRunning(t){return this.cache.isLoadingProgressRunning(t)}getMaximumPurchaseAmount(){return this.cache.purchaseUnitAmount||10}isEnoughCurrencyToBuyUnit(t){return!(t.premiumGold?this.getGoldLack(t)>0:this.getSilverLack(t)>0)}getSilverLack(t){return Math.max(t.silverCost*t.pay-this.getSilver(),0)}getGoldLack(t){return Math.max(t.premiumGold*t.pay-this.getGold(),0)}getSilver(){return this.campaignId?this.cache.getCampaignSilver(this.campaignId):this.userSilver}getXp(){return this.campaignId?this.cache.getCampaignFreeXp(this.campaignId):this.userExpo}getGold(){return this.userGold}allow(t){return this.cache.allow(t)}hasCounter(t){return this.cache.hasCounter(t)}void(){}computeCampaignCurrency(t){if(!t||!this.campaignId)return;let e=this.cache.getCampaignSilver(this.campaignId),i=this.cache.getCampaignFreeXp(this.campaignId);this.cache.setCampaignCurrency(this.campaignId,i,e-t)}isUnitUnlimited(t){return this.cache.isUnitUnlimited(t,this.slot.parent.commander)}openPurchaseMenu(){this.processPurchaseModal(this.selectedUnit,this.slot),this.menuIsOpened=!0}dismissPurchaseMenu(){this.cache.dismissPurchaseUnitsToBarrack(),this.menuIsOpened=!1}isBarackAvailable(){return!(!this.barack||!this.barack.units.length)}setSelectedUnit(t){console.log(t),t&&t.unitId&&t.unitId.length?(this.selectedUnit=this.cache.getBarrackUnit(t.unitId,this.slot,this.campaignId)||this.cache.getTreeUnit(t.unitId),this.purchasingUnit&&(this.dismissPurchaseMenu(),this.isUnitUnlimited(this.selectedUnit)||(this.purchasingUnit=this.selectedUnit,this.openPurchaseMenu()))):this.selectedUnit=null,console.log("selectedUnit",this.selectedUnit),this.calculator&&this.calculator.reset()}updateSelectedUnit(t){t&&t.unit&&this.selectedUnit&&t.unit.id==this.selectedUnit.id&&(this.selectedUnit=t.unit)}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(Ys),o.Nb(xn),o.Nb(Er),o.Nb(Uc))},t.\u0275cmp=o.Hb({type:t,selectors:[["regiment-editor"]],viewQuery:function(t,e){if(1&t&&(o.Qc(eN,!0),o.Qc(iN,!0)),2&t){let t;o.vc(t=o.Zb())&&(e.barack=t.first),o.vc(t=o.Zb())&&(e.calculator=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("grid-default",!0)},features:[o.Ab([nd,Uc])],decls:14,vars:13,consts:[["g-commander-name",""],["g-currency",""],["style","display: inline-block",4,"ngIf"],["href","","queryParamsHandling","merge","g-back","",1,"button","white",3,"routerLink","tooltip-hint","alertSound","key-duplicator"],[1,"icon-group"],["src","assets/img/icons/svg/back-button-icon.svg","draggable","false",1,"icon","hover-hidden"],["src","assets/img/icons/svg/back-button-icon_hover.svg","draggable","false",1,"icon","hover-visible"],[3,"campaignId",4,"ngIf"],["g-unit-amount",""],["class","unit-characteristics",4,"ngIf"],[2,"display","inline-block"],[2,"display","inline-block",3,"type","value","smallSize"],[3,"type","value","smallSize"],[3,"campaignId"],["barack",""],[1,"unit-characteristics"],[3,"bbox","fade"],["scrollable",""],[4,"ngIf"],["fade-in","",3,"unit","campaignId","campaignCurrency","unitData"],["class","unit-amount texture-border static margin-bottom-small dark",4,"ngIf"],[1,"unit-amount","texture-border","static","margin-bottom-small","dark"],["class","row align-middle",4,"ngIf"],["class","collectible-header",3,"innerHTML",4,"ngIf"],["class","margin-top",4,"ngIf"],[1,"row","align-middle"],[1,"col-6",2,"padding-right","0"],["class","col-6 align-right",4,"ngIf"],[1,"col-6","align-right"],["type","button","class","button small",3,"alertSound","click",4,"ngIf"],["type","button","class","button small transparent",3,"alertSound","click",4,"ngIf"],["type","button",1,"button","small",3,"alertSound","click"],["type","button",1,"button","small","transparent",3,"alertSound","click"],["src","assets/img/icons/svg/cross.svg",1,"icon"],[1,"collectible-header",3,"innerHTML"],[1,"margin-top"],[3,"min","max","step","onChange"],["calculator",""],[1,"margin-top","spaced-bottom"],[3,"tooltip-hint",4,"ngIf"],["class","alert",4,"ngIf"],[1,"row","margin-top","align-middle"],[1,"col-6"],[1,"button","red","small",3,"tooltip-hint","alertSound","click"],[3,"tooltip-hint"],[1,"purchase-detail"],[3,"type","value","smallSize",4,"ngIf"],["class","old-price","style","margin-left: calc(var(--checkbox-size) / 2);",4,"ngIf"],[1,"old-price",2,"margin-left","calc(var(--checkbox-size) / 2)"],[1,"alert"],["class","purchase-detail",4,"ngIf"],["src","assets/img/icons/svg/bonds.svg",1,"icon",2,"margin-top","-1em","margin-bottom","-1em"]],template:function(t,e){1&t&&(o.Rb(0,"h2",0),o.Lc(1),o.Qb(),o.Rb(2,"div",1),o.Jc(3,nN,2,3,"span",2),o.Jc(4,sN,2,3,"span",2),o.Qb(),o.Rb(5,"a",3),o.Rb(6,"span",4),o.Ob(7,"img",5),o.Ob(8,"img",6),o.Qb(),o.Lc(9),o.Qb(),o.Ob(10,"echelons"),o.Jc(11,aN,2,1,"barrack",7),o.Rb(12,"div",8),o.Jc(13,RN,5,8,"div",9),o.Qb()),2&t&&(o.Bb(1),o.Mc(e.L("commander."+(null==e.selectedCommander?null:e.selectedCommander._id)+".name")),o.Bb(2),o.jc("ngIf",!e.campaignId&&!e.campaignCurrency),o.Bb(1),o.jc("ngIf",e.campaignId&&e.campaignCurrency),o.Bb(1),o.kc("tooltip-hint",e.L("meta.ui.play.back")),o.jc("routerLink",o.nc(11,ON,e.missionId?"/campaigns/"+e.campaignId+"/missions/"+e.missionId:"/"+e.parentRoute||!1))("alertSound","ui_back")("key-duplicator",27),o.Cb("data-tooltip",e.L("meta.ui.play.back")),o.Bb(4),o.Nc(" ",e.L("meta.ui.play.back"),"\n"),o.Bb(2),o.jc("ngIf",e.selectedCommander&&!e.selectedCommander.const),o.Bb(2),o.jc("ngIf",e.selectedUnit))},encapsulation:2}),t})();function xN(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",11),o.Rb(1,"button",12),o.Yb("click",function(){return o.zc(t),o.bc().openRulesModal()}),o.Rb(2,"span",13),o.Ob(3,"img",14),o.Ob(4,"img",15),o.Qb(),o.Rb(5,"span",16),o.Lc(6),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(1),o.jc("alertSound","ui_click_default"),o.Bb(5),o.Mc(t.L("meta.ui.mode.rules.button_text"))}}function BN(t,e){if(1&t&&o.Ob(0,"currency",21),2&t){const t=o.bc().$implicit;o.jc("value",t.value.cat())("type",t.key)("smallSize",!0)}}function jN(t,e){if(1&t&&(o.Rb(0,"div",19),o.Jc(1,BN,1,3,"currency",20),o.Qb()),2&t){const t=e.$implicit,i=o.bc(2);o.Fb("not-loaded",!i.isLoaded)("disabled",!i.isLoaded),o.Bb(1),o.jc("ngIf","freeXpTotal"!=t.key&&"silverTotal"!=t.key)}}function MN(t,e){if(1&t&&(o.Rb(0,"div",17),o.Jc(1,jN,2,5,"div",18),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("ngForOf",t.campaignMoney)}}function QN(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",25),o.Rb(1,"div",26),o.Rb(2,"div",27),o.Rb(3,"unit",28),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(2).setActiveUnit(i.opensBy)}),o.Qb(),o.Qb(),o.Rb(4,"div",29),o.Rb(5,"div",30),o.Ob(6,"currency",31),o.Qb(),o.Qb(),o.Rb(7,"div",32),o.Rb(8,"unit",33),o.Yb("click",function(){o.zc(t);const i=e.$implicit;return o.bc(2).setActiveUnit(i.child)}),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,i=o.bc(2);o.Bb(3),o.Fb("selected",i.activeUnit&&i.activeUnit.id==t.opensBy.id),o.jc("data",t.opensBy)("alertSound","ui_click_default"),o.Bb(3),o.jc("type","free_xp")("value",t.xpNeeded.cat())("smallSize",!0),o.Bb(2),o.Fb("selected",i.activeUnit&&i.activeUnit.id==t.child.id),o.jc("data",t.child)("alertSound","ui_click_default")("campaignId",i.campaignId)}}function AN(t,e){if(1&t&&(o.Rb(0,"scrollable",22,23),o.Jc(2,QN,9,12,"div",24),o.Qb()),2&t){const t=o.bc();o.jc("fade",!0)("origin","left")("bbox",!0),o.Bb(2),o.jc("ngForOf",t.treePreview)}}function DN(t,e){if(1&t&&o.Ob(0,"empty",34),2&t){const t=o.bc();o.jc("desc",t.L("meta.ui.tech.no_units_to_open"))}}const EN=function(){return{key:27,zIndex:1}};function NN(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div",35),o.Rb(1,"button",36),o.Yb("click",function(){return o.zc(t),o.bc().closeUnitDetail()}),o.Lc(2),o.Qb(),o.Qb()}if(2&t){const t=o.bc();o.Bb(1),o.kc("tooltip-hint",t.L("meta.ui.store.close")),o.jc("alertSound","ui_click_default")("key-duplicator",o.mc(4,EN)),o.Bb(1),o.Nc(" \u2715 ",t.L("meta.ui.store.close")," ")}}const FN=function(){return{head:!0,fullDescription:!1,counters:!0,chart:!1}};function PN(t,e){if(1&t&&(o.Rb(0,"div",37),o.Rb(1,"scrollable",38,23),o.Ob(3,"open-unit",39),o.Ob(4,"unit-details",40),o.Qb(),o.Qb()),2&t){const t=o.bc();o.Bb(1),o.jc("bbox",!0)("fade",!0),o.Bb(2),o.jc("receivedUnit",t.activeUnit)("receivedCampaign",t.campaignId),o.Bb(1),o.jc("unit",t.activeUnit)("campaignId",t.campaignId)("campaignCurrency",t.campaignCurrency)("unitData",o.mc(8,FN))}}const UN=function(t){return[t]};let zN=(()=>{class t{constructor(t){this.cache=t,this.campaign=null,this.campaignId="",this.campaignMoney=[],this.campaignCurrency="",this.globalEvent=new uu,this.treePreview=[],this.isLoaded=!1,this.campaignHasMap=!1,(new al).data.subscribe(t=>this.L=t)}ngOnInit(){this._fetchCampaignData(),this.globalEvent.subscribe(t=>{"troops.unit_explore"===t.key&&this.updateData()}),this.ownerChangeSubscription=this.cache.ownerChange.pipe(We(t=>null!==t)).subscribe(()=>{setTimeout(()=>{console.warn("Owner change update [Tech tree simple]"),this._fetchCampaignData()},1e3)})}_fetchCampaignData(){this.isLoaded=!1,this.treePreview=[],this.campaign=this.cache.getGlobalCampaign(),this.campaignId=this.campaign?this.cache.getGlobalCampaign().id:"",this.campaignHasMap=this.campaign&&this.campaign.phase&&this.campaign.phase.length,this.campaignId&&(this.campaignMoney=this.getCampaignMoney(this.campaign),this.treePreview=this.cache.getCampaignUnitsPreview(this.campaignId),console.log(this.treePreview),this.campaignCurrency=this.cache.getCampaign(this.campaignId).currency),setTimeout(()=>{this.isLoaded=!0},550)}getCampaignMoney(t){let e=[];if(!t)return e;let i=null;if(t&&t.progress&&t.progress.money){i=t.progress.money;for(let n in i){let s={};"silver"==n&&t.currency?(s.key=t.currency,s.value=i[n],e.push(s)):"freeXp"==n?(s.key="free_xp",s.value=i[n],e.push(s)):(s.key=n,s.value=i[n],e.push(s))}}return e}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}setActiveUnit(t){t&&(this.activeUnit=t,this.cache.alertSound("ui_panel_appear_woosh"))}closeUnitDetail(){this.activeUnit=null}updateData(){this.campaignMoney=this.getCampaignMoney(this.campaign),this.treePreview=this.cache.getCampaignUnitsPreview(this.campaignId),this.activeUnit=null}openRulesModal(){this.triggerGlobalEvent("tech_tree_rules_modal.open")}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd))},t.\u0275cmp=o.Hb({type:t,selectors:[["tech-tree-simple"]],hostVars:2,hostBindings:function(t,e){2&t&&o.Fb("grid-default",!0)},features:[o.Ab([])],decls:16,vars:21,consts:[["class","rules-helper",4,"ngIf"],["g-campaign-tech-simple","",1,"preview-cover"],["class","money spaced-bottom",4,"ngIf"],[1,"title-with-button","spaced-bottom"],["href","","queryParamsHandling","merge","routerLinkActive","active",1,"button","small","tech-small-link",3,"routerLink","tooltip-hint","alertSound","click"],[1,"preloader"],[1,"tree-inner"],["style","height: 95%",3,"fade","origin","bbox",4,"ngIf"],[3,"desc",4,"ngIf"],["g-campaign-unit-close","","class","align-right",4,"ngIf"],["g-campaign-unit-unlock","",4,"ngIf"],[1,"rules-helper"],[1,"button","white",3,"alertSound","click"],[1,"icon-group"],["src","assets/img/icons/svg/attention-light.svg","draggable","false",1,"icon","hover-hidden"],["src","assets/img/icons/svg/attention-red.svg","draggable","false",1,"icon","hover-visible"],[1,"text"],[1,"money","spaced-bottom"],["class","money-item",3,"not-loaded","disabled",4,"ngFor","ngForOf"],[1,"money-item"],[3,"value","type","smallSize",4,"ngIf"],[3,"value","type","smallSize"],[2,"height","95%",3,"fade","origin","bbox"],["scrollable",""],["class","tree-preview",4,"ngFor","ngForOf"],[1,"tree-preview"],[1,"preview-line"],[1,"unit-cover","left"],[3,"data","alertSound","click"],[1,"arrow"],[1,"value"],[3,"type","value","smallSize"],[1,"unit-cover","right"],[3,"data","alertSound","campaignId","click"],[3,"desc"],["g-campaign-unit-close","",1,"align-right"],[1,"button","white",3,"tooltip-hint","alertSound","key-duplicator","click"],["g-campaign-unit-unlock",""],[3,"bbox","fade"],[1,"spaced-bottom-larger",3,"receivedUnit","receivedCampaign"],["fade-in","",3,"unit","campaignId","campaignCurrency","unitData"]],template:function(t,e){1&t&&(o.Jc(0,xN,7,2,"div",0),o.Rb(1,"div",1),o.Jc(2,MN,2,1,"div",2),o.Rb(3,"div",3),o.Rb(4,"h3"),o.Lc(5),o.Qb(),o.Rb(6,"a",4),o.Yb("click",function(){return e.triggerGlobalEvent("button.technology.full")}),o.Lc(7),o.Qb(),o.Qb(),o.Rb(8,"div",5),o.Ob(9,"span"),o.Lc(10),o.Qb(),o.Rb(11,"div",6),o.Jc(12,AN,3,4,"scrollable",7),o.Jc(13,DN,1,1,"empty",8),o.Qb(),o.Qb(),o.Jc(14,NN,3,5,"div",9),o.Jc(15,PN,5,9,"div",10)),2&t&&(o.jc("ngIf",!e.activeUnit),o.Bb(1),o.Fb("with-map",e.campaignHasMap),o.Bb(1),o.jc("ngIf",e.campaignMoney),o.Bb(3),o.Mc(e.L("meta.ui.tech.available_to_unlock")),o.Bb(1),o.kc("tooltip-hint",e.L("meta.ui.tech.show_full_version")),o.jc("routerLink",o.nc(19,UN,"/campaigns/"+e.campaignId+"/technology/full"))("alertSound","ui_click_default"),o.Cb("data-tooltip",e.L("meta.ui.tech.show_full_version")),o.Bb(1),o.Nc(" ",e.L("meta.ui.tech.show_full_version")," "),o.Bb(1),o.Fb("disabled",e.isLoaded),o.Bb(2),o.Nc("",e.L("meta.ui.tech.preloader")," "),o.Bb(1),o.Fb("active",e.isLoaded),o.Bb(1),o.jc("ngIf",e.treePreview&&e.treePreview.length),o.Bb(1),o.jc("ngIf",!e.treePreview||!e.treePreview.length),o.Bb(1),o.jc("ngIf",e.activeUnit),o.Bb(1),o.jc("ngIf",e.activeUnit))},encapsulation:2}),t})(),JN=(()=>{class t{transform(t,e){let i=new Date(t);return t?i.toLocaleDateString(e,{month:"long",day:"numeric",year:"numeric"}):t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Mb({name:"datetime",type:t,pure:!0}),t})(),qN=(()=>{class t{transform(t,e){let i=new Date(1e3*t);return t?i.toLocaleTimeString(e,{minute:"2-digit",second:"2-digit"}):t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Mb({name:"duration",type:t,pure:!0}),t})(),VN=(()=>{class t{transform(t,e,i,n=!1){if(Array.isArray(t))return e&&"all"!==i?t=t.filter(t=>n?Iu(t,e).match(new RegExp(`^(${i.escapeSpecialChars()})`,"gim")):Iu(t,e)===i):t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Mb({name:"filterList",type:t,pure:!0}),t})(),$N=(()=>{class t{transform(t,e,i){return t.filter(i||(t=>t.open||t.barrack.available>0))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Mb({name:"openedUnits",type:t,pure:!0}),t})(),GN=(()=>{class t{transform(t,e,i){return t.filter(i||(t=>!t.open&&t.barrack.available<=0))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Mb({name:"closedUnits",type:t,pure:!0}),t})(),HN=(()=>{class t{transform(t){if(Array.isArray(t))return t.reverse(),t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Mb({name:"reverse",type:t,pure:!0}),t})(),YN=(()=>{class t{transform(t,e){if(Array.isArray(t))return e?t=t.filter(t=>t.relation===e):t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Mb({name:"friendRelationFilter",type:t,pure:!0}),t})();const WN=[{path:"multiplayer",component:BE,data:{parent:"multiplayer"},children:[{path:"main",component:GE,data:{}},{path:"pvp",component:pw,data:{mode:"pvp",parent:"multiplayer/pvp",showDifficulty:!0}},{path:"pvp/:commanderId",component:TN,data:{parent:"multiplayer/pvp",showDifficulty:!0,showBarrack:!0}},{path:"duel",component:pw,data:{mode:"duel",parent:"multiplayer/duel",showDifficulty:!0}},{path:"duel/:commanderId",component:TN,data:{parent:"multiplayer/duel",showDifficulty:!0,showBarrack:!0}},{path:"pve",component:pw,data:{mode:"pve",parent:"multiplayer/pve",showDifficulty:!0}},{path:"pve/:commanderId",component:TN,data:{parent:"multiplayer/pve",showDifficulty:!0,showBarrack:!0}},{path:"classic",component:pw,data:{mode:"classic",parent:"multiplayer/classic",showDifficulty:!0}},{path:"classic/:commanderId",component:TN,data:{parent:"multiplayer/classic",showDifficulty:!0,showBarrack:!0}},{path:"lobby",component:hB,data:{parent:"multiplayer/lobby",showDifficulty:!0,showBarrack:!0}},{path:"lobby/:lobbyId",component:Ax},{path:"lobby/:lobbyId/:commanderId",component:TN,data:{parent:"multiplayer/lobby",showDifficulty:!0,showBarrack:!0}},{path:"**",redirectTo:"main",pathMatch:"full"},{path:"",redirectTo:"main",pathMatch:"full"}]},{path:"campaigns",component:QS,data:{parent:"campaigns",showDifficulty:!0}},{path:"campaigns/:campaignId",component:JS,data:{parent:"campaigns",showDifficulty:!0},children:[{path:"detail",component:PS,children:[{path:"missions",component:EC},{path:"tasks",component:OQ,data:{parent:"tasks",categories:["commander","unit","progress"]}},{path:"technology",component:zN}]},{path:"technology/full",component:hk,data:{parent:"campaigns",showDifficulty:!0}},{path:"missions/:missionId",component:pw,data:{mode:"pvp",parent:"campaigns",showDifficulty:!0}},{path:"missions/:missionId/:commanderId",component:TN,data:{parent:"campaigns",showDifficulty:!0,showBarrack:!0}},{path:"**",redirectTo:"missions",pathMatch:"full"},{path:"",redirectTo:"missions",pathMatch:"full"}]},{path:"unit/:campaignId/:unitId/full-size",component:Jw,data:{}},{path:"unit/:unitId/full-size",component:Jw,data:{}},{path:"unit/:campaignId/:unitId",component:zw,data:{}},{path:"unit/:unitId",component:zw,data:{}},{path:"tutorial",component:XE,data:{parent:"tutorial"},children:[{path:"main",component:tN,data:{}},{path:"authors",component:rR,data:{}},{path:"units",component:uS,data:{}},{path:"**",redirectTo:"main",pathMatch:"full"},{path:"",redirectTo:"main",pathMatch:"full"}]},{path:"technology",component:hk,data:{parent:"technology"}},{path:"tasks",component:OQ,children:[{path:":type",component:FQ,data:{parent:"tasks"}},{path:":type/:taskId",component:FQ,data:{parent:"tasks",direct:!0}},{path:"**",redirectTo:"league",pathMatch:"full"},{path:"",redirectTo:"league",pathMatch:"full"}],data:{parent:"tasks",categories:["trial","commander","league"]}},{path:"troops",component:pw,data:{showBarrack:!0,parent:"troops"},children:[{path:":commanderId",component:Ok,data:{parent:"troops"}},{path:":commanderId/echelons",component:Dw,data:{parent:"troops"}},{path:":commanderId/info",component:Nw,data:{parent:"troops"}},{path:"",component:Ok,data:{parent:"troops"}}]},{path:"editor",component:pQ},{path:"credits",component:rR},{path:"match/:campaign/:mission/:node/:gameMode/:playMode/:difficulty/:commanderId/:requestedSize",component:XL},{path:"match/resume/:matchId",component:XL},{path:"match/team",component:XL,data:{teamMatch:!0}},{path:"profile/:id",component:rA,children:[{path:"summary",component:LD},{path:"preferences",component:EA},{path:"sessions",component:hj,children:[{path:":sessionId",component:jM,data:{parent:"statistic/detail"}}],data:{parent:"statistic"}},{path:"achievements",component:IA},{path:"troops",component:OD,children:[{path:"units",component:QD},{path:"commanders",component:UD},{path:"**",redirectTo:"units",pathMatch:"full"},{path:"",redirectTo:"units",pathMatch:"full"}]},{path:"rating",component:eE},{path:"leagues",component:dE},{path:"avatar",component:yE},{path:"**",redirectTo:"summary",pathMatch:"full"},{path:"",redirectTo:"summary",pathMatch:"full"}]},{path:"**",redirectTo:"multiplayer"}];let KN=(()=>{class t{}return t.\u0275mod=o.Lb({type:t}),t.\u0275inj=o.Kb({factory:function(e){return new(e||t)},providers:[qt,{provide:Ft,useClass:Jt},Sl,{provide:Ia,deps:[Ys]}],imports:[[zr,Cc,Lc,ua.forRoot(WN,{useHash:!0,paramsInheritanceStrategy:"always"})],zr,Cc]}),t})();o.Dc(Zm,[tp,Zv],[]),o.Dc(mh,[Zv],[]),o.Dc(Yh,[ee,Zv,tp,Zt,se],[]),o.Dc(Qh,[$S,ee,tp,Zv],[]),o.Dc(hh,[ee,Qh,Zt,Ks,Zs,tp,Zv],[re]),o.Dc(Bm,[Qh,ee,tp,Zv,gL,mg,Yh,Wr,yo,hc,Qf,Rh,Zt,h_,Hm],[VN,YN]),o.Dc(Hm,[ee,Zv,Rh,Zt,Kt,Wr,_c,yo,hc,tp,Yv],[]),o.Dc(pk,[Rh,Zt,h_,Zv],[]),o.Dc(Ev,[Rh,ee,Zt,h_,Zv,gL,tp],[]),o.Dc(Km,[Qh,ee,Zv],[]),o.Dc(gg,[ee,tp,Zv],[]),o.Dc(Bg,[Qh,bc,_o,gc,Co,Wr,yo,vc,tp,_c,ee,Rh,Zt,Qf,Zv],[]),o.Dc(_f,[ee,Zv,tp,Zt,Zm,nv,ae],[]),o.Dc(Mf,[Qh,ee,Yh,Zt,Zv,Rh,tp,rp],[VN]),o.Dc(nv,[ee,Zt,Zv],[]),o.Dc(hv,[Qh,ee,h_,nv,Zv,Yh,Zt],[]),o.Dc(mv,[ee,Zv],[]),o.Dc(Nv,[tp,Zv],[]),o.Dc($v,[Yh,Rh,Zt,tp,Zv,ee],[]),o.Dc(Xv,[ee,Rh],[]),o.Dc(iL,[ee,gw,Rh,h_,Zt,d_,fw,Zv,tp,F_],[$N,GN]),o.Dc(Ok,[ee,Rh,Zt,h_,HS,Zv,tp,Qf],[Ex,VN]),o.Dc(VR,[tp,Zv,ee,Ks,Zs,Zt,Qf,gL],[le]),o.Dc(Ax,[ee,h_,Zv,tp,Zt,gL,mg,Yh,Ok,pk,Hk,ae,Wr,_c,yo,hc,Rh,Pv,wo,wc,Mf,Qh,Hm],[re]),o.Dc(hB,[h_,Ks,Zs,Zv,ee,Wr,_c,yo,hc,Yh,Zt,tp,Rh,rp,Qh,Pv],[VN,Ex]),o.Dc(_L,[ee,Zt,Zv],[]),o.Dc(hj,[ee,h_,tp,Zv,Wr,yo,hc,Rh,Zt,Yh,rp,Qh,Qf],[Ex]),o.Dc(jM,[ee,tp,Qf,Zv,gL,mg,Ef,rp,h_,Zt,Rh,ae],[JN,qN,Ex]),o.Dc(OQ,[ee,Ks,tp,Zv,Rh,Zt,h_,GQ,rp,ug],[VN]),o.Dc(FQ,[ee,Rh,Zt,h_,GQ],[]),o.Dc(GQ,[ee,tp,Zv],[]),o.Dc(eQ,[tp,ee,Zt,Qh,ae,Rh,_f,Zv],[]),o.Dc(Py,[Qh,ee,tp,Zv,Rh,Zt,d_,ae,rp],[]),o.Dc(sI,[ee,tp,Qf,YS],[]),o.Dc(wS,[ee,Qf,Zv],[]),o.Dc(YI,[ee,Kt,Zt,h_,fw,Zv,Qf,gw,tp,ae],[oe]),o.Dc(TE,[Qh,Rh,tp,Zv,Gr,yo,hc,ee,Wr],[]),o.Dc(GE,[tp,Zv,Ef,Nv,h_,Ks,Zs,Qf,Rh,Zt,ee,WQ,Xv],[]),o.Dc(tN,[tp,Zv,h_,Qf],[]),o.Dc(XE,[h_,Ks,Zs,Zv,ta],[]),o.Dc(TN,[ee,Ef,Ks,tp,Zv,ty,Dw,iL,Rh,mh,F_,h_],[]),o.Dc(zN,[ee,Zv,Zt,Ef,Ks,Zs,tp,Rh,d_,rp,ty,M_,F_,h_],[]),o.Dc(Ww,[Zt,ee,d_,Zv,tp],[]),o.Dc(pQ,[Zv,h_,Wr,yo,hc,_c,xo,Zt,Bo,Ao,Rh,nv,gL],[]),o.Dc(rR,[Zv,ee],[]),o.Dc(M_,[ee,tp,Ef,Zv],[]),o.Dc(rA,[ee,Ks,Zs,tp,Zv,ty,Zt,ta],[]),o.Dc(IA,[ee,Yh,Zt,Zv,Rh,Qf,Kt,tp,rp],[Ex]),o.Dc(EA,[h_,ee,Rh,Zt,tp,rp],[]),o.Dc(LD,[ee,Ks,Zs,Zv,Qf,VD,h_,gL,rp,Rh,$D,Zt,tp,mg],[HN]),o.Dc(VD,[gL,tp,ae,Qf],[]),o.Dc(QD,[ee,tp,Zv,Rh,Zt,Qf,rp,Ks,Zs,$v],[Ex]),o.Dc(UD,[ee,Ks,Zs,Zv,$v,tp,Rh,Zt,Qf,rp],[Ex]),o.Dc(eE,[Zt,Zv,tp,ee,Rh,gL,mg,Qf,rp],[Ex]),o.Dc(dE,[h_,ee,Zt,gL,ug],[]),o.Dc(yE,[gL,tp,Ks,Zs,Rh,h_,Zt,Zv,ee],[]),o.Dc(rp,[ee,Qf,h_,Zv],[]),o.Dc(hp,[ee,d_,tp],[]),o.Dc(ug,[Kt,ee,Zt,h_,Ef,d_,Qf,tp,wS,Zv,ae],[]);let XN=(()=>{class t{static forRoot(){return{ngModule:t,providers:[Gc,Uc]}}}return t.\u0275mod=o.Lb({type:t}),t.\u0275inj=o.Kb({factory:function(e){return new(e||t)},providers:[],imports:[[]]}),t})();const ZN=["newLevelModal"],tF=["statisticsListModal"],eF=["statisticsDetailModal"],iF=["confirmModal"],nF=["helpModal"],sF=["invitationConfirm"],aF=["loadGamePreloader"],rF=["friends"],oF=["compare"],cF=["hqMessages"],lF=["rewardsModal"],uF=["conquestRulesModal"],dF=["techTreeRulesModal"],hF=["reviewModal"];function bF(t,e){if(1&t&&(o.Rb(0,"h3",23),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Mc(t.L("meta.ui.load.connecting"))}}function mF(t,e){1&t&&(o.Rb(0,"span"),o.Lc(1,"\u26ac"),o.Qb())}function pF(t,e){if(1&t&&(o.Rb(0,"span"),o.Lc(1),o.Jc(2,mF,2,0,"span",26),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(3);o.Bb(1),o.Nc(" ",e.L("meta.ui.load."+e.progressLocalization[t.key])," "),o.Bb(1),o.jc("ngIf",t.skipped)}}function gF(t,e){if(1&t&&(o.Rb(0,"div"),o.Jc(1,pF,3,2,"span",26),o.Qb()),2&t){const t=e.$implicit,i=o.bc(3);o.Bb(1),o.jc("ngIf",t&&t.key&&i.progressLocalization[t.key])}}function fF(t,e){if(1&t&&(o.Rb(0,"div",24),o.Rb(1,"div"),o.Jc(2,gF,2,1,"div",25),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Eb("progress step-",t.progress.length,""),o.Bb(1),o.jc("ngForOf",t.progress)}}function vF(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",27),o.Yb("click",function(){return o.zc(t),o.bc(2).reload()}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(2);o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.load.reload_button")),o.Bb(1),o.Nc(" ",t.L("meta.ui.load.reload_button")," ")}}function yF(t,e){if(1&t){const t=o.Sb();o.Rb(0,"button",27),o.Yb("click",function(){return o.zc(t),o.bc(2).exit()}),o.Lc(1),o.Qb()}if(2&t){const t=o.bc(2);o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L("meta.ui.button_exit")),o.Bb(1),o.Nc(" ",t.L("meta.ui.button_exit")," ")}}function _F(t,e){if(1&t&&(o.Rb(0,"h4",31),o.Lc(1),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.Mc(t.L("meta.ui.load.failed"))}}function kF(t,e){if(1&t&&(o.Rb(0,"h4",31),o.Lc(1),o.Qb()),2&t){const t=o.bc(3);o.Bb(1),o.Mc(t.L("meta.ui.error.attention"))}}function wF(t,e){if(1&t&&(o.Rb(0,"div",28),o.Ob(1,"img",29),o.Jc(2,_F,2,1,"h4",30),o.Jc(3,kF,2,1,"h4",30),o.Qb()),2&t){const t=o.bc(2);o.Bb(2),o.jc("ngIf",!t.error.reason),o.Bb(1),o.jc("ngIf",t.error.reason)}}function SF(t,e){if(1&t&&(o.Rb(0,"div",32),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Nc(" ",t.L("meta.ui.error."+t.error.value).firstCapital()," ")}}const IF=function(t,e){return{date:t,reason:e}};function CF(t,e){if(1&t&&(o.Rb(0,"div",32),o.Lc(1),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Nc(" ",t.L("meta.ui.reason."+t.error.reason.key,o.oc(1,IF,t.error.reason.date,t.error.reason.reason)).firstCapital()," ")}}function LF(t,e){if(1&t&&(o.Rb(0,"div",33),o.Ob(1,"span"),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Ic("width",t.progress.length/t.getLoadingProgressLength()*100+"%")}}function RF(t,e){if(1&t&&(o.Rb(0,"div",8),o.Rb(1,"div",9),o.Rb(2,"div",10),o.Ob(3,"img",11),o.Ob(4,"img",12),o.Qb(),o.Jc(5,bF,2,1,"h3",13),o.Rb(6,"div",14),o.Lc(7),o.Qb(),o.Jc(8,fF,3,4,"div",15),o.Jc(9,vF,2,3,"button",16),o.Jc(10,yF,2,3,"button",16),o.Jc(11,wF,4,2,"div",17),o.Jc(12,SF,2,1,"div",18),o.Jc(13,CF,2,4,"div",18),o.Qb(),o.Rb(14,"div",19),o.Ob(15,"img",20),o.Ob(16,"img",21),o.Qb(),o.Jc(17,LF,2,2,"div",22),o.Qb()),2&t){const t=o.bc();o.Fb("fading",t.goingToFade),o.Bb(5),o.jc("ngIf",!t.error.state),o.Bb(2),o.Mc((t.progress.length/11*100).toFixed()+"%"),o.Bb(1),o.jc("ngIf",!t.error.state&&t.progress),o.Bb(1),o.jc("ngIf",t.error.state&&"player_deleted"!==t.error.value),o.Bb(1),o.jc("ngIf",t.error.state&&"player_deleted"===t.error.value),o.Bb(1),o.jc("ngIf",t.error.state),o.Bb(1),o.jc("ngIf",t.error.state&&t.error.value&&!t.error.reason),o.Bb(1),o.jc("ngIf",t.error.state&&t.error.reason),o.Bb(4),o.jc("ngIf",!t.error.state)}}function OF(t,e){if(1&t&&(o.Rb(0,"div",34),o.Ob(1,"router-outlet"),o.Qb()),2&t){const t=o.bc();o.Fb("large-language",t.largeLanguageSelected)}}function TF(t,e){if(1&t){const t=o.Sb();o.Rb(0,"app-navigation",86),o.Yb("onChatOpen",function(e){return o.zc(t),o.bc(2).onChatOpen(e)}),o.Qb()}}function xF(t,e){if(1&t&&(o.Rb(0,"div",87),o.Rb(1,"figure",88),o.Ob(2,"img",89),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.Bb(2),o.jc("src","assets/img/missions_full/"+t.globalSelectedCampaign.missionId+".jpg",o.Cc)}}function BF(t,e){1&t&&o.Ob(0,"sparks-animation")}function jF(t,e){1&t&&(o.Rb(0,"span",97),o.Lc(1,",\xa0"),o.Qb())}function MF(t,e){if(1&t&&(o.Rb(0,"li"),o.Lc(1),o.Jc(2,jF,2,0,"span",96),o.Qb()),2&t){const t=e.$implicit,i=e.index,n=o.bc(3);o.Bb(1),o.Nc(" ",t,""),o.Bb(1),o.jc("ngIf",n.newLevel.openedContent.length>1&&i<n.newLevel.openedContent.length-1)}}function QF(t,e){if(1&t&&o.Ob(0,"img",104),2&t){const t=o.bc().$implicit;o.jc("src","assets/img/icons/svg/"+t.key+".svg",o.Cc)}}function AF(t,e){if(1&t&&o.Ob(0,"img",105),2&t){const t=o.bc().$implicit;o.jc("src","assets/img/unit/"+t.unit.id+".png",o.Cc)}}function DF(t,e){if(1&t&&(o.Rb(0,"div",106),o.Lc(1),o.Qb()),2&t){const t=o.bc().$implicit;o.Bb(1),o.Nc("x",t.amount,"")}}function EF(t,e){if(1&t&&(o.Rb(0,"h4"),o.Lc(1),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(3);o.Bb(1),o.Oc("",t.amount.cat()," ",e.L("meta.hint.task.reward."+t.key),"")}}function NF(t,e){if(1&t&&(o.Rb(0,"h4"),o.Lc(1),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(3);o.Bb(1),o.Mc(e.L("unit."+t.unit.id+".short"))}}function FF(t,e){if(1&t&&(o.Rb(0,"h4"),o.Lc(1),o.Qb()),2&t){const t=o.bc().$implicit,e=o.bc(3);o.Bb(1),o.Mc(e.L("meta.hint.task.reward."+t.key))}}function PF(t,e){if(1&t&&(o.Rb(0,"div",98),o.Rb(1,"div",99),o.Rb(2,"figure",100),o.Jc(3,QF,1,1,"img",101),o.Jc(4,AF,1,1,"img",102),o.Qb(),o.Jc(5,DF,2,1,"div",103),o.Jc(6,EF,2,2,"h4",26),o.Jc(7,NF,2,1,"h4",26),o.Jc(8,FF,2,1,"h4",26),o.Qb(),o.Qb()),2&t){const t=e.$implicit,i=o.bc(3);o.Bb(3),o.jc("ngIf","unit"!==t.key),o.Bb(1),o.jc("ngIf","unit"===t.key),o.Bb(1),o.jc("ngIf",i.hasMultiplier(t)),o.Bb(1),o.jc("ngIf",!i.hasMultiplier(t)),o.Bb(1),o.jc("ngIf",i.hasMultiplier(t)&&t.unit),o.Bb(1),o.jc("ngIf",i.hasMultiplier(t)&&"premium"===t.key)}}function UF(t,e){if(1&t&&(o.Rb(0,"div",90),o.Rb(1,"h1"),o.Lc(2),o.Qb(),o.Rb(3,"div",91),o.Rb(4,"div"),o.Lc(5),o.Qb(),o.Rb(6,"div"),o.Lc(7),o.Qb(),o.Qb(),o.Rb(8,"h2"),o.Lc(9),o.Qb(),o.Rb(10,"h2"),o.Lc(11),o.Qb(),o.Rb(12,"ul",92),o.Jc(13,MF,3,2,"li",25),o.Qb(),o.Rb(14,"div",93),o.Rb(15,"div",94),o.Jc(16,PF,9,6,"div",95),o.Qb(),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.Bb(2),o.Mc(t.L("meta.tutorial.opening.title")),o.Bb(3),o.Mc(t.newLevel.level),o.Bb(2),o.Mc(t.newLevel.oldLevel),o.Bb(2),o.Mc(t.L("meta.tutorial.opening.subtitle")),o.Bb(2),o.Mc(t.L("meta.tutorial.opening.desc")),o.Bb(2),o.jc("ngForOf",t.newLevel.openedContent),o.Bb(3),o.jc("ngForOf",t.newLevel.reward)}}const zF=function(){return{prefix:"\u2014"}},JF=function(t){return{list:t}};function qF(t,e){if(1&t){const t=o.Sb();o.Rb(0,"modal",107,108),o.Yb("onClose",function(){return o.zc(t),o.bc(2).decline()}),o.Rb(2,"div",109),o.Rb(3,"h2",110),o.Lc(4),o.Qb(),o.Qb(),o.Rb(5,"div",111),o.Ob(6,"article",84),o.Qb(),o.Rb(7,"div",112),o.Rb(8,"button",85),o.Yb("click",function(){return o.zc(t),o.bc(2).confirm()}),o.Lc(9),o.Qb(),o.Rb(10,"button",113),o.Yb("click",function(){return o.zc(t),o.bc(2).decline()}),o.Lc(11),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.bc(2);o.jc("id","confirmation_window"),o.Bb(4),o.Mc(t.L(t.confirmation.options.title)),o.Bb(2),o.jc("innerHTML",t.L(t.confirmation.options.key,t.confirmation.data).markdown(o.nc(13,JF,o.mc(12,zF))).br(),o.Ac),o.Bb(2),o.Fb("disabled",t.confirmButtonsLocked),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",t.L(t.confirmation.options.confirm)," "),o.Bb(1),o.Fb("disabled",t.confirmButtonsLocked),o.jc("alertSound","ui_click_default"),o.Cb("data-tooltip",t.L(t.confirmation.options.decline)),o.Bb(1),o.Nc(" ",t.L(t.confirmation.options.decline)," ")}}function VF(t,e){if(1&t&&o.Ob(0,"article",84),2&t){const t=o.bc(2);o.jc("innerHTML",t.L("meta.tutorial."+t.help.key).markdown().br(),o.Ac)}}function $F(t,e){1&t&&(o.Rb(0,"div",114),o.Lc(1,"No help"),o.Qb())}function GF(t,e){if(1&t&&(o.Rb(0,"div",115),o.Lc(1),o.Rb(2,"span",116),o.Lc(3),o.Qb(),o.Qb()),2&t){const t=o.bc(2);o.Bb(1),o.Nc(" ",t.debugLine," "),o.Bb(2),o.Mc(t._debugChangedUrl)}}function HF(t,e){if(1&t&&o.Ob(0,"statistics",117),2&t){const t=o.bc(2);o.jc("campaignId",t.statisticsCampaignId)}}function YF(t,e){if(1&t&&o.Ob(0,"statistics-detail",118),2&t){const t=o.bc(2);o.jc("sessionId",t._selectedSessionId)}}function WF(t,e){if(1&t&&o.Ob(0,"img",119),2&t){const t=o.bc(2);o.jc("src","assets/img/review_portraits/"+t.reviewContent.avatar+".png",o.Cc)}}function KF(t,e){if(1&t&&o.Ob(0,"img",120),2&t){const t=o.bc(2);o.jc("src","assets/img/commanders_full/pvp/"+t.reviewContent.commander+".png",o.Cc)}}function XF(t,e){if(1&t){const t=o.Sb();o.Rb(0,"div"),o.Jc(1,TF,1,0,"app-navigation",35),o.Rb(2,"img",36),o.Yb("load",function(){return o.zc(t),o.bc().onBgLoad()}),o.Qb(),o.Rb(3,"div",37),o.Ob(4,"div",38),o.Jc(5,xF,3,1,"div",39),o.Qb(),o.Ob(6,"div",40),o.Ob(7,"friends",null,41),o.Ob(9,"hq-messages",null,42),o.Rb(11,"modal",43,44),o.Rb(13,"div",45),o.Jc(14,BF,1,0,"sparks-animation",26),o.Rb(15,"div",46),o.Jc(16,UF,17,7,"div",47),o.Qb(),o.Qb(),o.Rb(17,"div",48),o.Rb(18,"button",49),o.Yb("click",function(){return o.zc(t),o.bc().applyNewLevel()}),o.Lc(19),o.Qb(),o.Qb(),o.Rb(20,"div",50),o.Rb(21,"div",51),o.Rb(22,"div",52),o.Ob(23,"img",53),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Jc(24,qF,12,15,"modal",54),o.Rb(25,"modal",55,56),o.Rb(27,"div",57),o.Jc(28,VF,1,1,"article",58),o.Jc(29,$F,2,0,"div",59),o.Rb(30,"div",60),o.Rb(31,"button",61),o.Yb("click",function(){return o.zc(t),o.wc(26).close()}),o.Lc(32),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Ob(33,"rewards-modal",null,62),o.Jc(35,GF,4,2,"div",63),o.Ob(36,"invitation-confirm",null,64),o.Rb(38,"modal",65,66),o.Yb("onClose",function(){return o.zc(t),o.bc().statisticsCampaignId=""}),o.Jc(40,HF,1,1,"statistics",67),o.Qb(),o.Rb(41,"modal",65,68),o.Yb("onClose",function(){o.zc(t);const e=o.bc();return e.checkIfUserWantsReview(e._selectedSessionId)}),o.Jc(43,YF,1,1,"statistics-detail",69),o.Qb(),o.Ob(44,"ap-graph-modal"),o.Rb(45,"modal",70,71),o.Rb(47,"div",72),o.Rb(48,"scrollable"),o.Ob(49,"article",73),o.Qb(),o.Qb(),o.Qb(),o.Rb(50,"modal",70,74),o.Rb(52,"div",72),o.Rb(53,"scrollable"),o.Ob(54,"article",73),o.Qb(),o.Qb(),o.Qb(),o.Rb(55,"modal",75,76),o.Rb(57,"div",77),o.Rb(58,"div",78),o.Ob(59,"div",79),o.Ob(60,"div",80),o.Jc(61,WF,1,1,"img",81),o.Jc(62,KF,1,1,"img",82),o.Rb(63,"div",83),o.Ob(64,"h3",84),o.Ob(65,"article",84),o.Qb(),o.Qb(),o.Rb(66,"button",85),o.Yb("click",function(){return o.zc(t),o.bc().cache.alertUrl("steam://openurl/https://store.steampowered.com/app/1128860/Men_of_War_II/#app_reviews_hash")}),o.Lc(67),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&t){const t=o.wc(12),e=o.wc(39),i=o.wc(42),n=o.bc();o.Fb("large-language",n.largeLanguageSelected),o.Bb(1),o.jc("ngIf",!n.isMatching),o.Bb(2),o.Fb("visible",n.isBgLoaded)("developer-mode",n.cache.devMode||n.testingMode)("faded",n.isFaded),o.Bb(2),o.jc("ngIf",n.globalSelectedCampaign&&n.globalSelectedCampaign.missionId),o.Bb(2),o.Fb("disabled",n.isMatching),o.Bb(4),o.jc("id","new_level"),o.Bb(3),o.jc("ngIf",n.newLevel&&t.opened),o.Bb(2),o.jc("ngIf",n.newLevel),o.Bb(2),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",n.L("meta.ui.store.continue")," "),o.Bb(4),o.jc("src","assets/img/missions_full/rus_tank_tutorial.jpg",o.Cc),o.Bb(1),o.jc("ngIf",n.confirmation),o.Bb(1),o.jc("id","help_window"),o.Bb(3),o.jc("ngIf",n.help),o.Bb(1),o.jc("ngIf",!n.help),o.Bb(2),o.kc("tooltip-hint",n.L("meta.tutorial.button.next_step")),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",n.L("meta.tutorial.button.next_step")," "),o.Bb(3),o.jc("ngIf",!n.isMatching&&n.hasFlag("debug")&&n.showDebugLine),o.Bb(3),o.jc("ignoreCloseOnClick",!0)("id","statistics_list"),o.Bb(2),o.jc("ngIf",e.opened),o.Bb(1),o.jc("ignoreCloseOnClick",!0)("id","statistics_detail"),o.Bb(2),o.jc("ngIf",i.opened),o.Bb(2),o.jc("id","rules.conquest_campaign")("header",n.L("meta.ui.lobby.rules_title")),o.Bb(4),o.jc("innerHTML",n.L("meta.ui.mode.conquest_campaign.rules").markdown(),o.Ac),o.Bb(1),o.jc("id","rules.tech_tree")("header",n.L("meta.ui.mode.rules.button_text")),o.Bb(4),o.jc("innerHTML",n.L("meta.ui.tech_tree.rules").markdown(),o.Ac),o.Bb(1),o.jc("id","show_review"),o.Bb(6),o.jc("ngIf",n.reviewContent),o.Bb(1),o.jc("ngIf",n.reviewContent),o.Bb(2),o.jc("innerHTML",n.L("meta.ui.review_modal.title"),o.Ac),o.Bb(1),o.jc("innerHTML",n.L("meta.ui.review_modal.description"),o.Ac),o.Bb(1),o.jc("alertSound","ui_click_default"),o.Bb(1),o.Nc(" ",n.L("meta.ui.review_modal.button_accept")," ")}}const ZF=/campaigns\/(?<campaignId>.*?)\//,tP=/campaigns\/(?<campaignId>.*?)\/missions\/(?<missionId>.*?)(?:\/|\?)/,eP=/\/(multiplayer|profile|tasks|technology)/;var iP,nP;const sP=/(statistic|tasks|profile)/gim;let aP=(()=>{class t{constructor(t,e,i,n,s,a,r,o,c,l,u,d){this.cache=t,this.route=e,this.router=i,this.notificatorService=n,this.matchService=s,this.tutorialService=a,this.tasksService=r,this.sanitizer=o,this.profileService=c,this.lobbyService=l,this.helpService=u,this.redirectService=d,this.commanders=[],this.unitsTemplates=[],this.loading={commandersTemplates:!0,commanders:!0,progress:{}},this.isLoaded=!1,this.match="",this.progress=[],this.progressLocalization={login:"login",localization:"localization",information:"information",commandersTemplates:"commanders_templates",commanders:"commanders",unitsTemplates:"troops",unitsTreeGet:"tech",unitsTreeAmount:"tech_amount",maps:"maps",campaigns:"campaigns",inventory:"inventory"},this.localizator=new al,this.informator=new dl,this.isBgLoaded=!1,this.isMatching=!1,this.isFaded=!1,this.error={state:!1,value:"",reason:null},this.goingToFade=!1,this.levelRewardContainer=null,this.globalEvent=new uu,this.storeCase=null,this.dlcCase=null,this.counters={},this.newLevel=null,this.debugLine="",this.confirmation=null,this.confirmationData=null,this.confirmButtonsLocked=!1,this.containers=[],this.invitation=null,this._debugChangedUrl="",this.campaignId="",this.help=null,this.team={},this.teamId="",this.lastGameSettings={},this.globalSelectedCampaign={},this.isTeamOwner=!1,this.difficultiesString=["novice","easy","normal","hard","nightmare"],this.demoModeEnabled=!1,this.campaignModeActive=!1,this.isInLobby=!1,this._selectedSessionId="",this.largeLanguages=["ko","zh","jp"],this.largeLanguageSelected=!1,this.showDebugLine=!1,this.statisticsCampaignId="",Object(Pc.a)("INIT :: AppComponent")}ngAfterViewInit(){Qh.unitsCompareModal=this.compare}ngOnInit(){this.debugLine=`${window.innerWidth}x${window.innerHeight}`,window.addEventListener("resize",()=>{this.debugLine=`${window.innerWidth}x${window.innerHeight}`}),this.localizator.data.subscribe(t=>{console.log(al.flatLanguages),this.L=t,this.largeLanguageSelected=this.largeLanguages.indexOf(al.selectedLanguage)>-1}),iP=performance.now();let t=Wc(location.hash);this.cache.auth({preview:!!t.preview}).subscribe(t=>{t.error||(nP=performance.now(),this.cache.init())}),this.cache.authError.subscribe(t=>{this.error.state=!0;let e="";for(let i in t)if(!e&&(e=i,t[e].value)){let i=!!t[e].ucode.match(/ban/gim);this.error.reason={date:t[e].value.date?new Date(t[e].value.date).toLocaleString(this.localizator.getLocale()):t[e].value.expiresAt&&t[e].value.expiresAt.$date?new Date(t[e].value.expiresAt.$date).toLocaleString(this.localizator.getLocale()):null,key:i?t[e].dcode:t[e].value.reason||t[e].dcode,value:t[e].value}}console.log(this.error),Object(Pc.a)("ERROR :: preflight Auth"),this.error.value=e}),this.cache.userGold.subscribe(t=>this.userGold=t),this.cache.userSilver.subscribe(t=>this.userSilver=t),this.cache.userFreeXp.subscribe(t=>this.userExpo=t),this.router.events.subscribe(t=>{t instanceof Ci&&(this.isMatching=!!t.url.match(/(match)/gim),this.cache.saveAmount(),this.cache.getUserTeamId()&&this.cache.isReadyToFight()&&this.cache.setReadyToFight(!1),this.isFaded=!!t.url.match(sP)),this.checkUrlForCampaign(),this.checkUrlForLobby(),t instanceof Li&&(this._debugChangedUrl=t.url.replace(/^(.*?)\#/gim,""))}),this.cache.authorized.subscribe(t=>{if(t.scriptData.match){this.cache.isMatching=!0,Object(Pc.a)("isMatching true"),this.match=t.scriptData.match,this.matchService.insertGameSparks(nd.gameSparks),Object(Pc.a)("[event + redirect to match on auth]",this.match);let e=this.router.createUrlTree(["match","resume",this.match],{queryParamsHandling:"merge"});this.router.navigateByUrl(e)}!t.scriptData.lobbyMember&&location.href.match(/lobby/gim)&&this.cache.redirect(["multiplayer","lobby"])}),this.cache.loading.subscribe(t=>{t.key.match(/inventory/gim)&&(this.goingToFade=!0),this.loading.progress=t,this.progress.push(t)}),this.cache.commandersTemplates.subscribe(t=>{this.loading.commandersTemplates=!1}),this.cache.commanders.subscribe(t=>{this.commanders=t,this.loading.commanders=!1}),this.cache.error.subscribe(t=>{this.error.state=!0,Object(Pc.a)("ERROR :: preflight Auth"),t.target&&3===t.target.readyState&&(this.error.value="connect")}),this.cache.completed.subscribe(()=>{this.cache.checkFutureRedirect();let t=this.router.parseUrl(this.router.url).root.children.primary.segments.find(t=>!!t.path.match(/(jap|rus|ger|usa|eng)/gim));if(t){let e=t.path,i=e&&e.length&&e.match(/^([a-zA-Z]{2,3})/gim)?e.match(/^([a-zA-Z]{2,3})/gim)[0].toLowerCase():"";e&&this.cache.isCommanderIdValid(e)&&i&&(this.cache.setArmy(i),this.cache.setCommander(e))}let e=this.tasksService.getUnvisitedTasksCount("this_day"),i=this.tasksService.getUnvisitedTasksCount("this_week"),n=this.tasksService.getUnvisitedTasksCount("special"),s=this.tasksService.getUnvisitedTasksCount("trial"),a=this.tasksService.getUnvisitedTasksCount("commander"),r=this.tasksService.getUnvisitedTasksCount("league"),o=this.tasksService.getTasks(null,"this_day").filter(t=>"task"===t.type).length,c=this.tasksService.getTasks(null,"this_week").filter(t=>"task"===t.type).length,l=this.tasksService.getTasks(null,"special").filter(t=>"task"===t.type).length,u=this.tasksService.getTasks(null,"trial").filter(t=>"task"===t.type).length,d=this.tasksService.getTasks(null,"commander").filter(t=>"task"===t.type).length,h=this.tasksService.getTasks(null,"league").filter(t=>"task"===t.type).length;Object(Pc.a)("Lobby || team"),Object(Pc.a)("\u2502 team ID "+(this.cache.getUserTeamId()||null)),Object(Pc.a)("\u2514 lobby ID "+(this.cache.getUser().lobby||null)),Object(Pc.a)("Tasks count: "+(o+c+l+u+d+h)+" ("+(e+i+n+s+a+r)+")"),Object(Pc.a)("\u2502 Day: "+o+" ("+e+")"),Object(Pc.a)("\u2502 Week: "+c+" ("+i+")"),Object(Pc.a)("\u2502 Special: "+l+" ("+n+")"),Object(Pc.a)("\u2502 Trial: "+u+" ("+s+")"),Object(Pc.a)("\u2502 Commander chain: "+d+" ("+a+")"),Object(Pc.a)("\u2514 League: "+h+" ("+r+")");const b=performance.now();if(Object(Pc.a)("\u250c"+"".appendSpaces(40,"\u2500")+"\u2510"),Object(Pc.a)("\u2502"+("  Authorized in "+(nP-iP).toFixed(3)+"ms.").appendSpaces(40)+"\u2502"),Object(Pc.a)("\u2502"+("  Data loaded in "+(b-nP).toFixed(3)+"ms.").appendSpaces(40)+"\u2502"),Object(Pc.a)("\u2514"+"".appendSpaces(40,"\u2500")+"\u2518"),this.cache.save(),this.isLoaded=!0,this.cache.devMode){let t=10485762/1024,e={};var m,p,g=0;for(p in localStorage)localStorage.hasOwnProperty(p)&&(g+=m=2*(localStorage[p].length+p.length),e[p.substr(0,50)]=(m/1024).toFixed(2)+" KB");let i=g/1024;console.groupCollapsed(`Storage [${(i/t*100).toFixed(0)}%] >> ${i.toFixed(0)+"KB"} / ${t.toFixed(0)+"KB"}`);for(let n in e)console.log(`${n.appendSpaces(30)} = ${e[n]}`);console.groupEnd()}if(this.match){Object(Pc.a)("[event + redirect to match (onCompleted)] onMessage: ",this.match);let t=this.router.createUrlTree(["match","resume",this.match],{queryParamsHandling:"merge"});this.router.navigateByUrl(t)}this.isTeamOwner=this.cache.isTeamOwner(),this.cache.getUserTeamId()&&this.cache.isReadyToFight()&&this.cache.setReadyToFight(!1),this.teamSubscription=this.cache.teamChange.pipe(We(t=>null!==t)).subscribe(t=>{this.team=t,this.teamId=t?t.id:"";for(let e in t.data.members){let i=t.data.members[e];i&&"leader"===i.state&&i.ready&&this.checkTeamCampaign(t)}}),this.checkUrlForCampaign(),this.checkUrlForLobby();let f=this.cache.getUser(!0).scriptData;f.lastSession&&(Object(Pc.a)("redirecting to battle results","id: "+f.lastSession),this.triggerGlobalEvent("statistics_list.open"),setTimeout(()=>{this.triggerGlobalEvent("statistics_detail.open",{sessionId:f.lastSession})},50))}),this.cache.clearing.subscribe(()=>{this.isLoaded=!1,setTimeout(()=>{this.localizator.clear(),this.informator.clear(),location.reload()},200)}),this.cache.counterChange.pipe(We(t=>null!==t)).subscribe(t=>{this.counters[t.path]=t.value}),this.tasksService.onLevelChange.subscribe(t=>{t&&(Object(Pc.a)("LEVEL CHANGED",`new level: ${t.level}, congratulations!`),t.openedContent=[],t.container.map(e=>{let i=this.tutorialService.getTutorialLevelByIndex(parseInt(e.containerTemplate.replace(/\D/gim,""))-1);t.openedContent=t.openedContent.concat(i&&i.opens?i.opens:[])}),t.openedContent=t.openedContent.map(t=>{let e=Object.keys(t)[1],i=e?{[e]:this.L(t[e])}:{};return this.L("meta.tutorial."+t.key,i)}),t.reward=[],t.container.map(e=>{t.reward=t.reward.concat(e.reward)}),this.newLevel=t,setTimeout(()=>{this.newLevelModal.open()},100))}),this.tasksService.onContainerAdd.pipe(We(t=>null!==t)).subscribe(()=>{this.containers=this.tasksService.getContainers()}),this.cache.confirm.subscribe(t=>{this.confirmation=t,this.confirmation&&setTimeout(()=>{this.confirmModal&&this.confirmModal.open()},10)}),this.cache.invitation.subscribe(t=>{this.invitation=t,this.invitation&&setTimeout(()=>{this.invitationConfirm&&this.invitationConfirm.open(t)},10)}),this.lobbyCreateScubscription=this.lobbyService.onLobbyCreated.pipe(We(t=>null!==t)).subscribe(t=>{Object(Pc.a)("redirecting to lobby page after creating","id: "+t),this.lobbyService.redirectToLobby(t)}),this.globalEvent.subscribe(t=>{t&&t.key&&("friends.open"===t.key&&this.friends.open(t.data),"help.open"===t.key&&this.helpModal&&(this.helpModal.open(),this.help=this.helpService.getHelp()),"help.close"===t.key&&this.helpModal&&this.helpModal.close(),"gdpr_accept"===t.key&&(this.error={state:!1,value:"",reason:null}),"load_game"===t.key&&this.loadGamePreloader&&this.loadGamePreloader.show(),"lobby_invitation.accept"==t.key&&t.data&&this.acceptLobbyInvitation(t.data),"lobby_invitation.decline"==t.key&&t.data&&this.rejectLobbyInvitation(t.data),"button.show_unit_compate_table"==t.key&&this.compare.open(),"hq_messages.toggle"==t.key&&this.hqMessages.toggle(),"statistics_list.open"==t.key&&(console.log("statistics_list.open",t.data),t.data&&t.data.campaignId&&(this.statisticsCampaignId=t.data.campaignId),this.statisticsListModal&&this.statisticsListModal.open()),"statistics_detail.open"==t.key&&(this._selectedSessionId=t.data.sessionId,console.log("statistics_detail",t.data.sessionId),this.statisticsDetailModal&&this.statisticsDetailModal.open()),"conquest_rules_modal.open"==t.key&&this.conquestRulesModal&&this.conquestRulesModal.open(),"tech_tree_rules_modal.open"==t.key&&this.techTreeRulesModal&&this.techTreeRulesModal.open(),"review_modal.open"==t.key&&(this.reviewContent=t.data,this.reviewModal&&this.reviewModal.open()))}),pd.onKeyDown.pipe(We(t=>null!==t)).subscribe(t=>{27===t.keyCode&&Qh.isAllModalsClosed()&&!ty.hasCancelButtonsOnDisplay()&&this.cache.alertEscape()}),this.cache.globalCampaign.pipe(We(t=>null!==t)).subscribe(t=>{this.campaignId=t.id})}hostClickHandler(t){t.target.closest(".hq-messages-cover")||t.target.closest("hq-messages")||!this.hqMessages||this.hqMessages.close()}reload(){location.reload()}onChatOpen(){this.friends.open()}onBgLoad(){this.isBgLoaded=!0}hasMultiplier(t){return!!t.key.match(/(unit|premium)/gim)}getAvailableAvatars(){let t=this.cache.getUserInventory();return{portraits:this.selectFromInventory(t,"portrait"),wreath:this.selectFromInventory(t,"wreath")}}selectFromInventory(t,e){let i=[],n=this.cache.getProfileInventory();if(t&&t[e]&&t[e].length)for(let s of t[e])s.id&&"league"!==s.id&&(0==s.check_inventory&&0==s.in_progress&&i.push(s),1==s.check_inventory&&0==s.in_progress&&n&&n[e]&&n[e].includes(s.id)&&i.push(s));return i.sort((t,e)=>t.display_order-e.display_order)}triggerGlobalEvent(t,e){this.globalEvent.trigger(t,e?JSON.parse(JSON.stringify(e)):null)}applyNewLevel(){let t=()=>{let e=this.newLevel.container.pop();e?this.tasksService.openContainer(e.id).subscribe(()=>{this.cache.setUserLevel(this.newLevel.level),Object(Pc.a)("level applied"),t()}):(this.newLevelModal.close(),this.newLevel=null,this.cache.updateCounters())};t()}sanitize(t){return this.sanitizer.bypassSecurityTrustHtml(t)}confirm(){this.confirmButtonsLocked=!0,this.cache.acceptConfirm(this.confirmation.options.key),setTimeout(()=>{this.confirmButtonsLocked=!1},500)}decline(){this.confirmButtonsLocked=!0,this.cache.dismissConfirmModal(),setTimeout(()=>{this.confirmButtonsLocked=!1},500)}hasFlag(t){return this.cache.hasFlag(t)}allow(t){return this.cache.allow(t)}checkTeamCampaign(t){if(!t||!t.data||!t.data.game)return;let e=t.data.game,i=this.globalSelectedCampaign&&this.globalSelectedCampaign.missionId||"",n="",s="";e.option.campaign&&e.option.campaign.template&&(n=e.option.campaign.template),e.option.map&&(s=e.option.map),localStorage.setItem("METAGAME_LAST_TEAMCHANGE_OPTIONS",JSON.stringify({owner:t.data.owner,option:e.option})),s&&i&&i===s||(this.setGlobalCampaign(n,s),this._checkDemoRedirection())}_checkTeamLeaderRedirection(){let t=location.hash;if(this.teamId=this.cache.getUserTeamId()||null,!t.match(eP))return void(this.cache.devMode&&console.log("[multiplayer/redirect] parentRoute is not PLAY, redirecting skip"));let e=this.team&&this.team.data?this.team.data.game:this.team&&this.team.game?this.team.game:null;if(e){if(this.isSameGameOptions(e,this.lastGameSettings))this.cache.devMode&&console.log("[multiplayer/redirect] isSameGameOptions: true, redirecting skip");else if(this.lastGameSettings=e,!this.cache.isMatching&&this.teamId&&!this.isTeamOwner){let t=e.mode,i=[{pvp:"/multiplayer/pvp",pve:"/multiplayer/pve",mission:"/campaigns/missions",campaign:"/campaigns/",tutorial:"/multiplayer/missions",lobby:"/multiplayer/lobby"}[this.hasLobby()?"lobby":"coop"===t?e.option.campaign?"campaign":"missions":t]];console.log({game:e,"game.option":e.option,routePath:i}),this.router.url.match(new RegExp(i[0],"gim"))||wu(()=>{let t=this.router.createUrlTree(i,{queryParamsHandling:"merge"});this.router.navigateByUrl(t,{})},500,"regular_user_redirect"),wu(()=>{e.option&&e.option.campaign&&e.option.map&&console.log(e.option)},500,"campaign_user_redirect");let n=this.difficultiesString.indexOf(e.option.difficulty);n>=0&&this.cache.setDifficulty(n),this.cache.setMode(e.option.solo?"ai":"coop")}}else this.cache.devMode&&console.log("[multiplayer/redirect] no game data, redirecting skip")}_checkDemoRedirection(){this.demoModeEnabled&&this.cache.redirect(["campaigns"])}setGlobalCampaign(t,e){if(!t||!e)return;let i=this.cache.getCampaign(t),n=this.cache.getMission(e);this.globalSelectedCampaign={campaignId:t,missionId:e,campaign:i,mission:n}}hasLobby(){return this.lobbyService.hasLobby()}hasTournament(){return this.lobbyService.hasTournament()}hasCustomLobby(){return this.lobbyService.hasCustomLobby()}isSameGameOptions(t,e){if(!t||!e)return!1;for(let i in t)if(t[i]!==e[i])return!1;return!0}checkUrlForCampaign(){let t=new RegExp(tP,"gim").exec(this.router.url)||new RegExp(ZF,"gim").exec(this.router.url);if(!(t&&t.groups&&t.groups.campaignId&&t.groups.missionId))return this.globalSelectedCampaign=null,void(this.campaignModeActive=!1);this.setGlobalCampaign(t.groups.campaignId,t.groups.missionId),this.campaignModeActive=!0}checkUrlForLobby(){this.isInLobby=!!this.router.url.match(new RegExp("lobby/"))}getLoadingProgressLength(){return Object.keys(this.progressLocalization).length}exit(){this.cache.alert("exit")}acceptLobbyInvitation(t){t&&t.lobbyId&&this.lobbyService.lobbyJoin(t.lobbyId,t.slot)}rejectLobbyInvitation(t){t&&t.lobbyId&&this.lobbyService.lobbyKickPlayer(t.lobbyId,this.cache.getUserId())}checkIfUserWantsReview(t){this.cache.getSession(t).winner&&this.cache.callReviewModal()}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(nd),o.Nb(xn),o.Nb(Ys),o.Nb(Uc),o.Nb(Gd),o.Nb(Td),o.Nb(Tl),o.Nb(Er),o.Nb(Ou),o.Nb(Bl),o.Nb(Kd),o.Nb(Md))},t.\u0275cmp=o.Hb({type:t,selectors:[["app-root"]],viewQuery:function(t,e){if(1&t&&(o.Qc(ZN,!0),o.Qc(tF,!0),o.Qc(eF,!0),o.Qc(iF,!0),o.Qc(nF,!0),o.Qc(sF,!0),o.Qc(aF,!0),o.Qc(rF,!0),o.Qc(oF,!0),o.Qc(cF,!0),o.Qc(lF,!0),o.Qc(uF,!0),o.Qc(dF,!0),o.Qc(hF,!0)),2&t){let t;o.vc(t=o.Zb())&&(e.newLevelModal=t.first),o.vc(t=o.Zb())&&(e.statisticsListModal=t.first),o.vc(t=o.Zb())&&(e.statisticsDetailModal=t.first),o.vc(t=o.Zb())&&(e.confirmModal=t.first),o.vc(t=o.Zb())&&(e.helpModal=t.first),o.vc(t=o.Zb())&&(e.invitationConfirm=t.first),o.vc(t=o.Zb())&&(e.loadGamePreloader=t.first),o.vc(t=o.Zb())&&(e.friends=t.first),o.vc(t=o.Zb())&&(e.compare=t.first),o.vc(t=o.Zb())&&(e.hqMessages=t.first),o.vc(t=o.Zb())&&(e.rewardsModal=t.first),o.vc(t=o.Zb())&&(e.conquestRulesModal=t.first),o.vc(t=o.Zb())&&(e.techTreeRulesModal=t.first),o.vc(t=o.Zb())&&(e.reviewModal=t.first)}},hostBindings:function(t,e){1&t&&o.Yb("click",function(t){return e.hostClickHandler(t)})},features:[o.Ab([nd,Uc,Gd,Td,Tl,Ou,Bl,Kd,Md])],decls:10,vars:6,consts:[["class","preload verticaly-middle",3,"fading",4,"ngIf"],["compare",""],["id","app-view",3,"large-language",4,"ngIf"],[3,"goToEdit"],[2,"position","relative","z-index","120"],[3,"large-language",4,"ngIf"],[3,"label"],["loadGamePreloader",""],[1,"preload","verticaly-middle"],[1,"content"],[1,"logo"],["src","assets/img/logo.svg","image-load","",1,"logo-image"],["src","assets/img/logo_sparks.png","image-load","",1,"logo-sparks"],["class","title",4,"ngIf"],[1,"persent"],["class","progress-wrapper",4,"ngIf"],["class","button margin-top large",3,"alertSound","click",4,"ngIf"],["class","error",4,"ngIf"],["class","error text",4,"ngIf"],[1,"copyright"],["src","assets/img/BW_logo.png","image-load","","fade-in","down",1,"copyright-logo","colored","left"],["src","assets/img/F_logo.svg","image-load","","fade-in","down",1,"copyright-logo","colored","right"],["class","progress-bar",4,"ngIf"],[1,"title"],[1,"progress-wrapper"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"button","margin-top","large",3,"alertSound","click"],[1,"error"],["src","assets/img/icons/svg/exclamation.svg","alt","",1,"icon","margin-right"],["class","error-title",4,"ngIf"],[1,"error-title"],[1,"error","text"],[1,"progress-bar"],["id","app-view"],[3,"onChatOpen",4,"ngIf"],["src","assets/img/back_ui/bg2.jpg",2,"position","fixed","top","-100000px","left","-100000px",3,"load"],[1,"fader"],[1,"header"],["class","window-background active",4,"ngIf"],["id","dragTarget",1,"drag-target"],["friends",""],["hqMessages",""],["new-level-modal","",3,"id"],["newLevelModal",""],[1,"greet"],[1,"verticaly-middle"],["class","inner",4,"ngIf"],[1,"play-nav"],[1,"button","block","large","filled","primary",3,"alertSound","click"],[1,"window-background","store-item-background"],[1,"active"],[1,"image-cover"],["image-load","",3,"src"],["class","medium","id","confirmationModal",3,"id","onClose",4,"ngIf"],["id","helpModal",1,"bottom-position",3,"id","header"],["helpModal",""],[1,"body"],[3,"innerHTML",4,"ngIf"],["class","alert",4,"ngIf"],[1,"align-right","button-cover"],["type","button",1,"button","faded-in",3,"tooltip-hint","alertSound","click"],["rewardsModal",""],["class","debug-line",4,"ngIf"],["invitationConfirm",""],[1,"full-screen",3,"ignoreCloseOnClick","id","header","onClose"],["statisticsListModal",""],[3,"campaignId",4,"ngIf"],["statisticsDetailModal",""],[3,"sessionId",4,"ngIf"],[1,"spaced-size",3,"id","header"],["conquestRulesModal",""],[1,"body","collapsed-top"],["fade-in","down",1,"rules-article",3,"innerHTML"],["techTreeRulesModal",""],[1,"medium","review-modal",3,"id"],["reviewModal",""],[1,"main-body"],[1,"image-set"],[1,"back-overlay"],[1,"back-mask"],["draggable","false","class","commander-image",3,"src",4,"ngIf"],["draggable","false","class","regiment-image",3,"src",4,"ngIf"],[1,"caption-cover"],[3,"innerHTML"],[1,"button","large",3,"alertSound","click"],[3,"onChatOpen"],[1,"window-background","active"],[1,"image"],["image-load","null",3,"src"],[1,"inner"],[1,"greet-levels"],[1,"clear","greet-new-items-list"],[1,"tile-layout-wrapper","small",2,"width","100%"],[1,"tile-layout","aligned","greet-rewards-list"],["fade-in","down",4,"ngFor","ngForOf"],["class","comma",4,"ngIf"],[1,"comma"],["fade-in","down"],[1,"simple-card","transparent"],[1,"image-contain"],[3,"src",4,"ngIf"],["data-unit-image","",3,"src",4,"ngIf"],["class","subheader2",4,"ngIf"],[3,"src"],["data-unit-image","",3,"src"],[1,"subheader2"],["id","confirmationModal",1,"medium",3,"id","onClose"],["confirmModal",""],[1,"body","collapsed-bottom"],[1,"dialog-header"],[1,"body","collapsed-bottom","align-center"],[1,"body","align-center"],[1,"button",3,"alertSound","click"],[1,"alert"],[1,"debug-line"],[1,"item",2,"white-space","nowrap"],[3,"campaignId"],[3,"sessionId"],["draggable","false",1,"commander-image",3,"src"],["draggable","false",1,"regiment-image",3,"src"]],template:function(t,e){1&t&&(o.Jc(0,RF,18,11,"div",0),o.Ob(1,"unit-compare-table",null,1),o.Jc(3,OF,2,2,"div",2),o.Rb(4,"notificator",3),o.Yb("goToEdit",function(){return e.isMatching=!1}),o.Qb(),o.Ob(5,"bug-report",4),o.Jc(6,XF,68,45,"div",5),o.Ob(7,"preloader",6,7),o.Ob(9,"gdpr")),2&t&&(o.jc("ngIf",!e.isLoaded),o.Bb(1),o.Fb("large-language",e.largeLanguageSelected),o.Bb(2),o.jc("ngIf",e.isLoaded),o.Bb(3),o.jc("ngIf",e.isLoaded),o.Bb(1),o.jc("label",e.L("meta.ui.preloader.load_game")))},directives:[ee,Py,hh,Bg,mv,TE,Qf,h_,Zt,Zv,ta,Bm,Ev,Qh,tp,yR,gg,hv,Rh,VR,hj,jM],encapsulation:2}),t})(),rP=(()=>{class t{}return t.\u0275mod=o.Lb({type:t,bootstrap:[aP]}),t.\u0275inj=o.Kb({factory:function(e){return new(e||t)},providers:[{provide:o.d,useFactory:()=>()=>{},deps:[Ia],multi:!0}],imports:[[XN.forRoot(),KN,ua]]}),t})();var oP;Object(o.V)(),(oP={dsn:"https://e230b48f81234323825b070c653e9041@sentry.bestway.com.ua/4",integrations:[new ar.BrowserTracing({tracingOrigins:["localhost"],routingInstrumentation:function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!0),ya=!0,_a=t,ka=i,e&&t({name:window.location.pathname,op:"pageload"})}}),new Oa.Breadcrumbs({console:!Object(o.X)()}),new ur({iteratee:t=>(t.filename&&(t.filename=t.filename.replace(/^file\:\/\/.*\//,"~/")),t)})],release:dr.a,tracesSampleRate:0,debug:!1})._metadata=oP._metadata||{},oP._metadata.sdk={name:"sentry.javascript.angular",packages:[{name:"npm:@sentry/angular",version:c}],version:c},function(t){if(void 0===t&&(t={}),void 0===t.defaultIntegrations&&(t.defaultIntegrations=Lt),void 0===t.release){var e=Object(m.e)();e.SENTRY_RELEASE&&e.SENTRY_RELEASE.id&&(t.release=e.SENTRY_RELEASE.id)}void 0===t.autoSessionTracking&&(t.autoSessionTracking=!0),function(t,e){var i;!0===e.debug&&b.a.enable();var n=Object(h.b)();null===(i=n.getScope())||void 0===i||i.update(e.initialScope);var s=new t(e);n.bindClient(s)}(ft,t),t.autoSessionTracking&&function(){if(void 0!==Object(m.e)().document){var t=Object(h.b)();"function"==typeof t.startSession&&"function"==typeof t.captureSession&&(t.startSession({ignoreDuration:!0}),t.captureSession(),Object(y.a)({callback:function(e){var i=e.from;void 0!==i&&i!==e.to&&(t.startSession({ignoreDuration:!0}),t.captureSession())},type:"history"}))}else b.a.warn("Session tracking in non-browser environment with @sentry/browser is not supported.")}()}(oP),Pr().bootstrapModule(rP).then(t=>console.log("Bootstrap success")).catch(t=>console.error(t))},zx2A:function(t,e,i){"use strict";i.d(e,"a",function(){return r}),i.d(e,"b",function(){return o}),i.d(e,"c",function(){return c});var n=i("7o/Q"),s=i("HDdC"),a=i("SeVD");class r extends n.a{constructor(t){super(),this.parent=t}_next(t){this.parent.notifyNext(t)}_error(t){this.parent.notifyError(t),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class o extends n.a{notifyNext(t){this.destination.next(t)}notifyError(t){this.destination.error(t)}notifyComplete(){this.destination.complete()}}function c(t,e){if(e.closed)return;if(t instanceof s.a)return t.subscribe(e);let i;try{i=Object(a.a)(t)(e)}catch(n){e.error(n)}return i}}},[[0,0]]]);
//# sourceMappingURL=main.25874ee5f4d5f48fcdbb.js.map